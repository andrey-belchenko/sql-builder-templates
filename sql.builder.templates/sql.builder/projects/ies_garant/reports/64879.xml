<?xml version="1.0" encoding="utf-8"?>
<root>
  <parts>
    <part id="64879-params" timestamp="28.08.2023 11:14:15">
      <param type="array" name="p_dep" />
      <param type="number" name="p_ym" />
      <param type="number" name="is_detail" />
    </part>
  </parts>
  <forms>
    <form name="64879" timestamp="18.04.2025 14:09:51">
      <content>
        <usefield field="asuse_dep_single" name="p_dep" mandatory="1" />
        <usefield field="asuse_ym_tek_dep" name="p_ym" />
        <usefield type="number" field="cmn_check" title="C перерасчетом прошлых лет" name="is_detail" />
      </content>
    </form>
    <form name="64879_v2" timestamp="19.04.2025 10:26:33">
      <usefield field="asuse_dep_single" name="p_dep" mandatory="1" />
      <usefield field="asuse_ym_tek_dep" name="p_ym" />
      <usefield type="number" field="cmn_check" title="C перерасчетом прошлых лет" name="is_flag" />
    </form>
  </forms>
  <queries>
    <query name="64879-data" nogrid="1" timestamp="07.02.2025 19:18:34">
      <select>
        <column table="dog" column="dep" />
        <column table="a" column="kod" />
        <column table="a" column="kod_dog" />
        <column table="a" column="inn" title="ИНН" />
        <column table="a" column="ndog" title="№ договора" />
        <column table="a" column="payer_name" title="Наименование клиента" />
        <column table="a" column="gtp_name" title="Поставщик" />
        <column table="a" column="vid_uslugi" as="kod_uslugi" />
        <column table="vid_uslugi" column="name" as="vid_uslugi" />
        <column table="a" column="ym" />
        <column table="a" column="rym" />
        <column table="a" column="kod_ck" />
        <column table="ck" column="name" as="name_ck" />
        <column table="a" column="kod_mvt" />
        <column table="mvt" column="name" as="name_mvt" />
        <column table="a" column="kod_vidacc" />
        <column table="vidacc" column="name" as="name_vidacc" />
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" />
        <column table="a" column="fsk_nach" title="ФСК руб." />
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" />
        <column table="a" column="gn_vn_nach" title="ГН-ВН руб." />
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" />
        <column table="a" column="gn_sn2_nach" title="ГН-СН2 руб." />
        <column table="a" column="vn_cust" title="ВН кВт*ч" />
        <column table="a" column="vn_nach" title="ВН руб." />
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" />
        <column table="a" column="sn1_nach" title="СН1 руб." />
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" />
        <column table="a" column="sn2_nach" title="СН2 руб." />
        <column table="a" column="nn_cust" title="НН кВт*ч" />
        <column table="a" column="nn_nach" title="НН руб." />
        <column table="a" column="itog_cust" title="Итого кВт*ч" />
        <column table="a" column="itog_nach" title="Итого руб." />
      </select>
      <from>
        <query name="sqlb_rep_64879_tbl" as="a" />
        <query name="kr_dogovor" join="left outer" as="dog">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="dog" column="kod_dog" />
          </call>
        </query>
        <query name="ies_garant_spr_ck_1" as="ck" join="left outer">
          <call function="=">
            <column table="a" column="kod_ck" />
            <column table="ck" column="id" />
          </call>
        </query>
        <query name="ies_garant_spr_mvt_1" as="mvt" join="left outer">
          <call function="=">
            <column table="a" column="kod_mvt" />
            <column table="mvt" column="id" />
          </call>
        </query>
        <query name="ies_garant_spr_vidacc_1" as="vidacc" join="left outer">
          <call function="=">
            <column table="a" column="kod_vidacc" />
            <column table="vidacc" column="id" />
          </call>
        </query>
        <query name="ies_garant_spr_vid_uslugi" join="left outer" as="vid_uslugi">
          <call function="=">
            <column table="a" column="vid_uslugi" />
            <column table="vid_uslugi" column="id" />
          </call>
        </query>
      </from>
    </query>
    <query name="64879-dog" nogrid="1" timestamp="07.02.2025 19:28:24">
      <params exclude="1">
        <param name="p_kod_adr_m" />
      </params>
      <select>
        <column table="a" column="dep" />
        <column table="a" column="kod" />
        <column table="a" column="kod_dog" />
        <column table="a" column="inn" group="max" />
        <column table="a" column="ndog" title="№ договора" group="max" />
        <column table="a" column="payer_name" title="Наименование клиента" group="max" />
        <column table="a" column="gtp_name" title="Поставщик" />
        <column table="a" column="kod_uslugi" />
        <column table="a" column="vid_uslugi" group="max" />
        <column table="a" column="ym" />
        <column table="a" column="rym" />
        <column table="a" column="kod_ck" />
        <column table="a" column="name_ck" group="max" />
        <column table="a" column="kod_mvt" />
        <column table="a" column="name_mvt" group="max" />
        <column table="a" column="kod_vidacc" />
        <column table="a" column="name_vidacc" group="max" />
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" as="gn_vn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" as="gn_vn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" nvl="0" as="gn_vn_cust">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" nvl="0" as="gn_vn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_nach" title="ГН-ВН руб." group="sum" nvl="0" as="gn_vn_nach">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_nach" title="ГН-ВН руб." group="sum" nvl="0" as="gn_vn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" as="gn_sn2_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" as="gn_sn2_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" nvl="0" as="gn_sn2_cust">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" nvl="0" as="gn_sn2_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_nach" title="ГН-СН2 руб." group="sum" nvl="0" as="gn_sn2_nach">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_nach" title="ГН-СН2 руб." group="sum" nvl="0" as="gn_sn2_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0" as="fsk_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0" as="fsk_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0" as="vn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0" as="vn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0" as="sn1_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0" as="sn1_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0" as="sn2_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0" as="sn2_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0" as="nn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0" as="nn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0" as="itog_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0" as="itog_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
      </select>
      <from>
        <query name="64879-data" as="a" />
        <query name="kr_dogovor" join="left outer" as="k">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="k" column="kod_dog" />
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="in" optional="1">
            <column table="k" column="adress_region" />
            <useparam name="p_kod_adr_m" />
          </call>
          <call function="true" />
        </call>
      </where>
      <grouping>
        <grset as="itog">
          <grset as="dog">
            <group>
              <column table="a" column="kod_dog" />
            </group>
            <grset as="itogvc">
              <group>
                <column table="a" column="kod_vidacc" />
              </group>
            </grset>
            <grset as="gtp">
              <group>
                <column table="a" column="gtp_name" />
              </group>
              <grset as="gitogvc">
                <group>
                  <column table="a" column="kod_vidacc" />
                </group>
              </grset>
              <grset as="ck">
                <group>
                  <column table="a" column="kod_ck" />
                </group>
                <grset as="mvt">
                  <group>
                    <column table="a" column="kod_mvt" />
                  </group>
                  <grset as="vidacc">
                    <group>
                      <column table="a" column="kod_vidacc" />
                    </group>
                  </grset>
                </grset>
              </grset>
            </grset>
            <grset as="ck" exclude="1">
              <group>
                <column table="a" column="kod_ck" />
              </group>
              <grset as="mvt">
                <group>
                  <column table="a" column="kod_mvt" />
                </group>
                <grset as="vidacc">
                  <group>
                    <column table="a" column="kod_vidacc" />
                  </group>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
        <grset as="dog" exclude="1">
          <group>
            <column table="a" column="kod_dog" />
          </group>
          <grset as="itogvc">
            <group>
              <column table="a" column="kod_vidacc" />
            </group>
          </grset>
          <grset as="gtp">
            <group>
              <column table="a" column="gtp_name" />
            </group>
            <grset as="gitogvc">
              <group>
                <column table="a" column="kod_vidacc" />
              </group>
            </grset>
            <grset as="ck">
              <group>
                <column table="a" column="kod_ck" />
              </group>
              <grset as="mvt">
                <group>
                  <column table="a" column="kod_mvt" />
                </group>
                <grset as="vidacc">
                  <group>
                    <column table="a" column="kod_vidacc" />
                  </group>
                </grset>
              </grset>
            </grset>
          </grset>
          <grset as="ck" exclude="1">
            <group>
              <column table="a" column="kod_ck" />
            </group>
            <grset as="mvt">
              <group>
                <column table="a" column="kod_mvt" />
              </group>
              <grset as="vidacc">
                <group>
                  <column table="a" column="kod_vidacc" />
                </group>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="64879-gtp" nogrid="1" timestamp="15.08.2023 14:44:44">
      <params exclude="1">
        <param name="p_kod_adr_m" />
      </params>
      <select>
        <column table="a" column="dep" />
        <column table="a" column="kod_dog" />
        <column table="a" column="inn" />
        <column table="a" column="ndog" title="№ договора" />
        <column table="a" column="payer_name" title="Наименование клиента" />
        <column table="a" column="gtp_name" title="Поставщик" />
        <column table="a" column="ym" />
        <column table="a" column="rym" />
        <column table="a" column="kod_ck" />
        <column table="a" column="name_ck" group="max" />
        <column table="a" column="kod_mvt" />
        <column table="a" column="name_mvt" group="max" />
        <column table="a" column="kod_vidacc" />
        <column table="a" column="name_vidacc" group="max" />
        <column table="a" column="gn_cast" title="ГН кВт*ч" group="sum" if="notvidacc1" as="gn_cast1" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod_vidacc" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_cast" title="ГН кВт*ч" group="sum" nvl="0" />
        <column table="a" column="gn_nach" title="ГН руб." group="sum" nvl="0" />
        <column table="a" column="fsk_cast" title="ФСК кВт*ч" group="sum" if="notvidacc1" as="fsk_cast1" nvl="0" />
        <column table="a" column="fsk_cast" title="ФСК кВт*ч" group="sum" nvl="0" />
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0" />
        <column table="a" column="vn_cast" title="ВН кВт*ч" group="sum" if="notvidacc1" as="vn_cast1" nvl="0" />
        <column table="a" column="vn_cast" title="ВН кВт*ч" group="sum" nvl="0" />
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0" />
        <column table="a" column="sn1_cast" title="СН1 кВт*ч" group="sum" if="notvidacc1" as="sn1_cast1" nvl="0" />
        <column table="a" column="sn1_cast" title="СН1 кВт*ч" group="sum" nvl="0" />
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0" />
        <column table="a" column="sn2_cast" title="СН2 кВт*ч" group="sum" if="notvidacc1" as="sn2_cast1" nvl="0" />
        <column table="a" column="sn2_cast" title="СН2 кВт*ч" group="sum" nvl="0" />
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0" />
        <column table="a" column="nn_cast" title="НН кВт*ч" group="sum" if="notvidacc1" as="nn_cast1" nvl="0" />
        <column table="a" column="nn_cast" title="НН кВт*ч" group="sum" nvl="0" />
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0" />
        <column table="a" column="itog_cast" title="Итого кВт*ч" group="sum" if="notvidacc1" as="itog_cast1" nvl="0" />
        <column table="a" column="itog_cast" title="Итого кВт*ч" group="sum" nvl="0" />
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0" />
      </select>
      <from>
        <query name="64879-data" as="a" />
        <query name="kr_dogovor" join="left outer" as="k">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="k" column="kod_dog" />
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="in" optional="1">
            <column table="k" column="adress_region" />
            <useparam name="p_kod_adr_m" />
          </call>
          <call function="true" />
        </call>
      </where>
      <grouping>
        <grset as="gtp">
          <group>
            <column table="a" column="gtp_name" />
          </group>
          <grset as="itogvc">
            <group>
              <column table="a" column="kod_vidacc" />
            </group>
          </grset>
          <grset as="ck">
            <group>
              <column table="a" column="kod_ck" />
            </group>
            <grset as="mvt">
              <group>
                <column table="a" column="kod_mvt" />
              </group>
              <grset as="vidacc">
                <group>
                  <column table="a" column="kod_vidacc" />
                </group>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="64879-itog-all" nogrid="1" timestamp="24.08.2023 17:10:36">
      <params exclude="1">
        <param name="p_kod_adr_m" />
      </params>
      <select>
        <column table="a" column="dep" />
        <column table="a" column="kod_dog" />
        <column table="a" column="inn" />
        <column table="a" column="ndog" title="№ договора" />
        <column table="a" column="payer_name" title="Наименование клиента" />
        <column table="a" column="gtp_name" title="Наименование клиента" />
        <column table="a" column="ym" />
        <column table="a" column="rym" />
        <column table="a" column="kod_ck" />
        <column table="a" column="name_ck" />
        <column table="a" column="kod_mvt" />
        <column table="a" column="name_mvt" />
        <column table="a" column="kod_vidacc" />
        <column table="a" column="name_vidacc" />
        <column table="a" column="gn_cust" title="ГН кВт*ч" group="sum" as="gn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_cust" title="ГН кВт*ч" group="sum" as="gn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_cust" title="ГН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_cust" title="ГН кВт*ч" group="sum" nvl="0" as="gn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_nach" title="ГН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_nach" title="ГН руб." group="sum" nvl="0" as="gn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0" as="fsk_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0" as="fsk_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0" as="vn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0" as="vn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0" as="sn1_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0" as="sn1_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0" as="sn2_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0" as="sn2_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0" as="nn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0" as="nn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0" as="itog_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0" as="itog_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
      </select>
      <from>
        <query name="64879-data" as="a" />
        <query name="kr_dogovor" join="left outer" as="k">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="k" column="kod_dog" />
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="in" optional="1">
            <column table="k" column="adress_region" />
            <useparam name="p_kod_adr_m" />
          </call>
          <call function="true" />
        </call>
      </where>
      <grouping>
        <grset as="itog">
          <group>
            <column table="a" column="dep" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="64879-itog-all_vidacc" nogrid="1" timestamp="07.02.2025 19:34:24">
      <params exclude="1">
        <param name="p_kod_adr_m" />
      </params>
      <select>
        <column table="a" column="dep" />
        <column table="a" column="kod_dog" />
        <column table="a" column="inn" />
        <column table="a" column="ndog" title="№ договора" />
        <column table="a" column="payer_name" title="Наименование клиента" />
        <column table="a" column="gtp_name" title="Наименование клиента" />
        <column table="a" column="ym" />
        <column table="a" column="rym" />
        <column table="a" column="kod_ck" />
        <column table="a" column="name_ck" />
        <column table="a" column="kod_mvt" />
        <column table="a" column="name_mvt" />
        <column table="a" column="kod_vidacc" />
        <column table="a" column="name_vidacc" />
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" as="gn_vn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" as="gn_vn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" nvl="0" as="gn_vn_cust">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_cust" title="ГН-ВН кВт*ч" group="sum" nvl="0" as="gn_vn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_nach" title="ГН-ВН руб." group="sum" nvl="0" as="gn_vn_nach">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_vn_nach" title="ГН-ВН руб." group="sum" nvl="0" as="gn_vn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" as="gn_sn2_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" as="gn_sn2_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" nvl="0" as="gn_sn2_cust">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_cust" title="ГН-СН2 кВт*ч" group="sum" nvl="0" as="gn_sn2_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_nach" title="ГН-СН2 руб." group="sum" nvl="0" as="gn_sn2_nach">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="gn_sn2_nach" title="ГН-СН2 руб." group="sum" nvl="0" as="gn_sn2_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" as="fsk_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_cust" title="ФСК кВт*ч" group="sum" nvl="0" as="fsk_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="fsk_nach" title="ФСК руб." group="sum" nvl="0" as="fsk_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" as="vn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_cust" title="ВН кВт*ч" group="sum" nvl="0" as="vn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vn_nach" title="ВН руб." group="sum" nvl="0" as="vn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" as="sn1_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_cust" title="СН1 кВт*ч" group="sum" nvl="0" as="sn1_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn1_nach" title="СН1 руб." group="sum" nvl="0" as="sn1_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" as="sn2_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_cust" title="СН2 кВт*ч" group="sum" nvl="0" as="sn2_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="sn2_nach" title="СН2 руб." group="sum" nvl="0" as="sn2_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" as="nn_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_cust" title="НН кВт*ч" group="sum" nvl="0" as="nn_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="nn_nach" title="НН руб." group="sum" nvl="0" as="nn_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" as="itog_cust1_uslugi" nvl="0">
          <if>
            <call function="and">
              <call function="=">
                <column table="a" column="kod_vidacc" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="kod" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_cust" title="Итого кВт*ч" group="sum" nvl="0" as="itog_cust_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="itog_nach" title="Итого руб." group="sum" nvl="0" as="itog_nach_uslugi">
          <if>
            <call function="=">
              <column table="a" column="kod" />
              <const>2</const>
            </call>
          </if>
        </column>
      </select>
      <from>
        <query name="64879-data" as="a" />
        <query name="kr_dogovor" join="left outer" as="k">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="k" column="kod_dog" />
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="in" optional="1">
            <column table="k" column="adress_region" />
            <useparam name="p_kod_adr_m" />
          </call>
          <call function="true" />
        </call>
      </where>
      <grouping>
        <grset as="itog">
          <group>
            <column table="this" column="kod_vidacc" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="ies_garant_spr_ck_1" order="id" title="Ценовая категория" timestamp="22.08.2023 13:06:51">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'1ЦК КП'</const>
      <const>2</const>
      <const>'1ЦК ЭС'</const>
      <const>3</const>
      <const>'2ЦК КП'</const>
      <const>4</const>
      <const>'2ЦК ЭС'</const>
      <const>5</const>
      <const>'3ЦК КП'</const>
      <const>6</const>
      <const>'3ЦК ЭС'</const>
      <const>7</const>
      <const>'4ЦК КП'</const>
      <const>8</const>
      <const>'4ЦК ЭС'</const>
      <const>9</const>
      <const>'5ЦК КП'</const>
      <const>10</const>
      <const>'5ЦК ЭС'</const>
      <const>11</const>
      <const>'6ЦК КП'</const>
      <const>12</const>
      <const>'6ЦК ЭС'</const>
    </query>
    <query name="ies_garant_spr_vidacc_1" order="id" timestamp="22.08.2023 13:24:49">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'электроэнергия'</const>
      <const>2</const>
      <const>'ген. мощность, кВт'</const>
      <const>3</const>
      <const>' сет. мощность, кВт'</const>
    </query>
    <query name="ies_garant_spr_mvt_1" order="id" title="Группы мощности" timestamp="22.08.2023 13:39:22">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'макс. мощность менее 670 кВт'</const>
      <const>2</const>
      <const>'макс. мощность от 670 кВт до 10 МВт'</const>
      <const>3</const>
      <const>'макс. мощностью св. 10 МВт'</const>
    </query>
    <query name="ies_garant_spr_vid_uslugi" order="id" title="Вид услуги" timestamp="25.08.2023 14:33:48">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'одноставочная ЭЭ'</const>
      <const>2</const>
      <const>'двуставочная ЭЭ'</const>
      <const>3</const>
      <const>'одноставочная ЭМУ'</const>
      <const>4</const>
      <const>'двуставочная ЭМУ'</const>
    </query>
    <query name="64879_v2_data" timestamp="22.04.2025 15:33:38">
      <select>
        <column table="a" column="kod_dog" />
        <column table="a" column="ndog" group="max" />
        <column table="a" column="payer_name" group="max" />
        <column table="a" column="inn" group="max" />
        <column table="a" column="kod_gtp" as="kod_gtp" nvl="0" type="number" />
        <column table="a" column="gtp_name" as="gtp_name" nvl="'-'" group="max" type="string" />
        <column table="a" column="type_service" as="type_service" />
        <call group="max" table="a" function="case" as="type_service_name" type="string">
          <call function="when">
            <call function="=">
              <column table="a" column="type_service" />
              <const type="number">1</const>
            </call>
            <const type="string">'ЭЭ, МВт*ч'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="type_service" />
              <const type="number">2</const>
            </call>
            <const type="string">'МП, МВт'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="type_service" />
              <const type="number">3</const>
            </call>
            <const type="string">'МУ, МВт'</const>
          </call>
        </call>
        <column table="a" column="price_category" as="price_category" type="number" />
        <call group="max" type="string" function="||" as="price_category_name">
          <call table="a" column="price_category" function="int to char">
            <column table="a" column="price_category" />
          </call>
          <const type="string">' ЦК'</const>
        </call>
        <call table="a" function="case" type="number" as="gr_max_power">
          <call function="when">
            <call function="lt">
              <column table="a" column="max_power" nvl="0" />
              <const type="number">670</const>
            </call>
            <const type="number">1</const>
          </call>
          <call function="when">
            <call function="between">
              <column table="a" column="max_power" />
              <const type="number">670</const>
              <const type="number">10000</const>
            </call>
            <const type="number">2</const>
          </call>
          <call function="else">
            <const type="number">3</const>
          </call>
        </call>
        <call group="max" table="a" function="case" type="string" as="gr_max_power_name">
          <call function="when">
            <call function="lt">
              <column table="a" column="max_power" nvl="0" />
              <const type="number">670</const>
            </call>
            <const type="string">'менее 670 кВт'</const>
          </call>
          <call function="when">
            <call function="between">
              <column table="a" column="max_power" />
              <const type="number">670</const>
              <const type="number">10000</const>
            </call>
            <const type="string">'от 670 кВт до 10 МВт'</const>
          </call>
          <call function="else">
            <const type="string">'не менее 10 МВт'</const>
          </call>
        </call>
        <column group="sum" table="a" column="cust_kvth" as="cust_kvth_all" mp="-3" nvl="0" />
        <column table="a" column="cust_kvth" group="sum" mp="-3" nvl="0" dimname="volt" as="cust_kvth">
          <pivot>
            <column table="a" column="voltage" />
            <query>
              <select>
                <column table="a1" column="voltage" />
                <column table="a1" column="voltage_abbr" />
              </select>
              <from>
                <query name="voltage_all" as="a1" />
              </from>
              <where>
                <call function="gt">
                  <column table="a1" column="voltage" />
                  <const type="number">-2</const>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column group="sum" table="a" as="cust_all" mp="-3" column="cust" nvl="0" />
        <column table="a" column="cust" group="sum" mp="-3" nvl="0" dimname="volt" as="cust">
          <pivot>
            <column table="a" column="voltage" />
            <query>
              <select>
                <column table="a1" column="voltage" />
                <column table="a1" column="voltage_abbr" />
              </select>
              <from>
                <query name="voltage_all" as="a1" />
              </from>
              <where>
                <call function="gt">
                  <column table="a1" column="voltage" />
                  <const type="number">-2</const>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="nach" group="sum" mp="-3" nvl="0" as="nach_all" />
        <column table="a" column="nach" group="sum" mp="-3" nvl="0" as="nach" dimname="volt" />
        <column group="sum" table="a" column="sost_cust_kvth" as="sost_cust_kvth_all" mp="-3" nvl="0" />
        <column table="a" column="sost_cust_kvth" group="sum" mp="-3" nvl="0" dimname="volt" as="sost_cust_kvth" />
        <column group="sum" table="a" as="sost_cust_all" mp="-3" column="sost_cust" nvl="0" />
        <column table="a" column="sost_cust" group="sum" mp="-3" nvl="0" dimname="volt" as="sost_cust" />
        <column table="a" column="sost_nach" group="sum" mp="-3" nvl="0" as="sost_nach_all" />
        <column table="a" column="sost_nach" group="sum" mp="-3" nvl="0" as="sost_nach" dimname="volt" />
      </select>
      <from>
        <query name="sqlb_rep_64879_v2_tbl" as="a" />
      </from>
      <grouping>
        <grset as="itog">
          <grset as="itog_serv" order="type_service">
            <group>
              <column table="this" column="type_service" />
            </group>
          </grset>
          <grset order="ndog nulls last" as="dog">
            <group>
              <column table="this" column="kod_dog" type="number" />
            </group>
            <grset as="gtp" order="gtp_name">
              <group>
                <column table="this" column="kod_gtp" type="number" />
              </group>
              <grset as="gtp_serv" order="type_service">
                <group>
                  <column table="this" column="type_service" />
                </group>
              </grset>
              <grset as="gtp_price" order="price_category">
                <group>
                  <column table="this" column="price_category" />
                </group>
                <grset as="gtp_price_serv" order="type_service">
                  <group>
                    <column table="this" column="type_service" />
                  </group>
                </grset>
                <grset as="gtp_max_pwr" order="gr_max_power">
                  <group>
                    <column table="this" column="gr_max_power" />
                  </group>
                  <grset as="gtp_pwr_serv" order="type_service">
                    <group>
                      <column table="this" column="type_service" />
                    </group>
                  </grset>
                </grset>
              </grset>
            </grset>
            <grset as="serv" order="type_service">
              <group>
                <column table="this" column="type_service" />
              </group>
            </grset>
            <grset as="price" order="price_category">
              <group>
                <column table="this" column="price_category" />
              </group>
              <grset as="price_serv" order="type_service">
                <group>
                  <column table="this" column="type_service" />
                </group>
              </grset>
              <grset as="max_pwr" order="gr_max_power">
                <group>
                  <column table="this" column="gr_max_power" />
                </group>
                <grset as="pwr_serv" order="type_service">
                  <group>
                    <column table="this" column="type_service" />
                  </group>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
  </queries>
  <reports>
    <report name="64879" nogrid="1" form="64879" title="Отчет О выручке и затратах" timestamp="03.10.2023 12:44:14">
      <params>
        <usepart part="64879-params" />
      </params>
      <customers>
        <customer id="29" />
      </customers>
      <procedure>
        <text>
begin
    delete vr_number_array;
    for rec in (select * from kr_org where kodp in :p_dep)
    loop
      insert into vr_number_array (array_id,val) values ('p_dep',rec.kodp);
    end loop;
    sqlb_rep_64879.fill_table(:p_ym, :is_detail);
end;
      </text>
      </procedure>
      <print-templates>
        <excel>
          <template name="64879.xlsx" print-proc="2" print-xlsx="1" title="Отчет О выручке и затратах" />
        </excel>
      </print-templates>
      <queries>
        <query name="64879-itog-all" as="ia" exclude="1">
          <withparams exclude="1">
            <useparam name="p_kod_adr_m" />
          </withparams>
        </query>
        <query name="64879-itog-all_vidacc" as="iav">
          <withparams exclude="1">
            <useparam name="p_kod_adr_m" />
          </withparams>
        </query>
        <query name="64879-dog" as="d">
          <withparams exclude="1">
            <useparam name="p_kod_adr_m" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="64879_v2" nogrid="1" form="64879_v2" title="Отчет О выручке и затратах" timestamp="19.04.2025 12:01:21">
      <params>
        <param type="array" name="p_dep" />
        <param type="number" name="p_ym" />
        <param type="number" name="is_flag" />
      </params>
      <customers>
        <customer id="29" />
      </customers>
      <procedure><![CDATA[begin
    delete vr_number_array;
    insert into vr_number_array (array_id,val) SELECT 'p_dep', kodp from kr_org where 1=0 { OR kodp in :p_dep};
    sqlb_rep_64879.fill_table_v2(:p_ym, /*nvlu*/ :is_flag);
end;
]]></procedure>
      <print-templates>
        <excel>
          <template name="64879_v2.xlsx" print-proc="2" print-xlsx="1" title="Отчет О выручке и затратах" />
        </excel>
      </print-templates>
      <queries>
        <query name="64879_v2_data" as="d" />
        <query name="title_info" as="t">
          <withparams>
            <useparam name="p_ym" />
            <const>NULL</const>
            <useparam name="p_dep" />
            <const>NULL</const>
            <useparam name="is_flag" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
</root>