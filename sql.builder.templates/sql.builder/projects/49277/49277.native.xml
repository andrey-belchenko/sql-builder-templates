<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-06-29T03:13:43.4611695+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="vb_nastr_pwrc_list_1" timestamp="21.02.2021 01:45:05" class="1" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="kod_nastr" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="ПС" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def" as="a" auto-refresh="1" column-editable="0">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
        <query name="vb_rb_default_pwrc" as="pwrc_id" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="pwrc_id" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="pwrc_id" column="kod_fl" />
            </call>
            <call function="=">
              <column table="pwrc_id" column="kod_kol_gr_nastr" />
              <useparam name="kod_nastr" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="is null">
          <column table="pwrc_id" column="kod_kol_gr_pwrc" />
        </call>
      </where>
    </query>
    <query name="vb_rb_default_pwrc_list" class="1" timestamp="21.02.2021 01:58:41" order="name, pwrcn" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcn" type="string" title="ПС" />
        <column table="a" column="bal_id" />
        <column table="kod_fl" column="name" />
      </select>
      <from>
        <query name="vr_rb_pwrc" as="a" auto-refresh="1" column-editable="0">
          <link name="kod_fl" />
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is null">
            <column table="def_pwrc" column="pwrc_id" />
          </call>
          <call function="in">
            <column table="a" column="bal_id" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="vb_rb_default_pwrc_add" timestamp="25.02.2019 17:07:28" update-target="vb_rb_default_pwrc" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="pwrc_id" type="number" />
        <param name="bal_id" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="kod_fl">
          <useparam name="bal_id" />
        </call>
        <call function="()" type="number" as="pwrc_id">
          <useparam name="pwrc_id" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vb_rb_default_fdr_list" class="1" timestamp="21.02.2021 04:52:20" order="name, pwrcname, pwrc_fdrname" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <select>
        <call function="||-" as="pwrc_kod_id_fdrid" key="1">
          <column table="def_pwrc" column="kod_id" />
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" />
        </call>
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" />
        <column table="a" column="pwrc_fdrname" title="Фидер" />
        <column table="a" column="pwrc_id" />
        <column table="a" column="pwrcname" type="string" title="ПС" />
        <column table="def_pwrc" column="kod_fl" />
        <column table="a" column="pwrc_fdr_explname" title="Экспл.отв." />
        <column table="kod_fl" column="name" />
        <column table="def_pwrc" column="kod_id" />
      </select>
      <from>
        <query name="vr_rb_fider" as="a" auto-refresh="1" column-editable="0" />
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <link name="kod_fl" />
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="def_pwrc" column="pwrc_id" />
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="def_fdr" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="def_pwrc" column="kod_id" />
              <column table="def_fdr" column="kod_id_pwrc" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is null">
            <column table="def_fdr" column="pwrc_fdrid" />
          </call>
          <call function="in">
            <column table="kod_fl" column="kod_fl" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="vb_rb_default_fdr_add" timestamp="25.02.2019 20:19:14" update-target="vb_rb_default_fdr" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="pwrc_fdrid" type="number" />
        <param name="pwrc_id" type="number" />
        <param type="number" name="kod_id_pwrc" />
      </params>
      <select>
        <call function="()" type="number" as="pwrc_id">
          <useparam name="pwrc_id" />
        </call>
        <call function="()" type="number" as="pwrc_fdrid">
          <useparam name="pwrc_fdrid" />
        </call>
        <call function="()" type="number" as="kod_id_pwrc">
          <useparam name="kod_id_pwrc" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vb_rb_default_pwrc_list_from_HV_EOPWRC" class="1" timestamp="21.02.2021 04:59:33" order="name, pwrcname" file="sql.builder.templates\sql.builder\projects\49277\form\query.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <select>
        <call function="||-" key="1" as="bal_id_pwrc_id">
          <column table="a" column="bal_id" />
          <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="ПС" />
        <column table="a" column="bal_id" />
        <column table="kod_fl" column="name" />
      </select>
      <from>
        <query name="hv_eopwrc" as="a" auto-refresh="1" column-editable="0">
          <link name="kod_fl" />
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is null">
            <column table="def_pwrc" column="pwrc_id" />
          </call>
          <call function="in">
            <column table="a" column="bal_id" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="main_49277" timestamp="02.10.2018 17:12:30" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <call as="count_fdr" group="sum" function="()" type="number">
          <const>1</const>1</call>
        <column table="d49277_kod_fl" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <column table="d49277_fdrid" column="pwrc_fdrid" />
        <column table="d49277_kod_fl" column="name" as="fskname" group="max" title="Филиал" />
        <column table="d49277_pwrc" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="d49277_fdrid" column="pwrc_fdrname" group="max" title="ДИСП №ФИД" />
        <fact column="vr_rb_fact_wp_in_fdr" as="wp_in_st1" group="sum" table="stage1" />
        <fact column="vr_rb_fact_wp_out_fdr" as="wp_out_st1" group="sum" table="stage1" />
        <call function="case" as="neb_st1" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st1" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st1" table="this" />
                    <column column="wp_out_st1" table="this" />
                  </call>
                  <column column="wp_in_st1" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="vr_rb_fact_wp_in_fdr" as="wp_in_st2" group="sum" table="stage2" />
        <fact column="vr_rb_fact_wp_out_fdr" as="wp_out_st2" group="sum" table="stage2" />
        <call function="case" as="neb_st2" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st2" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st2" table="this" />
                    <call function="nvl0">
                      <column column="wp_out_st2" table="this" />
                    </call>
                  </call>
                  <column column="wp_in_st2" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="vr_rb_fact_wp_in_fdr" as="wp_in" group="sum" table="main" />
        <fact column="vr_rb_fact_wp_out_fdr" as="wp_out" group="sum" table="main" />
        <call function="case" as="neb" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="/">
                <call function="-">
                  <column column="wp_in" table="this" />
                  <call function="nvl0">
                    <column column="wp_out" table="this" />
                  </call>
                </call>
                <column column="wp_in" table="this" />
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact table="stage2" column="vr_rb_fact_count_tp" group="sum" as="tp_st2" nullif="0" />
        <fact table="main" column="vr_rb_fact_count_tp" group="sum" as="tp" nullif="0" exclude="1" />
        <fact table="main" column="vr_rb_fact_count_tp_le" group="sum" as="tp_le" nullif="0" />
        <fact table="main" column="vr_rb_fact_count_tp_potr" group="sum" as="tp_potr" nullif="0" />
        <call group="sum" as="tp_dif_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tp" />
          <fact table="prev_week" column="vr_rb_fact_count_tp" />
        </call>
        <call as="tp_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_count_tp_0" table="stage2" />
          <fact column="vr_rb_fact_count_tp_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_count_tp_le_0null" group="sum" as="tp_le_0null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tp_potr_0" group="sum" as="tp_potr_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tp_potr_null" group="sum" as="tp_potr_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tp_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tp_le_0null" table="main" />
            <fact column="vr_rb_fact_count_tp_potr_0" table="main" />
            <fact column="vr_rb_fact_count_tp_potr_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tp_le_0null" table="prev_week" />
            <fact column="vr_rb_fact_count_tp_potr_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tp_potr_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu" group="sum" as="tu" table="main" nullif="0" exclude="1" />
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul" table="main" nullif="0" />
        <call group="sum" as="tu_dif_ul_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_ul" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_ul" />
        </call>
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas" table="main" nullif="0" />
        <call group="sum" as="tu_dif_nas_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_nas" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_nas" />
        </call>
        <call group="sum" as="tu_dif_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu" />
          <fact table="prev_week" column="vr_rb_fact_count_tu" />
        </call>
        <call as="tu_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_count_tu_0" table="stage2" />
          <fact column="vr_rb_fact_count_tu_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_count_tu_ul_0" group="sum" as="tu_ul_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_null" group="sum" as="tu_ul_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_0" group="sum" as="tu_nas_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_null" group="sum" as="tu_nas_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tu_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="main" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="main" />
            <fact column="vr_rb_fact_count_tu_nas_0" table="main" />
            <fact column="vr_rb_fact_count_tu_nas_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_nas_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_nas_null" table="prev_week" />
          </call>
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_kod_fl" />
          <link name="d49277_pwrc" />
          <link name="d49277_fdrid" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_pwrc" column="pwrc_id" />
                <const>(8871, 56215, 342, 78784, 34026, 6665, 59071, 208972)</const>
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <const>(8873, 8874, 8875, 8876, 8872, 56264, 56274, 56276, 56266, 56268, 56269, 56270, 56271, 56272, 56273, 1865, 1866, 1867, 1868, 79387, 79388, 79491, 59181, 59180, 59179, 59177, 59182, 59183, 59184, 382276, 472188, 1229, 6670, 6667, 85354, 85355)</const>
              </call>
            </call>
          </where>
          <dimset as="main">
            <link name="dat" only-for-cond="1" />
            <where exclude="1">
              <call function="gt">
                <column table="dat" column="val" />
                <const>to_date('20180102', 'YYYY.MM.DD')</const>
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <call function="-">
                  <call function="trunc">
                    <call function="sysdate" />
                  </call>
                  <const>7</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="=">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <const>to_date('20180515', 'YYYY.MM.DD')</const>
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <const>to_date('20180531', 'YYYY.MM.DD')</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <grset as="ps" title="По сетям" order="pwrcname">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="d49277_fdrid" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="title_49277" timestamp="06.03.2019 11:51:31" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <usepart part="49277-params_test2" />
      </params>
      <select>
        <call function="trunc" as="dat_otch" type="date">
          <call function="sysdate" />
        </call>
        <call function="to_char" as="num_week" exclude="1">
          <call function="-">
            <call function="sysdate" />
            <const>7</const>
          </call>
          <const>'ww'</const>
        </call>
        <call function="()" as="num_week" type="string">
          <useparam name="w_num" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="main_49277_test" timestamp="26.02.2019 13:27:22" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <call as="count_fdr" group="count_dist" function="()" type="number">
          <const exclude="1">1</const>
          <column table="kg_name" column="val" />1</call>
        <column table="d49277_kod_fl" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <column table="d49277_fdrid" column="pwrc_fdrid" exclude="1" />
        <column table="kg_name" column="val" title="ДИСП №ФИД" as="pwrc_fdrname" />
        <column table="d49277_kod_fl" column="name" as="fskname" group="max" title="Филиал" />
        <column table="d49277_pwrc" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="d49277_fdrid" column="pwrc_fdrname" group="max" title="ДИСП №ФИД" exclude="1" />
        <fact column="vr_rb_fact_test_wp_in_fdr" as="wp_in_st1" group="sum" table="stage1" />
        <fact column="vr_rb_fact_test_wp_out_fdr" as="wp_out_st1" group="sum" table="stage1" />
        <call function="case" as="neb_st1" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st1" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st1" table="this" />
                    <column column="wp_out_st1" table="this" />
                  </call>
                  <column column="wp_in_st1" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="vr_rb_fact_test_wp_in_fdr" as="wp_in_st2" group="sum" table="stage2" />
        <fact column="vr_rb_fact_test_wp_out_fdr" as="wp_out_st2" group="sum" table="stage2" />
        <call function="case" as="neb_st2" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st2" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st2" table="this" />
                    <call function="nvl0">
                      <column column="wp_out_st2" table="this" />
                    </call>
                  </call>
                  <column column="wp_in_st2" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="vr_rb_fact_test_wp_in_fdr" as="wp_in" group="sum" table="main" />
        <fact column="vr_rb_fact_test_wp_out_fdr" as="wp_out" group="sum" table="main" />
        <call function="case" as="neb" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="/">
                <call function="-">
                  <column column="wp_in" table="this" />
                  <call function="nvl0">
                    <column column="wp_out" table="this" />
                  </call>
                </call>
                <column column="wp_in" table="this" />
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact table="stage2" column="vr_rb_fact_test_count_tp" group="sum" as="tp_st2" nullif="0" />
        <fact table="main" column="vr_rb_fact_count_tp" group="sum" as="tp" nullif="0" exclude="1" />
        <fact table="main" column="vr_rb_fact_test_count_tp_le" group="sum" as="tp_le" nullif="0" />
        <fact table="main" column="vr_rb_fact_test_count_tp_potr" group="sum" as="tp_potr" nullif="0" />
        <call group="sum" as="tp_dif_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_test_count_tp" />
          <fact table="prev_week" column="vr_rb_fact_test_count_tp" />
        </call>
        <call as="tp_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_test_count_tp_0" table="stage2" />
          <fact column="vr_rb_fact_test_count_tp_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_test_count_tp_le_0null" group="sum" as="tp_le_0null" table="main" nullif="0" />
        <fact column="vr_rb_fact_test_count_tp_potr_0" group="sum" as="tp_potr_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test_count_tp_potr_null" group="sum" as="tp_potr_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tp_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test_count_tp_le_0null" table="main" />
            <fact column="vr_rb_fact_test_count_tp_potr_0" table="main" />
            <fact column="vr_rb_fact_test_count_tp_potr_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test_count_tp_le_0null" table="prev_week" />
            <fact column="vr_rb_fact_test_count_tp_potr_0" table="prev_week" />
            <fact column="vr_rb_fact_test_count_tp_potr_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_test_count_tu_ul" group="sum" as="tu_ul_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_test_count_tu_nas" group="sum" as="tu_nas_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu" group="sum" as="tu" table="main" nullif="0" exclude="1" />
        <fact column="vr_rb_fact_test_count_tu_ul" group="sum" as="tu_ul" table="main" nullif="0" />
        <call group="sum" as="tu_dif_ul_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_test_count_tu_ul" />
          <fact table="prev_week" column="vr_rb_fact_test_count_tu_ul" />
        </call>
        <fact column="vr_rb_fact_test_count_tu_nas" group="sum" as="tu_nas" table="main" nullif="0" />
        <call group="sum" as="tu_dif_nas_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_test_count_tu_nas" />
          <fact table="prev_week" column="vr_rb_fact_test_count_tu_nas" />
        </call>
        <call group="sum" as="tu_dif_1w" function="-" nullif="0">
          <fact table="main" column="vr_rb_fact_test_count_tu" />
          <fact table="prev_week" column="vr_rb_fact_test_count_tu" />
        </call>
        <call as="tu_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_test_count_tu_0" table="stage2" />
          <fact column="vr_rb_fact_test_count_tu_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_test_count_tu_ul_0" group="sum" as="tu_ul_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test_count_tu_ul_null" group="sum" as="tu_ul_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_test_count_tu_nas_0" group="sum" as="tu_nas_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test_count_tu_nas_null" group="sum" as="tu_nas_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tu_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test_count_tu_ul_0" table="main" />
            <fact column="vr_rb_fact_test_count_tu_ul_null" table="main" />
            <fact column="vr_rb_fact_test_count_tu_nas_0" table="main" />
            <fact column="vr_rb_fact_test_count_tu_nas_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test_count_tu_ul_0" table="prev_week" />
            <fact column="vr_rb_fact_test_count_tu_ul_null" table="prev_week" />
            <fact column="vr_rb_fact_test_count_tu_nas_0" table="prev_week" />
            <fact column="vr_rb_fact_test_count_tu_nas_null" table="prev_week" />
          </call>
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_kod_fl" exclude="1" />
          <link name="d49277_kod_fl_real" as="d49277_kod_fl" />
          <link name="d49277_pwrc" />
          <link name="d49277_fdrid" />
          <link name="kg_name" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_pwrc" column="pwrc_id" />
                <const>(8871, 56215, 342, 78784, 34026, 6665, 59071, 208972)</const>
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <const>(8873, 8874, 8875, 8876, 8872, 56264, 56274, 56276, 56266, 56268, 56269, 56270, 56271, 56272, 56273, 1865, 1866, 1867, 1868, 79387, 79388, 79491, 59181, 59180, 59179, 59177, 59182, 59183, 59184, 382276, 472188, 1229, 6670, 6667, 85354, 85355)</const>
              </call>
            </call>
          </where>
          <dimset as="main">
            <link name="dat" only-for-cond="1" />
            <where exclude="1">
              <call function="gt">
                <column table="dat" column="val" />
                <const>to_date('20180102', 'YYYY.MM.DD')</const>
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <call function="-">
                  <call function="trunc">
                    <call function="sysdate" />
                  </call>
                  <const>7</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="=">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <const>to_date('20180515', 'YYYY.MM.DD')</const>
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <const>DATE'2018-05-31'</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <grset as="ps" title="По сетям" order="pwrcname">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="kg_name" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="49277-yms" timestamp="27.12.2018 18:58:24" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <column table="a" column="ym" type="number" key="1" group="min" />
        <column table="a" column="ym" type="number" group="min" as="name" />
      </select>
      <from>
        <query name="vr_rb_filial" as="a" />
      </from>
    </query>
    <query name="49277-ym_po" timestamp="27.12.2018 18:58:46" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <column table="a" column="ym" type="number" key="1" group="max" />
        <column table="a" column="ym" type="number" group="max" as="name" />
      </select>
      <from>
        <query name="vr_rb_filial" as="a" />
      </from>
    </query>
    <query name="main_49277_32" timestamp="29.05.2021 01:52:32" order="ym_start_analyz, pwrcn, pwrc_fdrname" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <usepart part="49277-params_test2" />
      </params>
      <select>
        <column table="d49277_pwrc" column="pwrcn" group="max" title="ДИСП №ПС" />
        <column table="def_pwrc" column="ym_start_analyz" group="max" />
        <call as="count_fdr" group="count_dist" function="()" type="number">
          <column table="kg_name" column="k_kg_name" />1</call>
        <call as="count_fdr" group="count_dist" function="()" type="number" exclude="1">
          <const exclude="1">1</const>
          <column table="kg_name" column="val" />1</call>
        <column table="d49277_kod_fl_real" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <call function="||-" as="hv_eopwrc_id" exclude="1">
          <column table="this" column="pwrc_id" />
          <column table="this" column="kod_fl" />
        </call>
        <column table="kg_name" column="kg_name_w_real_fdr" title="ДИСП №ФИД" as="pwrc_fdrname" />
        <column table="kg_name" column="k_kg_name" />
        <column table="kg_name" column="val" title="ДИСП №ФИД" as="pwrc_fdrname" exclude="1" />
        <column table="def_pwrc" column="kod_id" group="max" />
        <column table="d49277_fdrid" column="pwrc_fdr_explname" group="stragg_dist" />
        <column table="d49277_kod_fl_real" column="name" as="fskname" group="max" title="ы" />
        <column table="d49277_kod_fl_real" column="ym" as="ym" group="max" title="Отчетный период" />
        <column table="d49277_pwrc" column="pwrcname" group="max" title="ДИСП №ПС" />
        <call as="pwrcname" title="ДИСП №ПС" function="if" group="max" exclude="1">
          <call function="=">
            <column table="d49277_kod_fl_real" column="kod_fl" />
            <const comment="Кабельная сеть">13082</const>
          </call>
          <column table="d49277_pwrc" column="pwrcn" />
          <column table="d49277_pwrc" column="pwrcname" />
        </call>
        <fact column="vr_rb_fact_test2_wp_in_fdr" as="wp_in_st1" group="sum" table="stage1" />
        <fact column="vr_rb_fact_test2_wp_out_fdr" as="wp_out_st1" group="sum" table="stage1" />
        <call function="case" as="neb_st1" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st1" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st1" table="this" />
                    <column column="wp_out_st1" table="this" />
                  </call>
                  <column column="wp_in_st1" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="-" as="neb_st1_kwh" group="outer" nullif="0">
          <column column="wp_in_st1" table="this" />
          <column column="wp_out_st1" table="this" />
        </call>
        <fact column="vr_rb_fact_test2_wp_in_fdr" as="wp_in_st2" group="sum" table="stage2" />
        <fact column="vr_rb_fact_test2_wp_out_fdr" as="wp_out_st2" group="sum" table="stage2" />
        <call function="case" as="neb_st2" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st2" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st2" table="this" />
                    <call function="nvl0">
                      <column column="wp_out_st2" table="this" />
                    </call>
                  </call>
                  <column column="wp_in_st2" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="-" as="neb_st2_kwh" group="outer" nullif="0">
          <column column="wp_in_st2" table="this" />
          <column column="wp_out_st2" table="this" />
        </call>
        <fact column="vr_rb_fact_test2_wp_in_fdr" as="wp_in" group="sum" table="main" nullif="0" exclude="1" />
        <fact column="vr_rb_fact_test2_wp_out_fdr" as="wp_out" group="sum" table="main" nullif="0" exclude="1" />
        <call function="if" as="wp_in" group="sum">
          <call function="and">
            <call function="is null">
              <fact table="main_check_data" column="vr_rb_fact_test2_wp_in_raw_fdr" />
            </call>
            <call function="=0">
              <fact table="main" column="vr_rb_fact_test2_wp_in_fdr" />
            </call>
          </call>
          <call function="null" />
          <fact table="main" column="vr_rb_fact_test2_wp_in_fdr" />
        </call>
        <call function="if" as="wp_out" group="sum">
          <call function="and">
            <call function="is null">
              <fact table="main_check_data" column="vr_rb_fact_test2_wp_out_raw_fdr" />
            </call>
            <call function="=0">
              <fact table="main" column="vr_rb_fact_test2_wp_out_fdr" />
            </call>
          </call>
          <call function="null" />
          <fact table="main" column="vr_rb_fact_test2_wp_out_fdr" />
        </call>
        <call function="case" as="neb" group="outer" nullif="0" exclude="1">
          <call function="when">
            <call function="=0">
              <column column="wp_in" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="/">
                <call function="-">
                  <column column="wp_in" table="this" />
                  <call function="nvl0">
                    <column column="wp_out" table="this" />
                  </call>
                </call>
                <column column="wp_in" table="this" />
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="-" as="neb_kwh" group="outer" nullif="0" exclude="1">
          <column table="this" column="wp_in" />
          <column column="wp_out" table="this" />
        </call>
        <call function="case" as="neb" group="outer">
          <call function="when">
            <call function="or">
              <call function="is null">
                <column column="wp_in" table="this" />
              </call>
              <call function="is null">
                <column column="wp_out" table="this" />
              </call>
              <call function="=0">
                <column column="wp_in" table="this" />
              </call>
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="/">
                <call function="-">
                  <column column="wp_in" table="this" />
                  <call function="nvl0">
                    <column column="wp_out" table="this" />
                  </call>
                </call>
                <column column="wp_in" table="this" />
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="case" as="neb_kwh" group="outer">
          <call function="when">
            <call function="or">
              <call function="is null">
                <column column="wp_in" table="this" />
              </call>
              <call function="is null">
                <column column="wp_out" table="this" />
              </call>
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="-">
              <column table="this" column="wp_in" />
              <column column="wp_out" table="this" />
            </call>
          </call>
        </call>
        <fact table="stage2" column="vr_rb_fact_test2_count_tp" group="sum" as="tp_st2" nullif="0" />
        <fact table="main" column="vr_rb_fact_test2_count_tp_le" group="sum" as="tp_le" nullif="0" />
        <fact table="main" column="vr_rb_fact_test2_count_tp_potr" group="sum" as="tp_potr" nullif="0" />
        <call group="sum" as="tp_dif_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_test2_count_tp" />
          <fact table="prev_week" column="vr_rb_fact_test2_count_tp" />
        </call>
        <call as="tp_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_test2_count_tp_0" table="stage2" />
          <fact column="vr_rb_fact_test2_count_tp_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_test2_count_tp_le_0null" group="sum" as="tp_le_0null" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tp_potr_0" group="sum" as="tp_potr_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tp_potr_null" group="sum" as="tp_potr_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tp_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tp_le_0null" table="main" />
            <fact column="vr_rb_fact_test2_count_tp_potr_0" table="main" />
            <fact column="vr_rb_fact_test2_count_tp_potr_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tp_le_0null" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tp_potr_0" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tp_potr_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_test2_count_tu_ul" group="sum" as="tu_ul_st2" table="stage2" nullif="0" />
        <call group="sum" as="tu_dif_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_test2_count_tu" />
          <fact table="prev_week" column="vr_rb_fact_test2_count_tu" />
        </call>
        <fact column="vr_rb_fact_test2_count_tu_nas" group="sum" as="tu_nas_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_ul" group="sum" as="tu_ul" table="main" nullif="0" />
        <call group="sum" as="tu_dif_ul_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_test2_count_tu_ul" />
          <fact table="prev_week" column="vr_rb_fact_test2_count_tu_ul" />
        </call>
        <fact column="vr_rb_fact_test2_count_tu_mkd" group="sum" as="tu_mkd" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs" group="sum" as="tu_izs" table="main" nullif="0" />
        <call group="sum" as="tu_dif_nas_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_test2_count_tu_nas" />
          <fact table="prev_week" column="vr_rb_fact_test2_count_tu_nas" />
        </call>
        <call as="tu_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_test2_count_tu_0" table="stage2" />
          <fact column="vr_rb_fact_test2_count_tu_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_test2_count_tu_ul_0" group="sum" as="tu_ul_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_ul_null" group="sum" as="tu_ul_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_mkd_0" group="sum" as="tu_mkd_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs_0" group="sum" as="tu_izs_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_mkd_null" group="sum" as="tu_mkd_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs_null" group="sum" as="tu_izs_null" table="main" nullif="0" />
        <call function="-" group="sum" as="tu_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_0" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_ul_null" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_0" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_izs_0" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_null" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_izs_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_0" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_ul_null" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_0" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_izs_0" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_null" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_izs_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_test2_count_tu_ul_auto" group="sum" as="tu_ul_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_mkd_auto" group="sum" as="tu_mkd_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs_auto" group="sum" as="tu_izs_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_ul_hand" group="sum" as="tu_ul_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_mkd_hand" group="sum" as="tu_mkd_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs_hand" group="sum" as="tu_izs_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_ul_no" group="sum" as="tu_ul_no" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_mkd_no" group="sum" as="tu_mkd_no" table="main" nullif="0" />
        <fact column="vr_rb_fact_test2_count_tu_izs_no" group="sum" as="tu_izs_no" table="main" nullif="0" />
        <call function="-" group="sum" as="tu_auto_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_auto" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_auto" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_izs_auto" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_auto" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_auto" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_izs_auto" table="prev_week" />
          </call>
        </call>
        <call function="-" group="sum" as="tu_hand_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_hand" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_hand" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_izs_hand" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_hand" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_hand" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_izs_hand" table="prev_week" />
          </call>
        </call>
        <call function="-" group="sum" as="tu_no_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_no" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_no" table="main" />
            <fact column="vr_rb_fact_test2_count_tu_izs_no" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_test2_count_tu_ul_no" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_mkd_no" table="prev_week" />
            <fact column="vr_rb_fact_test2_count_tu_izs_no" table="prev_week" />
          </call>
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_kod_fl_real" />
          <link name="d49277_pwrc" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <link name="d49277_fdrid" />
          <link name="kg_name" />
          <link name="def_pwrc" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_kod_fl_real" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in" exclude="1">
                <column table="d49277_pwrc" column="pwrc_id" />
                <useparam name="pwrc_id" />
              </call>
              <call function="in" exclude="1">
                <column table="this" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
              <call function="in" exclude="1">
                <column table="d49277_pwrc" column="pwrc_id" />
                <const>(8871, 56215, 342, 78784, 34026, 6665, 59071, 208972)</const>
              </call>
              <call function="in" exclude="1">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <const>(8873, 8874, 8875, 8876, 8872, 56264, 56274, 56276, 56266, 56268, 56269, 56270, 56271, 56272, 56273, 1865, 1866, 1867, 1868, 79387, 79388, 79491, 59181, 59180, 59179, 59177, 59182, 59183, 59184, 382276, 472188, 1229, 6670, 6667, 85354, 85355)</const>
              </call>
            </call>
          </where>
          <dimset as="main">
            <link name="id_dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="nvl0">
                  <column table="id_dat" column="id_dat" />
                </call>
                <useparam name="id_dat" />
              </call>
            </where>
          </dimset>
          <dimset as="main_check_data">
            <link name="ym" only-for-cond="1" />
            <link name="id_dat" only-for-cond="1" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="ym" column="val" />
                  <column table="d49277_kod_fl_real" column="ym" />
                </call>
                <call function="le">
                  <call function="nvl0">
                    <column table="id_dat" column="id_dat" />
                  </call>
                  <useparam name="id_dat" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <call function="trunc">
                  <useparam name="prev_slice_dat" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage1" />
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage2" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <sourcelink table="d49277_kod_fl_real" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="(case when (SUBSTR( k_kg_name, 1 , 1) != '-') then 1 end) nulls last, pwrc_fdrname nulls first">
              <group>
                <sourcelink table="kg_name" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="49277-dats" timestamp="06.03.2019 13:15:04" order="dat desc" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <column table="a" column="id_dat" key="1" as="id" />
        <call function="to_char" as="num_week" title="Номер недели" is-name="1" vid="1">
          <column table="a" column="dat" />
          <const>'ww'</const>
        </call>
        <column table="a" column="dat" as="name" title="Дата снимка данных" vid="1" is-name="1" format="dd.MM.yyyy HH:mm" />
      </select>
      <from>
        <query name="vr_rb_dat" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="is_result" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="49277_51730-dat_by_id" timestamp="28.04.2022 15:20:16" order="a.ym desc" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <select>
        <column table="a" column="ym" group="1" key="1" />
        <call as="name" function="to_char" group="1">
          <column table="a" column="ym" />
          <const>'9999.99'</const>
        </call>
      </select>
      <from>
        <query name="vr_rb_fact_mv" as="a" />
      </from>
      <where>
        <call function="!=">
          <column table="a" column="ym" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="main_49277_31" order="ym_start_analyz, pwrcn, pwrc_fdrname" timestamp="25.01.2023 22:42:13" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="stage3" type="number">
          <const exclude="1">2020.12</const>
        </param>
        <param name="kod_fl" type="array">
          <array exclude="1">
            <const>12966</const>
          </array>
        </param>
        <param name="hv_eopwrc_id" type="array">
          <array exclude="1">
            <const>'56215-12966'</const>
          </array>
        </param>
        <param name="pwrc_id" type="array">
          <array exclude="1">
            <const>56215</const>
          </array>
        </param>
        <param name="k_kg_name" type="array">
          <array exclude="1">
            <const>'-220294-'</const>
          </array>
        </param>
        <param name="pwrc_fdrid" type="array">
          <array exclude="1">
            <const>56271</const>
            <const>56268</const>
          </array>
        </param>
      </params>
      <select>
        <column as="count_fdr" group="count_dist" function="()" type="number" table="a" column="count_fdr">1</column>
        <column table="a" column="kod_fl" />
        <column table="a" column="pwrc_id" />
        <column table="a" column="pwrc_fdrname" title="ДИСП №ФИД" as="pwrc_fdrname" />
        <column table="a" column="k_kg_name" />
        <column table="a" column="kod_id" group="max" />
        <column table="a" column="ym_start_analyz" group="max" />
        <column table="a" column="pwrc_fdr_explname" group="stragg_dist" />
        <column table="a" column="fskname" as="fskname" group="max" />
        <column table="a" column="ym" as="ym" group="max" title="Отчетный период" />
        <column table="a" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="a" column="pwrcn" group="max" title="ДИСП №ПС" />
        <column column="wp_in_st1" as="wp_in_st1" group="sum" table="a" />
        <column column="wp_out_st1" as="wp_out_st1" group="sum" table="a" />
        <call function="case" as="neb_st1" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st1" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st1" table="this" />
                    <column column="wp_out_st1" table="this" />
                  </call>
                  <column column="wp_in_st1" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="-" as="neb_st1_kwh" group="outer" nullif="0">
          <column column="wp_in_st1" table="this" />
          <column column="wp_out_st1" table="this" />
        </call>
        <column column="wp_in_st2" as="wp_in_st2" group="sum" table="a" />
        <column column="wp_out_st2" as="wp_out_st2" group="sum" table="a" />
        <call function="case" as="neb_st2" group="outer" nullif="0">
          <call function="when">
            <call function="=0">
              <column column="wp_in_st2" table="this" />
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in_st2" table="this" />
                    <call function="nvl0">
                      <column column="wp_out_st2" table="this" />
                    </call>
                  </call>
                  <column column="wp_in_st2" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="-" as="neb_st2_kwh" group="outer" nullif="0">
          <column column="wp_in_st2" table="this" />
          <column column="wp_out_st2" table="this" />
        </call>
        <column function="if" as="wp_in" group="sum" table="a" column="wp_in" />
        <column function="if" as="wp_out" group="sum" table="a" column="wp_out" />
        <call function="case" as="neb" group="outer">
          <call function="when">
            <call function="or">
              <call function="is null">
                <column column="wp_in" table="this" />
              </call>
              <call function="is null">
                <column column="wp_out" table="this" />
              </call>
              <call function="=0">
                <column column="wp_in" table="this" />
              </call>
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="/">
                <call function="-">
                  <column column="wp_in" table="this" />
                  <call function="nvl0">
                    <column column="wp_out" table="this" />
                  </call>
                </call>
                <column column="wp_in" table="this" />
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <call function="case" as="neb_kwh" group="outer">
          <call function="when">
            <call function="or">
              <call function="is null">
                <column column="wp_in" table="this" />
              </call>
              <call function="is null">
                <column column="wp_out" table="this" />
              </call>
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="-">
              <column table="this" column="wp_in" />
              <column column="wp_out" table="this" />
            </call>
          </call>
        </call>
        <column table="a" column="tp_st2" group="sum" as="tp_st2" nullif="0" />
        <column table="a" column="tp_le" group="sum" as="tp_le" nullif="0" />
        <column table="a" column="tp_potr" group="sum" as="tp_potr" nullif="0" />
        <column group="sum" as="tp_dif_1w" function="-nvl" nullif="0" table="a" column="tp_dif_1w" />
        <column as="tp_0null_st2" function="+" group="sum" nullif="0" table="a" column="tp_0null_st2" />
        <column column="tp_le_0null" group="sum" as="tp_le_0null" table="a" nullif="0" />
        <column column="tp_potr_0" group="sum" as="tp_potr_0" table="a" nullif="0" />
        <column column="tp_potr_null" group="sum" as="tp_potr_null" table="a" nullif="0" />
        <column function="-" group="sum" as="tp_0null_dif_1w" nullif="0" table="a" column="tp_0null_dif_1w" />
        <column column="tu_ul_st2" group="sum" as="tu_ul_st2" table="a" nullif="0" />
        <column group="sum" as="tu_dif_1w" function="-nvl" nullif="0" table="a" column="tu_dif_1w" />
        <column column="tu_nas_st2" group="sum" as="tu_nas_st2" table="a" nullif="0" />
        <column column="tu_ul" group="sum" as="tu_ul" table="a" nullif="0" />
        <column group="sum" as="tu_dif_ul_1w" function="-nvl" nullif="0" table="a" column="tu_dif_ul_1w" />
        <column column="tu_mkd" group="sum" as="tu_mkd" table="a" nullif="0" />
        <column column="tu_izs" group="sum" as="tu_izs" table="a" nullif="0" />
        <column group="sum" as="tu_dif_nas_1w" function="-nvl" nullif="0" table="a" column="tu_dif_nas_1w" />
        <column as="tu_0null_st2" function="+" group="sum" nullif="0" table="a" column="tu_0null_st2" />
        <column column="tu_ul_0" group="sum" as="tu_ul_0" table="a" nullif="0" />
        <column column="tu_ul_null" group="sum" as="tu_ul_null" table="a" nullif="0" />
        <column column="tu_mkd_0" group="sum" as="tu_mkd_0" table="a" nullif="0" />
        <column column="tu_izs_0" group="sum" as="tu_izs_0" table="a" nullif="0" />
        <column column="tu_mkd_null" group="sum" as="tu_mkd_null" table="a" nullif="0" />
        <column column="tu_izs_null" group="sum" as="tu_izs_null" table="a" nullif="0" />
        <column function="-" group="sum" as="tu_0null_dif_1w" nullif="0" table="a" column="tu_0null_dif_1w" />
        <column column="tu_ul_auto" group="sum" as="tu_ul_auto" table="a" nullif="0" />
        <column column="tu_mkd_auto" group="sum" as="tu_mkd_auto" table="a" nullif="0" />
        <column column="tu_izs_auto" group="sum" as="tu_izs_auto" table="a" nullif="0" />
        <column column="tu_ul_hand" group="sum" as="tu_ul_hand" table="a" nullif="0" />
        <column column="tu_mkd_hand" group="sum" as="tu_mkd_hand" table="a" nullif="0" />
        <column column="tu_izs_hand" group="sum" as="tu_izs_hand" table="a" nullif="0" />
        <column column="tu_ul_no" group="sum" as="tu_ul_no" table="a" nullif="0" />
        <column column="tu_mkd_no" group="sum" as="tu_mkd_no" table="a" nullif="0" />
        <column column="tu_izs_no" group="sum" as="tu_izs_no" table="a" nullif="0" />
        <column function="-" group="sum" as="tu_auto_dif_1w" nullif="0" table="a" column="tu_auto_dif_1w" />
        <column function="-" group="sum" as="tu_hand_dif_1w" nullif="0" table="a" column="tu_hand_dif_1w" />
        <column function="-" group="sum" as="tu_no_dif_1w" nullif="0" table="a" column="tu_no_dif_1w" />
      </select>
      <from>
        <query name="hv_report_31_main" as="a" />
        <qube star-scheme="1" exclude="1">
          <link name="d49277_kod_fl_real" />
          <link name="d49277_pwrc" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <link name="d49277_fdrid" />
          <link name="kg_name" />
          <link name="def_pwrc" />
          <link name="def_fdr" />
          <where>
            <call function="and">
              <call function="in">
                <column table="def_fdr" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
              <call function="in">
                <column table="d49277_kod_fl_real" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
            </call>
          </where>
          <dimset as="main">
            <link name="ym" only-for-cond="1" />
            <where>
              <call function="=">
                <column table="ym" column="val" />
                <useparam name="stage3" />
              </call>
            </where>
          </dimset>
          <dimset as="main_check_data">
            <link name="ym" only-for-cond="1" />
            <where>
              <call function="=">
                <column table="ym" column="val" />
                <useparam name="stage3" />
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="ym" only-for-cond="1" />
            <where>
              <call function="=">
                <column table="ym" column="val" />
                <call function="ym add month">
                  <useparam name="stage3" />
                  <const>-1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="=">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage1" />
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="=">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage2" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <column table="a" column="kod_fl" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <column table="a" column="pwrc_id" />
            </group>
            <grset as="fdr" title="По фидерам" order="(case when (SUBSTR( k_kg_name, 1 , 1) != '-') then 1 end) nulls last, pwrc_fdrname nulls first">
              <group>
                <column table="a" column="k_kg_name" />
                <column table="a" column="pwrc_fdrname" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="title_49277_test3" timestamp="13.12.2022 18:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="stage3" type="number">
          <const exclude="1">2020.12</const>
        </param>
        <param name="kod_fl" type="array">
          <array exclude="1">
            <const>12966</const>
          </array>
        </param>
        <param name="hv_eopwrc_id" type="array">
          <array exclude="1">
            <const>'56215-12966'</const>
          </array>
        </param>
        <param name="pwrc_id" type="array">
          <array exclude="1">
            <const>56215</const>
          </array>
        </param>
        <param name="k_kg_name" type="array">
          <array exclude="1">
            <const>'-220294-'</const>
          </array>
        </param>
        <param name="pwrc_fdrid" type="array">
          <array exclude="1">
            <const>56271</const>
            <const>56268</const>
          </array>
        </param>
      </params>
      <select>
        <call function="trunc" as="dat_otch" type="date">
          <call function="sysdate" />
        </call>
        <call function="to_char" as="num_week">
          <call function="-">
            <call function="sysdate" />
            <const>7</const>
          </call>
          <const>'ww'</const>
        </call>
        <call as="ym" function="()" type="number">
          <useparam name="stage3" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="49277_pwrc_def_test2" class="1" timestamp="11.04.2019 17:58:10" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="id_dat" type="number" />
      </params>
      <procedure>
        <text>
        BEGIN
            sqlb_d45862_fdr_kg.fill_table_fl_ym(greatest(0{,:id_dat}));
        END;
</text>
      </procedure>
      <select>
        <column table="pwrc_id" column="hv_eopwrc_id" />
        <column table="pwrc_id" column="pwrcn" />
        <column table="a" column="pwrc_id" type="number" title="" />
      </select>
      <from>
        <query name="vb_rb_default_pwrc" as="a">
          <link name="pwrc_id" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="kod_fl" />
            <useparam name="kod_fl" />
          </call>
          <call function="=">
            <column table="a" column="kod_fl" />
            <column table="pwrc_id" column="bal_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="49277_init_filial_test2" class="1" timestamp="25.02.2019 21:34:21" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="id_dat" type="number" />
      </params>
      <procedure>
        <text>
        BEGIN
            sqlb_d45862_fdr_kg.fill_table_fl_ym(:id_dat);
        END;
    </text>
      </procedure>
      <select>
        <call function="()" type="number" as="val">
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <useparam name="kod_fl" />
          </call>
          <call function="is not null">
            <useparam name="id_dat" />
          </call>
        </call>
      </where>
    </query>
    <query name="49277_pwrc_def_test3" class="1" timestamp="11.04.2019 18:03:14" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="stage3" type="number" />
      </params>
      <procedure>
        <text>
    BEGIN
        sqlb_d45862_fdr_kg.fill_table_fl_ym_by_ym(greatest(0{,:stage3}));
    END;
</text>
      </procedure>
      <select>
        <column table="pwrc_id" column="hv_eopwrc_id" />
        <column table="pwrc_id" column="pwrcn" />
        <column table="a" column="pwrc_id" type="number" />
      </select>
      <from>
        <query name="vb_rb_default_pwrc" as="a">
          <link name="pwrc_id" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="kod_fl" />
            <useparam name="kod_fl" />
          </call>
          <call function="=">
            <column table="a" column="kod_fl" />
            <column table="pwrc_id" column="bal_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="49277-week_num" timestamp="06.03.2019 11:45:09" order="dat desc" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="id_dat" type="number" />
      </params>
      <select>
        <call function="to_char" as="num_week" title="Номер недели">
          <column table="a" column="dat" />
          <const>'ww'</const>
        </call>
      </select>
      <from>
        <query name="vr_rb_dat" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_dat" />
          <useparam name="id_dat" />
        </call>
      </where>
    </query>
    <query name="49277-dat_slice_week_before" timestamp="01.10.2020 18:16:00" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="id_dat" type="number" />
      </params>
      <select>
        <call function="nvl" as="prev_slice_dat">
          <call function="max">
            <column table="vr_rb_dat_prev" column="dat" />
          </call>
          <call function="nativity" />
        </call>
      </select>
      <from>
        <query name="vr_rb_dat" as="vr_rb_dat_cur" />
        <query name="vr_rb_dat" as="vr_rb_dat_prev" join="left outer">
          <call function="and">
            <call function="le">
              <call function="trunc">
                <column table="vr_rb_dat_prev" column="dat" />
              </call>
              <call function="-">
                <call function="trunc">
                  <column table="vr_rb_dat_cur" column="dat" />
                </call>
                <const>7</const>
              </call>
            </call>
            <call function="=">
              <column table="vr_rb_dat_prev" column="is_result" />
              <const>0</const>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="vr_rb_dat_cur" column="id_dat" />
          <useparam name="id_dat" />
        </call>
      </where>
    </query>
    <query name="main_49277_32_without_kg" timestamp="13.10.2020 23:37:15" order="ym_start_analyz, pwrcn, pwrc_fdrname" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <usepart part="49277-params_test2" />
      </params>
      <select>
        <column table="d49277_kod_fl_real" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <column table="d49277_kod_fl_real" column="ym" />
        <column table="d49277_pwrc" column="pwrcname" />
        <column table="d49277_fdrid" column="pwrc_fdrid" />
        <column table="d49277_fdrid" column="pwrc_fdr_explname" />
        <column table="d49277_fdrid" column="pwrc_fdrname" />
        <column table="d49277_kod_fl_real" column="name" as="fskname" />
        <column table="d49277_pwrc" column="pwrcn" group="max" title="ДИСП №ПС" />
        <column table="def_pwrc" column="ym_start_analyz" group="max" />
        <column table="def_pwrc" column="kod_id" group="max" />
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul" table="main" nullif="0" />
        <call group="sum" as="tu_dif_ul_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_ul" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_ul" />
        </call>
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas" table="main" nullif="0" />
        <call group="sum" as="tu_dif_nas_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_nas" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_nas" />
        </call>
        <call group="sum" as="tu_dif_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu" />
          <fact table="prev_week" column="vr_rb_fact_count_tu" />
        </call>
        <call as="tu_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_count_tu_0" table="stage2" />
          <fact column="vr_rb_fact_count_tu_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_count_tu_ul_0" group="sum" as="tu_ul_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_null" group="sum" as="tu_ul_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_0" group="sum" as="tu_nas_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_null" group="sum" as="tu_nas_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd" group="sum" as="tu_mkd" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_0" group="sum" as="tu_mkd_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_null" group="sum" as="tu_mkd_null" table="main" nullif="0" />
        <call function="-nvl" group="sum" as="tu_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="main" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_0" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_0" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_null" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_null" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_count_tu_mkd_auto" group="sum" as="tu_mkd_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_hand" group="sum" as="tu_mkd_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_no" group="sum" as="tu_mkd_no" table="main" nullif="0" />
        <call function="-nvl" group="sum" as="tu_auto_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_auto" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_auto" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_auto" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_auto" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_auto" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_auto" table="prev_week" />
          </call>
        </call>
        <call function="-nvl" group="sum" as="tu_hand_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_hand" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_hand" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_hand" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_hand" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_hand" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_hand" table="prev_week" />
          </call>
        </call>
        <call function="-nvl" group="sum" as="tu_no_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_no" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_no" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_no" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_no" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_no" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_no" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_count_tu_izs" group="sum" as="tu_izs" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_0" group="sum" as="tu_izs_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_null" group="sum" as="tu_izs_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_auto" group="sum" as="tu_izs_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_hand" group="sum" as="tu_izs_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_no" group="sum" as="tu_izs_no" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_auto" group="sum" as="tu_ul_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_hand" group="sum" as="tu_ul_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_no" group="sum" as="tu_ul_no" table="main" nullif="0" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_pwrc" />
          <link name="d49277_fdrid" />
          <link name="def_pwrc" />
          <link name="d49277_kod_fl_real" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_kod_fl_real" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in" exclude="1">
                <column table="d49277_pwrc" column="pwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
            </call>
          </where>
          <dimset as="main">
            <link name="id_dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="nvl0">
                  <column table="id_dat" column="id_dat" />
                </call>
                <useparam name="id_dat" />
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <call function="trunc">
                  <useparam name="prev_slice_dat" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage1" />
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage2" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <sourcelink table="d49277_kod_fl_real" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="d49277_fdrid" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="main_49277_31_without_kg" order="ym_start_analyz, pwrcn, pwrc_fdrname" timestamp="25.01.2023 14:20:02" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="stage3" type="number">
          <const exclude="1">2020.12</const>
        </param>
        <param name="kod_fl" type="array">
          <array exclude="1">
            <const>12966</const>
          </array>
        </param>
        <param name="hv_eopwrc_id" type="array">
          <array exclude="1">
            <const>'56215-12966'</const>
          </array>
        </param>
        <param name="pwrc_id" type="array">
          <array exclude="1">
            <const>56215</const>
          </array>
        </param>
        <param name="k_kg_name" type="array">
          <array exclude="1">
            <const>'-220294-'</const>
          </array>
        </param>
        <param name="pwrc_fdrid" type="array">
          <array exclude="1">
            <const>56271</const>
            <const>56268</const>
          </array>
        </param>
      </params>
      <select>
        <column table="d49277_kod_fl_real" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <column table="d49277_kod_fl_real" column="ym" />
        <column table="d49277_pwrc" column="pwrcname" />
        <column table="d49277_fdrid" column="pwrc_fdrid" />
        <column table="d49277_fdrid" column="pwrc_fdr_explname" />
        <column table="d49277_fdrid" column="pwrc_fdrname" />
        <column table="d49277_kod_fl_real" column="name" as="fskname" />
        <column table="d49277_pwrc" column="pwrcn" group="max" title="ДИСП №ПС" />
        <column table="def_pwrc" column="ym_start_analyz" group="max" />
        <column table="def_pwrc" column="kod_id" group="max" />
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas_st2" table="stage2" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul" group="sum" as="tu_ul" table="main" nullif="0" />
        <call group="sum" as="tu_dif_ul_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_ul" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_ul" />
        </call>
        <fact column="vr_rb_fact_count_tu_nas" group="sum" as="tu_nas" table="main" nullif="0" />
        <call group="sum" as="tu_dif_nas_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu_nas" />
          <fact table="prev_week" column="vr_rb_fact_count_tu_nas" />
        </call>
        <call group="sum" as="tu_dif_1w" function="-nvl" nullif="0">
          <fact table="main" column="vr_rb_fact_count_tu" />
          <fact table="prev_week" column="vr_rb_fact_count_tu" />
        </call>
        <call as="tu_0null_st2" function="+" group="sum" nullif="0">
          <fact column="vr_rb_fact_count_tu_0" table="stage2" />
          <fact column="vr_rb_fact_count_tu_null" table="stage2" />
        </call>
        <fact column="vr_rb_fact_count_tu_ul_0" group="sum" as="tu_ul_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_null" group="sum" as="tu_ul_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_0" group="sum" as="tu_nas_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_nas_null" group="sum" as="tu_nas_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd" group="sum" as="tu_mkd" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_0" group="sum" as="tu_mkd_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_null" group="sum" as="tu_mkd_null" table="main" nullif="0" />
        <call function="-nvl" group="sum" as="tu_0null_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="main" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_0" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_0" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_null" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_null" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_ul_null" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_0" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_null" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_null" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_count_tu_mkd_auto" group="sum" as="tu_mkd_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_hand" group="sum" as="tu_mkd_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_mkd_no" group="sum" as="tu_mkd_no" table="main" nullif="0" />
        <call function="-nvl" group="sum" as="tu_auto_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_auto" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_auto" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_auto" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_auto" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_auto" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_auto" table="prev_week" />
          </call>
        </call>
        <call function="-nvl" group="sum" as="tu_hand_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_hand" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_hand" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_hand" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_hand" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_hand" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_hand" table="prev_week" />
          </call>
        </call>
        <call function="-nvl" group="sum" as="tu_no_dif_1w" nullif="0">
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_no" table="main" />
            <fact column="vr_rb_fact_count_tu_mkd_no" table="main" />
            <fact column="vr_rb_fact_count_tu_izs_no" table="main" />
          </call>
          <call function="+nvl">
            <fact column="vr_rb_fact_count_tu_ul_no" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_mkd_no" table="prev_week" />
            <fact column="vr_rb_fact_count_tu_izs_no" table="prev_week" />
          </call>
        </call>
        <fact column="vr_rb_fact_count_tu_izs" group="sum" as="tu_izs" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_0" group="sum" as="tu_izs_0" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_null" group="sum" as="tu_izs_null" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_auto" group="sum" as="tu_izs_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_hand" group="sum" as="tu_izs_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_izs_no" group="sum" as="tu_izs_no" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_auto" group="sum" as="tu_ul_auto" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_hand" group="sum" as="tu_ul_hand" table="main" nullif="0" />
        <fact column="vr_rb_fact_count_tu_ul_no" group="sum" as="tu_ul_no" table="main" nullif="0" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_pwrc" />
          <link name="d49277_fdrid" />
          <link name="def_pwrc" />
          <link name="d49277_kod_fl_real" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <link name="def_fdr" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_kod_fl_real" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
              <call function="in">
                <column table="def_fdr" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
            </call>
          </where>
          <dimset as="main" exclude="1">
            <link name="id_dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="nvl0">
                  <column table="id_dat" column="id_dat" />
                </call>
                <useparam name="id_dat" />
              </call>
            </where>
          </dimset>
          <dimset as="main">
            <link name="ym" only-for-cond="1" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <useparam name="stage3" />
              </call>
            </where>
          </dimset>
          <dimset as="prev_week" exclude="1">
            <link name="dat" only-for-cond="1" />
            <where>
              <call function="le">
                <call function="trunc">
                  <column table="dat" column="val" />
                </call>
                <call function="trunc">
                  <useparam name="prev_slice_dat" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="prev_week">
            <link name="ym" only-for-cond="1" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <call function="ym add month">
                  <useparam name="stage3" />
                  <const>-1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="stage1">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage1" />
              </call>
            </where>
          </dimset>
          <dimset as="stage2">
            <link only-for-cond="1" name="ym" />
            <where>
              <call function="le">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="stage2" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="upper(fskname)">
          <group>
            <sourcelink table="d49277_kod_fl_real" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="d49277_fdrid" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="52104_balanse_tu_detail" class="1" timestamp="28.04.2022 15:35:40" is-report="1" mode="excel" title="4. Отчет о загрузке данных в БД ИСЭ по потребителям в рамках пофидерного анализа" file="sql.builder.templates\sql.builder\projects\49277\reports\52104_rep.xml">
      <procedure>
        <text>
        BEGIN
            JG_REPORTS_ISE.jr_rep_blns_pwrc_fdrs_trunc;
            
            for fl in (select * from jv_rep_cons_d_fl where kod_fl in :kod_fl)
            loop
                JG_REPORTS_ISE.jr_rep_blns_pwrc_fdrs_init(:stage3, fl.kod_fl, 0);
            end loop;
                
            delete from rr_temp where skod = '45862_fdr_lst';
            insert into rr_temp (skod, n1)
            select distinct '45862_fdr_lst' as skod, a.pwrc_fdrid
            from vr_rb_fider a
            where a.pwrc_fdrid in :pwrc_fdrid;
                
            jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);
            sqlb_d45862_fdr_kg.FILL_TEMP(:stage3, :stage3, 0);
            sqlb_d45862_fdr_kg.fill_table_by_dat(0);
        END;
    </text>
      </procedure>
      <content>
        <usefield field="cmn_combo_num" title="Отчетный период" name="stage3" column-mandatory="1">
          <listquery>
            <query name="45862-yms" />
          </listquery>
          <defaultquery>
            <query name="45862-ym-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Филиал" name="kod_fl" column-mandatory="1" type="number">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
          <defaultquery>
            <query name="45862-kod_fl-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="hv_eopwrc_id" type="string" column-mandatory="1">
          <listquery>
            <query name="hv_eopwrc_list_test2" />
          </listquery>
          <defaultquery>
            <query name="49277_pwrc_def_test3" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1" column-visible="0">
          <listquery>
            <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
          </listquery>
          <defaultquery>
            <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры" name="k_kg_name" type="string" column-mandatory="1">
          <listquery>
            <query name="45862_kg_name_list_test2" />
          </listquery>
          <defaultquery>
            <query name="45862_kg_name_default_test2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры без КГ" name="pwrc_fdrid" type="number" column-visible="0">
          <listquery>
            <query name="45862_fdr_by_kn_name_list_test2" />
          </listquery>
          <defaultquery>
            <query name="45862_fdr_by_kn_name_list_test2" />
          </defaultquery>
        </usefield>
      </content>
      <print-templates>
        <excel>
          <template name="52104.xlsx" title="Отчет о загрузке данных в БД ИСЭ по потребителям в рамках пофидерного анализа" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <select>
        <call as="idid" function="rownum" key="1" />
        <column table="a" column="*" />
        <call as="engway_mod" function="case">
          <call function="when">
            <call function="=">
              <column table="a" column="engway" />
              <const>'АВТ'</const>
            </call>
            <const>'ИМПОРТ'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="engway" />
              <const>'РУЧН'</const>
            </call>
            <const>'РУЧН.'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="engway" />
              <const>'-'</const>
            </call>
            <const>'ОТСУТ.'</const>
          </call>
        </call>
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <call as="kg_name_all" function="if">
          <call function="=">
            <column table="a" column="kod_outeris" />
            <const comment="7 - строки с информацией об отпуске фидера">7</const>
          </call>
          <column table="k_kg_name" column="kg_name" />
          <column table="k_gr_f_tp" column="kg_name" />
        </call>
        <call as="kg_name" type="string" function="if">
          <call function="!=">
            <column table="this" column="pwrc_fdrname" />
            <column table="this" column="kg_name_all" />
          </call>
          <column table="this" column="kg_name_all" />
        </call>
        <call as="hv_eopwrc_id" function="||-">
          <column table="this" column="pwrc_id" />
          <column table="this" column="bal_id" />
        </call>
        <call as="wp_out_fdr" function="if" type="number">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <call function="=" exclude="1">
            <column table="a" column="kod_outeris" />
            <const comment="7 - строки с информацией об отпуске фидера">7</const>
          </call>
          <call function="over">
            <call function="sum">
              <column table="a" column="wp_out" />
              <call function="if" exclude="1">
                <call function="=">
                  <column table="a" column="kod_outeris" />
                  <const>6</const>
                </call>
                <column table="a" column="wp_out" />
                <const>0</const>
              </call>
            </call>
            <call function="partition by">
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <column table="a" column="wp_out" />
        </call>
        <call as="constype_fdr" function="if">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <call function="null" />
          <column table="a" column="constype" />
        </call>
        <call as="constypex_fdr" function="if">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <call function="null" />
          <column table="a" column="constypex" />
        </call>
        <call as="poteri" type="number" function="if">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <call function="-">
            <column table="this" column="wp_in" />
            <column table="this" column="wp_out_fdr" />
          </call>
        </call>
        <call function="case" as="nebalans" nullif="0" type="number">
          <call function="when">
            <call function="or">
              <call function="=0">
                <column column="wp_in" table="this" />
              </call>
              <call function="!=">
                <call function="nvl0">
                  <column table="a" column="gr" />
                </call>
                <const>1</const>
              </call>
            </call>
            <call function="null" />
          </call>
          <call function="else">
            <call function="*">
              <call function="round">
                <call function="/">
                  <call function="-">
                    <column column="wp_in" table="this" />
                    <column column="wp_out_fdr" table="this" />
                  </call>
                  <column column="wp_in" table="this" />
                </call>
                <const>6</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="jr_rep_blns_pwrc_fdrs" as="a" />
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="hv_eopwrc_grid_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
              <call function="replace" exclude="1">
                <column table="k_gr_f_tp" column="ym" />
                <const>9999.99</const>
                <column table="this" column="ym" />
              </call>
            </call>
            <call function="!=">
              <column table="a" column="kod_outeris" />
              <const comment="7 - строки с информацией об отпуске фидера">7</const>
            </call>
          </call>
        </query>
        <query name="52104_fdr_kg" as="k_kg_name" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="pwrc_fdrid" />
              <column table="k_kg_name" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_kg_name" column="ym" />
            </call>
            <call function="=">
              <column table="a" column="kod_outeris" />
              <const comment="7 - строки с информацией об отпуске фидера">7</const>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=" exclude="1">
            <column table="a" column="kod_outeris" />
            <const comment="7 - строки с информацией об отпуске фидера">7</const>
          </call>
          <call function="in">
            <column table="a" column="pwrc_fdrid" />
            <useparam name="pwrc_fdrid" />
          </call>
          <call function="in">
            <column table="this" column="hv_eopwrc_id" />
            <useparam name="hv_eopwrc_id" />
          </call>
          <call function="not">
            <call function="and">
              <call function="=">
                <column table="a" column="kod_outeris" />
                <const>7</const>
              </call>
              <call function="=">
                <call function="nvl0">
                  <column column="exclude_auto_fdr" table="k_kg_name" />
                </call>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="52104_fdr_kg" class="1" timestamp="09.09.2019 13:37:33" file="sql.builder.templates\sql.builder\projects\49277\reports\52104_rep.xml">
      <select>
        <column table="a" column="k_kg_name" group="1" />
        <column table="a" column="kg_name" group="1" />
        <column table="a" column="pwrc_fdrid" group="1" />
        <column table="a" column="ym" group="1" />
        <column table="a" column="exclude_auto_fdr" group="1" />
      </select>
      <from>
        <query name="d45862_fdr_kg" as="a" />
      </from>
    </query>
    <query name="52733_year" order="year desc" timestamp="03.10.2022 14:40:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <select>
        <call function="year" as="year" key="1" group="1">
          <column table="a" column="dat" />
        </call>
        <call function="to_char" as="name" title="Год" group="1">
          <call function="year">
            <column table="a" column="dat" />
          </call>
          <const>'FM9999'</const>
        </call>
      </select>
      <from>
        <query name="vr_rb_dat" as="a" />
      </from>
      <where exclude="1">
        <call function="!=">
          <column table="a" column="ym" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="52733_year_def" timestamp="03.10.2022 14:20:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <select>
        <call function="year" as="year" key="1">
          <call function="sysdate" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="52733_pwrc_list" class="1" order="kod_fl.name, a.pwrcname" timestamp="03.10.2022 14:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param name="kod_fl" type="array">
          <array>12968</array>
        </param>
      </params>
      <select>
        <column table="a" column="hv_eopwrc_id" key="1" />
        <column table="a" column="pwrcname" title="Подстанция" />
        <column table="kod_fl" column="name" title="Филиал" />
      </select>
      <from>
        <query name="hv_eopwrc" as="a" />
        <query name="jv_rep_cons_d_fl" as="kod_fl" join="inner">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
      </from>
      <where>
        <call function="in">
          <column table="a" column="bal_id" />
          <useparam name="kod_fl" />
        </call>
      </where>
      <order>
        <column table="kod_fl" column="name" title="Филиал" />
        <column table="a" column="pwrcname" title="Подстанция" />
      </order>
    </query>
    <query name="52733_pwrc_def" class="1" timestamp="03.10.2022 14:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="year" type="number" />
      </params>
      <procedure>
        DECLARE
        n_year    NUMBER(4, 0);
        n_ym_end  NUMBER(6, 2);
        n_ym_beg  NUMBER(6, 2);
        BEGIN
        delete sqlb_d45862_fl_ym_tbl;
        n_year := :year;
        IF n_year IS NOT NULL THEN
        n_ym_end := n_year + 0.12;
        n_ym_beg := n_year + 0.01;
        insert into sqlb_d45862_fl_ym_tbl (kod_fl, name, ym)
        select a.kod_fl, fl.name, a.ym
        from   vr_rb_fact_mv a left outer join jv_rep_cons_d_fl fl on a.kod_fl = fl.kod_fl
        where a.ym &lt;= n_ym_end and a.ym &gt;= n_ym_beg;
        END IF;
        END;
      </procedure>
      <select>
        <column table="pwrc_id" column="hv_eopwrc_id" key="1" />
      </select>
      <from>
        <query name="vb_rb_default_pwrc" as="a" />
        <query name="vr_rb_pwrc" as="pwrc_id" join="inner">
          <call function="and">
            <call function="=">
              <column table="pwrc_id" column="bal_id" />
              <column table="a" column="kod_fl" />
            </call>
            <call function="=">
              <column table="pwrc_id" column="pwrc_id" />
              <column table="a" column="pwrc_id" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="in">
          <column table="a" column="kod_fl" />
          <useparam name="kod_fl" />
        </call>
      </where>
    </query>
    <query name="52733_k_kg_name" comment="вместо 45862_kg_name_default_test2" class="1" timestamp="04.10.2022 15:10:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="pwrc_id" type="array" />
      </params>
      <select>
        <call function="||" as="k_kg_name" group="1">
          <call function="nvl">
            <column column="kod_kol_gr" table="kod_kol_gr" />
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <const>'-'</const>
        </call>
      </select>
      <from>
        <query as="a" name="hv_eopwrc_fdrs" />
        <query name="45862_nastr_by_ym_test2" join="left outer" as="kod_kol_gr">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="def_fdr" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="def_fdr" column="kod_fl" />
            <useparam name="kod_fl" />
          </call>
          <call function="in">
            <column table="a" column="pwrc_id" />
            <useparam name="pwrc_id" />
          </call>
          <call function="is not null">
            <column table="def_fdr" column="kod_id" />
          </call>
          <call function="not">
            <call function="and">
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                  <const>-1</const>
                </call>
                <const>1</const>
              </call>
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="is_auto_kg_real" />
                  <const>-1</const>
                </call>
                <const>0</const>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="main_52733_2" order="YM_START_ANALYZ, PWRCNAME, per_kg_s desc, REAL_FDR, srcname, src_fdrord" timestamp="03.10.2022 14:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param type="number" name="year" />
        <param name="kod_fl" type="array" />
        <param name="hv_eopwrc_id" type="array" />
        <param name="pwrc_id" type="array" />
        <param name="pwrc_fdrid" type="array" />
      </params>
      <select>
        <column table="d49277_kod_fl_real" column="kod_fl" exclude="1" />
        <column table="d49277_kod_fl" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <column table="k_gr_f_tp" column="src_id" />
        <column table="grid_dtl_kg" column="src_fdrid" />
        <call as="mnth" function="mes" type="number" group="max">
          <call function="least">
            <call function="ym add month">
              <column table="d49277_kod_fl" column="ym" />
              <const type="number">-1</const>
            </call>
            <call function="+">
              <useparam name="year" />
              <const type="number">0.12</const>
            </call>
          </call>
        </call>
        <call as="mnth" function="mes" group="max" exclude="1">
          <call function="if">
            <call function="gt">
              <call function="ym add month" comment="Последний закрытый отчетный период">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="+">
              <useparam name="year" />
              <const>0.12</const>
            </call>
            <call function="ym add month" comment="Последний закрытый отчетный период">
              <column table="d49277_kod_fl" column="ym" />
              <const>-1</const>
            </call>
          </call>
        </call>
        <column table="kg_name" column="kg_name_w_real_fdr" title="ДИСП №ФИД" as="pwrc_fdrname" intern="1" />
        <column table="kg_name" column="k_kg_name" intern="1" />
        <column table="kg_name" column="per_kg_s" as="per_kg_s" title="Период с для КГ" />
        <column table="def_pwrc" column="kod_id" group="max" />
        <column table="d49277_fdrid" column="pwrc_fdr_explname" group="stragg_dist" intern="1" />
        <column table="d49277_fdrid" column="pwrc_fdr_balsnamex" group="stragg_dist" intern="1" />
        <column table="d49277_kod_fl" column="name" as="fskname" group="max" intern="1" />
        <column table="d49277_pwrc" column="pwrcn" group="max" title="ДИСП №ПС" as="pwrcname" intern="1" />
        <column table="d49277_pwrc" column="ym_start_analyz" group="max" as="ym_start_analyz" title="Дата начала анализа" />
        <column table="d49277_pwrc" column="pwrc_balsnamex" group="max" intern="1" />
        <column table="k_gr_f_tp" group="max" column="real_fdr" as="real_fdr" intern="1" />
        <column table="k_gr_f_tp" column="srcname" group="max" title="ТП, РП, КК" />
        <column table="k_gr_f_tp" column="srcbalname" title="Балансовая принадоежность" group="max" intern="1" />
        <column table="grid_dtl_kg" column="src_fdrname" group="max" title="ТП, РП, КК (для линий)" as="place_namefider" />
        <call as="wp_in_01" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_02" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_03" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_04" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_05" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_06" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_07" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_08" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_09" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_10" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_11" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_12" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_01_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_01_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_01_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_01" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_02_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_02_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_02_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_02" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_03_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_03_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_03_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_03" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_04_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_04_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_04_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_04" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_05_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_05_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_05_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_05" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_06_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_06_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_06_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_06" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_07_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_07_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_07_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_07" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_08_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_08_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_08_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_08" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_09_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_09_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_09_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_09" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_10_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_10_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_10_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_10" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_11_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_11_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_11_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_11" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_12_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_1" />
          <const>0</const>
        </call>
        <call as="wp_out_12_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_2" />
          <const>0</const>
        </call>
        <call as="wp_out_12_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr_3" />
          <const>0</const>
        </call>
        <call as="wp_out_12" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_01" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_02" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_03" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_04" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_05" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_06" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_07" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_08" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_09" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_10" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_11" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_12" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_fdr" />
          <const>0</const>
        </call>
        <call as="pnt_fdr_year" function="case">
          <column table="this" column="mnth" />
          <call function="when">
            <const>1</const>
            <column table="this" column="pnt_fdr_01" />
          </call>
          <call function="when">
            <const>2</const>
            <column table="this" column="pnt_fdr_02" />
          </call>
          <call function="when">
            <const>3</const>
            <column table="this" column="pnt_fdr_03" />
          </call>
          <call function="when">
            <const>4</const>
            <column table="this" column="pnt_fdr_04" />
          </call>
          <call function="when">
            <const>5</const>
            <column table="this" column="pnt_fdr_05" />
          </call>
          <call function="when">
            <const>6</const>
            <column table="this" column="pnt_fdr_06" />
          </call>
          <call function="when">
            <const>7</const>
            <column table="this" column="pnt_fdr_07" />
          </call>
          <call function="when">
            <const>8</const>
            <column table="this" column="pnt_fdr_08" />
          </call>
          <call function="when">
            <const>9</const>
            <column table="this" column="pnt_fdr_09" />
          </call>
          <call function="when">
            <const>10</const>
            <column table="this" column="pnt_fdr_10" />
          </call>
          <call function="when">
            <const>11</const>
            <column table="this" column="pnt_fdr_11" />
          </call>
          <call function="when">
            <const>12</const>
            <column table="this" column="pnt_fdr_12" />
          </call>
        </call>
        <call as="pnt_grid_01_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_01_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_01_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_01" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_02_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_02_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_02_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_02" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_03_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_03_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_03_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_03" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_04_1" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_04_2" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_04_3" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_04" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_05_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_05_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_05_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_05" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_06_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_06_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_06_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_06" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_07_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_07_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_07_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_07" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_08_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_08_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_08_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_08" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_09_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_09_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_09_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_09" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_10_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_10_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_10_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_10" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_11_1" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_11_2" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_11_3" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_11" function="if" group="sum" nullif="0" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_12_1" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_1" />
          <const>0</const>
        </call>
        <call as="pnt_grid_12_2" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_2" />
          <const>0</const>
        </call>
        <call as="pnt_grid_12_3" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid_3" />
          <const>0</const>
        </call>
        <call as="pnt_grid_12" function="if" nullif="0" group="sum" type="number">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <useparam name="year" />
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_pnt_grid" />
          <const>0</const>
        </call>
        <call as="pnt_grid_year_1" function="case">
          <column table="this" column="mnth" />
          <call function="when">
            <const>1</const>
            <column table="this" column="pnt_grid_01_1" />
          </call>
          <call function="when">
            <const>2</const>
            <column table="this" column="pnt_grid_02_1" />
          </call>
          <call function="when">
            <const>3</const>
            <column table="this" column="pnt_grid_03_1" />
          </call>
          <call function="when">
            <const>4</const>
            <column table="this" column="pnt_grid_04_1" />
          </call>
          <call function="when">
            <const>5</const>
            <column table="this" column="pnt_grid_05_1" />
          </call>
          <call function="when">
            <const>6</const>
            <column table="this" column="pnt_grid_06_1" />
          </call>
          <call function="when">
            <const>7</const>
            <column table="this" column="pnt_grid_07_1" />
          </call>
          <call function="when">
            <const>8</const>
            <column table="this" column="pnt_grid_08_1" />
          </call>
          <call function="when">
            <const>9</const>
            <column table="this" column="pnt_grid_09_1" />
          </call>
          <call function="when">
            <const>10</const>
            <column table="this" column="pnt_grid_10_1" />
          </call>
          <call function="when">
            <const>11</const>
            <column table="this" column="pnt_grid_11_1" />
          </call>
          <call function="when">
            <const>12</const>
            <column table="this" column="pnt_grid_12_1" />
          </call>
        </call>
        <call as="pnt_grid_year_2" function="case">
          <column table="this" column="mnth" />
          <call function="when">
            <const>1</const>
            <column table="this" column="pnt_grid_01_2" />
          </call>
          <call function="when">
            <const>2</const>
            <column table="this" column="pnt_grid_02_2" />
          </call>
          <call function="when">
            <const>3</const>
            <column table="this" column="pnt_grid_03_2" />
          </call>
          <call function="when">
            <const>4</const>
            <column table="this" column="pnt_grid_04_2" />
          </call>
          <call function="when">
            <const>5</const>
            <column table="this" column="pnt_grid_05_2" />
          </call>
          <call function="when">
            <const>6</const>
            <column table="this" column="pnt_grid_06_2" />
          </call>
          <call function="when">
            <const>7</const>
            <column table="this" column="pnt_grid_07_2" />
          </call>
          <call function="when">
            <const>8</const>
            <column table="this" column="pnt_grid_08_2" />
          </call>
          <call function="when">
            <const>9</const>
            <column table="this" column="pnt_grid_09_2" />
          </call>
          <call function="when">
            <const>10</const>
            <column table="this" column="pnt_grid_10_2" />
          </call>
          <call function="when">
            <const>11</const>
            <column table="this" column="pnt_grid_11_2" />
          </call>
          <call function="when">
            <const>12</const>
            <column table="this" column="pnt_grid_12_2" />
          </call>
        </call>
        <call as="pnt_grid_year_3" function="case">
          <column table="this" column="mnth" />
          <call function="when">
            <const>1</const>
            <column table="this" column="pnt_grid_01_3" />
          </call>
          <call function="when">
            <const>2</const>
            <column table="this" column="pnt_grid_02_3" />
          </call>
          <call function="when">
            <const>3</const>
            <column table="this" column="pnt_grid_03_3" />
          </call>
          <call function="when">
            <const>4</const>
            <column table="this" column="pnt_grid_04_3" />
          </call>
          <call function="when">
            <const>5</const>
            <column table="this" column="pnt_grid_05_3" />
          </call>
          <call function="when">
            <const>6</const>
            <column table="this" column="pnt_grid_06_3" />
          </call>
          <call function="when">
            <const>7</const>
            <column table="this" column="pnt_grid_07_3" />
          </call>
          <call function="when">
            <const>8</const>
            <column table="this" column="pnt_grid_08_3" />
          </call>
          <call function="when">
            <const>9</const>
            <column table="this" column="pnt_grid_09_3" />
          </call>
          <call function="when">
            <const>10</const>
            <column table="this" column="pnt_grid_10_3" />
          </call>
          <call function="when">
            <const>11</const>
            <column table="this" column="pnt_grid_11_3" />
          </call>
          <call function="when">
            <const>12</const>
            <column table="this" column="pnt_grid_12_3" />
          </call>
        </call>
        <call as="pnt_grid_year" function="case">
          <column table="this" column="mnth" />
          <call function="when">
            <const>1</const>
            <column table="this" column="pnt_grid_01" />
          </call>
          <call function="when">
            <const>2</const>
            <column table="this" column="pnt_grid_02" />
          </call>
          <call function="when">
            <const>3</const>
            <column table="this" column="pnt_grid_03" />
          </call>
          <call function="when">
            <const>4</const>
            <column table="this" column="pnt_grid_04" />
          </call>
          <call function="when">
            <const>5</const>
            <column table="this" column="pnt_grid_05" />
          </call>
          <call function="when">
            <const>6</const>
            <column table="this" column="pnt_grid_06" />
          </call>
          <call function="when">
            <const>7</const>
            <column table="this" column="pnt_grid_07" />
          </call>
          <call function="when">
            <const>8</const>
            <column table="this" column="pnt_grid_08" />
          </call>
          <call function="when">
            <const>9</const>
            <column table="this" column="pnt_grid_09" />
          </call>
          <call function="when">
            <const>10</const>
            <column table="this" column="pnt_grid_10" />
          </call>
          <call function="when">
            <const>11</const>
            <column table="this" column="pnt_grid_11" />
          </call>
          <call function="when">
            <const>12</const>
            <column table="this" column="pnt_grid_12" />
          </call>
        </call>
        <fact column="vr_rb_eq_kg_pwrc_id" />
        <column table="grid_dtl_kg" column="src_fdrord" as="src_fdrord" group="max" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_kod_fl_real" exclude="1" />
          <link name="d49277_kod_fl" />
          <link name="d49277_pwrc" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <link name="d49277_fdrid" />
          <link name="kg_name" />
          <link name="def_pwrc" />
          <link name="ym" />
          <link name="k_gr_f_tp" />
          <link name="grid_dtl_hist_kg" as="grid_dtl_kg" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_kod_fl_real" column="kod_fl" exclude="1" />
                <column table="d49277_kod_fl" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <useparam name="hv_eopwrc_id" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
              <call function="le">
                <column table="ym" column="val" />
                <call function="+">
                  <useparam name="year" />
                  <const>0.12</const>
                </call>
              </call>
              <call function="le">
                <column table="ym" column="val" />
                <call function="ym add month">
                  <column table="d49277_kod_fl" column="ym" />
                  <const>-1</const>
                </call>
              </call>
              <call function="ge">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="ym_start_analyz" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="nullif(upper(fskname), 'КС') nulls last">
          <group>
            <sourcelink table="d49277_kod_fl_real" exclude="1" />
            <sourcelink table="d49277_kod_fl" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="(case when (SUBSTR( k_kg_name, 1 , 1) != '-') then 1 end) nulls last, pwrc_fdrname nulls first">
              <group>
                <sourcelink table="kg_name" />
              </group>
              <grset as="tp" title="По ТП" order="real_fdr, srcname">
                <group>
                  <sourcelink table="k_gr_f_tp" />
                </group>
                <where>
                  <call function="is not null">
                    <column table="this" column="src_id" />
                  </call>
                </where>
                <grset as="line" title="По линиям" order="src_fdrord">
                  <group>
                    <column table="this" column="src_fdrid" />
                  </group>
                  <where>
                    <call function="is not null">
                      <column table="this" column="src_fdrid" />
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="52733_fdr_kg_missing_tp_single_year_text" class="1" order="name, pwrcname, pwrc_fdrname, srcname" timestamp="04.10.2022 12:10:10" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param name="k_kg_name" type="array" />
        <param name="year" type="number" />
      </params>
      <select>
        <call function="||" group="stragg" as="desc_text">
          <column table="a" column="name" />
          <const>' / '</const>
          <column table="a" column="pwrcname" />
          <const>' / '</const>
          <column table="a" column="pwrc_fdrname" />
          <const>' / '</const>
          <column table="a" column="srcname" />
          <call function="chr">
            <const>13</const>
          </call>
          <call function="chr">
            <const>10</const>
          </call>
        </call>
      </select>
      <from>
        <query name="52733_fdr_kg_missing_tp_single_year_text_pre" as="a">
          <withparams>
            <useparam name="k_kg_name" />
            <useparam name="year" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="52733_fdr_kg_missing_tp_single_year_text_pre" class="1" order="name, pwrcname, pwrc_fdrname, srcname" timestamp="04.10.2022 12:08:10" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param name="k_kg_name" type="array" />
        <param name="year" type="number" />
      </params>
      <select>
        <column table="kod_fl" column="name" group="1" />
        <column table="tp" column="pwrcname" group="1" />
        <column table="tp" column="pwrc_fdrname" group="1" />
        <column table="tp" column="srcname" group="1" />
      </select>
      <from>
        <query name="kg_fdr_missing_tp" as="a" />
        <query name="vb_kol_gr_nastr" as="nastr" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_kol_gr" />
              <column table="nastr" column="kod_kol_gr" />
            </call>
          </call>
          <link name="kod_fl" />
        </query>
        <query name="hv_eopwrc_grid_dtl" as="tp" join="left outer">
          <call function="=">
            <column table="a" column="src_id" />
            <column table="tp" column="src_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <call function="trunc">
              <column table="a" column="ym" />
            </call>
            <useparam name="year" />
          </call>
          <call function="or">
            <call function="in">
              <call function="||">
                <column table="a" column="kod_kol_gr" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
            <call function="in">
              <call function="||">
                <const>'-'</const>
                <column table="a" column="pwrc_fdrid" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="main_53605_temp" timestamp="30.10.2019 00:58:52" comment="Для генерации основны процедуры sqlb_d45862_fdr_kg.vr_rb_fact_progr_total_proc" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <select>
        <call as="id" function="rownum" />
        <column table="d49277_kod_fl" column="kod_fl" />
        <column table="d49277_pwrc" column="pwrc_id" />
        <call as="mnth" function="mes" group="max">
          <call function="ym add month" comment="Последний закрытый отчетный период">
            <column table="d49277_kod_fl" column="ym" />
            <const>-1</const>
          </call>
        </call>
        <column table="kg_name" column="kg_name_w_real_fdr" title="ДИСП №ФИД" as="pwrc_fdrname" />
        <column table="def_pwrc" column="kod_id" group="max" />
        <column table="d49277_fdrid" column="pwrc_fdr_explname" group="stragg_dist" />
        <column table="d49277_fdrid" column="pwrc_fdr_balsnamex" group="stragg_dist" />
        <column table="d49277_kod_fl" column="name" as="fskname" group="max" />
        <column table="d49277_pwrc" column="pwrcn" group="max" title="ДИСП №ПС" as="pwrcname" />
        <call as="wp_in_01" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_02" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_03" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_04" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_05" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_06" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_07" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_08" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_09" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_10" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_11" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_in_12" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_in_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_01" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.01</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.01</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_02" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.02</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.02</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_03" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.03</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.03</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_04" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.04</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.04</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_05" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.05</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.05</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_06" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.06</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.06</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_07" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.07</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.07</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_08" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.08</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.08</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_09" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.09</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.09</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_10" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.10</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.10</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_11" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.11</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.11</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="wp_out_12" function="if" group="sum" nullif="0">
          <call function="and">
            <call function="=">
              <column table="ym" column="val" />
              <call function="+">
                <const>ym_</const>
                <const>0.12</const>
              </call>
            </call>
            <call function="le">
              <call function="+">
                <const>ym_</const>
                <const>0.12</const>
              </call>
              <call function="ym add month">
                <column table="d49277_kod_fl" column="ym" />
                <const>-1</const>
              </call>
            </call>
          </call>
          <fact column="vr_rb_fact_52733_2_wp_out_fdr" />
          <const>0</const>
        </call>
        <call as="neb01" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_01" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_01" />
              <column table="this" column="wp_out_01" />
            </call>
            <column table="this" column="wp_in_01" />
          </call>
        </call>
        <call as="neb02" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_02" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_02" />
              <column table="this" column="wp_out_02" />
            </call>
            <column table="this" column="wp_in_02" />
          </call>
        </call>
        <call as="neb03" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_03" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_03" />
              <column table="this" column="wp_out_03" />
            </call>
            <column table="this" column="wp_in_03" />
          </call>
        </call>
        <call as="neb04" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_04" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_04" />
              <column table="this" column="wp_out_04" />
            </call>
            <column table="this" column="wp_in_04" />
          </call>
        </call>
        <call as="neb05" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_05" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_05" />
              <column table="this" column="wp_out_05" />
            </call>
            <column table="this" column="wp_in_05" />
          </call>
        </call>
        <call as="neb06" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_06" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_06" />
              <column table="this" column="wp_out_06" />
            </call>
            <column table="this" column="wp_in_06" />
          </call>
        </call>
        <call as="neb07" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_07" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_07" />
              <column table="this" column="wp_out_07" />
            </call>
            <column table="this" column="wp_in_07" />
          </call>
        </call>
        <call as="neb08" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_08" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_08" />
              <column table="this" column="wp_out_08" />
            </call>
            <column table="this" column="wp_in_08" />
          </call>
        </call>
        <call as="neb09" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_09" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_09" />
              <column table="this" column="wp_out_09" />
            </call>
            <column table="this" column="wp_in_09" />
          </call>
        </call>
        <call as="neb10" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_10" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_10" />
              <column table="this" column="wp_out_10" />
            </call>
            <column table="this" column="wp_in_10" />
          </call>
        </call>
        <call as="neb11" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_11" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_11" />
              <column table="this" column="wp_out_11" />
            </call>
            <column table="this" column="wp_in_11" />
          </call>
        </call>
        <call as="neb12" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_12" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <call function="-">
              <column table="this" column="wp_in_12" />
              <column table="this" column="wp_out_12" />
            </call>
            <column table="this" column="wp_in_12" />
          </call>
        </call>
        <call as="wp_in_total" function="+nvl">
          <column table="this" column="wp_in_01" />
          <column table="this" column="wp_in_02" />
          <column table="this" column="wp_in_03" />
          <column table="this" column="wp_in_04" />
          <column table="this" column="wp_in_05" />
          <column table="this" column="wp_in_06" />
          <column table="this" column="wp_in_07" />
          <column table="this" column="wp_in_08" />
          <column table="this" column="wp_in_09" />
          <column table="this" column="wp_in_10" />
          <column table="this" column="wp_in_11" />
          <column table="this" column="wp_in_12" />
        </call>
        <call as="wp_out_total" function="+nvl">
          <column table="this" column="wp_out_01" />
          <column table="this" column="wp_out_02" />
          <column table="this" column="wp_out_03" />
          <column table="this" column="wp_out_04" />
          <column table="this" column="wp_out_05" />
          <column table="this" column="wp_out_06" />
          <column table="this" column="wp_out_07" />
          <column table="this" column="wp_out_08" />
          <column table="this" column="wp_out_09" />
          <column table="this" column="wp_out_10" />
          <column table="this" column="wp_out_11" />
          <column table="this" column="wp_out_12" />
        </call>
        <call as="neb_total_kw" function="-">
          <column table="this" column="wp_in_total" />
          <column table="this" column="wp_out_total" />
        </call>
        <call as="neb_total" function="if">
          <call function="=">
            <call function="nvl0">
              <column table="this" column="wp_in_total" />
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <call function="/">
            <column table="this" column="neb_total_kw" />
            <column table="this" column="wp_in_total" />
          </call>
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="d49277_kod_fl" />
          <link name="d49277_pwrc" />
          <link name="d49277_bal_id" only-for-cond="1" />
          <link name="d49277_fdrid" />
          <link name="kg_name" />
          <link name="def_pwrc" />
          <link name="ym" />
          <where>
            <call function="and">
              <call function="in">
                <column table="d49277_kod_fl" column="kod_fl" />
                <const>(select n1 from rr_temp where skod = '52733_fl_lst')</const>
                <useparam name="kod_fl" exclude="1" />
              </call>
              <call function="in">
                <column table="d49277_bal_id" column="hv_eopwrc_id" />
                <const>(select s1 from rr_temp where skod = '52733_hv_eopwrc_lst')</const>
                <useparam name="hv_eopwrc_id" exclude="1" />
              </call>
              <call function="in">
                <column table="d49277_fdrid" column="pwrc_fdrid" />
                <const>(select n1 from rr_temp where skod = '45862_fdr_lst')</const>
                <useparam name="pwrc_fdrid" exclude="1" />
              </call>
              <call function="le">
                <column table="ym" column="val" />
                <call function="+">
                  <const>ym_</const>
                  <const>0.12</const>
                </call>
                <useparam name="stage12" exclude="1" />
              </call>
              <call function="le">
                <column table="ym" column="val" />
                <call function="ym add month">
                  <column table="d49277_kod_fl" column="ym" />
                  <const>-1</const>
                </call>
              </call>
              <call function="ge">
                <column table="ym" column="val" />
                <column table="def_pwrc" column="ym_start_analyz" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="fl" title="По филиалам" order="nullif(upper(fskname), 'КС') nulls last">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <grset as="ps" title="По сетям" order="kod_id">
            <group>
              <sourcelink table="d49277_pwrc" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="kg_name" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="f53605_rr_temp" class="1" timestamp="31.10.2019 01:40:43" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <select>
        <column table="a" column="n1" type="number" column-mandatory="1" title="" as="id" />
        <column table="a" column="skod" type="string" column-mandatory="1" title="" as="skod" />
        <column table="a" column="s1" type="string" column-mandatory="1" title="" as="grsetname" />
        <column table="a" column="n2" type="number" column-mandatory="1" title="" as="kod_fl" />
        <column table="a" column="n3" type="number" column-mandatory="1" title="" as="pwrc_id" />
        <column table="a" column="n4" type="number" column-mandatory="1" title="" as="mnth" />
        <column table="a" column="s2" type="string" column-mandatory="1" title="" as="pwrc_fdrname" />
        <column table="a" column="n5" type="number" column-mandatory="1" title="" as="kod_id" />
        <column table="a" column="s3" type="string" column-mandatory="1" title="" as="pwrc_fdr_explname" />
        <column table="a" column="s4" type="string" column-mandatory="1" title="" as="fskname" />
        <column table="a" column="s5" type="string" column-mandatory="1" title="" as="pwrcname" />
        <column table="a" column="n6" type="number" column-mandatory="1" title="" as="neb01" />
        <column table="a" column="n7" type="number" column-mandatory="1" title="" as="neb02" />
        <column table="a" column="n8" type="number" column-mandatory="1" title="" as="neb03" />
        <column table="a" column="n9" type="number" column-mandatory="1" title="" as="neb04" />
        <column table="a" column="n10" type="number" column-mandatory="1" title="" as="neb05" />
        <column table="a" column="n11" type="number" column-mandatory="1" title="" as="neb06" />
        <column table="a" column="n12" type="number" column-mandatory="1" title="" as="neb07" />
        <column table="a" column="n13" type="number" column-mandatory="1" title="" as="neb08" />
        <column table="a" column="n14" type="number" column-mandatory="1" title="" as="neb09" />
        <column table="a" column="n15" type="number" column-mandatory="1" title="" as="neb10" />
        <column table="a" column="n16" type="number" column-mandatory="1" title="" as="neb11" />
        <column table="a" column="n17" type="number" column-mandatory="1" title="" as="neb12" />
        <column table="a" column="n18" type="number" column-mandatory="1" title="" as="neb_total_kw" />
        <column table="a" column="n19" type="number" column-mandatory="1" title="" as="neb_total" />
        <column table="a" column="n20" type="number" column-mandatory="1" title="" as="gr_rn" />
        <column table="a" column="s6" type="string" column-mandatory="1" title="" as="growid" />
        <column table="a" column="s7" type="string" column-mandatory="1" title="" as="parent_growid" />
        <column table="a" column="n21" type="number" column-mandatory="1" title="" as="groupingid" />
        <column table="a" column="s8" type="string" column-mandatory="1" title="" as="grsetid" />
        <column table="a" column="s9" type="string" column-mandatory="1" title="" as="origgrsetid" />
        <column table="a" column="s10" type="string" column-mandatory="1" title="" as="parent_grsetid" />
        <column table="a" column="n22" type="number" column-mandatory="1" title="" as="par_groupingid" />
        <column table="a" column="n23" type="number" column-mandatory="1" title="" as="neb_0_10" is-fact="1" agg="max" />
        <column table="a" column="n24" type="number" column-mandatory="1" title="" as="neb_10_20" is-fact="1" agg="max" />
        <column table="a" column="n25" type="number" column-mandatory="1" title="" as="neb_10_30" is-fact="1" agg="max" />
        <column table="a" column="n26" type="number" column-mandatory="1" title="" as="neb_30_50" is-fact="1" agg="max" />
        <column table="a" column="n27" type="number" column-mandatory="1" title="" as="neb_20_50" is-fact="1" agg="max" />
        <column table="a" column="n28" type="number" column-mandatory="1" title="" as="neb_50_100" is-fact="1" agg="max" />
        <column table="a" column="n29" type="number" column-mandatory="1" title="" as="neb_100" is-fact="1" agg="max" />
        <column table="a" column="n30" type="number" column-mandatory="1" title="" as="neb_null" is-fact="1" agg="max" />
        <column table="a" column="n31" type="number" column-mandatory="1" title="" as="neb_min_0_10" is-fact="1" agg="max" />
        <column table="a" column="n32" type="number" column-mandatory="1" title="" as="neb_min_10_20" is-fact="1" agg="max" />
        <column table="a" column="n33" type="number" column-mandatory="1" title="" as="neb_min_20_50" is-fact="1" agg="max" />
        <column table="a" column="n34" type="number" column-mandatory="1" title="" as="neb_min_50_100" is-fact="1" agg="max" />
        <column table="a" column="n35" type="number" column-mandatory="1" title="" as="neb_min_100" is-fact="1" agg="max" />
        <column table="a" column="n36" type="number" column-mandatory="1" title="" as="plan_ps" is-fact="1" agg="max" />
        <column table="a" column="n37" type="number" column-mandatory="1" title="" as="fact_ps" is-fact="1" agg="max" />
        <column table="a" column="n38" type="number" column-mandatory="1" title="" as="wp_in_total" is-fact="1" agg="max" />
        <column table="a" column="n39" type="number" column-mandatory="1" title="" as="wp_out_total" is-fact="1" agg="max" />
        <column table="a" column="s11" type="string" column-mandatory="1" title="" as="pwrc_fdr_balsnamex" />
        <column table="a" column="n40" type="number" column-mandatory="1" title="" as="last_neb" is-fact="1" agg="max" />
      </select>
      <from>
        <table name="rr_temp" as="a" />
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="kod_fl" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="this" column="skod" />
          <const>'53605_progr_total_rep'</const>
        </call>
      </where>
    </query>
    <query name="title_53605" class="1" timestamp="30.10.2019 01:26:04" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <select>
        <column table="a" column="closed_ym" />
        <column table="a" column="stage01" />
        <column table="a" column="stage_last" />
      </select>
      <from>
        <query name="stage_last_53605" as="a">
          <withparams>
            <usepart part="52733-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="main_53605" class="1" timestamp="06.10.2019 19:32:07" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <select>
        <column table="fl" column="kod_fl" column-mandatory="1" title="" />
        <column table="a" column="kod_fl" column-mandatory="1" title="" exclude="1" />
        <column table="a" column="neb_0_10" group="max" nullif="0" />
        <column table="a" column="neb_10_20" group="max" nullif="0" />
        <column table="a" column="neb_10_30" group="max" nullif="0" />
        <column table="a" column="neb_30_50" group="max" nullif="0" />
        <column table="a" column="neb_20_50" group="max" nullif="0" />
        <column table="a" column="neb_50_100" group="max" nullif="0" />
        <column table="a" column="neb_100" group="max" nullif="0" />
        <column table="a" column="neb_null" group="max" nullif="0" />
        <column table="a" column="neb_min_0_10" group="max" nullif="0" />
        <column table="a" column="neb_min_10_20" group="max" nullif="0" />
        <column table="a" column="neb_min_20_50" group="max" nullif="0" />
        <column table="a" column="neb_min_50_100" group="max" nullif="0" />
        <column table="a" column="neb_min_100" group="max" nullif="0" />
        <column table="a" column="plan_ps" group="max" nullif="0" />
        <column table="a" column="fact_ps" group="max" nullif="0" />
      </select>
      <from>
        <query name="53605_rr_temp" as="a" />
        <query name="jv_rep_cons_d_fl" join="right outer" as="fl">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_fl" />
              <column table="fl" column="kod_fl" />
            </call>
            <call function="in">
              <column table="fl" column="kod_fl" />
              <const comment="ВЭС, ГтЭС, КнЭС, НлЭС, ПрЭС, ТхЭС, КС">(1105, 12966, 1107, 1110, 12968, 1111, 13082)</const>
            </call>
          </call>
        </query>
      </from>
      <grouping>
        <grset as="ves">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1105</const>
            </call>
          </where>
        </grset>
        <grset as="gtes">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>12966</const>
            </call>
          </where>
        </grset>
        <grset as="knes">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1107</const>
            </call>
          </where>
        </grset>
        <grset as="nles">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1110</const>
            </call>
          </where>
        </grset>
        <grset as="pres">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>12968</const>
            </call>
          </where>
        </grset>
        <grset as="thes">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1111</const>
            </call>
          </where>
        </grset>
        <grset as="ks">
          <group>
            <column table="this" column="kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>13082</const>
            </call>
          </where>
        </grset>
      </grouping>
    </query>
    <query name="53605_detail" timestamp="30.10.2019 01:54:09" is-report="1" title="Отчет ЛЭ с линейными работами" visible="0" order="replace(growid, '# ', '#')" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail.xlsx" print-proc="2" print-xlsx="1" title="Отчет ЛЭ с линейными работами" />
        </excel>
      </print-templates>
      <select>
        <column table="a" column="id" title="id" />
        <column table="a" column="growid" />
        <column table="a" column="grsetname" />
        <column table="a" column="mnth" />
        <column table="a" column="kod_fl" />
        <call title="Филиал" function="if" as="fskname">
          <call function="=">
            <column table="this" column="grsetname" />
            <const>'По филиалам'</const>
          </call>
          <call function="||">
            <column table="a" column="fskname" />
            <const>', итого:'</const>
          </call>
          <column table="a" column="fskname" />
        </call>
        <call title="РЭС" as="pwrc_fdr_explname" function="if">
          <call function="=">
            <column table="this" column="grsetname" />
            <const>'По фидерам'</const>
          </call>
          <column table="a" column="pwrc_fdr_explname" />
        </call>
        <call title="Фидер" as="pwrc_fdrname" function="if">
          <call function="=">
            <column table="this" column="grsetname" />
            <const>'По сетям'</const>
          </call>
          <column table="a" column="pwrcname" />
          <column table="a" column="pwrc_fdrname" />
        </call>
        <call title="Январь" function="*" as="neb01">
          <column table="a" column="neb01" />
          <const>100</const>
        </call>
        <call title="Февраль" function="*" as="neb02">
          <column table="a" column="neb02" />
          <const>100</const>
        </call>
        <call title="Март" function="*" as="neb03">
          <column table="a" column="neb03" />
          <const>100</const>
        </call>
        <call title="Апрель" function="*" as="neb04">
          <column table="a" column="neb04" />
          <const>100</const>
        </call>
        <call title="Май" function="*" as="neb05">
          <column table="a" column="neb05" />
          <const>100</const>
        </call>
        <call title="Июнь" function="*" as="neb06">
          <column table="a" column="neb06" />
          <const>100</const>
        </call>
        <call title="Июль" function="*" as="neb07">
          <column table="a" column="neb07" />
          <const>100</const>
        </call>
        <call title="Август" function="*" as="neb08">
          <column table="a" column="neb08" />
          <const>100</const>
        </call>
        <call title="Сентябрь" function="*" as="neb09">
          <column table="a" column="neb09" />
          <const>100</const>
        </call>
        <call title="Октябрь" function="*" as="neb10">
          <column table="a" column="neb10" />
          <const>100</const>
        </call>
        <call title="Ноябрь" function="*" as="neb11">
          <column table="a" column="neb11" />
          <const>100</const>
        </call>
        <call title="Декабрь" function="*" as="neb12">
          <column table="a" column="neb12" />
          <const>100</const>
        </call>
        <call title="Небаланс Нарастающ. итог, %" function="*" as="neb_total">
          <column table="a" column="neb_total" />
          <const>100</const>
        </call>
        <column table="a" column="neb_total_kw" title="Небаланс Нарастающ. итог, кВтч" />
      </select>
      <from>
        <qube>
          <link name="rep_53605_rr_temp" as="a" />
          <link name="d49277_kod_fl" all-rows="1" />
        </qube>
      </from>
    </query>
    <query name="main_53605_2" class="1" timestamp="30.10.2019 01:55:22" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <select>
        <column table="d49277_kod_fl" column="kod_fl" column-mandatory="1" title="" />
        <fact group="max" column="f53605_rr_temp_neb_0_10" as="neb_0_10" />
        <fact group="max" column="f53605_rr_temp_neb_10_20" as="neb_10_20" />
        <fact group="max" column="f53605_rr_temp_neb_10_30" as="neb_10_30" />
        <fact group="max" column="f53605_rr_temp_neb_30_50" as="neb_30_50" />
        <fact group="max" column="f53605_rr_temp_neb_20_50" as="neb_20_50" />
        <fact group="max" column="f53605_rr_temp_neb_50_100" as="neb_50_100" />
        <fact group="max" column="f53605_rr_temp_neb_100" as="neb_100" />
        <fact group="max" column="f53605_rr_temp_neb_null" as="neb_null" />
        <fact group="max" column="f53605_rr_temp_neb_min_0_10" as="neb_min_0_10" />
        <fact group="max" column="f53605_rr_temp_neb_min_10_20" as="neb_min_10_20" />
        <fact group="max" column="f53605_rr_temp_neb_min_20_50" as="neb_min_20_50" />
        <fact group="max" column="f53605_rr_temp_neb_min_50_100" as="neb_min_50_100" />
        <fact group="max" column="f53605_rr_temp_neb_min_100" as="neb_min_100" />
        <fact group="max" column="f53605_rr_temp_plan_ps" as="plan_ps" />
        <fact group="max" column="f53605_rr_temp_fact_ps" as="fact_ps" />
      </select>
      <from>
        <qube>
          <link name="d49277_kod_fl" all-rows="1" />
        </qube>
      </from>
      <grouping>
        <grset as="ves">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1105</const>
            </call>
          </where>
        </grset>
        <grset as="gtes">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>12966</const>
            </call>
          </where>
        </grset>
        <grset as="knes">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1107</const>
            </call>
          </where>
        </grset>
        <grset as="nles">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1110</const>
            </call>
          </where>
        </grset>
        <grset as="pres">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>12968</const>
            </call>
          </where>
        </grset>
        <grset as="thes">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>1111</const>
            </call>
          </where>
        </grset>
        <grset as="ks">
          <group>
            <sourcelink table="d49277_kod_fl" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_fl" />
              <const>13082</const>
            </call>
          </where>
        </grset>
      </grouping>
    </query>
    <query name="53605_detail_0_10" timestamp="31.10.2019 01:52:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <column table="a" column="id" part-id="53605_detail_fdr_select" />
        <column table="a" column="growid" part-id="53605_detail_fdr_select" />
        <column table="a" column="grsetname" part-id="53605_detail_fdr_select" />
        <column table="a" column="mnth" part-id="53605_detail_fdr_select" />
        <column table="a" column="kod_fl" part-id="53605_detail_fdr_select" />
        <column table="a" column="fskname" title="Филиал" part-id="53605_detail_fdr_select" />
        <column table="a" column="pwrcname" title="Подстанция" part-id="53605_detail_fdr_select" />
        <column table="a" column="pwrc_fdr_explname" title="РЭС" part-id="53605_detail_fdr_select" />
        <column table="a" column="pwrc_fdr_balsnamex" title="Балансовая принадлежность" part-id="53605_detail_fdr_select" />
        <column table="a" column="pwrc_fdrname" title="Фидер" part-id="53605_detail_fdr_select" />
        <column table="a" column="wp_in_total" title="Отпуск Нарастающ. итог" part-id="53605_detail_fdr_select" />
        <column table="a" column="wp_out_total" title="Потребление Нарастающ. итог" part-id="53605_detail_fdr_select" />
        <call title="Январь" function="*" as="neb01" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb01" />
          <const>100</const>
        </call>
        <call title="Февраль" function="*" as="neb02" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb02" />
          <const>100</const>
        </call>
        <call title="Март" function="*" as="neb03" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb03" />
          <const>100</const>
        </call>
        <call title="Апрель" function="*" as="neb04" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb04" />
          <const>100</const>
        </call>
        <call title="Май" function="*" as="neb05" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb05" />
          <const>100</const>
        </call>
        <call title="Июнь" function="*" as="neb06" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb06" />
          <const>100</const>
        </call>
        <call title="Июль" function="*" as="neb07" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb07" />
          <const>100</const>
        </call>
        <call title="Август" function="*" as="neb08" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb08" />
          <const>100</const>
        </call>
        <call title="Сентябрь" function="*" as="neb09" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb09" />
          <const>100</const>
        </call>
        <call title="Октябрь" function="*" as="neb10" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb10" />
          <const>100</const>
        </call>
        <call title="Ноябрь" function="*" as="neb11" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb11" />
          <const>100</const>
        </call>
        <call title="Декабрь" function="*" as="neb12" format="F1" part-id="53605_detail_fdr_select">
          <column table="a" column="neb12" />
          <const>100</const>
        </call>
        <call title="Небаланс Нарастающ. итог, %" function="*" as="neb_total" part-id="53605_detail_fdr_select">
          <column table="a" column="neb_total" />
          <const>100</const>
        </call>
        <column table="a" column="neb_total_kw" title="Небаланс Нарастающ. итог, кВтч" part-id="53605_detail_fdr_select" />
        <call function="*" as="last_neb" part-id="53605_detail_fdr_select">
          <column table="a" column="last_neb" />
          <const>100</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="rep_53605_rr_temp" as="a" part-id="53605_detail_fdr_qube" />
          <link name="d49277_kod_fl" part-id="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>0</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>10</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_10_20" timestamp="31.10.2019 00:40:27" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>10</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>20</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="stage_last_53605" class="1" timestamp="30.10.2019 01:30:35" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <select>
        <call as="closed_ym" type="number" function="ym add month" group="max">
          <column table="a" column="ym" />
          <const>-1</const>
        </call>
        <call as="stage01" function="()" type="number">
          <useparam name="stage01" />
        </call>
        <call type="number" function="if" as="stage_last">
          <call function="lt">
            <useparam name="year" />
            <call function="trunc">
              <column table="this" column="closed_ym" />
            </call>
          </call>
          <call function="+">
            <useparam name="year" />
            <const>0.12</const>
          </call>
          <column table="this" column="closed_ym" />
        </call>
        <call as="month_last" function="mes">
          <column table="this" column="stage_last" />
        </call>
      </select>
      <from>
        <query name="vr_rb_filial" as="a" />
        <query name="rr_temp" as="fl" join="inner">
          <call function="and">
            <call function="=">
              <column table="fl" column="skod" />
              <const>'52733_fl_lst'</const>
            </call>
            <call function="=">
              <column table="fl" column="n1" />
              <column table="a" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="53605_detail_10_30" timestamp="31.10.2019 00:40:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>10</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>30</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_30_50" timestamp="31.10.2019 00:40:27" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>30</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>50</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_20_50" timestamp="31.10.2019 00:40:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>20</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>50</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_50_100" timestamp="31.10.2019 00:40:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>50</const>
              </call>
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>100</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_100" timestamp="31.10.2019 00:40:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="ge">
                <column table="this" column="last_neb" />
                <const>100</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_null" timestamp="31.10.2019 00:40:28" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="last_neb" />
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_min_0_10" timestamp="31.10.2019 00:40:29" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="lt">
                <column table="this" column="last_neb" />
                <const>0</const>
              </call>
              <call function="gt">
                <column table="this" column="last_neb" />
                <const>-10</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_min_10_20" timestamp="31.10.2019 00:40:29" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="le">
                <column table="this" column="last_neb" />
                <const>-10</const>
              </call>
              <call function="gt">
                <column table="this" column="last_neb" />
                <const>-20</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_min_20_50" timestamp="31.10.2019 00:40:29" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="le">
                <column table="this" column="last_neb" />
                <const>-20</const>
              </call>
              <call function="gt">
                <column table="this" column="last_neb" />
                <const>-50</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_min_50_100" timestamp="31.10.2019 00:40:30" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="le">
                <column table="this" column="last_neb" />
                <const>-50</const>
              </call>
              <call function="gt">
                <column table="this" column="last_neb" />
                <const>-100</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="53605_detail_min_100" timestamp="31.10.2019 00:40:30" is-report="1" visible="0" order="replace(growid, '# ', '#')" title="6. Итоги. Детализация по фидерам" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <print-templates>
        <excel>
          <template name="53605_detail_fdr.xlsx" print-proc="2" print-xlsx="1" title="6. Итоги. Детализация по фидерам" />
        </excel>
      </print-templates>
      <select>
        <usepart part="53605_detail_fdr_select" />
      </select>
      <from>
        <qube>
          <usepart part="53605_detail_fdr_qube" />
          <where>
            <call function="and">
              <call function="le">
                <column table="this" column="last_neb" />
                <const>-100</const>
              </call>
              <call function="=">
                <column table="this" column="grsetname" />
                <const>'По фидерам'</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="hv_report_31_main" class="1" timestamp="24.01.2023 12:36:02" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\asuse.hv_report_31_main.xml">
      <select>
        <column table="a" column="count_fdr" type="number" title="" data-size="300" />
        <column table="a" column="kod_fl" type="number" />
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrc_fdrname" type="string" data-size="303" title="" />
        <column table="a" column="k_kg_name" type="string" data-size="300" title="" />
        <column table="a" column="kod_id" type="number" />
        <column table="a" column="ym_start_analyz" type="number" title="" />
        <column table="a" column="pwrc_fdr_explname" type="string" data-size="4000" title="" />
        <column table="a" column="fskname" type="string" data-size="20" title="" />
        <column table="a" column="ym" type="number" title="" />
        <column table="a" column="pwrcname" type="string" data-size="121" title="" />
        <column table="a" column="pwrcn" type="string" data-size="121" title="" />
        <column table="a" column="wp_in_st1" type="number" title="" />
        <column table="a" column="wp_out_st1" type="number" title="" />
        <column table="a" column="wp_in_st2" type="number" title="" />
        <column table="a" column="wp_out_st2" type="number" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="tp_st2" type="number" title="" />
        <column table="a" column="tp_le" type="number" title="" />
        <column table="a" column="tp_potr" type="number" title="" />
        <column table="a" column="tp_dif_1w" type="number" title="" />
        <column table="a" column="tp_0null_st2" type="number" title="" />
        <column table="a" column="tp_le_0null" type="number" title="" />
        <column table="a" column="tp_potr_0" type="number" title="" />
        <column table="a" column="tp_potr_null" type="number" title="" />
        <column table="a" column="tp_0null_dif_1w" type="number" title="" />
        <column table="a" column="tu_ul_st2" type="number" title="" />
        <column table="a" column="tu_dif_1w" type="number" title="" />
        <column table="a" column="tu_nas_st2" type="number" title="" />
        <column table="a" column="tu_ul" type="number" title="" />
        <column table="a" column="tu_dif_ul_1w" type="number" title="" />
        <column table="a" column="tu_mkd" type="number" title="" />
        <column table="a" column="tu_izs" type="number" title="" />
        <column table="a" column="tu_dif_nas_1w" type="number" title="" />
        <column table="a" column="tu_0null_st2" type="number" title="" />
        <column table="a" column="tu_ul_0" type="number" title="" />
        <column table="a" column="tu_ul_null" type="number" title="" />
        <column table="a" column="tu_mkd_0" type="number" title="" />
        <column table="a" column="tu_izs_0" type="number" title="" />
        <column table="a" column="tu_mkd_null" type="number" title="" />
        <column table="a" column="tu_izs_null" type="number" title="" />
        <column table="a" column="tu_0null_dif_1w" type="number" title="" />
        <column table="a" column="tu_ul_auto" type="number" title="" />
        <column table="a" column="tu_mkd_auto" type="number" title="" />
        <column table="a" column="tu_izs_auto" type="number" title="" />
        <column table="a" column="tu_ul_hand" type="number" title="" />
        <column table="a" column="tu_mkd_hand" type="number" title="" />
        <column table="a" column="tu_izs_hand" type="number" title="" />
        <column table="a" column="tu_ul_no" type="number" title="" />
        <column table="a" column="tu_mkd_no" type="number" title="" />
        <column table="a" column="tu_izs_no" type="number" title="" />
        <column table="a" column="tu_auto_dif_1w" type="number" title="" />
        <column table="a" column="tu_hand_dif_1w" type="number" title="" />
        <column table="a" column="tu_no_dif_1w" type="number" title="" />
      </select>
      <from>
        <table name="hv_report_31_main" as="a" />
      </from>
    </query>
    <query name="vr_rb_pwrc" class="1" timestamp="21.02.2021 02:29:13" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\hv_eopwrc.xml">
      <select>
        <call function="||-" as="hv_eopwrc_id" key="1">
          <column table="this" column="pwrc_id" />
          <column table="this" column="bal_id" />
        </call>
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" title="" as="pwrcn" />
        <call function="instr" as="n1">
          <column table="a" column="pwrcname" />
          <const>'('</const>
        </call>
        <call function="instr" as="n2">
          <column table="a" column="pwrcname" />
          <const>')'</const>
        </call>
        <call as="pwrcname" function="if">
          <call function="or">
            <call function="=0">
              <column table="this" column="n1" />
            </call>
            <call function="=0">
              <column table="this" column="n2" />
            </call>
          </call>
          <column table="this" column="pwrcn" />
          <call function="substr">
            <column table="this" column="pwrcn" />
            <call function="+">
              <column table="this" column="n1" />
              <const>1</const>
            </call>
            <call function="-">
              <column table="this" column="n2" />
              <column table="this" column="n1" />
              <const>1</const>
            </call>
          </call>
        </call>
        <call function="substr" as="pwrcname" exclude="1">
          <column table="this" column="pwrcn" />
          <call function="+">
            <column table="this" column="n1" />
            <const>1</const>
          </call>
          <call function="-">
            <column table="this" column="n2" />
            <column table="this" column="n1" />
            <const>1</const>
          </call>
        </call>
        <column table="a" column="bal_id" type="number" title="" comment="!ВНИМАНИЕ. ЭТО КОД СЕТИ, В ЗОНЕ КОТОРОЙ НАХОДИТСЯ ЭНЕРГООБЪЕКТ" />
        <column table="a" column="pwrc_balname" type="string" title="" />
        <column table="a" column="pwrc_bkod_ecls" type="number" />
        <column table="a" column="pwrc_balsname" type="string" title="" />
        <call as="pwrc_balsnamex" type="string" function="if">
          <call function="=">
            <column table="this" column="pwrc_bkod_ecls" />
            <const>2</const>
          </call>
          <column table="this" column="pwrc_balsname" />
          <const>'ПОТР.'</const>
        </call>
        <column table="default_pwrc" column="ym_start_analyz" as="ym_start_analyz" />
      </select>
      <from>
        <table name="vr_rb_pwrc" as="a" />
        <query name="vr_rb_filial" as="kod_fl" join="left outer">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="vr_rb_pwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl_real" join="left outer">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl_real" column="kod_fl" />
          </call>
        </query>
        <query join="left outer" name="vb_rb_default_pwrc" as="default_pwrc">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="default_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="default_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <links exclude="1">
        <link name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dlink name="vr_rb_fider" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="vr_rb_pwrc_g" class="1" timestamp="21.02.2021 02:29:58" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\hv_eopwrc.xml">
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" group="1" key="1" />
        <column table="a" column="pwrcname" type="string" title="" group="max" />
        <column group="max" table="a" column="pwrcn" />
        <column group="max" table="a" column="pwrc_balsnamex" />
        <column table="a" column="ym_start_analyz" group="max" />
      </select>
      <from>
        <query name="vr_rb_pwrc" as="a" />
      </from>
      <links exclude="1">
        <dlink name="vr_rb_pwrc" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="d49277_kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="vr_rb_fider" class="1" timestamp="01.07.2019 10:53:38" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\hv_eopwrc_fdrs.xml">
      <select>
        <column table="a" column="pwrc_fdrid" type="number" title="" comment="Код фидера" />
        <column table="a" column="pwrc_fdrname" type="string" title="" comment="Дисп. наименованиие фидера" />
        <column table="a" column="isprm_fdr" type="string" title="" comment="пр. Фидер прямофидерного потребителя" />
        <column table="a" column="pwrc_id" type="number" title="" comment="Код ПС (ТП, РТП ..)" />
        <column table="a" column="pwrcname" type="string" title="" comment="Дисп. ПС (ТП, РТП ..)" />
        <column table="a" column="bal_id" type="number" title="" comment="Код балансовой принадлежности" />
        <column table="a" column="expl_id" type="number" title="" comment="Код эксплуатационной ответственности" />
        <column table="a" column="pwrc_fdr_bkod_ecls" type="number" comment="Классификатор балансодержателя фидера ПС" />
        <column table="a" column="pwrc_fdr_expl_id" type="number" title="" comment="Код экспл.принадлежности фидера (обычно РЭС)" />
        <column table="a" column="pwrc_fdr_bal_id" type="number" title="" comment="Код балансовой принадлежности фидера" />
        <column table="a" column="kod_srckind" type="number" comment="Код вида энергообъекта" />
        <column table="a" column="pwrc_balname" type="string" title="" comment="Балансовая принадлежность" />
        <column table="a" column="pwrc_explname" type="string" title="" comment="Эксплуатационная ответвенность" />
        <column table="a" column="pwrc_fdr_balname" type="string" title="" comment="Балансовая принадлежность фидера" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="" comment="Эксплуатационная ответвенность фидера" />
        <column table="a" column="pr_cycle" type="number" title="" comment="пр. фидер закольцован" />
        <column table="a" column="pwrc_bkod_ecls" type="number" />
        <column table="a" column="pwrc_balsname" type="string" title="" />
        <column table="a" column="pwrc_fdr_balsname" type="string" title="" />
        <call as="pwrc_fdr_balsnamex" type="string" function="if">
          <call function="=">
            <column table="this" column="pwrc_fdr_bkod_ecls" />
            <const>2</const>
          </call>
          <column table="this" column="pwrc_fdr_balsname" />
          <const>'ПОТР.'</const>
        </call>
      </select>
      <from>
        <table name="vr_rb_fider" as="a" />
        <query name="vr_rb_pwrc_g" as="pwrc_id" join="left outer" exclude="1">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
      </from>
      <links exclude="1">
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="d49277_kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="vr_rb_tp" class="1" timestamp="06.09.2018 18:18:32" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\hv_eopwrc_grid.xml">
      <select>
        <call function="||-" as="tp_id" key="1">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="a" column="pwrc_fdrid" type="number" title="" />
        <column table="a" column="pwrc_fdrname" type="string" title="" />
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="src_id" type="number" title="" />
        <column table="a" column="srcname" type="string" title="" />
        <column table="a" column="srcbalname" type="string" title="" comment="Балансовая принадлежность энергообъекта" />
      </select>
      <from>
        <table name="vr_rb_tp" as="a" />
      </from>
    </query>
    <query name="vr_rb_filial" class="1" timestamp="27.12.2018 18:01:50" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\jv_rep_cons_d_fl.xml">
      <select>
        <column table="a" column="kod_fl" type="number" />
        <column table="a" column="name" type="string" title="Наименование" />
        <column table="a" column="ym" type="number" title="Отчетный период" />
      </select>
      <from>
        <table as="a" name="vr_rb_filial" />
      </from>
      <links exclude="1">
        <dlink name="vr_rb_pwrc" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="d49277_fdrid" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="d49277_pwrc" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="sqlb_d45862_fl_ym_tbl" class="1" timestamp="06.02.2019 12:45:17" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\sqlb_d45862_fl_ym_tbl.xml">
      <select>
        <column table="a" column="kod_fl" type="number" key="1" />
        <column table="a" column="name" type="string" />
        <column table="a" column="ym" type="number" title="" />
      </select>
      <from>
        <table name="sqlb_d45862_fl_ym_tbl" as="a" />
      </from>
    </query>
    <query name="vb_rb_default_fdr" class="1" timestamp="20.02.2021 22:36:23" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vb_rb_default_fdr.xml">
      <select>
        <column table="a" column="kod_id" type="number" column-mandatory="1" comment="Код записи таблицы" />
        <column table="a" column="pwrc_id" type="number" title="" comment="Код подстанции" />
        <column table="a" column="pwrc_fdrid" type="number" title="" comment="Код фидера" />
        <column table="a" column="u_m" type="string" data-size="4000" title="" />
        <column table="a" column="d_m" type="date" title="" />
        <column table="a" column="kod_id_pwrc" type="number" title="" comment="Код записи таблицы ПС - vb_rb_default_pwrc" />
        <column table="pwrc_id" column="kod_fl" />
      </select>
      <from>
        <table name="vb_rb_default_fdr" as="a" />
        <query name="vb_rb_default_pwrc" join="left outer" as="pwrc_id">
          <call function="=">
            <column table="a" column="kod_id_pwrc" />
            <column table="pwrc_id" column="kod_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left inner">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="jv_rep_cons_d_fl" join="left outer" as="kod_fl">
          <call function="=">
            <column table="this" column="kod_fl" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
      </from>
    </query>
    <query name="vb_rb_default_pwrc" class="1" timestamp="04.10.2022 11:47:13" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vb_rb_default_pwrc.xml">
      <select>
        <column table="a" column="kod_id" type="number" column-mandatory="1" comment="Код записи таблицы" />
        <column table="a" column="kod_fl" type="number" comment="Код филиала" />
        <column table="a" column="pwrc_id" type="number" title="" comment="Код подстанции" />
        <column table="a" column="u_m" type="string" data-size="4000" title="" />
        <column table="a" column="d_m" type="date" title="" />
        <column table="a" column="stage1" type="number" title="" comment="Период 1го этапа (YYYY.MM)" />
        <column table="a" column="stage2" type="number" title="" comment="Период 2го этапа (YYYY.MM)" />
        <column table="a" column="ym_start_analyz" type="number" title="" comment="Период, с которого по ПС проводятся работы по устранению небалансов" />
        <call function="to_char" as="tm_start_an_str">
          <column table="this" column="ym_start_analyz" />
        </call>
      </select>
      <from>
        <table name="vb_rb_default_pwrc" as="a" />
        <query name="jv_rep_cons_d_fl" as="kod_fl" join="left outer">
          <call function="=">
            <column table="a" column="kod_fl" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query join="left outer" name="vr_rb_pwrc" as="pwrc_id">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="pwrc_id" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="kod_fl" />
              <column table="pwrc_id" column="bal_id" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_dat" class="1" timestamp="26.02.2019 13:56:02" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_dat.xml">
      <select>
        <column table="a" column="id_dat" type="number" column-mandatory="1" title="" key="1" />
        <column table="a" column="dat" type="date" title="" />
        <column table="a" column="is_result" type="number" />
      </select>
      <from>
        <table name="vr_rb_dat" as="a" />
      </from>
    </query>
    <query name="vr_rb_equip" class="1" timestamp="16.12.2022 02:29:03" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_equip.xml">
      <select>
        <call function="rowid" as="vr_rb_equip_id" key="1" />
        <column table="a" column="pwrc_fdrid" type="number" title="" />
        <column table="a" column="pwrc_fdrname" type="string" data-size="206" title="" />
        <column table="a" column="src_id" type="number" title="" />
        <column table="a" column="srcname" type="string" data-size="123" title="" />
        <column table="a" column="src_fdrid" type="number" title="" />
        <column table="a" column="src_fdrname" type="string" data-size="100" title="" comment="Наименование может содержаь смещение, указывающее на подчиненность более старшему элементу" />
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" data-size="121" title="" />
        <column table="a" column="srckodp_fsk" type="number" title="" />
        <column table="a" column="pwrc_fdr_bkod_ecls" type="number" />
        <column table="a" column="isprm_fdr" type="string" data-size="3" title="" />
        <column table="a" column="kod_eqsep" type="number" />
        <column table="a" column="pwrc_fdr_expl_id" type="number" title="" />
        <column table="a" column="src_fdrord" type="number" column-mandatory="1" title="" comment="Порядок сортировки оборудования в энергообъекте" />
        <column table="a" column="src_fdrname_orig" type="string" data-size="100" title="" comment="Исходное наименование оборудования" />
        <column table="a" column="src_balnamex" type="string" data-size="100" title="" comment="Балансовая принадлежность энергообъекта. Особеность - если филиал. то его наименование, прочие - Потребитель" />
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
      </select>
      <from>
        <table name="vr_rb_equip" as="a" />
      </from>
      <where>
        <call function="=">
          <const>1</const>
          <const>2</const>
        </call>
      </where>
    </query>
    <query name="vr_rb_eq_kg" class="1" timestamp="26.06.2019 14:33:42" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_equip.xml">
      <select>
        <call as="grid_dtl_kg" function="||-" key="1">
          <column table="a" column="pwrc_fdrid" />
          <column table="a" column="src_fdrid" />
          <column table="this" column="ym" />
        </call>
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="srcname" type="string" title="" />
        <column table="a" column="src_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" is-fact="1" agg="max" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="srckodp_fsk" type="number" column-mandatory="1" title="" />
        <column table="a" column="hv_eopwrc_grid_id" type="string" title="" />
        <column table="a" column="src_fdrord" type="number" />
        <column table="k_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_f_tp" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="pwrc_fdrid" column="bal_id" />
        <column table="kod_fl" column="kod_fl" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
      </select>
      <from>
        <query name="vr_rb_equip" as="a" />
        <query name="d45862_fdr_kg" as="k_f_tp" join="left outer">
          <call function="=">
            <column table="this" column="hv_eopwrc_grid_id" />
            <column table="k_f_tp" column="k_f_tp" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="id" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <links>
        <link name="k_f_tp">
          <dimlink name="kg_name" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="vr_rb_fact" class="1" timestamp="15.04.2021 02:39:58" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="rowid" as="id " key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <call as="bal_id_act" function="case">
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Лупполово">59071</const>
            </call>
            <const comment="ВВ ЭС -&gt; ПрЭС">12968</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Северная долина">208972</const>
            </call>
            <const comment="ВВ ЭС -&gt; КС">13082</const>
          </call>
          <call function="else">
            <column table="a" column="bal_id" />
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_nas_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_nas_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <call function="if" as="count_tu_mkd" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_mkd_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_mkd_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_mkd_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_mkd_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_mkd_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_izs" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_izs_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_izs_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_izs_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_izs_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_izs_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_ul_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_ul_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_ul_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_pwrc_g" as="pwrc_id" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id_act" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl_real" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl_real" column="kod_fl" />
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="pwrc_id" table="a" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="bal_id" table="a" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="def_fdr" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_fdr" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="not in">
          <column table="a" column="bal_id" />
          <const>(13082, 12968)</const>
        </call>
      </where>
    </query>
    <query name="vr_rb_fact_test" class="1" timestamp="20.02.2019 21:33:33" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <call as="bal_id_act" function="case">
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Лупполово">59071</const>
            </call>
            <const comment="ВВ ЭС -&gt; ПрЭС">12968</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Северная долина">208972</const>
            </call>
            <const comment="ВВ ЭС -&gt; КС">13082</const>
          </call>
          <call function="else">
            <column table="a" column="bal_id" />
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_nas_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_nas_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="kg_name" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="kod_fl" column="ym" exclude="1" />
        <column table="kod_fl" column="ym" as="ym_dat" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id_act" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym_dat" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
            <call function="=" exclude="1">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="not in">
          <column table="a" column="bal_id" />
          <const>(13082, 12968)</const>
        </call>
      </where>
    </query>
    <query name="vr_rb_fact_test2" class="1" timestamp="24.01.2023 07:27:31" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <column table="a" column="wp_in_raw" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <call function="if">
            <call function="=">
              <call function="nvl0">
                <column table="k_gr_f_tp" column="exclude_auto_fdr" />
              </call>
              <const>0</const>
            </call>
            <column table="a" column="wp_in" />
          </call>
          <column table="a" column="wp_in" exclude="1" />
        </call>
        <call function="if" as="wp_in_raw_fdr" type="number" is-fact="1" agg="max">
          <call function="=">
            <call function="nvl0">
              <column table="k_gr_f_tp" column="exclude_auto_fdr" />
            </call>
            <const>0</const>
          </call>
          <column table="a" column="wp_in_raw" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="wp_out_raw" type="number" title="" />
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="constypex" type="string" />
        <column table="a" column="count_tu_auto" type="number" />
        <column table="a" column="count_tu_hand" type="number" />
        <column table="a" column="count_tu_no" type="number" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call type="number" function="if" as="wp_out_raw_fdr" is-fact="1" agg="max">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <column table="a" column="wp_out_raw" />
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_mkd" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_izs" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_mkd_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_izs_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_mkd_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_izs_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_ul_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_mkd_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_izs_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_ul_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_mkd_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_izs_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_ul_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_mkd_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_izs_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym_dat" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="def_fdr" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_fdr" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_fact_52733" class="1" timestamp="23.05.2019 19:35:45" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="rowid" as="rid" key="1" exclude="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" exclude="1" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" exclude="1" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" exclude="1" />
        <column table="a" column="constype" type="string" title="" exclude="1" />
        <column table="a" column="wp_in" type="number" title="" exclude="1" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum" exclude="1">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_in_fdr" is-fact="1" agg="sum" />
        <column table="a" column="wp_out" type="number" title="" exclude="1" />
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" exclude="1" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="constypex" type="string" exclude="1" />
        <column table="a" column="count_tu_auto" type="number" exclude="1" />
        <column table="a" column="count_tu_hand" type="number" exclude="1" />
        <column table="a" column="count_tu_no" type="number" exclude="1" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum" exclude="1">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <column table="a" column="wp_out_fdr" is-fact="1" agg="sum" />
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <query name="vr_rb_fact_52733_presum" as="a" />
        <table name="vr_rb_fact" as="a" exclude="1" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=" exclude="1">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_fact_52733_presum" class="1" timestamp="23.05.2019 19:50:31" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" group="1" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" group="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" group="1" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" group="1" />
        <column table="a" column="ym" type="number" group="1" />
        <column table="a" column="wp_in_fdr" type="number" title="" group="sum" />
        <column table="a" column="wp_out_fdr" type="number" title="" group="sum" />
      </select>
      <from>
        <query name="vr_rb_fact_tbl" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_tbl" class="1" timestamp="23.05.2019 19:28:17" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="id_dat" type="number" />
        <column table="a" column="ym" type="number" />
        <column table="a" column="constypex" type="string" />
        <column table="a" column="count_tu_auto" type="number" />
        <column table="a" column="count_tu_hand" type="number" />
        <column table="a" column="count_tu_no" type="number" />
        <column table="a" column="count_tp" type="number" />
        <column table="a" column="count_tp_0" type="number" title="" />
        <column table="a" column="count_tp_null" type="number" title="" />
        <column table="a" column="count_tu" type="number" title="" />
        <column table="a" column="count_tu_0" type="number" title="" />
        <column table="a" column="count_tu_null" type="number" title="" />
        <call type="number" function="if" as="wp_out_fdr">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_52733_2" class="1" timestamp="28.05.2021 17:58:25" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact.xml">
      <select>
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="src_fdrid" type="number" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="wp_in" is-fact="1" agg="sum" as="wp_in_fdr" exclude="1" />
        <column table="a" column="wp_in" type="number" />
        <call type="number" function="if" as="wp_in_fdr" is-fact="1" agg="sum">
          <call function="=">
            <call function="nvl0">
              <column table="k_gr_f_tp" column="exclude_auto_fdr" />
            </call>
            <const>0</const>
          </call>
          <column table="this" column="wp_in" />
        </call>
        <column table="a" column="wp_out" is-fact="1" agg="sum" as="wp_out_fdr" />
        <column table="a" column="wp_out_1" as="wp_out_fdr_1" is-fact="1" agg="sum" />
        <column table="a" column="wp_out_2" as="wp_out_fdr_2" is-fact="1" agg="sum" />
        <column table="a" column="wp_out_3" as="wp_out_fdr_3" is-fact="1" agg="sum" />
        <column table="a" column="pnt_fdr" type="number" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid" type="number" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_1" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_2" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_3" is-fact="1" agg="sum" />
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
        <call as="grid_dtl_kg" function="||-">
          <column table="a" column="pwrc_fdrid" />
          <column table="a" column="src_fdrid" />
          <column table="a" column="ym" />
        </call>
      </select>
      <from>
        <table name="vr_rb_fact_presum_52733" as="a" exclude="1" />
        <query name="vr_rb_fact_presum_52733" as="a" />
        <query name="vr_rb_eq_kg" as="pwrc_grid_dtl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="grid_dtl_kg" />
            <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
            <call function="replace" exclude="1">
              <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
              <const>9999.99</const>
              <column table="this" column="ym" />
            </call>
          </call>
        </query>
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_fact_mv" class="1" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact_mv.xml">
      <select>
        <call function="rowid" as="vr_rb_fact_mv_id" key="1" />
        <column table="a" column="kod_fl" type="number" />
        <column table="a" column="ym" type="number" title="" />
      </select>
      <from>
        <table name="vr_rb_fact_mv" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_presum_52733" class="1" timestamp="28.05.2021 17:59:11" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact_presum_52733.xml">
      <select>
        <call function="rowid" as="vr_rb_fact_presum_52733_id" key="1" />
        <column table="a" column="bal_id" type="number" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="src_id" type="number" title="" />
        <column table="a" column="src_fdrid" type="number" title="" />
        <column table="a" column="ym" type="number" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="pnt_fdr" type="number" title="" />
        <column table="a" column="pnt_grid" type="number" title="" />
        <column table="a" column="pnt_grid_1" type="number" title="Количество точек учёта ЮЛ" />
        <column table="a" column="pnt_grid_2" type="number" title="Количество точек учёта МКД" />
        <column table="a" column="pnt_grid_3" type="number" title="Количество точек учёта ИЖС" />
        <column table="a" column="wp_out_1" type="number" title="Поступление ЮЛ" />
        <column table="a" column="wp_out_2" type="number" title="" />
        <column table="a" column="wp_out_3" type="number" title="" />
      </select>
      <from>
        <table name="vr_rb_fact_presum_52733" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_ym" class="1" file="sql.builder.templates\sql.builder\projects\49277\scheme\original\vr_rb_fact_ym.xml">
      <select>
        <call function="rowid" as="vr_rb_fact_ym_id" key="1" />
        <column table="a" column="bal_id" type="number" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="src_id" type="number" title="" />
        <column table="a" column="src_fdrid" type="number" title="" />
        <column table="a" column="gr" type="number" title="" />
        <column table="a" column="constype" type="string" data-size="20" title="" />
        <column table="a" column="constypex" type="string" data-size="20" title="" />
        <column table="a" column="ym" type="number" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="count_tp" type="number" title="" />
        <column table="a" column="count_tp_0" type="number" title="" />
        <column table="a" column="count_tp_null" type="number" title="" />
        <column table="a" column="count_tu" type="number" title="" />
        <column table="a" column="count_tu_0" type="number" title="" />
        <column table="a" column="count_tu_null" type="number" title="" />
        <column table="a" column="count_tu_auto" type="number" title="" />
        <column table="a" column="count_tu_hand" type="number" title="" />
        <column table="a" column="count_tu_no" type="number" title="" />
        <column table="a" column="wp_in_raw" type="number" title="" />
        <column table="a" column="wp_out_raw" type="number" title="" />
      </select>
      <from>
        <table name="vr_rb_fact_ym" as="a" />
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id">
    <part id="49277-params_test2" timestamp="13.10.2020 18:41:02" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <param name="id_dat" type="number">
        <const>4041</const>
      </param>
      <param name="w_num" type="string" />
      <param name="kod_fl" type="array">
        <const>12968</const>
      </param>
      <param name="hv_eopwrc_id" type="array" />
      <param name="pwrc_id" type="array" />
      <param name="k_kg_name" type="array" />
      <param name="pwrc_fdrid" type="array" />
      <param name="prev_slice_dat" type="date" />
    </part>
    <part id="49277-useparams_test2" timestamp="01.10.2020 18:21:46" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <useparam name="id_dat" />
      <useparam name="w_num" />
      <useparam name="kod_fl" />
      <useparam name="hv_eopwrc_id" />
      <useparam name="pwrc_id" />
      <useparam name="k_kg_name" />
      <useparam name="pwrc_fdrid" />
      <useparam name="prev_slice_dat" />
    </part>
  </parts>
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="49277" title="Отчет о выполненных работах по устранению пофидерных небалансов" mode="excel" timestamp="26.02.2019 16:52:13" form="empty" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <print-templates>
        <excel>
          <template name="49277.xlsx" title="Отчет о выполненных работах по устранению пофидерных небалансов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="title_49277" as="t" />
        <query name="main_49277" as="a" />
      </queries>
    </report>
    <report name="49277_test" title="Отчет о выполненных работах по устранению пофидерных небалансов ТЕСТ" mode="excel" timestamp="26.02.2019 16:53:42" form="49277_test" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <params>
        <param name="ym_s" type="number" />
        <param name="ym_po" type="number" />
      </params>
      <procedure>
        <text>
    DECLARE
        id_dat__ number;
    BEGIN
        select max(id_dat)
        into id_dat__
        from vr_rb_dat;
    
        sqlb_d45862_fdr_kg.fill_table_fl_ym(id_dat__);
        
        delete from rr_temp where skod = '45862_fdr_lst';
        insert into rr_temp (skod, n1)
        select distinct '45862_fdr_lst' as skod, a.pwrc_fdrid
        from vr_rb_fider a
        where a.pwrc_fdrid in (8873, 8874, 8875, 8876, 8872, 56264, 56274, 56276, 56266, 56268, 56269, 56270, 56271,
                                56272, 56273, 1865, 1866, 1867, 1868, 79387, 79388, 79491, 59181, 59180, 59179, 59177,
                                59182, 59183, 59184, 382276, 472188, 1229, 6670, 6667, 85354, 85355);
                                
        jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);
        --sqlb_d45862_fdr_kg.fill_table(:ym_s, :ym_po);
        sqlb_d45862_fdr_kg.FILL_TEMP(:ym_s, :ym_po);
        asuse.sqlb_d45862_fdr_kg.fill_table_by_dat(0);
    END;
</text>
      </procedure>
      <print-templates>
        <excel>
          <template name="49277_test.xlsx" title="Отчет о выполненных работах по устранению пофидерных небалансов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="title_49277" as="t" />
        <query name="main_49277_test" as="a" />
      </queries>
    </report>
    <report name="49277_test2" form="49277_test2" nogrid="1" mode="excel" title="3.2. Отчет о выполненных работах по устранению небалансов за неделю" timestamp="15.12.2022 19:00:00" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <param name="id_dat" type="number" />
        <param name="w_num" type="string" />
        <param name="kod_fl" type="array" mode="store" />
        <param name="hv_eopwrc_id" type="array" />
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
        <param name="pwrc_fdrid" type="array" mode="store" />
        <param name="prev_slice_dat" type="date" />
      </params>
      <procedure><![CDATA[DECLARE
  p_id_dat   vr_rb_fact.id_dat%type;
  n_ym_s     NUMBER(6, 2);
  n_ym_po    NUMBER(6, 2);
BEGIN
  p_id_dat := :id_dat;
  -- Определяем ym
  select case when min(a.ym)=0 then kg.ym_add(max(a.ym), -1) else min(a.ym) end,
         max(a.ym)
  into   n_ym_s, n_ym_po
  from   vr_rb_fact a
  where  a.id_dat <= :id_dat;
  --
  DELETE FROM vr_array_storage WHERE array_id = 'fl_id';
  INSERT INTO vr_array_storage (array_id, nval)
    SELECT 'fl_id', nval FROM vr_array_storage WHERE array_id = 'kod_fl';
  jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);
  --
  -- sqlb_d45862_fdr_kg.FILL_TEMP(ym_s__, ym_po__);
  DELETE FROM rr_temp WHERE skod IN ('{8AF26E4F-7324-4724-8038-724EF07A3B09}', '45862_tp_kg', 'd45862_fdr_kg');
  INSERT INTO rr_temp (skod, n1, n2, s1, s2)
    SELECT '{8AF26E4F-7324-4724-8038-724EF07A3B09}', pwrc_fdrid, src_id, srcname, srcbalname
    FROM   hv_eopwrc_grid
    WHERE  pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')
    UNION
    SELECT '{8AF26E4F-7324-4724-8038-724EF07A3B09}', a.pwrc_fdrid, a.src_id, NVL(b.srcname, a.srcname) AS srcname, NVL(b.srcbalname, a.srcbalname) AS srcbalname
    FROM   vr_rb_tp a LEFT OUTER JOIN hv_eopwrc_grid b on a.pwrc_fdrid = b.pwrc_fdrid and a.src_id = b.src_id
    WHERE  a.pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid');
  --
  -- 45862_tp_kg
  INSERT INTO rr_temp (skod, s1, -- id
                     s2, --k_gr_f_tp
                     s3, --k_f_tp
                     n1, --is_tp_gr
                     s4, --name
                     n2, --kod_kol_gr
                     n3--ym
                     )
    SELECT '45862_tp_kg' as skod,
           kod_kol_gr.kod_kol_gr||'-'||a.pwrc_fdrid||'-'||tpn.src_id||ym as id,
           kod_kol_gr.kod_kol_gr||'-'||a.pwrc_fdrid||'-'||tpn.src_id as k_gr_f_tp,
           a.pwrc_fdrid||'-'||tpn.src_id as k_f_tp,
           case when tp.src_id is not null or tpsel.kod_kol_gr_fdr is null or tpn.src_id is null then 1 else 0 end as is_tp_gr,
           kod_kol_gr.name||case when kod_kol_gr.kol_gr_comment is not null then ' ['||kod_kol_gr.kol_gr_comment||']' end as name,
           kod_kol_gr.kod_kol_gr, ym.ym
    FROM   vb_kol_gr_fdr a
           left outer join (select kod_kol_gr_fdr from vb_kol_gr_tp group by kod_kol_gr_fdr) tpsel on a.kod_kol_gr_fdr = tpsel.kod_kol_gr_fdr
           left outer join vb_kol_gr_pwrc kod_kol_gr_pwrc on a.kod_kol_gr_pwrc = kod_kol_gr_pwrc.kod_kol_gr_pwrc
           left outer join vb_kol_gr_nastr kod_kol_gr_nastr on kod_kol_gr_pwrc.kod_kol_gr_nastr = kod_kol_gr_nastr.kod_kol_gr_nastr
           left outer join (SELECT t.column_value as ym FROM TABLE(kg.ym_numerator(n_ym_s, n_ym_po)) t) ym on ym.ym between kod_kol_gr_nastr.s and nvl(kod_kol_gr_nastr.po, n_ym_po)
           left outer join vb_kol_gr kod_kol_gr on kod_kol_gr_nastr.kod_kol_gr = kod_kol_gr.kod_kol_gr
           left outer join (SELECT n1 as pwrc_fdrid, n2 as src_id FROM rr_temp WHERE skod = '{8AF26E4F-7324-4724-8038-724EF07A3B09}') tpn on a.pwrc_fdrid = tpn.pwrc_fdrid
           left outer join vb_kol_gr_tp tp on a.kod_kol_gr_fdr = tp.kod_kol_gr_fdr and (tpn.src_id = tp.src_id);
  -- d45862_fdr_kg
  INSERT INTO rr_temp (skod, --skod
                     sid, --sid
                     rn, --rn
                     s1, --id
                     s2, --k_gr_f_tp
                     s3, --k_f_tp
                     s4, --k_kg_name
                     n1, --pwrc_id
                     s5, --kg_name
                     n2, --kod_kol_gr
                     n3, --pwrc_fdrid
                     s6, --real_fdr
                     s7, --isprm_fdr
                     s8, --pwrc_fdr_explname
                     n4, --src_id
                     s9, --srcname
                     s10, --srcbalname
                     n5, --ym
                     s11 --kg_name_w_real_fdr
                     )
     select 'd45862_fdr_kg' as skod, 'd45862_fdr_kg|#'||mtr.id as sid, row_number() over (order by 1) as rn, mtr.*
     from  (select case when (tp_kg.is_tp_gr = 1) then tp_kg.id else ('' || '-' || hv_eopwrc_grid.hv_eopwrc_grid_id || '-' || ym.ym ) end as id,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.k_gr_f_tp else ('' || '-' || hv_eopwrc_grid.hv_eopwrc_grid_id) end as k_gr_f_tp,
                   hv_eopwrc_grid.hv_eopwrc_grid_id as k_f_tp,
                   case when (tp_kg.is_tp_gr = 1) then (tp_kg.kod_kol_gr || '-') else ('-' || a.pwrc_fdrid || '-') end as k_kg_name,
                   a.pwrc_id as pwrc_id,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.name else a.pwrc_fdrname end as kg_name,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.kod_kol_gr end as kod_kol_gr,
                   a.pwrc_fdrid as pwrc_fdrid,
                   ( SUBSTR( a.pwrcname , ( nvl( ( instr( a.pwrcname , '(' ) ) ,0) +nvl( 1 ,0) ) , (( instr( a.pwrcname , ')' ) ) - ( instr( a.pwrcname , '(' ) ) - 1) ) ) || ' (' || a.pwrc_fdrname || ')' as real_fdr,
                   a.isprm_fdr as isprm_fdr,
                   a.pwrc_fdr_explname as pwrc_fdr_explname,
                   hv_eopwrc_grid.src_id as src_id,
                   hv_eopwrc_grid.srcname as srcname,
                   hv_eopwrc_grid.srcbalname as srcbalname,
                   ym.ym as ym,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.name else ( SUBSTR( a.pwrcname , ( nvl( ( instr( a.pwrcname , '(' ) ) ,0) +nvl( 1 ,0) ) , (( instr( a.pwrcname , ')' ) ) - ( instr( a.pwrcname , '(' ) ) - 1) ) ) || ' (' || a.pwrc_fdrname || ')' end as kg_name_w_real_fdr
            from  (select a.pwrc_fdrid, a.pwrc_fdrname, a.isprm_fdr, a.pwrc_id, a.pwrcname, a.pwrc_fdr_explname
                   from   hv_eopwrc_fdrs a
                   WHERE  a.pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')) a
                   cross join (SELECT t.column_value as ym FROM TABLE(kg.ym_numerator(n_ym_s, n_ym_po)) t) ym
                   left outer join (SELECT TO_CHAR(n1)||'-'||TO_CHAR(n2) as hv_eopwrc_grid_id,  n1 as pwrc_fdrid, n2 AS src_id, s1 AS srcname, s2 AS srcbalname FROM rr_temp WHERE skod = '{8AF26E4F-7324-4724-8038-724EF07A3B09}') hv_eopwrc_grid on hv_eopwrc_grid.pwrc_fdrid = a.pwrc_fdrid
                   left outer join (select /*+ dynamic_sampling(rr_temp 10)*/ s1 as id, s2 as k_gr_f_tp, s3 as k_f_tp, n1 as is_tp_gr, s4 as name, n2 as kod_kol_gr, n3 as ym from rr_temp where skod = '45862_tp_kg') tp_kg on tp_kg.k_f_tp = hv_eopwrc_grid.hv_eopwrc_grid_id and tp_kg.ym = ym.ym
            where  nvl(tp_kg.is_tp_gr, 1) = 1
               and a.pwrc_fdrid in (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')) mtr;
  --
  sqlb_d45862_fdr_kg.fill_table_by_dat(p_id_dat);
  DELETE FROM rr_temp WHERE skod IN ('{8AF26E4F-7324-4724-8038-724EF07A3B09}', '45862_tp_kg');
END;]]></procedure>
      <print-templates>
        <excel>
          <template name="49277_test2.xlsx" title="Отчет о выполненных работах по устранению пофидерных небалансов за неделю" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="title_49277" as="t">
          <withparams>
            <usepart part="49277-useparams_test2" />
          </withparams>
        </query>
        <query name="main_49277_32" as="a">
          <withparams>
            <usepart part="49277-useparams_test2" />
          </withparams>
        </query>
        <query name="main_49277_32_without_kg" as="b">
          <withparams>
            <usepart part="49277-useparams_test2" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="49277_test3" form="49277_test3" nogrid="1" mode="excel" title="3.1. Отчет о выполненных работах по устранению небалансов за период" timestamp="15.12.2022 17:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <param name="stage3" type="number" />
        <param name="kod_fl" type="array" mode="store" />
        <param name="hv_eopwrc_id" type="array" mode="store" />
        <param name="pwrc_id" type="array" mode="store" />
        <param name="k_kg_name" type="array" mode="store" />
        <param name="pwrc_fdrid" type="array" mode="store" />
      </params>
      <procedure><![CDATA[DECLARE
  p_ym  NUMBER(6,2);
BEGIN
  p_ym := :stage3;
  --
  DELETE FROM vr_array_storage WHERE array_id = 'fl_id';
  INSERT INTO vr_array_storage (array_id, nval)
    SELECT 'fl_id', nval FROM vr_array_storage WHERE array_id = 'kod_fl';
  jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);
  --
  -- sqlb_d45862_fdr_kg.FILL_TEMP(p_ym, p_ym);
  DELETE FROM rr_temp WHERE skod IN ('{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}', '45862_tp_kg', 'd45862_fdr_kg');
  INSERT INTO rr_temp (skod, n1, n2, s1, s2)
    SELECT '{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}', pwrc_fdrid, src_id, srcname, srcbalname
    FROM   hv_eopwrc_grid
    WHERE  pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')
    UNION
    SELECT '{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}', a.pwrc_fdrid, a.src_id, NVL(b.srcname, a.srcname) AS srcname, NVL(b.srcbalname, a.srcbalname) AS srcbalname
    FROM   vr_rb_tp a LEFT OUTER JOIN hv_eopwrc_grid b on a.pwrc_fdrid = b.pwrc_fdrid and a.src_id = b.src_id
    WHERE  a.pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid');
  -- 45862_tp_kg
  INSERT INTO rr_temp (skod, s1, -- id
                     s2, --k_gr_f_tp
                     s3, --k_f_tp
                     n1, --is_tp_gr
                     s4, --name
                     n2, --kod_kol_gr
                     n3--ym
                     )
    SELECT '45862_tp_kg' as skod,
           kod_kol_gr.kod_kol_gr||'-'||a.pwrc_fdrid||'-'||tpn.src_id||ym as id,
           kod_kol_gr.kod_kol_gr||'-'||a.pwrc_fdrid||'-'||tpn.src_id as k_gr_f_tp,
           a.pwrc_fdrid||'-'||tpn.src_id as k_f_tp,
           case when tp.src_id is not null or tpsel.kod_kol_gr_fdr is null or tpn.src_id is null then 1 else 0 end as is_tp_gr,
           kod_kol_gr.name||case when kod_kol_gr.kol_gr_comment is not null then ' ['||kod_kol_gr.kol_gr_comment||']' end as name,
           kod_kol_gr.kod_kol_gr, ym.ym
    FROM   vb_kol_gr_fdr a
           left outer join (select kod_kol_gr_fdr from vb_kol_gr_tp group by kod_kol_gr_fdr) tpsel on a.kod_kol_gr_fdr = tpsel.kod_kol_gr_fdr
           left outer join vb_kol_gr_pwrc kod_kol_gr_pwrc on a.kod_kol_gr_pwrc = kod_kol_gr_pwrc.kod_kol_gr_pwrc
           left outer join vb_kol_gr_nastr kod_kol_gr_nastr on kod_kol_gr_pwrc.kod_kol_gr_nastr = kod_kol_gr_nastr.kod_kol_gr_nastr
           left outer join (SELECT p_ym as ym FROM dual) ym on ym.ym between kod_kol_gr_nastr.s and nvl(kod_kol_gr_nastr.po, p_ym)
           left outer join vb_kol_gr kod_kol_gr on kod_kol_gr_nastr.kod_kol_gr = kod_kol_gr.kod_kol_gr
           left outer join (SELECT n1 as pwrc_fdrid, n2 as src_id FROM rr_temp WHERE skod = '{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}') tpn on a.pwrc_fdrid = tpn.pwrc_fdrid
           left outer join vb_kol_gr_tp tp on a.kod_kol_gr_fdr = tp.kod_kol_gr_fdr and (tpn.src_id = tp.src_id);
  -- d45862_fdr_kg
  INSERT INTO rr_temp (skod, --skod
                     sid, --sid
                     rn, --rn
                     s1, --id
                     s2, --k_gr_f_tp
                     s3, --k_f_tp
                     s4, --k_kg_name
                     n1, --pwrc_id
                     s5, --kg_name
                     n2, --kod_kol_gr
                     n3, --pwrc_fdrid
                     s6, --real_fdr
                     s7, --isprm_fdr
                     s8, --pwrc_fdr_explname
                     n4, --src_id
                     s9, --srcname
                     s10, --srcbalname
                     n5, --ym
                     s11 --kg_name_w_real_fdr
                     )
     select 'd45862_fdr_kg' as skod, 'd45862_fdr_kg|#'||mtr.id as sid, row_number() over (order by 1) as rn, mtr.*
     from  (select case when (tp_kg.is_tp_gr = 1) then tp_kg.id else ('' || '-' || hv_eopwrc_grid.hv_eopwrc_grid_id || '-' || ym.ym ) end as id,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.k_gr_f_tp else ('' || '-' || hv_eopwrc_grid.hv_eopwrc_grid_id) end as k_gr_f_tp,
                   hv_eopwrc_grid.hv_eopwrc_grid_id as k_f_tp,
                   case when (tp_kg.is_tp_gr = 1) then (tp_kg.kod_kol_gr || '-') else ('-' || a.pwrc_fdrid || '-') end as k_kg_name,
                   a.pwrc_id as pwrc_id,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.name else a.pwrc_fdrname end as kg_name,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.kod_kol_gr end as kod_kol_gr,
                   a.pwrc_fdrid as pwrc_fdrid,
                   ( SUBSTR( a.pwrcname , ( nvl( ( instr( a.pwrcname , '(' ) ) ,0) +nvl( 1 ,0) ) , (( instr( a.pwrcname , ')' ) ) - ( instr( a.pwrcname , '(' ) ) - 1) ) ) || ' (' || a.pwrc_fdrname || ')' as real_fdr,
                   a.isprm_fdr as isprm_fdr,
                   a.pwrc_fdr_explname as pwrc_fdr_explname,
                   hv_eopwrc_grid.src_id as src_id,
                   hv_eopwrc_grid.srcname as srcname,
                   hv_eopwrc_grid.srcbalname as srcbalname,
                   ym.ym as ym,
                   case when (tp_kg.is_tp_gr = 1) then tp_kg.name else ( SUBSTR( a.pwrcname , ( nvl( ( instr( a.pwrcname , '(' ) ) ,0) +nvl( 1 ,0) ) , (( instr( a.pwrcname , ')' ) ) - ( instr( a.pwrcname , '(' ) ) - 1) ) ) || ' (' || a.pwrc_fdrname || ')' end as kg_name_w_real_fdr
            from  (select a.pwrc_fdrid, a.pwrc_fdrname, a.isprm_fdr, a.pwrc_id, a.pwrcname, a.pwrc_fdr_explname
                   from   hv_eopwrc_fdrs a
                   WHERE  a.pwrc_fdrid IN (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')) a
                   cross join (SELECT p_ym as ym FROM dual) ym
                   left outer join (SELECT TO_CHAR(n1)||'-'||TO_CHAR(n2) as hv_eopwrc_grid_id,  n1 as pwrc_fdrid, n2 AS src_id, s1 AS srcname, s2 AS srcbalname FROM rr_temp WHERE skod = '{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}') hv_eopwrc_grid on hv_eopwrc_grid.pwrc_fdrid = a.pwrc_fdrid
                   left outer join (select /*+ dynamic_sampling(rr_temp 10)*/ s1 as id, s2 as k_gr_f_tp, s3 as k_f_tp, n1 as is_tp_gr, s4 as name, n2 as kod_kol_gr, n3 as ym from rr_temp where skod = '45862_tp_kg') tp_kg on tp_kg.k_f_tp = hv_eopwrc_grid.hv_eopwrc_grid_id and tp_kg.ym = ym.ym
            where  nvl(tp_kg.is_tp_gr, 1) = 1
               and a.pwrc_fdrid in (SELECT nval FROM vr_array_storage WHERE array_id = 'pwrc_fdrid')) mtr;
  sqlb_d45862_fdr_kg.fill_table_by_dat(0);
  DELETE FROM rr_temp WHERE skod IN ('{D1DEC229-CEA9-4E18-B269-14ACE3A371BA}', '45862_tp_kg');
END;]]></procedure>
      <print-templates>
        <excel>
          <template name="49277_test3.xlsx" title="Отчет о выполненных работах по устранению пофидерных небалансов за отчетный период" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="title_49277_test3" as="t">
          <withparams>
            <useparam name="stage3" />
            <useparam name="kod_fl" />
            <useparam name="hv_eopwrc_id" />
            <useparam name="pwrc_id" />
            <useparam name="k_kg_name" />
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
        <query name="main_49277_31" as="a">
          <withparams>
            <useparam name="stage3" />
            <useparam name="kod_fl" />
            <useparam name="hv_eopwrc_id" />
            <useparam name="pwrc_id" />
            <useparam name="k_kg_name" />
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
        <query name="main_49277_31_without_kg" as="b">
          <withparams>
            <useparam name="stage3" />
            <useparam name="kod_fl" />
            <useparam name="hv_eopwrc_id" />
            <useparam name="pwrc_id" />
            <useparam name="k_kg_name" />
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="52733" form="52733" title="5. Накопительный итог" mode="excel" nogrid="1" timestamp="03.10.2022 14:30:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <params>
        <param type="number" name="year" />
        <param name="kod_fl" type="array" />
        <param name="hv_eopwrc_id" type="array" />
        <param name="pwrc_id" type="array" />
        <param name="pwrc_fdrid" type="array" />
      </params>
      <procedure>
        DECLARE
            p_year    NUMBER(4, 0);
            n_beg_ym  NUMBER(6, 2);
            n_end_ym  NUMBER(6, 2);
        BEGIN
            p_year   := :year;
            n_beg_ym := p_year + 0.01;
            n_end_ym := p_year + 0.12;
            delete from rr_temp where skod in ('52733_fl_lst', '45862_fdr_lst');
            
            insert into rr_temp (skod, n1)
            select distinct '52733_fl_lst' as skod, a.kod_fl
            from jv_rep_cons_d_fl a
            where a.kod_fl in :kod_fl;
                
            insert into rr_temp (skod, n1)
            select '45862_fdr_lst' as skod, a.pwrc_fdrid
            from vr_rb_fider a
            where a.pwrc_fdrid in :pwrc_fdrid
            union
            select '45862_fdr_lst' as skod, a.pwrc_fdrid
            from hv_eopwrc_fdrs a
            where a.pwrc_fdrid in :pwrc_fdrid;
                    
            asuse.jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);                
            sqlb_d45862_fdr_kg.vr_rb_fact_presum_proc(n_beg_ym, n_end_ym);
            sqlb_d45862_fdr_kg.FILL_TEMP(n_beg_ym, n_end_ym);
            sqlb_d45862_fdr_kg.fill_table_by_dat(0);
        END;
      </procedure>
      <print-templates>
        <excel>
          <template name="52733.xlsx" title="Накопительный итог" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="main_52733_2" as="a">
          <withparams>
            <useparam name="year" />
            <useparam name="kod_fl" />
            <useparam name="hv_eopwrc_id" />
            <useparam name="pwrc_id" />
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
        <query name="main_52733" as="a" exclude="1">
          <withparams>
            <useparam name="year" />
            <useparam name="kod_fl" />
            <useparam name="hv_eopwrc_id" />
            <useparam name="pwrc_id" />
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="53605" title="6. Итоги (тест)" mode="excel" timestamp="05.11.2019 18:28:39" form="52733" nogrid="1" file="sql.builder.templates\sql.builder\projects\49277\reports\53605-rep.xml">
      <params>
        <usepart part="52733-params" />
      </params>
      <procedure>
        <text>
        BEGIN
            delete from rr_temp where skod in ('52733_fl_lst', '52733_hv_eopwrc_lst', '45862_fdr_lst');
            
            insert into rr_temp (skod, n1)
            select distinct '52733_fl_lst' as skod, a.kod_fl
            from jv_rep_cons_d_fl a
            where a.kod_fl in :kod_fl;
            
            insert into rr_temp (skod, s1)
            select distinct '52733_hv_eopwrc_lst' as skod, a.pwrc_id || '-' || a.bal_id
            from hv_eopwrc a
            where a.pwrc_id || '-' || a.bal_id in :hv_eopwrc_id;
                
            insert into rr_temp (skod, n1)
            select distinct '45862_fdr_lst' as skod, a.pwrc_fdrid
            from vr_rb_fider a
            where a.pwrc_fdrid in :pwrc_fdrid
                union
            select '45862_fdr_lst' as skod, a.pwrc_fdrid
            from hv_eopwrc_fdrs a
            where a.pwrc_fdrid in :pwrc_fdrid;
                    
            asuse.jg_reports_ise.jr_rep_blns_pwrc_sx_init(0, 1);                
            sqlb_d45862_fdr_kg.vr_rb_fact_presum_proc(:stage01, :stage12);
            sqlb_d45862_fdr_kg.FILL_TEMP(:stage01, :stage12);
            sqlb_d45862_fdr_kg.fill_table_by_dat(0);
            
            sqlb_d45862_fdr_kg.vr_rb_fact_progr_total_proc(trunc(:stage01));
        END;
    </text>
      </procedure>
      <print-templates>
        <excel>
          <template name="53605.xlsx" print-proc="2" print-xlsx="1" title="Отчет Итоги" />
        </excel>
      </print-templates>
      <queries>
        <query name="title_53605" as="t">
          <withparams>
            <usepart part="52733-useparams" />
          </withparams>
        </query>
        <query name="main_53605_2" as="a">
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail" column="fact_ps">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_0_10" column="neb_0_10">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_10_20" column="neb_10_20">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_10_30" column="neb_10_30">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_30_50" column="neb_30_50">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_20_50" column="neb_20_50">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_50_100" column="neb_50_100">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_100" column="neb_100">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_null" column="neb_null">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_min_0_10" column="neb_min_0_10">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_min_10_20" column="neb_min_10_20">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_min_20_50" column="neb_min_20_50">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_min_50_100" column="neb_min_50_100">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail_min_100" column="neb_min_100">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
        <query name="main_53605" as="a" exclude="1">
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="53605_detail" column="plan_ps">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="49277_vb_rb_default" timestamp="21.02.2021 06:23:55" title="3.3. Настройка формы отчета о выполненных работах (фиксация параметров)" file="sql.builder.templates\sql.builder\projects\49277\form\forms.xml">
      <content>
        <usefield field="cmn_list" title="Филиал" name="kod_fl" column-mandatory="1" type="number" show-checkbox="0">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
        </usefield>
        <splitcontainer>
          <fieldgroup title="ПС">
            <grid table="def_pwrc" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" exclude="1" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" exclude="1" />
                <uicommand title="Добавить" action-type="custom" editable="kod_fl" button-type="custom-add-form">
                  <useaction action-type="save" />
                  <useaction action-type="dynamic-form-create-multiple" call="49277_vb_rb_default_pwrc" modal="1" title="Добавить">
                    <useparam name="kod_fl" />
                  </useaction>
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите удалить отмеченные ПС?" title="Удалить отмеченные" button-type="custom-delete" editable="kod_fl">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="def_pwrc" />
                  <useaction action-type="refresh-table" object="def_pwrc" />
                  <useaction action-type="refresh-table" object="def_fdrid" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="kod_fl" column="name" title="Филиал" column-width="316" />
                <column table="pwrc_id" column="pwrcn" title="ПС" column-width="316" />
                <column table="def_pwrc" column="stage1" title="1 этап (до актуализации ИСЭ)" column-editable="1" column-width="101" />
                <column table="def_pwrc" column="stage2" title="2 этап (после актуализации ИСЭ)" column-editable="1" column-width="107" />
                <column table="def_pwrc" column="tm_start_an_str" title="Начало анализа" column-editable="0" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="Фидеры">
            <grid table="def_fdrid" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" exclude="1" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand title="Добавить" action-type="custom" editable="kod_fl" button-type="custom-add-form">
                  <useaction action-type="save" />
                  <useaction action-type="dynamic-form-create-multiple" call="49277_vb_rb_default_fdr" modal="1" title="Добавить">
                    <useparam name="kod_fl" />
                  </useaction>
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите удалить отмеченные фидеры?" title="Удалить отмеченные" button-type="custom-delete" editable="kod_fl">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="def_fdrid" />
                  <useaction action-type="refresh-table" object="def_fdrid" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="kod_fl" column="name" title="Филиал" column-width="316" />
                <column table="pwrc_fdrid" column="pwrcname" column-width="316" title="ПС" />
                <column table="pwrc_fdrid" column="pwrc_fdrname" column-width="124" title="Фидер" />
                <column table="pwrc_fdrid" column="pwrc_fdr_explname" column-width="154" title="Экспл. отв." />
              </columns>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="vb_rb_default_pwrc" as="def_pwrc" column-editable="0" auto-refresh="1" order="name, pwrcn">
          <link name="pwrc_id" />
          <link name="kod_fl" />
          <where>
            <call function="in">
              <column table="def_pwrc" column="kod_fl" />
              <useparam name="kod_fl" />
            </call>
          </where>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdrid" auto-refresh="1" order="name, pwrcname, pwrc_fdrname">
          <link name="pwrc_fdrid" />
          <link name="kod_fl" />
          <where>
            <call function="in">
              <column table="kod_fl" column="kod_fl" />
              <useparam name="kod_fl" />
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="49277_vb_rb_default_pwrc" timestamp="21.02.2021 04:59:56" title="Изменить список ПС" file="sql.builder.templates\sql.builder\projects\49277\form\forms.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <content>
        <grid table="a" show-toolbar="1" show-checkbox="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" title="Добавить выбранные" button-type="custom-ok">
              <useaction action-type="save" />
              <useaction action-type="close" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="a" column="bal_id_pwrc_id" column-visible="0" />
            <column table="a" column="pwrc_id" column-visible="0" parname="pwrc_id" />
            <column table="a" column="pwrcname" title="ПС" column-width="322" />
            <column table="a" column="bal_id" column-visible="0" parname="bal_id" />
            <column table="a" column="name" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vb_rb_default_pwrc_add">
                <useparam name="pwrc_id" />
                <useparam name="bal_id" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vb_rb_default_pwrc_list" as="a" auto-refresh="1" column-editable="0" exclude="1">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
        <query name="vb_rb_default_pwrc_list_from_HV_EOPWRC" as="a" auto-refresh="1" column-editable="0">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="49277_vb_rb_default_fdr" timestamp="21.02.2021 04:54:29" title="Изменить список фидеров" file="sql.builder.templates\sql.builder\projects\49277\form\forms.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <content>
        <grid table="a" show-toolbar="1" show-checkbox="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" title="Добавить выбранные" button-type="custom-ok">
              <useaction action-type="save" />
              <useaction action-type="close" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="a" column="pwrc_kod_id_fdrid" column-visible="0" />
            <column table="a" column="pwrc_fdrid" column-visible="0" parname="pwrc_fdrid" />
            <column table="a" column="pwrc_id" column-visible="0" parname="pwrc_id" />
            <column table="a" column="kod_id" column-visible="0" parname="kod_id_pwrc" as="kod_id_pwrc" />
            <column table="a" column="name" />
            <column table="a" column="pwrcname" column-width="266" />
            <column table="a" column="pwrc_fdrname" />
            <column table="a" column="pwrc_fdr_explname" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vb_rb_default_fdr_add">
                <useparam name="pwrc_fdrid" />
                <useparam name="pwrc_id" />
                <useparam name="kod_id_pwrc" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vb_rb_default_fdr_list" as="a" column-editable="0" auto-refresh="1">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="49277_test" timestamp="01.02.2019 18:31:48" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <usefield field="cmn_combo_num" name="ym_s" column-mandatory="1" column-visible="0">
        <listquery>
          <query name="49277-yms" />
        </listquery>
        <defaultquery>
          <query name="49277-yms" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_combo_num" name="ym_po" column-mandatory="1" column-visible="0">
        <listquery>
          <query name="49277-ym_po" />
        </listquery>
        <defaultquery>
          <query name="49277-ym_po" />
        </defaultquery>
      </usefield>
    </form>
    <form name="49277_test2" timestamp="01.10.2020 18:27:31" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <usefield field="cmn_combo_num" name="id_dat" column-mandatory="1" title="Номер недели">
        <listquery>
          <query name="49277-dats" />
        </listquery>
      </usefield>
      <usefield field="cmn_string" name="w_num" column-visible="0">
        <defaultquery>
          <query name="49277-week_num" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Филиал" name="kod_fl" column-mandatory="1" type="number">
        <listquery>
          <query name="jv_rep_cons_d_fl" />
        </listquery>
        <defaultquery>
          <query name="45862-kod_fl-def" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Подстанции" name="hv_eopwrc_id" type="string" column-mandatory="1">
        <listquery>
          <query name="hv_eopwrc_list_test2" />
        </listquery>
        <defaultquery>
          <query name="49277_pwrc_def_test2" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1" visible="0">
        <listquery>
          <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
        </listquery>
        <defaultquery>
          <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Фидеры" name="k_kg_name" type="string" column-mandatory="1">
        <listquery>
          <query name="45862_kg_name_list_test2" />
        </listquery>
        <defaultquery>
          <query name="45862_kg_name_default_test2" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Фидеры без КГ" name="pwrc_fdrid" type="number" column-visible="0">
        <listquery>
          <query name="45862_fdr_by_kn_name_list_test2" />
        </listquery>
        <defaultquery>
          <query name="45862_fdr_by_kn_name_list_test2" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="prev_slice_dat" title="Динамика относительно даты" column-editable="0">
        <defaultquery>
          <query name="49277-dat_slice_week_before" />
        </defaultquery>
      </usefield>
    </form>
    <form name="49277_test3" timestamp="31.05.2022 10:37:48" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <usefield field="cmn_combo_num" name="stage3" title="Отчетный период" column-mandatory="1">
        <listquery>
          <query name="49277_51730-dat_by_id" />
        </listquery>
      </usefield>
      <usefield field="cmn_list" title="Филиал" name="kod_fl" column-mandatory="1" type="number">
        <listquery>
          <query name="jv_rep_cons_d_fl" />
        </listquery>
        <defaultquery>
          <query name="45862-kod_fl-def" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Подстанции" name="hv_eopwrc_id" type="string" column-mandatory="1">
        <listquery>
          <query name="hv_eopwrc_list_test2" />
        </listquery>
        <defaultquery exclude="1">
          <query name="49277_pwrc_def_test3" exclude="1" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1" visible="0">
        <listquery>
          <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
        </listquery>
        <defaultquery exclude="1">
          <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" exclude="1" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Фидеры" name="k_kg_name" type="string" column-mandatory="1">
        <listquery>
          <query name="45862_kg_name_list_test2" />
        </listquery>
        <defaultquery>
          <query name="45862_kg_name_default_test2" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_list" title="Фидеры без КГ" name="pwrc_fdrid" type="number" column-visible="0">
        <listquery>
          <query name="45862_fdr_by_kn_name_list_test2" />
        </listquery>
        <defaultquery>
          <query name="45862_fdr_by_kn_name_list_test2" />
        </defaultquery>
      </usefield>
    </form>
    <form name="52733" timestamp="04.10.2022 15:00:00" file="sql.builder.templates\sql.builder\projects\49277\reports\52733-rep.xml">
      <content>
        <usefield field="cmn_combo_num" name="year" title="Год" column-mandatory="1">
          <listquery>
            <query name="52733_year" />
          </listquery>
          <defaultquery>
            <query name="52733_year_def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Филиал" name="kod_fl" type="number" column-mandatory="1">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
          <defaultquery>
            <query name="45862-kod_fl-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="hv_eopwrc_id" type="string" column-mandatory="1">
          <listquery>
            <query name="52733_pwrc_list" />
          </listquery>
          <defaultquery>
            <query name="52733_pwrc_def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1" visible="0">
          <defaultquery>
            <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры" name="k_kg_name" type="string" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="52733_k_kg_name" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры" name="pwrc_fdrid" type="number" column-mandatory="1">
          <listquery>
            <query name="45862_fdr_by_kn_name_list_test2" />
          </listquery>
          <defaultquery>
            <query name="45862_fdr_by_kn_name_list_test2" />
          </defaultquery>
        </usefield>
        <!-- usefield field="cmn_check" name="kg_missing_tp_flag" title="Есть новые тп не включены в кг" visible="0" exclude="1">
          <defaultquery>
            <query name="52733_fdr_kg_missing_tp_single_year_flag" />
          </defaultquery>
        </usefield -->
        <usefield field="cmn_text" name="kg_missing_tp_text" type="string" column-editable="0" title="ТП, которые необходимо включить в КГ">
          <defaultquery>
            <query name="52733_fdr_kg_missing_tp_single_year_text" />
          </defaultquery>
        </usefield>
      </content>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name">
    <dimension-package name="49277" timestamp="16.03.2021 01:53:24" file="sql.builder.templates\sql.builder\projects\49277\reports\49277-rep.xml">
      <dimension name="d49277_kod_fl" class-type="vr_rb_filial" />
      <dimension name="d49277_bal_id" class-type="vr_rb_pwrc" />
      <dimension name="d49277_pwrc" class-type="vr_rb_pwrc_g" />
      <dimension class-type="vr_rb_fider" name="d49277_fdrid" />
      <dimension class-type="vr_rb_fact" name="d49277_vr_rb_fact" />
      <dimension name="d49277_kod_fl_real" class-type="sqlb_d45862_fl_ym_tbl" />
      <dimension name="id_dat" class-type="vr_rb_dat" />
      <dimension name="def_pwrc" class-type="vb_rb_default_pwrc" />
      <dimension name="def_fdr" class-type="vb_rb_default_fdr" />
      <dimension name="grid_dtl_hist_kg" class-type="vr_rb_eq_kg" />
      <dimension time-type="number" name="ym" exclude="1" />
      <dimension class-type="vr_rb_fact_fider" name="d49277_fact_fider" exclude="1" />
      <dimension class-type="vr_rb_fact_tu" name="d49277_fact_tu" exclude="1" />
      <dimension class-type="vr_rb_fact_tp_all" name="d49277_fact_tp_all" exclude="1" />
      <dimension class-type="vr_rb_fact_tp" name="d49277_fact_tp" exclude="1" />
      <dimension class-type="f53605_rr_temp" name="rep_53605_rr_temp" />
    </dimension-package>
  </dimension-packages>
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>