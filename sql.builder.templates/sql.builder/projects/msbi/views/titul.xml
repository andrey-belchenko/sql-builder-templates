<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="msbi_ipr_titul_ip" timestamp="24.05.2016 17:23:15" title="0010.Объект строительства">
      <select>
        <column table="ipr_titul_ip" column="kod_titul_ip" key="1" comment="1,2,3" />
        <column table="ipr_titul_ip" column="kod_ispolnit" link="msbi_is_spr_direct" title="Исполнитель" comment="1,2,3" />
        <column table="ipr_titul_ip" column="tit_num_new" as="num" comment="1,2,3" />
        <column table="ipr_titul_ip" column="name" title="Наименование объекта строительства" comment="1,2,3" />
        <column table="ipr_titul_ip" column="pr_ofz" as="kod_ofz_state" comment="1,2,3" />
        <column table="ipr_titul_ip" column="date_vkl_ofz" />
      </select>
      <from>
        <query name="ipr_titul_ip" />
      </from>
    </query>
    <query name="msbi_is_dogovor" timestamp="28.08.2017 16:39:16" title="0050.Подрядный договор">
      <select>
        <column table="is_dogovor" column="kod_dog" key="1" />
        <column table="is_dogovor" column="name_unig_dog" as="num_dog" title="№ договора" />
        <column table="is_dogovor" column="dat_dog" title="Дата договора" />
        <column table="is_dogovor" column="kod_tip_dog" />
        <column table="is_dogovor" column="e_code" />
        <column table="is_dogovor" column="kod_parent_cp" link="msbi_is_dogovor" />
        <column table="is_dogovor" column="status" link="msbi_is_status" />
        <column table="is_dogovor" column="vsego" comment="m6.41" title="Сумма c НДС" />
        <column table="is_dogovor" column="summa" comment="m6.41" as="summ" title="Сумма без НДС" />
        <call function="-nvl" as="nds" title="НДС" comment="m6.41">
          <column table="this" column="vsego" />
          <column table="this" column="summ" />
        </call>
        <column table="is_dogovor" column="predm_dog" comment="m12.94" title="Предмет договора подряда " />
        <column table="is_dogovor" column="dat_udal" comment="m12.95" />
        <column table="is_dogovor" column="num_dog" comment="m12.96" as="num_dog_podr" />
        <column table="is_dogovor" column="kod_spr_doc" comment="m12.97" link="msbi_is_spr_doc" />
        <column table="is_dogovor" column="dat_cr_dog" comment="m12.98" title="Дата создания договора" />
        <column table="is_dogovor" column="dat_end" comment="m12.98" title="Дата закрытия договора" />
        <column table="is_dogovor" column="dat_ret" comment="m12.98" title="Дата аннулирования договора" />
        <column table="is_dogovor" column="dat_status_1" comment="m12.98" title="Дата изменения статуса на действующий" />
        <column table="is_dogovor" column="dat_status_4" comment="m12.98" title="Дата выполнения" />
        <column table="is_dogovor" column="kod_predpr" comment="m12.99" link="msbi_is_spr_direct" />
      </select>
      <from>
        <query name="is_dogovor" />
      </from>
    </query>
    <query name="msbi_is_spr_tip_dog" timestamp="24.05.2016 17:23:09" title="0080.Тип договора">
      <select>
        <column table="is_spr_tip_dog" column="kod_tip_dog" key="1" />
        <column table="is_spr_tip_dog" column="name" />
        <column table="is_spr_tip_dog" column="prizn_1c_tip_dog" as="tip_dog_1c" title="Код вида договора в 1С" />
      </select>
      <from>
        <query name="is_spr_tip_dog" />
      </from>
    </query>
    <query name="msbi_is_creditors" timestamp="06.10.2016 10:43:48" title="0040.Контрагент">
      <select>
        <column table="is_creditors" column="e_code" key="1" />
        <column table="is_creditors" column="name" comment="m1.13" title="Наименование контрагента / ФИО" />
        <column table="is_creditors" column="inn" />
        <column table="is_creditors" column="kpp" />
        <column table="is_creditors" column="ur_lico" comment="m1.31" />
        <column table="is_creditors" column="kod_fs" link="msbi_is_spr_fs" comment="m8.56" />
      </select>
      <from>
        <query name="is_creditors" />
      </from>
    </query>
    <query name="msbi_is_ofz_state" timestamp="24.05.2016 17:23:06" title="0070.Состояние для ОФЗ">
      <select>
        <column table="is_spr_ofz" column="kod" as="kod_ofz_state" key="1" comment="1,2,3" />
        <column table="is_spr_ofz" column="name" comment="1,2,3" />
      </select>
      <from>
        <query name="is_spr_ofz" />
      </from>
    </query>
    <query name="msbi_ips_vid_zatrat" timestamp="21.01.2017 04:25:20" title="0030.Вид затрат">
      <select>
        <column table="ips_vid_zatrat" column="kodzatrat" key="1" comment="1,2" />
        <column table="ips_vid_zatrat" column="abbr" as="num" title="Номер" comment="1,2" />
        <column table="ips_vid_zatrat" column="name" />
        <column table="ips_vid_zatrat" column="kod_smet" comment="1,2" />
        <column table="ips_vid_zatrat" column="skod_1c" title="Код статьи затрат 1С" />
      </select>
      <from>
        <query name="ips_vid_zatrat" />
      </from>
    </query>
    <query name="msbi_isv_ip_vip_dog" timestamp="12.09.2016 13:21:05" title="0090.Акт выполненных работ (ИнвестPRO)" haskeys="1" path=".">
      <select>
        <column table="isv_ip_vip_dog" column="kod_vip_dog" as="kod_vip_dog" key="1" fixed="1" />
        <call function="nullif" type="number" as="kod_dog">
          <column table="isv_ip_vip_dog" column="kod_dog" />
          <const>-1</const>
        </call>
        <column table="isv_ip_vip_dog" column="kodzatrat" as="kodzatrat" comment="1,2" />
        <column table="isv_ip_vip_dog" column="num_doc" as="num_doc" title="Номер акта" comment="1,2" />
        <column table="isv_ip_vip_dog" column="dat_doc" as="dat_doc" title="Дата акта" comment="1,2" />
        <column table="isv_ip_vip_dog" column="vsego" as="vsego" title="Сумма с НДС" comment="1,2" />
        <column table="isv_ip_vip_dog" column="nds" as="nds" title="НДС" comment="1,2" />
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="isv_ip_vip_dog" column="dat_buh" title="Дата учета" as="dat_buh" comment="1,2" />
        <call function="nvl" title="UID" as="kod_uid">
          <column table="kod_doc_vip" column="kod_uid" title="UID" />
          <column table="kod_doc" column="kod_uid" title="UID" />
        </call>
        <column table="is_vip_dog" column="kod_spr_doc" comment="1,2" />
        <column table="kod_doc" column="kod_doc_type" comment="1,2" />
        <column table="isv_ip_vip_dog" column="kod_ip" as="kod_titul_ip" comment="1,2" />
        <call function="if" type="number" as="pr_itog" title="Признак итоговой строки">
          <call function="and">
            <call function="is not null">
              <column table="this" column="kod_dog" />
            </call>
            <call function="is null">
              <column table="is_vip_dog" column="kod_vip_dog" />
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="isv_ip_vip_dog">
          <link name="kod_vip_dog" as="is_vip_dog">
            <link name="kod_doc_vip" />
          </link>
          <link name="kod_vip_dog_proch">
            <link name="kod_doc" />
          </link>
        </query>
      </from>
    </query>
    <query name="msbi_ips_smet_structure" timestamp="24.05.2016 17:23:02" title="0020.Вид затрат (группа)">
      <select>
        <column table="ips_smet_structure" column="kod_smet" title="№" key="1" comment="1,2" />
        <column table="ips_smet_structure" column="name" comment="1,2" />
      </select>
      <from>
        <query name="ips_smet_structure" />
      </from>
    </query>
    <query name="msbi_is_spr_doc" timestamp="13.12.2016 20:45:27" title="0060.Тип документа" haskeys="1" path=".">
      <select>
        <column table="is_spr_doc" column="kod_spr_doc" as="kod_spr_doc" key="1" fixed="1" />
        <column table="is_spr_doc" column="name" as="name" comment="m10.75" />
        <column table="is_spr_doc" column="kod_buh" title="Код документа 1С" as="kod_buh" />
      </select>
      <from>
        <query name="is_spr_doc" as="is_spr_doc" />
      </from>
    </query>
    <query name="msbi_is_tit_dog" timestamp="28.08.2017 16:39:18" haskeys="1" path="." title="0100.Связь титулов и договоров">
      <select>
        <column table="is_fin_doc" column="kod_titul_ip" group="1" comment="1,2" />
        <column table="is_fin_doc" column="kod_dog" group="1" comment="1,2" />
      </select>
      <from>
        <query name="is_fin_doc" />
      </from>
      <where>
        <call function="is not null">
          <column table="is_fin_doc" column="kod_titul_ip" />
        </call>
      </where>
    </query>
    <query name="msbi_isv_ip_opl" timestamp="13.12.2016 18:49:00" title="0110.Оплата по подрядному договору (ИнвестPRO)" haskeys="1" path=".">
      <select>
        <column table="isv_ip_opl" column="kod_opl_period" key="1" comment="1,2" />
        <column table="kod_vip_dog" column="kod_vip_dog" as="kod_vip_dog" fixed="1" comment="1,2" />
        <column table="isv_ip_opl" as="kod_titul_ip" column="kod_ip" comment="1,2" />
        <call function="nullif" type="number" as="kod_dog">
          <column table="isv_ip_opl" column="kod_dog" />
          <const>-1</const>
        </call>
        <column table="isv_ip_opl" column="num_doc" as="num_doc" title="Номер документа" comment="1,2" />
        <column table="isv_ip_opl" column="dat_opl" title="Дата документа" comment="1,2" />
        <column table="isv_ip_opl" column="sum_opl" title="Сумма с НДС" as="vsego" comment="1,2" />
        <column table="isv_ip_opl" column="nds" as="nds" title="НДС" comment="1,2" />
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="kod_opl_ro" column="kod_spr_doc" title="Вид платежа" />
        <call function="if" type="number" as="pr_itog" title="Признак итоговой строки">
          <call function="and">
            <call function="is not null">
              <column table="this" column="kod_dog" />
            </call>
            <call function="is null">
              <column table="kod_opl_period" column="kod_vip_dog" />
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="decode" type="number" as="pr_ofz" title="Признак ОФЗ">
          <column table="isv_ip_opl" column="pr_ofz" />
          <const>1</const>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="nvl0" as="is_avans" title="Признак авансовой оплаты" comment="m8.61">
          <column table="isv_ip_opl" column="is_avans" />
        </call>
        <column comment="m8.62" table="isv_ip_opl" column="kodzatrat" link="msbi_ips_vid_zatrat" />
      </select>
      <from>
        <query name="isv_ip_opl">
          <link name="kod_opl_period">
            <link name="kod_opl_ro">
              <link name="kod_ro" />
              <link name="kod_vidopl" />
            </link>
          </link>
          <link name="kod_vip_dog" />
        </query>
      </from>
    </query>
    <query name="msbi_ipr_works_vvod" timestamp="24.05.2016 17:22:52" title="0120.Акты ввода" haskeys="1" path=".">
      <select>
        <column table="ipr_works_vvod" column="kod_work_vvod" key="1" comment="1,2" />
        <column table="kod_vip_dog_ip" column="kod_vip_dog" comment="1,2" />
        <call function="nullif" type="number" as="kod_dog">
          <column table="kod_vip_dog_ip" column="kod_dog" />
          <const>-1</const>
        </call>
        <column table="kod_vip_dog_ip" column="kodzatrat" comment="1,2" />
        <column table="kod_tituls_object" column="kod_titul_ip" as="kod_titul_ip" comment="1,2" />
        <column table="kod_doc" column="doc_num" title="Номер акта" comment="1,2" />
        <column table="kod_doc" column="doc_date_c" title="Дата акта" as="doc_date" comment="1,2" />
        <column table="kod_doc" column="kod_doc_type" title="Акт ввода ОС" comment="1,2" />
        <column table="kod_object" column="kod_podrazd" as="kod_direct" title="Филиал, эксплуатирующий ОС" />
        <column table="kod_object" column="name" as="name_os" />
        <column table="kod_object" column="invent_num" />
        <call function="+nvl" as="vsego" title="Сумма с НДС" comment="1,2">
          <column table="ipr_works_vvod" column="summ" />
          <column table="ipr_works_vvod" column="summ_nds" />
        </call>
        <column table="ipr_works_vvod" column="summ_nds" as="nds" title="НДС" comment="1,2" />
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
      </select>
      <from>
        <query name="ipr_works_vvod">
          <link name="kod_fact_wcompl">
            <link name="kod_work_body">
              <link name="kod_tituls_object">
                <link name="kod_object" />
              </link>
            </link>
            <link name="kod_vip_dog" as="kod_vip_dog_ip">
              <link name="kod_vip_dog" />
            </link>
          </link>
          <link name="kod_doc" />
        </query>
      </from>
      <where exclude="1">
        <call function="not">
          <call function="is null or -1">
            <column table="kod_vip_dog_ip" column="kod_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="msbi_is_spr_direct" title="0160.Подразделение" timestamp="30.05.2018 20:03:11">
      <select>
        <column table="is_spr_direct" column="kod_direct" key="1" comment="1,2,3" />
        <column table="is_spr_direct" column="name" title="Наименование" comment="1,2,3,m11.91,m15.113" />
        <column table="is_spr_direct" column="name_kr" title="Сокращенное наименование" comment="1,2,3" />
        <call function="decode" as="cfo_name" title="ЦФО">
          <column table="is_spr_direct" column="god" />
          <const>null</const>
          <const>''</const>
          <call function="||">
            <const>'(У) '</const>
            <column table="is_spr_direct" column="name_kr" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_spr_direct" />
      </from>
    </query>
    <query name="msbi_ipr_smet" timestamp="24.05.2016 17:22:46" title="0150.Сметная стоимость">
      <select>
        <column table="ipr_smet_struct_titul" column="kod_smet_titul" key="1" comment="1,2" />
        <column table="ipr_smet_struct_titul" column="kod_titul_ip" comment="1,2" />
        <column table="ipr_smet_struct_titul" column="kod_doc" title="Документ, утверждающий сметную стоимость" comment="1,2" />
        <column table="ipr_smet_struct_titul" column="kod_smet" comment="1,2" />
        <column table="ipr_smet_struct_titul" column="summ2_nds" title="Сумма c НДС" as="vsego" comment="1,2" />
        <call function="-nvl" as="nds" title="НДС" comment="1,2">
          <column table="ipr_smet_struct_titul" column="summ2_nds" />
          <column table="ipr_smet_struct_titul" column="summ1" as="summ" title="Сумма без НДС" />
        </call>
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
      </select>
      <from>
        <query name="ipr_smet_struct_titul">
          <link name="kod_smet" />
          <link name="kod_doc">
            <link name="kod_doc_type" />
            <elink name="ipr_tek_smet_doc" as="smet_doc">
              <link name="doc_target_str" />
            </elink>
          </link>
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="kod_smet" column="kod_smet" />
        </call>
        <call function="is null" exclude="1">
          <column table="smet_doc" column="doc_target_str" />
        </call>
      </where>
    </query>
    <query name="msbi_ipr_doc" title="0190.Документ ИнвестPRO" timestamp="25.07.2016 14:59:22">
      <select>
        <column table="ipr_doc" column="kod_doc" key="1" comment="1,2,3" />
        <column table="ipr_doc" column="doc_num" comment="1,2,3" />
        <column table="ipr_doc" column="doc_date_c" as="doc_date" comment="1,2,3" />
        <column table="ipr_doc" column="kod_titul_ip" comment="1,2,3" />
        <column table="ipr_doc" column="kod_doc_type" comment="1,2,3" />
        <column table="doc_target_str" column="doc_target_str" as="kod_smet_target" exclude="1" />
      </select>
      <from>
        <query name="ipr_doc">
          <link name="doc_target" />
          <link name="kod_doc_type">
            <elink name="ips_doc_type_target" exclude="1">
              <link name="kod_doc_target">
                <link name="doc_target_str" />
              </link>
            </elink>
          </link>
        </query>
      </from>
    </query>
    <query name="msbi_smet_target" timestamp="24.05.2016 17:22:43" title="0170.Вид сметной стоимости">
      <select>
        <column table="ips_doc_target_str" column="doc_target_str" as="kod_smet_target" key="1" comment="1,2" />
        <column table="ips_doc_target_str" column="name" comment="1,2" />
      </select>
      <from>
        <query name="ips_doc_target_str" />
      </from>
    </query>
    <query name="msbi_is_dop_contract" timestamp="13.10.2016 12:42:52" title="0180.Договор ТП">
      <select>
        <column table="is_dop_contract" column="kod_dop_contract" key="1" comment="1,2" />
        <column table="is_dop_contract" column="num_ouco" comment="m1.2,m7.42" />
        <column table="is_dop_contract" column="num_ad" comment="1,2" />
        <column table="is_dop_contract" column="num_ad_pref" comment="1,2" />
        <column table="is_dop_contract" column="dt_contract" title="Дата договора" comment="1,2,m1.6" />
        <column table="is_dop_contract" column="status" comment="1,2,m7.42" link="msbi_is_status" />
        <column table="is_dop_contract" column="isp_info" title=" Состояние по ОФЗ" exclude="1" />
        <call function="decode" type="number" as="pr_ofz" title="Признак ОФЗ" comment="1,2">
          <column table="is_dop_contract" column="pr_ofz" />
          <const>1</const>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="is_dop_contract" column="kn_contract_p" title="Код основного договора (для доп. соглашения)" link="msbi_is_dop_contract" />
        <call function="nvl0" type="number" title="Признак наличия работ ЛЭ" as="fl_build">
          <column table="is_dop_contract" column="fl_build" />
        </call>
        <call function="nvl0" type="number" title="Признак выполнения работ ЛЭ" as="fl_build_vip" comment="m1.30,m2.30">
          <column table="is_dop_contract" column="fl_build_vip" />
        </call>
        <column table="is_dop_contract" column="dat_status_1" title="Дата установки статуса &quot;действующий&quot;" />
        <column table="is_dop_contract" column="dat_status_2" title="Дата установки статуса &quot;аннулирован&quot;" />
        <column table="is_dop_contract" column="dat_status_4" title="Дата установки статуса &quot;выполнен&quot;" />
        <column table="is_dop_contract" column="kod_ofz_state" comment="m1.1" />
        <column table="is_dop_contract" column="kn_contr_kind" comment="m1.3" />
        <column table="is_dop_contract" column="kod_vid_ad" comment="m1.4" />
        <column table="is_dop_contract" column="vid_opl" comment="m1.5" />
        <column table="is_dop_contract" column="srok_uslug" comment="m1.7" title="Срок оказания услуг" />
        <column table="is_dop_contract" column="dat_end" comment="m1.8" />
        <column table="is_dop_contract" column="contr_sum_m" comment="m1.9" />
        <column table="is_dop_contract" column="contr_sum_e" comment="m1.9" />
        <column table="is_dop_contract" column="num_req" comment="m1.11" />
        <column table="is_dop_contract" column="kn_load_type" comment="m1.12" />
        <column table="is_dop_contract" column="kn_customer" comment="m1.13" as="e_code" />
        <column table="is_dop_contract" column="lp_addr" comment="m1.14" />
        <column table="is_dop_contract" column="kod_filial" comment="m1.15" link="msbi_is_spr_direct" />
        <column table="is_dop_contract" column="kodres" comment="m1.16" link="msbi_is_spr_direct" />
        <column comment="m1.17" table="is_dop_contract" column="kod_mo" />
        <column comment="m1.18" table="is_dop_contract" column="kod_mobr" />
        <column comment="m1.19" table="is_dop_contract" column="kod_nasp" />
        <column comment="m1.20" table="is_dop_contract" column="ist_pit" />
        <column comment="m1.21" table="is_dop_contract" column="kod_obj" />
        <column comment="m1.22" table="is_dop_contract" column="load_ex1" />
        <column comment="m1.22" table="is_dop_contract" column="load_ex2" />
        <column comment="m1.22" table="is_dop_contract" column="load_ex3" />
        <column comment="m1.22" table="is_dop_contract" column="load1" />
        <column comment="m1.22" table="is_dop_contract" column="load2" />
        <column comment="m1.22" table="is_dop_contract" column="load3" />
        <column table="is_dop_contract" column="kn_voltage" comment="m1.23" />
        <column table="is_dop_contract" column="n_pril" comment="m3.36" />
        <column table="is_dop_contract" column="dat_rastorg" comment="m4.38" />
        <column table="is_dop_contract" column="kn_req" as="kn_request" link="msbi_as_request" />
        <column table="is_dop_contract" column="dt_request" title="Дата заявки" comment="m7.43" />
        <call function="if" title="д/с   " as="num_ds2" comment="m7.44">
          <call function="is not null">
            <column table="is_dop_contract" column="kn_contract_p" />
          </call>
          <column table="is_dop_contract" column="num_ds" />
        </call>
        <column table="is_dop_contract" column="kod_vid_ds" link="msbi_is_spr_vid_ds" comment="m7.45" />
        <call function="if" as="fl_discount_str" title="Льготный" type="string" comment="m7.46">
          <call function="=1">
            <call function="nvl0">
              <column table="is_dop_contract" column="fl_discount" />
            </call>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <column table="is_dop_contract" column="kod_vid_otl_usl" link="msbi_is_spr_vid_otl_usl" comment="m7.47" />
        <column table="is_dop_contract" column="dat_srok_otl_usl" title="Срок отлагательных условий" comment="m7.47" />
        <column table="is_dop_contract" column="kn_zone" comment="m7.48" title="Зона" />
        <column table="is_dop_contract" column="kod_group" link="msbi_is_spr_group" comment="m7.49" />
        <call function="nvl" comment="m8.58" as="dt_project" title="Дата проекта ">
          <column table="kn_contract" column="dt_project" />
          <column table="is_dop_contract" column="dat_ouco" />
        </call>
      </select>
      <from>
        <query name="is_dop_contract">
          <link name="kn_contract" />
        </query>
      </from>
    </query>
    <query name="msbi_is_status" timestamp="13.12.2016 20:39:38" title="0220.Статусы">
      <select>
        <column table="is_status" column="status" key="1" comment="1,2" />
        <column table="is_status" column="name" title="Статус" comment="1,2,m7.42,m10.68" />
      </select>
      <from>
        <query name="is_status" />
      </from>
    </query>
    <query name="msbi_ipr_titul_dop_cont" timestamp="24.05.2016 17:22:38" title="0210.Связь объектов строительства с договорами на ТП">
      <select>
        <column table="ipr_titul_dop_contract" column="kod_titul_ip" comment="1,2" />
        <column table="ipr_titul_dop_contract" column="kod_dop_contract" comment="1,2" />
      </select>
      <from>
        <query name="ipr_titul_dop_contract" />
      </from>
    </query>
    <query name="msbi_ipr_contr_steps_val" timestamp="15.08.2017 17:19:42" title="0200.Контрольный этап" comment="поставить материализацию с помощью хинта на  ipr_contr_steps_val_dt">
      <select>
        <column table="ipr_contr_steps_val" column="kod_contr_steps_val" key="1" comment="3" />
        <column table="kod_ipr" column="kod_titul_ip" comment="3" />
        <column table="ipr_contr_steps_val" column="kod_doc" title="Документ, утверждающий контрольный этап" comment="3" />
        <column table="kod_template_contr_steps_val" column="kod_template_contr_steps_val" as="kod_template_contr_steps" comment="3" />
        <column table="ipr_contr_steps_val" column="ep_date" comment="3" />
        <column table="ipr_contr_steps_val" column="ef_date" comment="3" />
      </select>
      <from>
        <query name="ipr_contr_steps_val">
          <link name="kod_template_contr_steps_val" />
          <link name="kod_ipr" />
        </query>
      </from>
    </query>
    <query name="msbi_ipr_move_wsumm" timestamp="16.12.2016 14:32:05" title="0130.Переброска/списание по актам">
      <select>
        <column table="ipr_move_wsumm" column="kod_move_wsumm" key="1" comment="1,2" />
        <column table="ipr_move_wsumm" column="kod_doc" title="Документ, на основании которого выполнена операция" comment="1,2" />
        <column table="kod_vip_dog_fr" column="kod_vip_dog" as="kod_vip_dog_fr" link="msbi_isv_ip_vip_dog" comment="1,2" />
        <column table="kod_vip_dog_to" column="kod_vip_dog" as="kod_vip_dog_to" link="msbi_isv_ip_vip_dog" comment="1,2" />
        <call function="+nvl" as="vsego" title="Сумма с НДС" comment="1,2">
          <column table="ipr_move_wsumm" column="summ" />
          <column table="this" column="nds" />
        </call>
        <call function="*" as="nds" title="НДС" comment="1,2">
          <column table="ipr_move_wsumm" column="summ" />
          <call function="/">
            <column table="kod_vip_dog_fr" column="proc_nds" />
            <const>100</const>
          </call>
        </call>
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="ipr_move_wsumm" column="kod_titul_ip_fr" link="msbi_ipr_titul_ip" title="C титула" />
        <column table="ipr_move_wsumm" column="kod_titul_ip_to" link="msbi_ipr_titul_ip" title="На титул" />
      </select>
      <from>
        <query name="ipr_move_wsumm">
          <link name="kod_fact_wcompl_fr">
            <link name="kod_vip_dog" as="kod_vip_dog_fr" />
          </link>
          <link name="kod_fact_wcompl_to">
            <link name="kod_vip_dog" as="kod_vip_dog_to" />
          </link>
        </query>
      </from>
      <where exclude="1">
        <call function="not">
          <call function="is null or -1">
            <column table="kod_vip_dog_fr" column="kod_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="msbi_ipr_move_wsumm_fin" timestamp="24.05.2016 17:24:09" title="0140.Переброска/списание по оплатам">
      <select>
        <column table="ipr_move_wsumm_fin" column="kod_move_wsumm" comment="1,2" />
        <column table="ipr_move_wsumm_fin" column="kod_opl_period" comment="1,2" />
        <column table="ipr_move_wsumm_fin" column="summ_nds" as="vsego" title="Сумма с НДС" comment="1,2" />
        <call function="-nvl" as="nds" title="НДС" comment="1,2">
          <column table="ipr_move_wsumm_fin" column="summ_nds" />
          <column table="ipr_move_wsumm_fin" column="summ" />
        </call>
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="1,2">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
      </select>
      <from>
        <query name="ipr_move_wsumm_fin" />
      </from>
    </query>
    <query name="msbi_ips_doc_type" title="0230.Тип документа (ИнвестPRO)" timestamp="25.07.2016 15:01:19">
      <select>
        <column table="ips_doc_type" column="kod_doc_type" key="1" group="1" comment="1,2,3" />
        <column table="ips_doc_type" column="name" group="max" comment="1,2,3" />
        <column table="doc_target_str" column="doc_target_str" as="kod_smet_target" group="max" comment="1,2,3" />
        <column table="ips_doc_type" column="pr_main" group="max" comment="m2.35" title="Документ является основным документом, определяющим версию ИПР" />
      </select>
      <from>
        <query name="ips_doc_type">
          <elink name="ips_doc_type_target">
            <link name="kod_doc_target">
              <link name="doc_target_str" />
            </link>
          </elink>
        </query>
      </from>
    </query>
    <query name="msbi_ipr_template_contr_steps" timestamp="24.05.2016 17:24:31" title="0205.Тип контрольного этапа">
      <select>
        <column table="ipr_template_contr_steps_val" column="kod_template_contr_steps_val" as="kod_template_contr_steps" key="1" comment="3" />
        <column table="ipr_template_contr_steps_val" column="abbr" as="num" comment="3" />
        <column table="ipr_template_contr_steps_val" column="name" comment="3" />
      </select>
      <from>
        <query name="ipr_template_contr_steps_val" />
      </from>
    </query>
    <!--<query name="msbi_isv_ip_vip_dog_pr" timestamp="19.04.2016 16:20:04" title="0095.Акт выполненных работ (прочие)" haskeys="1" path=".">
      <select>
        <column table="isv_ip_vip_dog" column="kod_vip_dog" as="kod_vip_dog_pr" key="1" fixed="1" />
        <column table="isv_ip_vip_dog" column="kodzatrat"  />
        <column table="isv_ip_vip_dog" column="num_doc" as="num_doc"  title="Номер акта" />
        <column table="isv_ip_vip_dog" column="dat_doc" as="dat_doc"  title="Дата акта" />
        <column table="isv_ip_vip_dog" column="vsego" as="vsego"  title="Сумма с НДС" />
        <column table="isv_ip_vip_dog" column="nds" as="nds"  title="НДС" />
        <column table="isv_ip_vip_dog" column="dat_buh" title="Дата учета" as="dat_buh"  />
        <column table="kod_doc" column="kod_uid" title="UID" />
        <column table="kod_doc" column="kod_doc_type" />
        <column table="isv_ip_vip_dog" column="kod_ip" as="kod_titul_ip" />
      </select>
      <from>
        <query name="isv_ip_vip_dog">
          <link name="kodzatrat" />
          <link name="kod_vip_dog_proch">
            <link name="kod_doc" />
          </link>
        </query>
      </from>
      <where>
        <call function="is null or -1">
          <column table="isv_ip_vip_dog" column="kod_dog" />
        </call>
      </where>
    </query>-->
    <!--<query name="msbi_ipr_move_wsumm_pr" timestamp="19.04.2016 16:23:31" title="0135.Переброска/списание по актам (прочие)">
      <select>
        <column table="ipr_move_wsumm" column="kod_move_wsumm" key="1" as="kod_move_wsumm_pr" />
        <column table="ipr_move_wsumm" column="kod_doc" title="Документ, на основании которого выполнена операция" />
        <column table="kod_vip_dog_fr" column="kod_vip_dog" as="kod_vip_dog_fr" link="msbi_isv_ip_vip_dog_pr" />
        <column table="kod_vip_dog_to" column="kod_vip_dog" as="kod_vip_dog_to" link="msbi_isv_ip_vip_dog_pr" />
        <call function="+nvl" as="vsego" title="Сумма с НДС">
          <column table="ipr_move_wsumm" column="summ" />
          <column table="this" column="nds" />
        </call>
        <call function="*" as="nds" title="НДС">
          <column table="ipr_move_wsumm" column="summ" />
          <call function="/">
            <column table="kod_vip_dog_fr" column="proc_nds" />
            <const>100</const>
          </call>
        </call>
      </select>
      <from>
        <query name="ipr_move_wsumm">
          <link name="kod_fact_wcompl_fr">
            <link name="kod_vip_dog" as="kod_vip_dog_fr" />
          </link>
          <link name="kod_fact_wcompl_to">
            <link name="kod_vip_dog" as="kod_vip_dog_to" />
          </link>
        </query>
      </from>
      <where>
        <call function="is null or -1">
          <column table="kod_vip_dog_fr" column="kod_dog" />
        </call>
      </where>
    </query>-->
    <query name="msbi_as_sert_power" timestamp="30.09.2016 19:20:43" title="0240. Акт ТП">
      <select>
        <column table="is_atp_dop_info" column="kod_atp_dop_info" key="1" as="kn_sert_power" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="is_atp_dop_info" column="kn_sert_power" as="num" title="Номер" />
        <column table="kn_sert_power" column="dt_reg" />
        <column table="is_atp_dop_info" column="dt_delivery" />
        <column table="is_atp_dop_info" column="u_id" comment="m1.24" />
        <column table="is_atp_dop_info" comment="m1.25" column="date_podpis_cust" />
        <column table="is_atp_dop_info" comment="m1.26" column="dat_reestr" />
        <column table="is_atp_dop_info" comment="m1.27" column="date_buh_check_prizn" />
        <column table="is_atp_dop_info" column="pr_scan" comment="m1.28" />
        <column table="is_atp_dop_info" column="kn_atp_case" comment="m1.34" />
        <column table="is_aktstp_view" column="state_prizn" comment="m1.34" link="msbi_is_status_atp" />
        <column table="is_aktstp_view" column="state_soglas" comment="m1.34" />
        <column table="kod_buh_akt" column="dat_buh" comment="m3.37" />
        <column table="kod_buh_akt" column="dat_m" comment="m3.37" />
        <column table="kod_buh_akt" column="dat_del" comment="m3.37" />
        <column table="is_atp_dop_info" column="date_send_to_buh" comment="m7.55" title="Дата передачи в бухгалтерию " />
      </select>
      <from>
        <query name="is_atp_dop_info">
          <link name="kn_sert_power" />
          <link name="kod_dop_contract" />
          <link name="is_aktstp_view" />
          <link name="kod_buh_akt" />
        </query>
        <query name="as_sert_power" as="a" exclude="1">
          <link name="kod_atp_dop_info" />
        </query>
        <query name="is_dop_contract" join="left outer" exclude="1">
          <call function="=">
            <column table="is_dop_contract" column="kn_req" />
            <column table="a" column="kn_request">2</column>
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="=" exclude="1">
            <column table="a" column="kn_atp_case" />
            <const>2</const>
          </call>
          <call function="is not null">
            <column table="this" column="dat_buh" />
          </call>
        </call>
      </where>
    </query>
    <query name="msbi_as_contr_kind" timestamp="29.09.2016 16:22:51" title="0250. Тип договора ТП" comment="m1.3">
      <select>
        <column table="as_contr_kind" column="kn_contr_kind" key="1" />
        <column table="as_contr_kind" column="name" title="Наименование" />
        <column table="as_contr_kind" column="sname" title="Сокращенное наименование" />
      </select>
      <from>
        <query name="as_contr_kind" />
      </from>
    </query>
    <query name="msbi_is_spr_vid_ad" timestamp="21.07.2016 15:57:12" title="0260. Вид договора ТП" comment="m1.4">
      <select>
        <column table="is_spr_vid_ad" column="kod_vid_ad" key="1" />
        <column table="is_spr_vid_ad" column="name" title="Наименование" />
      </select>
      <from>
        <query name="is_spr_vid_ad" />
      </from>
    </query>
    <query name="msbi_c_opl_dog" timestamp="25.05.2018 15:52:34" title="0270. Оплата по договору" comment="m1.10">
      <select>
        <column table="c_opl" column="kod_opl" key="1" />
        <column table="c_opl" column="kod_dog" as="kod_dop_contract" />
        <column table="c_opl" column="opl" />
        <column table="c_opl" column="datao" />
      </select>
      <from>
        <query name="c_opl" />
      </from>
      <where>
        <call function="is null">
          <column table="c_opl" column="kod_parent" />
        </call>
      </where>
    </query>
    <query name="msbi_as_load_type" timestamp="29.09.2016 12:36:03" title="0280. Тип заявки" comment="m1.12">
      <select>
        <column table="as_load_type" column="kn_load_type" key="1" />
        <column table="as_load_type" column="name" title="Тип заявки" comment="m7.42" />
      </select>
      <from>
        <query name="as_load_type" />
      </from>
    </query>
    <query name="msbi_is_spr_mobr" timestamp="06.10.2016 10:27:03" title="0290. Муниципальное образование" comment="m1.18">
      <select>
        <column table="is_spr_mobr" column="kod" key="1" as="kod_mobr" />
        <column table="is_spr_mobr" column="name" />
      </select>
      <from>
        <query name="is_spr_mobr" />
      </from>
    </query>
    <query name="msbi_is_spr_mo" timestamp="04.08.2016 17:23:09" title="0300. Сельское поселение" comment="m1.17">
      <select>
        <column table="is_spr_mo" column="kod" key="1" as="kod_mo" />
        <column table="is_spr_mo" column="name" />
      </select>
      <from>
        <query name="is_spr_mo" />
      </from>
    </query>
    <query name="msbi_is_spr_nasp" timestamp="04.08.2016 17:23:05" title="0310. Населенный пункт" comment="m1.19">
      <select>
        <column table="is_spr_nasp" column="kod" key="1" as="kod_nasp" />
        <column table="is_spr_nasp" column="name" />
      </select>
      <from>
        <query name="is_spr_nasp" />
      </from>
    </query>
    <query name="msbi_is_spr_podkl_obj" timestamp="22.07.2016 01:53:00" title="0320. Точка подключения" comment="m1.21">
      <select>
        <column table="is_spr_podkl_obj" column="kod_obj" key="1" />
        <column table="is_spr_podkl_obj" column="name" />
      </select>
      <from>
        <query name="is_spr_podkl_obj" />
      </from>
    </query>
    <query name="msbi_as_voltage" timestamp="28.09.2016 14:15:13" title="0330. Уровень напряжения" comment="m1.23">
      <select>
        <column table="as_voltage" column="kn_voltage" key="1" />
        <column table="as_voltage" column="voltage" comment="m7.42" />
        <column table="as_voltage" column="name_kr" />
      </select>
      <from>
        <query name="as_voltage" />
      </from>
    </query>
    <query name="msbi_dog_contr" timestamp="22.07.2016 02:01:58" title="0340. Связь договора ТП и договора подряда" comment="m1.29">
      <select>
        <column table="is_podr_uslug" column="kod_dop_contract" group="1" />
        <column table="is_podr_uslug" column="kod_dog" group="1" />
      </select>
      <from>
        <query name="is_podr_uslug" />
      </from>
    </query>
    <query name="msbi_is_dop_docs_atp" timestamp="22.07.2016 14:24:25" title="0350. Доп документы к АТП" comment="m1.32,m1.33">
      <select>
        <column table="is_dop_docs_atp" column="kod" key="1" />
        <column table="is_dop_docs_atp" column="kod_atp_dop_info" as="kn_sert_power" />
        <column table="is_dop_docs_atp" column="num_doc" />
        <column table="is_dop_docs_atp" column="dat_doc" />
        <column table="is_dop_docs_atp" column="vid_doc" title="Вид документа, 1- Акт о выполнении тех. условий, 2 - Акт осмотра электроустановок" />
      </select>
      <from>
        <query name="is_dop_docs_atp" />
      </from>
    </query>
    <query name="msbi_as_atp_case" timestamp="22.07.2016 12:15:09" title="0360. Уровень напряжения" comment="m1.34">
      <select>
        <column table="as_atp_case" column="kn_atp_case" key="1" />
        <column table="as_atp_case" column="name" />
      </select>
      <from>
        <query name="as_atp_case" title="Вид атп" />
      </from>
    </query>
    <query name="msbi_is_status_atp" timestamp="22.07.2016 12:44:24" title="0370. Состояние заполнения реквизитов" comment="m1.34">
      <select>
        <column table="is_status_atp" column="kod" key="1" />
        <column table="is_status_atp" column="name" />
      </select>
      <from>
        <query name="is_status_atp" title="Вид атп" />
      </from>
    </query>
    <query name="msbi_ipr_ipr_data" timestamp="25.07.2016 15:21:22" title="0390. Версия ИПР" comment="m2.35">
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" key="1" />
        <column table="ipr_ipr_data" column="kod_doc_osn" link="msbi_ipr_doc" title="Документ - основание" />
        <column table="ipr_ipr_data" column="kod_titul_ip" />
        <column table="ipr_ipr_data" column="tip_op" as="h_tip_op" />
        <column table="ipr_ipr_data" column="km" as="h_vk_km" />
        <column table="ipr_ipr_data" column="km_kl" as="h_kl_km" />
        <column table="ipr_ipr_data" column="h_ps_tp" />
        <column table="ipr_ipr_data" column="h_ru_110" />
        <column table="ipr_ipr_data" column="h_ru_35" />
        <column table="ipr_ipr_data" column="h_ru_10" />
        <column table="ipr_ipr_data" column="h_ru_6" />
        <column table="ipr_ipr_data" column="h_cnt_110" />
        <column table="ipr_ipr_data" column="h_cnt_35" />
        <column table="ipr_ipr_data" column="h_cnt_10" />
        <column table="ipr_ipr_data" column="h_cnt_6" />
      </select>
      <from>
        <query name="ipr_ipr_data" title="Вид атп" />
      </from>
    </query>
    <query name="msbi_ipr_tituls_objects" timestamp="27.07.2016 16:31:15" title="0400. Объекты ОС" comment="m2.35">
      <select>
        <column table="ipr_kod_tituls_objects" column="kod_tituls_object" key="1" />
        <column table="ipr_kod_tituls_objects" column="kod_titul_ip" />
        <column table="ipr_kod_tituls_objects" column="kod_vid_object" />
        <column table="kod_object" column="name" />
        <fact column="pr_ch_val_tp_pow_plan" as="tp_pow_plan" comment="m2.35" />
        <fact column="pr_ch_val_tp_volt_plan" as="tp_volt_plan" comment="m2.35" />
        <fact column="pr_ch_val_tr_pow_plan" as="tr_pow_plan" comment="m2.35" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_tituls_objects" all-rows="1">
            <link name="kod_object" />
          </link>
        </qube>
        <query name="ipr_tituls_objects" exclude="1">
          <link name="kod_object" />
        </query>
      </from>
    </query>
    <query name="msbi_ips_vid_object" timestamp="25.07.2016 15:32:02" title="0410. Вид объекта ОС" comment="m2.35">
      <select>
        <column table="ips_vid_object" column="kod_vid_object" key="1" />
        <column table="ips_vid_object" column="name" />
      </select>
      <from>
        <query name="ips_vid_object" />
      </from>
    </query>
    <query name="msbi_is_dop_cont_simple" timestamp="12.08.2016 18:03:55" title="0420.Договор (только поля этапа1)">
      <select>
        <column table="is_dop_contract" column="kod_dop_contract" key="1" />
        <column table="is_dop_contract" column="num_ouco" />
        <column table="is_dop_contract" column="num_ad" />
        <column table="is_dop_contract" column="num_ad_pref" />
        <column table="is_dop_contract" column="dt_contract" title="Дата договора" />
        <column table="is_dop_contract" column="status" />
        <column table="is_dop_contract" column="isp_info" title=" Состояние по ОФЗ" exclude="1" />
        <call function="decode" type="number" as="pr_ofz" title="Признак ОФЗ">
          <column table="is_dop_contract" column="pr_ofz" />
          <const>1</const>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="is_dop_contract" column="kn_contract_p" title="Код основного договора (для доп. соглашения)" link="msbi_is_dop_contract" />
        <call function="nvl0" type="number" title="Признак наличия работ ЛЭ" as="fl_build">
          <column table="is_dop_contract" column="fl_build" />
        </call>
        <call function="nvl0" type="number" title="Признак выполнения работ ЛЭ" as="fl_build_vip">
          <column table="is_dop_contract" column="fl_build_vip" />
        </call>
        <column table="is_dop_contract" column="dat_status_1" title="Дата установки статуса &quot;действующий&quot;" />
        <column table="is_dop_contract" column="dat_status_2" title="Дата установки статуса &quot;аннулирован&quot;" />
        <column table="is_dop_contract" column="dat_status_4" title="Дата установки статуса &quot;выполнен&quot;" />
      </select>
      <from>
        <query name="is_dop_contract" />
      </from>
    </query>
    <query name="msbi_is_period" timestamp="21.01.2017 04:21:57" title="0430.Этап работ по подрядному договору" comment="m1.39,m5.39">
      <select>
        <column table="is_period" column="kod_period" key="1" />
        <column table="is_period" column="kod_dog" link="msbi_is_dogovor" />
        <column table="is_period" column="kod_direct_cfo" comment="m7.53" link="msbi_is_spr_direct" />
        <column table="is_period" column="kod_ucfo" comment="m7.54" link="msbi_is_spr_cfo" />
        <column table="is_period" column="summa" comment="m13.100" />
        <column table="is_period" column="nds" comment="m13.100" />
        <column table="is_period" column="vsego" comment="m13.100" title="Сумма с НДС" />
        <column table="is_period" column="dat_first" comment="m13.101" />
        <column table="is_period" column="dat_last" comment="m13.101" />
        <column table="is_period" column="kod_spr_stage" link="msbi_ips_vid_zatrat" comment="m13.102" />
      </select>
      <from>
        <query name="is_period" />
      </from>
    </query>
    <query name="msbi_is_fin_doc" timestamp="22.08.2016 13:59:27" title="0440. Источник финансирования по этапу работ" comment="m1.39,m5.39">
      <select>
        <column column="kod_fin_doc" key="1" table="is_fin_doc" />
        <column table="is_fin_doc" column="kod_period" />
        <column table="is_fin_doc" column="kod_spr_doc" />
        <column table="is_fin_doc" column="kod_spr_budget" />
        <column table="is_fin_doc" column="num" title="Номер / Наименование" />
      </select>
      <from>
        <query name="is_fin_doc" />
      </from>
    </query>
    <query name="msbi_is_spr_budget" timestamp="04.06.2018 11:54:14" title="0450. Статья бюджета (ДПН)" comment="m1.39,m5.39">
      <select>
        <column column="kod_spr_budget" key="1" table="is_spr_budget" title="Статья бюджета" comment="m0,m23.174" />
        <column table="is_spr_budget" column="name" comment="m0,m19.145,m23.174,m23.176" />
        <column table="is_spr_budget" column="kod_budget" comment="m19.145,m23.174,m23.176,m22.169" title="Статья бюджета" />
        <column table="is_spr_budget" column="prizn" title="Расход(1)/Доход(0)" comment="m23.174" />
        <column table="is_spr_budget" column="kod_direct" title="Подразделение (3-ЛЭ)" comment="m23.174" />
        <column table="is_spr_budget" column="dat_start" title="Дата начала (число)" comment="m23.174" />
        <column table="is_spr_budget" column="dat_finish" title="Дата окончания(число)" comment="m23.174" />
        <column table="is_spr_budget" column="kod_parent" title="Код родителя" comment="m23.174" />
      </select>
      <from>
        <query name="is_spr_budget" />
      </from>
    </query>
    <query name="imsbi_is_opl_period" timestamp="13.12.2016 18:48:06" title="0110.Оплата по подрядному договору (КИДО)" haskeys="1" path=".">
      <select>
        <column table="a" column="kod_opl_period" key="1" />
        <column table="a" column="kod_vip_dog" as="kod_vip_dog" fixed="1" />
        <const type="number" as="kod_titul_ip">null</const>
        <column table="a" column="kod_dog" />
        <column table="kod_opl_ro" column="num_doc" as="num_doc" title="Номер документа" />
        <column table="kod_opl_ro" column="dat_opl" title="Дата документа" />
        <column table="a" column="sum_opl" title="Сумма с НДС" as="vsego" />
        <column table="a" column="nds" as="nds" title="НДС" />
        <call function="-nvl" as="summ" title="Сумма  без НДС">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="kod_opl_ro" column="kod_spr_doc" title="Вид платежа" />
        <const type="number" as="pr_itog">0</const>
        <call function="decode" type="number" as="pr_ofz" title="Признак ОФЗ">
          <column table="a" column="pr_ofz" />
          <const>1</const>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="if" as="is_avans" title="Признак авансовой оплаты" comment="m8.61">
          <call function="and">
            <call function="=">
              <column table="kod_vip_dog" column="kod_spr_doc" />
              <const>21</const>
            </call>
            <call function="=">
              <column table="kod_vip_dog" column="prizn_r" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <const type="number" as="kodzatrat">null</const>
      </select>
      <from>
        <query name="is_opl_period" as="a">
          <link name="kod_opl_period" />
          <link name="kod_opl_ro">
            <link name="kod_ro" />
          </link>
          <link name="kod_vip_dog" />
        </query>
      </from>
      <where>
        <call function="or" exclude="1">
          <call function="and">
            <call function="gt">
              <column table="this" column="dat_opl" />
              <const>DATE'2012-12-31'</const>
            </call>
            <call function="is null">
              <column table="kod_opl_period" column="kod_opl_period" />
            </call>
          </call>
        </call>
        <call function="not exists">
          <query>
            <select>
              <column table="i" column="kod_opl_period" />
            </select>
            <from>
              <query name="isv_ip_opl" as="i" />
            </from>
            <where>
              <call function="=">
                <column table="i" column="kod_dog" />
                <column table="a" column="kod_dog" />
              </call>
            </where>
          </query>
        </call>
      </where>
    </query>
    <query name="msbi_is_opl_all" timestamp="13.12.2016 18:50:12" title="0117.Оплата по подрядному договору (КИДО и ИнвестPRO)" haskeys="1" path="." comment="m6.40">
      <select>
        <column table="a" column="kod_opl_period" key="1" />
        <column table="a" column="kod_vip_dog" link="msbi_is_vip_dog_all" />
        <column table="a" column="kod_titul_ip" />
        <column table="a" column="kod_dog" />
        <column table="a" column="num_doc" />
        <column table="a" column="dat_opl" />
        <column table="a" column="vsego" />
        <column table="a" column="nds" />
        <column table="a" column="summ" />
        <column table="a" column="kod_spr_doc" />
        <column table="a" column="pr_itog" />
        <column table="a" column="pr_ofz" comment="m6.40" />
        <column table="a" column="is_avans" comment="m8.61" />
        <column table="a" column="kodzatrat" comment="m8.62" link="msbi_ips_vid_zatrat" />
      </select>
      <from>
        <query as="a">
          <union>
            <query>
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="msbi_isv_ip_opl" />
              </from>
            </query>
            <query>
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="imsbi_is_opl_period" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
    <query name="msbi_is_vip_dog" timestamp="13.12.2016 19:56:29" title="0093.Акт выполненных работ (КИДО)" haskeys="1" path="." comment="m6.40">
      <select>
        <column table="is_vip_dog" column="kod_vip_dog" as="kod_vip_dog" key="1" fixed="1" />
        <column table="is_vip_dog" column="kod_dog" />
        <column table="kod_doc_vip" column="num" as="num_doc" title="Номер акта" />
        <column table="kod_doc_vip" column="dat_doc" as="dat_doc" title="Дата акта" />
        <column table="is_vip_dog" column="vsego" as="vsego" title="Сумма с НДС" />
        <column table="is_vip_dog" column="nds" as="nds" title="НДС" />
        <call function="-nvl" as="summ" title="Сумма  без НДС">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="is_vip_dog" column="dat_buh" title="Дата учета" as="dat_buh" />
        <column table="kod_doc_vip" column="kod_uid" title="UID" />
        <column table="is_vip_dog" column="kod_spr_doc" />
        <column table="is_vip_dog" column="pr_ofz" comment="m10.83" />
      </select>
      <from>
        <query name="is_vip_dog">
          <link name="kod_doc_vip" />
        </query>
      </from>
    </query>
    <query name="imsbi_is_vip_dog" timestamp="12.09.2016 14:29:58" title="0093.Акт выполненных работ (КИДО)" haskeys="1" path=".">
      <select>
        <column table="is_vip_dog" column="kod_vip_dog" as="kod_vip_dog" key="1" fixed="1" />
        <column table="is_vip_dog" column="kod_dog" />
        <const type="number" as="kodzatrat">null</const>
        <column table="kod_doc_vip" column="num" as="num_doc" title="Номер акта" />
        <column table="kod_doc_vip" column="dat_doc" as="dat_doc" title="Дата акта" />
        <column table="is_vip_dog" column="vsego" as="vsego" title="Сумма с НДС" />
        <column table="is_vip_dog" column="nds" as="nds" title="НДС" />
        <call function="-nvl" as="summ" title="Сумма  без НДС">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="is_vip_dog" column="dat_buh" title="Дата учета" as="dat_buh" />
        <column table="kod_doc_vip" column="kod_uid" title="UID" />
        <column table="is_vip_dog" column="kod_spr_doc" />
        <const type="number" as="kod_doc_type">null</const>
        <const type="number" as="kod_titul_ip">null</const>
        <const type="number" as="pr_itog">0</const>
      </select>
      <from>
        <query name="is_vip_dog">
          <link name="kod_doc_vip" />
        </query>
      </from>
      <where>
        <call function="not exists">
          <query>
            <select>
              <column table="i" column="kod_vip_dog" />
            </select>
            <from>
              <query name="isv_ip_vip_dog" as="i" />
            </from>
            <where>
              <call function="=">
                <column table="i" column="kod_dog" />
                <column table="is_vip_dog" column="kod_dog" />
              </call>
            </where>
          </query>
        </call>
      </where>
    </query>
    <query name="msbi_is_vip_dog_all" timestamp="12.09.2016 14:29:16" title="0097.Акт выполненных работ (КИДО и ИнвестPRO)" haskeys="1" path="." comment="m6.40">
      <select>
        <column table="a" column="kod_vip_dog" key="1" />
        <column table="a" column="kod_dog" />
        <column table="a" column="kodzatrat" />
        <column table="a" column="num_doc" />
        <column table="a" column="dat_doc" />
        <column table="a" column="vsego" />
        <column table="a" column="nds" />
        <column table="a" column="summ" />
        <column table="a" column="dat_buh" />
        <column table="a" column="kod_uid" />
        <column table="a" column="kod_spr_doc" />
        <column table="a" column="kod_doc_type" />
        <column table="a" column="kod_titul_ip" />
        <column table="a" column="pr_itog" />
      </select>
      <from>
        <query as="a">
          <union>
            <query>
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="msbi_isv_ip_vip_dog" />
              </from>
            </query>
            <query>
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="imsbi_is_vip_dog" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
    <query name="msbi_as_request" title="0460. Заявки" class="1" timestamp="06.12.2016 12:53:02" haskeys="1" path="." comment="m7.42">
      <select>
        <column table="a" column="kn_request" type="number" title="" comment="ключ заявки" key="1" />
        <column table="a" column="kn_load_type" type="number" title="" as="kn_load_type" link="msbi_as_load_type" />
        <column table="a" column="kn_st_req" link="msbi_as_st_req" />
        <column table="a" column="kn_customer" link="msbi_as_customer" />
        <column table="a" column="kn_region" link="msbi_as_region" />
        <column table="a" column="kn_load_kind" link="msbi_as_load_kind" />
        <column table="a" column="kn_voltage" link="msbi_as_voltage" />
        <call function="||" title="Номер заявки" as="req_num">
          <call function="lpad">
            <call function="to_char">
              <column table="a" column="req_year" />
            </call>
            <const type="number">2</const>
            <const type="string">'0'</const>
          </call>
          <const type="string">'-'</const>
          <call function="to_char">
            <column table="a" column="req_num" />
          </call>
        </call>
        <column table="a" column="date_coming" title="Дата заявки" />
        <call function="+nvl" title="Мощность кВт заявленная" as="load_cat">
          <column table="a" column="load_cat1" />
          <column table="a" column="load_cat2" />
          <column table="a" column="load_cat3" />
        </call>
        <call function="+nvl" title="Мощность кВт существующая" as="load_ex">
          <column table="a" column="load_ex1" />
          <column table="a" column="load_ex2" />
          <column table="a" column="load_ex3" />
        </call>
        <call function="+nvl" title="Мощность кВт суммарная" as="load_all">
          <column table="this" column="load_cat" />
          <column table="this" column="load_ex" />
        </call>
        <column table="a" column="dt_docs_got" title="Получены все необходимые документы" />
        <call function="if" as="fl_worknet_name" type="string" title="Наличие работ. Распред. сеть">
          <call function="=">
            <column table="a" column="fl_work_net" />
            <const>1</const>
          </call>
          <const type="string">'с работами'</const>
          <const type="string">'без работ'</const>
        </call>
        <call function="if" as="fl_build_name" type="string" title="Наличие работ. ИП">
          <call function="=">
            <column table="a" column="fl_build" />
            <const>1</const>
          </call>
          <const type="string">'с работами'</const>
          <const type="string">'без работ'</const>
        </call>
        <call function="if" as="fl_all" type="string" title="Наличие работ. В целом">
          <call function="or">
            <call function="=">
              <column table="a" column="fl_work_net" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="fl_build" />
              <const>1</const>
            </call>
          </call>
          <const type="string">'да'</const>
          <const type="string">'нет'</const>
        </call>
        <call function="if" as="indtar_got_str" title="Наличие инд. тарифа">
          <call function="is not null">
            <column table="a" column="dt_indtar_got" />
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <column table="a" column="date_off" title="Дата аннул. заявки" comment="m8.59" />
      </select>
      <from>
        <query name="as_request" as="a" />
      </from>
    </query>
    <query name="msbi_as_st_req" class="1" timestamp="29.09.2016 12:36:24" title="0470. Статус заявок" comment="m7.42">
      <select>
        <column table="a" column="kn_st_req" type="number" title="" comment="ключ статуса заявки" key="1" />
        <column table="a" column="name" type="string" title="Статус заявки" comment="m7.42" />
        <column table="a" column="sname" type="string" title="" comment="краткое наименвание статуса" />
      </select>
      <from>
        <query name="as_st_req" as="a" />
      </from>
    </query>
    <query name="msbi_as_customer" class="1" title="0480. Клиенты" comment="m7.42" timestamp="29.09.2016 12:37:49">
      <select>
        <column table="a" column="kn_customer" type="number" title="" comment="ключ клиента" key="1" />
        <column table="a" column="name" type="string" title="Клиент" comment="m7.42" />
      </select>
      <from>
        <query name="as_customer" as="a" />
      </from>
    </query>
    <query name="msbi_as_region" class="1" timestamp="28.09.2016 14:03:53" title="0490. Регионы" comment="m7.42">
      <select>
        <column table="a" column="kn_region" type="number" title="" key="1" />
        <column table="a" column="name" type="string" title="Регион" />
      </select>
      <from>
        <query name="as_region" as="a" />
      </from>
    </query>
    <query name="msbi_as_load_kind" class="1" timestamp="28.09.2016 14:04:35" title="0500. Объекты" comment="m7.42">
      <select>
        <column table="a" column="kn_load_kind" type="number" title="" comment="ключ вида нагрузки" key="1" />
        <column table="a" column="name" type="string" title="Объект" comment="наименование вида нагрузки" />
      </select>
      <from>
        <query name="as_load_kind" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_vid_ds" class="1" timestamp="29.09.2016 12:41:00" title="0510. Виды дополнительных соглашений" comment="m7.45">
      <select>
        <column table="a" column="kod_vid_ds" type="number" key="1" />
        <column table="a" column="name" type="string" title="Вид дополнительного соглашения" comment="m7.45" />
        <column table="a" column="abbr" type="string" title="Аббревиатура" />
      </select>
      <from>
        <query name="is_spr_vid_ds" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_vid_otl_usl" class="1" title="0520. Виды отлагательных условий" timestamp="29.09.2016 12:41:58" comment="m7.47">
      <select>
        <column table="a" column="kod" type="number" title="" key="1" />
        <column table="a" column="name" type="string" title="Вид отлагательных условий" />
      </select>
      <from>
        <query name="is_spr_vid_otl_usl" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_group" class="1" timestamp="29.09.2016 12:43:34" title="0530. Группы индивидуальных тарифов" comment="m7.50">
      <select>
        <column table="a" column="kod_group" type="number" key="1" />
        <column table="a" column="name" type="string" title="Группа индивидуального тарифа" comment="наименование группы" />
      </select>
      <from>
        <query name="is_spr_group" as="a" />
      </from>
    </query>
    <query name="msbi_c_debet" title="0540. График оплат" class="1" comment="m7.51" timestamp="29.09.2016 11:45:46">
      <select>
        <column table="a" column="kod_deb" type="number" key="1" title="" />
        <column table="a" column="kod_dog" type="number" link="msbi_is_dop_contract" />
      </select>
      <from>
        <query name="c_debet" as="a" />
      </from>
    </query>
    <query name="msbi_c_facvip" class="1" title="0550. Начисления" comment="m7.51" timestamp="29.09.2016 12:45:47">
      <select>
        <column table="a" column="kod_sf" type="number" key="1" />
        <column table="a" column="kod_deb" type="number" link="msbi_c_debet" />
        <column table="a" column="dat_bzad" type="date" title="Срок оплаты" comment="m7.51" />
        <column table="a" column="stage" type="string" title="Этап оплаты" comment="m7.51" />
      </select>
      <from>
        <query name="c_facvip" as="a" />
      </from>
      <where comment="по комментарию Татьяны С.">
        <call function="=">
          <column table="a" column="vid_real" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="msbi_c_opl" title="0560. Оплаты" class="1" timestamp="29.09.2016 12:46:00" comment="m7.52">
      <select>
        <column table="a" column="kod_opl" type="number" key="1" />
        <column table="a" column="kod_sf" type="number" link="msbi_c_facvip" />
        <column table="a" column="datao" type="number" title="" comment="m7.52" />
        <column table="a" column="opl" type="number" title="" />
      </select>
      <from>
        <query name="c_opl" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_cfo" class="1" timestamp="30.09.2016 17:20:04" comment="m7.54" title="0570. УЦФО">
      <select>
        <column table="a" column="kod_cfo" type="number" key="1" />
        <column table="a" column="name" type="string" title="Наименование" />
        <column table="a" column="name_kr" type="string" title="УЦФО" comment="m7.54" as="ucfo_name" />
      </select>
      <from>
        <query name="is_spr_cfo" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_fs" class="1" timestamp="06.10.2016 10:38:28" title="0580. Формы собственности" comment="m8.56">
      <select>
        <column table="a" column="kod_fs" type="number" key="1" />
        <column table="a" column="name" type="string" title="Форма собственности" />
        <column table="a" column="abbr" type="string" title="Аббревиатура" />
      </select>
      <from>
        <query as="a" name="is_spr_fs" />
      </from>
    </query>
    <query name="msbi_ipr_doc_by_ipr" class="1" timestamp="11.10.2016 14:22:43" comment="m8.57" title="0590. Связи версий ИПР и документов, в них использующихся">
      <select>
        <column table="a" column="kod_doc_by_ipr" type="number" key="1" />
        <column table="a" column="kod_doc" type="number" link="msbi_ipr_doc" />
        <column table="a" column="kod_ip_by_year1" type="number" />
        <column table="a" column="kod_status1" type="number" comment="показывает, в каком статусе была программа, когда унее появился этот док-т" />
        <column table="a" column="kod_ipr" type="number" link="msbi_ipr_ipr_data" />
      </select>
      <from>
        <query name="ipr_doc_by_ipr" as="a" />
      </from>
    </query>
    <query name="msbi_is_spr_vid_doc" class="1" timestamp="13.12.2016 20:20:00" title="0610. Виды документов" comment="m8.60">
      <select>
        <column table="a" column="kod_vid_doc" type="number" key="1" />
        <column table="a" column="name" type="string" title="Наименование" comment="m10.81" />
        <column table="a" column="abbr" type="string" title="Аббревиатура" />
        <column table="a" column="pr_rekv" type="number" title="" comment="признак вида док-та из табл. is_spr_doc" link="msbi_is_spr_doc" />
      </select>
      <from>
        <query name="is_spr_vid_doc" as="a" />
      </from>
    </query>
    <query name="msbi_c_dop_doc" class="1" timestamp="13.12.2016 20:19:50" comment="m8.60" title="0600. Документы по договорам ТП">
      <select>
        <column table="a" column="kod_dop_doc" type="number" key="1" />
        <column table="a" column="num_doc" type="string" title="" />
        <column table="a" column="dat_doc" type="date" title="" />
        <column table="a" column="kod_dop_contract" link="msbi_is_dop_contract" />
        <column table="a" column="kod_vid_doc" link="msbi_is_spr_vid_doc" />
      </select>
      <from>
        <query name="c_dop_doc" as="a" />
      </from>
    </query>
    <query name="msbi_is_opl_period" timestamp="16.01.2017 19:22:13" title="0113.Оплата по подрядному договору (КИДО)" haskeys="1" path="." comment="m6.40">
      <select>
        <column table="a" column="kod_opl_period" key="1" />
        <column table="a" column="kod_vip_dog" as="kod_vip_dog" fixed="1" link="msbi_is_vip_dog" comment="m10.77" />
        <column table="a" column="kod_dog" link="msbi_is_dogovor" comment="m10.77" />
        <column table="kod_opl_ro" column="num_doc" as="num_doc" title="Номер документа" comment="m10.72" />
        <column table="kod_opl_ro" column="dat_opl" title="Дата оплаты" comment="m10.73" />
        <column table="a" column="sum_opl" title="Сумма с НДС" as="vsego" comment="m10.74" />
        <column table="a" column="nds" as="nds" title="НДС" comment="m10.74" />
        <call function="-nvl" as="summ" title="Сумма  без НДС" comment="m10.74">
          <column table="this" column="vsego" />
          <column table="this" column="nds" />
        </call>
        <column table="kod_opl_ro" column="kod_spr_doc" comment="m10.75" link="msbi_is_spr_doc" />
        <call function="decode" type="number" as="pr_ofz" title="Признак ОФЗ" comment="m10.67">
          <column table="a" column="pr_ofz" />
          <const>1</const>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="if" as="is_avans" title="Признак авансовой оплаты" comment="m8.61">
          <call function="and">
            <call function="=">
              <column table="kod_vip_dog" column="kod_spr_doc" />
              <const>21</const>
            </call>
            <call function="=">
              <column table="kod_vip_dog" column="prizn_r" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="kod_opl_ro" column="kod_ro" comment="m10.64" link="msbi_is_ro" />
        <column table="kod_opl_ro" column="kod_vidopl" comment="m10.76" link="msbi_ks_vidopl" />
        <call function="if" as="is_vozrat" title="Признак возврата денежных средств" comment="m10.78">
          <call function="is not null">
            <column table="kod_opl_ro" column="kod_dog" />
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="trunc" as="dat_opl_kazn" title="Дата оплаты в казначействе" comment="m11.84">
          <column table="kod_link" column="dat_opl" />
        </call>
        <column table="kod_link" column="num_opl" title="Номер ПП в казначействе" as="num_doc_kazn" comment="m11.85" />
        <call function="nvl" title="Дата ПП в казначействе" comment="m11.85" as="dat_doc_kazn">
          <column table="kod_link" column="dat_deb" />
          <column table="kod_link" column="dat_opl" />
        </call>
        <column table="kod_link" column="osn_opl" title="Назначение платежа в казначействе" as="nazn_kazn" comment="m11.86" />
        <call function="trunc" as="dat_bank_kazn" title="Дата выписки в казначействе" comment="m11.87">
          <column table="kod_extract" column="dat_bank" />
        </call>
        <column table="kod_link" column="kodb_p" link="msbi_ks_bank_p" comment="m11.88" />
        <column table="a" column="kod_parent" link="msbi_is_opl_period" comment="m12.93" />
      </select>
      <from>
        <query name="is_opl_period" as="a">
          <link name="kod_opl_period" />
          <link name="kod_opl_ro">
            <link name="kod_link">
              <link name="kod_extract" />
            </link>
          </link>
          <link name="kod_vip_dog" />
        </query>
      </from>
    </query>
    <query name="msbi_ipr_csv" timestamp="15.08.2017 16:27:34" title="0200.Контрольный этап (процедура , просто й запрос завис)" is-report="1">
      <select>
        <column table="ipr_contr_steps_val" column="kod_contr_steps_val" key="1" comment="3" />
        <column table="kod_ipr" column="kod_titul_ip" comment="3" />
        <column table="ipr_contr_steps_val" column="kod_doc" title="Документ, утверждающий контрольный этап" comment="3" />
        <column table="kod_template_contr_steps_val" column="kod_template_contr_steps_val" as="kod_template_contr_steps" comment="3" />
        <column table="ipr_contr_steps_val" column="ep_date" comment="3" />
        <column table="ipr_contr_steps_val" column="ef_date" comment="3" />
      </select>
      <from>
        <query name="ipr_contr_steps_val">
          <link name="kod_template_contr_steps_val" />
          <link name="kod_ipr" />
        </query>
      </from>
    </query>
  </queries>
</root>