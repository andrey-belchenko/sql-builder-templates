<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-06-29T03:13:43.3322242+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="vc_add_kontact" timestamp="10.10.2018 21:25:24" class="1" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_kontact" type="number" />
        <param name="user_id" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="kod_kontact">
          <useparam name="kod_kontact" />
        </call>
        <call function="()" type="number" as="user_id">
          <useparam name="user_id" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vc_add_creditor" timestamp="11.10.2018 14:51:40" class="1" update-target="vc_ul_creditors" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="e_code" type="number" />
        <param name="user_id" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="e_code">
          <useparam name="e_code" />
        </call>
        <call function="()" type="number" as="user_id">
          <useparam name="user_id" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vcf_ul_kontakt_insert" timestamp="31.10.2018 19:37:29" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="user_id" type="number" />
        <param type="number" name="kod_kontakt" />
      </params>
      <select>
        <column table="a" column="kod_kontact" />
        <call function="()" type="number" as="user_id">
          <useparam name="user_id" />
        </call>
      </select>
      <from>
        <query as="a" name="is_kontact">
          <elink name="vc_ul_kontakt" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_kontact" />
            <useparam name="kod_kontakt" />
          </call>
          <call function="is null">
            <column table="vc_ul_kontakt" column="kod_kontact" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_ul_zayav_insert" timestamp="04.12.2018 04:38:40" update-target="vc_ul_zayav" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="user_id" type="number" />
        <param name="num_zayav" type="string" />
        <param name="request_kind" type="number" />
      </params>
      <select>
        <call function="()" type="string" as="num_zayav">
          <useparam name="num_zayav" />
        </call>
        <call function="()" type="number" as="user_id">
          <useparam name="user_id" />
        </call>
        <call function="()" type="number" as="request_kind">
          <useparam name="request_kind" />
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
      <where>
        <call function="not exists">
          <query>
            <select>
              <column table="b" column="kod_ul_zayav" />
            </select>
            <from>
              <query name="vc_ul_zayav" as="b" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="b" column="num_zayav" />
                  <useparam name="num_zayav" />
                </call>
                <call function="=">
                  <column table="b" column="user_id" />
                  <useparam name="user_id" />
                </call>
              </call>
            </where>
          </query>
        </call>
      </where>
    </query>
    <query name="vc_num_zayav" timestamp="27.11.2018 02:38:14" class="1" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="num_zayav" type="string" />
      </params>
      <select>
        <call function="rownum" type="number" as="id" key="1" />
        <call function="()" type="string" as="num_zayav" title="Номер заявки">
          <useparam name="num_zayav" />
        </call>
        <column table="c_zayav" column="kod_zayav" />
        <column table="c_zayav_virtual" column="kod" as="kod_zayav_virt" />
        <call function="if" as="found" type="number">
          <call function="is not null">
            <column table="this" column="kod_zayav" />
            <column table="this" column="kod_zayav_virt" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
        <query name="c_zayav" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="num_zayav" />
            <column table="c_zayav" column="num_zayav" />
          </call>
        </query>
        <query name="c_zayav_virtual" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <call function="||">
              <const>'ВО '</const>
              <column table="this" column="num_zayav" />
            </call>
            <column table="c_zayav_virtual" column="num_zayav_vo" />
          </call>
        </query>
        <query name="c_zayav" as="kod_zayav" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="kod_zayav" />
            <column table="kod_zayav" column="kod_zayav" />
          </call>
        </query>
        <query name="c_zayav_virtual" as="kod_zayav_virt" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="kod_zayav_virt" />
            <column table="kod_zayav_virt" column="kod" />
          </call>
        </query>
      </from>
    </query>
    <query name="vc_ul_for_num_zayav" timestamp="01.11.2018 20:05:02" class="1" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="num_zayav" type="string">
          <const>''</const>
        </param>
      </params>
      <expressions>
        <call function="if" type="number" as="is_connected" group="max">
          <call function="=">
            <column table="vc_ul_zayav" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
          <fact column="vc_ul_zayav_cnt" />
        </call>
      </expressions>
      <select>
        <column table="a" column="user_id" group="1" key="1" />
        <column table="a" column="fio" group="max" />
        <column table="a" column="user_phone" column-width="146" group="max" />
        <column table="a" column="user_email" column-width="209" group="max" />
      </select>
      <from>
        <qube>
          <link name="vc_user_login" as="a" all-rows="1">
            <elink name="vc_ul_kontakt">
              <link name="kod_kontact">
                <link name="e_code">
                  <elink name="qr_list_zpr_abons">
                    <link name="kod_zayav" />
                  </elink>
                </link>
              </link>
            </elink>
          </link>
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_zayav" column="num_zayav" />
                <useparam name="num_zayav" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="is null">
          <fact column="is_connected" />
        </call>
      </where>
    </query>
    <query name="vc_ul_zayav_check" timestamp="31.10.2018 19:35:26" class="1" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="user_id" type="number" />
        <param name="num_zayav" type="string" />
      </params>
      <select>
        <call function="()" as="val" type="number">
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="vc_ul_zayav" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="user_id" />
            <useparam name="user_id" />
          </call>
          <call function="=">
            <column table="a" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_search_kontakt" timestamp="04.12.2018 04:27:13" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_zayav" type="number">
          <const>72442</const>
        </param>
        <param name="user_id" type="number">
          <const>27</const>
        </param>
      </params>
      <select>
        <column table="k" column="kod_kontact" group="max" />
      </select>
      <from>
        <query name="c_zayav" as="z">
          <link name="kodp">
            <elink name="is_kontact" as="k" />
          </link>
        </query>
        <query name="vc_user_login" as="l" join="cross" />
        <query name="is_kontact" as="kod_kontact" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="kod_kontact" />
            <column table="kod_kontact" column="kod_kontact" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <useparam name="kod_zayav" />
            <column table="z" column="kod_zayav" />
          </call>
          <call function="=">
            <useparam name="user_id" />
            <column table="l" column="user_id" />
          </call>
          <call function="=">
            <call function="cut_phone">
              <column table="k" column="phone" />
            </call>
            <call function="cut_phone">
              <column table="l" column="user_phone" />
            </call>
          </call>
          <call function="lt" exclude="1">
            <call function="rownum" />
            <const>2</const>
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_kont_user_id" timestamp="29.11.2018 22:38:01" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_kontakt" type="number" />
      </params>
      <select>
        <column table="a" column="user_id" />
      </select>
      <from>
        <query name="vc_ul_kontakt" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_kontact" />
            <useparam name="kod_kontakt" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_kont_search_user_id" timestamp="26.12.2018 18:49:22" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_kontakt" type="number">
          <const>12</const>
        </param>
      </params>
      <select>
        <column table="b" column="user_id" group="max" />
        <column table="b" column="user_id" group="count" as="cnt" />
      </select>
      <from>
        <query name="is_kontact" as="a" />
        <query name="vc_user_login" as="b" join="left outer">
          <call function="or">
            <call function="=">
              <column table="a" column="phone_clear" />
              <column table="b" column="phone_clear" />
            </call>
            <call function="=">
              <call function="lower">
                <column table="a" column="e_mail" />
              </call>
              <call function="lower">
                <column table="b" column="user_email" />
              </call>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_kontact" />
            <useparam name="kod_kontakt" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_validate_kontakt_change" timestamp="27.12.2018 20:32:42" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_kontakt" type="number">
          <const>111</const>
        </param>
        <param type="string" name="num_zayav">
          <const>'18-55999'</const>
        </param>
      </params>
      <select>
        <call function="case" as="val" type="string">
          <call function="when">
            <call function="and">
              <call function="is not null">
                <column table="uiz" column="user_id" group="max" />
              </call>
              <call function="is null">
                <column table="uik" column="user_id" group="max" />
              </call>
              <call function="=">
                <column table="uiz" column="user_id" group="max" />
                <call type="" group="max" function="nvl">
                  <column table="vc_ul_kontakt" column="user_id" as="" type="" />
                  <column table="vc_ul_kontakt_v" column="user_id" as="" type="" />
                </call>
              </call>
            </call>
            <call function="||">
              <const>'Заявка будет отвязана от личного кабинета '</const>
              <column table="uiz" column="user_email" group="max" />
            </call>
          </call>
          <call function="when">
            <call function="!=">
              <column table="uiz" column="user_id" group="max" />
              <column table="uik" column="user_id" group="max" />
            </call>
            <call function="||">
              <const>'Заявка будет отвязана от личного кабинета '</const>
              <column table="uiz" column="user_email" group="max" />
              <const>' и привязана к личному кабинену  '</const>
              <column table="uik" column="user_email" group="max" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="vc_num_z_vo" as="a">
          <link name="kod_zayav" as="z">
            <link name="kod_kontact">
              <elink name="vc_ul_kontakt" />
            </link>
          </link>
          <link name="kod_zayav_virt" as="v">
            <link name="kod_kontact" as="kod_kontact_v">
              <elink name="vc_ul_kontakt" as="vc_ul_kontakt_v" />
            </link>
          </link>
          <elink name="vc_ul_zayav">
            <link name="user_id" as="uiz" />
          </elink>
        </query>
        <query name="vc_ul_kontakt" as="uk" join="left outer">
          <link name="user_id" as="uik" />
          <call function="=">
            <column column="kod_kontact" table="uk" />
            <useparam name="kod_kontakt" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_ul_zayav_insert_nc" timestamp="04.12.2018 04:27:32" update-target="vc_ul_zayav" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="num_zayav" type="string">
          <const>2</const>
        </param>
      </params>
      <select>
        <column table="a" column="num_zayav" />
        <column table="vc_ul_kontakt" column="user_id" />
        <call function="()" type="number" as="request_kind">
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="c_zayav" as="a">
          <link name="kod_kontact">
            <elink name="vc_ul_kontakt" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
          <call function="is not null">
            <column table="vc_ul_kontakt" column="user_id" />
            <useparam name="num_zayav" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_test" timestamp="02.12.2018 23:25:26" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="user_id" type="number">
          <const>63</const>
        </param>
        <param name="p_num" type="array">
          <const>('18-55801','18-55803','18-55798','18-55797','18-55792','18-55791','18-55774','18-55769','18-55758','18-55768','18-55767','18-55766','ВО','18-55804','ВО','18-55804')</const>
        </param>
      </params>
      <expressions>
        <call group="max" function="if" type="number" as="bad_kont_pr">
          <call function="and">
            <call function="!=nvl">
              <useparam name="user_id" />
              <column table="vc_user_login_by_k" column="user_id" />
            </call>
            <call function="is not null">
              <column table="c_zayav" column="kod_zayav" />
            </call>
            <call function="=0">
              <column table="vc_num_z_vo" column="pr_change_kont" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call group="max" function="if" type="number" as="bad_kont">
          <call function="and">
            <call function="!=nvl">
              <useparam name="user_id" />
              <column table="vc_user_login_by_k" column="user_id" />
            </call>
            <call function="is not null">
              <column table="c_zayav" column="kod_zayav" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call group="max" function="if" type="number" as="is_bound">
          <call function="and">
            <call function="is not null">
              <column table="vc_user_login" column="user_id" />
            </call>
            <call function="=0">
              <column table="vc_num_z_vo" column="pr_rebind" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call type="number" as="cant_sel" group="sum" function="nvl">
          <fact column="bad_kont_pr" nullif="0" />
          <fact column="is_bound" nullif="0" />
        </call>
      </expressions>
      <select>
        <column table="np_z_vo" column="num_zayav" parname="np_kod" column-visible="0" />
        <column table="np_z_vo" column="kod_zayav" parname="kod_zayav" column-visible="0" />
        <column table="np_z_vo" column="kod_zayav_virt" parname="kod_zayav_virt" column-visible="0" />
        <column table="np_z_vo" column="name_org" as="namep" column-width="225" />
        <column table="np_z_vo" column="num_zayav_vo" column-width="125" />
        <column table="np_zv" column="d_c" />
        <column table="np_z_vo" column="num_z" column-width="87" as="num_z" />
        <column table="np_z" column="dat_zayav" column-width="119" />
        <column table="np_kon" column="vis_id" column-width="210" title="Оcновной контакт" as="k_vis_id" />
        <fact parname="bad_kont" column="bad_kont" column-visible="0" />
        <column table="np_z_vo" column="pr_change_kont" editable="bad_kont" />
        <column table="user_id" column="vis_id" title="Логин ЛКК" as="u_vis_id" column-width="207" />
        <column table="np_z_vo" column="pr_rebind" editable="old_user_id" column-width="91" />
        <fact column="cant_sel" parname="can_sel" column-visible="0" />
        <column table="user_id" column="user_id" column-visible="0" parname="old_user_id" />
      </select>
      <from>
        <qube>
          <link name="vc_num_z_vo" as="np_z_vo" all-rows="1">
            <link name="kod_zayav" as="np_z">
              <link name="kod_kontact" as="np_kon" />
            </link>
            <link name="kod_zayav_virt" as="np_zv" />
          </link>
          <link name="vc_ul_zayav" as="np_uz">
            <link name="user_id" />
            <where exclude="1">
              <call function="=">
                <column table="np_uz" column="user_id" />
                <useparam name="user_id" />
              </call>
            </where>
          </link>
          <where>
            <call function="and">
              <call function="or" exclude="1">
                <call function="false" />
                <call function="in" optional="1">
                  <column column="num_zayav" table="np_z_vo" />
                  <useparam name="p_num" />
                </call>
              </call>
              <call function="in">
                <column column="num_zayav" table="np_z_vo" />
                <useparam name="p_num" />
              </call>
              <call function="!=nvl" exclude="1">
                <column column="user_id" table="np_uz" />
                <useparam name="user_id" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="vcf_zayav_get_main_kont_and_user" timestamp="27.12.2018 16:59:18" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="num_zayav" type="string">
          <const>'12'</const>
        </param>
      </params>
      <select>
        <call as="kod_kontact" type="number" group="max" function="nvl">
          <column table="a" column="kod_kontact" as="" type="" />
          <column table="v" column="kod_kontact" as="" type="" />
        </call>
        <column column="user_id" table="vc_ul_zayav" group="max" />
      </select>
      <from>
        <query name="vc_num_z_vo" as="x">
          <link name="kod_zayav" as="a" />
          <link name="kod_zayav_virt" as="v" />
          <elink name="vc_ul_zayav" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="x" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_not_num_z" timestamp="03.12.2018 02:08:56" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="p_num" type="array">
          <const>('18-55801','18-55803','18-55798','18-55797','18-55792','18-55791','18-55774','18-55769','18-55758','18-55768','18-55767','18-55766','ВО','18-55804','ВО','18-55804')</const>
        </param>
      </params>
      <select>
        <call function="()" as="val" group="max" nvl="0">
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <const>null</const>
            <useparam name="p_num" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcf_vo_search_user_id" timestamp="27.12.2018 22:38:19" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="num_zayav" type="string">
          <const>'12'</const>
        </param>
      </params>
      <select>
        <column table="b" column="user_id" group="max" />
        <column table="b" column="user_id" group="count" as="cnt" />
      </select>
      <from>
        <query name="vc_num_z_vo" as="x">
          <link name="kod_zayav_virt" as="a" />
        </query>
        <query name="vc_user_login" as="b" join="left outer">
          <call function="or">
            <call function="=">
              <column table="a" column="phone_clear" />
              <column table="b" column="phone_clear" />
            </call>
            <call function="=">
              <call function="lower">
                <column table="a" column="e_mail" />
              </call>
              <call function="lower">
                <column table="b" column="user_email" />
              </call>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="x" column="num_zayav" />
            <useparam name="num_zayav" />
          </call>
        </call>
      </where>
    </query>
    <query name="vc_ul_def_info" timestamp="22.01.2019 19:54:48" class="1" update-target="vc_ul_kontakt" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\query.xml">
      <params>
        <param name="kod_kontakt" type="number">
          <const>3000261</const>
        </param>
        <param name="num_zayav" type="string">
          <const>'17-35759'</const>
        </param>
      </params>
      <select>
        <call function="nvl" as="phone" type="string">
          <column table="k" column="phone_clear" />
          <column table="vv" column="phone_clear" />
        </call>
        <call function="nvl" as="email" type="string">
          <column table="k" column="e_mail" />
          <column table="vv" column="e_mail" />
        </call>
        <call function="nvl" as="f" type="string">
          <column table="k" column="f" />
          <column table="vv" column="f" />
        </call>
        <call function="nvl" as="i" type="string">
          <column table="k" column="i" />
          <column table="vv" column="i" />
        </call>
        <call function="nvl" as="o" type="string">
          <column table="k" column="o" />
          <column table="vv" column="o" />
        </call>
        <column table="k" column="send_prior_nvl" />
        <call function="if" as="user_right" type="number">
          <call function="=">
            <call function="user_rights_kod_menu">
              <const type="number">13065</const>
            </call>
            <const type="number">2</const>
          </call>
          <const>1</const>
          <const type="number">0</const>
        </call>
      </select>
      <from>
        <query name="dual" as="d" />
        <query name="vc_num_z_vo" as="a" join="left outer">
          <link name="kod_zayav_virt" as="vv" />
          <call function="and">
            <call type="" function="or">
              <call function="false" />
              <call function="=" as="" type="" optional="1">
                <column table="a" column="num_zayav" />
                <useparam name="num_zayav" />
              </call>
            </call>
            <call function="is not null">
              <column table="a" column="kod_zayav_virt" />
            </call>
          </call>
        </query>
        <query name="is_kontact" as="k" join="left outer">
          <call type="" function="or">
            <call function="false" />
            <call function="=" as="" type="" optional="1">
              <column table="k" column="kod_kontact" />
              <useparam name="kod_kontakt" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_user_login_by_user_id" timestamp="15.10.2018 20:33:15" inherit="vcs_user_login" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="user_id" type="number">
          <const>2</const>
        </param>
      </params>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_petition_by_num" timestamp="15.12.2018 03:08:59" inherit="vcs_petition" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="petition_num" type="string">
          <const>2</const>
        </param>
      </params>
      <where>
        <call function="=">
          <column table="a" column="num_reg" />
          <useparam name="petition_num" />
        </call>
      </where>
    </query>
    <query name="vcs_request_by_user_id" timestamp="26.12.2018 00:45:02" inherit="vcs_request" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="user_id" type="number">
          <const>64</const>
        </param>
      </params>
      <from>
        <query name="vcs_ul_zayav_company" join="left outer" ConstrDelOption="cascade" as="vcs_ul_zayav_company">
          <call function="=">
            <column table="a" column="num_zayav" />
            <column table="vcs_ul_zayav_company" column="num_zayav" />
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_get_login_info_err" timestamp="15.10.2018 20:55:20" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="user_id" type="number">
          <const>2</const>
        </param>
      </params>
      <select>
        <call function="decode" as="value" type="string">
          <column table="a" column="user_id" group="count" />
          <const>0</const>
          <const>'Пользователь отсутствует в системе'</const>
        </call>
      </select>
      <from>
        <query name="vc_user_login" as="a" join="cross" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_get_bing_req_err" timestamp="04.12.2018 05:15:42" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="user_id" type="number">
          <const>174</const>
        </param>
        <param name="request_num" type="string">
          <const>'17-381'</const>
        </param>
        <param name="request_kind" type="number" />
      </params>
      <select>
        <call function="if" type="string" as="value">
          <call function="!=nvl">
            <useparam name="request_kind" />
            <const>1</const>
          </call>
          <call function="nvl" type="string">
            <column table="a" column="value" />
            <column table="b" column="value" />
          </call>
        </call>
      </select>
      <from>
        <query name="vcs_get_login_info_err" as="a" join="cross">
          <withparams>
            <useparam name="user_id" />
          </withparams>
        </query>
        <query name="vcs_num_zayav_err" as="b" join="cross">
          <withparams>
            <useparam name="request_num" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="vcs_num_zayav_err" timestamp="02.11.2018 00:14:29" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="request_num" type="number">
          <const>2</const>
        </param>
      </params>
      <select>
        <call function="decode" as="value" type="string">
          <column table="a" column="found" group="max" />
          <const>1</const>
          <const>''</const>
          <const>'Заявка отсутствует в системе'</const>
        </call>
      </select>
      <from>
        <query name="vc_num_zayav" as="a" join="cross">
          <withparams>
            <useparam name="request_num" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="vcs_check_can_bind" timestamp="04.12.2018 04:46:16" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="user_id" type="number">
          <const>16547</const>
        </param>
        <param name="request_num" type="string">
          <const>'16-40199'</const>
        </param>
      </params>
      <select>
        <call function="if" type="string" as="val">
          <call function="=0">
            <column table="is_kontact" column="kod_kontact" group="count" />
          </call>
          <const>'У пользователя нет доступа к указанной заявке'</const>
        </call>
      </select>
      <from>
        <query name="c_zayav">
          <link name="kod_kontact" as="is_kontact" />
          <link name="kod_zpr" exclude="1">
            <elink name="qr_list_zpr_abons">
              <link name="kodp">
                <elink name="is_kontact" />
              </link>
            </elink>
          </link>
        </query>
        <query name="vc_user_login" join="left outer">
          <call function="=">
            <column table="vc_user_login" column="user_id" />
            <useparam name="user_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="c_zayav" column="num_zayav" />
            <useparam name="request_num" />
          </call>
          <call function="=">
            <call function="cut_phone">
              <column table="is_kontact" column="phone" />
            </call>
            <call function="cut_phone">
              <column table="vc_user_login" column="user_phone" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_get_petition_err" timestamp="17.12.2018 02:20:55" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv.xml">
      <params>
        <param name="petition_num" type="string" />
      </params>
      <select>
        <call function="decode" as="value" type="string">
          <column table="a" column="petition_id" group="count" />
          <const>0</const>
          <const>'Обращение не найдено'</const>
        </call>
      </select>
      <from>
        <query name="vcs_petition" as="a" join="cross" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="petition_num" />
          <useparam name="petition_num" />
        </call>
      </where>
    </query>
    <query name="vcs_user_login" timestamp="11.04.2019 13:41:32" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="user_id" key="1" />
        <column table="a" column="user_password" />
        <column table="a" column="user_email" />
        <column table="a" column="user_phone" />
        <column table="a" column="esia_guid" />
        <column table="a" column="user_registration" />
        <column table="a" column="user_last_login" />
        <column table="a" column="user_snils" />
        <column table="a" column="person_last_name" />
        <column table="a" column="person_first_name" />
        <column table="a" column="person_middle_name" />
        <column table="a" column="user_type" />
        <column table="a" column="pref_communication" />
        <column table="a" column="blocking_date" />
        <column table="a" column="status" />
        <column table="a" column="user_info" />
        <column table="a" column="pr_db" />
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
    </query>
    <query name="vcs_request" timestamp="26.12.2018 01:01:52" title="Заявка привязанная к профилю пользователя" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="user_id" />
        <call function="if" type="number" as="request_id">
          <call function="=0">
            <column table="a" column="request_kind" />
          </call>
          <column table="kod_zayav" column="kod_zayav" />
          <column table="is_lkk_vip_tu" column="kod" />
        </call>
        <column table="a" column="num_zayav" as="request_num" />
        <call function="if" type="number" as="type_of_request" exclude="1">
          <call function="=0">
            <column table="a" column="request_kind" />
          </call>
          <column table="kod_spr_query" column="kod_spr_query" title="Код типа заявки" />
        </call>
        <call function="if" type="number" as="status">
          <call function="=0">
            <column table="a" column="request_kind" />
          </call>
          <call function="qg_state_lkk.f_state_lkk">
            <column table="this" column="num_zayav" />
          </call>
          <column table="is_lkk_vip_tu" column="kod_state_lkk" />
        </call>
        <call function="qg_state_lkk.f_state_lkk" as="status" exclude="1">
          <column table="a" column="num_zayav" />
        </call>
        <call function="if" type="date" as="request_date">
          <call function="=0">
            <column table="a" column="request_kind" />
          </call>
          <call function="nvl" type="date">
            <column table="kod_zayav_virt" column="d_c" />
            <column table="kod_zayav" column="dat_doc" />
          </call>
          <column table="is_lkk_vip_tu" column="dat_vip_tu" />
        </call>
        <call function="if" type="string" as="address">
          <call function="=0">
            <column table="a" column="request_kind" />
          </call>
          <call function="qg_state_lkk.f_get_addr">
            <column table="this" column="num_zayav" />
          </call>
          <column table="kod_dop_contract" column="lp_addr" />
        </call>
        <column table="a" column="request_kind" />
        <call function="nvl" as="company_id" type="number">
          <column table="kod_zayav" column="kodp" />
          <column table="kod_zayav_virt" column="kodp" />
        </call>
        <column as="counteragent_id" column="id" table="vcs_ul_zayav_company" />
      </select>
      <from>
        <query name="vc_ul_zayav" as="a">
          <link name="vc_num_z_vo">
            <link name="kod_zayav">
              <link name="kod_spr_query" />
            </link>
            <link name="kod_zayav_virt" />
          </link>
          <link name="is_lkk_vip_tu">
            <link name="kod_dop_contract" />
          </link>
        </query>
        <query ConstrDelOption="cascade" as="vcs_ul_zayav_company" join="left outer" name="vcs_ul_zayav_company">
          <call function="and">
            <call function="=">
              <column column="num_zayav" table="a" />
              <column column="num_zayav" table="vcs_ul_zayav_company" />
            </call>
            <call function="=">
              <column column="user_id" table="a" />
              <column column="user_id" table="vcs_ul_zayav_company" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_user_login_tmp" timestamp="11.04.2019 14:04:00" stored="vcs_user_login_tmp" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <call function="()" type="number" as="tmp_user_id" key="1" />
        <column table="a" column="*" exclude="1" />
        <column table="a" column="user_id" />
        <column table="a" column="user_password" />
        <column table="a" column="user_email" />
        <column table="a" column="user_phone" />
        <column table="a" column="esia_guid" />
        <column table="a" column="user_registration" />
        <column table="a" column="user_last_login" />
        <column table="a" column="user_snils" />
        <column table="a" column="person_last_name" />
        <column table="a" column="person_first_name" />
        <column table="a" column="person_middle_name" />
        <column table="a" column="user_type" />
        <column table="a" column="pref_communication" />
        <column table="a" column="blocking_date" />
        <column table="a" column="status" />
        <column table="a" column="user_info" />
      </select>
      <from>
        <query name="vcs_user_login" as="a" />
        <query name="vc_user_login" as="user_id" join="left outer">
          <call function="=">
            <column table="this" column="user_id" />
            <column table="user_id" column="user_id" />
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_request_tmp" timestamp="04.12.2018 04:58:52" stored="vcs_request_tmp" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <call function="()" type="number" as="tmp_request_id" key="1" />
        <call function="()" type="number" as="tmp_user_id" />
        <column table="a" column="*" />
      </select>
      <from>
        <query name="vcs_request" as="a" />
        <query name="vcs_user_login_tmp" join="left outer">
          <call function="=">
            <column table="this" column="tmp_user_id" />
            <column table="vcs_user_login_tmp" column="tmp_user_id" />
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_user_login_upd" timestamp="14.11.2018 16:51:46" use-repository="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="vcs_user_login_tmp" as="a" />
      </from>
    </query>
    <query name="vcs_request_upd" timestamp="04.12.2018 04:35:59" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="vcs_user_login_tmp" column="tmp_user_id" />
        <column table="vc_ul_zayav" column="kod_ul_zayav" />
        <column table="vcs_user_login_tmp" column="user_id" />
        <column table="a" column="request_num" as="num_zayav" />
        <column table="a" column="request_kind" />
      </select>
      <from>
        <query name="vcs_request_tmp" as="a">
          <link name="vcs_user_login_tmp" />
        </query>
        <query name="vc_ul_zayav" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="request_num" />
              <column table="vc_ul_zayav" column="num_zayav" />
            </call>
            <call function="=">
              <column table="vc_ul_zayav" column="user_id" />
              <column table="vcs_user_login_tmp" column="user_id" />
            </call>
          </call>
        </query>
        <query name="c_zayav" join="left outer">
          <call function="=">
            <column table="a" column="request_num" />
            <column table="c_zayav" column="num_zayav" />
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_user_login_upd_min" timestamp="17.10.2018 00:39:37" use-repository="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="tmp_user_id" />
        <column table="a" column="user_id" />
      </select>
      <from>
        <query name="vcs_user_login_tmp" as="a" />
      </from>
    </query>
    <query name="vcs_is_request_exists" timestamp="13.11.2018 12:29:45" is-report="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param name="request_num" type="string">
          <const>'16-3461asd9'</const>
        </param>
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="is not null">
            <column table="a" column="kod_zayav" group="max" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="c_zayav" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="num_zayav" />
          <useparam name="request_num" />
        </call>
      </where>
    </query>
    <query name="vcs_get_new_login_list" timestamp="17.10.2018 19:35:06" is-report="1" multi-select="1" title="Запрос списка логинов пользователей на создание в ЛКК" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="user_id" />
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="status" />
          <const>2</const>
        </call>
      </where>
    </query>
    <query name="vcs_confirm_new_login" timestamp="17.10.2018 20:18:43" is-report="1" use-temp="1" update-target="vc_user_login" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id" />
      </params>
      <select>
        <column table="a" column="user_id" />
        <call function="()" type="number" as="status">
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_get_all_login_list" timestamp="12.11.2018 20:10:03" is-report="1" multi-select="1" title="Запрос списка всех логинов пользователей" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="user_id" />
        <column table="a" column="user_email" />
        <column table="a" column="user_phone" />
        <column table="a" column="status" />
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
    </query>
    <query name="vcs_user_login_delete" timestamp="12.11.2018 20:46:52" is-report="1" multi-select="1" title="Удаление пользователя ЛКК" update-target="vc_user_login" use-temp="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param name="user_id" type="number" />
      </params>
      <select>
        <column table="a" column="user_id" />
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_get_user_id" timestamp="04.12.2018 19:38:24" is-report="1" multi-select="1" title="Получение ID пользователя по email или телефону" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="string" name="login" />
      </params>
      <select>
        <column table="a" column="user_id" />
      </select>
      <from>
        <query name="vc_user_login" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="=">
            <call function="cut_num">
              <column table="a" column="user_phone" />
            </call>
            <call function="cut_num">
              <useparam name="login" />
            </call>
          </call>
          <call function="=">
            <call function="lower">
              <column table="a" column="user_email" />
            </call>
            <call function="lower">
              <useparam name="login" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_petition" timestamp="06.02.2019 13:35:50" title="Жалоба / обращение" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="kod" as="petition_id" />
        <column table="a" column="lkk_num_zayav" as="req_num" />
        <column table="a" column="user_id" />
        <column table="a" column="e_mail" as="user_email" />
        <column table="a" column="str_name" as="person_name" />
        <column table="a" column="phone" />
        <column table="a" column="lkk_petition_type" as="petition_type" />
        <column table="a" column="cause" as="text" />
        <column table="a" column="str_adr" as="address_text" />
        <column table="a" column="prior_send" as="answer_type" />
        <column table="a" column="num_reg" as="petition_num" />
        <column table="a" column="lkk_theme_id" as="theme_id" />
        <column table="a" column="kod_type_source_lkk" as="petition_source" />
        <column table="a" column="str_message" as="answer_text" />
        <column table="a" column="kod_dop_doc_out" as="answer_file_id" />
        <column table="kod_dop_doc_out" column="doc_file_name" as="answer_file_name" />
        <column table="a" column="status" />
      </select>
      <from>
        <query name="is_complaints" as="a">
          <link name="kod_dop_doc_out" />
        </query>
      </from>
    </query>
    <query name="vcs_petition_tmp" timestamp="16.12.2018 02:14:39" stored="vcs_petition_tmp" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <call function="()" type="number" as="tmp_petition_id" key="1" />
        <column table="a" column="*" />
      </select>
      <from>
        <query as="a" name="vcs_petition" />
      </from>
    </query>
    <query name="vcs_get_petition_list" timestamp="14.01.2019 14:24:50" is-report="1" multi-select="1" title="Получение списка поданных обращений" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id" />
      </params>
      <select>
        <column table="a" column="num_reg" as="petition_num" />
      </select>
      <from>
        <query name="is_complaints" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="user_id" />
          <useparam name="user_id" />
        </call>
      </where>
    </query>
    <query name="vcs_petition_attachment" timestamp="24.12.2018 16:07:23" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <select>
        <column table="a" column="kod_compl" as="petition_id" />
        <column table="a" column="kod_dop_doc" as="file_id" />
        <column table="a" column="doc_file_name_old" as="file_name" />
        <column table="a" column="num_doc" as="attachment_num" />
        <column table="a" column="dat_doc" as="attachment_date" />
      </select>
      <from>
        <query name="c_dop_doc" as="a">
          <link name="kod_compl" />
        </query>
      </from>
      <where>
        <call function="=1">
          <column table="a" column="pr_lkk" />
        </call>
      </where>
    </query>
    <query name="vcs_get_company_list" timestamp="25.12.2018 21:02:29" is-report="1" multi-select="1" title="Получение списка контрагентов" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id">
          <const>64</const>
        </param>
      </params>
      <select>
        <column table="b" column="e_code" as="company_id" />
        <column table="b" column="tip" />
        <column table="b" column="name" as="short_name" />
        <column table="b" column="name_all" as="full_name" />
        <column table="b" column="adr_text" as="address" title="address" />
        <column table="b" column="adr_post" as="post_address" />
        <call as="ogrn" type="" function="()">
          <column table="b" column="ogrn" as="" type="" />
        </call>
        <call function="()" type="date" as="date_reg">
          <const>null</const>
        </call>
        <call as="passport_series" type="string" function="()">
          <column table="b" column="pasp_series" as="" type="" />
        </call>
        <call as="passport_number" type="string" function="()">
          <column table="b" column="pasp_num" as="" type="" />
        </call>
        <call as="passport_issued_from" type="string" function="()">
          <column table="b" column="pasp_issued" as="" type="" />
        </call>
        <call as="passport_issue_date" type="date" function="()">
          <column table="b" column="dat_pasp" as="" type="" />
        </call>
        <call as="inn" type="" function="()">
          <column table="b" column="inn" as="" type="" />
        </call>
        <call as="name_last" type="string" function="if">
          <call function="=1">
            <column table="b" column="tip" />
          </call>
          <column table="b" column="f" as="" type="" />
        </call>
        <call as="name_first" type="string" function="if">
          <call function="=1">
            <column table="b" column="tip" />
          </call>
          <column table="b" column="i" as="" type="" />
        </call>
        <call as="name_second" type="string" function="if">
          <call function="=1">
            <column table="b" column="tip" />
          </call>
          <column table="b" column="o" as="" type="" />
        </call>
        <call as="phone" type="" function="()">
          <column table="b" column="phone" as="" type="" />
        </call>
        <call as="email" type="" function="()">
          <column table="b" column="e_mail" as="" type="" />
        </call>
      </select>
      <from>
        <query name="vcs_get_company_list_pre" as="a">
          <withparams>
            <useparam name="user_id" />
          </withparams>
        </query>
        <query name="is_creditors" join="left outer" as="b">
          <call function="=">
            <column table="a" column="kodp" />
            <column table="b" column="e_code" />
          </call>
        </query>
      </from>
    </query>
    <query name="vcs_get_company_list_pre" timestamp="19.12.2018 21:43:05" title="Получение списка контрагентов" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id" />
      </params>
      <select>
        <call function="nvl" as="kodp" group="1" type="number">
          <column table="kod_zayav" column="kodp" />
          <column table="kod_zayav_virt" column="kodp" />
        </call>
      </select>
      <from>
        <query name="vc_user_login" as="a">
          <elink name="vc_ul_zayav">
            <link name="kod_zayav" />
            <link name="kod_zayav_virt" />
          </elink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="user_id" />
            <useparam name="user_id" />
          </call>
          <call function="is not null">
            <column table="this" column="kodp" group="no" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_ul_zayav_company" timestamp="26.12.2018 00:59:11" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params exclude="1">
        <param type="number" name="user_id" />
      </params>
      <select>
        <column table="a" column="user_id" group="1" />
        <call function="case" as="id" type="string">
          <call function="when">
            <call function="is not null">
              <column table="this" column="kodp" />
            </call>
            <call function="||">
              <const>'A'</const>
              <column table="this" column="kodp" />
            </call>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="this" column="kod_lkk_zayavitel" />
            </call>
            <call function="||">
              <const>'B'</const>
              <column table="this" column="kod_lkk_zayavitel" />
            </call>
          </call>
        </call>
        <column table="vc_ul_zayav" column="num_zayav" group="1" />
        <call function="coalesce" as="kodp" type="number" group="max">
          <column table="kod_zayav" column="kodp" />
          <column table="kod_zayav_virt" column="kodp" />
          <column table="kod_dop_contract" column="kn_customer" />
        </call>
        <call function="if" as="kod_lkk_zayavitel" type="number">
          <call function="is null">
            <column table="this" column="kodp" />
          </call>
          <call function="coalesce" type="number" group="max">
            <column table="is_lkk_vo_zayavitel" column="kod_zayavitel" />
            <column table="is_lkk_vip_tu" column="kod_counteragent" />
          </call>
        </call>
      </select>
      <from>
        <query name="vc_user_login" as="a">
          <elink name="vc_ul_zayav">
            <link name="kod_zayav" />
            <link name="kod_zayav_virt">
              <elink name="is_lkk_vo_zayavitel" />
            </link>
            <link name="is_lkk_vip_tu">
              <link name="kod_counteragent" />
              <link name="kod_dop_contract" />
            </link>
          </elink>
        </query>
        <query name="is_creditors" join="left outer" as="kodp">
          <call function="=">
            <column table="this" column="kodp" />
            <column table="kodp" column="e_code" />
          </call>
        </query>
        <query name="is_lkk_zayavitel" join="left outer" as="kod_lkk_zayavitel">
          <call function="=">
            <column table="this" column="kod_lkk_zayavitel" />
            <column table="kod_lkk_zayavitel" column="kod" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1" exclude="1">
            <column table="a" column="user_id" />
            <useparam name="user_id" />
          </call>
          <call function="is not null" exclude="1">
            <column table="this" column="kodp" group="no" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_get_counteragent_list" timestamp="07.02.2019 18:03:17" is-report="1" multi-select="1" title="Получение списка контрагентов" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id">
          <const>64</const>
        </param>
      </params>
      <select>
        <column table="a" column="id" as="counteragent_id" group="1" />
        <call as="counteragent_type" type="number" function="coalesce" group="max">
          <column table="b" column="tip" as="" type="">
            <item />
          </column>
          <column table="z" column="tip" />
        </call>
        <call as="short_name" type="string" function="coalesce" group="max">
          <column table="b" column="name" as="" type="">
            <item />
          </column>
          <column table="z" column="shorttitle" />
        </call>
        <call as="full_name" type="string" function="coalesce" group="max">
          <column table="b" column="name_all" as="" type="">
            <item />
          </column>
          <column table="z" column="title" />
        </call>
        <call as="address" type="string" title="address" function="coalesce" group="max">
          <column table="b" column="adr_text" as="" type="">
            <item />
          </column>
          <column table="z" column="adr_reg" />
        </call>
        <call as="post_address" type="string" function="coalesce" group="max">
          <column table="b" column="adr_post" as="" type="">
            <item />
          </column>
          <column table="z" column="adr_post" />
        </call>
        <call as="ogrn" type="string" function="coalesce" group="max">
          <column table="b" column="ogrn" as="" type="" />
          <column table="z" column="num_egrul" />
        </call>
        <call function="coalesce" type="date" as="date_reg" group="max">
          <const>null</const>
          <column table="z" column="dat_egrul" />
        </call>
        <call as="passport_series" type="string" function="coalesce" group="max">
          <column table="b" column="pasp_series" as="" type="" />
          <column table="z" column="ser_passp" />
        </call>
        <call as="passport_number" type="string" function="coalesce" group="max">
          <column table="b" column="pasp_num" as="" type="" />
          <column table="z" column="num_passp" />
        </call>
        <call as="passport_issued_from" type="string" function="coalesce" group="max">
          <column table="b" column="pasp_issued" as="" type="" />
          <column table="z" column="kem_passp" />
        </call>
        <call as="passport_issue_date" type="date" function="coalesce" group="max">
          <column table="b" column="dat_pasp" as="" type="" />
          <column table="z" column="dat_passp" />
        </call>
        <call as="inn" type="" function="coalesce" group="max">
          <column table="b" column="inn" as="" type="" />
          <column table="z" column="inn" />
        </call>
        <call as="name_last" type="string" function="coalesce" group="max">
          <column table="z" column="namelast" />
          <call type="" function="if">
            <call function="=1">
              <column table="this" column="counteragent_type" group="no" />
            </call>
            <column table="b" column="f" as="" type="" />
          </call>
        </call>
        <call as="name_first" type="string" function="coalesce" group="max">
          <column table="z" column="namefirst" />
          <call type="" function="if">
            <call function="=1">
              <column table="this" column="counteragent_type" group="no" />
            </call>
            <column table="b" column="i" as="" type="" />
          </call>
        </call>
        <call as="name_second" type="string" function="coalesce" group="max">
          <column table="z" column="namesecond" />
          <call type="" function="if">
            <call function="=1">
              <column table="this" column="counteragent_type" group="no" />
            </call>
            <column table="b" column="o" as="" type="" />
          </call>
        </call>
        <call as="phone" type="string" function="coalesce" group="max">
          <column table="b" column="phone" as="" type="" />
          <column table="z" column="phone" />
        </call>
        <call as="email" type="string" function="coalesce" group="max">
          <column table="b" column="e_mail" as="" type="" />
          <column table="z" column="e_mail" />
        </call>
      </select>
      <from>
        <query name="vcs_ul_zayav_company" as="a">
          <link name="kodp" as="b" />
          <link name="kod_lkk_zayavitel" as="z" />
          <withparams>
            <useparam name="user_id" />
          </withparams>
        </query>
      </from>
      <where>
        <call type="" function="and">
          <call function="=" as="" type="">
            <column table="a" column="user_id" />
            <useparam name="user_id" />
          </call>
          <call function="is not null" as="" type="">
            <column table="a" column="id" />
          </call>
        </call>
      </where>
    </query>
    <query name="vcs_ul_zayav_company_test" timestamp="07.02.2019 16:06:54" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param type="number" name="user_id">
          <const>16729</const>
        </param>
      </params>
      <select>
        <column table="a" column="user_id" group="1" />
        <call function="case" as="id" type="string">
          <call function="when">
            <call function="is not null">
              <column table="this" column="kodp" />
            </call>
            <call function="||">
              <const>'A'</const>
              <column table="this" column="kodp" />
            </call>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="this" column="kod_lkk_zayavitel" />
            </call>
            <call function="||">
              <const>'B'</const>
              <column table="this" column="kod_lkk_zayavitel" />
            </call>
          </call>
        </call>
        <column table="vc_ul_zayav" column="num_zayav" group="1" />
        <call function="coalesce" as="kodp" type="number" group="max">
          <column table="kod_zayav" column="kodp" />
          <column table="kod_zayav_virt" column="kodp" />
          <column table="kod_dop_contract" column="kn_customer" />
        </call>
        <call function="if" as="kod_lkk_zayavitel" type="number">
          <call function="is null">
            <column table="this" column="kodp" />
          </call>
          <call function="coalesce" type="number" group="max">
            <column table="is_lkk_vo_zayavitel" column="kod_zayavitel" />
            <column table="is_lkk_vip_tu" column="kod_counteragent" />
          </call>
        </call>
        <column table="kod_zayav_virt" column="kod" group="max" />
        <column table="is_lkk_vo_zayavitel" column="kod_zayavitel" group="max" />
      </select>
      <from>
        <query name="vc_user_login" as="a">
          <elink name="vc_ul_zayav">
            <link name="kod_zayav" />
            <link name="kod_zayav_virt">
              <elink name="is_lkk_vo_zayavitel" />
            </link>
            <link name="is_lkk_vip_tu">
              <link name="kod_counteragent" />
              <link name="kod_dop_contract" />
            </link>
          </elink>
        </query>
        <query name="is_creditors" join="left outer" as="kodp">
          <call function="=">
            <column table="this" column="kodp" />
            <column table="kodp" column="e_code" />
          </call>
        </query>
        <query name="is_lkk_zayavitel" join="left outer" as="kod_lkk_zayavitel">
          <call function="=">
            <column table="this" column="kod_lkk_zayavitel" />
            <column table="kod_lkk_zayavitel" column="kod" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1">
            <column table="a" column="user_id" />
            <useparam name="user_id" />
          </call>
          <call function="is not null" exclude="1">
            <column table="this" column="kodp" group="no" />
          </call>
        </call>
      </where>
    </query>
    <query name="c_zayav_for_ul" timestamp="30.10.2018 15:48:19" class="1" inherit="c_zayav" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\c_zayav.xml">
      <select />
      <from />
      <links />
    </query>
    <query name="vc_ul_creditors" timestamp="10.10.2018 22:09:47" class="1" title="Связь пользователей ЛК с контрагентами" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_creditors.xml">
      <select>
        <column table="a" type="number" comment="Уникальный идентификатор" title="Уникальный идентификатор" data-size="" key="1" column="kod_ul_creditors" />
        <column comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" data-size="1" table="a" type="number" column="e_code" />
        <column column="user_id" comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" data-size="1" table="a" type="number" />
        <column table="a" column="u_m" type="string" title="" data-size="30" />
        <column table="a" column="d_m" type="date" title="" />
      </select>
      <from>
        <table name="vc_ul_creditors" as="a" />
        <query name="vc_user_login" join="left outer" as="user_id">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="user_id" />
          </call>
        </query>
        <query name="is_creditors" as="e_code" join="left outer">
          <call function="=">
            <column table="a" column="e_code" />
            <column table="e_code" column="e_code" />
          </call>
        </query>
      </from>
    </query>
    <query name="vc_ul_izmen" timestamp="19.11.2018 16:05:17" class="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_izmen.xml">
      <select>
        <column table="a" type="number" comment="Уникальный идентификатор" data-size="" key="1" column="kod_ul_izmen" />
        <column table="a" column="user_id" type="number" />
        <column table="a" column="kod_kontact" type="number" />
        <column table="a" column="field" type="string" data-size="300" title="Поле" />
        <column table="a" type="string" column="old_val" data-size="300" title="Старое значение" />
        <column table="a" type="string" column="new_val" data-size="300" title="Новое значение" />
        <column table="a" column="u_m" type="string" title="Пользователь" data-size="30" />
        <column table="a" column="d_m" type="date" controlType="UIDateTime" title="Дата изменения" is-fact="1" agg="max" />
        <column table="vc_ul_kontakt" column="kod_ul_kontakt" />
      </select>
      <from>
        <table name="vc_ul_izmen" as="a" />
        <query name="vc_user_login" join="left outer" as="user_id" ConstrDelOption="cascade">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="user_id" />
          </call>
        </query>
        <query name="is_kontact" as="kod_kontact" join="left outer" ConstrDelOption="cascade" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="kod_kontact" />
            <column table="kod_kontact" column="kod_kontact" />
          </call>
        </query>
        <query name="vc_ul_kontakt" as="vc_ul_kontakt" join="left outer" ConstrDelOption="cascade">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_kontact" />
              <column table="vc_ul_kontakt" column="kod_kontact" />
            </call>
            <call function="=">
              <column table="a" column="user_id" />
              <column table="vc_ul_kontakt" column="user_id" />
            </call>
          </call>
        </query>
        <query name="vc_ul_kontakt" as="kod_ul_kontakt" join="left outer" ConstrDelOption="cascade" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="kod_ul_kontakt" />
            <column table="kod_ul_kontakt" column="kod_ul_kontakt" />
          </call>
        </query>
      </from>
    </query>
    <query name="vc_ul_kontakt" timestamp="10.12.2018 21:44:58" class="1" title="Связь пользователей ЛК с контактами КИДО" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_kontakt.xml">
      <select>
        <column table="a" type="number" comment="Уникальный идентификатор" title="Уникальный идентификатор" data-size="" key="1" column="kod_ul_kontakt" />
        <column column="kod_kontact" comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" data-size="1" table="a" type="number">
          <listquery>
            <query name="is_kontact_list" />
          </listquery>
        </column>
        <column column="user_id" comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" data-size="1" table="a" type="number" />
        <column table="a" column="u_m" type="string" title="" data-size="30" />
        <column table="a" column="d_m" type="date" title="" />
      </select>
      <from>
        <table name="vc_ul_kontakt" as="a" table-code="i151" />
        <query name="vc_user_login" join="left outer" as="user_id" ConstrDelOption="cascade">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="user_id" />
          </call>
        </query>
        <query name="vc_user_login_by_k" join="left outer" as="vc_user_login_by_k" ConstrDelOption="cascade" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="vc_user_login_by_k" />
          </call>
        </query>
        <query name="is_kontact" as="kod_kontact" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="a" column="kod_kontact" />
            <column table="kod_kontact" column="kod_kontact" />
          </call>
        </query>
      </from>
      <links>
        <link name="kod_kontact" is-private-dimension="1" is-final-dimension="1" dimension="1" />
      </links>
    </query>
    <query name="vc_ul_pref_com_data" timestamp="10.10.2018 19:20:04" class="1" title="Предпочитаемый способ связи" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_pref_com.xml">
      <const as="id" type="number">0</const>
      <const as="name" type="string">'E-mail'</const>
      <const>1</const>
      <const>'Телефон'</const>
    </query>
    <query name="vc_ul_pref_com" timestamp="10.10.2018 19:22:45" class="1" title="Предпочитаемый способ связи" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_pref_com.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="Предпочитаемый способ связи" />
      </select>
      <from>
        <query name="vc_ul_pref_com_data" as="a" />
      </from>
    </query>
    <query name="vc_ul_status_data" timestamp="04.12.2018 20:40:29" class="1" title="Статус" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_status.xml">
      <const as="id" type="number">0</const>
      <const as="name" type="string">'Активный'</const>
      <const>1</const>
      <const>'Удален'</const>
      <const>2</const>
      <const>'Новый'</const>
    </query>
    <query name="vc_ul_status" timestamp="11.10.2018 17:47:59" class="1" title="Статус" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_status.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="Наименование" />
      </select>
      <from>
        <query name="vc_ul_status_data" as="a" />
      </from>
    </query>
    <query name="vc_ul_user_type_data" timestamp="10.10.2018 19:19:59" class="1" title="Тип заявителя по умолчанию" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_user_type.xml">
      <const as="id" type="number">0</const>
      <const as="name" type="string">'Физическое лицо'</const>
      <const>1</const>
      <const>'Юридическое лицо'</const>
      <const>2</const>
      <const>'Индивидуальный предприниматель'</const>
    </query>
    <query name="vc_ul_user_type" timestamp="10.10.2018 19:23:03" class="1" title="Тип заявителя по умолчанию" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_user_type.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="Тип заявителя по умолчанию" />
      </select>
      <from>
        <query name="vc_ul_user_type_data" as="a" />
      </from>
    </query>
    <query name="vc_ul_zayav" timestamp="25.12.2018 21:43:12" class="1" title="Связь пользователей ЛК с заявками КИДО" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_ul_zayav.xml">
      <select>
        <column table="a" type="number" comment="Уникальный идентификатор" data-size="" key="1" column="kod_ul_zayav" />
        <column column="kod_zayav" comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" data-size="1" table="a" type="number" exclude="1" />
        <column column="user_id" data-size="1" table="a" type="number" />
        <column column="request_kind" data-size="1" table="a" type="number" comment=" 0-заявка/ВО 1-УВТУ" />
        <column table="a" column="u_m" type="string" title="" data-size="30" />
        <column table="a" column="d_m" type="date" title="" />
        <column table="c_zayav" column="num_zayav" title="Номер заявки" as="num_z" />
        <column table="c_zayav" column="kod_zayav" />
        <column table="c_zayav_virtual" column="kod" as="kod_zayav_virt" />
        <column column="num_zayav" data-size="30" table="a" type="string" index="1" title="Номер заявки/ВО" />
        <column table="c_zayav_virtual" column="num_zayav_vo" title="Номер ВО" />
        <call function="()" as="cnt" type="number" is-fact="1" agg="sum">
          <const>1</const>
        </call>
        <call type="string" function="coalesce" title="Наименование контрагента" as="name_org">
          <column table="kodp" column="name" />
          <column table="kodp_v" column="name" />
          <column table="c_zayav_virtual" column="name_org" />
        </call>
      </select>
      <from>
        <table name="vc_ul_zayav" as="a" table-code="i150" />
        <query name="vc_user_login" join="left outer" as="user_id" ConstrDelOption="cascade">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="user_id" />
          </call>
        </query>
        <query name="vc_user_login_by_z" join="left outer" as="vc_user_login_by_z">
          <call function="=">
            <column table="a" column="user_id" />
            <column column="user_id" table="vc_user_login_by_z" />
          </call>
        </query>
        <query name="c_zayav" join="left outer" ConstrDelOption="cascade" dname="vc_ul_zayav_pre">
          <call function="=">
            <column table="a" column="num_zayav" />
            <column table="c_zayav" column="num_zayav" />
          </call>
        </query>
        <query name="c_zayav_virtual" join="left outer" ConstrDelOption="cascade" dname="vc_ul_zayav_pre">
          <call function="=">
            <call function="||">
              <const>'ВО '</const>
              <column table="a" column="num_zayav" />
            </call>
            <column table="c_zayav_virtual" column="num_zayav_vo" />
          </call>
        </query>
        <query name="c_zayav" as="kod_zayav" join="left outer" ConstrDelOption="cascade" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="kod_zayav" />
            <column table="kod_zayav" column="kod_zayav" />
          </call>
        </query>
        <query name="c_zayav_virtual" as="kod_zayav_virt" join="left outer" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="kod_zayav_virt" />
            <column table="kod_zayav_virt" column="kod" />
          </call>
        </query>
        <query name="vc_num_z_vo" join="left outer" ConstrDelOption="cascade" as="vc_num_z_vo">
          <call function="=">
            <column table="a" column="num_zayav" />
            <column table="vc_num_z_vo" column="num_zayav" />
          </call>
        </query>
        <query name="is_lkk_vip_tu" join="left outer" ConstrDelOption="cascade" as="is_lkk_vip_tu">
          <call function="=">
            <column table="a" column="num_zayav" />
            <column table="is_lkk_vip_tu" column="number_vip_tu" />
          </call>
        </query>
      </from>
      <links>
        <link name="vc_user_login_by_z" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        <link name="user_id" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        <link name="c_zayav">
          <link name="kodp" />
        </link>
        <link name="c_zayav_virtual">
          <link name="kodp" as="kodp_v" />
        </link>
      </links>
    </query>
    <query name="vc_user_login" timestamp="11.04.2019 14:21:45" class="1" title="Пользователь личного кабинета" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_user_login.xml">
      <select>
        <column table="a" column="user_id" type="number" comment="Уникальный идентификатор" title="Уникальный идентификатор" data-size="" key="1" is-fact="1" agg="max" />
        <column table="a" column="user_password" type="string" comment="Пароль пользователя (в зашифрованном виде)" title="Пароль пользователя (в зашифрованном виде)" data-size="300" />
        <column table="a" column="user_email" type="string" title="E-mail" data-size="300" column-mandatory="1" valid="mail_error" editable="is_new_user" />
        <column table="a" column="user_phone" type="string" comment="Мобильный телефон" title="Мобильный телефон" data-size="300" column-mandatory="1" format="s+0 (000) 000-00-00" valid="phone_error" editable="is_new_user" />
        <column table="a" column="esia_guid" type="string" comment="Идентификатор ЕСИА " title="Идентификатор ЕСИА " data-size="300" editable="is_new_user" />
        <column table="a" column="user_registration" type="date" comment="Дата/время регистрации в системе" title="Дата/время регистрации в системе" data-size="" column-editable="0" column-default="cur-date" controlType="UIDateTime" fact="vc_user_login_reg" agg="min" />
        <column table="a" column="user_last_login" type="date" comment="Дата/время последнего входа в систему" title="Дата/время последнего входа в систему" data-size="" column-editable="0" />
        <column table="a" column="user_snils" type="string" comment="СНИЛС" title="СНИЛС" data-size="300" editable="is_new_user" />
        <column table="a" column="person_last_name" type="string" comment="Фамилия" title="Фамилия" data-size="300" column-mandatory="1" editable="is_new_user" />
        <column table="a" column="person_first_name" type="string" comment="Имя" title="Имя" data-size="300" column-mandatory="1" editable="is_new_user" />
        <column table="a" column="person_middle_name" type="string" comment="Отчество" title="Отчество" data-size="300" editable="is_new_user" />
        <column table="a" column="user_type" type="number" comment="Тип заявителя по умолчанию (ФЛ=0,ЮЛ=1,ИП=2)" title="Тип заявителя по умолчанию" data-size="1" />
        <column table="a" column="pref_communication" type="number" comment="Предпочитаемый способ связи 0=E-mail, 1=телефон" title="Предпочитаемый способ связи" data-size="1" column-mandatory="1" editable="is_new_user" />
        <column table="a" column="blocking_date" type="date" comment="Дата блокировки. Если задана- доступ пользователю запрещен" title="Дата блокировки" data-size="" />
        <column table="a" column="status" type="number" comment="Статус: 0 – активный; 1- удален; 2- новый (еще не создан в ЛКК)" title="Статус" data-size="1" new-val="def_state" column-mandatory="1" />
        <column table="a" column="user_info" type="clob" title="Информация" column-editable="0" />
        <call type="number" function="()" as="def_state">
          <const>2</const>
        </call>
        <column table="a" column="u_m" type="string" title="" data-size="30" />
        <column table="a" column="d_m" type="date" title="" />
        <call function="()" type="string" as="dub_mail_error">
          <query>
            <select>
              <call function="decode">
                <column table="b" column="user_id" group="count" />
                <const>0</const>
                <const>''</const>
                <const>'Такой E-mail уже используется'</const>
              </call>
            </select>
            <from>
              <query name="vc_user_login" as="b" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="b" column="user_email" />
                  <column table="a" column="user_email" />
                </call>
                <call function="!=">
                  <column table="a" column="user_id" />
                  <column table="b" column="user_id" />
                </call>
              </call>
            </where>
          </query>
        </call>
        <call function="()" type="string" as="dub_phone_error">
          <query>
            <select>
              <call function="decode">
                <column table="b" column="user_id" group="count" />
                <const>0</const>
                <const>''</const>
                <const>'Такой телефон уже используется'</const>
              </call>
            </select>
            <from>
              <query name="vc_user_login" as="b" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="b" column="user_phone" />
                  <column table="a" column="user_phone" />
                </call>
                <call function="!=">
                  <column table="a" column="user_id" />
                  <column table="b" column="user_id" />
                </call>
              </call>
            </where>
          </query>
        </call>
        <call function="||" title="ФИО" as="fio">
          <column table="this" column="person_last_name" />
          <const>' '</const>
          <column table="this" column="person_first_name" />
          <const>' '</const>
          <column table="this" column="person_middle_name" />
        </call>
        <call function="if" type="string" as="mail_format_error">
          <call function="not">
            <call function="is_email_valid">
              <column table="this" column="user_email" />
            </call>
          </call>
          <const>'Некорректный e-mail'</const>
        </call>
        <call function="coalesce" as="mail_error" type="string">
          <column table="this" column="mail_format_error" />
          <column table="this" column="dub_mail_error" />
        </call>
        <call function="if" type="string" as="phone_format_error">
          <call function="!=nvl">
            <call function="length">
              <call function="cut_num">
                <column table="this" column="user_phone" />
              </call>
            </call>
            <const>11</const>
          </call>
          <const>'Некорректный телефон'</const>
        </call>
        <call function="coalesce" as="phone_error" type="string">
          <column table="this" column="phone_format_error" />
          <column table="this" column="dub_phone_error" />
        </call>
        <call function="||" as="vis_id">
          <column table="this" column="user_phone" />
          <const>' '</const>
          <column table="this" column="fio" />
        </call>
        <call function="()" type="number" as="cnt" is-fact="1" agg="sum" fact="vc_user_login_cnt">
          <const>1</const>
        </call>
        <call function="cut_phone" as="phone_clear" title="Телефон">
          <column table="this" column="user_phone" />
        </call>
        <call function="if" type="number" as="is_new_user">
          <call function="=">
            <column table="this" column="status" />
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="nvl0" type="number" as="pr_db" title="Признак DB">
          <query>
            <select>
              <column table="bze" column="pr_db" group="max" />
            </select>
            <from>
              <query name="vc_ul_zayav" as="b">
                <link name="c_zayav" as="bz">
                  <link name="c_zayav_energo" as="bze" />
                </link>
              </query>
            </from>
            <where>
              <call function="=">
                <column table="a" column="user_id" />
                <column table="b" column="user_id" />
              </call>
            </where>
          </query>
        </call>
      </select>
      <from>
        <table name="vc_user_login" as="a" table-code="i149" />
        <query name="vc_ul_status" as="status" join="left outer">
          <call function="=">
            <column table="a" column="status" />
            <column table="status" column="id" />
          </call>
        </query>
        <query name="vc_ul_user_type" as="user_type" join="left outer">
          <call function="=">
            <column table="a" column="user_type" />
            <column table="user_type" column="id" />
          </call>
        </query>
        <query name="vc_ul_pref_com" as="pref_communication" join="left outer">
          <call function="=">
            <column table="a" column="pref_communication" />
            <column table="pref_communication" column="id" />
          </call>
        </query>
      </from>
      <links>
        <dlink name="vc_ul_kontakt" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="is_kontact" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="vc_user_login_by_z" timestamp="11.10.2018 14:15:12" class="1" title="Пользователь личного кабинета" inherit="vc_user_login" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_user_login.xml" />
    <query name="vc_user_login_by_k" timestamp="27.11.2018 18:27:28" class="1" title="Пользователь личного кабинета" inherit="vc_user_login" stored="Связь через контакт в заявке" file="sql.builder.templates\sql.builder\projects\kido_lkk\scheme\original\vc_user_login.xml" />
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id" />
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="vcs_user_login_cls" timestamp="15.10.2018 20:12:55" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_user_login" as="user_login">
          <query name="vcs_request" as="request_list">
            <call function="=">
              <column table="user_login" column="user_id" />
              <column table="request_list" column="user_id" />
            </call>
          </query>
        </query>
      </queries>
    </report>
    <report name="vcs_user_login_input" timestamp="16.10.2018 23:05:09" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_user_login_tmp" as="user_login">
          <query name="vcs_request_tmp" as="request_list">
            <call function="=">
              <column table="user_login" column="tmp_user_id" />
              <column table="request_list" column="tmp_user_id" />
            </call>
          </query>
        </query>
      </queries>
    </report>
    <report name="vcs_get_login_info" timestamp="17.10.2018 17:04:29" title="Запрос данных профиля пользователя " file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param name="user_id" type="number">
          <const>2</const>
        </param>
      </params>
      <queries>
        <query name="vcs_user_login_by_user_id" as="user_info">
          <withparams>
            <useparam name="user_id" />
          </withparams>
          <query name="vcs_request_by_user_id" as="request_list">
            <withparams>
              <useparam name="user_id" />
            </withparams>
            <call function="=">
              <column table="user_info" column="user_id" />
              <column table="request_list" column="user_id" />
            </call>
          </query>
        </query>
        <query name="vcs_get_login_info_err" as="error">
          <withparams>
            <useparam name="user_id" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="vcs_user_login_full_merge" timestamp="14.11.2018 16:59:42" use-repository="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_user_login_upd" update-target="vc_user_login" as="a">
          <query name="vcs_request_upd" as="b" update-target="vc_ul_zayav">
            <call function="=">
              <column table="a" column="tmp_user_id" />
              <column table="b" column="tmp_user_id" />
            </call>
          </query>
        </query>
      </queries>
    </report>
    <report name="vcs_user_login_merge" timestamp="14.11.2018 16:59:59" use-repository="1" use-temp="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_user_login_upd" update-target="vc_user_login" as="a" />
      </queries>
    </report>
    <report name="vcs_user_login_cld_merge" timestamp="17.10.2018 00:29:24" use-repository="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_user_login_upd_min" update-target="vc_user_login" as="a">
          <query name="vcs_request_upd" as="b" update-target="vc_ul_zayav">
            <call function="=">
              <column table="a" column="tmp_user_id" />
              <column table="b" column="tmp_user_id" />
            </call>
          </query>
        </query>
      </queries>
    </report>
    <report name="vcs_bind_request" timestamp="04.12.2018 04:37:04" use-repository="1" use-temp="1" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param name="user_id" type="number" />
        <param name="request_num" type="string" />
        <param name="request_kind" type="number" />
      </params>
      <queries>
        <query name="vcs_ul_zayav_insert" update-target="vc_ul_zayav" as="a">
          <withparams>
            <useparam name="user_id" />
            <useparam name="request_num" />
            <useparam name="request_kind" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="vcs_get_petition" timestamp="17.12.2018 02:23:17" title="Получение информации по обращению" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <params>
        <param name="petition_num" type="string" />
      </params>
      <queries>
        <query name="vcs_petition_by_num" as="petition_info">
          <withparams>
            <useparam name="petition_num" />
          </withparams>
          <query name="vcs_petition_attachment" as="petition_attachments">
            <call function="=">
              <column table="petition_info" column="petition_id" />
              <column table="petition_attachments" column="petition_id" />
            </call>
          </query>
        </query>
        <query name="vcs_get_petition_err" as="error">
          <withparams>
            <useparam name="petition_num" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="vcs_petition_input" timestamp="16.12.2018 01:19:33" file="sql.builder.templates\sql.builder\projects\kido_lkk\other\serv_qry.xml">
      <queries>
        <query name="vcs_petition_tmp" as="petition" />
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="vc_user_login_list" timestamp="04.12.2018 16:10:31" title="Пользователи личного кабинета" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <content>
        <fieldgroup title="Фильтры">
          <usefield name="email" field="cmn_string" title="E-mail" />
          <usefield name="phone" field="cmn_string" title="Телефон" />
        </fieldgroup>
        <grid show-toolbar="1" table="a">
          <toolbar>
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="custom-add-form" action-type="dynamic-form-create" call="vc_user_login" title="Создать" />
          </toolbar>
          <columns>
            <column table="a" column="user_id" column-visible="0" parname="user_id" />
            <column table="a" column="fio" column-width="277" valid="null">
              <buttons>
                <uicommand action-type="dynamic-form" call="vc_user_login" title="Создать" visible="1" type="Ellipsis" side="Right">
                  <useparam name="user_id" />
                </uicommand>
              </buttons>
            </column>
            <column table="a" column="user_email" column-width="159" valid="null" />
            <column table="a" column="user_phone" column-width="120" valid="null" />
            <column table="a" column="esia_guid" column-width="80" valid="null" />
            <column table="a" column="user_registration" valid="null" />
            <column table="a" column="user_last_login" valid="null" />
            <column table="a" column="user_snils" valid="null" />
            <column table="a" column="user_type" valid="null" />
            <column table="a" column="pref_communication" valid="null" />
            <column table="a" column="blocking_date" valid="null" />
            <column table="a" column="status" valid="null" />
          </columns>
          <events exclude="1">
            <useaction event-name="double-click" action-type="dynamic-form" call="vc_user_login">
              <useparam name="user_id" />
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vc_user_login" as="a" column-editable="0" auto-refresh="1" async="1">
          <where>
            <call function="and">
              <call function="true" />
              <call function="like" optional="1">
                <call function="cut_phone">
                  <column column="user_phone" table="a" />
                </call>
                <call function="||">
                  <const>'%'</const>
                  <call function="cut_phone">
                    <useparam name="phone" />
                  </call>
                  <const>'%'</const>
                </call>
              </call>
              <call function="like" optional="1">
                <column table="a" column="user_email" />
                <call function="||">
                  <const>'%'</const>
                  <useparam name="email" />
                  <const>'%'</const>
                </call>
              </call>
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="vc_user_login" timestamp="29.01.2019 17:33:02" title="Пользователь ЛКК [:a.fio]" show-toolbar="1" form-size="1164;672" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param name="user_id" type="number">
          <const type="number">60</const>
        </param>
        <param name="kod_kontakt" type="number" />
        <param type="string" name="num_zayav" />
      </params>
      <content>
        <column table="k_i" column="phone" parname="phone_i" column-visible="0" />
        <column table="k_i" column="email" parname="email_i" column-visible="0" />
        <column table="k_i" column="f" parname="f_i" column-vfsfble="0" column-visible="0" />
        <column table="k_i" column="i" parname="i_i" column-visible="0" />
        <column table="k_i" column="o" parname="o_i" column-vfsfble="0" column-visible="0" />
        <column table="k_i" column="send_prior_nvl" parname="send_prior_i" column-vfsfble="0" column-visible="0" />
        <column table="z_i" column="num_zayav" parname="num_zayav" column-visible="0" exclude="1" />
        <column table="a" column="is_not_new" parname="a_is_not_new" as="is_not_new" column-visible="0" />
        <column table="k_i" column="user_right" parname="user_right" comment="Право на пункт 13065 (сейчас не используется)" column-visible="0" />
        <fieldgroup noborder="1">
          <fieldgroup noborder="1" width-perc="3">
            <column table="a" column="user_email" default="email_i" />
            <column table="a" column="user_phone" default="phone_i" />
            <column table="a" column="fio" />
          </fieldgroup>
          <fieldgroup title="Заявка" width-perc="1" noborder="1" visible="nz_i_num" exclude="1">
            <column table="nz_i" column="num_z" title="Заявка" parname="nz_i_num" />
            <column table="nz_i" column="kod_zayav" title="Заявка" parname="nz_i_kod_zayav" column-visible="0" />
            <uicommand title="Привязать" action-type="custom" side="Right">
              <useaction name="vc_bind_request_upd_kont">
                <useparam name="nz_i_kod_zayav" />
                <useparam name="nz_i_num" />
                <useparam name="user_id" />
              </useaction>
              <useaction action-type="refresh-table" object="nz_i" />
            </uicommand>
          </fieldgroup>
        </fieldgroup>
        <tabcontainer>
          <fieldgroup title="Информация">
            <column column="person_last_name" default="f_i" table="a" />
            <column column="person_first_name" table="a" default="i_i" />
            <column column="person_middle_name" table="a" default="o_i" />
            <column table="a" column="esia_guid" />
            <column table="a" column="user_snils" />
            <column table="a" column="user_type" parname="user_type" visible="user_type" column-editable="0" />
            <column table="a" column="pref_communication" default="send_prior_i" />
            <column table="a" column="status" column-editable="0" />
            <column table="a" column="user_registration" />
            <column table="a" column="user_last_login" />
            <column table="a" column="blocking_date" column-editable="0" />
            <column table="a" column="user_info" exclude="1" />
          </fieldgroup>
          <fieldgroup title="Заявки / ВО" visible="a_is_not_new">
            <grid table="z" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="vc_zayav_select" modal="1" title="Поиск и привязка" editable="1">
                  <useparam name="user_id" />
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите отвязать выделенные заявки?" title="Отвязать выбранные" editable="1">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="z" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="z" column="name_org" as="namep" column-width="233" />
                <column table="z" column="kod_ul_zayav" column-visible="0" parname="kod_ul_zayav" />
                <column table="z" column="kod_zayav" parname="z_kod_zayav" column-visible="0" />
                <column table="z" column="kod_zayav_virt" parname="z_kod_zayav_virt" column-visible="0" />
                <column table="z" column="num_zayav_vo" column-width="147" column-editable="0">
                  <buttons>
                    <uicommand name="open_form_vo" visible="z_kod_zayav_virt" side="Right">
                      <useparam name="z_kod_zayav_virt" />
                    </uicommand>
                  </buttons>
                </column>
                <column table="zv" column="d_c" column-width="150" />
                <column table="z" column="num_zayav" column-width="147" column-editable="0" title="Номер заявки">
                  <buttons>
                    <uicommand name="open_form_zayav" visible="z_kod_zayav" side="Right">
                      <useparam name="z_kod_zayav" />
                    </uicommand>
                  </buttons>
                </column>
                <column table="zz" column="dat_zayav" column-width="150" />
                <column table="c_zayav_family" column="name_filial" column-width="96" exclude="1" />
                <column table="kod_spr_query" column="name" exclude="1" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup visible="a_is_not_new" title="УВТУ">
            <grid table="uvtu" show-toolbar="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
              </toolbar>
              <columns>
                <column table="uvtu" column="num_zayav" title="Номер УВТУ" column-editable="0" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="Контакты" visible="a_is_not_new">
            <grid table="k" show-toolbar="1" show-checkbox="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="vc_kontakt_select" modal="1" title="Привязка" editable="user_right">
                  <useparam name="user_id" />
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите отвязать выделенные заявки?" title="Отвязать выбранные" editable="user_right">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="k" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="c" column="name" column-width="346" />
                <column table="kk" column="kod_kontact" column-width="150" parname="kod_kontact_c" column-visible="0" />
                <column table="kk" column="oper" column-width="225" />
                <column table="kk" column="phone" column-width="133" />
                <column table="kk" column="e_mail" column-width="155" />
                <fact table="kk" column="vc_ul_izmen_d_m" column-width="133">
                  <buttons>
                    <uicommand action-type="dynamic-form" call="vc_ul_izmen" type="Ellipsis" side="Right" visible="1">
                      <useparam name="kod_kontact_c" />
                    </uicommand>
                  </buttons>
                </fact>
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup visible="a_is_not_new" title="Контрагенты" exclude="1">
            <grid table="c1" show-toolbar="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="vc_creditors_select" modal="1" title="Привязка">
                  <useparam name="user_id" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="cc" column="name" column-width="147" />
                <column table="cc" column="inn" column-width="150" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup visible="a_is_not_new" title="Обращения">
            <grid table="compl" show-toolbar="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
              </toolbar>
              <columns>
                <column table="compl" column="num_reg" title="Номер" column-editable="0" />
                <column table="compl" column="date_reg" title="Дата" column-editable="0" />
                <column table="compl_vid" column="name" title="Вид обращения" as="vid_name" column-editable="0" />
                <column table="compl_subj" column="name" title="Тематика" as="subj_name" column-editable="0" />
                <column table="compl_subt" column="name" title="Подтематика" as="subt_mane" column-editable="0" />
                <column table="compl_ts" column="name" title="Канал поступления" as="ts_name" column-editable="0" />
                <column table="compl_fs" column="name" title="Форма поступления" as="fs_name" column-editable="0" />
                <column table="compl" column="cause" title="Причина" controlType="UITextEx" column-editable="0" />
                <column table="compl" column="kod" title="ID (kod)" column-visible="0" column-editable="0" />
              </columns>
            </grid>
          </fieldgroup>
        </tabcontainer>
      </content>
      <from>
        <query name="vc_user_login" as="a" new-rows-vis-for-other-tbls="1">
          <where>
            <call function="=">
              <column table="a" column="user_id" />
              <useparam name="user_id" />
            </call>
          </where>
          <elink name="vc_ul_kontakt" as="k" only-visible-refresh="1">
            <link name="kod_kontact" as="kk">
              <link name="e_code" as="c" />
            </link>
          </elink>
          <elink name="vc_ul_zayav" as="z" only-visible-refresh="1">
            <link name="kod_zayav" as="zz">
              <link name="c_zayav_family" exclude="1" />
              <link name="kod_spr_query" exclude="1" />
            </link>
            <link name="kod_zayav_virt" as="zv" />
            <where>
              <call function="=">
                <column table="z" column="request_kind" />
                <const>0</const>
              </call>
            </where>
          </elink>
          <elink name="vc_ul_zayav" as="uvtu" only-visible-refresh="1">
            <where>
              <call function="=">
                <column table="uvtu" column="request_kind" />
                <const>1</const>
              </call>
            </where>
          </elink>
          <elink name="is_complaints" only-visible-refresh="1" as="compl">
            <link name="kod_vid_compl" as="compl_vid" />
            <link name="kod_subject" as="compl_subj" />
            <link name="kod_subtheme" as="compl_subt" />
            <link name="kod_type_source" as="compl_ts" />
            <link name="kod_form_source" as="compl_fs" />
          </elink>
        </query>
        <query name="vc_ul_def_info" as="k_i">
          <withparams>
            <useparam name="kod_kontakt" />
            <useparam name="num_zayav" />
          </withparams>
        </query>
        <query name="vc_num_z_vo" as="nz_i" exclude="1">
          <where>
            <call function="=">
              <column table="nz_i" column="num_zayav" />
              <useparam name="num_zayav" />
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="vc_kontakt_select" timestamp="01.11.2018 16:54:37" title="Привязка контактов к пользователю [:a.fio]" form-size="1278;600" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param name="user_id" type="number" />
      </params>
      <content>
        <column table="a" column="user_email" parname="v_mail" column-visible="0" />
        <column table="a" column="user_phone" parname="v_phone" column-visible="0" />
        <column column="fio" table="a" column-visible="0" />
        <fieldgroup title="Фильтры">
          <usefield name="p_phone" field="cmn_string" title="Телефон" new-val="v_phone" />
          <usefield name="p_mail" field="cmn_string" new-val="v_mail" title="E-mail" />
          <usefield name="p_zay" field="cmn_check" title="С учетом привязанных заявок">
            <defaultquery>
              <query name="true" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <splitcontainer>
          <fieldgroup title="Доступные для привязки">
            <grid table="kk" show-toolbar="1" show-checkbox="1">
              <toolbar>
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="custom-refresh" action-type="custom">
                  <useaction action-type="refresh-table" object="kk" />
                  <useaction action-type="refresh-table" object="kkp" />
                </uicommand>
                <uicommand action-type="save-and-close" button-type="custom-ok" title="Подтрердить выбор сохранить и закрыть" />
              </toolbar>
              <columns>
                <column table="kk" column="kod_kontact" column-visible="0" parname="kod_kontact" />
                <column table="c" column="name" column-width="147" />
                <column table="kk" column="oper" column-width="150" />
                <column table="kk" column="phone" column-width="133" />
                <column table="kk" column="e_mail" column-width="155" />
              </columns>
              <events>
                <useaction event-name="checked-row-save" action-type="custom">
                  <useaction action-type="execute-add" call="vc_add_kontact">
                    <useparam name="kod_kontact" />
                    <useparam name="user_id" />
                  </useaction>
                </useaction>
              </events>
            </grid>
          </fieldgroup>
          <fieldgroup title="Привязанные к другим пользователям">
            <grid table="kkp" show-toolbar="1">
              <toolbar>
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
              </toolbar>
              <columns>
                <column table="cp" column="name" column-width="147" />
                <column table="kkp" column="oper" column-width="150" />
                <column table="kkp" column="phone" column-width="133" />
                <column table="kkp" column="e_mail" column-width="155" />
              </columns>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="vc_user_login" as="a">
          <where>
            <call function="=">
              <column table="a" column="user_id" />
              <useparam name="user_id" />
            </call>
          </where>
        </query>
        <query name="is_kontact" as="kk" column-editable="0" auto-refresh="1" async="1">
          <qube>
            <link name="vc_user_login_by_z" only-for-cond="1" />
            <where>
              <call function="and">
                <call function="true" />
                <call function="and">
                  <call function="is null">
                    <column table="vc_ul_kontakt" column="kod_ul_kontakt" />
                  </call>
                  <call function="or">
                    <call function="and">
                      <call function="true" />
                      <call function="like" optional="1">
                        <column table="kk" column="phone" />
                        <call function="||">
                          <const>'%'</const>
                          <useparam name="p_phone" />
                          <const>'%'</const>
                        </call>
                      </call>
                      <call function="like" optional="1">
                        <column table="kk" column="e_mail" />
                        <call function="||">
                          <const>'%'</const>
                          <useparam name="p_mail" />
                          <const>'%'</const>
                        </call>
                      </call>
                    </call>
                    <call function="like" optional="1">
                      <column table="kk" column="phone" />
                      <call function="||">
                        <const>'%'</const>
                        <useparam name="p_phone" />
                        <const>'%'</const>
                      </call>
                    </call>
                    <call function="like" optional="1">
                      <column table="kk" column="e_mail" />
                      <call function="||">
                        <const>'%'</const>
                        <useparam name="p_mail" />
                        <const>'%'</const>
                      </call>
                    </call>
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="p_zay" />
                  </call>
                  <call function="=">
                    <column table="vc_user_login_by_z" column="user_id" />
                    <useparam name="user_id" />
                  </call>
                </call>
              </call>
            </where>
          </qube>
          <link name="e_code" as="c" />
          <link name="vc_ul_kontakt" />
        </query>
        <query name="is_kontact" as="kkp" column-editable="0" auto-refresh="1">
          <qube>
            <link name="vc_user_login_by_z" only-for-cond="1" as="vc_user_login_by_z_p" />
            <where>
              <call function="and">
                <call function="!=">
                  <column table="vc_ul_kontakt_p" column="user_id" />
                  <useparam name="user_id" />
                </call>
                <call function="or">
                  <call function="and">
                    <call function="true" />
                    <call function="like" optional="1">
                      <column table="kkp" column="phone" />
                      <call function="||">
                        <const>'%'</const>
                        <useparam name="p_phone" />
                        <const>'%'</const>
                      </call>
                    </call>
                    <call function="like" optional="1">
                      <column table="kkp" column="e_mail" />
                      <call function="||">
                        <const>'%'</const>
                        <useparam name="p_mail" />
                        <const>'%'</const>
                      </call>
                    </call>
                  </call>
                  <call function="like" optional="1">
                    <column table="kkp" column="phone" />
                    <call function="||">
                      <const>'%'</const>
                      <useparam name="p_phone" />
                      <const>'%'</const>
                    </call>
                  </call>
                  <call function="like" optional="1">
                    <column table="kkp" column="e_mail" />
                    <call function="||">
                      <const>'%'</const>
                      <useparam name="p_mail" />
                      <const>'%'</const>
                    </call>
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="p_zay" />
                  </call>
                  <call function="=">
                    <column table="vc_user_login_by_z_p" column="user_id" />
                    <useparam name="user_id" />
                  </call>
                </call>
              </call>
            </where>
          </qube>
          <link name="e_code" as="cp" />
          <link name="vc_ul_kontakt" as="vc_ul_kontakt_p" />
        </query>
      </from>
    </form>
    <form name="vc_zayav_select" timestamp="04.12.2018 21:34:28" title="Привязка заявок к пользователю [:a.fio]" form-size="1397;630" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param name="user_id" type="number" />
      </params>
      <expressions>
        <call group="max" function="if" type="number" as="bad_kont_pr">
          <call function="and">
            <call function="!=nvl">
              <useparam name="user_id" />
              <column table="vc_user_login_by_k" column="user_id" />
            </call>
            <call function="is not null">
              <column table="c_zayav" column="kod_zayav" />
            </call>
            <call function="=0">
              <column table="vc_num_z_vo" column="pr_change_kont" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call group="max" function="if" type="number" as="bad_kont">
          <call function="and">
            <call function="!=nvl">
              <useparam name="user_id" />
              <column table="vc_user_login_by_k" column="user_id" />
            </call>
            <call function="is not null">
              <column table="c_zayav" column="kod_zayav" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call group="max" function="if" type="number" as="is_bound">
          <call function="and">
            <call function="is not null">
              <column table="vc_user_login" column="user_id" />
            </call>
            <call function="=0">
              <column table="vc_num_z_vo" column="pr_rebind" />
            </call>
          </call>
          <fact column="vc_num_z_vo_cnt" />
        </call>
        <call type="number" as="cant_sel" group="sum" function="nvl">
          <fact column="bad_kont_pr" nullif="0" />
          <fact column="is_bound" nullif="0" />
        </call>
      </expressions>
      <content>
        <column column="fio" table="a" column-visible="0" />
        <fieldgroup title="Фильтры">
          <usefield name="p_num" field="cmn_string_array" hint="Можно указать несколько номеров через пробел или запятую" title="Номера заявок / ВО" />
          <usefield field="cmn_check" name="pr_my" column-visible="0">
            <defaultquery>
              <query name="vcf_not_num_z" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <splitcontainer>
          <fieldgroup title="Найденные заявки / ВО">
            <grid table="np_z_vo" show-toolbar="1" show-checkbox="1">
              <toolbar>
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand action-type="save-and-close" title="Привязать выбранные" editable="np_kod" exclude="1" />
                <uicommand title="Привязать выбранные" editable="np_kod" name="vc_accept_zayav_selection" />
              </toolbar>
              <columns>
                <column table="np_z_vo" column="num_zayav" parname="np_kod" column-visible="0" />
                <column table="np_z_vo" column="kod_zayav" parname="kod_zayav" column-visible="0" />
                <column table="np_z_vo" column="kod_zayav_virt" parname="kod_zayav_virt" column-visible="0" />
                <column table="np_z_vo" column="name_org" as="namep" column-width="225" />
                <column table="np_z_vo" column="num_zayav_vo" column-width="125">
                  <buttons>
                    <uicommand name="open_form_vo" visible="kod_zayav_virt" side="Right">
                      <useparam name="kod_zayav_virt" />
                    </uicommand>
                  </buttons>
                </column>
                <column table="np_zv" column="d_c" column-editable="0" />
                <column table="np_z_vo" column="num_z" column-width="87" as="num_z">
                  <buttons>
                    <uicommand name="open_form_zayav" visible="kod_zayav" side="Right">
                      <useparam name="kod_zayav" />
                    </uicommand>
                  </buttons>
                </column>
                <column table="np_z" column="dat_zayav" column-width="119" column-editable="0" />
                <column table="np_kon" column="vis_id" column-width="210" title="Оcновной контакт" as="k_vis_id" />
                <fact table="np_z_vo" parname="bad_kont" column="bad_kont" column-visible="0" />
                <column table="np_z_vo" column="pr_change_kont" editable="bad_kont" exclude="1" />
                <column table="user_id" column="vis_id" title="Логин ЛКК" as="u_vis_id" column-width="207" />
                <column table="np_z_vo" column="pr_rebind" editable="old_user_id" column-width="91" exclude="1" />
                <fact table="np_z_vo" column="cant_sel" parname="can_sel" column-visible="0" exclude="1" />
                <column table="user_id" column="user_id" column-visible="0" parname="old_user_id" />
              </columns>
              <events>
                <useaction event-name="checked-row-save" name="vc_bind_request_upd_kont">
                  <useparam name="np_kod" />
                  <useparam name="user_id" />
                </useaction>
              </events>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="vc_user_login" as="a">
          <where>
            <call function="=">
              <column table="a" column="user_id" />
              <useparam name="user_id" />
            </call>
          </where>
        </query>
        <query name="vc_num_z_vo" as="np_z_vo" column-editable="0" new-rows-vis-for-other-tbls="1" auto-refresh="1" async="1">
          <link name="kod_zayav" as="np_z">
            <link name="kod_kontact" as="np_kon">
              <link name="vc_ul_kontakt" />
            </link>
          </link>
          <link name="kod_zayav_virt" as="np_zv" />
          <qube>
            <link name="vc_ul_zayav" as="np_uz">
              <link name="user_id" />
            </link>
            <where>
              <call function="and">
                <call function="!=nvl">
                  <column column="user_id" table="np_uz" />
                  <useparam name="user_id" />
                </call>
                <call function="in" optional="1">
                  <column column="num_zayav" table="np_z_vo" />
                  <useparam name="p_num" />
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_my" />
                  </call>
                  <call function="=">
                    <column column="user_id" table="vc_ul_kontakt" />
                    <useparam name="user_id" />
                  </call>
                  <call function="is null">
                    <column column="user_id" table="np_uz" />
                  </call>
                </call>
              </call>
            </where>
          </qube>
        </query>
      </from>
    </form>
    <form name="vc_creditors_select" timestamp="11.10.2018 15:14:25" title="Привязка контрагентов к пользователю [:a.fio]" form-size="1140;563" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param name="user_id" type="number" />
      </params>
      <content>
        <column table="a" column="fio" column-visible="0" />
        <fieldgroup title="Фильтры">
          <usefield name="p_name" field="cmn_string" title="Наименование" />
          <usefield name="p_inn" field="cmn_string" title="ИНН" />
        </fieldgroup>
        <grid table="zz" show-toolbar="1" show-checkbox="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="save-and-close" button-type="custom-ok" title="Подтрердить выбор сохранить и закрыть" />
          </toolbar>
          <columns>
            <column table="zz" column="e_code" column-visible="0" parname="kod" />
            <column table="zz" column="name" column-width="147" />
            <column table="zz" column="inn" column-width="150" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vc_add_creditor">
                <useparam name="kod" />
                <useparam name="user_id" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vc_user_login" as="a">
          <where>
            <call function="=">
              <column table="a" column="user_id" />
              <useparam name="user_id" />
            </call>
          </where>
        </query>
        <query name="is_creditors" as="zz" column-editable="0">
          <qube>
            <where>
              <call function="and">
                <call function="true" />
                <call function="or">
                  <call function="like" optional="1">
                    <column table="zz" column="name" />
                    <useparam name="p_name" />
                  </call>
                  <call function="like" optional="1">
                    <column table="zz" column="inn" />
                    <useparam name="p_inn" />
                  </call>
                </call>
              </call>
            </where>
          </qube>
        </query>
      </from>
    </form>
    <form name="vc_zayavka_kontakt" timestamp="29.11.2018 01:26:24" title="Заявка с контактными лицами" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <content>
        <fieldgroup title="Фильтры">
          <usefield name="p_phone" field="cmn_string" title="Телефон" new-val="v_phone" exclude="1" />
          <usefield name="p_mail" field="cmn_string" new-val="v_mail" title="E-mail" exclude="1" />
          <usefield name="p_num" field="cmn_string_array" title="Заявка" hint="Можно указать несколько номеров через пробел или запятую" />
        </fieldgroup>
        <splitcontainer>
          <fieldgroup title="Заявки">
            <grid table="zz" show-toolbar="1">
              <toolbar>
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
              </toolbar>
              <columns>
                <column table="zz" column="kod_zayav" format="F0" parname="kod_zayav" />
                <column table="zz" column="num_zayav" format="F0" parname="num_zayav" as="num" />
                <column table="kodp" column="e_code" format="F0" column-visible="1" />
                <column table="kodp" column="name" format="F0" column-visible="1" />
                <column table="z_kont" column="kod_kontact" format="F0" column-visible="1" />
                <column table="z_kont" column="vis_id" format="F0" column-visible="1" />
                <fact column="vc_ul_zayav_cnt" title="Привязана в ЛК" table="zz">
                  <buttons>
                    <uicommand type="Search" action-type="dynamic-form" call="vc_zayav" visible="1" side="Right" modal="1" title="Привязать учетную запись">
                      <useparam name="num_zayav" />
                    </uicommand>
                  </buttons>
                </fact>
                <fact table="zz" column="is_kontact_cnt" title="К-во контактов" exclude="1" />
              </columns>
              <events exclude="1">
                <useaction event-name="double-click" action-type="dynamic-form" call="vc_user_login">
                  <useparam name="user_id" />
                </useaction>
              </events>
            </grid>
          </fieldgroup>
          <fieldgroup title="Контрагенты" expanded="0">
            <grid table="p">
              <toolbar>
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
              </toolbar>
              <columns>
                <column table="pp" column="e_code" parname="e_code" format="F0" />
                <band title="Контрагент">
                  <column table="pp" column="name" title="Наименование" column-width="235" />
                  <column table="pp" column="e_mail" column-width="93" />
                  <column table="pp" column="phone" column-width="94" />
                </band>
                <band title="Контакт">
                  <column table="kod_kontact" column="kod_kontact" format="F0" />
                  <column table="kod_kontact" column="oper" />
                  <column table="kod_kontact" column="e_mail" as="e_mail_k" />
                  <column table="kod_kontact" column="phone" as="phone_k" />
                </band>
              </columns>
              <events exclude="1">
                <useaction event-name="double-click" action-type="dynamic-form" call="vc_user_login">
                  <useparam name="user_id" />
                </useaction>
              </events>
            </grid>
          </fieldgroup>
          <fieldgroup title="Контакты">
            <fact table="k" column="vc_user_login_reg" column-width="170" title="Дата регистрации ЛК" exclude="1">
              <buttons>
                <uicommand title="Создать учетную запись" type="Plus" action-type="dynamic-form-create" call="vc_user_login" visible="kod_kontact">
                  <const>null</const>
                  <useparam name="kod_kontact" />
                </uicommand>
              </buttons>
            </fact>
            <grid table="k">
              <toolbar>
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
              </toolbar>
              <columns>
                <column table="k" column="kod_kontact" format="F0" parname="kod_kontact" />
                <column table="k" column="oper" column-width="279" />
                <fact table="k" column="vc_user_login_reg" column-width="170" title="Дата регистрации ЛК" parname="vc_user_login_reg">
                  <buttons>
                    <uicommand title="Создать учетную запись" type="Plus" action-type="dynamic-form-create" call="vc_user_login" visible="vc_user_login_reg" side="Right" visible-invert="1" modal="1">
                      <const>null</const>
                      <useparam name="kod_kontact" />
                      <useparam name="num_zayav" />
                    </uicommand>
                    <uicommand type="Search" action-type="dynamic-form" call="vc_ul_search" visible="vc_user_login_reg" side="Right" visible-invert="1" modal="1" title="Привязать учетную запись">
                      <useparam name="kod_kontact" />
                      <useparam name="num_zayav" />
                    </uicommand>
                    <uicommand title="Посмотреть учетную запись" type="Ellipsis" action-type="dynamic-form" call="vc_user_login" visible="vc_user_login_reg" side="Right">
                      <useparam name="user_id" />
                    </uicommand>
                  </buttons>
                </fact>
                <column table="k" column="phone" column-width="189" />
                <column table="k" column="phone_clear" column-width="189" />
                <column table="k" column="e_mail" column-width="189" />
                <fact table="k" column="vc_user_login_user_id" parname="user_id" />
                <column table="k" column="send_prior_nvl" />
              </columns>
              <events exclude="1">
                <useaction event-name="double-click" action-type="dynamic-form" call="vc_user_login">
                  <useparam name="user_id" />
                </useaction>
              </events>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="c_zayav" as="zz" column-editable="0">
          <link name="kodp" />
          <link name="kod_kontact" as="z_kont" />
          <elink name="qr_list_zpr_abons" as="p" column-editable="0">
            <link name="kodp" as="pp" />
            <link name="kod_kontact" />
          </elink>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="zz" column="num_zayav" />
                <useparam name="p_num" />
              </call>
            </call>
          </where>
        </query>
        <query name="is_creditors" auto-refresh="1" column-editable="0">
          <where>
            <call function="=">
              <column table="is_creditors" column="e_code" />
              <useparam name="e_code" />
            </call>
          </where>
          <elink name="is_kontact" as="k" column-editable="0" />
        </query>
        <query name="is_kontact" as="a" column-editable="0" exclude="1">
          <qube>
            <link name="kido_e_code" as="c" />
            <link name="c_zayav" as="z" />
          </qube>
        </query>
        <query name="vc_user_login" as="a" column-editable="0" auto-refresh="1" async="1" exclude="1">
          <where>
            <call function="and">
              <call function="true" />
              <call function="like" optional="1">
                <column column="user_phone" table="a" />
                <call function="||">
                  <const>'%'</const>
                  <useparam name="phone" />
                  <const>'%'</const>
                </call>
              </call>
              <call function="like" optional="1">
                <column table="a" column="user_email" />
                <call function="||">
                  <const>'%'</const>
                  <useparam name="email" />
                  <const>'%'</const>
                </call>
              </call>
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="vc_zayav" timestamp="01.11.2018 20:54:33" form-size="1164;672" title="Заявка [:nz.num_zayav] в ЛКК" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param type="string" name="num_zayav">
          <const>'17-8382'</const>
        </param>
      </params>
      <content>
        <column table="nz" column="num_zayav" column-visible="0" />
        <grid table="zul" show-toolbar="1">
          <toolbar>
            <uicommand button-type="grid-add" visible="0" />
            <uicommand action-type="dynamic-form-create-multiple" call="vc_ul_select" modal="1" title="Привязка">
              <useparam name="num_zayav" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="ul" column="user_id" parname="user_id" column-visible="0" />
            <column table="ul" column="fio" column-width="283">
              <buttons>
                <uicommand action-type="dynamic-form" call="vc_user_login" visible="1" side="Right">
                  <useparam name="user_id" />
                </uicommand>
              </buttons>
            </column>
            <column table="ul" column="user_phone" column-width="146" />
            <column table="ul" column="user_email" column-width="209" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="vc_num_zayav" as="nz">
          <withparams>
            <useparam name="num_zayav" />
          </withparams>
        </query>
        <query name="vc_ul_zayav" as="zul">
          <link name="user_id" as="ul" />
          <where>
            <call function="=">
              <column table="zul" column="num_zayav" />
              <useparam name="num_zayav" />
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="vc_user_login_test" timestamp="01.11.2018 14:35:17" title="Пользователь ЛКК [:a.fio]" show-toolbar="1" form-size="1164;672" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param name="user_id" type="number" />
      </params>
      <content>
        <column table="a" column="user_phone" />
        <fact table="a" column="vc_user_login_othr_cnt" />
      </content>
      <from>
        <query name="vc_user_login" as="a" new-rows-vis-for-other-tbls="1">
          <where>
            <call function="=">
              <column table="a" column="user_id" />
              <useparam name="user_id" />
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="vc_ul_izmen" timestamp="26.11.2018 16:38:01" title="История изменения реквизитов пользователя" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\form.xml">
      <params>
        <param type="number" name="p_kod_kontakt" />
      </params>
      <content>
        <column table="a" column="oper" />
        <column table="a" column="phone" />
        <column table="a" column="e_mail" />
        <grid show-toolbar="1" table="i">
          <toolbar>
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand button-type="grid-save" column-visible="0" />
          </toolbar>
          <columns>
            <column table="i" column="d_m" column-width="123" />
            <column table="i" column="u_m" column-width="141" />
            <column table="i" column="field" />
            <column table="i" column="old_val" column-width="197" />
            <column table="i" column="new_val" column-width="190" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="is_kontact" as="a" column-editable="0">
          <elink name="vc_ul_izmen" as="i" column-editable="0" />
          <where>
            <call function="=">
              <column column="kod_kontact" table="a" />
              <useparam name="p_kod_kontakt" />
            </call>
          </where>
        </query>
      </from>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name">
    <expression-package name="kido_lkk" timestamp="31.10.2018 22:02:50" file="sql.builder.templates\sql.builder\projects\kido_lkk\expr.xml">
      <call function="if" as="is_kontact_cnt_by_p" type="number" group="sum" exclude="1">
        <params>
          <param type="string" name="val" />
        </params>
        <call function="like">
          <column table="is_kontact" column="phone" />
          <useparam name="val" />
        </call>
        <fact column="is_kontact_cnt" />
      </call>
      <call function="if" as="vc_ul_othr_phone_dub_cnt" type="number" group="sum">
        <call function="=">
          <call function="cut_num">
            <column table="vc_user_login" column="user_phone" />
          </call>
          <call function="cut_num">
            <column table="vc_user_login_othr" column="user_phone" />
          </call>
        </call>
        <fact column="vc_user_login_othr_cnt" />
      </call>
      <call function="if" as="vc_ul_othr_mail_dub_cnt" type="number" group="sum">
        <call function="=">
          <column table="vc_user_login" column="user_email" />
          <column table="vc_user_login_othr" column="user_email" />
        </call>
        <fact column="vc_user_login_othr_cnt" />
      </call>
      <call function="nvl" as="vc_ul_phone_error" type="string" group="max">
        <column table="vc_user_login" column="phone_error" />
        <call function="if">
          <call function="!=0">
            <fact column="vc_ul_othr_phone_dub_cnt" />
          </call>
          <const>'Такой телефон уже используется'</const>
        </call>
      </call>
      <call function="nvl" as="vc_ul_mail_error" type="string" group="max">
        <column table="vc_user_login" column="mail_error" />
        <call function="if">
          <call function="!=0">
            <fact column="vc_ul_othr_mail_dub_cnt" />
          </call>
          <const>'Такой E-mail уже используется'</const>
        </call>
      </call>
    </expression-package>
  </expression-packages>
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name">
    <action name="open_vc_user_login_list" action-type="dynamic-form" call="vc_user_login_list" timestamp="30.10.2018 12:46:57" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml" />
    <action name="open_form_zayav" action-type="call-client-method" assembly="prisoed.el.complex" type-name="prisoed.el.complex.LkkP.LkkUtilsP" function="OpenFormZayav" title="Открыть заявку" timestamp="29.11.2018 18:10:23" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="kod_zayav" type="number" />
      </params>
    </action>
    <action name="open_form_vo" action-type="call-client-method" assembly="prisoed.el.complex" type-name="prisoed.el.complex.LkkP.LkkUtilsP" function="OpenFormVo" title="Открыть виртуальное обращение" timestamp="29.11.2018 18:10:46" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="kod_vo" type="number" />
      </params>
    </action>
    <action name="vc_accept_zayav_selection" action-type="call-client-method" assembly="sql.builder" type-name="sql.builder.Special.Kido.Lkk" function="AcceptZayavSelection" timestamp="29.11.2018 18:10:46" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml" />
    <action name="vc_bind_request_upd_kont" action-type="call-plsql-add" timestamp="04.12.2018 21:56:22" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="num_zayav" type="string" />
        <param name="user_id" type="number" />
        <param name="ret" type="number" is-ret="1" />
      </params>
      <text>begin

:ret:=vc_lkk_utils.BIND_LOGIN(:user_id, :num_zayav); 

end;</text>
    </action>
    <action name="vc_bind_zayav" action-type="call-plsql-add" timestamp="04.12.2018 21:56:22" comment="скорее всего не актуален" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="num_zayav" type="string" />
      </params>
      <text>
        declare

        v_user_id number;
        res number;
        begin
        select max(b.user_id)  into v_user_id from c_zayav a, vc_ul_kontaKt b where a.kod_kontact=b.kod_kontact and a.num_zayav=:num_zayav;
        if v_user_id is null then
          select max(b.user_id)  into v_user_id from vc_num_z_vo n, c_zayav_virtual a, vc_ul_kontaKt b where a.kod_kontact=b.kod_kontact and n.KOD_ZAYAV_VIRT=a.kod and n.num_zayav=:num_zayav;
        end if;
        res:=vc_lkk_utils.BIND_LOGIN(v_user_id, :num_zayav);

        end;</text>
    </action>
    <action name="vc_bind_zayav_no_kont" action-type="call-plsql-add" timestamp="04.12.2018 21:56:22" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="num_zayav" type="string" />
        <param name="user_id" type="number" />
      </params>
      <text>
        declare
        res number;
        begin
        res:=vc_lkk_utils.bind_login_no_kont(:user_id, :num_zayav);
        end;
      </text>
    </action>
    <action name="vc_bind_zayav_to_main_kont" action-type="call-plsql-add" timestamp="04.12.2018 21:56:22" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="num_zayav" type="string" />
      </params>
      <text>
        declare

        v_user_id number;
        res number;
        begin
        select max(b.user_id)  into v_user_id from c_zayav a, vc_ul_kontaKt b where a.kod_kontact=b.kod_kontact and a.num_zayav=:num_zayav;
        if v_user_id is null then
        select max(b.user_id)  into v_user_id from vc_num_z_vo n, c_zayav_virtual a, vc_ul_kontaKt b where a.kod_kontact=b.kod_kontact and n.KOD_ZAYAV_VIRT=a.kod and n.num_zayav=:num_zayav;
        end if;
        res:=vc_lkk_utils.bind_login_no_kont(v_user_id, :num_zayav);

        end;</text>
    </action>
    <action name="vc_bind_kont" action-type="custom" file="sql.builder.templates\sql.builder\projects\kido_lkk\form\action.xml">
      <params>
        <param name="user_id" type="number" />
        <param name="kod_kontact" type="number" />
      </params>
      <useaction action-type="execute-add" call="vcf_ul_kontakt_insert">
        <useparam name="user_id" />
        <useparam name="kod_kontakt" />
      </useaction>
    </action>
  </actions>
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>