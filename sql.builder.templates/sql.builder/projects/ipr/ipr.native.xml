<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-06-29T03:13:43.2971798+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="25499-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
      </params>
      <select>
        <call function="" as="year" type="number" key="1">
          <useparam name="year" />
        </call>
        <call function="" as="kod_doc" type="number">
          <useparam name="kod_doc" />
        </call>
        <call function="year" as="cur_year">
          <const>sysdate</const>
        </call>
        <!--<column table="is_person_gen_dir" column="fio" />
        <column table="is_person_gen_dir" column="dolgn" />-->
        <call function="get_reports_const" as="fio">
          <const>null</const>
          <const>1</const>
        </call>
        <call function="get_reports_const" as="dolgn">
          <const>null</const>
          <const>2</const>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
        <!--<query name="is_person_gen_dir" join="cross"></query>-->
      </from>
    </query>
    <query name="25499" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <select>
        <usepart part="25499-columns" />
        <call function="if" as="stadiya" type="string" title="Стадия реализации проекта С/П" agg="no">
          <call function="between">
            <useparam name="year" />
            <column table="a" column="beg_year" />
            <column table="a" column="end_year" />
          </call>
          <call function="if">
            <call function="not 0">
              <column table="a" column="kap_sum_itog_23" />
            </call>
            <const>'С'</const>
            <const>'П'</const>
          </call>
          <const>null</const>
        </call>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="25499-tree" as="tree">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="year" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="25499-dat" as="a" join="left outer" grouplevel="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <undefined />
            <useparam name="kod_ofz" />
          </withparams>
          <using>
            <column column="kod_titul_ip" />
          </using>
        </query>
      </from>
    </query>
    <query name="25499-detail" timestamp="03.06.2021 13:57:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <usepart part="25499-detail-pars" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="25499-dat" as="a">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <!--<useparam name="pr_dont_show_wfp" />-->
            <undefined />
            <useparam name="kod_ofz" />
          </withparams>
          <grsets>
            <grset level="1,2" title="По статьям сметы" as="sm">
              <where>
                <usepart part="26630-smet-cond" />
              </where>
            </grset>
            <grset level="1,4" title="По прочим затратам" as="zt">
              <where>
                <usepart part="26630-zt-cond" />
              </where>
            </grset>
            <grset level="1" title="По договорам(итог)" as="dgi">
              <where>
                <usepart part="26630-dog-cond" />
              </where>
              <grset level="3" title="По договорам" as="dg" />
            </grset>
          </grsets>
        </query>
      </from>
      <!--<where>
        <call function="=">
          <column table="t" column="tit_num_new"/>
          <const>'10133374000'</const>
        </call>
      </where>-->
    </query>
    <query name="25499-detail-razdel" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <usepart part="25499-detail-pars" />
      </params>
      <select>
        <column table="a" column="*" />
        <!--<column table="a" column="kredit2_itog"/>-->
      </select>
      <from>
        <query name="25499-dat" as="a">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
          <grsets>
            <grset level="5,2" title="По статьям сметы" as="sm">
              <where>
                <usepart part="26630-smet-cond" />
              </where>
            </grset>
            <grset level="5,4" title="По прочим затратам" as="zt" order="zatr_full_name">
              <where>
                <usepart part="26630-zt-cond" />
              </where>
            </grset>
          </grsets>
        </query>
      </from>
      <!--<where>
        <call function="=">
          <column table="t" column="tit_num_new"/>
          <const>'10133374000'</const>
        </call>
      </where>-->
    </query>
    <query name="25499-dat-test" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <usepart part="25499-detail-pars" />
      </params>
      <select>
        <column table="a" column="*" />
        <!--<column table="a" column="dz"/>
        <column table="a" column="kz"/>-->
        <!--<column table="a" column="debet_by_y"/>
        <column table="a" column="kredit_by_y"/>
        <column table="a" column="kap_sum_itog_23"/>-->
      </select>
      <from>
        <query name="25499-dat" as="a" grouplevel="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
      </from>
      <!--<where>
        <call function="=">
          <column table="a" column="kod_titul_ip"/>
          <const>7788</const>
        </call>
      </where>-->
    </query>
    <query name="25499-dat" grouplevel="no" timestamp="03.06.2021 14:01:22" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="pr_dont_show_wfp">
          <const>1</const>
        </param>
        <param name="kod_ofz">
          <const>1</const>
        </param>
      </params>
      <select>
        <usepart part="25499-dat-kod_titul_ip" />
        <column table="kod_razdel" column="kod_root" as="razdel_kod_root" group="5" agg="no" />
        <column table="a" column="kod_smet" group="2" agg="no" />
        <column table="kod_smet" column="name" as="smet_name" group="kod_smet" agg="no" />
        <column table="a" column="kodzatrat" group="4" agg="no" />
        <column table="kodzatrat" column="full_name" as="zatr_full_name" group="kodzatrat" agg="no" />
        <column table="kodzatrat" column="kod_parent" as="zatr_parent" group="kodzatrat" agg="no" />
        <column table="a" column="kod_dog_i" group="3" agg="no" />
        <column table="kod_dog_i" column="name_i" as="dog_i_name" group="kod_dog_i" agg="no" />
        <column table="kod_dog_i" column="date_i" as="dog_i_date" group="kod_dog_i" agg="no" />
        <column table="ipr_ipr_data" column="kod_doc_osn" group="max" agg="no" />
        <column table="ipr_ipr_data" column="pr_last" group="max" agg="no" />
        <column table="kod_titul_ip" column="beg_year" group="min" agg="no" />
        <column table="kod_titul_ip" column="end_year" group="max" agg="no" />
        <column table="a" column="year" group="max" />
        <call function="decode" as="summ_k_rasp" title="Полная стоимость строительства к распределению, млн. руб. с НДС" group="sum" agg="sum" type="number" mp="-6">
          <column table="a" column="summ_k_rasp_id" />
          <const>0</const>
          <column table="a" column="summ" />
          <const>1</const>
          <column table="a" column="summ_10" />
          <const>3</const>
          <column table="a" column="summ_30" />
        </call>
        <call function="decode" as="summ_k_rasp_bn" title="Полная стоимость строительства к распределению, млн. руб. без НДС" group="sum" agg="sum" type="number" mp="-6">
          <column table="a" column="summ_k_rasp_id" />
          <const>0</const>
          <column table="a" column="summ_bn" />
          <const>1</const>
          <column table="a" column="summ_10_bn" />
          <const>3</const>
          <column table="a" column="summ_30_bn" />
        </call>
        <call function="-nvl" as="ost_st_stro" title="Остаточная стоимость строительства по финансированию" group="sum" agg="sum">
          <column table="this" column="summ_k_rasp" mp="-6" />
          <column table="this" column="fp_sum_nds_itog" mp="-6" />
        </call>
        <call function="-nvl" as="ost_st_stro_kap" title="Остаточная стоимость строительства по освоению" group="sum" agg="sum">
          <column table="this" column="summ_k_rasp_bn" mp="-6" />
          <column table="this" column="kap_sum_itog" mp="-6" />
        </call>
        <call function="-nvl" as="ost_st_stro_vvod" title="Остаточная стоимость строительства по вводу" group="sum" agg="sum">
          <column table="this" column="summ_k_rasp_bn" mp="-6" />
          <column table="this" column="vvod_sum_itog" mp="-6" />
        </call>
        <column table="a" column="summ_s" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_10" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_bn" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_10_bn" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30_bn" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30_mva" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30_vl_km" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30_kl_km" group="sum" mp="-6" agg="sum" />
        <column table="a" column="summ_30_prch" group="sum" mp="-6" agg="sum" />
        <column table="a" column="dz" group="sum" mp="-6" agg="sum" />
        <column table="a" column="kz" group="sum" mp="-6" agg="sum" />
        <column table="a" column="nzs_saldo" group="sum" mp="-6" agg="sum" />
        <column table="a" column="debet_itog" group="sum" mp="-6" if="do" title="Дебиторская задолженность на начало" agg="sum">
          <section>
            <call function="num to ym2">
              <call function="-">
                <useparam name="year" />
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
        </column>
        <column table="a" column="kredit_itog" group="sum" mp="-6" if="do" title="Кредиторская задолженность на начало" agg="sum" />
        <column table="a" column="debet2_itog" group="sum" mp="-6" if="do1" title="Дебиторская задолженность на начало (с уч. заданной)" agg="sum">
          <section nvl="first">
            <call function="num to ym2">
              <call function="-">
                <useparam name="year" />
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
        </column>
        <column table="a" column="kredit2_itog" group="sum" mp="-6" if="do1" title="Кредиторская задолженность на начало (с уч. заданной)" agg="sum" />
        <column table="a" column="nzs_itog" group="sum" mp="-6" if="do" title="Незавершенное строительство на начало" agg="sum" />
        <column table="a" column="nzs2_itog" group="sum" mp="-6" if="do1" title="Незавершенное строительство на начало(с уч. заданной)" agg="sum" />
        <column table="a" column="fp_sum_nds_itog" group="sum" mp="-6" if="do" title="Объем финансирования на начало c НДС" agg="sum" />
        <column table="a" column="kap_sum_itog" group="sum" mp="-6" if="do" title="Объем капитальных вложений на начало без НДС" agg="sum" />
        <column table="a" column="vvod_sum_itog" group="sum" mp="-6" if="do" title="Ввод мощностей в ОФ (руб.) на начало без НДС" agg="sum" />
        <column table="a" column="pow_mba_itog" group="sum" if="do" title="Ввод мощностей в ОФ (МВа) на начало" agg="sum" />
        <column table="a" column="pow_km_itog" group="sum" if="do" title="Ввод мощностей в ОФ ВЛ(км) на начало" agg="sum" />
        <column table="a" column="pow_km_kl_itog" group="sum" if="do" title="Ввод мощностей в ОФ КЛ(км) на начало" agg="sum" />
        <column table="a" column="kap_sum" title="Объем капитальных вложений" group="sum" mp="-6" if="all" agg="sum">
          <if>
            <call function="between">
              <column table="this" column="year" group="" />
              <useparam name="year" />
              <call function="+">
                <useparam name="year" />
                <const>5</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fp_sum_nds" title="Объем финансирования" group="sum" mp="-6" if="all" agg="sum" />
        <column table="a" column="vvod_sum" title="Ввод мощностей в ОФ (руб.)" group="sum" mp="-6" if="all" agg="sum" />
        <column table="a" column="pow_mba" group="sum" title="Ввод мощностей в ОФ (МВа)" if="all" agg="sum" />
        <column table="a" column="pow_km" group="sum" title="Ввод мощностей в ОФ ВЛ (км)" if="all" agg="sum" />
        <column table="a" column="pow_km_kl" group="sum" title="Ввод мощностей в ОФ КЛ (км)" if="all" agg="sum" />
        <column table="a" column="kap_sum" as="kap_sum_by_y" title="Объем капитальных вложений по годам" group="sum" mp="-6" dimname="ipr_year" agg="sum">
          <pivot>
            <column table="this" column="year" group="" />
            <query>
              <select>
                <column table="yl" column="god_ip" />
                <column table="yl" column="name" />
              </select>
              <from>
                <query name="25499-year_list" as="yl" />
              </from>
              <where>
                <call function="between">
                  <column table="yl" column="god_ip" />
                  <useparam name="year" />
                  <call function="+">
                    <useparam name="year" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <call function="if" as="kap_sum_sz_by_y" type="number" title="Объем капитальных вложений по годам(содержание заказчика)" group="sum" mp="-6" agg="sum" dimname="ipr_year">
          <call function="=">
            <column table="a" column="kodzatrat" />
            <const>53</const>
          </call>
          <column table="a" column="kap_sum" />
        </call>
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_by_y" title="Объем финансирования по годам" group="sum" mp="-6" dimname="ipr_year" agg="sum" />
        <column table="a" column="vvod_sum" as="vvod_sum_by_y" title="Ввод мощностей в ОФ (руб.) по годам" group="sum" mp="-6" dimname="ipr_year" agg="sum" />
        <column table="a" column="nzs_itog" as="nzs_by_y" title="Незавершенное строительcтво по годам" group="sum" mp="-6" dimname="ipr_year1" agg="sum">
          <pivot>
            <section>
              <call function="num to ym2">
                <column table="dim" column="god_ip" />
                <const>12</const>
              </call>
            </section>
            <query>
              <select>
                <column table="yl" column="god_ip" />
                <column table="yl" column="name" />
              </select>
              <from>
                <query name="25499-year_list" as="yl" />
              </from>
              <where>
                <call function="between">
                  <column table="yl" column="god_ip" />
                  <useparam name="year" />
                  <call function="+">
                    <useparam name="year" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="nzs2_itog" as="nzs2_by_y" title="Незавершенное строительcтво по годам (с уч. заданной)" group="sum" mp="-6" dimname="ipr_year1" agg="sum" />
        <column table="a" column="debet_itog" as="debet_by_y" title="Дебиторская задолженность" group="sum" mp="-6" dimname="ipr_year1" agg="sum" />
        <column table="a" column="kredit_itog" as="kredit_by_y" title="Кредиторская задолженность" group="sum" mp="-6" dimname="ipr_year1" agg="sum" />
        <column table="a" column="debet2_itog" as="debet2_by_y" title="Дебиторская задолженность (с уч. заданной)" group="sum" mp="-6" dimname="ipr_year1" agg="sum" />
        <column table="a" column="kredit2_itog" as="kredit2_by_y" title="Кредиторская задолженность (с уч. заданной)" group="sum" mp="-6" dimname="ipr_year1" agg="sum" />
        <column table="a" column="pow_mba" as="pow_mba_by_y" group="sum" title="Ввод мощностей в ОФ (МВа) по годам" dimname="ipr_year" agg="sum" />
        <column table="a" column="pow_km" as="pow_km_by_y" group="sum" title="Ввод мощностей в ОФ (км) по годам" dimname="ipr_year" agg="sum" />
        <column table="a" column="pow_km_kl" as="pow_km_kl_by_y" group="sum" title="Ввод мощностей в ОФ (км) по годам" dimname="ipr_year" agg="sum" />
        <column table="ipr_ipr_data" column="energ_eff_kvt" mp="-6" group="max" agg="no" />
        <column table="ipr_ipr_data" column="energ_eff_proc" group="max" agg="no" />
        <column table="kod_kriteria" column="abbr" as="kriteria_name" title="Критерии включения объектов ИПР" group="max" agg="no" />
        <column table="kod_priority_insert_ip" column="abbr" as="priority_name" title="Приоритеты включения объектов ИПР" group="max" agg="no" />
        <column table="kod_klass" column="abbr_num" as="klass_name" title="Принадлежность к важн. объектам, программам" group="max" agg="no" />
        <column table="a" column="km" title="Проектная мощность/протяженность сетей ВЛ, км" group="sum" agg="sum" />
        <column table="a" column="km_kl" title="Проектная мощность/протяженность сетей KЛ, км" group="sum" agg="sum" />
        <column table="a" column="pow" title="Проектная мощность/протяженность сетей, МВА" mp="-6" group="sum" agg="sum" />
        <call function="if" as="tip_obj1" title="ВЛ, км" group="sum" agg="no">
          <call function="true" />
          <call function="nvl">
            <column table="a" column="km" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="tip_obj2" title="КЛ, км" group="sum" agg="no">
          <call function="true" />
          <call function="nvl">
            <column table="a" column="km_kl" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="tip_obj3" type="string" title="ПС (+)" group="max" agg="no">
          <call function="=">
            <column table="kod_razdel" column="tip_obj" />
            <const>3</const>
          </call>
          <const>'+'</const>
        </call>
        <call function="if" as="tip_obj0" type="string" title="Прочие (+)" group="max" agg="no">
          <call function="is null">
            <column table="kod_razdel" column="tip_obj" />
          </call>
          <const>'+'</const>
        </call>
        <column table="kod_direct" column="name" as="direct_name" group="max" agg="no" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" group="max" agg="no" />
        <column table="kod_subject" column="name" as="subject_name" group="max" agg="no" />
        <column table="kod_razdel" column="tip_obj" group="max" agg="no" />
        <column table="ipr_ipr_data" column="kod_main_titul" group="max" agg="no" />
        <call function="decode" as="in_ozp_name" type="string" group="max" title="Участвует в подготовке к ОЗП" agg="no">
          <column table="kod_titul_ip" column="in_ozp" />
          <const>1</const>
          <const>'+'</const>
          <const>''</const>
        </call>
        <call function="decode" as="prin_sogl_name" type="string" group="max" title="Принадлежность к ФНБ" agg="no">
          <column table="kod_main_titul" column="prin_sogl" />
          <const>1</const>
          <const>'+'</const>
          <const>''</const>
        </call>
        <column table="kod_priority" column="name" as="prior_name" title="Степень важности" group="max" agg="no" />
        <column table="kod_prin_soc_val" column="full_name" as="soc_val_name" title="Признак социально значимого объекта" group="max" agg="no" />
        <column table="a" column="kap_sum_itog" as="kap_sum_itog_23" title="Плановые суммы освоения по виду затрат СМР,Оборудование на начало " group="sum" mp="-6" if="beg23" agg="sum">
          <section>
            <call function="num to ym2">
              <call function="-">
                <useparam name="year" />
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
          <if>
            <call function="in">
              <column table="a" column="kod_smet" />
              <array>2,3</array>
            </call>
          </if>
        </column>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <!--<withparams>
            <const>15847</const>
          </withparams>-->
          <link name="kod_ipr" as="ipr_ipr_data">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_razdel" />
              <link name="kod_subject" />
            </link>
            <link name="kod_kriteria" />
            <link name="kod_priority_insert_ip" />
            <link name="kod_priority" />
            <link name="kod_prin_soc_val" />
            <link name="kod_klass" />
            <!--<link name="kod_ipr_dog_pr"/>-->
          </link>
          <link name="kod_smet" />
          <link name="kodzatrat" />
          <link name="kod_dog_i" />
          <extendwhere push="0">
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
              <!--<call function="in">
                <column table="*" column="kod_ipr"/>
                <array>
                  8305,
                  8306,
                  8307
                </array>
              </call>-->
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="=">
            <column table="kod_titul_ip" column="tit_num_new" />
            <const>10110238000</const>
          </call>-->
          <!--<call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>-->
          <call function="=">
            <column table="ipr_ipr_data" column="pr_last" />
            <const>1</const>
          </call>
          <call function="and" optional="1">
            <call function="=">
              <useparam name="pr_dont_show_wfp" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="has_plan" />
              <const>1</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="25499-ipr_doc_main_list" order="doc_date desc" description="Журнал «Документы» Условие: «Тип документа» = «Приказ о формировании ИПР» или «Распоряжение о начале формирования ИПР»" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <select>
        <column table="a" column="kod_doc" />
        <column table="a" column="full_name" />
        <column table="a" column="doc_date" />
      </select>
      <from>
        <query name="ipr_doc" as="a">
          <link name="kod_doc_type" />
        </query>
      </from>
      <where>
        <call function="=">
          <column table="kod_doc_type" column="pr_main" />
          <const>1</const>
        </call>
      </where>
    </query>
    <query name="25499-ipr_direct" order="name" timestamp="06.04.2018 15:14:02" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <select>
        <column table="a" column="kod_direct" group="1" key="1" />
        <column table="a" column="name" as="name_direct" fixed="1" group="1" />
        <column table="a" column="name_kr" as="name_kr_direct" group="max" />
      </select>
      <from>
        <query name="is_spr_direct" as="a">
          <link name="puser_ext" as="ipr_rights" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_rights" column="puser" />
            <const>user</const>
          </call>
          <call function="is null">
            <column table="a" column="god" />
          </call>
          <call function="=">
            <column table="a" column="invest_pr" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="25499-year_list" order="god_ip" timestamp="12.04.2017 17:09:16" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <select>
        <column table="a" column="god_ip" group="1" />
        <column table="a" column="god_ip" as="name" group="max" halign="left" />
      </select>
      <from>
        <query name="ipr_ip_by_year" as="a" />
      </from>
    </query>
    <query name="25499-year_def" description="Текущий год" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <select>
        <call function="year" as="year">
          <const>sysdate</const>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="25499-it-test" materialize="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <select>
        <column table="r_root" column="full_name" />
      </select>
      <from>
        <query name="ips_razdel_ip" as="a">
          <link name="kod_root" as="r_root" />
        </query>
      </from>
    </query>
    <query name="25499-tree" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor">
          <const>1</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="year" />
        <param name="kod_ofz" />
      </params>
      <select>
        <call function="rownum" as="rwn" fixed="1" />
        <call function="level" as="lvl" />
        <column table="a" column="*" />
      </select>
      <from>
        <query name="25499-tree-pre" as="a">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="year" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
      </from>
      <connect>
        <call function="=">
          <column table="a" column="kod_node" prior="1" />
          <column table="a" column="kod_parent_node" />
        </call>
      </connect>
      <start>
        <call function="is null">
          <column table="a" column="kod_parent_node" />
        </call>
      </start>
    </query>
    <query name="25499-tree-pre" timestamp="24.10.2016 17:14:41" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor">
          <const>1</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="year" />
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="kod_razdel" column="abbr" as="razdel_abbr" />
        <column table="kod_razdel" column="kod_razdel" if="root">
          <if pfx="_if_root">
            <call function="is null">
              <column table="kod_razdel" column="kod_parent" />
            </call>
          </if>
        </column>
        <column table="kod_titul_ip" column="tit_num_new" />
        <call function="if" as="itip" type="string" title="Тип титула">
          <call function="=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Одиночный/Дочерний'</const>
          </call>
          <call function="if">
            <call function="gt">
              <column table="kod_ipr" column="kod_parent" />
              <const>0</const>
            </call>
            <const>'Дочерний'</const>
            <const>'Одиночный'</const>
          </call>
          <column table="kod_titul_ip" column="itip" />
        </call>
        <column table="a" column="*" />
        <call function="nvl" as="har" type="string" title="Характеристика объекта ТПИР/НС">
          <column table="r_root" column="har" />
          <column table="r_root1" column="har" />
        </call>
        <column table="r_root_pp" column="abbr" as="prog" title="Отнесение к Программам" />
        <call function="coalesce" as="full_name" type="string">
          <column table="kod_titul_ip" column="full_name" />
          <column table="kod_razdel" column="full_name" />
          <const>'Все элементы'</const>
        </call>
      </select>
      <from>
        <query name="ipr_tree" as="a">
          <link name="kod_ipr" />
          <link name="kod_razdel">
            <link name="kod_root" as="r_root" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_progpartner">
              <link name="kod_root" as="r_root_pp" />
            </link>
            <link name="kod_main" as="t_root">
              <link name="kod_razdel" as="kod_razdel1">
                <link name="kod_root" as="r_root1" />
              </link>
            </link>
          </link>
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="in">
            <column table="a" column="kod_node" />
            <query>
              <select>
                <column table="filter" column="kod_node" />
              </select>
              <from>
                <query name="25499-tree-filter" as="filter" hint="materialize">
                  <withparams>
                    <useparam name="kod_doc" />
                    <useparam name="kod_subject" />
                    <useparam name="kod_direct" />
                    <useparam name="pr_sbor" />
                    <useparam name="pr_child" />
                    <useparam name="kod_dirisp" />
                    <useparam name="pr_dont_show_wfp" />
                    <useparam name="year" />
                    <useparam name="kod_ofz" />
                  </withparams>
                </query>
              </from>
            </query>
          </call>
          <call function="and">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_all_razdel" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="is null">
              <column table="a" column="kod_titul_ip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="25499-tree-filter" timestamp="24.10.2016 17:14:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor">
          <const>1</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_dirisp" />
        <param name="pr_dont_show_wfp" />
        <param name="year" />
        <param name="kod_ofz" />
      </params>
      <select>
        <!--<call function="distinct" as="kod_node">
          <column table="a" column="kod_node"/>
        </call>-->
        <column table="a" column="kod_node" group="1" />
        <column table="a" column="kod_parent_node" group="1" />
      </select>
      <from>
        <query name="ipr_tree" as="a">
          <link name="kod_titul_ip">
            <dlink name="ipr_ipr_data">
              <link name="kod_main_titul" />
              <where>
                <call function="and">
                  <call function="=">
                    <column table="ipr_ipr_data" column="kod_doc_osn" />
                    <useparam name="kod_doc" />
                  </call>
                  <call function="in" optional="1">
                    <column table="kod_main_titul" column="kod_subject" />
                    <useparam name="kod_subject" />
                  </call>
                </call>
              </where>
            </dlink>
          </link>
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="pr_sbor" />
            <const>1</const>
          </withparams>
          <!--<dlink name="ipr_tree_childs">
          </dlink>-->
        </query>
      </from>
      <where>
        <call function="in" optional="1">
          <column table="kod_titul_ip" column="pr_ofz" />
          <useparam name="kod_ofz" />
        </call>
      </where>
      <connect>
        <call function="=">
          <column table="a" column="kod_node" />
          <column table="a" column="kod_parent_node" prior="1" />
        </call>
      </connect>
      <start>
        <call function="and">
          <call function="is not null">
            <column table="ipr_ipr_data" column="kod_ipr" dgroup="max" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="!=nvl">
            <column table="kod_titul_ip" column="is_head_tit" />
            <const>1</const>
          </call>
          <usepart part="25499-wfp-cond" />
          <!--<call function="=">
            <call function="nvl0">
              <column table="ipr_tree_childs" column="kod_node" dgroup="count"/>
            </call>          
            <const>0</const>
          </call>-->
        </call>
      </start>
    </query>
    <query name="25499-ipr-fp" materialize="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2015</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_titul_ip" group="1" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="not 0">
            <column table="a" column="kap_sum" />
            <column table="a" column="vvod_sum" />
            <column table="a" column="fp_sum" />
            <column table="a" column="dz" />
            <column table="a" column="kz" />
            <column table="a" column="nzs_saldo" />
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <!--<call function="between">
            <column table="a" column="year"/>
            <useparam name="year"/>
            <call function="+">
              <useparam name="year"/>
              <const>5</const>
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="25499-tree-pre-nofilter" timestamp="13.07.2017 14:08:11" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor">
          <const>1</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="year" />
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="kod_razdel" column="abbr" as="razdel_abbr" />
        <column table="kod_razdel" column="vid_full" as="razdel_vid_full" />
        <column table="kod_razdel" column="kod_razdel" if="root">
          <if pfx="_if_root">
            <call function="is null">
              <column table="kod_razdel" column="kod_parent" />
            </call>
          </if>
        </column>
        <column table="kod_titul_ip" column="tit_num_new" />
        <call function="if" as="itip" type="string" title="Тип титула">
          <call function="=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Одиночный/Дочерний'</const>
          </call>
          <call function="if">
            <call function="gt">
              <column table="kod_ipr" column="kod_parent" />
              <const>0</const>
            </call>
            <const>'Дочерний'</const>
            <const>'Одиночный'</const>
          </call>
          <column table="kod_titul_ip" column="itip" />
        </call>
        <column table="a" column="*" />
        <call function="nvl" as="har" type="string" title="Характеристика объекта ТПИР/НС">
          <column table="r_root" column="har" />
          <column table="r_root1" column="har" />
        </call>
        <column table="r_root_pp" column="abbr" as="prog" title="Отнесение к Программам" />
        <call function="coalesce" as="full_name" type="string">
          <column table="kod_titul_ip" column="full_name" />
          <column table="kod_razdel" column="full_name" />
          <const>'Все элементы'</const>
        </call>
      </select>
      <from>
        <query name="ipr_tree" as="a">
          <link name="kod_ipr">
            <link name="kod_main_titul" />
          </link>
          <link name="kod_razdel">
            <link name="kod_root" as="r_root" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_progpartner">
              <link name="kod_root" as="r_root_pp" />
            </link>
            <link name="kod_main" as="t_root">
              <link name="kod_razdel" as="kod_razdel1">
                <link name="kod_root" as="r_root1" />
              </link>
            </link>
          </link>
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="or" exclude="1">
          <call function="=1">
            <column table="kod_titul_ip" column="is_sbor" />
          </call>
          <call function="and">
            <call function="true" />
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
          </call>
        </call>
        <call function="and">
          <call function="true" />
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <call function="nvl">
              <column table="kod_main_titul" column="kod_subject" />
              <column table="kod_titul_ip" column="kod_subject" />
            </call>
            <useparam name="kod_subject" />
          </call>
        </call>
      </where>
    </query>
    <query name="26553" order="rwn" timestamp="24.10.2016 13:24:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <select>
        <usepart part="25499-columns" />
        <column table="dat" column="*" />
      </select>
      <from>
        <query name="25499-tree" as="tree">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="year" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="26553-dat" as="dat" join="left outer">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <undefined />
            <useparam name="kod_ofz" />
          </withparams>
          <using>
            <column column="kod_titul_ip" />
          </using>
        </query>
      </from>
    </query>
    <query name="26553-dat" timestamp="24.10.2016 11:49:05" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="pr_child" />
        <param name="kod_ofz" />
      </params>
      <select>
        <usepart part="25499-dat-kod_titul_ip" />
        <column table="kod_direct" column="name" as="direct_name" group="max" />
        <column table="kod_subject" column="name" as="subject_name" group="max" />
        <column table="obj_data" column="ekspluat_normativ_by_vo" dgroup="max" group="sum" />
        <column table="ipr_ipr_data" column="kvo_tr_do" group="sum" agg="sum" class-title="До реализации" />
        <column table="ipr_ipr_data" column="mark_tr_do" group="max" class-title="До реализации" />
        <column table="ipr_ipr_data" column="km_do" group="sum" class-title="До реализации" agg="sum" />
        <column table="ipr_ipr_data" column="km_kl_do" group="sum" class-title="До реализации" agg="sum" />
        <column table="ipr_ipr_data" column="pow_do" group="sum" class-title="До реализации" agg="sum" mp="-6" />
        <column table="ipr_ipr_data" column="other_do" group="sum" class-title="До реализации" agg="sum" />
        <column table="ipr_ipr_data" column="mark_kb_do" group="max" class-title="До реализации" />
        <column table="ipr_ipr_data" column="tip_op_do" group="max" class-title="До реализации" />
        <column table="ipr_ipr_data" column="kvo_tr" group="sum" class-title="Ввод" agg="sum" />
        <column table="ipr_ipr_data" column="mark_tr" group="max" class-title="Ввод" />
        <column table="ipr_ipr_data" column="km" group="sum" class-title="Ввод" agg="sum" />
        <column table="ipr_ipr_data" column="km_kl" group="sum" class-title="Ввод" agg="sum" />
        <column table="ipr_ipr_data" column="pow" group="sum" class-title="Ввод" agg="sum" mp="-6" />
        <column table="ipr_ipr_data" column="other" group="sum" class-title="Ввод" agg="sum" />
        <column table="ipr_ipr_data" column="mark_kb" group="max" class-title="Ввод" />
        <column table="ipr_ipr_data" column="tip_op" group="max" class-title="Ввод" />
        <column table="ipr_ipr_data" column="km_change" group="sum" class-title="Изменение" agg="sum" />
        <column table="ipr_ipr_data" column="km_kl_change" group="sum" class-title="Изменение" agg="sum" />
        <column table="ipr_ipr_data" column="pow_change" group="sum" class-title="Изменение" agg="sum" mp="-6" />
        <column table="ipr_ipr_data" column="other_change" group="sum" class-title="Изменение" agg="sum" />
        <column table="kap_data" column="plan_summ" dgroup="sum" group="sum" mp="-6" agg="sum" />
        <column table="kap_data" column="plan_summ_by_s" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="kap_data" column="plan_summ_by_k" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="kap_data" column="plan_summ_by_sk" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="fin_data" column="plan_summ_nds" dgroup="sum" group="sum" mp="-6" agg="sum" />
        <column table="fin_data" column="plan_summ_nds_by_s" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="fin_data" column="plan_summ_nds_by_k" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="fin_data" column="plan_summ_nds_by_sk" dgroup="sum" group="sum" agg="sum" mp="-6" />
        <column table="kod_kriteria" column="abbr" as="kriteria_name" title="Критерии включения объектов ИПР" group="max" />
        <column table="kod_priority_insert_ip" column="abbr" as="priority_name" title="Приоритеты включения объектов ИПР" group="max" />
        <column table="kod_klass" column="abbr_num" as="klass_name" title="Принадлежность к важн. объектам, программам" group="max" />
        <call function="nvl" as="god_vvod" type="number">
          <column table="ipr_vvod_head" column="year" dgroup="max" group="max" agg="no" />
          <column table="kod_titul_ip" column="end_year" group="max" />
        </call>
      </select>
      <from>
        <query name="ipr_ipr_data" as="ipr_ipr_data">
          <link name="kod_titul_ip">
            <dlink name="ipr_tituls_objects">
              <slink name="26553-obj" as="obj_data" />
            </dlink>
            <link name="kod_direct" />
            <link name="kod_subject" />
          </link>
          <link name="kod_main_titul" />
          <link name="kod_kriteria" />
          <link name="kod_priority_insert_ip" />
          <link name="kod_klass" />
          <dlink name="ipr_dogs">
            <dlink name="ipr_vid_zatrat_titul">
              <dlink name="ipr_kapitalvloz_head">
                <dlink name="ipr_kapitalvloz_body">
                  <slink name="26553-kap" as="kap_data" />
                </dlink>
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="ipr_kapitalvloz_head" column="pr_last" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="ipr_kapitalvloz_head" column="year" />
                      <useparam name="year" />
                    </call>
                  </call>
                </where>
              </dlink>
              <dlink name="ipr_finplan_head">
                <dlink name="ipr_finplan_body">
                  <slink name="26553-fin" as="fin_data" />
                </dlink>
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="ipr_finplan_head" column="pr_last" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="ipr_finplan_head" column="year" />
                      <useparam name="year" />
                    </call>
                  </call>
                </where>
              </dlink>
              <dlink name="ipr_vvod_head" />
            </dlink>
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="pr_last" />ex
            <const>1</const></call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
        </call>
      </where>
    </query>
    <query name="26553-obj" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <select>
        <column table="a" column="kod_tituls_object" />
        <column table="a" column="ekspluat_normativ" as="ekspluat_normativ_by_vo" dimname="vo">
          <pivot title=" по видам объектов">
            <column table="a" column="kod_vid_object" />
            <query>
              <select>
                <column table="b" column="kod_vid_object" />
                <column table="b" column="name" />
              </select>
              <from>
                <query name="ips_vid_object" as="b" />
              </from>
            </query>
          </pivot>
        </column>
      </select>
      <from>
        <query name="ipr_tituls_objects" as="a" />
      </from>
    </query>
    <query name="26553-kap" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <select>
        <column table="a" column="kod_kapitalvloz_body" />
        <column table="a" column="plan_summ" />
        <column table="a" column="plan_summ" as="plan_summ_by_s" dimname="s">
          <pivot title=" по статьям">
            <column table="kod_vid_zatrat" column="kod_smet" />
            <query>
              <select>
                <column table="a" column="kod_smet" />
                <column table="a" column="name" />
              </select>
              <from>
                <query name="ips_smet_struc_root" as="a" />
              </from>
            </query>
          </pivot>
        </column>
        <column table="a" column="plan_summ" as="plan_summ_by_k" dimname="k">
          <pivot title=" по кварталам">
            <call function="mes to kv">
              <column table="a" column="period" />
            </call>
            <query>
              <select>
                <column table="b" column="kvartal" />
                <column table="b" column="name" />
              </select>
              <from>
                <query name="kvartal" as="b" />
              </from>
            </query>
          </pivot>
        </column>
        <column table="a" column="plan_summ" as="plan_summ_by_sk" dimname="sk">
          <pivot title=" по кварталам и статьям">
            <call function="||" as="kod">
              <call function="mes to kv">
                <column table="a" column="period" />
              </call>
              <const>'_'</const>
              <column table="kod_vid_zatrat" column="kod_smet" />
            </call>
            <query order="b.kvartal,a.kod_smet">
              <select>
                <call function="||" as="kod">
                  <column table="b" column="kvartal" />
                  <const>'_'</const>
                  <column table="a" column="kod_smet" />
                </call>
                <call function="||" as="name">
                  <column table="b" column="name" />
                  <const>'|'</const>
                  <column table="a" column="name" />
                </call>
              </select>
              <from>
                <query name="kvartal" as="b" />
                <query name="ips_smet_struc_root" as="a" join="cross" />
              </from>
            </query>
          </pivot>
        </column>
      </select>
      <from>
        <query name="ipr_kapitalvloz_body" as="a">
          <link name="kod_kapitalvloz_head">
            <link name="kod_vid_zatrat_titul">
              <link name="kod_vid_zatrat">
                <link name="kod_smet" />
              </link>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="is null">
          <column table="kod_smet" column="kod_parent" />
        </call>
      </where>
    </query>
    <query name="26553-fin" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <select>
        <column table="a" column="kod_finplan_body" />
        <column table="a" column="plan_summ_nds" />
        <column table="a" column="plan_summ_nds" as="plan_summ_nds_by_s" dimname="s" />
        <column table="a" column="plan_summ_nds" as="plan_summ_nds_by_k" dimname="k" />
        <column table="a" column="plan_summ_nds" as="plan_summ_nds_by_sk" dimname="sk" />
      </select>
      <from>
        <query name="ipr_finplan_body" as="a">
          <link name="kod_finplan_head">
            <link name="kod_vid_zatrat_titul">
              <link name="kod_vid_zatrat">
                <link name="kod_smet" />
              </link>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="is null">
          <column table="kod_smet" column="kod_parent" />
        </call>
      </where>
    </query>
    <query name="26630-dat-new2" grouplevel="no" timestamp="11.01.2017 15:11:31" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <usepart part="26630-common-columns" />
        <column table="a" column="kod_smet" group="2" />
        <column table="kod_smet" column="name" as="smet_name" group="kod_smet" />
        <column table="a" column="kod_dog_i" group="3" />
        <column table="kod_dog_i" column="name_i" as="dog_i_name" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_i" as="dog_i_date" group="kod_dog_i" />
        <column table="a" column="kodzatrat" group="4" />
        <column table="kodzatrat" column="full_name" as="zatr_full_name" group="kodzatrat" />
        <column table="kodzatrat" column="kod_parent" as="zatr_parent" group="kodzatrat" />
        <column table="e_code" column="name" as="e_name" group="kod_dog_i" />
        <call function="nvl" as="status_name" group="kod_dog_i">
          <column table="status" column="name" />
          <!--<const>'-'</const>-->
          <call function="if">
            <call function="=">
              <column table="kod_ipr_dog" column="kod_dog_type" />
              <const>52</const>
            </call>
            <const>'-'</const>
            <const>'Плановый'</const>
          </call>
        </call>
        <column table="a" column="summ_k_rasp_usr" group="sum" mp="[:mp]" as="summ_usr" exclude="1" />
        <column table="a" column="summ_k_rasp_psd" group="sum" mp="[:mp]" as="summ_psd" exclude="1" />
        <call as="summ_psd" function="if" group="sum" mp="[:mp]">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="pr_tek_smet" />
            </call>
          </call>
          <call function="if">
            <call function="=1">
              <column table="a" column="pr_last_smet" />
            </call>
            <column table="a" column="summ_k_rasp_psd_tek" />
          </call>
          <column table="a" column="summ_k_rasp_psd" />
        </call>
        <call as="summ_usr" function="if" group="sum" mp="[:mp]">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="pr_tek_smet" />
            </call>
          </call>
          <call function="if">
            <call function="=1">
              <column table="a" column="pr_last_smet" />
            </call>
            <column table="a" column="summ_k_rasp_usr_tek" />
          </call>
          <column table="a" column="summ_k_rasp_usr" />
        </call>
        <column table="a" column="dog_plan_cost" group="sum" mp="[:mp]" master="kod_dog_i" />
        <call function="if" type="number" as="pr_plan" group="max">
          <call function="is not null">
            <column table="a" column="kod_ipr" />
          </call>
          <const>1</const>
        </call>
        <column table="a" column="dog_plan_cost_nds" group="sum" mp="[:mp]" master="kod_dog_i" />
        <!--Освоение-->
        <column table="a" column="kap_sum" as="kap_sum_god" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" if="god" colset="План">
          <usepart part="26630-if-god" />
        </column>
        <column table="a" column="kap_nds" as="kap_nds_god" title="Освоение капитальных вложений план НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="kap_sum" as="kap_sum_all" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" if="all" colset="План">
          <usepart part="26630-if-all" />
        </column>
        <column table="a" column="kap_sum" as="kap_sum_fix_all" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="kap_nds" as="kap_nds_all" title="Освоение капитальных вложений план НДС" group="sum" mp="[:mp]" if="all" colset="План" />
        <column table="a" column="kap_sum_itog" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" if="ng" colset="План">
          <usepart part="26630-if-ng" />
        </column>
        <column table="a" column="kap_nds_itog" title="Освоение капитальных вложений план НДС" group="sum" mp="[:mp]" if="ng" colset="План" />
        <column table="a" column="kap_sum_itog" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" if="eg" colset="План">
          <usepart part="26630-if-eg" />
        </column>
        <column table="a" column="kap_nds_itog" title="Освоение капитальных вложений план НДС" group="sum" mp="[:mp]" if="eg" colset="План" />
        <column table="a" column="kap_sum" as="kap_sum_by_per" title="Освоение капитальных вложений план без НДС" group="sum" mp="[:mp]" dimname="period" colset="План">
          <usepart part="26630-dim-period" />
        </column>
        <column table="a" column="kap_nds" as="kap_nds_by_per" title="Освоение капитальных вложений план НДС" group="sum" mp="[:mp]" dimname="period" colset="План" />
        <column table="a" column="debet_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" if="ng" colset="План" />
        <column table="a" column="kredit_itog_smet" group="sum" mp="[:mp]" title="Кредитроская задолженность план(на уровне сметы)" if="ng" colset="План" />
        <column table="a" column="debet_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне договора)" if="ng" colset="План" />
        <column table="a" column="kredit_itog_dog" group="sum" mp="[:mp]" title="Кредитроская задолженность план(на уровне договора)" if="ng" colset="План" />
        <column table="a" column="nzs_itog" group="sum" mp="[:mp]" title="НЗС" if="ng" colset="План" />
        <column table="a" column="debet_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" if="eg" colset="План" />
        <column table="a" column="kredit_itog_smet" group="sum" mp="[:mp]" title="Кредитроская задолженность план(на уровне сметы)" if="eg" colset="План" />
        <column table="a" column="debet_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне договора)" if="eg" colset="План" />
        <column table="a" column="kredit_itog_dog" group="sum" mp="[:mp]" title="Кредитроская задолженность план(на уровне договора)" if="eg" colset="План" />
        <column table="a" column="nzs_itog" group="sum" mp="[:mp]" title="НЗС" if="eg" colset="План" />
        <column table="a" column="debet_itog_smet" as="debet_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность план(на уровне сметы)" colset="План">
          <pivot title=" по кварталам">
            <section>
              <column table="dim" column="ym2" />
            </section>
            <!--<call function="=">
            <column table="a" column="ym" />
            <column table="dim" column="ym2" />
          </call>-->
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="26630_time_intervals" as="a">
                  <withparams>
                    <useparam name="year" />
                    <useparam name="mon1" />
                    <useparam name="mon2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="and">
                  <call function="in">
                    <column table="a" column="kod" />
                    <useparam name="period" />
                  </call>
                  <call function="=">
                    <column table="a" column="time_type" />
                    <const>'Квартал'</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="kredit_itog_smet" as="kredit_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредитроская задолженность план(на уровне сметы)" colset="План" />
        <column table="a" column="debet_itog_dog" as="debet_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность план(на уровне договора)" colset="План" />
        <column table="a" column="kredit_itog_dog" as="kredit_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредитроская задолженность план(на уровне договора)" colset="План" />
        <!--Ожидаемый факт-->
        <column table="a" column="kap_sum_wait" as="kap_sum_wait_god" title="Освоение капитальных вложений ожидаемый факт без НДС" group="sum" mp="[:mp]" if="god" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait" as="kap_nds_wait_god" title="Освоение капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="god" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum_wait" as="kap_sum_wait_all" title="Освоение капитальных вложений ожидаемый факт без НДС" group="sum" mp="[:mp]" if="all" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait" as="kap_nds_wait_all" title="Освоение капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="all" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum_wait_itog" title="Освоение капитальных вложений ожидаемый факт без НДС" group="sum" mp="[:mp]" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait_itog" title="Освоение капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum_wait_itog" title="Освоение капитальных вложений ожидаемый факт без НДС" group="sum" mp="[:mp]" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait_itog" title="Освоение капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum_wait" as="kap_sum_wait_by_per" title="Освоение капитальных вложений ожидаемый факт без НДС" group="sum" mp="[:mp]" dimname="period" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait" as="kap_nds_wait_by_per" title="Освоение капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" dimname="period" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность ожидаемый факт(на уровне сметы)" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_smet" group="sum" mp="[:mp]" title="Кредитроская задолженность ожидаемый факт(на уровне сметы)" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность ожидаемый факт(на уровне договора)" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_dog" group="sum" mp="[:mp]" title="Кредитроская задолженность ожидаемый факт(на уровне договора)" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="nzs_wait_itog" group="sum" mp="[:mp]" title="НЗС" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность ожидаемый факт(на уровне сметы)" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_smet" group="sum" mp="[:mp]" title="Кредитроская задолженность ожидаемый факт(на уровне сметы)" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность ожидаемый факт(на уровне договора)" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_dog" group="sum" mp="[:mp]" title="Кредитроская задолженность ожидаемый факт(на уровне договора)" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="nzs_wait_itog" group="sum" mp="[:mp]" title="НЗС" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_smet" as="debet_wt_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_smet" as="kredit_wt_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредитроская задолженность ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="debet_wait_itog_dog" as="debet_wt_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность ожидаемый факт(на уровне договора)" colset="Ожидаемый факт" />
        <column table="a" column="kredit_wait_itog_dog" as="kredit_wt_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредитроская задолженность ожидаемый факт(на уровне договора)" colset="Ожидаемый факт" />
        <column table="a" column="pow_mba_wait" group="sum" if="all" colset="Ожидаемый факт" title="Ввод мва  ожидаемый" />
        <column table="a" column="pow_km_wait" group="sum" if="all" colset="Ожидаемый факт" title="Ввод км  ожидаемый" />
        <call function="+nvl" group="sum" as="pow_km_all_wait" colset="Ожидаемый факт" title="Ввод км ожидаемый">
          <column table="this" column="pow_km_wait" />
          <column table="this" column="pow_km_kl_wait" />
        </call>
        <column table="a" column="pow_cnt_wait" group="sum" if="all" colset="Ожидаемый факт" title="Ввод шт. ожидаемый" />
        <column table="a" column="pow_cnt_proch_wait" group="sum" if="all" colset="Ожидаемый факт" title="Ввод шт. прочие  ожидаемый" />
        <column table="a" column="pow_mba_wait_pr" group="sum" if="all" colset="Ожидаемый факт" title="Прирост мва  ожидаемый" />
        <column table="a" column="pow_km_wait_pr" group="sum" if="all" colset="Ожидаемый факт" title="Прирост км  ожидаемый" />
        <call function="+nvl" group="sum" as="pow_km_all_wait_pr" colset="Ожидаемый факт" title="Прирост км  ожидаемый">
          <column table="this" column="pow_km_wait_pr" />
          <column table="this" column="pow_km_kl_wait_pr" />
        </call>
        <column table="a" column="pow_cnt_wait_pr" group="sum" if="all" colset="Ожидаемый факт" title="Прирост штук ожидаемый" />
        <column table="a" column="pow_cnt_proch_wait_pr" group="sum" if="all" colset="Ожидаемый факт" title="Прирост шт. прочие  ожидаемый" />
        <column table="a" column="pow_km_kl_wait" group="sum" if="all" colset="Ожидаемый факт" title="Ввод кл  ожидаемый" />
        <column table="a" column="pow_km_kl_wait_pr" group="sum" if="all" colset="Ожидаемый факт" title="Прирост кл  ожидаемый" />
        <!--Финансирование-->
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_god" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="fp_nds" as="fp_nds_god" title="Финансирование капитальных вложений план НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_all" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" if="all" colset="План" />
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_fix_all" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="fp_nds" as="fp_nds_all" title="Финансирование капитальных вложений план НДС" group="sum" mp="[:mp]" if="all" colset="План" />
        <column table="a" column="fp_sum_nds_itog" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" if="ng" colset="План" />
        <column table="a" column="fp_nds_itog" title="Финансирование капитальных вложений план НДС" group="sum" mp="[:mp]" if="ng" colset="План" />
        <column table="a" column="fp_sum_nds_itog" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" if="eg" colset="План" />
        <column table="a" column="fp_nds_itog" title="Финансирование капитальных вложений план НДС" group="sum" mp="[:mp]" if="eg" colset="План" />
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_by_per" title="Финансирование капитальных вложений план c НДС" group="sum" mp="[:mp]" dimname="period" colset="План" />
        <column table="a" column="fp_nds" as="fp_nds_by_per" title="Финансирование капитальных вложений план НДС" group="sum" mp="[:mp]" dimname="period" colset="План" />
        <!--Ожидаемый факт-->
        <column table="a" column="fp_sum_nds_wait" as="fp_sum_nds_wait_god" title="Финансирование капитальных вложений ожидаемый факт c НДС" group="sum" mp="[:mp]" if="god" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait" as="fp_nds_wait_god" title="Финансирование капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="god" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds_wait" as="fp_sum_nds_wait_all" title="Финансирование капитальных вложений ожидаемый факт c НДС" group="sum" mp="[:mp]" if="all" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait" as="fp_nds_wait_all" title="Финансирование капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="all" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds_wait_itog" title="Финансирование капитальных вложений ожидаемый факт c НДС" group="sum" mp="[:mp]" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait_itog" title="Финансирование капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="ng" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds_wait_itog" title="Финансирование капитальных вложений ожидаемый факт c НДС" group="sum" mp="[:mp]" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait_itog" title="Финансирование капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds_wait" as="fp_sum_nds_wait_by_per" title="Финансирование капитальных вложений ожидаемый факт c НДС" group="sum" mp="[:mp]" dimname="period" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait" as="fp_nds_wait_by_per" title="Финансирование капитальных вложений ожидаемый факт НДС" group="sum" mp="[:mp]" dimname="period" colset="Ожидаемый факт" />
        <!--Ввод-->
        <column table="a" column="vvod_sum" as="vvod_sum_god" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="vvod_sum" as="vvod_sum_all" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="all" colset="План" />
        <column table="a" column="vvod_sum" as="vvod_sum_fix_all" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="vvod_sum_itog" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="eg" colset="План" />
        <column table="a" column="vvod_sum" as="vvod_sum_by_per" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" dimname="period" colset="План" />
        <!--Ожидаемый факт-->
        <column table="a" column="vvod_sum_wait" as="vvod_sum_wait_god" title="Ввод в основные фонды ожидаемый факт без НДС" group="sum" mp="[:mp]" if="god" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum_wait" as="vvod_sum_wait_all" title="Ввод в основные фонды ожидаемый факт без НДС" group="sum" mp="[:mp]" if="all" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum_wait_itog" title="Ввод в основные фонды ожидаемый факт без НДС" group="sum" mp="[:mp]" if="eg" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum_wait" as="vvod_sum_wait_by_per" title="Ввод в основные фонды ожидаемый факт без НДС" group="sum" mp="[:mp]" dimname="period" colset="Ожидаемый факт" />
        <!--Факт-->
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_all" title="Освоение капитальных вложений факт без НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_fix_all" title="Освоение капитальных вложений факт без НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="kap_nds_fact" as="kap_nds_fact_all" title="Освоение капитальных вложений факт НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="kap_sum_fact_itog" title="Освоение капитальных вложений факт без НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="kap_nds_fact_itog" title="Освоение капитальных вложений факт НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="kap_sum_fact_itog" title="Освоение капитальных вложений факт без НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="kap_nds_fact_itog" title="Освоение капитальных вложений факт НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_by_per" title="Освоение капитальных вложений факт без НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <column table="a" column="kap_nds_fact" as="kap_nds_fact_by_per" title="Освоение капитальных вложений факт НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_all" title="Финансирование капитальных вложений факт c НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_fix_all" title="Финансирование капитальных вложений факт c НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="fp_nds_fact" as="fp_nds_fact_all" title="Финансирование капитальных вложений факт НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="fp_sum_nds_fact_itog" title="Финансирование капитальных вложений факт c НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="fp_nds_fact_itog" title="Финансирование капитальных вложений факт НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="fp_sum_nds_fact_itog" title="Финансирование капитальных вложений факт c НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="fp_nds_fact_itog" title="Финансирование капитальных вложений факт НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_by_per" title="Финансирование капитальных вложений факт c НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <column table="a" column="fp_nds_fact" as="fp_nds_fact_by_per" title="Финансирование капитальных вложений факт НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_all" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_fix_all" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="vvod_sum_fact_itog" title="Ввод факт без НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="vvod_sum_fact_itog" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_by_per" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <column table="a" column="debet_fact_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность факт(на уровне сметы)" if="ng" colset="Факт" />
        <column table="a" column="kredit_fact_itog_smet" group="sum" mp="[:mp]" title="Кредиторская задолженность факт(на уровне сметы)" if="ng" colset="Факт" />
        <column table="a" column="debet_fact_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность факт(на уровне договора)" if="ng" colset="Факт" />
        <column table="a" column="kredit_fact_itog_dog" group="sum" mp="[:mp]" title="Кредиторская задолженность факт(на уровне договора)" if="ng" colset="Факт" />
        <column table="a" column="nzs_fact_itog" group="sum" mp="[:mp]" title="НЗС" if="ng" colset="Факт" />
        <column table="a" column="debet_fact_itog_smet" group="sum" mp="[:mp]" title="Дебиторская задолженность факт(на уровне сметы)" if="eg" colset="Факт" />
        <column table="a" column="kredit_fact_itog_smet" group="sum" mp="[:mp]" title="Кредиторская задолженность факт(на уровне сметы)" if="eg" colset="Факт" />
        <column table="a" column="debet_fact_itog_dog" group="sum" mp="[:mp]" title="Дебиторская задолженность факт(на уровне договора)" if="eg" colset="Факт" />
        <column table="a" column="kredit_fact_itog_dog" group="sum" mp="[:mp]" title="Кредиторская задолженность факт(на уровне договора)" if="eg" colset="Факт" />
        <column table="a" column="nzs_fact_itog" group="sum" mp="[:mp]" title="НЗС" if="eg" colset="Факт" />
        <column table="a" column="debet_fact_itog_smet" as="debet_ft_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="kredit_fact_itog_smet" as="kredit_ft_itog_smet_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредиторская задолженность факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="debet_fact_itog_dog" as="debet_ft_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Дебиторская задолженность факт(на уровне договора)" colset="Факт" />
        <column table="a" column="kredit_fact_itog_dog" as="kredit_ft_itog_dog_by_per" group="sum" mp="[:mp]" dimname="kv" title="Кредиторская задолженность факт(на уровне договора)" colset="Факт" />
        <column table="a" column="pow_mba" group="sum" if="all" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km" group="sum" if="all" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all" colset="План" title="Ввод км  план">
          <column table="this" column="pow_km" />
          <column table="this" column="pow_km_kl" />
        </call>
        <column table="a" column="pow_km_kl" group="sum" if="all" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt" group="sum" if="all" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch" title="Ввод шт прочие план" group="sum" if="all" colset="План" />
        <column table="a" column="pow_mba_pr" group="sum" if="all" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr" group="sum" if="all" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr" group="sum" if="all" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr" colset="План" title="Прирост КМ  план">
          <column table="this" column="pow_km_pr" />
          <column table="this" column="pow_km_kl_pr" />
        </call>
        <column table="a" column="pow_cnt_pr" group="sum" if="all" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr" title="Прирост шт прочие план" group="sum" if="all" colset="План" />
        <column table="a" column="pow_mba_fact" group="sum" if="all" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact" group="sum" if="all" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact" colset="Факт" title="Ввод км факт">
          <column table="this" column="pow_km_fact" />
          <column table="this" column="pow_km_kl_fact" />
        </call>
        <column table="a" column="pow_cnt_fact" group="sum" if="all" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact" group="sum" if="all" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr" group="sum" if="all" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr" group="sum" if="all" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr" colset="Факт" title="Прирост КМ факт">
          <column table="this" column="pow_km_fact_pr" />
          <column table="this" column="pow_km_kl_fact_pr" />
        </call>
        <column table="a" column="pow_cnt_fact_pr" group="sum" if="all" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr" group="sum" if="all" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact" group="sum" if="all" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr" group="sum" if="all" colset="Факт" title="Прирост КЛ факт" />
        <!--<column table="a" column="pow_mba" as="pow_mba_by_per" group="sum" dimname="period" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km" as="pow_km_by_per"  group="sum" dimname="period" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_by_per" colset="План" title="Ввод км  план" dimname="period">
          <column table="a" column="pow_km" />
          <column table="a" column="pow_km_kl" />
        </call>
        <column table="a" column="pow_km_kl" as="pow_km_kl_by_per" group="sum" dimname="period" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt" as="pow_cnt_by_per" group="sum" dimname="period" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch" as="pow_cnt_proch_by_per" title="Ввод шт прочие план" group="sum" dimname="period" colset="План" />
        <column table="a" column="pow_mba_pr" as="pow_mba_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr" as="pow_km_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr" as="pow_km_kl_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_by_per" dimname="period" colset="План" title="Прирост КМ  план">
          <column table="a" column="pow_km_pr" />
          <column table="a" column="pow_km_kl_pr" />
        </call>
        <column table="a" column="pow_cnt_pr" as="pow_cnt_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr" as="pow_cnt_proch_pr_by_per" title="Прирост шт прочие план" group="sum" dimname="period" colset="План" />-->
        <!--<column table="a" column="pow_mba_fact" as="pow_mba_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact" as="pow_km_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_by_per" colset="Факт" title="Ввод км факт" dimname="period">
          <column table="a" column="pow_km_fact" />
          <column table="a" column="pow_km_kl_fact" />
        </call>
        <column table="a" column="pow_cnt_fact" as="pow_cnt_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact" as="pow_cnt_proch_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr"  as="pow_mba_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr" as="pow_km_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_by_per" colset="Факт" title="Прирост КМ факт" dimname="period">
          <column table="a" column="pow_km_fact_pr" />
          <column table="a" column="pow_km_kl_fact_pr" />
        </call>
        <column table="a" column="pow_cnt_fact_pr"  as="pow_cnt_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr"  as="pow_cnt_proch_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact"   as="pow_km_kl_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr"  as="pow_km_kl_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост КЛ факт" />-->
        <column table="a" column="kap_sum_fact_sp" as="kap_sum_fact_sp_by_per" group="sum" mp="[:mp]" dimname="kv" colset="Факт" />
        <column table="a" column="kap_sum_fact_per" as="kap_sum_fact_per_by_per" group="sum" mp="[:mp]" dimname="kv" colset="Факт" />
        <column table="a" column="kap_sum_fact_pri" as="kap_sum_fact_pri_by_per" group="sum" mp="[:mp]" dimname="kv" colset="Факт" />
        <call function="-nvl" as="kap_sum_fact_pp_by_per" group="sum" dimname="kv" title="Передано/принято" colset="Факт">
          <column table="a" column="kap_sum_fact_pri" mp="[:mp]" />
          <column table="a" column="kap_sum_fact_per" mp="[:mp]" />
        </call>
        <call function="" as="kap_sum_fact_null" group="sum" dimname="kv" colset="Факт" type="number">
          <const>null</const>
        </call>
        <column table="a" column="kap_sum_fact_sp" as="kap_sum_fact_sp_all" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="kap_sum_fact_per" as="kap_sum_fact_per_all" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="kap_sum_fact_pri" as="kap_sum_fact_pri_all" group="sum" mp="[:mp]" colset="Факт" />
        <call function="-nvl" as="kap_sum_fact_pp_all" group="sum" mp="[:mp]" if="all" title="Передано/принято" colset="Факт">
          <column table="a" column="kap_sum_fact_pri" />
          <column table="a" column="kap_sum_fact_per" />
        </call>
        <column table="ipr_planfactanaliz" column="kvl_prim" dgroup="stragg_dist" group="max" />
        <column table="ipr_planfactanaliz" column="fin_prim" dgroup="stragg_dist" group="max" />
        <column table="ipr_planfactanaliz" column="vv_prim" dgroup="stragg_dist" group="max" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere exclude="1">
            <call function="and">
              <call function="=">
                <column table="kod_doc_osn" column="kod_doc" />
                <useparam name="kod_doc" />
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="not" optional="1">
                <call function="=">
                  <column table="kod_titul_ip" column="kod_aip" />
                  <useparam name="pr_notaip" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_all_fact_not" />
                </call>
                <call function="is not null">
                  <column table="kod_ipr" column="kod_ipr" />
                </call>
              </call>
            </call>
          </extendwhere>
          <withparams exclude="1">
            <useparam name="kod_titul_ip" />
            <useparam name="year" />
          </withparams>
          <link name="kod_ipr" as="ipr_ipr_data">
            <dlink name="ipr_planfactanaliz">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="kod_doc" />
                    <useparam name="kod_doc" />
                  </call>
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="year" />
                    <useparam name="year" />
                  </call>
                  <call function="between">
                    <column table="ipr_planfactanaliz" column="kvart" />
                    <call function="mes to kv">
                      <useparam name="mon1" />
                    </call>
                    <call function="mes to kv">
                      <useparam name="mon2" />
                    </call>
                  </call>
                </call>
              </where>
            </dlink>
            <link name="kod_kriteria" exclude="1" />
            <link name="kod_priority_insert_ip" exclude="1" />
            <link name="kod_klass" exclude="1" />
            <link name="kod_status" />
          </link>
          <link name="kod_ipr_ext">
            <link name="kod_razdel" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" as="kod_subject_main" />
            <link name="kod_direct" as="kod_direct_main" />
            <link name="kod_ispolnit" as="kod_ispolnit_main" />
            <link name="kod_sbor_titul">
              <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
            </link>
          </link>
          <!--<link name="kod_dog"/>-->
          <link name="kod_smet" />
          <link name="kodzatrat" />
          <link name="kod_dog">
            <link name="e_code" />
            <link name="status" />
          </link>
          <link name="kod_dog_i" />
          <link name="kod_ipr_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_all_fact_not" />
            </call>
            <call function="=nvl">
              <column table="a" column="kod_ipr" />
              <column table="a" column="kod_ipr_ext" />
            </call>
          </call>
          <!--заменить на section-->
          <call function="or">
            <call function="is null">
              <column table="a" column="ym" />
            </call>
            <call function="and">
              <call function="le">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <const>12</const>
                </call>
              </call>
              <call function="or">
                <call function="ge">
                  <column table="a" column="ym" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="ge">
                  <column table="a" column="ym_nxt" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="is null">
                  <column table="a" column="ym_nxt" />
                </call>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="is not null" comment="химия. когда вырезается условие по подразделениям , дает ошибку из-за лишнего параметра">
            <useparam name="kod_dirisp" />
          </call>
          <!--<call function="between">
            <call function="nvl">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam  name="year"/>
                <useparam  name="mon1"/>
              </call>
            </call>
            <call function="ym2 add month">
              <call function="num to ym2">
                <useparam  name="year"/>
                <const>1</const>
              </call>
              <const>-1</const>
            </call>
            <call function="num to ym2">
              <useparam  name="year"/>
              <const>12</const>
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-dat-vvod-new-2" grouplevel="no" timestamp="14.01.2017 15:49:35" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <usepart part="26630-common-columns" />
        <column table="a" column="vvod_sum" as="vvod_sum_god" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="god" colset="План">
          <usepart part="26630-if-god" />
        </column>
        <column table="a" column="vvod_sum" as="vvod_sum_all" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="all" colset="План">
          <usepart part="26630-if-all" />
        </column>
        <column table="a" column="vvod_sum_itog" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="ng" colset="План">
          <usepart part="26630-if-ng" />
        </column>
        <column table="a" column="vvod_sum_itog" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" if="eg" colset="План">
          <usepart part="26630-if-eg" />
        </column>
        <column table="a" column="vvod_sum" as="vvod_sum_by_per" title="Ввод в основные фонды план без НДС" group="sum" mp="[:mp]" dimname="period" colset="План">
          <usepart part="26630-dim-period" />
        </column>
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_all" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" if="all" colset="Факт" />
        <column table="a" column="vvod_sum_fact_itog" title="Ввод факт без НДС" group="sum" mp="[:mp]" if="ng" colset="Факт" />
        <column table="a" column="vvod_sum_fact_itog" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" if="eg" colset="Факт" />
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_by_per" title="Ввод в основные фонды факт без НДС" group="sum" mp="[:mp]" dimname="period" colset="Факт" />
        <!--<column table="a" column="pow_mba_itog" group="sum" if="ng" colset="План" title="Ввод мва  план" />-->
        <column table="a" column="pow_any" as="pow_any_god" group="sum" if="god" colset="План" />
        <column table="a" column="pow_any" as="pow_any_all" group="sum" if="all" colset="План" />
        <column table="a" column="pow_any_itog" group="sum" if="ng" colset="План" />
        <column table="a" column="pow_any_itog" group="sum" if="eg" colset="План" />
        <column table="a" column="pow_any" as="pow_any_by_per" group="sum" dimname="period" colset="План" />
        <column table="a" column="pow_any_fact" as="pow_any_fact_all" group="sum" if="all" colset="Факт" />
        <column table="a" column="pow_any_fact_itog" group="sum" if="ng" colset="Факт" />
        <column table="a" column="pow_any_fact_itog" group="sum" if="eg" colset="Факт" />
        <column table="a" column="pow_any_fact" as="pow_any_fact_by_per" group="sum" dimname="period" colset="Факт" />
        <!--год-->
        <column table="a" column="pow_mba" as="pow_mba_god" group="sum" if="god" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km" as="pow_km_god" group="sum" if="god" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_god" colset="План" title="Ввод км  план">
          <column table="this" column="pow_km_god" />
          <column table="this" column="pow_km_kl_god" />
        </call>
        <column table="a" column="pow_km_kl" as="pow_km_kl_god" group="sum" if="god" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt" as="pow_cnt_god" group="sum" if="god" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch" as="pow_cnt_proch_god" title="Ввод шт прочие план" group="sum" if="god" colset="План" />
        <column table="a" column="pow_mba_pr" as="pow_mba_pr_god" group="sum" if="god" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr" as="pow_km_pr_god" group="sum" if="god" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr" as="pow_km_kl_pr_god" group="sum" if="god" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_god" colset="План" title="Прирост КМ  план">
          <column table="this" column="pow_km_pr_god" />
          <column table="this" column="pow_km_kl_pr_god" />
        </call>
        <column table="a" column="pow_cnt_pr" as="pow_cnt_pr_god" group="sum" if="god" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr" as="pow_cnt_proch_pr_god" title="Прирост шт прочие план" group="sum" if="god" colset="План" />
        <!--начало периода-->
        <column table="a" column="pow_mba_itog" group="sum" if="ng" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km_itog" group="sum" if="ng" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_itog_ng" colset="План" title="Ввод км  план">
          <column table="this" column="pow_km_itog_ng" />
          <column table="this" column="pow_km_kl_itog_ng" />
        </call>
        <column table="a" column="pow_km_kl_itog" group="sum" if="ng" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt_itog" group="sum" if="ng" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch_itog" title="Ввод шт прочие план" group="sum" if="ng" colset="План" />
        <column table="a" column="pow_mba_pr_itog" group="sum" if="ng" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr_itog" group="sum" if="ng" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr_itog" group="sum" if="ng" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_itog_ng" colset="План" title="Прирост КМ  план">
          <column table="this" column="pow_km_pr_itog_ng" />
          <column table="this" column="pow_km_kl_pr_itog_ng" />
        </call>
        <column table="a" column="pow_cnt_pr_itog" group="sum" if="ng" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr_itog" title="Прирост шт прочие план" group="sum" if="ng" colset="План" />
        <column table="a" column="pow_mba_fact_itog" group="sum" if="ng" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact_itog" group="sum" if="ng" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_itog_ng" colset="Факт" title="Ввод км факт">
          <column table="this" column="pow_km_fact_itog_ng" />
          <column table="this" column="pow_km_kl_fact_itog_ng" />
        </call>
        <column table="a" column="pow_cnt_fact_itog" group="sum" if="ng" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact_itog" group="sum" if="ng" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr_itog" group="sum" if="ng" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr_itog" group="sum" if="ng" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_itog_ng" colset="Факт" title="Прирост КМ факт">
          <column table="this" column="pow_km_fact_pr_itog_ng" />
          <column table="this" column="pow_km_kl_fact_pr_itog_ng" />
        </call>
        <column table="a" column="pow_cnt_fact_pr_itog" group="sum" if="ng" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr_itog" group="sum" if="ng" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact_itog" group="sum" if="ng" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr_itog" group="sum" if="ng" colset="Факт" title="Прирост КЛ факт" />
        <!--конец периода-->
        <column table="a" column="pow_mba_itog" group="sum" if="eg" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km_itog" group="sum" if="eg" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_itog_eg" colset="План" title="Ввод км  план">
          <column table="this" column="pow_km_itog_eg" />
          <column table="this" column="pow_km_kl_itog_eg" />
        </call>
        <column table="a" column="pow_km_kl_itog" group="sum" if="eg" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt_itog" group="sum" if="eg" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch_itog" title="Ввод шт прочие план" group="sum" if="eg" colset="План" />
        <column table="a" column="pow_mba_pr_itog" group="sum" if="eg" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr_itog" group="sum" if="eg" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr_itog" group="sum" if="eg" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_itog_eg" colset="План" title="Прирост КМ  план">
          <column table="this" column="pow_km_pr_itog_eg" />
          <column table="this" column="pow_km_kl_pr_itog_eg" />
        </call>
        <column table="a" column="pow_cnt_pr_itog" group="sum" if="eg" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr_itog" title="Прирост шт прочие план" group="sum" if="eg" colset="План" />
        <column table="a" column="pow_mba_fact_itog" group="sum" if="eg" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact_itog" group="sum" if="eg" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_itog_eg" colset="Факт" title="Ввод км факт">
          <column table="this" column="pow_km_fact_itog_eg" />
          <column table="this" column="pow_km_kl_fact_itog_eg" />
        </call>
        <column table="a" column="pow_cnt_fact_itog" group="sum" if="eg" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact_itog" group="sum" if="eg" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr_itog" group="sum" if="eg" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr_itog" group="sum" if="eg" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_itog_eg" colset="Факт" title="Прирост КМ факт">
          <column table="this" column="pow_km_fact_pr_itog_eg" />
          <column table="this" column="pow_km_kl_fact_pr_itog_eg" />
        </call>
        <column table="a" column="pow_cnt_fact_pr_itog" group="sum" if="eg" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr_itog" group="sum" if="eg" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact_itog" group="sum" if="eg" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr_itog" group="sum" if="eg" colset="Факт" title="Прирост КЛ факт" />
        <!--весь период-->
        <column table="a" column="pow_mba" as="pow_mba_all" group="sum" if="all" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km" as="pow_km_all" group="sum" if="all" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_all" colset="План" title="Ввод км  план">
          <column table="this" column="pow_km_all" />
          <column table="this" column="pow_km_kl_all" />
        </call>
        <column table="a" column="pow_km_kl" as="pow_km_kl_all" group="sum" if="all" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt" as="pow_cnt_all" group="sum" if="all" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch" as="pow_cnt_proch_all" title="Ввод шт прочие план" group="sum" if="all" colset="План" />
        <column table="a" column="pow_mba_pr" as="pow_mba_pr_all" group="sum" if="all" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr" as="pow_km_pr_all" group="sum" if="all" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr" as="pow_km_kl_pr_all" group="sum" if="all" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_all" colset="План" title="Прирост КМ  план">
          <column table="this" column="pow_km_pr_all" />
          <column table="this" column="pow_km_kl_pr_all" />
        </call>
        <column table="a" column="pow_cnt_pr" as="pow_cnt_pr_all" group="sum" if="all" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr" as="pow_cnt_proch_pr_all" title="Прирост шт прочие план" group="sum" if="all" colset="План" />
        <column table="a" column="pow_mba_fact" as="pow_mba_fact_all" group="sum" if="all" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact" as="pow_km_fact_all" group="sum" if="all" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_all" colset="Факт" title="Ввод км факт">
          <column table="this" column="pow_km_fact_all" />
          <column table="this" column="pow_km_kl_fact_all" />
        </call>
        <column table="a" column="pow_cnt_fact" as="pow_cnt_fact_all" group="sum" if="all" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact" as="pow_cnt_proch_fact_all" group="sum" if="all" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr" as="pow_mba_fact_pr_all" group="sum" if="all" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr" as="pow_km_fact_pr_all" group="sum" if="all" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_all" colset="Факт" title="Прирост КМ факт">
          <column table="this" column="pow_km_fact_pr_all" />
          <column table="this" column="pow_km_kl_fact_pr_all" />
        </call>
        <column table="a" column="pow_cnt_fact_pr" as="pow_cnt_fact_pr_all" group="sum" if="all" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr" as="pow_cnt_proch_fact_pr_all" group="sum" if="all" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact" as="pow_km_kl_fact_all" group="sum" if="all" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr" as="pow_km_kl_fact_pr_all" group="sum" if="all" colset="Факт" title="Прирост КЛ факт" />
        <!--по периодам-->
        <column table="a" column="pow_mba" as="pow_mba_by_per" group="sum" dimname="period" colset="План" title="Ввод мва  план" />
        <column table="a" column="pow_km" as="pow_km_by_per" group="sum" dimname="period" colset="План" title="Ввод ВЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_by_per" colset="План" title="Ввод км  план" dimname="period">
          <column table="a" column="pow_km" />
          <column table="a" column="pow_km_kl" />
        </call>
        <column table="a" column="pow_km_kl" as="pow_km_kl_by_per" group="sum" dimname="period" colset="План" title="Ввод КЛ  план" />
        <column table="a" column="pow_cnt" as="pow_cnt_by_per" group="sum" dimname="period" colset="План" title="Ввод шт  план" />
        <column table="a" column="pow_cnt_proch" as="pow_cnt_proch_by_per" title="Ввод шт прочие план" group="sum" dimname="period" colset="План" />
        <column table="a" column="pow_mba_pr" as="pow_mba_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост МВА  план" />
        <column table="a" column="pow_km_pr" as="pow_km_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост вл  план" />
        <column table="a" column="pow_km_kl_pr" as="pow_km_kl_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост КЛ  план" />
        <call function="+nvl" group="sum" as="pow_km_all_pr_by_per" dimname="period" colset="План" title="Прирост КМ  план">
          <column table="a" column="pow_km_pr" />
          <column table="a" column="pow_km_kl_pr" />
        </call>
        <column table="a" column="pow_cnt_pr" as="pow_cnt_pr_by_per" group="sum" dimname="period" colset="План" title="Прирост шт  план" />
        <column table="a" column="pow_cnt_proch_pr" as="pow_cnt_proch_pr_by_per" title="Прирост шт прочие план" group="sum" dimname="period" colset="План" />
        <column table="a" column="pow_mba_fact" as="pow_mba_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод мва факт" />
        <column table="a" column="pow_km_fact" as="pow_km_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод вл факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_by_per" colset="Факт" title="Ввод км факт" dimname="period">
          <column table="a" column="pow_km_fact" />
          <column table="a" column="pow_km_kl_fact" />
        </call>
        <column table="a" column="pow_cnt_fact" as="pow_cnt_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод шт факт" />
        <column table="a" column="pow_cnt_proch_fact" as="pow_cnt_proch_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод шт. прочие факт" />
        <column table="a" column="pow_mba_fact_pr" as="pow_mba_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост мва факт" />
        <column table="a" column="pow_km_fact_pr" as="pow_km_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост ВЛ факт" />
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_by_per" colset="Факт" title="Прирост КМ факт" dimname="period">
          <column table="a" column="pow_km_fact_pr" />
          <column table="a" column="pow_km_kl_fact_pr" />
        </call>
        <column table="a" column="pow_cnt_fact_pr" as="pow_cnt_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост шт. факт" />
        <column table="a" column="pow_cnt_proch_fact_pr" as="pow_cnt_proch_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост шт. прочие факт" />
        <column table="a" column="pow_km_kl_fact" as="pow_km_kl_fact_by_per" group="sum" dimname="period" colset="Факт" title="Ввод КЛ факт" />
        <column table="a" column="pow_km_kl_fact_pr" as="pow_km_kl_fact_pr_by_per" group="sum" dimname="period" colset="Факт" title="Прирост КЛ факт" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere exclude="1">
            <call function="and">
              <call function="=">
                <column table="kod_doc_osn" column="kod_doc" />
                <useparam name="kod_doc" />
              </call>
              <call function="=" exclude="1">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <const>7787</const>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="not" optional="1">
                <call function="=">
                  <column table="kod_titul_ip" column="kod_aip" />
                  <useparam name="pr_notaip" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_all_fact_not" />
                </call>
                <call function="is not null">
                  <column table="kod_ipr" column="kod_ipr" />
                </call>
              </call>
            </call>
          </extendwhere>
          <withparams>
            <useparam name="kod_titul_ip" />
            <useparam name="year" />
          </withparams>
          <link name="kod_ipr" as="ipr_ipr_data">
            <dlink name="ipr_planfactanaliz">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="kod_doc" />
                    <useparam name="kod_doc" />
                  </call>
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="year" />
                    <useparam name="year" />
                  </call>
                  <call function="between">
                    <column table="ipr_planfactanaliz" column="kvart" />
                    <call function="mes to kv">
                      <useparam name="mon1" />
                    </call>
                    <call function="mes to kv">
                      <useparam name="mon2" />
                    </call>
                  </call>
                </call>
              </where>
            </dlink>
            <link name="kod_kriteria" exclude="1" />
            <link name="kod_priority_insert_ip" exclude="1" />
            <link name="kod_klass" exclude="1" />
            <link name="kod_status" />
          </link>
          <link name="kod_ipr_ext">
            <link name="kod_razdel" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" as="kod_subject_main" />
            <link name="kod_direct" as="kod_direct_main" />
            <link name="kod_ispolnit" as="kod_ispolnit_main" />
            <link name="kod_sbor_titul">
              <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
            </link>
          </link>
          <link name="kod_smet" />
          <link name="kodzatrat" />
          <link name="kod_dog">
            <link name="e_code" />
            <link name="status" />
          </link>
          <link name="kod_dog_i" />
          <link name="kod_ipr_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_all_fact_not" />
            </call>
            <call function="=nvl">
              <column table="a" column="kod_ipr" />
              <column table="a" column="kod_ipr_ext" />
            </call>
          </call>
          <!--заменить на section-->
          <call function="or">
            <call function="is null">
              <column table="a" column="ym" />
            </call>
            <call function="and">
              <call function="le">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <const>12</const>
                </call>
              </call>
              <call function="or">
                <call function="ge">
                  <column table="a" column="ym" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="ge">
                  <column table="a" column="ym_nxt" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="is null">
                  <column table="a" column="ym_nxt" />
                </call>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="is not null" comment="химия. когда вырезается условие по подразделениям , дает ошибку из-за лишнего параметра">
            <useparam name="kod_dirisp" />
          </call>
          <!--<call function="between">
            <call function="nvl">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam  name="year"/>
                <useparam  name="mon1"/>
              </call>
            </call>
            <call function="ym2 add month">
              <call function="num to ym2">
                <useparam  name="year"/>
                <const>1</const>
              </call>
              <const>-1</const>
            </call>
            <call function="num to ym2">
              <useparam  name="year"/>
              <const>12</const>
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-dat-new3" grouplevel="no" timestamp="12.01.2018 01:10:48" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3-1.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <usepart part="26630-common-columns" />
        <call function="time ym2 id" as="ym_nxt_dog_id" group="9">
          <column table="a" column="ym_nxt_dog" />
        </call>
        <call function="time ym2 id" as="ym_nxt_smet_id" group="10">
          <column table="a" column="ym_nxt_smet" />
        </call>
        <column table="a" column="rn_dog" />
        <column table="a" column="rn_smet" />
        <column table="a" column="kod_smet" group="2" />
        <column table="kod_smet" column="name" as="smet_name" group="kod_smet" />
        <column table="a" column="kod_dog_i" group="3" />
        <column table="kod_dog_i" column="name_i" as="dog_i_name" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_i" as="dog_i_date" group="kod_dog_i" />
        <column table="a" column="kodzatrat" group="4" />
        <column table="kodzatrat" column="full_name" as="zatr_full_name" group="kodzatrat" />
        <column table="kodzatrat" column="kod_parent" as="zatr_parent" group="kodzatrat" />
        <column table="e_code" column="name" as="e_name" group="kod_dog_i" />
        <call function="nvl" as="status_name" group="kod_dog_i">
          <column table="status" column="name" />
          <!--<const>'-'</const>-->
          <call function="if">
            <call function="=">
              <column table="kod_ipr_dog" column="kod_dog_type" />
              <const>52</const>
            </call>
            <const>'-'</const>
            <const>'Плановый'</const>
          </call>
        </call>
        <column table="a" column="summ_k_rasp_usr" group="sum" mp="[:mp]" as="summ_usr" exclude="1" />
        <column table="a" column="summ_k_rasp_psd" group="sum" mp="[:mp]" as="summ_psd" exclude="1" />
        <call as="summ_psd" function="if" group="sum" mp="[:mp]">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="pr_tek_smet" />
            </call>
          </call>
          <call function="if">
            <call function="=1">
              <column table="a" column="pr_last_smet" />
            </call>
            <column table="a" column="summ_k_rasp_psd_tek" />
          </call>
          <column table="a" column="summ_k_rasp_psd" />
        </call>
        <call as="summ_usr" function="if" group="sum" mp="[:mp]">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="pr_tek_smet" />
            </call>
          </call>
          <call function="if">
            <call function="=1">
              <column table="a" column="pr_last_smet" />
            </call>
            <column table="a" column="summ_k_rasp_usr_tek" />
          </call>
          <column table="a" column="summ_k_rasp_usr" />
        </call>
        <column table="a" column="dog_plan_cost" group="sum" mp="[:mp]" master="kod_dog_i" />
        <call function="if" type="number" as="pr_plan" group="max">
          <call function="is not null">
            <column table="a" column="kod_ipr" />
          </call>
          <const>1</const>
        </call>
        <const as="empty" group="sum" type="number">null</const>
        <column table="a" column="dog_plan_cost_nds" group="sum" mp="[:mp]" master="kod_dog_i" />
        <!--ДЗ КЗ НЗС-->
        <column table="a" column="saldo_itog" as="sld_pl_sn_cm" group="sum" mp="[:mp]" title="Сальдо" colset="План" />
        <column table="a" column="saldo_wait_itog" as="sld_wf_sn_cm" group="sum" mp="[:mp]" title="Сальдо" colset="Ожидаемый факт" />
        <column table="a" column="saldo_fact_itog" as="sld_ft_sn_cm" group="sum" mp="[:mp]" title="Сальдо" colset="Факт" />
        <column table="a" column="deb_smet" as="smet_dz_pl_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" colset="План" />
        <column table="a" column="kred_smet" as="smet_kz_pl_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" colset="План" />
        <column table="a" column="deb_dog" as="dog_dz_pl_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" colset="План" />
        <column table="a" column="kred_dog" as="dog_kz_pl_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность план(на уровне сметы)" colset="План" />
        <column table="a" column="nzs_itog" as="nzs_pl_bn_cm" group="sum" mp="[:mp]" title="НЗС" colset="План" />
        <column table="a" column="deb_wait_smet" as="smet_dz_wf_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="kred_wait_smet" as="smet_kz_wf_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="deb_wait_dog" as="dog_dz_wf_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="kred_wait_dog" as="dog_kz_wf_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Ожидаемый факт(на уровне сметы)" colset="Ожидаемый факт" />
        <column table="a" column="nzs_wait_itog" as="nzs_wf_bn_cm" group="sum" mp="[:mp]" title="НЗС" colset="Ожидаемый факт" />
        <column table="a" column="deb_fact_smet" as="smet_dz_ft_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="kred_fact_smet" as="smet_kz_ft_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="deb_fact_dog" as="dog_dz_ft_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="kred_fact_dog" as="dog_kz_ft_sn_cm" group="sum" mp="[:mp]" title="Дебиторская задолженность Факт(на уровне сметы)" colset="Факт" />
        <column table="a" column="nzs_fact_c_itog" as="nzs_ft_bn_cm" group="sum" mp="[:mp]" title="НЗС" colset="Факт" />
        <!--Освоение-План-->
        <column table="a" column="kap_sum" as="os_pl_bn_gd" title="Освоение план без НДС" group="sum" mp="[:mp]" if="god" colset="План">
          <usepart part="26630-if-god" />
        </column>
        <column table="a" column="kap_nds" as="os_pl_nn_gd" title="Освоение план НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="kap_sum" as="kap_sum_fix_all" title="Освоение план без НДС" group="sum" mp="[:mp]" if="all">
          <usepart part="26630-if-all" />
        </column>
        <column table="a" column="kap_sum_itog" as="os_pl_bn_cm" title="Освоение план без НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="kap_nds_itog" as="os_pl_nn_cm" title="Освоение план НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="kap_sum" as="os_pl_bn" title="Освоение план без НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="kap_nds" as="os_pl_nn" title="Освоение план НДС" group="sum" mp="[:mp]" colset="План" />
        <!--Освоение-Ожидаемый факт-->
        <column table="a" column="kap_sum_wait_itog" as="os_wf_bn_cm" title="Освоение Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait_itog" as="os_wf_nn_cm" title="Освоение Ожидаемый факт НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum_wait" as="os_wf_bn" title="Освоение Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="kap_nds_wait" as="os_wf_nn" title="Освоение Ожидаемый факт НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <!--Освоение-Факт-->
        <column table="a" column="kod_schet_y" as="kod_schet" />
        <call function="if" as="kod_schet_vvod" type="number">
          <call function="=">
            <column table="kod_razdel" column="kod_root" />
            <const>246</const>
          </call>
          <const>4</const>
          <const>1</const>
        </call>
        <!--<column table="a" column="kap_sum_fact_b"  as="os_ft_bn_b"/>
        <column table="a" column="kap_nds_fact_b"  as="os_ft_nn_b"/>-->
        <call function="-nvl" as="os_ft_bn_b">
          <column table="a" column="kap_sum_fact_b" />
          <column table="this" column="nzs_pp_pg" />
        </call>
        <call function="-nvl" as="os_ft_nn_b">
          <column table="a" column="kap_nds_fact_b" />
          <column table="this" column="nzs_nn_pp_pg" />
        </call>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s1" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s1" colset="Факт">
          <if>
            <call function="and">
              <call function="=">
                <column table="this" column="kod_schet" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s2" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s2" colset="Факт">
          <if>
            <call function="and">
              <call function="=">
                <column table="this" column="kod_schet" />
                <const>2</const>
              </call>
            </call>
          </if>
        </column>
        <!--<call function="or">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>3</array>
              </call>
              <call function="and">
                <call function="le">
                  <column table="a" column="ym" />
                  <const>201709</const>
                </call>
                <call function="in">
                  <column table="this" column="kod_schet" />
                  <array>6,7</array>
                </call>
              </call>
            </call>-->
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s3" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s3" colset="Факт">
          <if>
            <call function="and">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>3,6,7</array>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s3_n" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s3_n" colset="Факт">
          <if>
            <call function="and">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>3</array>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s6" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s6" colset="Факт">
          <if>
            <call function="and">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>6</array>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s7" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s7" colset="Факт">
          <if>
            <call function="and">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>7</array>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s4" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s4" colset="Факт">
          <if>
            <call function="and">
              <call function="=">
                <column table="this" column="kod_schet" />
                <const>4</const>
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="os_ft_bn_b" as="os_ft_bn_s5" title="Освоение Факт без НДС" group="sum" mp="[:mp]" if="s5" colset="Факт">
          <if>
            <call function="and">
              <call function="=">
                <column table="this" column="kod_schet" />
                <const>5</const>
              </call>
            </call>
          </if>
        </column>
        <!--<call function="if">
          
        </call>-->
        <column table="a" column="kap_sum_fact_d" as="os_ft_bn" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_d" as="os_ft_nn" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_sum_fact_d" as="kap_sum_fact_fix_all" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="kap_sum_fact_n" as="os_ft_bn_n" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_n" as="os_ft_nn_n" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_sum_fact_n" as="kap_sum_fact_fix_all_n" group="sum" mp="[:mp]" if="all" />
        <!--1-->
        <column table="a" column="kap_sum_fact_b_itog" as="os_ft_bn_cm_b" />
        <column table="a" column="kap_nds_fact_b_itog" as="os_nn_bn_cm_b" />
        <column table="a" column="kap_sum_fact_itog" as="os_ft_bn_cm_b_n" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s1" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s1" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s2" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s2" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s3" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s3" />
        <column table="this" column="os_ft_bn_cm_b_n" as="os_ft_bn_cm_s3_n" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s3_n" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s4" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s4" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s5" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s5" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s6" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s6" />
        <column table="this" column="os_ft_bn_cm_b" as="os_ft_bn_cm_s7" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s7" />
        <column table="a" column="kap_sum_fact_c_itog" as="os_ft_bn_cm" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_c_itog" as="os_ft_nn_cm" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_sum_fact_itog" as="os_ft_bn_cm_n" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_itog" as="os_ft_nn_cm_n" title="Освоение Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--Финансирование-План-->
        <column table="a" column="fp_sum_nds" as="fn_pl_sn_gd" title="Финансирование план без НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="fp_nds" as="fn_pl_nn_gd" title="Финансирование план НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="fp_sum_nds" as="fp_sum_nds_fix_all" title="Финансирование план без НДС" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="fp_sum_nds_itog" as="fn_pl_sn_cm" title="Финансирование план без НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="fp_nds_itog" as="fn_pl_nn_cm" title="Финансирование план НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="fp_sum_nds" as="fn_pl_sn" title="Финансирование план без НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="fp_nds" as="fn_pl_nn" title="Финансирование план НДС" group="sum" mp="[:mp]" colset="План" />
        <!--Финансирование-Ожидаемый факт-->
        <column table="a" column="fp_sum_nds_wait_itog" as="fn_wf_sn_cm" title="Финансирование Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait_itog" as="fn_wf_nn_cm" title="Финансирование Ожидаемый факт НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds_wait" as="fn_wf_sn" title="Финансирование Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="fp_nds_wait" as="fn_wf_nn" title="Финансирование Ожидаемый факт НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <!--Финансирование-Факт-->
        <column table="a" column="fp_sum_nds_fact_b" as="fn_ft_sn_b" />
        <column table="a" column="fp_nds_fact_b" as="fn_ft_nn_b" />
        <column table="this" column="fn_ft_sn_b" as="fp_sum_nds_fact_fix_all" title="Финансирование Факт НДС" group="sum" mp="[:mp]" if="all" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn_s1" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" if="s1" colset="Факт" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn_s2" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" if="s2" colset="Факт" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn_s3" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" if="s3" colset="Факт" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn_s4" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" if="s4" colset="Факт" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn_s5" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" if="s5" colset="Факт" />
        <column table="this" column="fn_ft_sn_b" as="fn_ft_sn" title="Финансирование Факт без НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--1-->
        <column table="this" column="fn_ft_nn_b" as="fn_ft_nn" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--1-->
        <!--1-->
        <!--1-->
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm_s1" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s1" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm_s2" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s2" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm_s3" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s3" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm_s4" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s4" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm_s5" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" if="s5" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fn_ft_sn_cm" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--1-->
        <column table="a" column="fp_nds_fact_itog" as="fn_ft_nn_cm" title="Финансирование Факт НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--Ввод-План-->
        <column table="a" column="vvod_sum" as="vvod_sum_fix_all" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="vvod_sum" as="vv_pl_bn_gd" title="Ввод план без НДС" group="sum" mp="[:mp]" if="god" colset="План" />
        <column table="a" column="vvod_sum_itog" as="vv_pl_bn_cm" title="Ввод план без НДС" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="vvod_sum" as="vv_pl_bn" title="Ввод план без НДС" group="sum" mp="[:mp]" colset="План" />
        <!--Ввод-Ожидаемый факт-->
        <column table="a" column="vvod_sum_wait_itog" as="vv_wf_bn_cm" title="Ввод Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum_wait" as="vv_wf_bn" title="Ввод Ожидаемый факт без НДС" group="sum" mp="[:mp]" colset="Ожидаемый факт" />
        <!--Ввод-Факт-->
        <column table="a" column="vvod_sum_fact" as="vv_ft_bn_s1" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" if="vs1">
          <if>
            <call function="=">
              <column table="this" column="kod_schet_vvod" />
              <const>1</const>
            </call>
          </if>
        </column>
        <column table="a" column="vvod_sum_fact" as="vv_ft_bn_s4" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" if="vs4">
          <if>
            <call function="=">
              <column table="this" column="kod_schet_vvod" />
              <const>4</const>
            </call>
          </if>
        </column>
        <column table="a" column="vvod_sum_fact_itog" as="vv_ft_bn_cm_s4" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" if="vs4" />
        <column table="a" column="vvod_sum_fact_itog" as="vv_ft_bn_cm_s1" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" if="vs1" />
        <column table="a" column="vvod_sum_fact" as="vvod_sum_fact_fix_all" group="sum" mp="[:mp]" if="all" />
        <column table="a" column="vvod_sum_fact_itog" as="vv_ft_bn_cm" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="vvod_sum_fact" as="vv_ft_bn" title="Ввод Факт без НДС" group="sum" mp="[:mp]" colset="Факт" />
        <!--Списание прием передача-->
        <!--Списание прием передача-Деньги-->
        <column table="a" column="kap_sum_fact_sp" as="nzs_sp_ag" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_sum_fact_pp" as="nzs_pp_ag" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_pp" as="nzs_nn_pp_ag" group="sum" mp="[:mp]" colset="Факт" />
        <call function="if" as="fin_sp_ag" group="sum" mp="[:mp]" colset="Факт">
          <call function="=1">
            <column table="a" column="pr_opl_spis" />
          </call>
          <column table="a" column="fp_sum_nds_fact" />
        </call>
        <column table="a" column="fp_sum_nds_fact_pp" as="fin_pp_ag" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="fp_nds_fact_pp" as="fin_nn_pp_ag" group="sum" mp="[:mp]" colset="Факт" />
        <!--чтобы определить if ы-->
        <column table="a" column="kap_sum_fact_sp" as="kap_sum_fact_sp_pr" group="sum" mp="[:mp]" colset="Факт" if="pr_god">
          <if>
            <call function="lt">
              <call function="ym2 god">
                <column table="a" column="ym_vozn" />
              </call>
              <call function="ym2 god">
                <column table="a" column="ym" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact_sp" as="kap_sum_fact_sp_tek" group="sum" mp="[:mp]" colset="Факт" if="tek_god">
          <if>
            <call function="=">
              <call function="ym2 god">
                <column table="a" column="ym_vozn" />
              </call>
              <call function="ym2 god">
                <column table="a" column="ym" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="fp_sum_nds_fact_pp_pg" as="fin_pp_pg" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="fp_nds_fact_pp_pg" as="fin_nn_pp_pg" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_sum_fact_pp_pg" as="nzs_pp_pg" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="kap_nds_fact_pp_pg" as="nzs_nn_pp_pg" group="sum" mp="[:mp]" colset="Факт" />
        <!--<column table="this" column="nzs_sp_ag" as="nzs_sp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="fin_pp_ag" as="fin_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="fin_nn_pp_ag" as="fin_nn_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="nzs_pp_ag" as="nzs_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />-->
        <column table="this" column="nzs_sp_ag" as="nzs_sp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="nzs_sp_ag" as="nzs_sp_tg" group="sum" mp="[:mp]" if="tek_god" colset="Факт" />
        <column table="this" column="nzs_pp_ag" as="nzs_pp_tg" group="sum" mp="[:mp]" if="tek_god" colset="Факт" />
        <column table="this" column="fin_pp_ag" as="fin_pp_tg" group="sum" mp="[:mp]" if="tek_god" colset="Факт" />
        <!--Причины отклонения-->
        <column table="ipr_planfactanaliz" column="kvl_prim" as="os_prich_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="ipr_planfactanaliz" column="fin_prim" as="fn_prich_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="ipr_planfactanaliz" column="vv_prim" as="vv_prich_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="kvl_krit" column="full_name1" as="os_krm_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="fin_krit" column="full_name1" as="fn_krm_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="vv_krit" column="full_name1" as="vv_krm_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="kvl_krit" column="full_name" as="os_krr_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="fin_krit" column="full_name" as="fn_krr_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="vv_krit" column="full_name" as="vv_krr_0" dgroup="stragg_dist" group="max" exclude="1" />
        <column table="pfa" column="os_prich_0" exclude="1" />
        <column table="pfa" column="fn_prich_0" exclude="1" />
        <column table="pfa" column="vv_prich_0" exclude="1" />
        <column table="pfa" column="os_krm_0" exclude="1" />
        <column table="pfa" column="fn_krm_0" exclude="1" />
        <column table="pfa" column="vv_krm_0" exclude="1" />
        <column table="pfa" column="os_krr_0" exclude="1" />
        <column table="pfa" column="fn_krr_0" exclude="1" />
        <column table="pfa" column="vv_krr_0" exclude="1" />
        <column table="a" column="kod_ipr" group="max" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere exclude="1">
            <call function="and">
              <call function="=">
                <column table="kod_doc_osn" column="kod_doc" />
                <useparam name="kod_doc" />
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="not" optional="1">
                <call function="=">
                  <column table="kod_titul_ip" column="kod_aip" />
                  <useparam name="pr_notaip" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_all_fact_not" />
                </call>
                <call function="is not null">
                  <column table="kod_ipr" column="kod_ipr" />
                </call>
              </call>
            </call>
          </extendwhere>
          <withparams exclude="1">
            <useparam name="kod_titul_ip" />
            <useparam name="year" />
          </withparams>
          <link name="check_pl_ft" />
          <link name="kod_ipr" as="ipr_ipr_data">
            <dlink name="ipr_planfactanaliz" exclude="1">
              <link name="kvl_krit" />
              <link name="vv_krit" />
              <link name="fin_krit" />
              <where>
                <call function="and">
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="kod_doc" />
                    <useparam name="kod_doc" />
                  </call>
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="year" />
                    <useparam name="year" />
                  </call>
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="kvart" />
                    <!--<call function="mes to kv">
                      <useparam name="mon1" />
                    </call>-->
                    <call function="mes to kv">
                      <useparam name="mon2" />
                    </call>
                  </call>
                </call>
              </where>
            </dlink>
            <link name="kod_kriteria" exclude="1" />
            <link name="kod_priority_insert_ip" exclude="1" />
            <link name="kod_klass" exclude="1" />
            <link name="kod_status" />
          </link>
          <link name="kod_ipr_ext">
            <link name="kod_razdel" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" as="kod_subject_main" />
            <link name="kod_direct" as="kod_direct_main" />
            <link name="kod_ispolnit" as="kod_ispolnit_main" />
            <link name="kod_sbor_titul">
              <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
            </link>
          </link>
          <!--<link name="kod_dog"/>-->
          <link name="kod_smet" />
          <link name="kodzatrat" />
          <link name="kod_dog">
            <link name="e_code" />
            <link name="status" />
          </link>
          <link name="kod_dog_i" />
          <link name="kod_ipr_dog" />
        </query>
        <query name="26630-dat-new3-pfa" as="pfa" join="left outer" exclude="1">
          <call function="=">
            <column table="a" column="kod_ipr" />
            <column table="pfa" column="kod_ipr" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_titul_ip" />
            <useparam name="kod2_titul_ip" />
          </call>
          <call function="or" optional="1" exclude="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_all_fact_not" />
            </call>
            <call function="=nvl">
              <column table="a" column="kod_ipr" />
              <column table="a" column="kod_ipr_ext" />
            </call>
          </call>
          <!--заменить на section-->
          <call function="or">
            <call function="is null">
              <column table="a" column="ym" />
            </call>
            <call function="and">
              <call function="le">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <const>12</const>
                </call>
              </call>
              <call function="or">
                <call function="ge">
                  <column table="a" column="ym" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="ge">
                  <column table="a" column="ym_nxt" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="is null">
                  <column table="a" column="ym_nxt" />
                </call>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="is not null" comment="химия. когда вырезается условие по подразделениям , дает ошибку из-за лишнего параметра">
            <useparam name="kod_dirisp" />
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_no_zero" />
            </call>
            <call function="!=">
              <column table="this" column="pr_check_plan_fact" />
              <const>3</const>
            </call>
          </call>
          <!--<call function="between">
            <call function="nvl">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam  name="year"/>
                <useparam  name="mon1"/>
              </call>
            </call>
            <call function="ym2 add month">
              <call function="num to ym2">
                <useparam  name="year"/>
                <const>1</const>
              </call>
              <const>-1</const>
            </call>
            <call function="num to ym2">
              <useparam  name="year"/>
              <const>12</const>
            </call>
          </call>-->
        </call>
        <call function="false" exclude="1" />
      </where>
    </query>
    <query name="26630-dat-new3-pfa" grouplevel="no" timestamp="22.01.2018 19:24:36" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3-1.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="kod_ipr" column="kod_ipr" group="1" />
        <!--ДЗ КЗ НЗС-->
        <!--Освоение-План-->
        <!--Освоение-Ожидаемый факт-->
        <!--Освоение-Факт-->
        <!--<column table="a" column="kap_sum_fact_b"  as="os_ft_bn_b"/>
        <column table="a" column="kap_nds_fact_b"  as="os_ft_nn_b"/>-->
        <!--<call function="or">
              <call function="in">
                <column table="this" column="kod_schet" />
                <array>3</array>
              </call>
              <call function="and">
                <call function="le">
                  <column table="a" column="ym" />
                  <const>201709</const>
                </call>
                <call function="in">
                  <column table="this" column="kod_schet" />
                  <array>6,7</array>
                </call>
              </call>
            </call>-->
        <!--<call function="if">
          
        </call>-->
        <!--1-->
        <!--Финансирование-План-->
        <!--Финансирование-Ожидаемый факт-->
        <!--Финансирование-Факт-->
        <!--1-->
        <!--1-->
        <!--1-->
        <!--1-->
        <!--1-->
        <!--Ввод-План-->
        <!--Ввод-Ожидаемый факт-->
        <!--Ввод-Факт-->
        <!--Списание прием передача-->
        <!--Списание прием передача-Деньги-->
        <!--чтобы определить if ы-->
        <!--<column table="this" column="nzs_sp_ag" as="nzs_sp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="fin_pp_ag" as="fin_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="fin_nn_pp_ag" as="fin_nn_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />
        <column table="this" column="nzs_pp_ag" as="nzs_pp_pg" group="sum" mp="[:mp]" if="pr_god" colset="Факт" />-->
        <!--Причины отклонения-->
        <column table="ipr_planfactanaliz" column="kvl_prim" as="os_prich_0" dgroup="stragg_dist" group="stragg" />
        <column table="ipr_planfactanaliz" column="fin_prim" as="fn_prich_0" dgroup="stragg_dist" group="stragg" />
        <column table="ipr_planfactanaliz" column="vv_prim" as="vv_prich_0" dgroup="stragg_dist" group="stragg" />
        <column table="kvl_krit" column="full_name1" as="os_krm_0" dgroup="stragg_dist" group="stragg" />
        <column table="fin_krit" column="full_name1" as="fn_krm_0" dgroup="stragg_dist" group="stragg" />
        <column table="vv_krit" column="full_name1" as="vv_krm_0" dgroup="stragg_dist" group="stragg" />
        <column table="kvl_krit" column="full_name" as="os_krr_0" dgroup="stragg_dist" group="stragg" />
        <column table="fin_krit" column="full_name" as="fn_krr_0" dgroup="stragg_dist" group="stragg" />
        <column table="vv_krit" column="full_name" as="vv_krr_0" dgroup="stragg_dist" group="stragg" />
      </select>
      <from>
        <query name="ipr_planfactanaliz">
          <link name="kod_ipr" />
          <link name="kvl_krit" />
          <link name="vv_krit" />
          <link name="fin_krit" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_planfactanaliz" column="kod_doc" />
            <useparam name="kod_doc" />
          </call>
          <call function="=">
            <column table="ipr_planfactanaliz" column="year" />
            <useparam name="year" />
          </call>
          <call function="=">
            <column table="ipr_planfactanaliz" column="kvart" />
            <!--<call function="mes to kv">
                      <useparam name="mon1" />
                    </call>-->
            <call function="mes to kv">
              <useparam name="mon2" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-dat-grsets-new3" timestamp="03.06.2021 14:04:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="-nvl" as="os_otkl_0">
          <column table="this" column="kap_sum_fact_fix_all" />
          <column table="this" column="kap_sum_fix_all" />
        </call>
        <call function="-nvl" as="os_otkl_n_0">
          <column table="this" column="kap_sum_fact_fix_all_n" />
          <column table="this" column="kap_sum_fix_all" />
        </call>
        <call function="-nvl" as="fn_otkl_0">
          <column table="this" column="fp_sum_nds_fact_fix_all" />
          <column table="this" column="fp_sum_nds_fix_all" />
        </call>
        <call function="-nvl" as="vv_otkl_0">
          <column table="this" column="vvod_sum_fact_fix_all" />
          <column table="this" column="vvod_sum_fix_all" />
        </call>
        <call function="*" as="os_prc_0">
          <call function="/">
            <column table="this" column="kap_sum_fact_fix_all" />
            <column table="this" column="kap_sum_fix_all" />
          </call>
          <const>100</const>
        </call>
        <call function="*" as="fn_prc_0">
          <call function="/">
            <column table="this" column="fp_sum_nds_fact_fix_all" />
            <column table="this" column="fp_sum_nds_fix_all" />
          </call>
          <const>100</const>
        </call>
        <call function="*" as="vv_prc_0">
          <call function="/">
            <column table="this" column="vvod_sum_fact_fix_all" />
            <column table="this" column="vvod_sum_fix_all" />
          </call>
          <const>100</const>
        </call>
        <call function="if" as="num_pr_sbor" type="number" title="Наличие сборного">
          <call function="or">
            <call function="is null">
              <column table="this" column="tit_num_new_sbor" />
            </call>
            <call function="and">
              <call function="true" />
              <call function="=" optional="1">
                <useparam name="pr_sbor" />
                <const>0</const>
              </call>
            </call>
          </call>
          <const>0</const>
          <const>1</const>
        </call>
        <usepart part="26630-rownum">
          <column table="this" column="num_pr_sbor" />
          <array>'gtst'</array>
          <array>'ttot'</array>
          <array>'ttmt'</array>
          <array>'mtdt'</array>
        </usepart>
        <!--<call as="zt_dz_pl_sn_cm" function="if" title="ДЗ для вида затрат" client-calc="1" row-selector="isgrset(izt,stzt,otzt,mtzt,dtzt)">
          <call function="gt">
            <column table="this" column="smet_dz_pl_sn_cm" row-selector="parent" />
            <const>0</const>
          </call>
          <call function="0-">
            <column table="this" column="sld_pl_sn_cm" />
          </call>
        </call>
        <call as="zt_kz_pl_sn_cm" function="if" title="КЗ для вида затрат" client-calc="1" row-selector="isgrset(izt,stzt,otzt,mtzt,dtzt)">
          <call function="gt">
            <column table="this" column="smet_kz_pl_sn_cm" row-selector="parent" />
            <const>0</const>
          </call>
          <column table="this" column="sld_pl_sn_cm" />
        </call>

-->
        <column table="a" column="*" />
        <column table="pfa" column="os_prich_0" />
        <column table="pfa" column="fn_prich_0" />
        <column table="pfa" column="vv_prich_0" />
        <column table="pfa" column="os_krm_0" />
        <column table="pfa" column="fn_krm_0" />
        <column table="pfa" column="vv_krm_0" />
        <column table="pfa" column="os_krr_0" />
        <column table="pfa" column="fn_krr_0" />
        <column table="pfa" column="vv_krr_0" />
      </select>
      <from>
        <query name="26630-dat-new3" as="a">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <grsets materialize-type="temp-table">
            <on-rows>
              <grset level="7" title="Итого" as="i">
                <grset level="2" title="По статьям сметы" as="ism" order="kod_smet">
                  <where>
                    <usepart part="26630-smet-cond" />
                  </where>
                </grset>
                <grset level="4" title="По прочим затратам" as="izt">
                  <where>
                    <usepart part="26630-zt-cond" />
                  </where>
                </grset>
                <grset level="16" title="Группа план/факт" as="pf_gr">
                  <grset level="" title="Группа план/факт (вывод)" as="pf_gro">
                    <where>
                      <call function="or">
                        <call function="false" />
                        <call function="=1" optional="1">
                          <useparam name="pr_pf_gr" />
                        </call>
                      </call>
                    </where>
                  </grset>
                  <grset level="6" title="По титулам" as="igt">
                    <grset level="" title="По сборному титулу" as="gtst">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="tit_num_new_sbor" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_sbor" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                      <grset level="2" title="По статьям сметы" as="stsm" order="kod_smet">
                        <where>
                          <usepart part="26630-smet-cond" />
                        </where>
                      </grset>
                      <grset level="4" title="По прочим затратам" as="stzt">
                        <where>
                          <usepart part="26630-zt-cond" />
                        </where>
                      </grset>
                    </grset>
                    <grset level="1" title="По одиночным и головным титулам" as="gttt">
                      <grset level="" title="По одиночному титулу" as="ttot">
                        <where>
                          <call function="=">
                            <call function="nvl">
                              <column table="a" column="is_head_tit" />
                              <const>0</const>
                            </call>
                            <const>0</const>
                          </call>
                        </where>
                        <grset level="2" title="По статьям сметы" as="otsm" order="kod_smet">
                          <where>
                            <usepart part="26630-smet-cond" />
                          </where>
                        </grset>
                        <grset level="4" title="По прочим затратам" as="otzt">
                          <where>
                            <usepart part="26630-zt-cond" />
                          </where>
                        </grset>
                        <grset level="" title="По договорам(итог)" as="otdi">
                          <where>
                            <usepart part="26630-dog-cond" />
                          </where>
                          <grset level="3" title="По договорам" as="otdg" />
                        </grset>
                      </grset>
                      <grset level="" title="По головному титулу" as="ttmt">
                        <where>
                          <call function="=">
                            <column table="a" column="is_head_tit" />
                            <const>1</const>
                          </call>
                        </where>
                        <grset level="2" title="По статьям сметы" as="mtsm" order="kod_smet">
                          <where>
                            <usepart part="26630-smet-cond" />
                          </where>
                        </grset>
                        <grset level="4" title="По прочим затратам" as="mtzt">
                          <where>
                            <usepart part="26630-zt-cond" />
                          </where>
                        </grset>
                        <grset level="" title="По договорам(итог)" as="mtdi">
                          <where>
                            <call function="and">
                              <usepart part="26630-dog-cond" />
                              <call function="=">
                                <call function="nvlu">
                                  <useparam name="pr_child" />
                                  <const>0</const>
                                </call>
                                <const>0</const>
                              </call>
                            </call>
                          </where>
                          <grset level="3" title="По договорам" as="mtdg" />
                        </grset>
                        <grset level="5" title="По дочерним титулам" as="mtdt">
                          <where>
                            <call function="and">
                              <call function="is not null">
                                <column table="a" column="kod_child_titul" />
                              </call>
                              <call function="=">
                                <call function="nvlu">
                                  <useparam name="pr_child" />
                                  <const>0</const>
                                </call>
                                <const>1</const>
                              </call>
                            </call>
                          </where>
                          <grset level="2" title="По статьям сметы" as="dtsm" order="kod_smet">
                            <where>
                              <usepart part="26630-smet-cond" />
                            </where>
                          </grset>
                          <grset level="4" title="По прочим затратам" as="dtzt">
                            <where>
                              <usepart part="26630-zt-cond" />
                            </where>
                          </grset>
                          <grset level="" title="По договорам(итог)" as="dtdi">
                            <where>
                              <usepart part="26630-dog-cond" />
                            </where>
                            <grset level="3" title="По договорам" as="dtdg" />
                          </grset>
                        </grset>
                      </grset>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </on-rows>
            <on-columns>
              <grset level="8" as="ym" title="Период" order="ym_id">
                <facts>
                  <usepart part="26630-pivot-facts-ym-kv-m6-m9" />
                  <usepart part="26630-pivot-facts-ym" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="ym_id" />
                  </call>
                </where>
              </grset>
              <grset level="11" as="kv" title="Период" order="kv_id">
                <facts>
                  <usepart part="26630-pivot-facts-ym-kv-m6-m9" />
                  <usepart part="26630-pivot-facts-kv" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="kv_id" />
                  </call>
                </where>
              </grset>
              <grset level="12" as="m6" title="Период" order="m6_id">
                <facts>
                  <usepart part="26630-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="m6_id" />
                  </call>
                </where>
              </grset>
              <grset level="13" as="m9" title="Период" order="m9_id">
                <facts>
                  <usepart part="26630-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="m9_id" />
                  </call>
                </where>
              </grset>
              <grset level="15" as="op" title="Период" order="op_id">
                <facts>
                  <usepart part="26630-pivot-facts-ym-kv-m6-m9" />
                  <usepart part="26630-pivot-facts-kv" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="op_id" />
                  </call>
                </where>
              </grset>
              <grset level="8,14" as="ym_cm" title="Период" order="ym_id" intervals="1">
                <facts>
                  <usepart part="26630-pivot-facts-ym_cm" />
                </facts>
                <where>
                  <call function="and">
                    <call function="is not null">
                      <column table="a" column="ym_id" />
                    </call>
                  </call>
                </where>
              </grset>
              <grset level="8,10" as="ym_cm_smet" title="Период" order="ym_id" intervals="1">
                <facts>
                  <usepart part="26630-pivot-facts-ym_cm-smet" />
                </facts>
                <where>
                  <call function="and">
                    <call function="is not null">
                      <column table="a" column="ym_id" />
                    </call>
                    <call function="=1">
                      <column table="a" column="rn_smet" />
                    </call>
                  </call>
                </where>
              </grset>
              <grset level="8,9" as="ym_cm_dog" title="Период" order="ym_id" intervals="1">
                <facts>
                  <usepart part="26630-pivot-facts-ym_cm-dog" />
                </facts>
                <where>
                  <call function="and">
                    <call function="is not null">
                      <column table="a" column="ym_id" />
                    </call>
                    <call function="=1">
                      <column table="a" column="rn_dog" />
                    </call>
                  </call>
                </where>
              </grset>
            </on-columns>
          </grsets>
        </query>
        <query name="26630-dat-new3-pfa" as="pfa" join="left outer">
          <call function="=">
            <column table="a" column="kod_ipr" />
            <column table="pfa" column="kod_ipr" />
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="or">
          <call function="and">
            <call function="is not null">
              <column table="a" column="pr_plan" />
            </call>
            <call function="not 0">
              <column table="a" column="summ_usr" />
              <column table="a" column="summ_psd" />
              <column table="a" column="dog_plan_cost" />
              <column table="a" column="kap_sum_itog_eg" />
              <column table="a" column="fp_sum_nds_itog_eg" />
              <column table="a" column="vvod_sum_itog_eg" />
              <column table="a" column="kap_sum_fact_itog_eg" />
              <column table="a" column="fp_sum_nds_fact_itog_eg" />
              <column table="a" column="vvod_sum_fact_itog_eg" />
            </call>
          </call>
          <call function="and">
            <call function="is null">
              <column table="a" column="pr_plan" />
            </call>
            <call function="not 0">
              <column table="a" column="fp_sum_nds_fact_all" />
              <column table="a" column="kap_sum_fact_all" />
              <column table="a" column="vvod_sum_fact_all" />
              <column table="a" column="nzs_fact_itog_eg" />
              <column table="a" column="kredit_fact_itog_dog_eg" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-dat-vvod-new3" grouplevel="no" timestamp="02.02.2017 19:51:13" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-vvod-new3-1.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <usepart part="26630-common-columns" />
        <call function="+nvl" group="sum" as="pow_km_all" colset="План">
          <column table="a" column="pow_km" />
          <column table="this" column="pow_km_kl" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_fact" colset="Факт">
          <column table="a" column="pow_km_fact" />
          <column table="a" column="pow_km_kl_fact" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_itog" colset="План">
          <column table="a" column="pow_km_itog" />
          <column table="this" column="pow_km_kl_itog" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_fact_itog" colset="Факт">
          <column table="a" column="pow_km_fact_itog" />
          <column table="a" column="pow_km_kl_fact_itog" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_pr" colset="План">
          <column table="a" column="pow_km_pr" />
          <column table="this" column="pow_km_kl_pr" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr" colset="Факт">
          <column table="a" column="pow_km_fact_pr" />
          <column table="a" column="pow_km_kl_fact_pr" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_pr_itog" colset="План">
          <column table="a" column="pow_km_pr_itog" />
          <column table="this" column="pow_km_kl_pr_itog" />
        </call>
        <call function="+nvl" group="sum" as="pow_km_all_fact_pr_itog" colset="Факт">
          <column table="a" column="pow_km_fact_pr_itog" />
          <column table="a" column="pow_km_kl_fact_pr_itog" />
        </call>
        <!--деньги-->
        <column table="a" column="vvod_sum" as="vv_pl_bn_gd" group="sum" mp="[:mp]" if="god" colset="План">
          <usepart part="26630-if-god" />
        </column>
        <column table="a" column="vvod_sum" as="vv_pl_bn" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="vvod_sum_itog" as="vv_pl_bn_cm" group="sum" mp="[:mp]" colset="План" />
        <column table="a" column="vvod_sum_fact" as="vv_ft_bn" group="sum" mp="[:mp]" colset="Факт" />
        <column table="a" column="vvod_sum_fact_itog" as="vv_ft_bn_cm" group="sum" mp="[:mp]" colset="Факт" />
        <!--наличие физ параметров-->
        <column table="a" column="pow_any" as="vv_any_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_any" as="vv_any_pl" group="sum" colset="План" />
        <column table="a" column="pow_any_itog" as="vv_any_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_any_fact" as="vv_any_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_any_fact_itog" as="vv_any_ft_cm" group="sum" colset="Факт" />
        <!--ввод-->
        <!--мва-->
        <column table="a" column="pow_mba" as="vv_mba_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_mba" as="vv_mba_pl" group="sum" colset="План" />
        <column table="a" column="pow_mba_itog" as="vv_mba_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_mba_fact" as="vv_mba_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_mba_fact_itog" as="vv_mba_ft_cm" group="sum" colset="Факт" />
        <!--км-->
        <column table="this" column="pow_km_all" as="vv_km_pl_gd" group="sum" if="god" colset="План" />
        <column table="this" column="pow_km_all" as="vv_km_pl" group="sum" colset="План" />
        <column table="this" column="pow_km_all_itog" as="vv_km_pl_cm" group="sum" colset="План" />
        <column table="this" column="pow_km_all_fact" as="vv_km_ft" group="sum" colset="Факт" />
        <column table="this" column="pow_km_all_fact_itog" as="vv_km_ft_cm" group="sum" colset="Факт" />
        <!--км кл-->
        <column table="a" column="pow_km_kl" as="vv_kmkl_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_km_kl" as="vv_kmkl_pl" group="sum" colset="План" />
        <column table="a" column="pow_km_kl_itog" as="vv_kmkl_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_km_kl_fact" as="vv_kmkl_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_km_kl_fact_itog" as="vv_kmkl_ft_cm" group="sum" colset="Факт" />
        <!--км вл-->
        <column table="a" column="pow_km" as="vv_kmvl_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_km" as="vv_kmvl_pl" group="sum" colset="План" />
        <column table="a" column="pow_km_itog" as="vv_kmvl_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_km_fact" as="vv_kmvl_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_km_fact_itog" as="vv_kmvl_ft_cm" group="sum" colset="Факт" />
        <!--км вл1-->
        <column table="a" column="vvd_plan_km_vl1" as="vv_kmvl1_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="vvd_plan_km_vl1" as="vv_kmvl1_pl" group="sum" colset="План" />
        <column table="a" column="vvd_plan_km_vl1_itog" as="vv_kmvl1_pl_cm" group="sum" colset="План" />
        <column table="a" column="vvd_fact_km_vl1" as="vv_kmvl1_ft" group="sum" colset="Факт" />
        <column table="a" column="vvd_fact_km_vl1_itog" as="vv_kmvl1_ft_cm" group="sum" colset="Факт" />
        <!--км вл2-->
        <column table="a" column="vvd_plan_km_vl2" as="vv_kmvl2_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="vvd_plan_km_vl2" as="vv_kmvl2_pl" group="sum" colset="План" />
        <column table="a" column="vvd_plan_km_vl2_itog" as="vv_kmvl2_pl_cm" group="sum" colset="План" />
        <column table="a" column="vvd_fact_km_vl2" as="vv_kmvl2_ft" group="sum" colset="Факт" />
        <column table="a" column="vvd_fact_km_vl2_itog" as="vv_kmvl2_ft_cm" group="sum" colset="Факт" />
        <!--пстп-->
        <column table="a" column="pow_cnt" as="vv_pstp_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_cnt" as="vv_pstp_pl" group="sum" colset="План" />
        <column table="a" column="pow_cnt_itog" as="vv_pstp_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_cnt_fact" as="vv_pstp_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_cnt_fact_itog" as="vv_pstp_ft_cm" group="sum" colset="Факт" />
        <!--прочие-->
        <column table="a" column="pow_cnt_proch" as="vv_prch_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_cnt_proch" as="vv_prch_pl" group="sum" colset="План" />
        <column table="a" column="pow_cnt_proch_itog" as="vv_prch_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_cnt_proch_fact" as="vv_prch_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_cnt_proch_fact_itog" as="vv_prch_ft_cm" group="sum" colset="Факт" />
        <!--прирост-->
        <!--мва-->
        <column table="a" column="pow_mba_pr" as="pr_mba_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_mba_pr" as="pr_mba_pl" group="sum" colset="План" />
        <column table="a" column="pow_mba_pr_itog" as="pr_mba_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_mba_fact_pr" as="pr_mba_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_mba_fact_pr_itog" as="pr_mba_ft_cm" group="sum" colset="Факт" />
        <!--км-->
        <column table="this" column="pow_km_all_pr" as="pr_km_pl_gd" group="sum" if="god" colset="План" />
        <column table="this" column="pow_km_all_pr" as="pr_km_pl" group="sum" colset="План" />
        <column table="this" column="pow_km_all_pr_itog" as="pr_km_pl_cm" group="sum" colset="План" />
        <column table="this" column="pow_km_all_fact_pr" as="pr_km_ft" group="sum" colset="Факт" />
        <column table="this" column="pow_km_all_fact_pr_itog" as="pr_km_ft_cm" group="sum" colset="Факт" />
        <!--км кл-->
        <column table="a" column="pow_km_kl_pr" as="pr_kmkl_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_km_kl_pr" as="pr_kmkl_pl" group="sum" colset="План" />
        <column table="a" column="pow_km_kl_pr_itog" as="pr_kmkl_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_km_kl_fact_pr" as="pr_kmkl_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_km_kl_fact_pr_itog" as="pr_kmkl_ft_cm" group="sum" colset="Факт" />
        <!--км вл-->
        <column table="a" column="pow_km_pr" as="pr_kmvl_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_km_pr" as="pr_kmvl_pl" group="sum" colset="План" />
        <column table="a" column="pow_km_pr_itog" as="pr_kmvl_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_km_fact_pr" as="pr_kmvl_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_km_fact_pr_itog" as="pr_kmvl_ft_cm" group="sum" colset="Факт" />
        <!--км вл1-->
        <column table="a" column="vvd_plan_km_vl1_pr" as="pr_kmvl1_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="vvd_plan_km_vl1_pr" as="pr_kmvl1_pl" group="sum" colset="План" />
        <column table="a" column="vvd_plan_km_vl1_pr_itog" as="pr_kmvl1_pl_cm" group="sum" colset="План" />
        <column table="a" column="vvd_fact_km_vl1_pr" as="pr_kmvl1_ft" group="sum" colset="Факт" />
        <column table="a" column="vvd_fact_km_vl1_pr_itog" as="pr_kmvl1_ft_cm" group="sum" colset="Факт" />
        <!--км вл2-->
        <column table="a" column="vvd_plan_km_vl2_pr" as="pr_kmvl2_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="vvd_plan_km_vl2_pr" as="pr_kmvl2_pl" group="sum" colset="План" />
        <column table="a" column="vvd_plan_km_vl2_pr_itog" as="pr_kmvl2_pl_cm" group="sum" colset="План" />
        <column table="a" column="vvd_fact_km_vl2_pr" as="pr_kmvl2_ft" group="sum" colset="Факт" />
        <column table="a" column="vvd_fact_km_vl2_pr_itog" as="pr_kmvl2_ft_cm" group="sum" colset="Факт" />
        <!--пстп-->
        <column table="a" column="pow_cnt_pr" as="pr_pstp_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_cnt_pr" as="pr_pstp_pl" group="sum" colset="План" />
        <column table="a" column="pow_cnt_pr_itog" as="pr_pstp_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_cnt_fact_pr" as="pr_pstp_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_cnt_fact_pr_itog" as="pr_pstp_ft_cm" group="sum" colset="Факт" />
        <!--прочие-->
        <column table="a" column="pow_cnt_proch_pr" as="pr_prch_pl_gd" group="sum" if="god" colset="План" />
        <column table="a" column="pow_cnt_proch_pr" as="pr_prch_pl" group="sum" colset="План" />
        <column table="a" column="pow_cnt_proch_pr_itog" as="pr_prch_pl_cm" group="sum" colset="План" />
        <column table="a" column="pow_cnt_proch_fact_pr" as="pr_prch_ft" group="sum" colset="Факт" />
        <column table="a" column="pow_cnt_proch_fact_pr_itog" as="pr_prch_ft_cm" group="sum" colset="Факт" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere exclude="1">
            <call function="and">
              <call function="=">
                <column table="kod_doc_osn" column="kod_doc" />
                <useparam name="kod_doc" />
              </call>
              <call function="=" exclude="1">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <const>7787</const>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="not" optional="1">
                <call function="=">
                  <column table="kod_titul_ip" column="kod_aip" />
                  <useparam name="pr_notaip" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_all_fact_not" />
                </call>
                <call function="is not null">
                  <column table="kod_ipr" column="kod_ipr" />
                </call>
              </call>
            </call>
          </extendwhere>
          <withparams>
            <useparam name="kod_titul_ip" />
            <useparam name="year" />
          </withparams>
          <link name="check_pl_ft" />
          <link name="kod_ipr" as="ipr_ipr_data">
            <dlink name="ipr_planfactanaliz">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="kod_doc" />
                    <useparam name="kod_doc" />
                  </call>
                  <call function="=">
                    <column table="ipr_planfactanaliz" column="year" />
                    <useparam name="year" />
                  </call>
                  <call function="between">
                    <column table="ipr_planfactanaliz" column="kvart" />
                    <call function="mes to kv">
                      <useparam name="mon1" />
                    </call>
                    <call function="mes to kv">
                      <useparam name="mon2" />
                    </call>
                  </call>
                </call>
              </where>
            </dlink>
            <link name="kod_kriteria" exclude="1" />
            <link name="kod_priority_insert_ip" exclude="1" />
            <link name="kod_klass" exclude="1" />
            <link name="kod_status" />
          </link>
          <link name="kod_ipr_ext">
            <link name="kod_razdel" />
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" as="kod_subject_main" />
            <link name="kod_direct" as="kod_direct_main" />
            <link name="kod_ispolnit" as="kod_ispolnit_main" />
            <link name="kod_sbor_titul">
              <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
            </link>
          </link>
          <link name="kod_smet" />
          <link name="kodzatrat" />
          <link name="kod_dog">
            <link name="e_code" />
            <link name="status" />
          </link>
          <link name="kod_dog_i" />
          <link name="kod_ipr_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_hide_do_data" />
            </call>
            <call function="!=0">
              <column table="check_pl_ft" column="pr_plan" />
              <column table="check_pl_ft" column="pr_fact" />
              <column table="check_pl_ft" column="pr_wait" />
            </call>
          </call>-->
          <call function="=">
            <column table="a" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="or" optional="1" exclude="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_titul_ip" />
            <useparam name="kod2_titul_ip" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_all_fact_not" />
            </call>
            <call function="=nvl">
              <column table="a" column="kod_ipr" />
              <column table="a" column="kod_ipr_ext" />
            </call>
          </call>
          <!--заменить на section-->
          <call function="or">
            <call function="is null">
              <column table="a" column="ym" />
            </call>
            <call function="and">
              <call function="le">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <const>12</const>
                </call>
              </call>
              <call function="or">
                <call function="ge">
                  <column table="a" column="ym" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="ge">
                  <column table="a" column="ym_nxt" />
                  <call function="ym2 add month">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <const>1</const>
                    </call>
                    <const>-1</const>
                  </call>
                </call>
                <call function="is null">
                  <column table="a" column="ym_nxt" />
                </call>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="is not null" comment="химия. когда вырезается условие по подразделениям , дает ошибку из-за лишнего параметра">
            <useparam name="kod_dirisp" />
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_no_zero" />
            </call>
            <call function="!=">
              <column table="this" column="pr_check_plan_fact" />
              <const>3</const>
            </call>
          </call>
          <!--<call function="between">
            <call function="nvl">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam  name="year"/>
                <useparam  name="mon1"/>
              </call>
            </call>
            <call function="ym2 add month">
              <call function="num to ym2">
                <useparam  name="year"/>
                <const>1</const>
              </call>
              <const>-1</const>
            </call>
            <call function="num to ym2">
              <useparam  name="year"/>
              <const>12</const>
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-dat-grsets-vvod-new3" timestamp="24.01.2017 23:42:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-vvod-new3.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="if" as="num_pr_sbor" type="number" title="Наличие сборного">
          <call function="or">
            <call function="is null">
              <column table="this" column="tit_num_new_sbor" />
            </call>
            <call function="and">
              <call function="true" />
              <call function="=" optional="1">
                <useparam name="pr_sbor" />
                <const>0</const>
              </call>
            </call>
          </call>
          <const>0</const>
          <const>1</const>
        </call>
        <usepart part="26630-rownum">
          <column table="this" column="num_pr_sbor" />
          <array>'gtst'</array>
          <array>'ttot'</array>
          <array>'ttmt'</array>
          <array>'mtdt'</array>
        </usepart>
        <!--<call function="+nvl" as="num_ttt" title="Номер дочернего" type="number" client-calc="1">
          <column table="this" column="num_ttt" row-selector="prev-row" />
          <const>1</const>
        </call>-->
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-dat-vvod-new3" as="a">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <grsets materialize-type="temp-table">
            <on-rows>
              <grset level="7" title="Итого" as="i">
                <grset level="16" title="Группа план/факт" as="pf_gr">
                  <grset level="" title="Группа план/факт (вывод)" as="pf_gro">
                    <where>
                      <call function="or">
                        <call function="false" />
                        <call function="=1" optional="1">
                          <useparam name="pr_pf_gr" />
                        </call>
                      </call>
                    </where>
                  </grset>
                  <grset level="6" title="По титулам" as="igt">
                    <grset level="" title="По сборному титулу" as="gtst">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="tit_num_new_sbor" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_sbor" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                    <grset level="1" title="По одиночным и головным титулам" as="gttt">
                      <grset level="" title="По одиночному титулу" as="ttot">
                        <where>
                          <call function="=">
                            <call function="nvl">
                              <column table="a" column="is_head_tit" />
                              <const>0</const>
                            </call>
                            <const>0</const>
                          </call>
                        </where>
                      </grset>
                      <grset level="" title="По головному титулу" as="ttmt">
                        <where>
                          <call function="=">
                            <column table="a" column="is_head_tit" />
                            <const>1</const>
                          </call>
                        </where>
                        <grset level="5" title="По дочерним титулам" as="mtdt">
                          <where>
                            <call function="and">
                              <call function="is not null">
                                <column table="a" column="kod_child_titul" />
                              </call>
                              <call function="=">
                                <call function="nvlu">
                                  <useparam name="pr_child" />
                                  <const>0</const>
                                </call>
                                <const>1</const>
                              </call>
                            </call>
                          </where>
                        </grset>
                      </grset>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </on-rows>
            <on-columns>
              <grset level="8" as="ym" title="Период" order="ym_id">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="ym_id" />
                  </call>
                </where>
              </grset>
              <grset level="11" as="kv" title="Период" order="kv_id">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="kv_id" />
                  </call>
                </where>
              </grset>
              <grset level="12" as="m6" title="Период" order="m6_id">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="m6_id" />
                  </call>
                </where>
              </grset>
              <grset level="13" as="m9" title="Период" order="m9_id">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="m9_id" />
                  </call>
                </where>
              </grset>
              <grset level="15" as="op" title="Период" order="op_id">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym-kv-m6-m9" />
                </facts>
                <where>
                  <call function="is not null">
                    <column table="a" column="op_id" />
                  </call>
                </where>
              </grset>
              <grset level="8,14" as="ym_cm" title="Период" order="ym_id" intervals="1">
                <facts>
                  <usepart part="26630-vvod-pivot-facts-ym_cm" />
                </facts>
                <where>
                  <call function="and">
                    <call function="is not null">
                      <column table="a" column="ym_id" />
                    </call>
                  </call>
                </where>
              </grset>
            </on-columns>
          </grsets>
        </query>
      </from>
      <!--<where>
        <call function="not 0">
          <column table="a" column="summ_usr" />
          <column table="a" column="summ_psd" />
          <column table="a" column="dog_plan_cost" />
          <column table="a" column="kap_sum_itog_eg" />
          <column table="a" column="fp_sum_nds_itog_eg" />
          <column table="a" column="vvod_sum_itog_eg" />
          <column table="a" column="kap_sum_fact_itog_eg" />
          <column table="a" column="fp_sum_nds_fact_itog_eg" />
          <column table="a" column="vvod_sum_fact_itog_eg" />
        </call>
      </where>-->
    </query>
    <query name="26630-xl-cols1o-test" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-vvod-new3.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols1o" as="a">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="like">
            <column table="a" column="title2" />
            <const>'I квартал'</const>
          </call>
          <call function="like">
            <column table="a" column="title3" />
            <const>'Факт'</const>
          </call>
          <call function="in">
            <column table="a" column="title4" />
            <array>'Январь','Февраль'</array>
          </call>
          <!--<call function="in">
            <column table="a" column="title5"/>
            <array>'Без НДС'</array>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-xl-vv-cols0-2" timestamp="25.01.2017 02:24:33" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <params>
        <usepart part="26630-params" />
        <param type="string" name="pfx">
          <const>'beg'</const>
        </param>
      </params>
      <select>
        <call function="||" as="name" key="1">
          <const>'vv_'</const>
          <call function="if" type="string">
            <call function="in">
              <column table="hz1" column="name" />
              <const>'pow'</const>
            </call>
            <call function="||" key="1">
              <column table="hz2" column="name" />
              <const>'_'</const>
            </call>
          </call>
          <column table="pwf" column="name" />
          <const>'_'</const>
          <call function="if" type="string">
            <call function="not in">
              <column table="hz1" column="name" />
              <const>'pow'</const>
            </call>
            <call function="||" key="1">
              <column table="nds" column="name" />
              <const>'_'</const>
            </call>
          </call>
          <const>'cm'</const>
          <const>'_'</const>
          <call function="if" type="string">
            <call function="=">
              <useparam name="pfx" />
              <const>'beg'</const>
            </call>
            <call function="time ym2 id">
              <call function="ym2 add month">
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <const>-1</const>
              </call>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
        </call>
        <call function="||" as="name_for_comp" key="1">
          <call function="if" type="string">
            <call function="in">
              <column table="hz1" column="name" />
              <const>'pow'</const>
            </call>
            <call function="||" key="1">
              <const>'vv_'</const>
              <column table="pwf" column="name" />
              <const>'_bn_'</const>
            </call>
            <call function="||" key="1">
              <const>'vv_any_'</const>
              <column table="pwf" column="name" />
              <const>'_'</const>
            </call>
          </call>
          <const>'cm_'</const>
          <call function="if" type="string">
            <call function="=">
              <useparam name="pfx" />
              <const>'beg'</const>
            </call>
            <call function="time ym2 id">
              <call function="ym2 add month">
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <const>-1</const>
              </call>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="pwf" column="ordr" />
          <column table="hz1" column="ordr" />
          <call function="coalesce">
            <column table="nds" column="ordr" />
            <column table="hz2" column="ordr" />
          </call>
        </call>
        <column table="pwf" column="title" as="title2" />
        <column table="hz1" column="title" as="title3" />
        <column table="this" column="title3" as="title4" />
        <call function="coalesce" as="title5">
          <column table="nds" column="title" />
          <column table="hz2" column="title" />
        </call>
        <call as="column_width" function="if" type="number">
          <call function="in">
            <column table="hz2" column="name" />
            <array>'any'</array>
          </call>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-pwf" as="pwf" />
        <query name="26630-xl-vv-cols-hz1" as="hz1" join="cross" />
        <query name="26630-xl-cols-nds" as="nds" join="left outer">
          <call function="and">
            <call function="in">
              <column table="hz1" column="name" />
              <const>'vvod'</const>
            </call>
            <call function="in">
              <column table="nds" column="name" />
              <array>'bn'</array>
            </call>
          </call>
        </query>
        <query name="26630-xl-cols-fiz" as="hz2" join="left outer">
          <call function="in">
            <column table="hz1" column="name" />
            <const>'pow'</const>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','ft'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-vv-cols1-2" timestamp="29.01.2017 20:48:44" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <call function="||" as="name">
          <const>'vv_'</const>
          <call function="case">
            <call function="when">
              <call function="=">
                <column table="per" column="tip" />
                <const>'p0'</const>
              </call>
              <const>'pl_bn_gd'</const>
            </call>
            <call function="else">
              <call function="||">
                <column table="pwf" column="name" />
                <const>'_'</const>
                <const>'bn_'</const>
                <call function="case">
                  <call function="when">
                    <call function="in">
                      <column table="per" column="tip" />
                      <array>'p','p3'</array>
                    </call>
                    <const>'0'</const>
                  </call>
                  <call function="else">
                    <call function="||">
                      <const>''</const>
                      <column table="this" column="time_id" />
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="name_for_comp" key="1">
          <const>'vv_any_'</const>
          <column table="pwf" column="name" />
          <const>'_'</const>
          <call function="case">
            <call function="when">
              <call function="=">
                <column table="per" column="tip" />
                <const>'p0'</const>
              </call>
              <const>'gd'</const>
            </call>
            <call function="else">
              <call function="||">
                <const>''</const>
                <call function="case">
                  <call function="when">
                    <call function="in">
                      <column table="per" column="tip" />
                      <array>'p','p3'</array>
                    </call>
                    <const>'0'</const>
                  </call>
                  <call function="else">
                    <call function="||">
                      <const>''</const>
                      <column table="this" column="time_id" />
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
        </call>
        <column table="ofv" column="title" as="title1" />
        <column table="per" column="title" as="title2" />
        <call function="case" as="title3">
          <call function="when">
            <call function="=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="else">
            <column table="pwf" column="title" />
          </call>
        </call>
        <call function="case" as="title4">
          <call function="when">
            <call function="=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p','p1','p2','p3'</array>
            </call>
            <column table="pwf" column="title" />
          </call>
          <call function="when">
            <call function="in">
              <column table="per2" column="tip" />
              <array>'k'</array>
            </call>
            <const>'Итого квартал'</const>
          </call>
          <call function="else">
            <column table="per2" column="title" />
          </call>
        </call>
        <column table="nds" column="title" as="title5" />
        <const type="number" as="column_width">12</const>
        <call function="case" type="string" as="time_id">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p3'</array>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="per2" column="tip" />
              <array>'m'</array>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per2" column="name" />
              </call>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p1','k','p2'</array>
            </call>
            <call function="time y k id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="per" column="ordr" />
          <column table="pwf" column="ordr" />
          <column table="per2" column="ordr" />
          <column table="nds" column="ordr" />
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-ofv" as="ofv" />
        <query name="26630-xl-cols-per" as="per" join="cross" />
        <query name="26630-xl-cols-pwf" as="pwf" join="left outer">
          <call function="or">
            <call function="!=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <call function="=">
              <column table="pwf" column="name" />
              <const>'pl'</const>
            </call>
          </call>
        </query>
        <query name="26630-xl-cols-per" as="per2" join="left outer">
          <call function="=">
            <column table="per" column="kv" />
            <column table="per2" column="kv" />
          </call>
        </query>
        <query name="26630-xl-cols-nds" as="nds" join="cross" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="ofv" column="name" />
            <array>'vv'</array>
          </call>
          <call function="in">
            <column table="per" column="tip" />
            <array>'k','p','p0','p1','p2','p3'</array>
          </call>
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','ft'</array>
          </call>
          <call function="in">
            <column table="nds" column="name" />
            <array>'bn'</array>
          </call>
          <call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>
          <!--<call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-xl-vv-colsx-2" timestamp="29.01.2017 20:53:22" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <call function="||" as="name">
          <column table="vpr" column="name" />
          <const>'_'</const>
          <column table="hz3" column="name" />
          <const>'_'</const>
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <const>'p0'</const>
              </call>
              <const>'gd'</const>
            </call>
            <call function="else">
              <call function="||">
                <column table="pwf" column="name" />
                <const>'_'</const>
                <call function="case">
                  <call function="when">
                    <call function="in">
                      <column table="per" column="tip" />
                      <array>'p','p3'</array>
                    </call>
                    <const>'0'</const>
                  </call>
                  <call function="else">
                    <call function="||">
                      <const>''</const>
                      <column table="this" column="time_id" />
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="name_for_comp" key="1">
          <const>'vv_'</const>
          <column table="pwf" column="name" />
          <const>'_bn_'</const>
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <const>'p0'</const>
              </call>
              <const>'gd'</const>
            </call>
            <call function="else">
              <call function="||">
                <const>''</const>
                <call function="case">
                  <call function="when">
                    <call function="in">
                      <column table="per" column="tip" />
                      <array>'p','p3'</array>
                    </call>
                    <const>'0'</const>
                  </call>
                  <call function="else">
                    <call function="||">
                      <const>''</const>
                      <column table="this" column="time_id" />
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
        </call>
        <column table="hz3" column="color" />
        <call function="if" as="column_width" type="number">
          <call function="in">
            <column table="hz3" column="name" />
            <const>'any'</const>
          </call>
          <const>0</const>
        </call>
        <call function="case" type="string" as="time_id">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p3'</array>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="per2" column="tip" />
              <array>'m'</array>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per2" column="name" />
              </call>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p1','k','p2'</array>
            </call>
            <call function="time y k id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="vpr" column="ordr" />
          <column table="hz3" column="ordr" />
          <column table="per" column="ordr" />
          <column table="pwf" column="ordr" />
          <column table="per2" column="ordr" />
        </call>
        <column table="vpr" column="title" as="title1" />
        <column table="hz3" column="title" as="title2" />
        <column table="per" column="title" as="title3" />
        <call function="case" as="title4">
          <call function="when">
            <call function="=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="else">
            <column table="pwf" column="title" />
          </call>
        </call>
        <call function="case" as="title5">
          <call function="when">
            <call function="=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p','p1','p2','p3'</array>
            </call>
            <column table="pwf" column="title" />
          </call>
          <call function="when">
            <call function="in">
              <column table="per2" column="tip" />
              <array>'k'</array>
            </call>
            <const>'Итого квартал'</const>
          </call>
          <call function="else">
            <column table="per2" column="title" />
          </call>
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-fiz" as="hz3" />
        <query name="26630-xl-cols-vpr" as="vpr" join="cross" />
        <query name="26630-xl-cols-per" as="per" join="cross" />
        <query name="26630-xl-cols-pwf" as="pwf" join="left outer">
          <call function="or">
            <call function="!=">
              <column table="per" column="tip" />
              <const>'p0'</const>
            </call>
            <call function="=">
              <column table="pwf" column="name" />
              <const>'pl'</const>
            </call>
          </call>
        </query>
        <query name="26630-xl-cols-per" as="per2" join="left outer">
          <call function="=">
            <column table="per" column="kv" />
            <column table="per2" column="kv" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="per" column="tip" />
            <array>'k','p','p0','p1','p2','p3'</array>
          </call>
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','ft'</array>
          </call>
          <call function="or">
            <call function="in">
              <column table="vpr" column="name" />
              <array>'vv'</array>
            </call>
            <call function="not in">
              <column table="hz3" column="name" />
              <array>'any'</array>
            </call>
          </call>
          <call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>
          <!--<call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630-xl-vv-cols-hz1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <const as="name" type="string">'vvod'</const>
      <const as="title" type="string">'Ввод в основные фонды'</const>
      <const as="ordr" type="number">100</const>
      <const>'pow'</const>
      <const>'Ввод в физическом выражении'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-vv-cols-hz2" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <const as="name" type="string">'any'</const>
      <const as="title" type="string">''</const>
      <const as="ordr" type="number">100</const>
      <const>'mba'</const>
      <const>'МВА'</const>
      <const>200</const>
      <const>'km'</const>
      <const>'км'</const>
      <const>300</const>
      <const>'pr1'</const>
      <const>'прочие (ТП, РП), шт.'</const>
      <const>400</const>
      <const>'pr2'</const>
      <const>'прочие (прочие), шт.'</const>
      <const>500</const>
    </query>
    <query name="26630-xl-vv-cols-hz3" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <const as="name" type="string">'pow_mba'</const>
      <const as="title" type="string">'ввод в МВА'</const>
      <const as="ordr" type="number">100</const>
      <const as="color" type="number">1</const>
      <const>'pow_km_all'</const>
      <const>'ввод в ОФ, км'</const>
      <const>150</const>
      <const>2</const>
      <const>'pow_km'</const>
      <const>'в т.ч. ввод в ОФ, ВЛ, км'</const>
      <const>200</const>
      <const>1</const>
      <const>'pow_km_kl'</const>
      <const>'в т.ч. ввод в ОФ, КЛ, км'</const>
      <const>250</const>
      <const>2</const>
      <const>'pow_cnt'</const>
      <const>'ввод в ОФ, прочие (ТП, РП), шт.'</const>
      <const>300</const>
      <const>1</const>
      <const>'pow_cnt_proch'</const>
      <const>'ввод в ОФ, прочие (прочие), шт.'</const>
      <const>350</const>
      <const>2</const>
      <const>'pow_mba_pr'</const>
      <const>'прирост ввода в МВА'</const>
      <const>400</const>
      <const>1</const>
      <const>'pow_km_all_pr'</const>
      <const>'прирост ввода в ОФ, км'</const>
      <const>450</const>
      <const>2</const>
      <const>'pow_km_pr'</const>
      <const>'в т.ч. прирост ввода в ОФ, ВЛ, км'</const>
      <const>500</const>
      <const>1</const>
      <const>'pow_km_kl_pr'</const>
      <const>'в т.ч. прирост ввода в ОФ, КЛ, км'</const>
      <const>550</const>
      <const>2</const>
      <const>'pow_cnt_pr'</const>
      <const>'прирост ввода в ОФ, прочие (ТП, РП), шт.'</const>
      <const>600</const>
      <const>1</const>
      <const>'pow_cnt_proch_pr'</const>
      <const>'прирост ввода в ОФ, прочие (прочие), шт.'</const>
      <const>650</const>
      <const>2</const>
    </query>
    <query name="26630-xl-vv-cols0-2b" timestamp="24.01.2017 21:41:43" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-vv-cols0-2" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'beg'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-vv-cols0-2e" timestamp="24.01.2017 21:42:13" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols-2.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-vv-cols0-2" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'end'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols1" timestamp="07.01.2018 01:47:26" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
        <param type="string" name="ofv" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <call function="||" as="name_tit">
          <column table="ofv" column="name" />
          <const>'_'</const>
          <column table="pwf" column="name" />
          <call function="if">
            <call function="is not null">
              <column table="nds" column="name" />
            </call>
            <call function="||">
              <const>'_'</const>
              <column table="nds" column="name" />
            </call>
          </call>
          <call function="if">
            <call function="is not null">
              <column table="sch" column="name" />
            </call>
            <call function="||">
              <const>'_s'</const>
              <column table="sch" column="kod" />
            </call>
          </call>
          <call function="if">
            <call function="and">
              <call function="or">
                <call function="in">
                  <column table="sch" column="kod" />
                  <array>3</array>
                </call>
                <call function="is null">
                  <column table="sch" column="name" />
                </call>
              </call>
              <call function="in">
                <column table="pwf" column="name" />
                <array>'otkl','ft'</array>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="gt">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="gt">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <column table="per" column="end_mon" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
            </call>
            <const>'_n'</const>
          </call>
          <const>'_'</const>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'p','p3'</array>
              </call>
              <const>'0'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'p0'</array>
              </call>
              <const>'gd'</const>
            </call>
            <call function="else">
              <call function="to_char">
                <column table="this" column="time_id" />
              </call>
            </call>
          </call>
        </call>
        <call as="name" function="if" type="string">
          <call function="in">
            <column table="pwf" column="name" />
            <array>'prich','krm','krr'</array>
          </call>
          <const>'empty'</const>
          <column table="this" column="name_tit" />
        </call>
        <call function="case" type="string" as="time_id">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p3'</array>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'m'</array>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p1','k','p2'</array>
            </call>
            <call function="time y k id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="ofv" column="ordr" />
          <const>'_'</const>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'m'</array>
              </call>
              <column table="kv" column="ordr" />
            </call>
            <call function="else">
              <column table="per" column="ordr" />
            </call>
          </call>
          <const>'_'</const>
          <column table="pwf" column="ordr" />
          <const>'_'</const>
          <column table="per" column="ordr" />
          <const>'_'</const>
          <call function="nvl">
            <column table="sch" column="ordr" />
            <const>120</const>
          </call>
          <const>'_'</const>
          <column table="nds" column="ordr" />
        </call>
        <column table="ofv" column="title" as="title1" />
        <call function="nvl" type="string" as="title2">
          <column table="kv" column="title" />
          <column table="per" column="title" />
        </call>
        <call function="case" type="string" as="title3">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p0'</array>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="else">
            <column table="pwf" column="title" />
          </call>
        </call>
        <call function="case" type="string" as="title4">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'m'</array>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'k'</array>
            </call>
            <const>'Итого квартал'</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p0'</array>
            </call>
            <column table="per" column="title" />
          </call>
          <call function="else">
            <column table="pwf" column="title" />
          </call>
        </call>
        <call function="case" type="string" as="title5">
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <array>1,2</array>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <column table="per" column="end_mon" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
            </call>
            <const>'справочно '</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="sch" column="name" />
            </call>
            <const>'в том числе '</const>
          </call>
          <call function="else">
            <column table="this" column="title7" />
          </call>
        </call>
        <call function="case" type="string" as="title6">
          <call function="when">
            <call function="is null">
              <column table="sch" column="name" />
            </call>
            <column table="this" column="title9" />
          </call>
          <call function="else">
            <call function="||">
              <const>'Счет '</const>
              <call function="if">
                <call function="in">
                  <column table="sch" column="tip" />
                  <const>3</const>
                </call>
                <const>'08.03'</const>
                <column table="sch" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="case" type="string" as="title7">
          <call function="when">
            <call function="in">
              <column table="sch" column="tip" />
              <const>3</const>
            </call>
            <call function="if">
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <column table="per" column="end_mon" />
                    <const>0</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <column table="per" column="end_mon" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
              <const>'в том числе'</const>
              <const>'справочно'</const>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <const>3</const>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <const>'os'</const>
              </call>
            </call>
            <const>'Всего'</const>
          </call>
          <call function="else">
            <column table="this" column="title6" />
          </call>
        </call>
        <call function="case" type="string" as="title8">
          <call function="when">
            <call function="in">
              <column table="sch" column="tip" />
              <const>3</const>
            </call>
            <column table="sch" column="name" />
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <const>3</const>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <const>'os'</const>
              </call>
            </call>
            <column table="this" column="title7" />
          </call>
          <call function="else">
            <column table="this" column="title6" />
          </call>
        </call>
        <call function="if" as="title9">
          <call function="in">
            <column table="nds" column="name" />
            <array>'nn'</array>
          </call>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <const>'кроме того НДС'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'fn'</array>
              </call>
              <const>'в том числе НДС'</const>
            </call>
          </call>
          <call function="nvl">
            <column table="nds" column="title" />
            <column table="this" column="title4" />
          </call>
        </call>
        <call as="column_width" function="case" type="number">
          <call function="when">
            <call function="in">
              <column table="pwf" column="name" />
              <array>'prich'</array>
            </call>
            <const>70</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="pwf" column="name" />
              <array>'krm','krr'</array>
            </call>
            <const>45</const>
          </call>
        </call>
        <call function="||" as="source_info" exclude="1">
          <column table="ofv" column="title1" />
          <const>' '</const>
          <column table="pwf" column="title" />
          <const>' '</const>
          <column table="nds" column="title" />
        </call>
        <call function="||" as="cond_info" exclude="1">
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'m'</array>
              </call>
              <const>'Месяц'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'k'</array>
              </call>
              <const>'Квартал'</const>
            </call>
            <call function="else">
              <column table="per" column="title" />
            </call>
          </call>
          <call function="case" type="string">
            <call function="when">
              <call function="is not null">
                <column table="sch" column="name" />
              </call>
              <call function="||">
                <const>', '</const>
                <const>'Счет '</const>
                <call function="if">
                  <call function="in">
                    <column table="sch" column="tip" />
                    <const>3</const>
                  </call>
                  <const>'08.03'</const>
                  <column table="sch" column="name" />
                </call>
              </call>
            </call>
            <call function="when">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <call function="||">
                <const>', '</const>
                <const>'Счет 08.03, 08.41, 08.05'</const>
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="source_info">
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="sch" column="tip" />
                <const>3</const>
              </call>
              <const>'Интеграционная таблица'</const>
            </call>
            <call function="when">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="sch" column="name" />
                    <const>'08.03'</const>
                  </call>
                  <const>'08.03'</const>
                </call>
                <call function="in">
                  <column table="pwf" column="name" />
                  <const>'ft'</const>
                </call>
              </call>
              <call function="||">
                <column table="ofv" column="info2" />
              </call>
            </call>
            <call function="when">
              <call function="is not null">
                <column table="sch" column="name" />
              </call>
              <column table="ofv" column="info3" />
            </call>
            <call function="else">
              <call function="||">
                <column table="ofv" column="info1" />
                <const>' '</const>
                <column table="pwf" column="title" />
              </call>
            </call>
          </call>
          <const exclude="1">' '</const>
          <column table="nds" column="title" exclude="1" />
        </call>
        <call function="||" as="cond_info">
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'m'</array>
              </call>
              <const>'Месяц'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'k'</array>
              </call>
              <const>'Квартал'</const>
            </call>
            <call function="else">
              <column table="per" column="title" />
            </call>
          </call>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="sch" column="tip" />
                <const>3</const>
              </call>
              <call function="||">
                <const>', '</const>
                <column table="sch" column="name" />
              </call>
            </call>
            <call function="when">
              <call function="is not null">
                <column table="sch" column="name" />
              </call>
              <call function="||">
                <const>', Счет '</const>
                <column table="sch" column="name" />
              </call>
            </call>
            <call function="when">
              <call function="and">
                <call function="in">
                  <column table="ofv" column="name" />
                  <array>'os'</array>
                </call>
                <call function="in">
                  <column table="pwf" column="name" />
                  <const>'ft'</const>
                </call>
              </call>
              <const>', Счет 08.03 08.41 08.05'</const>
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-ofv" as="ofv" />
        <query name="26630-xl-cols-pwf" as="pwf" join="cross" />
        <query name="26630-xl-cols-ofv-nds" as="ofv_nds" join="left outer">
          <call function="and">
            <call function="in">
              <column table="pwf" column="name" />
              <array>'pl','wf','ft'</array>
            </call>
            <call function="=">
              <column table="ofv" column="name" />
              <column table="ofv_nds" column="ofv" />
            </call>
          </call>
        </query>
        <query name="26630-xl-cols-nds" as="nds" join="left outer">
          <call function="=">
            <column table="nds" column="name" />
            <column table="ofv_nds" column="nds" />
          </call>
        </query>
        <query name="26630-xl-cols-per" as="per" join="cross" />
        <query name="26630-xl-cols-kv" as="kv" join="left outer">
          <call function="=">
            <column table="kv" column="name" />
            <column table="per" column="kv" />
          </call>
        </query>
        <query name="26630-xl-cols-sch" as="sch" join="left outer">
          <call function="or">
            <call function="and">
              <call function="in">
                <column table="pwf" column="name" />
                <const>'ft'</const>
              </call>
              <call function="in">
                <column table="nds" column="name" />
                <array>'bn','sn'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="in">
                    <column table="ofv" column="name" />
                    <array>'os','fn'</array>
                  </call>
                  <call function="in">
                    <column table="sch" column="tip" />
                    <const>1</const>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="ofv" column="name" />
                    <array>'os'</array>
                  </call>
                  <call function="in">
                    <column table="sch" column="tip" />
                    <const>3</const>
                  </call>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'vv'</array>
              </call>
              <call function="in">
                <column table="pwf" column="name" />
                <const>'ft'</const>
              </call>
              <call function="in" exclude="1">
                <column table="nds" column="name" />
                <array>'bn','sn'</array>
              </call>
              <call function="in">
                <column table="sch" column="tip" />
                <const>2</const>
              </call>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="not in">
              <column table="per" column="tip" />
              <array>'p0'</array>
            </call>
            <call function="in">
              <column table="pwf" column="name" />
              <array>'pl'</array>
            </call>
          </call>
          <call function="or">
            <call function="not in">
              <column table="pwf" column="name" />
              <array>'otkl','prc','prich','krm','krr'</array>
            </call>
            <call function="and">
              <call function="in">
                <column table="per" column="tip" />
                <array>'p'</array>
              </call>
              <call function="in" exclude="1">
                <column table="nds" column="name" />
                <array>'bn','sn'</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="ofv" column="name" />
            <useparam name="ofv" />
          </call>
          <call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-cols-pwf" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'pl'</const>
      <const as="title" type="string">'План'</const>
      <const as="ordr" type="number">100</const>
      <const>'wf'</const>
      <const>'Ожидаемый факт'</const>
      <const>200</const>
      <const>'ft'</const>
      <const>'Факт'</const>
      <const>300</const>
      <const>'otkl'</const>
      <const>'Отклонение от плановых показателей'</const>
      <const>400</const>
      <const>'prc'</const>
      <const>'% выполнения'</const>
      <const>500</const>
      <const>'krm'</const>
      <const>'Критерий отклонения Минэнерго'</const>
      <const>600</const>
      <const>'krr'</const>
      <const>'Критерий отклонения Россети'</const>
      <const>700</const>
      <const>'prich'</const>
      <const>'Причины  отклонения от плановых показателей'</const>
      <const>800</const>
    </query>
    <query name="26630-xl-cols-nds" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'bn'</const>
      <const as="title" type="string">'Без НДС'</const>
      <const as="ordr" type="number">100</const>
      <const>'nn'</const>
      <const>'НДС'</const>
      <const>300</const>
      <const>'sn'</const>
      <const>'С НДС'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-cols-ofv-nds" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="ofv" type="string">'os'</const>
      <const as="nds" type="string">'bn'</const>
      <const>'os'</const>
      <const>'nn'</const>
      <const>'fn'</const>
      <const>'sn'</const>
      <const>'fn'</const>
      <const>'nn'</const>
      <const>'vv'</const>
      <const>'bn'</const>
      <const>'nzs'</const>
      <const>'bn'</const>
      <const>'dz'</const>
      <const>'sn'</const>
      <const>'kz'</const>
      <const>'sn'</const>
    </query>
    <query name="26630-xl-cols-ofndkz" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'os'</const>
      <const as="title" type="string">'Освоение'</const>
      <const as="info1" type="string">'Освоение'</const>
      <const as="info2" type="string">'Освоение факт с учетом передачи и данных интеграционной таблицы'</const>
      <const as="info3" type="string">'Освоение факт с учетом передачи'</const>
      <const as="ordr" type="number">100</const>
      <const>'fn'</const>
      <const>'Финансирование'</const>
      <const>'Финансирование'</const>
      <const>'Финансирование с учетом передачи'</const>
      <const>'Финансирование с учетом передачи'</const>
      <const>200</const>
      <const>'vv'</const>
      <const>'Ввод'</const>
      <const>'Ввод'</const>
      <const>'Ввод'</const>
      <const>'Ввод'</const>
      <const>250</const>
      <const>'nzs'</const>
      <const>'НЗС'</const>
      <const>'НЗС'</const>
      <const>'НЗС'</const>
      <const>'НЗС'</const>
      <const>300</const>
      <const>'dz'</const>
      <const>'ДЗ'</const>
      <const>'ДЗ'</const>
      <const>'ДЗ'</const>
      <const>'ДЗ'</const>
      <const>400</const>
      <const>'kz'</const>
      <const>'КЗ'</const>
      <const>'КЗ'</const>
      <const>'КЗ'</const>
      <const>'КЗ'</const>
      <const>500</const>
    </query>
    <query name="26630-xl-cols-ofv" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'os'</const>
      <const as="title" type="string">'Освоение капитальных вложений'</const>
      <const as="info1" type="string">'Освоение'</const>
      <const as="info2" type="string">'Освоение факт с учетом передачи текущего периода и данных интеграционной таблицы'</const>
      <const as="info3" type="string">'Освоение факт с учетом передачи текущего периода'</const>
      <const as="ordr" type="number">100</const>
      <const>'fn'</const>
      <const>'Финансирование капитальных вложений '</const>
      <const>'Финансирование'</const>
      <const>'Финансирование с учетом передачи текущего периода'</const>
      <const>'Финансирование с учетом передачи текущего периода'</const>
      <const>200</const>
      <const>'vv'</const>
      <const>'Ввод в основные фонды'</const>
      <const>'Ввод'</const>
      <const>'Ввод'</const>
      <const>'Ввод'</const>
      <const>300</const>
    </query>
    <query name="26630-xl-cols-dkz" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'dz'</const>
      <const as="title" type="string">'ДЗ'</const>
      <const as="ordr" type="number">100</const>
      <const>'kz'</const>
      <const>'КЗ'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-cols-spp" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'sp'</const>
      <const as="title" type="string">'Списание'</const>
      <const as="ordr" type="number">100</const>
      <const>'pp'</const>
      <const>'Передано/принято'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-cols-nfn" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'nzs'</const>
      <const as="title" type="string">'НЗС'</const>
      <const as="ordr" type="number">100</const>
      <const>'fin'</const>
      <const>'Финансирование'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-cols-ptg" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'ag'</const>
      <const as="title" type="string">'Всего'</const>
      <const as="ordr" type="number">100</const>
      <const>'pg'</const>
      <const>'Прошлого периода'</const>
      <const>200</const>
      <const>'tg'</const>
      <const>'Текущего периода'</const>
      <const>300</const>
    </query>
    <query name="26630-xl-cols-vpr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'vv'</const>
      <const as="title" type="string">'Ввод'</const>
      <const as="ordr" type="number">100</const>
      <const>'pr'</const>
      <const>'Прирост'</const>
      <const>200</const>
    </query>
    <query name="26630-xl-cols-sch-vvd" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'1'</const>
      <const as="title" type="string">'01'</const>
      <const as="ordr" type="number">150</const>
      <const>'4'</const>
      <const>'04'</const>
      <const>200</const>
      <const>null</const>
      <const>null</const>
      <const>100</const>
    </query>
    <query name="26630-xl-cols-sch-move" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'6'</const>
      <const as="title" type="string">'перенос с 07'</const>
      <const as="ordr" type="number">170</const>
      <const>'7'</const>
      <const>'перенос с 10.14,10.15'</const>
      <const>180</const>
    </query>
    <query name="26630-xl-cols-sch" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <select>
        <column table="a" column="kod" />
        <column table="a" column="name" />
        <column table="a" column="ordr" />
        <column table="a" column="tip" />
      </select>
      <from>
        <query as="a">
          <union>
            <query>
              <select>
                <column table="a" column="name" as="kod" />
                <column table="a" column="title" as="name" />
                <column table="a" column="ordr" />
                <const as="tip" type="number">2</const>
              </select>
              <from>
                <query name="26630-xl-cols-sch-vvd" as="a" />
              </from>
            </query>
            <query>
              <select>
                <column table="a" column="name" as="kod" />
                <column table="a" column="title" as="name" />
                <column table="a" column="ordr" />
                <const as="tip" type="number">3</const>
              </select>
              <from>
                <query name="26630-xl-cols-sch-move" as="a" />
              </from>
            </query>
            <query>
              <select>
                <call function="to_char" as="kod">
                  <column table="a" column="kod" />
                </call>
                <column table="a" column="name" />
                <column table="a" column="ordr" />
                <const as="tip" type="number">1</const>
              </select>
              <from>
                <query name="ips_vid_zatrat_schet" as="a" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols-fiz" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'mba'</const>
      <const as="title" type="string">'мва'</const>
      <const as="ordr" type="number">150</const>
      <const as="color" type="number">1</const>
      <const>'km'</const>
      <const>'км'</const>
      <const>200</const>
      <const>2</const>
      <const>'kmvl'</const>
      <const>'в т.ч. ВЛ, км'</const>
      <const>300</const>
      <const>1</const>
      <const>'kmvl1'</const>
      <const>'в т.ч. 1-цепные ВЛ, км'</const>
      <const>330</const>
      <const>2</const>
      <const>'kmvl2'</const>
      <const>'в т.ч. 2-цепные ВЛ, км'</const>
      <const>370</const>
      <const>1</const>
      <const>'kmkl'</const>
      <const>'в т.ч. КЛ, км'</const>
      <const>400</const>
      <const>2</const>
      <const>'pstp'</const>
      <const>'ПС/ТП, шт'</const>
      <const>500</const>
      <const>1</const>
      <const>'prch'</const>
      <const>'прочие, шт'</const>
      <const>600</const>
      <const>2</const>
      <const>'any'</const>
      <const>'Наличие физ параметров'</const>
      <const>100</const>
      <const>0</const>
    </query>
    <query name="26630-xl-cols-per" timestamp="04.01.2018 22:15:00" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'01'</const>
      <const as="title" type="string">'Январь'</const>
      <const as="ordr" type="string">'150'</const>
      <const as="tip" type="string">'m'</const>
      <const as="kv" type="string">'1'</const>
      <const as="end_mon" type="number">1</const>
      <const>'02'</const>
      <const>'Февраль'</const>
      <const>'200'</const>
      <const>'m'</const>
      <const>'1'</const>
      <const>2</const>
      <const>'03'</const>
      <const>'Март'</const>
      <const>'300'</const>
      <const>'m'</const>
      <const>'1'</const>
      <const>3</const>
      <const>'04'</const>
      <const>'Апрель'</const>
      <const>'400'</const>
      <const>'m'</const>
      <const>'2'</const>
      <const>4</const>
      <const>'05'</const>
      <const>'Май'</const>
      <const>'500'</const>
      <const>'m'</const>
      <const>'2'</const>
      <const>5</const>
      <const>'06'</const>
      <const>'Июнь'</const>
      <const>'600'</const>
      <const>'m'</const>
      <const>'2'</const>
      <const>6</const>
      <const>'07'</const>
      <const>'Июль'</const>
      <const>'700'</const>
      <const>'m'</const>
      <const>'3'</const>
      <const>7</const>
      <const>'08'</const>
      <const>'Август'</const>
      <const>'800'</const>
      <const>'m'</const>
      <const>'3'</const>
      <const>8</const>
      <const>'09'</const>
      <const>'Сентябрь'</const>
      <const>'900'</const>
      <const>'m'</const>
      <const>'3'</const>
      <const>9</const>
      <const>'10'</const>
      <const>'Октябрь'</const>
      <const>'910'</const>
      <const>'m'</const>
      <const>'4'</const>
      <const>10</const>
      <const>'11'</const>
      <const>'Ноябрь'</const>
      <const>'920'</const>
      <const>'m'</const>
      <const>'4'</const>
      <const>11</const>
      <const>'12'</const>
      <const>'Декабрь'</const>
      <const>'930'</const>
      <const>'m'</const>
      <const>'4'</const>
      <const>12</const>
      <const>'1'</const>
      <const>'I квартал'</const>
      <const>'130'</const>
      <const>'k'</const>
      <const>'1'</const>
      <const>3</const>
      <const>'2'</const>
      <const>'II Квартал'</const>
      <const>'350'</const>
      <const>'k'</const>
      <const>'2'</const>
      <const>6</const>
      <const>'3'</const>
      <const>'III Квартал'</const>
      <const>'650'</const>
      <const>'k'</const>
      <const>'3'</const>
      <const>9</const>
      <const>'4'</const>
      <const>'IV Квартал'</const>
      <const>'905'</const>
      <const>'k'</const>
      <const>'4'</const>
      <const>12</const>
      <const>'5'</const>
      <const>'I Полугодие'</const>
      <const>'380'</const>
      <const>'p1'</const>
      <const>''</const>
      <const>6</const>
      <const>'6'</const>
      <const>'9 месяцев'</const>
      <const>'680'</const>
      <const>'p2'</const>
      <const>''</const>
      <const>9</const>
      <const>'3'</const>
      <const>'За отчетный период'</const>
      <const>'110'</const>
      <const>'p'</const>
      <const>''</const>
      <const>0</const>
      <const>'0'</const>
      <const>'Всего план на год'</const>
      <const>'105'</const>
      <const>'p0'</const>
      <const>''</const>
      <const>12</const>
      <const>'7'</const>
      <const>'Год'</const>
      <const>'950'</const>
      <const>'p3'</const>
      <const>''</const>
      <const>12</const>
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
      <!--|-->
    </query>
    <query name="26630-xl-cols-kv" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <const as="name" type="string">'1'</const>
      <const as="title" type="string">'I квартал'</const>
      <const as="ordr" type="string">'130'</const>
      <const>'2'</const>
      <const>'II Квартал'</const>
      <const>'350'</const>
      <const>'3'</const>
      <const>'III Квартал'</const>
      <const>'650'</const>
      <const>'4'</const>
      <const>'IV Квартал'</const>
      <const>'905'</const>
    </query>
    <query name="26630-xl-cols2" timestamp="17.01.2017 21:15:01" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="||" as="name" key="1">
          <column table="dkz" column="name" />
          <const>'_'</const>
          <column table="pwf" column="name" />
          <const>'_'</const>
          <const>'sn'</const>
          <const>'_'</const>
          <const>'cm'</const>
          <const>'_'</const>
          <call function="to_char">
            <column table="this" column="time_id_mon" />
          </call>
        </call>
        <call function="time y k id" as="time_id">
          <useparam name="year" />
          <column table="kv" column="name" />
        </call>
        <call function="time y m id" as="time_id_mon">
          <useparam name="year" />
          <call function="kv end mes">
            <call function="to_number">
              <column table="kv" column="name" />
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="kv" column="ordr" />
          <const>'_'</const>
          <column table="pwf" column="ordr" />
          <const>'_'</const>
          <column table="dkz" column="ordr" />
        </call>
        <const type="string" as="title1">'Анализ ДЗ, КЗ'</const>
        <column table="kv" column="title" as="title2" />
        <column table="pwf" column="title" as="title3" />
        <column table="dkz" column="title" as="title4" />
        <const type="string" as="title5">'C НДС'</const>
      </select>
      <from>
        <query name="26630-xl-cols-pwf" as="pwf" />
        <query name="26630-xl-cols-kv" as="kv" join="cross" />
        <query name="26630-xl-cols-dkz" join="cross" as="dkz" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','wf','ft'</array>
          </call>
          <call function="in" optional="1">
            <column table="this" column="time_id" />
            <useparam name="period" />
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-cols3" timestamp="15.01.2017 22:23:44" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="||" as="name" key="1">
          <column table="vpr" column="name" />
          <const>'_'</const>
          <column table="fiz" column="name" />
          <const>'_'</const>
          <column table="pwf" column="name" />
        </call>
        <call function="||" as="ordr">
          <column table="vpr" column="ordr" />
          <const>'_'</const>
          <column table="fiz" column="ordr" />
          <const>'_'</const>
          <column table="pwf" column="ordr" />
        </call>
        <const type="string" as="title1">'Раздел ввода физ объемов'</const>
        <column table="vpr" column="title" as="title2" />
        <column table="fiz" column="title" as="title3" />
        <column table="pwf" column="title" as="title4" />
        <column table="pwf" column="title" as="title5" />
      </select>
      <from>
        <query name="26630-xl-cols-pwf" as="pwf" />
        <query name="26630-xl-cols-vpr" as="vpr" join="cross" />
        <query name="26630-xl-cols-fiz" as="fiz" join="cross" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','wf','ft'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-cols4" timestamp="17.02.2017 13:52:41" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="||" as="name" key="1">
          <column table="nfn" column="name" />
          <const>'_'</const>
          <column table="spp" column="name" />
          <const>'_'</const>
          <column table="ptg" column="name" />
          <const>'_'</const>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'k'</array>
              </call>
              <call function="to_char">
                <call function="time y k id">
                  <useparam name="year" />
                  <call function="to_number">
                    <column table="per" column="name" />
                  </call>
                </call>
              </call>
            </call>
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'p'</array>
              </call>
              <const>'0'</const>
            </call>
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="per" column="ordr" />
          <const>'_'</const>
          <column table="nfn" column="ordr" />
          <const>'_'</const>
          <column table="spp" column="ordr" />
          <const>'_'</const>
          <column table="ptg" column="ordr" />
        </call>
        <const type="string" as="title1">'Движение актов выполненных работ (прием/передача)'</const>
        <column table="per" column="title" as="title2" />
        <column table="nfn" column="title" as="title3" />
        <column table="spp" column="title" as="title4" />
        <call function="if" as="title5" type="string">
          <call function="in">
            <column table="spp" column="name" />
            <array>'pp'</array>
          </call>
          <column table="ptg" column="title" />
          <column table="this" column="title4" />
        </call>
        <call function="if" as="title6" type="string">
          <call function="in">
            <column table="nfn" column="name" />
            <array>'fin'</array>
          </call>
          <const>'C НДС'</const>
          <const>'Без НДС'</const>
        </call>
        <call function="case" type="string" as="time_id">
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p3'</array>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'m'</array>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="per" column="tip" />
              <array>'p1','k','p2'</array>
            </call>
            <call function="time y k id">
              <useparam name="year" />
              <call function="to_number">
                <column table="per" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="||" as="source_info">
          <column table="spp" column="title" />
          <const>' '</const>
        </call>
        <call function="||" as="cond_info">
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'m'</array>
              </call>
              <const>'Месяц'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="per" column="tip" />
                <array>'k'</array>
              </call>
              <const>'Квартал'</const>
            </call>
            <call function="else">
              <column table="per" column="title" />
            </call>
          </call>
          <call function="if" as="title5" type="string">
            <call function="!=">
              <column table="ptg" column="name" />
              <const>'ag'</const>
            </call>
            <call function="||">
              <const>', '</const>
              <column table="ptg" column="title" />
            </call>
          </call>
          <const>' '</const>
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-spp" as="spp" />
        <query name="26630-xl-cols-nfn" join="cross" as="nfn" />
        <query name="26630-xl-cols-ptg" as="ptg" join="cross" />
        <query name="26630-xl-cols-per" join="cross" as="per" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="per" column="tip" />
            <array>'k','p'</array>
          </call>
          <call function="or">
            <call function="in">
              <column table="spp" column="name" />
              <array>'pp'</array>
            </call>
            <call function="in">
              <column table="ptg" column="name" />
              <array>'ag'</array>
            </call>
          </call>
          <call function="or" optional="1">
            <call function="is null">
              <column table="this" column="time_id" />
            </call>
            <call function="in">
              <column table="this" column="time_id" />
              <useparam name="period" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-cols0" timestamp="07.01.2018 03:03:31" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
        <param type="string" name="pfx">
          <const>'beg'</const>
        </param>
      </params>
      <select>
        <call function="||" as="name" key="1">
          <column table="ofv" column="name" />
          <const>'_'</const>
          <column table="pwf" column="name" />
          <call function="if">
            <call function="is not null">
              <column table="nds" column="name" />
            </call>
            <call function="||">
              <const>'_'</const>
              <column table="nds" column="name" />
            </call>
          </call>
          <const>'_'</const>
          <const>'cm'</const>
          <call function="if">
            <call function="is not null">
              <column table="sch" column="name" />
            </call>
            <call function="||">
              <const>'_s'</const>
              <column table="sch" column="kod" />
            </call>
          </call>
          <call function="if">
            <call function="and">
              <call function="or">
                <call function="in">
                  <column table="sch" column="kod" />
                  <array>3</array>
                </call>
                <call function="is null">
                  <column table="sch" column="name" />
                </call>
              </call>
              <call function="in">
                <column table="pwf" column="name" />
                <array>'otkl','ft'</array>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="gt">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon1" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="gt">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
            </call>
            <const>'_n'</const>
          </call>
          <const>'_'</const>
          <call function="if" type="string">
            <call function="=">
              <useparam name="pfx" />
              <const>'beg'</const>
            </call>
            <call function="time ym2 id">
              <call function="ym2 add month">
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <const>-1</const>
              </call>
            </call>
            <call function="time y m id">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
        </call>
        <call function="||" as="name_smet">
          <call function="if">
            <call function="in">
              <column table="ofv" column="name" />
              <array>'dz','kz'</array>
            </call>
            <const>'smet_'</const>
          </call>
          <column table="this" column="name" />
        </call>
        <call function="||" as="name_dog">
          <call function="if">
            <call function="in">
              <column table="ofv" column="name" />
              <array>'dz','kz'</array>
            </call>
            <const>'dog_'</const>
          </call>
          <column table="this" column="name" />
        </call>
        <call function="||" as="name_zt">
          <call function="if">
            <call function="in">
              <column table="ofv" column="name" />
              <array>'dz','kz'</array>
            </call>
            <const>'empty'</const>
            <column table="this" column="name" />
          </call>
        </call>
        <call function="||" as="ordr">
          <column table="pwf" column="ordr" />
          <const>'_'</const>
          <column table="ofv" column="ordr" />
          <const>'_'</const>
          <call function="nvl">
            <column table="sch" column="ordr" />
            <const>120</const>
          </call>
          <const>'_'</const>
          <column table="nds" column="ordr" />
        </call>
        <column table="pwf" column="title" as="title2" />
        <column table="ofv" column="title" as="title3" />
        <column table="ofv" column="title" as="title4" />
        <call function="case" type="string" as="title5">
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <array>1,2</array>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon1" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
            </call>
            <const>'справочно '</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="sch" column="name" />
            </call>
            <const>'в том числе '</const>
          </call>
          <call function="else">
            <column table="this" column="title7" />
          </call>
        </call>
        <call function="case" type="string" as="title6">
          <call function="when">
            <call function="is null">
              <column table="sch" column="name" />
            </call>
            <column table="this" column="title9" />
          </call>
          <call function="else">
            <call function="||">
              <const>'Счет '</const>
              <call function="if">
                <call function="in">
                  <column table="sch" column="tip" />
                  <const>3</const>
                </call>
                <const>'08.03'</const>
                <column table="sch" column="name" />
              </call>
            </call>
          </call>
        </call>
        <call function="case" type="string" as="title7">
          <call function="when">
            <call function="in">
              <column table="sch" column="tip" />
              <const>3</const>
            </call>
            <call function="if">
              <call function="or">
                <call function="and">
                  <call function="=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="le">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon1" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
                <call function="and">
                  <call function="!=">
                    <useparam name="pfx" />
                    <const>'beg'</const>
                  </call>
                  <call function="lt">
                    <call function="num to ym2">
                      <useparam name="year" />
                      <useparam name="mon2" />
                    </call>
                    <const>201709</const>
                  </call>
                </call>
              </call>
              <const>'в том числе'</const>
              <const>'справочно'</const>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <const>3</const>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <const>'os'</const>
              </call>
            </call>
            <const>'Всего'</const>
          </call>
          <call function="else">
            <column table="this" column="title6" />
          </call>
        </call>
        <call function="case" type="string" as="title8">
          <call function="when">
            <call function="in">
              <column table="sch" column="tip" />
              <const>3</const>
            </call>
            <column table="sch" column="name" />
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="sch" column="kod" />
                <const>3</const>
              </call>
              <call function="in">
                <column table="ofv" column="name" />
                <const>'os'</const>
              </call>
            </call>
            <column table="this" column="title7" />
          </call>
          <call function="else">
            <column table="this" column="title6" />
          </call>
        </call>
        <call function="if" as="title9">
          <call function="in">
            <column table="nds" column="name" />
            <array>'nn'</array>
          </call>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'os'</array>
              </call>
              <const>'кроме того НДС'</const>
            </call>
            <call function="when">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'fn'</array>
              </call>
              <const>'в том числе НДС'</const>
            </call>
          </call>
          <column table="nds" column="title" />
        </call>
        <call function="||" as="source_info">
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="sch" column="tip" />
                <const>3</const>
              </call>
              <const>'Интеграционная таблица'</const>
            </call>
            <call function="when">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="sch" column="name" />
                    <const>'08.03'</const>
                  </call>
                  <const>'08.03'</const>
                </call>
                <call function="in">
                  <column table="pwf" column="name" />
                  <const>'ft'</const>
                </call>
              </call>
              <call function="||">
                <column table="ofv" column="info2" />
              </call>
            </call>
            <call function="when">
              <call function="is not null">
                <column table="sch" column="name" />
              </call>
              <column table="ofv" column="info3" />
            </call>
            <call function="else">
              <call function="||">
                <column table="ofv" column="info1" />
                <const>' '</const>
                <column table="pwf" column="title" />
              </call>
            </call>
          </call>
          <const exclude="1">' '</const>
          <column table="nds" column="title" exclude="1" />
        </call>
        <call function="||" as="cond_info">
          <call function="if" type="string">
            <call function="=">
              <useparam name="pfx" />
              <const>'beg'</const>
            </call>
            <const>'На начало отчетного периода'</const>
            <const>'На конец отчетного периода'</const>
          </call>
          <call function="case" type="string">
            <call function="when">
              <call function="in">
                <column table="sch" column="tip" />
                <const>3</const>
              </call>
              <call function="||">
                <const>', '</const>
                <column table="sch" column="name" />
              </call>
            </call>
            <call function="when">
              <call function="is not null">
                <column table="sch" column="name" />
              </call>
              <call function="||">
                <const>', Счет '</const>
                <column table="sch" column="name" />
              </call>
            </call>
            <call function="when">
              <call function="and">
                <call function="in">
                  <column table="ofv" column="name" />
                  <array>'os'</array>
                </call>
                <call function="in">
                  <column table="pwf" column="name" />
                  <const>'ft'</const>
                </call>
              </call>
              <const>', Счет 08.03 08.41 08.05'</const>
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="26630-xl-cols-ofndkz" as="ofv" />
        <query name="26630-xl-cols-pwf" as="pwf" join="cross" />
        <query name="26630-xl-cols-ofv-nds" as="ofv_nds" join="left outer">
          <call function="and">
            <call function="in">
              <column table="pwf" column="name" />
              <array>'pl','wf','ft'</array>
            </call>
            <call function="=">
              <column table="ofv" column="name" />
              <column table="ofv_nds" column="ofv" />
            </call>
          </call>
        </query>
        <query name="26630-xl-cols-nds" as="nds" join="left outer">
          <call function="=">
            <column table="nds" column="name" />
            <column table="ofv_nds" column="nds" />
          </call>
        </query>
        <query name="26630-xl-cols-sch" as="sch" join="left outer">
          <call function="or">
            <call function="and">
              <call function="in">
                <column table="pwf" column="name" />
                <const>'ft'</const>
              </call>
              <call function="in">
                <column table="nds" column="name" />
                <array>'bn','sn'</array>
              </call>
              <call function="or">
                <call function="and">
                  <call function="in">
                    <column table="ofv" column="name" />
                    <array>'os','fn'</array>
                  </call>
                  <call function="in">
                    <column table="sch" column="tip" />
                    <const>1</const>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="ofv" column="name" />
                    <array>'os'</array>
                  </call>
                  <call function="in">
                    <column table="sch" column="tip" />
                    <const>3</const>
                  </call>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="ofv" column="name" />
                <array>'vv'</array>
              </call>
              <call function="in">
                <column table="pwf" column="name" />
                <const>'ft'</const>
              </call>
              <call function="in" exclude="1">
                <column table="nds" column="name" />
                <array>'bn','sn'</array>
              </call>
              <call function="in">
                <column table="sch" column="tip" />
                <const>2</const>
              </call>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="pwf" column="name" />
            <array>'pl','wf','ft'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-xl-cols0b" timestamp="16.01.2017 00:16:38" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols0" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'beg'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols0e" timestamp="16.01.2017 00:19:18" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols0" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'end'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols1o" timestamp="16.01.2017 00:36:12" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols1" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'os'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols1f" timestamp="16.01.2017 00:36:31" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols1" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'fn'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-xl-cols1v" timestamp="16.01.2017 00:36:56" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-cols.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-xl-cols1" as="a">
          <withparams>
            <usepart part="26630-withparams" />
            <const>'vv'</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="26630-pivot-ym" timestamp="18.01.2017 01:12:51" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-pivot-queries.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="kod" key="1" />
        <column table="a" column="name" />
        <column table="a" column="kod" as="ordr" />
      </select>
      <from>
        <query name="spr_time_intervals" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="kod" />
            <call function="time ym2 id">
              <call function="ym2 add month">
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <const>-1</const>
              </call>
            </call>
            <call function="time ym2 id">
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>
          </call>
          <call function="in">
            <column table="a" column="time_type" />
            <array>'Месяц'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-pivot-kv" timestamp="18.01.2017 02:40:26" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-pivot-queries.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="kod" key="1" />
        <column table="a" column="name" />
        <column table="a" column="kod" as="ordr" />
      </select>
      <from>
        <query name="spr_time_intervals" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="kod" />
            <call function="time y k id">
              <call function="ym2 god">
                <call function="ym2 add month">
                  <call function="num to ym2">
                    <useparam name="year" />
                    <useparam name="mon1" />
                  </call>
                  <const>-1</const>
                </call>
              </call>
              <call function="ym2 to kv">
                <call function="ym2 add month">
                  <call function="num to ym2">
                    <useparam name="year" />
                    <useparam name="mon1" />
                  </call>
                  <const>-1</const>
                </call>
              </call>
            </call>
            <call function="time y k id">
              <useparam name="year" />
              <call function="ym2 to kv">
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon2" />
                </call>
              </call>
            </call>
          </call>
          <call function="in">
            <column table="a" column="time_type" />
            <array>'Квартал'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-pivot-m6" timestamp="18.01.2017 01:16:56" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-pivot-queries.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="kod" key="1" />
        <column table="a" column="name" />
        <column table="a" column="kod" as="ordr" />
      </select>
      <from>
        <query name="spr_time_intervals" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod" />
            <call function="time y k id">
              <useparam name="year" />
              <const>5</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-pivot-m9" timestamp="18.01.2017 01:17:47" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-pivot-queries.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="kod" key="1" />
        <column table="a" column="name" />
        <column table="a" column="kod" as="ordr" />
      </select>
      <from>
        <query name="spr_time_intervals" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod" />
            <call function="time y k id">
              <useparam name="year" />
              <const>6</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-pivot-op" timestamp="24.01.2017 17:42:21" order="ordr" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-xl-pivot-queries.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <call function="()" as="kod" type="number">
          <const>0</const>
        </call>
        <call function="()" type="string" as="name">
          <const>'Отчетный период'</const>
        </call>
        <call function="()" type="number" as="ordr">
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="26630-mp" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <const as="kod_mp" type="number">-6</const>
      <const as="name" type="string">'млн. руб.'</const>
      <const>-3</const>
      <const>'тыс. руб.'</const>
      <const>0</const>
      <const>'руб.'</const>
    </query>
    <query name="26630-cols" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <const as="id" type="string">'План'</const>
      <const as="name" type="string">'План'</const>
      <const>'Факт'</const>
      <const>'Факт'</const>
    </query>
    <query name="26630_time_intervals_def" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <param name="year" type="number" />
        <param name="mon1" type="number" />
        <param name="mon2" type="number" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630_time_intervals" as="a">
          <withparams>
            <useparam name="year" />
            <useparam name="mon1" />
            <useparam name="mon2" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="le">
            <call function="date to ym2">
              <column table="a" column="date_end" />
            </call>
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630_time_intervals" order="date_end,date_begin desc" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <param name="year" type="number" />
        <param name="mon1" type="number" />
        <param name="mon2" type="number" />
      </params>
      <select>
        <call function="if" as="kod" type="number" key="1">
          <call function="!=">
            <column table="a" column="time_type" />
            <const>'Год'</const>
          </call>
          <column table="a" column="kod" />
          <const>0</const>
        </call>
        <call function="if" as="name" type="string">
          <call function="!=">
            <column table="a" column="time_type" />
            <const>'Год'</const>
          </call>
          <column table="a" column="name" />
          <const>'Год'</const>
        </call>
        <column table="a" column="kod_parent" />
        <column table="a" column="time_type" title="" />
        <column table="a" column="in_year_id" />
        <!--<column table="a" column="period_id"/>-->
        <column table="a" column="date_begin" />
        <column table="a" column="date_end" />
      </select>
      <from>
        <query name="spr_time_intervals1" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="ge">
            <call function="date to ym2">
              <column table="a" column="date_begin" />
            </call>
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon1" />
            </call>
          </call>
          <call function="le">
            <call function="date to ym2">
              <column table="a" column="date_begin" />
            </call>
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
          <!--<call function="!=">
            <column table="a" column="time_type" />
            <const>'Год'</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="26630_mon_def" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <select>
        <const as="mon" type="number">12</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="26630_tituls" timestamp="13.07.2017 14:09:18" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <param name="kod_doc" type="number">
          <const>143404</const>
        </param>
        <param name="kod_subject" type="array" />
        <param name="kod_direct" type="array" />
        <param name="pr_sbor" type="number" />
        <param name="pr_child" type="number" />
        <param name="kod_dirisp" type="number" />
        <param name="kod_ofz" type="number" />
      </params>
      <select>
        <column table="tree" column="kod_node" key="1" />
        <column table="tree" column="tit_num_new" />
        <column table="tree" column="kod_titul_ip" />
        <column table="tree" column="kod_ipr" />
        <column table="tree" column="kod_parent_node" />
        <column table="tree" column="full_name" />
        <column table="tree" column="itip" />
        <column table="tree" column="razdel_vid_full" title="Раздел" />
        <column table="kod_direct" column="name" as="direct_name" title="Подразделение заказчика" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" title="Подразделение исполнителя" />
        <column table="kod_subject" column="name" as="subject_name" exclude="1" />
        <call function="nvl" type="string" as="subject_name">
          <column table="kod_subject" column="name" as="subject_name" />
          <column table="kod_subject1" column="name" as="subject_name" />
        </call>
      </select>
      <from>
        <query name="25499-tree-pre-nofilter" as="tree">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
          </withparams>
        </query>
        <query name="ipr_titul_ip" as="kod_titul_ip" join="left outer">
          <using>
            <column column="kod_titul_ip" />
          </using>
          <link name="kod_direct" />
          <link name="kod_ispolnit" />
          <link name="kod_subject" as="kod_subject1" />
        </query>
        <query name="ipr_ipr_data" as="kod_ipr" join="left outer">
          <using>
            <column column="kod_ipr" />
          </using>
          <link name="kod_main_titul">
            <link name="kod_subject" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="tree" column="kod_titul_ip" />
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
        </call>
      </where>
    </query>
    <query name="26630-dat-grsets" timestamp="02.11.2016 18:05:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-dat-new2" as="a">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <grsets materialize-type="temp-table">
            <grset level="7" title="Итого" as="i">
              <grset level="2" title="По статьям сметы" as="ism" order="kod_smet">
                <where>
                  <usepart part="26630-smet-cond" />
                </where>
              </grset>
              <grset level="4" title="По прочим затратам" as="izt">
                <where>
                  <usepart part="26630-zt-cond" />
                </where>
              </grset>
              <grset level="6" title="По титулам" as="igt">
                <grset level="" title="По сборному титулу" as="gtst">
                  <where>
                    <call function="and">
                      <call function="is not null">
                        <column table="a" column="tit_num_new_sbor" />
                      </call>
                      <call function="=">
                        <call function="nvlu">
                          <useparam name="pr_sbor" />
                          <const>0</const>
                        </call>
                        <const>1</const>
                      </call>
                    </call>
                  </where>
                  <grset level="2" title="По статьям сметы" as="stsm" order="kod_smet">
                    <where>
                      <usepart part="26630-smet-cond" />
                    </where>
                  </grset>
                  <grset level="4" title="По прочим затратам" as="stzt">
                    <where>
                      <usepart part="26630-zt-cond" />
                    </where>
                  </grset>
                </grset>
                <grset level="1" title="По одиночным и головным титулам" as="gttt">
                  <grset level="" title="По одиночному титулу" as="ttot">
                    <where>
                      <call function="=">
                        <call function="nvl">
                          <column table="a" column="is_head_tit" />
                          <const>0</const>
                        </call>
                        <const>0</const>
                      </call>
                    </where>
                    <grset level="2" title="По статьям сметы" as="otsm" order="kod_smet">
                      <where>
                        <usepart part="26630-smet-cond" />
                      </where>
                    </grset>
                    <grset level="4" title="По прочим затратам" as="otzt">
                      <where>
                        <usepart part="26630-zt-cond" />
                      </where>
                    </grset>
                    <grset level="" title="По договорам(итог)" as="otdi">
                      <where>
                        <usepart part="26630-dog-cond" />
                      </where>
                      <grset level="3" title="По договорам" as="otdg" />
                    </grset>
                  </grset>
                  <grset level="" title="По головному титулу" as="ttmt">
                    <where>
                      <call function="=">
                        <column table="a" column="is_head_tit" />
                        <const>1</const>
                      </call>
                    </where>
                    <grset level="2" title="По статьям сметы" as="mtsm" order="kod_smet">
                      <where>
                        <usepart part="26630-smet-cond" />
                      </where>
                    </grset>
                    <grset level="4" title="По прочим затратам" as="mtzt">
                      <where>
                        <usepart part="26630-zt-cond" />
                      </where>
                    </grset>
                    <grset level="" title="По договорам(итог)" as="mtdi">
                      <where>
                        <call function="and">
                          <usepart part="26630-dog-cond" />
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_child" />
                              <const>0</const>
                            </call>
                            <const>0</const>
                          </call>
                        </call>
                      </where>
                      <grset level="3" title="По договорам" as="mtdg" />
                    </grset>
                    <grset level="5" title="По дочерним титулам" as="mtdt">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_child_titul" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_child" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                      <grset level="2" title="По статьям сметы" as="dtsm" order="kod_smet">
                        <where>
                          <usepart part="26630-smet-cond" />
                        </where>
                      </grset>
                      <grset level="4" title="По прочим затратам" as="dtzt">
                        <where>
                          <usepart part="26630-zt-cond" />
                        </where>
                      </grset>
                      <grset level="" title="По договорам(итог)" as="dtdi">
                        <where>
                          <usepart part="26630-dog-cond" />
                        </where>
                        <grset level="3" title="По договорам" as="dtdg" />
                      </grset>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="and">
            <call function="is not null">
              <column table="a" column="pr_plan" />
            </call>
            <call function="not 0">
              <column table="a" column="summ_usr" />
              <column table="a" column="summ_psd" />
              <column table="a" column="dog_plan_cost" />
              <column table="a" column="kap_sum_itog_eg" />
              <column table="a" column="fp_sum_nds_itog_eg" />
              <column table="a" column="vvod_sum_itog_eg" />
              <column table="a" column="kap_sum_fact_itog_eg" />
              <column table="a" column="fp_sum_nds_fact_itog_eg" />
              <column table="a" column="vvod_sum_fact_itog_eg" />
            </call>
          </call>
          <call function="and">
            <call function="is null">
              <column table="a" column="pr_plan" />
            </call>
            <call function="not 0">
              <column table="a" column="fp_sum_nds_fact_all" />
              <column table="a" column="kap_sum_fact_all" />
              <column table="a" column="vvod_sum_fact_all" />
              <column table="a" column="nzs_fact_itog_eg" />
              <column table="a" column="kredit_fact_itog_dog_eg" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-dat-grsets-vvod" timestamp="16.08.2016 16:47:17" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-dat-vvod-new-2" as="a">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <grsets materialize-type="temp-table">
            <grset level="7" title="Итого" as="i">
              <grset level="6" title="По титулам" as="igt">
                <grset level="" title="По сборному титулу" as="gtst">
                  <where>
                    <call function="and">
                      <call function="is not null">
                        <column table="a" column="tit_num_new_sbor" />
                      </call>
                      <call function="=">
                        <call function="nvlu">
                          <useparam name="pr_sbor" />
                          <const>0</const>
                        </call>
                        <const>1</const>
                      </call>
                    </call>
                  </where>
                </grset>
                <grset level="1" title="По одиночным и головным титулам" as="gttt">
                  <grset level="" title="По одиночному титулу" as="ttot">
                    <where>
                      <call function="=">
                        <call function="nvl">
                          <column table="a" column="is_head_tit" />
                          <const>0</const>
                        </call>
                        <const>0</const>
                      </call>
                    </where>
                  </grset>
                  <grset level="" title="По головному титулу" as="ttmt">
                    <where>
                      <call function="=">
                        <column table="a" column="is_head_tit" />
                        <const>1</const>
                      </call>
                    </where>
                    <grset level="5" title="По дочерним титулам" as="mtdt">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_child_titul" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_child" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
      <!--<where>
        <call function="not 0">
          <column table="a" column="summ_usr" />
          <column table="a" column="summ_psd" />
          <column table="a" column="dog_plan_cost" />
          <column table="a" column="kap_sum_itog_eg" />
          <column table="a" column="fp_sum_nds_itog_eg" />
          <column table="a" column="vvod_sum_itog_eg" />
          <column table="a" column="kap_sum_fact_itog_eg" />
          <column table="a" column="fp_sum_nds_fact_itog_eg" />
          <column table="a" column="vvod_sum_fact_itog_eg" />
        </call>
      </where>-->
    </query>
    <query name="26630_list_ipr_data_default" timestamp="02.02.2017 18:42:05" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <param name="kod_doc" type="number">
          <const>143404</const>
        </param>
        <param name="kod_titul_ip" type="array" />
      </params>
      <select>
        <column table="a" column="kod_titul_ip" key="1" />
        <column table="kod_titul_ip" column="tit_num_new" />
      </select>
      <from>
        <query name="ipr_ipr_data" as="a" join="left outer">
          <link name="kod_titul_ip" />
          <link name="kod_main_titul">
            <link name="kod_sbor_titul" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or">
            <call function="false" />
            <call function="in" optional="1">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in" optional="1">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in" optional="1">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="27332" order="rwn" timestamp="24.10.2016 19:39:08" file="sql.builder.templates\sql.builder\projects\ipr\reports\27332.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <select>
        <usepart part="25499-columns" />
        <column table="dat" column="*" />
      </select>
      <from>
        <query name="25499-tree" as="tree">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="year" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="27332-dat" as="dat" join="left outer">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="pr_child" />
            <useparam name="kod_ofz" />
          </withparams>
          <using>
            <column column="kod_titul_ip" />
          </using>
        </query>
      </from>
    </query>
    <query name="27332-dat" timestamp="24.10.2016 19:38:53" file="sql.builder.templates\sql.builder\projects\ipr\reports\27332.xml">
      <params>
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="year">
          <const>2014</const>
        </param>
        <param name="pr_child">
          <const>1</const>
        </param>
        <param name="kod_ofz" />
      </params>
      <select>
        <usepart part="25499-dat-kod_titul_ip" />
        <column table="ipr_ipr_data" column="kod_doc_osn" group="max" />
        <column table="ipr_ipr_data" column="pr_last" group="max" />
        <column table="kod_titul_ip" column="beg_year" group="min" />
        <column table="kod_titul_ip" column="end_year" group="max" />
        <column table="kod_direct" column="name" as="direct_name" group="max" />
        <column table="kod_subject" column="name" as="subject_name" group="max" />
        <column table="a" column="summ_bn" group="sum" mp="-6" />
        <column table="a" column="vvod_sum_itog" as="vvod_sum_do" title="Ввод мощностей в ОФ (руб.) на начало N года" group="sum" mp="-6" if="do">
          <section>
            <call function="num to ym2">
              <call function="-">
                <useparam name="year" />
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
        </column>
        <column table="a" column="vvod_sum" as="vvod_sum_first" title="Ввод мощностей в ОФ (руб.) за N год" group="sum" mp="-6" if="first">
          <if>
            <call function="=">
              <column table="a" column="year" />
              <useparam name="year" />
            </call>
          </if>
        </column>
        <column table="a" column="pow_mba" as="pow_mba_first" group="sum" title="Ввод мощностей в ОФ (МВа) за N год" if="first" />
        <column table="a" column="pow_km" as="pow_km_first" group="sum" title="Ввод мощностей в ОФ ВЛ (км) за N год" if="first" />
        <column table="a" column="pow_km_kl" as="pow_km_kl_first" group="sum" title="Ввод мощностей в ОФ КЛ (км) за N год" if="first" />
        <column table="a" column="pow_mba_del" as="pow_mba_del_first" group="sum" title="Вывод мощностей в ОФ (МВа) за N год" if="first" />
        <column table="a" column="pow_km_del" as="pow_km_del_first" group="sum" title="Вывод мощностей в ОФ ВЛ (км) за N год" if="first" />
        <column table="a" column="pow_km_kl_del" as="pow_km_kl_del_first" group="sum" title="Вывод мощностей в ОФ КЛ (км) за N год" if="first" />
        <column table="a" column="vvod_sum" as="vvod_sum_all" title="Ввод мощностей в ОФ (руб.) итого" group="sum" mp="-6" if="all">
          <if>
            <call function="between">
              <column table="a" column="year" />
              <useparam name="year" />
              <call function="+">
                <useparam name="year" />
                <const>5</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="pow_mba" as="pow_mba_all" group="sum" title="Ввод мощностей в ОФ (МВа) итого" if="all" />
        <column table="a" column="pow_km" as="pow_km_all" group="sum" title="Ввод мощностей в ОФ ВЛ (км) итого" if="all" />
        <column table="a" column="pow_km_kl" as="pow_km_kl_all" group="sum" title="Ввод мощностей в ОФ КЛ (км) итого" if="all" />
        <column table="a" column="pow_mba_del" as="pow_mba_del_all" group="sum" title="Вывод мощностей в ОФ (МВа) итого" if="all" />
        <column table="a" column="pow_km_del" as="pow_km_del_all" group="sum" title="Вывод мощностей в ОФ ВЛ (км) итого" if="all" />
        <column table="a" column="pow_km_kl_del" as="pow_km_kl_del_all" group="sum" title="Вывод мощностей в ОФ КЛ (км) итого" if="all" />
        <column table="a" column="vvod_sum" as="vvod_sum_by_y" title="Ввод мощностей в ОФ (руб.) по годам" group="sum" mp="-6" dimname="year">
          <pivot>
            <column table="a" column="year" />
            <query>
              <select>
                <column table="yl" column="god_ip" />
                <column table="yl" column="name" />
              </select>
              <from>
                <query name="25499-year_list" as="yl" />
              </from>
              <where>
                <call function="between">
                  <column table="yl" column="god_ip" />
                  <call function="+">
                    <useparam name="year" />
                    <const>1</const>
                  </call>
                  <call function="+">
                    <useparam name="year" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="pow_mba" as="pow_mba_by_y" title="Ввод мощностей в ОФ (МВа) по годам" group="sum" dimname="year" />
        <column table="a" column="pow_km" as="pow_km_by_y" title="Ввод мощностей в ОФ ВЛ (км) по годам" group="sum" dimname="year" />
        <column table="a" column="pow_km_kl" as="pow_km_kl_by_y" title="Ввод мощностей в ОФ КЛ (км) по годам" group="sum" dimname="year" />
        <column table="a" column="pow_mba_del" as="pow_mba_del_by_y" title="Вывод мощностей в ОФ (МВа) по годам" group="sum" dimname="year" />
        <column table="a" column="pow_km_del" as="pow_km_del_by_y" title="Вывод мощностей в ОФ ВЛ (км) по годам" group="sum" dimname="year" />
        <column table="a" column="pow_km_kl_del" as="pow_km_kl_del_by_y" title="Вывод мощностей в ОФ КЛ (км) по годам" group="sum" dimname="year" />
        <column table="a" column="vvod_sum" as="vvod_sum_by_kv" title="Ввод мощностей в ОФ (руб.) по кварталам N года" group="sum" mp="-6" dimname="kv">
          <pivot>
            <call function="and">
              <call function="=">
                <call function="mes to kv">
                  <column table="a" column="period" />
                </call>
                <column table="dim" column="kvartal" />
              </call>
              <call function="=">
                <column table="a" column="year" />
                <useparam name="year" />
              </call>
            </call>
            <query>
              <select>
                <column table="b" column="kvartal" />
                <column table="b" column="name" />
              </select>
              <from>
                <query name="kvartal" as="b" />
              </from>
            </query>
          </pivot>
        </column>
        <column table="a" column="pow_mba" as="pow_mba_by_kv" title="Ввод мощностей в ОФ (МВа) по кварталам N года" group="sum" dimname="kv" />
        <column table="a" column="pow_km" as="pow_km_by_kv" title="Ввод мощностей в ОФ ВЛ (км) по кварталам N года" group="sum" dimname="kv" />
        <column table="a" column="pow_km_kl" as="pow_km_kl_by_kv" title="Ввод мощностей в ОФ КЛ (км) по кварталам N года" group="sum" dimname="kv" />
        <column table="a" column="pow_mba_del" as="pow_mba_del_by_kv" title="Вывод мощностей в ОФ (МВа) по кварталам N года" group="sum" dimname="kv" />
        <column table="a" column="pow_km_del" as="pow_km_del_by_kv" title="Вывод мощностей в ОФ ВЛ (км) по кварталам N года" group="sum" dimname="kv" />
        <column table="a" column="pow_km_kl_del" as="pow_km_kl_del_by_kv" title="Вывод мощностей в ОФ КЛ (км) по кварталам N года" group="sum" dimname="kv" />
        <column table="kod_kriteria" column="abbr" as="kriteria_name" title="Критерии включения объектов ИПР" group="max" />
        <column table="kod_priority_insert_ip" column="abbr" as="priority_name" title="Приоритеты включения объектов ИПР" group="max" />
        <column table="kod_klass" column="abbr_num" as="klass_name" title="Принадлежность к важн. объектам, программам" group="max" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr" as="ipr_ipr_data">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_subject" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_razdel" />
            </link>
            <link name="kod_kriteria" />
            <link name="kod_priority_insert_ip" />
            <link name="kod_klass" />
          </link>
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_titul_ip" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="pr_last" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="n-const" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <select>
        <const as="n_const" type="number" key="1">96</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="26630-mp-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <const>-3</const>
        </call>
      </where>
    </query>
    <query name="29319-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
        <param name="nvalue" />
        <param name="mp" />
      </params>
      <select>
        <call function="year" as="nyear">
          <useparam name="date" />
        </call>
        <call function="date to char" as="ddate" type="string">
          <useparam name="date" />
        </call>
        <call function="mes to kv" as="num_kv" type="number">
          <call function="month">
            <useparam name="date" />
          </call>
        </call>
        <call function="/" as="nvalue">
          <useparam name="nvalue" />
          <const>100</const>
        </call>
        <column table="a" column="name" as="name_mp" />
        <call function="add_month" as="month_next" type="date">
          <useparam name="date" />
        </call>
        <call function="" as="month" type="date">
          <useparam name="date" />
        </call>
        <const as="kap_exists" type="number" colset="освоение" comment="чтобы удалять колонки без переменных">1</const>
        <const as="fp_exists" type="number" colset="финансирование" comment="чтобы удалять колонки без переменных">1</const>
        <const as="vvod_exists" type="number" colset="ввод в ОФ" comment="чтобы удалять колонки без переменных">1</const>
        <const as="pow_exists" type="number" colset="МВА" comment="чтобы удалять колонки без переменных">1</const>
        <const as="pow_km_exists" type="number" colset="км" comment="чтобы удалять колонки без переменных">1</const>
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp"></column>
          <useparam name="mp" />
        </call>
      </where>
    </query>
    <query name="29319-detail" timestamp="08.09.2016 15:38:04" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param name="date" type="date">
          <const>DATE'2015-05-01'</const>
        </param>
        <param name="pr_aip" />
        <param name="kod_doc">
          <const>43383</const>
        </param>
        <param name="mp" />
        <param name="pr_ip" />
        <param name="pr_aip_detail" />
        <param name="kod_direct" />
        <param name="kod_dir_isp" />
        <param name="pr_sbor" />
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="29319" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="pr_aip" />
            <useparam name="kod_doc" />
            <useparam name="mp" />
            <useparam name="kod_direct" />
            <useparam name="kod_dir_isp" />
            <useparam name="kod_ofz" />
          </withparams>
          <grsets>
            <grset level="" title="Всего" as="itog" />
            <grset level="2" title="По СПб и ЛО" as="itog_spb_lo" />
            <grset level="1" title="По филиалам" as="ispoln">
              <grset level="2" title="По субъекту" as="spb">
                <grset level="3" title="По признаку АИП" as="spb_aip">
                  <grset level="5" as="sbor" title="Сборный титул" order="tit_num_new_sbor">
                    <grset level="" as="sborinfo" title="Сборный титул(информация)">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_titul_ip_sbor" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_sbor" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                    <grset level="6" as="main" title="Головной/ одиночный титул" order="tit_num_new_main">
                      <where>
                        <call function="and">
                          <call function="=0">
                            <column table="a" column="is_sbor_main" />
                          </call>
                        </call>
                      </where>
                      <grset level="" as="head" title="Головной титул">
                        <where>
                          <call function="and">
                            <call function="=">
                              <column table="a" column="is_head_tit" />
                              <const>1</const>
                            </call>
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_sbor" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                          </call>
                        </where>
                      </grset>
                      <grset level="" as="single" title="Одиночный титул">
                        <where>
                          <call function="!=">
                            <column table="a" column="is_head_tit" />
                            <const>1</const>
                          </call>
                        </where>
                      </grset>
                      <grset level="7" as="child" title="Дочерний титул" order="tit_num_new">
                        <where>
                          <call function="and">
                            <call function="is not null">
                              <column table="a" column="kod_child_titul" />
                            </call>
                          </call>
                        </where>
                      </grset>
                    </grset>
                  </grset>
                  <grset level="4" title="По титулам" as="tit" exclude="1">
                    <where>
                      <call function="or">
                        <call function="false" />
                        <call function="and" optional="1">
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_ip" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip" />
                            <const>0</const>
                          </call>
                        </call>
                        <call function="and" optional="1">
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_aip_detail" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip" />
                            <const>1</const>
                          </call>
                        </call>
                        <!--<call function="=">
                          <call function="nvlu">
                            <useparam name="pr_ip" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>
                        <call function="or">
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>0</const>
                            </call>
                            <call function="=">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                            <call function="ge">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                        </call>-->
                      </call>
                    </where>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="is null">
            <column table="a" column="kod_titul_ip_sbor" />
            <column table="a" column="kod_main_titul" />
            <column table="a" column="kod_child_titul" />
          </call>
          <call function="and" optional="1">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_ip" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kod_aip_min" />
              <const>0</const>
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_aip_detail" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kod_aip_max" />
              <const>1</const>
            </call>
          </call>
          <!--<call function="=">
                          <call function="nvlu">
                            <useparam name="pr_ip" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>
                        <call function="or">
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>0</const>
                            </call>
                            <call function="=">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                            <call function="ge">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                        </call>-->
        </call>
      </where>
    </query>
    <query name="29319-test" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param name="date" type="date">
          <const>DATE'2015-05-01'</const>
        </param>
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="29319" as="a" grouplevel="5">
          <withparams>
            <useparam name="date" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="29319" grouplevel="no" timestamp="21.10.2016 17:01:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
        <param name="pr_aip" />
        <param name="kod_doc" />
        <param name="mp" />
        <param name="kod_direct" />
        <param name="kod_dir_isp" />
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="kod_main_titul" column="kod_sbor_titul" group="5" exclude="1" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_sbor_titul" group="5" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title="Номер сборного" />
        <column table="kod_titul_ip_sbor" column="full_name" as="+_sbor" group="kod_sbor_titul" title="Наименование сборного титула" />
        <column table="ipr_ipr_data" column="kod_main_titul" group="6" />
        <column table="kod_main_titul" column="tit_num_new_n" as="tit_num_new_main" group="kod_main_titul" title="Номер головного/одиночного титула" />
        <column table="kod_main_titul" column="full_name" as="full_name_main" group="kod_main_titul" title="Наименование головного/одиночного титула" />
        <column table="kod_main_titul" column="is_head_tit" group="kod_main_titul" />
        <column table="kod_main_titul" column="is_sbor" as="is_sbor_main" group="kod_main_titul" />
        <column table="kod_titul_ip" column="is_head_tit" as="is_head_tit1" />
        <column table="ipr_ipr_data" column="kod_child_titul" group="7" />
        <column table="kod_titul_ip" column="is_sbor" group="kod_child_titul" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_child_titul" title="Номер дочернего титула" as="tit_num_new" />
        <column table="kod_titul_ip" column="full_name" group="kod_child_titul" title="Наименование дочернего титула" />
        <column table="kod_titul_ip" column="kod_ispolnit" group="1" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" group="kod_ispolnit" />
        <column table="kod_subject" column="kod_subject" group="2" />
        <column table="kod_subject" column="name" as="subject_name" group="kod_subject" />
        <column table="kod_titul_ip" column="kod_aip" group="3" />
        <!--<column table="kod_titul_ip" column="name_aip" group="kod_aip" />-->
        <call function="decode" as="name_aip" group="kod_aip" type="string">
          <column table="kod_titul_ip" column="kod_aip" />
          <const>0</const>
          <call function="||">
            <column table="kod_titul_ip" column="name_aip" />
            <column table="kod_ispolnit" column="name" />
          </call>
          <column table="kod_titul_ip" column="name_aip" />
        </call>
        <column table="kod_titul_ip" column="kod_titul_ip" group="4" exclude="1" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_titul_ip" as="tit_num_new" exclude="1" />
        <column table="kod_titul_ip" column="name" group="kod_titul_ip" exclude="1" />
        <column table="kod_titul_ip" column="kod_aip" group="max" as="kod_aip_max" title="1 - есть аип" />
        <column table="kod_titul_ip" column="kod_aip" group="max" as="kod_aip_min" title="0 - есть капстрой" />
        <column table="a" column="period" group="max" />
        <!--Освоение-->
        <column table="a" column="kap_sum" group="sum" mp="[:mp]" colset="освоение" />
        <column table="a" column="kap_sum_fact_a" group="sum" mp="[:mp]" as="kap_sum_fact" colset="освоение" />
        <column table="a" column="kap_sum_wait" group="sum" mp="[:mp]" colset="освоение" />
        <column table="a" column="kap_sum" group="sum" if="kv" mp="[:mp]" colset="освоение">
          <if pfx="_kv" title=" за квартал">
            <call function="=">
              <call function="mes to kv">
                <column table="a" column="period" />
              </call>
              <call function="mes to kv">
                <call function="month">
                  <useparam name="date" />
                </call>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum" as="kap_sum_itog" group="sum" dimname="itog" mp="[:mp]" colset="освоение">
          <pivot title=" нарастающий итог">
            <call function="le">
              <call function="mes to kv">
                <column table="this" column="period" group="" />
              </call>
              <column table="dim" column="kvartal" />
            </call>
            <query>
              <select>
                <const as="id">1</const>
                <call function="mes to kv" as="kvartal">
                  <call function="month">
                    <useparam name="date" />
                  </call>
                </call>
              </select>
              <from>
                <table name="dual" as="kvartal" />
              </from>
              <where>
                <call function="gt">
                  <call function="mes to kv" as="kvartal">
                    <call function="month">
                      <useparam name="date" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="kap_sum_fact_a" group="sum" if="kv" mp="[:mp]" colset="освоение" />
        <column table="a" column="kap_sum_fact_a" group="sum" dimname="itog" as="kap_sum_fact_itog" mp="[:mp]" colset="освоение" />
        <column table="a" column="kap_sum_wait" group="sum" if="kv_wait" mp="[:mp]" as="kap_sum_wait_kv" colset="освоение">
          <if>
            <call function="and">
              <call function="le">
                <column table="a" column="period" />
                <call function="month">
                  <useparam name="date" />
                </call>
              </call>
              <call function="=">
                <call function="mes to kv">
                  <column table="a" column="period" />
                </call>
                <call function="mes to kv">
                  <call function="month">
                    <useparam name="date" />
                  </call>
                </call>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_wait" group="sum" dimname="itog_wait" as="kap_sum_wait_itog" mp="[:mp]" colset="освоение">
          <pivot title=" нарастающий итог +1 мес">
            <call function="le">
              <column table="this" column="period" group="" />
              <column table="dim" column="month" />
            </call>
            <query>
              <select>
                <const as="id">1</const>
                <call function="+" as="month">
                  <call function="month">
                    <useparam name="date" />
                  </call>
                  <const>1</const>
                </call>
              </select>
              <from>
                <table name="dual" as="month" />
              </from>
              <where>
                <call function="gt">
                  <call function="+" as="month">
                    <call function="month">
                      <useparam name="date" />
                    </call>
                    <const>1</const>
                  </call>
                  <const>1</const>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <!--Финансирование-->
        <column table="a" column="fp_sum_nds" group="sum" mp="[:mp]" as="fp_sum" colset="финансирование" />
        <column table="a" column="fp_sum_nds" group="sum" if="kv" mp="[:mp]" as="fp_sum" colset="финансирование" />
        <column table="a" column="fp_sum_nds_fact_a" group="sum" mp="[:mp]" as="fp_sum_fact" colset="финансирование" />
        <column table="a" column="fp_sum_nds_fact_a" group="sum" if="kv" mp="[:mp]" as="fp_sum_fact" colset="финансирование" />
        <column table="a" column="fp_sum_nds_wait" group="sum" mp="[:mp]" as="fp_sum_wait_kv" if="kv_wait" colset="финансирование" />
        <column table="a" column="fp_sum_nds" group="sum" dimname="itog" as="fp_sum_itog" mp="[:mp]" colset="финансирование" />
        <column table="a" column="fp_sum_nds_fact_a" group="sum" dimname="itog" as="fp_sum_fact_itog" mp="[:mp]" colset="финансирование" />
        <column table="a" column="fp_sum_nds_wait" group="sum" mp="[:mp]" as="fp_sum_wait_itog" dimname="itog_wait" colset="финансирование" />
        <!--Ввод-->
        <column table="a" column="vvod_sum" group="sum" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_fact" group="sum" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_wait" group="sum" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum" group="sum" if="kv" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_fact" group="sum" if="kv" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_wait" as="vvod_sum_wait_kv" group="sum" if="kv_wait" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum" group="sum" dimname="itog" as="vvod_sum_itog" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_fact" group="sum" dimname="itog" as="vvod_sum_fact_itog" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_wait" group="sum" dimname="itog_wait" as="vvod_sum_wait_itog" mp="[:mp]" colset="ввод в ОФ" />
        <!--МВА-->
        <column table="a" column="pow_mba" group="sum" colset="МВА" />
        <column table="a" column="pow_mba_fact_date" as="pow_mba_fact" group="sum" colset="МВА" />
        <column table="a" column="pow_mba_wait" group="sum" colset="МВА" />
        <column table="a" column="pow_mba" group="sum" if="kv" colset="МВА" />
        <column table="a" column="pow_mba_fact_date" as="pow_mba_fact" group="sum" if="kv" colset="МВА" />
        <column table="a" column="pow_mba_wait" as="pow_mba_wait_kv" group="sum" if="kv_wait" colset="МВА" />
        <column table="a" column="pow_mba" group="sum" dimname="itog" as="pow_mba_itog" colset="МВА" />
        <column table="a" column="pow_mba_fact_date" group="sum" dimname="itog" as="pow_mba_fact_itog" colset="МВА" />
        <column table="a" column="pow_mba_wait" group="sum" dimname="itog_wait" as="pow_mba_wait_itog" colset="МВА" />
        <!--КМ-->
        <column table="a" column="pow_km_all" group="sum" as="pow_km" colset="км" />
        <column table="a" column="pow_km_all_fact_date" as="pow_km_fact" group="sum" colset="км" />
        <column table="a" column="pow_km_all_wait" group="sum" colset="км" />
        <column table="a" column="pow_km_all" group="sum" if="kv" as="pow_km" colset="км" />
        <column table="a" column="pow_km_all_fact_date" as="pow_km_fact" group="sum" if="kv" colset="км" />
        <column table="a" column="pow_km_all_wait" group="sum" if="kv_wait" as="pow_km_wait_kv" colset="км" />
        <column table="a" column="pow_km_all" group="sum" dimname="itog" as="pow_km_itog" colset="км" />
        <column table="a" column="pow_km_all_fact_date" group="sum" dimname="itog" as="pow_km_fact_itog" colset="км" />
        <column table="a" column="pow_km_all_wait" group="sum" dimname="itog_wait" as="pow_km_wait_itog" colset="км" />
        <column table="a" column="ipr_fin_ipr" group="sum" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr" as="ipr_ipr_data">
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
              </link>
            </link>
          </link>
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="=" selective="1">
                <call function="year">
                  <useparam name="date" />
                </call>
                <column table="*" column="year" />
              </call>
              <call function="le" selective="1">
                <call function="trunc">
                  <column table="*" column="dat" />
                </call>
                <useparam name="date" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dir_isp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dir_isp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_aip" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <call function="nvl0">
                <column table="kod_titul_ip" column="kod_aip" />
              </call>
              <const>0</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="26630-pr_all_fact_not-default_1" timestamp="17.08.2016 18:36:43" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param type="number" name="pr_all_fact" />
      </params>
      <select>
        <call function="if" type="number" as="val">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="pr_all_fact" />
            </call>
          </call>
          <const>0</const>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="29319-cols" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <const as="id" type="string">'освоение'</const>
      <const as="name" type="string">'освоение'</const>
      <const>'финансирование'</const>
      <const>'финансирование'</const>
      <const>'ввод в ОФ'</const>
      <const>'ввод в ОФ'</const>
      <const>'МВА'</const>
      <const>'МВА'</const>
      <const>'км'</const>
      <const>'км'</const>
    </query>
    <query name="29611-title" timestamp="17.07.2016 17:44:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <params>
        <usepart part="29611-params" />
      </params>
      <select>
        <call function="replace" as="name_direct" type="string">
          <column table="a" column="name_direct" group="stragg_dist" />
          <const>','</const>
          <const>'; '</const>
        </call>
        <call function="" as="year" group="max" type="number">
          <useparam name="year" />
        </call>
        <!--<call function="" as="kv" group="max" type="number">
          <useparam name="kv" />
        </call>-->
        <call function="decode" as="kv" type="string">
          <useparam name="kv" />
          <const as="id" type="number">1</const>
          <const as="name" type="string">'1 квартал'</const>
          <const>2</const>
          <const>'1 полугодие'</const>
          <const>3</const>
          <const>'9 месяцев'</const>
          <const>4</const>
          <const>''</const>
        </call>
        <call as="mes_name" function="mes-name">
          <useparam name="mes" />
        </call>
      </select>
      <from>
        <query name="25499-ipr_direct" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in" optional="1">
            <column table="a" column="kod_direct" />
            <useparam name="kod_direct" />
          </call>
          <call function="true" />
        </call>
      </where>
    </query>
    <query name="29611-gr" timestamp="16.10.2018 18:13:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <params>
        <usepart part="29611-params" />
      </params>
      <select>
        <column table="a" column="*" />
        <call function="/nvl" as="otkl_kap_pl_perc" colset="План" title="% отклонения факта от плана" mp="2">
          <column table="a" column="otkl_kap_pl" />
          <column table="a" column="kap_sum" />
        </call>
        <call function="/nvl" as="otkl_kap_lim_perc" colset="Лимит" title="% Отклонение факта от лимита" mp="2">
          <column table="a" column="otkl_kap_lim" />
          <column table="a" column="kap_lim_sum" />
        </call>
        <call function="/nvl" as="otkl_fp_pl_perc" colset="План" title="% Отклонение факта от плана" mp="2">
          <column table="a" column="otkl_fp_pl" />
          <column table="a" column="fp_sum_nds" />
        </call>
        <call function="/nvl" as="otkl_fp_lim_perc" colset="Лимит" title="% Отклонение факта от лимита" mp="2">
          <column table="a" column="otkl_fp_lim" />
          <column table="a" column="fp_lim_sum_nds" />
        </call>
        <call function="/nvl" as="otkl_vvod_pl_perc" colset="План" title="% Отклонение факта от плана" mp="2">
          <column table="a" column="otkl_vvod_pl" />
          <column table="a" column="vvod_sum" />
        </call>
        <call function="/nvl" as="otkl_vvod_lim_perc" colset="Лимит" title="% Отклонение факта от лимита" mp="2">
          <column table="a" column="otkl_vvod_lim" />
          <column table="a" column="vvod_lim_sum" />
        </call>
        <call function="/nvl" as="otkl_pow_mba_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_pow_mba" />
          <column table="a" column="pow_mba" />
        </call>
        <call function="/nvl" as="otkl_pow_km_all_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_pow_km_all" />
          <column table="a" column="pow_km_all" />
        </call>
        <call function="/nvl" as="otkl_kap_mes_perc" title="% отклонения факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_kap_mes" />
          <column table="a" column="kap_sum_mes" />
        </call>
        <call function="/nvl" as="otkl_fp_mes_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_fp_mes" />
          <column table="a" column="fp_sum_nds_mes" />
        </call>
        <call function="/nvl" as="otkl_vvod_mes_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_vvod_mes" />
          <column table="a" column="vvod_sum_mes" />
        </call>
        <call function="/nvl" as="otkl_pow_mba_mes_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_pow_mba_mes" />
          <column table="a" column="pow_mba_mes" />
        </call>
        <call function="/nvl" as="otkl_pow_km_all_mes_perc" title="% Отклонение факта от плана" mp="2" colset="Ожидаемый факт">
          <column table="a" column="otkl_pow_km_all_mes" />
          <column table="a" column="pow_km_all_mes" />
        </call>
      </select>
      <from>
        <query name="29611" as="a">
          <usepart part="29611-withparams" />
          <grsets>
            <grset level="1" as="itog" title="Группа" order="go_grp">
              <where>
                <call function="is not null">
                  <column table="a" column="go_grp" />
                </call>
              </where>
              <grset level="4" as="sbor" title="Сборный титул" order="subject_abbr,podr_abbr_sbor,tit_num_new_sbor">
                <where exclude="1">
                  <call function="or">
                    <call function="and" optional="1">
                      <call function="=">
                        <call function="nvlu">
                          <useparam name="pr_aip_detail" />
                          <const>0</const>
                        </call>
                        <const>1</const>
                      </call>
                      <call function="=">
                        <column table="a" column="kod_aip_sbor" />
                        <const>1</const>
                      </call>
                    </call>
                    <call function="=">
                      <column table="a" column="kod_aip_sbor" nvl="0" />
                      <const>0</const>
                    </call>
                  </call>
                </where>
                <grset level="" as="sborinfo" title="Сборный титул(информация)">
                  <where>
                    <call function="and">
                      <call function="is not null">
                        <column table="a" column="kod_titul_ip_sbor" />
                      </call>
                      <call function="=">
                        <call function="nvlu">
                          <useparam name="pr_sbor" />
                          <const>0</const>
                        </call>
                        <const>1</const>
                      </call>
                    </call>
                  </where>
                </grset>
                <grset level="2" as="main" title="Головной/ одиночный титул" order="subject_abbr,podr_abbr_main,tit_num_new_main">
                  <where>
                    <call function="and">
                      <call function="=0">
                        <column table="a" column="is_sbor_main" />
                      </call>
                      <call function="or">
                        <call function="and" optional="1">
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_aip_detail" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip_main" />
                            <const>1</const>
                          </call>
                        </call>
                        <call function="=">
                          <column table="a" column="kod_aip_main" />
                          <const>0</const>
                        </call>
                      </call>
                    </call>
                  </where>
                  <grset level="" as="head" title="Головной титул">
                    <where>
                      <call function="=">
                        <column table="a" column="is_head_tit" />
                        <const>1</const>
                      </call>
                    </where>
                    <grset level="" as="head1" title="Головной титул (без дочерних)">
                      <where>
                        <call function="=">
                          <column table="a" column="is_head_tit1" />
                          <const>1</const>
                        </call>
                      </where>
                    </grset>
                  </grset>
                  <grset level="" as="single" title="Одиночный титул">
                    <where>
                      <call function="!=nvl">
                        <column table="a" column="is_head_tit" />
                        <const>1</const>
                      </call>
                    </where>
                  </grset>
                  <grset level="3" as="child" title="Дочерний титул" order="subject_abbr,podr_abbr,tit_num_new">
                    <where>
                      <call function="and">
                        <call function="or">
                          <call function="and" optional="1">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                            <call function="=">
                              <column table="a" column="kod_aip_child" />
                              <const>1</const>
                            </call>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip_child" />
                            <const>0</const>
                          </call>
                        </call>
                        <call function="is not null">
                          <column table="a" column="kod_child_titul" />
                        </call>
                      </call>
                    </where>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="29611-test" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" />
        <column table="ipr_fin_body_united" column="fp_sum" dgroup="sum" />
      </select>
      <from>
        <query name="ipr_ipr_data">
          <dlink name="ipr_fin_body_united" />
        </query>
      </from>
    </query>
    <query name="29611" grouplevel="no" timestamp="08.01.2018 16:36:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <params>
        <usepart part="29611-params" />
      </params>
      <select>
        <call function="if" as="go_grp" group="1" title="Группа">
          <call function="=">
            <call function="nvlu">
              <useparam name="pr_gorobl" />
              <const>0</const>
            </call>
            <const>0</const>
          </call>
          <const>'СПб и ЛО'</const>
          <column table="kod_subject" column="abbr" />
        </call>
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" group="4" as="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title="Номер сборного" />
        <column table="kod_titul_ip_sbor" column="full_name" as="+_sbor" group="kod_sbor_titul" title="Наименование сборного титула" />
        <column table="kod_titul_ip_sbor" column="beg_year" as="+_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="end_year" as="+_sbor" group="kod_sbor_titul" />
        <column table="kod_direct_sbor" column="name_kr" as="direct_sbor_abbr" group="kod_sbor_titul" title="Заказчик сборного титула" />
        <column table="kod_ispolnit_sbor" column="name_kr" as="ispolnit_sbor_abbr" group="kod_sbor_titul" title="Исполнитель сборного титула" />
        <column table="kod_titul_ip_sbor" column="kod_aip" as="kod_aip_sbor" group="kod_sbor_titul" />
        <call function="if" group="kod_sbor_titul" as="podr_abbr_sbor" title="Подразделение сборного титула" description="Подразделение заказчика или исполнителя">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit_sbor" column="name_kr" />
          <column table="kod_direct_sbor" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_main_titul" group="2" />
        <column table="kod_main_titul" column="tit_num_new_n" as="tit_num_new_main" group="kod_main_titul" title="Номер головного/одиночного титула" />
        <column table="kod_main_titul" column="full_name" as="full_name_main" group="kod_main_titul" title="Наименование головного/одиночного титула" />
        <column table="kod_main_titul" column="beg_year" as="beg_year_main" group="kod_main_titul" />
        <column table="kod_main_titul" column="end_year" as="end_year_main" group="kod_main_titul" />
        <column table="kod_main_titul" column="is_head_tit" group="kod_main_titul" />
        <column table="kod_main_titul" column="is_sbor" as="is_sbor_main" group="kod_main_titul" />
        <column table="kod_titul_ip" column="is_head_tit" as="is_head_tit1" />
        <column table="kod_subject" column="kod_subject" group="kod_main_titul" />
        <column table="kod_subject" column="abbr" as="subject_abbr" group="kod_main_titul" />
        <column table="kod_direct_main" column="name_kr" as="direct_main_abbr" group="kod_main_titul" title="Заказчик головного/одиночного титула" />
        <column table="kod_ispolnit_main" column="name_kr" as="ispolnit_main_abbr" group="kod_main_titul" title="Исполнитель головного/одиночного титула" />
        <column table="kod_main_titul" column="kod_aip" as="kod_aip_main" group="kod_main_titul" />
        <call function="if" group="kod_main_titul" as="podr_abbr_main" title="Подразделение головного/одиночного титула">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit_main" column="name_kr" />
          <column table="kod_direct_main" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_child_titul" group="3" />
        <column table="kod_titul_ip" column="is_sbor" group="kod_child_titul" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_child_titul" title="Номер дочернего титула" as="tit_num_new" />
        <column table="kod_titul_ip" column="full_name" group="kod_child_titul" title="Наименование дочернего титула" />
        <column table="kod_titul_ip" column="beg_year" group="kod_child_titul" />
        <column table="kod_titul_ip" column="end_year" group="kod_child_titul" />
        <column table="kod_titul_ip" column="kod_aip" as="kod_aip_child" group="kod_child_titul" />
        <column table="kod_direct" column="name_kr" as="direct_abbr" group="kod_child_titul" title="Заказчик дочернего титула" />
        <column table="kod_ispolnit" column="name_kr" as="ispolnit_abbr" group="kod_child_titul" title="Исполнитель дочернего титула" />
        <column table="a" column="kod_ipr" group="max" />
        <call function="if" group="kod_child_titul" as="podr_abbr" title="Подразделение дочернего титула">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name_kr" />
          <column table="kod_direct" column="name_kr" />
        </call>
        <column table="a" column="ipr_fin_ipr" group="sum" />
        <column table="a" column="kap_sum" group="sum" mp="-3" colset="План" if="kv">
          <if>
            <call function="le">
              <call function="mes to kv">
                <column table="a" column="period" />
              </call>
              <useparam name="kv" />
            </call>
          </if>
        </column>
        <column table="a" column="kap_lim_sum" group="sum" mp="-3" colset="Лимит" if="kv" />
        <column table="a" column="kap_sum_fact_a" group="sum" mp="-3" if="kv" as="kap_sum_fact" exclude="1" />
        <column table="a" column="kap_sum_fact_d" group="sum" mp="-3" if="kv" as="kap_sum_fact" exclude="1" />
        <call function="if" as="kap_sum_fact" group="sum" title="Отклонение фактического освоения от планового освоения" type="number">
          <call function="le">
            <call function="num to ym2">
              <useparam name="year" />
              <call function="kv end mes">
                <useparam name="kv" />
              </call>
            </call>
            <const>201709</const>
          </call>
          <column table="a" column="kap_sum_fact_d" mp="-3" if="kv" />
          <column table="a" column="kap_sum_fact_n" mp="-3" if="kv" />
        </call>
        <call function="-nvl" as="otkl_kap_pl" colset="План" title="Отклонение факта от плана" group="sum">
          <column table="this" column="kap_sum_fact" />
          <column table="this" column="kap_sum" />
        </call>
        <call function="-nvl" as="otkl_kap_lim" colset="Лимит" title="Отклонение факта от лимита" group="sum">
          <column table="this" column="kap_sum_fact" />
          <column table="this" column="kap_lim_sum" />
        </call>
        <column table="a" column="fp_sum_nds" group="sum" mp="-3" colset="План" if="kv" />
        <column table="a" column="fp_lim_sum_nds" group="sum" mp="-3" colset="Лимит" if="kv" />
        <column table="a" column="fp_sum_nds_fact_a" group="sum" mp="-3" if="kv" as="fp_sum_nds_fact" exclude="1" />
        <column table="a" column="fp_sum_nds_fact_b" group="sum" mp="-3" if="kv" as="fp_sum_nds_fact" />
        <call function="-nvl" as="otkl_fp_pl" colset="План" title="Отклонение факта от плана" group="sum">
          <column table="this" column="fp_sum_nds_fact" />
          <column table="this" column="fp_sum_nds" />
        </call>
        <call function="-nvl" as="otkl_fp_lim" colset="Лимит" title="Отклонение факта от лимита" group="sum">
          <column table="this" column="fp_sum_nds_fact" />
          <column table="this" column="fp_lim_sum_nds" />
        </call>
        <column table="a" column="vvod_sum" group="sum" mp="-3" colset="План" if="kv" />
        <column table="a" column="vvod_lim_sum" group="sum" mp="-3" colset="Лимит" if="kv" />
        <column table="a" column="vvod_sum_fact" group="sum" mp="-3" if="kv" />
        <call function="-nvl" as="otkl_vvod_pl" colset="План" title="Отклонение факта от плана" group="sum">
          <column table="this" column="vvod_sum_fact" />
          <column table="this" column="vvod_sum" />
        </call>
        <call function="-nvl" as="otkl_vvod_lim" colset="Лимит" title="Отклонение факта от лимита" group="sum">
          <column table="this" column="vvod_sum_fact" />
          <column table="this" column="vvod_lim_sum" />
        </call>
        <column table="a" column="pow_mba" group="sum" if="kv" />
        <column table="a" column="pow_km_all" group="sum" if="kv" />
        <column table="a" column="pow_other" group="sum" if="kv" />
        <column table="a" column="pow_mba_pr" group="sum" if="kv" />
        <column table="a" column="pow_km_all_pr" group="sum" if="kv" />
        <column table="a" column="pow_other_pr" group="sum" if="kv" />
        <column table="a" column="pow_mba_fact" group="sum" if="kv" />
        <column table="a" column="pow_km_all_fact" group="sum" if="kv" />
        <column table="a" column="pow_other_fact" group="sum" if="kv" />
        <column table="a" column="pow_mba_fact_pr" group="sum" if="kv" />
        <column table="a" column="pow_km_all_fact_pr" group="sum" if="kv" />
        <column table="a" column="pow_other_fact_pr" group="sum" if="kv" />
        <call function="-nvl" as="otkl_pow_mba" title="Отклонение факта от плана" group="sum">
          <column table="this" column="pow_mba_fact" />
          <column table="this" column="pow_mba" />
        </call>
        <call function="-nvl" as="otkl_pow_km_all" title="Отклонение факта от плана" group="sum">
          <column table="this" column="pow_km_all_fact" />
          <column table="this" column="pow_km_all" />
        </call>
        <column table="a" column="pfa_kvl_prim" group="max" if="kv1">
          <if>
            <call function="=">
              <column table="a" column="kvart" />
              <useparam name="kv" />
            </call>
          </if>
        </column>
        <column table="a" column="pfa_vv_prim" group="max" if="kv1" />
        <column table="a" column="pfa_fin_prim" group="max" if="kv1" />
        <column table="a" column="pfa_mba_prim" group="max" if="kv1" />
        <column table="a" column="pfa_km_prim" group="max" if="kv1" />
        <column table="a" column="pfa_kvl_krit_name" group="max" if="kv1" />
        <column table="a" column="pfa_vv_krit_name" group="max" if="kv1" />
        <column table="a" column="pfa_fin_krit_name" group="max" if="kv1" />
        <column table="a" column="pfa_kvl_krit_name1" group="max" if="kv1" />
        <column table="a" column="pfa_vv_krit_name1" group="max" if="kv1" />
        <column table="a" column="pfa_fin_krit_name1" group="max" if="kv1" />
        <call function="if" group="max" as="fa_kvl_krit_name_a" title="Критерий отклонения по освоению">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_kvl_krit_name" />
          <column table="this" column="pfa_kvl_krit_name1" />
        </call>
        <call function="if" group="max" as="fa_vv_krit_name_a" title="Критерий отклонения по вводу">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_vv_krit_name" />
          <column table="this" column="pfa_vv_krit_name1" />
        </call>
        <call function="if" group="max" as="fa_fin_krit_name_a" title="Критерий отклонения по финансированию">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_fin_krit_name" />
          <column table="this" column="pfa_fin_krit_name1" />
        </call>
        <column table="sbor_fin" column="pfa_kvl_prim" as="+_sbor" group="max" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_vv_prim" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_fin_prim" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_mba_prim" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_km_prim" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_kvl_krit_name" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_vv_krit_name" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_fin_krit_name" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_kvl_krit_name1" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_vv_krit_name1" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <column table="sbor_fin" column="pfa_fin_krit_name1" group="max" as="+_sbor" dgroup="max" if="kv1" />
        <call function="if" as="fa_kvl_krit_name_a_sbor" group="max" title="Критерий отклонения по освоению">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_kvl_krit_name_sbor" />
          <column table="this" column="pfa_kvl_krit_name1_sbor" />
        </call>
        <call function="if" as="fa_vv_krit_name_a_sbor" group="max" title="Критерий отклонения по вводу">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_vv_krit_name_sbor" />
          <column table="this" column="pfa_vv_krit_name1_sbor" />
        </call>
        <call function="if" as="fa_fin_krit_name_a_sbor" group="max" title="Критерий отклонения по финансированию">
          <call function="=">
            <useparam name="krit_autor" />
            <const>0</const>
          </call>
          <column table="this" column="pfa_fin_krit_name_sbor" />
          <column table="this" column="pfa_fin_krit_name1_sbor" />
        </call>
        <column table="a" column="kap_sum_wait" group="sum" mp="-3" if="mes" colset="Ожидаемый факт">
          <if>
            <call function="le">
              <column table="a" column="period" />
              <useparam name="mes" />
            </call>
          </if>
        </column>
        <column table="a" column="fp_sum_nds_wait" group="sum" mp="-3" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum_wait" group="sum" mp="-3" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_mba_wait" group="sum" mp="-3" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_km_all_wait" group="sum" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_other_wait" group="sum" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_mba_wait_pr" group="sum" if="mes" mp="-3" colset="Ожидаемый факт" />
        <column table="a" column="pow_km_all_wait_pr" group="sum" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_other_wait_pr" group="sum" if="mes" colset="Ожидаемый факт" />
        <column table="a" column="kap_sum" group="sum" mp="-3" if="mes" as="kap_sum_mes" colset="Ожидаемый факт" />
        <column table="a" column="fp_sum_nds" group="sum" mp="-3" if="mes" as="fp_sum_nds_mes" colset="Ожидаемый факт" />
        <column table="a" column="vvod_sum" group="sum" mp="-3" if="mes" as="vvod_sum_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_mba" group="sum" if="mes" as="pow_mba_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_km_all" group="sum" if="mes" as="pow_km_all_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_other" group="sum" if="mes" as="pow_other_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_mba_pr" group="sum" if="mes" as="pow_mba_pr_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_km_all_pr" group="sum" if="mes" as="pow_km_all_pr_mes" colset="Ожидаемый факт" />
        <column table="a" column="pow_other_pr" group="sum" if="mes" as="pow_other_pr_mes" colset="Ожидаемый факт" />
        <call function="-nvl" as="otkl_kap_mes" title="Отклонение факта от плана" group="sum" colset="Ожидаемый факт">
          <column table="this" column="kap_sum_wait" />
          <column table="this" column="kap_sum_mes" />
        </call>
        <call function="-nvl" as="otkl_fp_mes" title="Отклонение факта от плана" group="sum" colset="Ожидаемый факт">
          <column table="this" column="fp_sum_nds_wait" />
          <column table="this" column="fp_sum_nds_mes" />
        </call>
        <call function="-nvl" as="otkl_vvod_mes" title="Отклонение факта от плана" group="sum" colset="Ожидаемый факт">
          <column table="this" column="vvod_sum_wait" />
          <column table="this" column="vvod_sum_mes" />
        </call>
        <call function="-nvl" as="otkl_pow_mba_mes" title="Отклонение факта от плана" group="sum" colset="Ожидаемый факт">
          <column table="this" column="pow_mba_wait" />
          <column table="this" column="pow_mba_mes" />
        </call>
        <call function="-nvl" as="otkl_pow_km_all_mes" title="Отклонение факта от плана" group="sum" colset="Ожидаемый факт">
          <column table="this" column="pow_km_all_wait" />
          <column table="this" column="pow_km_all_mes" />
        </call>
        <column table="a" column="pfa_kvl_wprim" group="max" if="mes1" colset="Ожидаемый факт">
          <if>
            <call function="=">
              <column table="a" column="kvart" />
              <call function="mes to kv">
                <useparam name="mes" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="pfa_vv_wprim" group="max" if="mes1" colset="Ожидаемый факт" />
        <column table="a" column="pfa_fin_wprim" group="max" if="mes1" colset="Ожидаемый факт" />
        <column table="a" column="pfa_mba_wprim" group="max" if="mes1" colset="Ожидаемый факт" />
        <column table="a" column="pfa_km_wprim" group="max" if="mes1" colset="Ожидаемый факт" />
        <column table="sbor_fin" column="pfa_kvl_wprim" group="max" if="mes1" as="pfa_kvl_wprim_sbor" colset="Ожидаемый факт" />
        <column table="sbor_fin" column="pfa_vv_wprim" group="max" if="mes1" as="pfa_vv_wprim_sbor" colset="Ожидаемый факт" />
        <column table="sbor_fin" column="pfa_fin_wprim" group="max" if="mes1" as="pfa_fin_wprim_sbor" colset="Ожидаемый факт" />
        <column table="sbor_fin" column="pfa_mba_wprim" group="max" if="mes1" as="pfa_mba_wprim_sbor" colset="Ожидаемый факт" />
        <column table="sbor_fin" column="pfa_km_wprim" group="max" if="mes1" as="pfa_km_wprim_sbor" colset="Ожидаемый факт" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_direct" as="kod_direct_main" />
              <link name="kod_ispolnit" as="kod_ispolnit_main" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                  <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                  <link name="kod_direct" as="kod_direct_sbor" />
                  <dlink name="ipr_fin_body_united" as="sbor_fin">
                    <extendwhere>
                      <call function="and">
                        <call function="and" selective="1">
                          <call function="=">
                            <column table="*" column="year" />
                            <useparam name="year" />
                          </call>
                          <call function="le" exclude="1">
                            <call function="mes to kv">
                              <column table="*" column="period" />
                            </call>
                            <useparam name="kv" />
                          </call>
                        </call>
                        <call function="=" selective="1" exclude="1">
                          <column table="*" column="kvart" />
                          <useparam name="kv" />
                        </call>
                        <call function="=">
                          <column table="kod_ipr" column="kod_doc_osn" />
                          <useparam name="kod_doc" />
                        </call>
                        <call function="=">
                          <column table="kod_titul_ip1" column="is_sbor" />
                          <const>1</const>
                        </call>
                      </call>
                    </extendwhere>
                  </dlink>
                </link>
              </link>
            </link>
          </link>
          <extendwhere>
            <call function="and">
              <call function="and" selective="1">
                <call function="=">
                  <column table="*" column="year" />
                  <useparam name="year" />
                </call>
                <call function="le" exclude="1">
                  <call function="mes to kv">
                    <column table="*" column="period" />
                  </call>
                  <useparam name="kv" />
                </call>
              </call>
              <call function="=" selective="1" exclude="1">
                <column table="*" column="kvart" />
                <useparam name="kv" />
              </call>
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>3</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>2</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip1" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="=">
            <column table="kod_ipr" column="pr_last" />
            <const>1</const>
          </call>-->
          <!--<call function="is not null">
            <column table="kod_subject" column="abbr" />
          </call>-->
          <call function="true" />
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="29611_mon_def" timestamp="17.07.2016 17:48:26" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <select>
        <call function="month" as="mon">
          <call function="sysdate" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="29611_cols_pf" timestamp="18.07.2016 01:19:13" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <const as="id" type="string">'План'</const>
      <const as="name" type="string" title="Группа колонок">'План'</const>
      <const>'Лимит'</const>
      <const>'Лимит'</const>
    </query>
    <query name="29611_cols_all" timestamp="18.07.2016 01:32:33" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <const as="id" type="string">'План'</const>
      <const as="name" type="string">'План'</const>
      <const>'Лимит'</const>
      <const>'Лимит'</const>
      <const>'Ожидаемый факт'</const>
      <const>'Ожидаемый факт'</const>
    </query>
    <query name="29611_cols_def" timestamp="18.07.2016 01:36:26" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <params>
        <param name="colsets_pre" type="array" />
        <param name="pr_wait" type="number" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="29611_cols_all" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="in">
            <column table="a" column="id" />
            <useparam name="colsets_pre" />
          </call>
          <call function="and" optional="1">
            <call function="=">
              <column table="a" column="id" />
              <const>'Ожидаемый факт'</const>
            </call>
            <call function="=1">
              <useparam name="pr_wait" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="30576_tituls" timestamp="13.07.2017 14:09:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <params>
        <param name="kod_doc" type="number" />
        <param name="kod_direct" type="array" />
        <param name="kod_dirisp" type="number" />
        <param name="kod_subject" type="number" />
        <param name="kod_ofz" type="array" />
      </params>
      <select>
        <column table="a" column="kod_node" key="1" />
        <column table="a" column="kod_titul_ip" />
        <column table="a" column="tit_num_new" />
        <column table="a" column="kod_parent_node" />
        <column table="a" column="full_name" />
        <column table="a" column="itip" />
        <column table="a" column="direct_name" />
        <column table="a" column="ispolnit_name" />
        <column table="a" column="subject_name" />
        <column table="a" column="razdel_vid_full" />
      </select>
      <from>
        <query name="26630_tituls" as="a">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <const>1</const>
            <const>1</const>
            <useparam name="kod_dirisp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="30576_dat" timestamp="21.10.2016 17:28:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <params>
        <param name="kod_doc" />
        <param name="kod_direct" />
        <param name="kod_dirisp" />
        <param name="pr_notaip" />
        <param name="kod_titul_ip" />
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="a" column="kod_titul_ip" group="1" />
        <column table="a" column="kod_doc" group="kod_titul_ip" type="number" />
        <column table="a" column="ipr_fin_doc" group="max" />
        <column table="a" column="ipr_fin_ipr" group="max" />
        <column table="kod_doc_osn" column="doc_num" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="tit_num_new" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="name" group="kod_titul_ip" />
        <column table="kod_direct" column="name_kr" as="podr_name_kr_d" group="max" description="Подразделение заказчика" />
        <column table="kod_ispolnit" column="name_kr" as="podr_name_kr_isp" group="max" description="Подразделение исполнителя" />
        <usepart part="30576_dat_doc" as="dat_22" title="Пояснительная записка" group="max">
          <const>22</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_302" title="Бизнес-план" group="max">
          <const>302</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_24" title="Техническое задание" group="max">
          <const>24</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_28" title="Укрупненный расчет стоимости (УРС)" group="max">
          <const>28</const>
        </usepart>
        <call function="if" as="dat_29" title="Приказ об утверждении ПСД" group="max" type="string">
          <call function="is not null">
            <usepart part="30576_num_doc">
              <const>29</const>
            </usepart>
          </call>
          <call function="||">
            <usepart part="30576_num_doc">
              <const>29</const>
            </usepart>
            <const>' от '</const>
            <call function="date to char">
              <usepart part="30576_dat_doc">
                <const>29</const>
              </usepart>
            </call>
          </call>
        </call>
        <usepart part="30576_dat_doc" as="dat_30" title="Сводно-сметный расчет (ССР)" group="max">
          <const>30</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_162" title="Расчет к ССР -10 %" group="max">
          <const>162</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_241" title="Расчет к ССР -30 %" group="max">
          <const>241</const>
        </usepart>
        <usepart part="30576_dat_doc" as="dat_38" title="Акт приемки законченного строительством объекта (Форма КС-11)" group="max">
          <const>38</const>
        </usepart>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_doc" />
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_ipr">
            <link name="kod_doc_osn" />
          </link>
          <extendwhere>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>3</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>2</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_titul_ip" />
            <useparam name="kod_titul_ip" />
          </call>
        </call>
      </where>
    </query>
    <query name="ips_klass_titul_tree_def" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="ips_klass_titul_tree" as="a" />
      </from>
      <where>
        <call function="in">
          <column table="a" column="kod_klass" />
          <const>83</const>
        </call>
      </where>
    </query>
    <query name="30581_tituls_list" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="kod_doc" type="number">
          <const>43383</const>
        </param>
        <param name="kod_direct" type="number" />
        <param name="kod_dirisp" type="number">
          <const></const>
        </param>
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630_tituls" as="a">
          <withparams>
            <useparam name="kod_doc" />
            <undefined></undefined>
            <useparam name="kod_direct" />
            <undefined></undefined>
            <const>1</const>
            <useparam name="kod_dirisp" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="30581" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="30581-dat" as="a">
          <usepart part="30581-withparams" />
          <grsets>
            <grset as="itog" level="" title="Итог">
              <where>
                <call function="=">
                  <call function="nvlu">
                    <useparam name="pr_svod" />
                    <const>0</const>
                  </call>
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset as="podr" level="1,4" title="Подразделение">
              <where>
                <call function="is not null">
                  <column table="a" column="kod_contr_steps_val" />
                </call>
              </where>
              <grset as="tit" level="2" title="Титул"></grset>
            </grset>
            <grset as="podr1" level="1,4" title="Подразделение(при наличии контр. этапов)">
              <where>
                <call function="is not null">
                  <column table="a" column="kod_contr_steps_val" />
                </call>
                <call function="=">
                  <call function="nvlu">
                    <useparam name="pr_detail" />
                    <const>0</const>
                  </call>
                  <const>1</const>
                </call>
              </where>
              <grset as="tit1" level="2" title="Титул(при наличии контр. этапов)">
                <grset as="ki1" level="3" title="Контрольный этап" order="step_ord"></grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="30581-date-def" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="kod_doc_kontr" type="array" />
      </params>
      <select>
        <call function="nvl" type="date" as="date1">
          <query>
            <select>
              <call function="max" as="doc_date">
                <column table="a" column="doc_date" />
              </call>
            </select>
            <from>
              <query name="ipr_doc" as="a" />
            </from>
            <where>
              <call function="or">
                <call function="false" />
                <call function="in" optional="1">
                  <column table="a" column="kod_doc" />
                  <useparam name="kod_doc_kontr" />
                </call>
              </call>
            </where>
          </query>
          <const>sysdate</const>
        </call>
      </select>
      <from>
        <table name="dual" as="b" />
      </from>
    </query>
    <query name="30581_user_name" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <select>
        <call function="||" as="name_user" type="string">
          <column table="kod_spr_dolg" column="name" />
          <const>' '</const>
          <column table="a" column="name" />
        </call>
      </select>
      <from>
        <query name="k_user" as="a">
          <slink name="is_rights">
            <link name="kod_person">
              <link name="kod_spr_dolg" />
            </link>
          </slink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="puser" />
            <const>user</const>
          </call>
        </call>
      </where>
    </query>
    <query name="30581-dat" grouplevel="no" timestamp="30.07.2018 17:42:43" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params" />
      </params>
      <select>
        <call function="date to char" as="sdate" group="max" title="Дата">
          <useparam name="date" />
        </call>
        <call function="year" as="year" group="max" title="Год">
          <useparam name="date" />
        </call>
        <call function="date to kv" as="kv" group="max" title="Квартал">
          <useparam name="date" />
        </call>
        <call function="if" as="name_dir" type="string" group="max">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="is_person_isp" column="fio" dgroup="max" />
          <column table="is_person_dir" column="fio" dgroup="max" />
        </call>
        <call function="if" as="kod_podr" group="1">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="kod_direct" />
          <column table="kod_direct" column="kod_direct" />
        </call>
        <!--<column table="kod_direct" column="kod_direct" as="kod_podr" group="1"/>-->
        <call function="if" as="podr_name" group="kod_podr">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name" />
          <column table="kod_direct" column="name" />
        </call>
        <!--<column table="kod_direct" column="name" as="podr_name" group="kod_podr"/>-->
        <call function="if" as="podr_name_kr" group="kod_podr">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name_kr" />
          <column table="kod_direct" column="name_kr" />
        </call>
        <call function="if" as="go_grp" group="4" title="Группа">
          <call function="=">
            <call function="nvlu">
              <useparam name="pr_gorobl" />
              <const>0</const>
            </call>
            <const>0</const>
          </call>
          <const>'СПб и ЛО'</const>
          <column table="kod_subject" column="abbr" />
        </call>
        <call function="||" as="podr_name_kr_go" group="kod_podr" title="Подразделение по областям">
          <column table="this" column="podr_name_kr" />
          <const>' '</const>
          <column table="this" column="go_grp" />
        </call>
        <!--<column table="kod_direct" column="name_kr" as="podr_name_kr" group="kod_podr"/>-->
        <column table="a" column="kod_titul_ip" group="2" />
        <column table="kod_titul_ip" column="tit_num_new" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="name" as="tit_name" group="kod_titul_ip" />
        <column table="a" column="kod_contr_steps_val" type="number" group="3" />
        <!--<column table="a" column="kod_ipr" group="kod_contr_steps_val"/>-->
        <call function="if" as="pr_g" type="number" group="kod_contr_steps_val">
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>0</const>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="ipr_contr_steps_val_ord" column="step_ord" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_ord" column="ord2" group="kod_contr_steps_val" />
        <call function="case" as="abbr" group="kod_contr_steps_val" type="string">
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>1</const>
            </call>
            <column table="kod_template_contr_steps_val" column="abbr" />
          </call>
          <call function="else">
            <const>''</const>
          </call>
        </call>
        <call function="case" as="name" group="kod_contr_steps_val" type="string">
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>1</const>
            </call>
            <column table="kod_template_contr_steps_val" column="name" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>2</const>
            </call>
            <column table="kod_template_contr_steps_val" column="num_cognos" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>3</const>
            </call>
            <column table="kod_template_contr_steps_val" column="name_rosseti" />
          </call>
        </call>
        <column table="kod_contr_steps_val" column="need" group="kod_contr_steps_val" />
        <column table="kod_contr_steps_val" column="wfact_date_beg" group="kod_contr_steps_val" as="bw_date" />
        <column table="kod_contr_steps_val" column="wfact_date_end" group="kod_contr_steps_val" as="ew_date" />
        <column table="kod_contr_steps_val" column="comments" group="kod_contr_steps_val" />
        <column table="kod_contr_steps_val" column="comments_fill" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="plan_date_beg" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="plan_date_end" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="fact_date_beg" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="fact_date_end" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="bp_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ep_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="bf_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ef_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ef_date_uch" group="kod_contr_steps_val">
          <if>
            <call function="le">
              <column table="ipr_contr_steps_val_dt" column="ef_date_uch" />
              <useparam name="datef" />
            </call>
          </if>
        </column>
        <column table="ipr_contr_steps_val_dt_prev" column="bp_date" as="bp_date_prev" group="kod_contr_steps_val" title="ПН" />
        <column table="ipr_contr_steps_val_dt_prev" column="ep_date" as="ep_date_prev" group="kod_contr_steps_val" title="ПК" />
        <column table="ipr_contr_steps_val_dt_prev" column="bf_date" as="bf_date_prev" group="kod_contr_steps_val" title="ФН" />
        <column table="ipr_contr_steps_val_dt_prev" column="ef_date" as="ef_date_prev" group="kod_contr_steps_val" title="ФК" />
        <column table="kod_contr_steps_val_prev" column="comments" group="kod_contr_steps_val" title="Коммент" as="comments_prev" />
        <column table="a" column="ipr_fin_steps" as="count_plan_year" title="К-во план за год" group="sum">
          <usepart part="30581-if-year">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_year" title="К-во факт за год" group="sum">
          <usepart part="30581-if-year">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_period" title="К-во план за период" group="sum">
          <usepart part="30581-if-period">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_period" title="К-во факт за период" group="sum">
          <usepart part="30581-if-period">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <!--<column table="a" column="ipr_fin_ipr" group="sum" />-->
        <!--<column table="a" column="ipr_fin_ipr" as="count_ipr_podr" dimname="podr" title="К-во проектов по подразделениям" group="sum">
          <usepart part="30581-pivot-podr"/>
        </column>-->
        <column table="a" column="kod_ipr" as="count_ipr_podr" dimname="podr" title="К-во проектов по подразделениям" group="count_dist">
          <usepart part="30581-pivot-podr" />
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_kv" dimname="kv_plan" title="К-во план по кварталам" group="sum">
          <usepart part="30581-pivot-kv">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_kv" dimname="kv_fact" title="К-во факт по кварталам" group="sum">
          <usepart part="30581-pivot-kv">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_podr" dimname="podr_plan" title="К-во план по подразделениям" group="sum">
          <usepart part="30581-pivot-podr-year">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_podr" dimname="podr_fact" title="К-во факт по подразделениям" group="sum">
          <usepart part="30581-pivot-podr-year">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_podr_kv" dimname="podr_kv_plan" title="К-во план по подразделениям и кварталам" group="sum">
          <usepart part="30581-pivot-podr-kv">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_podr_kv" dimname="podr_kv_fact" title="К-во факт по подразделениям и кварталам" group="sum">
          <usepart part="30581-pivot-podr-kv">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_contr_steps_val">
            <link name="kod_doc" as="kod_doc_steps" />
            <link name="kod_template_contr_steps_val" />
            <link name="ipr_contr_steps_val_ord" hint="materialize" />
            <link name="ipr_contr_steps_val_dt" />
            <link name="kod_contr_steps_val_prev">
              <link name="ipr_contr_steps_val_dt" as="ipr_contr_steps_val_dt_prev" />
            </link>
          </link>
          <link name="kod_ipr">
            <link name="kod_main_titul">
              <link name="kod_subject" />
            </link>
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct">
              <dlink name="is_person" as="is_person_dir">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="is_person_dir" column="kod_spr_dolg" />
                      <const comment="44295 было 0">54</const>
                    </call>
                    <call function="is null">
                      <column table="is_person_dir" column="dat_udal" />
                    </call>
                  </call>
                </where>
              </dlink>
            </link>
            <link name="kod_ispolnit">
              <dlink name="is_person" as="is_person_isp">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="is_person_isp" column="kod_spr_dolg" />
                      <const comment="44295 было 0">54</const>
                    </call>
                    <call function="is null">
                      <column table="is_person_isp" column="dat_udal" />
                    </call>
                  </call>
                </where>
              </dlink>
            </link>
          </link>
          <!--<extendwhere target-query="ipr_contr_steps_val">
            <call function="=">
              <table
            </call>
          </extendwhere>-->
          <extendwhere>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="between" optional="1" selective="1" comment="если это условие применялось только к контр. этапам то теперь оно лишнее, dat  в конт. э. заменил   на dat_doc_steps ">
                <column table="*" column="dat" />
                <call function="year begin time">
                  <call function="year">
                    <useparam name="date" />
                  </call>
                </call>
                <useparam name="date" />
              </call>
              <call function="le" optional="1" selective="1">
                <column table="*" column="dat_doc_steps" />
                <useparam name="date" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in" optional="1">
                <column table="kod_main_ipr_ipr_data1" column="kod_klass" />
                <useparam name="kod_klass_titul" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>3</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>2</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
            </call>
            <call function="!=nvl" optional="1" exclude="1">
              <column table="kod_titul_ip1" column="is_head_tit" />
              <const>1</const>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <!--если документ не задан берем последний, иначе заданный документ-->
        <call function="and">
          <call function="true" />
          <call function="or">
            <call function="and">
              <call function="=">
                <!--nvl, чтобы попадали строки из ipr_fin_ipr,  они не привязаны к документам-->
                <call function="nvl">
                  <column table="a" column="pr_steps_last" />
                  <const>1</const>
                </call>
                <const>1</const>
              </call>
              <call function="in" optional="1">
                <const>-1</const>
                <useparam name="kod_doc_kontr" />
              </call>
            </call>
            <call function="or">
              <call function="false" />
              <call optional="1" function="in">
                <column table="kod_contr_steps_val" column="kod_doc" />
                <useparam name="kod_doc_kontr" />
              </call>
            </call>
          </call>
          <call function="not in">
            <column table="this" column="name" />
            <array>'нет','нет соответствия'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="30581-passport" timestamp="15.05.2018 13:39:51" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="30581-dat-passport" as="a">
          <usepart part="30581-withparams" />
          <grsets>
            <grset as="itog" level="" title="Итог">
              <where>
                <call function="=">
                  <call function="nvlu">
                    <useparam name="pr_svod" />
                    <const>0</const>
                  </call>
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset as="podr" level="1,4" title="Подразделение">
              <where>
                <call function="is not null">
                  <column table="a" column="kod_contr_steps_val" />
                </call>
              </where>
              <grset as="tit" level="2" title="Титул" />
            </grset>
            <grset as="podr1" level="1,4" title="Подразделение(при наличии контр. этапов)">
              <where>
                <call function="is not null">
                  <column table="a" column="kod_contr_steps_val" />
                </call>
                <call function="=">
                  <call function="nvlu">
                    <useparam name="pr_detail" />
                    <const>0</const>
                  </call>
                  <const>1</const>
                </call>
              </where>
              <grset as="tit1" level="2" title="Титул(при наличии контр. этапов)">
                <grset as="ki1" level="3" title="Контрольный этап" order="step_ord" />
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="30581-dat-passport" grouplevel="no" timestamp="30.07.2018 17:43:35" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params" />
      </params>
      <select>
        <call function="date to char" as="sdate" group="max" title="Дата" exclude="1">
          <useparam name="date" />
        </call>
        <call function="year" as="year" group="max" title="Год">
          <useparam name="date" />
        </call>
        <call function="date to kv" as="kv" group="max" title="Квартал" exclude="1">
          <useparam name="date" />
        </call>
        <call function="if" as="name_dir" type="string" group="max">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="is_person_isp" column="fio" dgroup="max" />
          <column table="is_person_dir" column="fio" dgroup="max" />
        </call>
        <call function="if" as="kod_podr" group="1">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="kod_direct" />
          <column table="kod_direct" column="kod_direct" />
        </call>
        <!--<column table="kod_direct" column="kod_direct" as="kod_podr" group="1"/>-->
        <call function="if" as="podr_name" group="kod_podr" exclude="1">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name" />
          <column table="kod_direct" column="name" />
        </call>
        <call function="if" as="go_grp" group="4" title="Группа">
          <call function="=">
            <call function="nvlu">
              <useparam name="pr_gorobl" />
              <const>0</const>
            </call>
            <const>0</const>
          </call>
          <const>'СПб и ЛО'</const>
          <column table="kod_subject" column="abbr" />
        </call>
        <!--<column table="kod_direct" column="name" as="podr_name" group="kod_podr"/>-->
        <call function="if" as="podr_name_kr" group="kod_podr" exclude="1">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name_kr" />
          <column table="kod_direct" column="name_kr" />
        </call>
        <call function="||" as="podr_name_kr_go" group="kod_podr" title="Подразделение по областям" exclude="1">
          <column table="this" column="podr_name_kr" />
          <const>' '</const>
          <column table="this" column="go_grp" />
        </call>
        <!--<column table="kod_direct" column="name_kr" as="podr_name_kr" group="kod_podr"/>-->
        <column table="a" column="kod_titul_ip" group="2" />
        <column table="kod_titul_ip" column="tit_num_new" group="kod_titul_ip" exclude="1" />
        <column table="kod_titul_ip" column="name" as="tit_name" group="kod_titul_ip" />
        <column table="a" column="kod_contr_steps_val" type="number" group="3" />
        <!--<column table="a" column="kod_ipr" group="kod_contr_steps_val"/>-->
        <call function="if" as="pr_g" type="number" group="kod_contr_steps_val">
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>0</const>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="ipr_contr_steps_val_ord" column="step_ord" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_ord" column="ord2" group="kod_contr_steps_val" />
        <call function="case" as="abbr" group="kod_contr_steps_val" type="string">
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>1</const>
            </call>
            <column table="kod_template_contr_steps_val" column="abbr" />
          </call>
          <call function="else">
            <const>''</const>
          </call>
        </call>
        <call function="case" as="name" group="kod_contr_steps_val" type="string">
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>1</const>
            </call>
            <column table="kod_template_contr_steps_val" column="name" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>2</const>
            </call>
            <column table="kod_template_contr_steps_val" column="num_cognos" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="kod_name_tmp" />
              <const>3</const>
            </call>
            <column table="kod_template_contr_steps_val" column="name_rosseti" />
          </call>
        </call>
        <column table="kod_contr_steps_val" column="need" group="kod_contr_steps_val" />
        <column table="kod_contr_steps_val" column="wfact_date_beg" group="kod_contr_steps_val" as="bw_date" />
        <column table="kod_contr_steps_val" column="wfact_date_end" group="kod_contr_steps_val" as="ew_date" />
        <column table="kod_contr_steps_val" column="comments" group="kod_contr_steps_val" />
        <column table="kod_contr_steps_val" column="comments_fill" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="plan_date_beg" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="plan_date_end" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="fact_date_beg" group="kod_contr_steps_val" />
        <column table="kod_template_contr_steps_val" column="fact_date_end" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="bp_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ep_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="bf_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ef_date" group="kod_contr_steps_val" />
        <column table="ipr_contr_steps_val_dt" column="ef_date_uch" group="kod_contr_steps_val">
          <if>
            <call function="le">
              <column table="ipr_contr_steps_val_dt" column="ef_date_uch" />
              <useparam name="datef" />
            </call>
          </if>
        </column>
        <column table="ipr_contr_steps_val_dt_prev" column="bp_date" as="bp_date_prev" group="kod_contr_steps_val" title="ПН" />
        <column table="ipr_contr_steps_val_dt_prev" column="ep_date" as="ep_date_prev" group="kod_contr_steps_val" title="ПК" />
        <column table="ipr_contr_steps_val_dt_prev" column="bf_date" as="bf_date_prev" group="kod_contr_steps_val" title="ФН" />
        <column table="ipr_contr_steps_val_dt_prev" column="ef_date" as="ef_date_prev" group="kod_contr_steps_val" title="ФК" />
        <column table="kod_contr_steps_val_prev" column="comments" group="kod_contr_steps_val" title="Коммент" as="comments_prev" />
        <column table="a" column="ipr_fin_steps" as="count_plan_year" title="К-во план за год" group="sum">
          <usepart part="30581-if-year">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_year" title="К-во факт за год" group="sum">
          <usepart part="30581-if-year">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_period" title="К-во план за период" group="sum" exclude="1">
          <usepart part="30581-if-period">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_period" title="К-во факт за период" group="sum" exclude="1">
          <usepart part="30581-if-period">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <!--<column table="a" column="ipr_fin_ipr" group="sum" />-->
        <!--<column table="a" column="ipr_fin_ipr" as="count_ipr_podr" dimname="podr" title="К-во проектов по подразделениям" group="sum">
          <usepart part="30581-pivot-podr"/>
        </column>-->
        <column table="a" column="kod_ipr" as="count_ipr_podr" dimname="podr" title="К-во проектов по подразделениям" group="count_dist" exclude="1">
          <usepart part="30581-pivot-podr" />
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_kv" dimname="kv_plan" title="К-во план по кварталам" group="sum">
          <usepart part="30581-pivot-kv">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_kv" dimname="kv_fact" title="К-во факт по кварталам" group="sum">
          <usepart part="30581-pivot-kv">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_podr" dimname="podr_plan" title="К-во план по подразделениям" group="sum" exclude="1">
          <usepart part="30581-pivot-podr-year">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_podr" dimname="podr_fact" title="К-во факт по подразделениям" group="sum" exclude="1">
          <usepart part="30581-pivot-podr-year">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_plan_podr_kv" dimname="podr_kv_plan" title="К-во план по подразделениям и кварталам" group="sum" exclude="1">
          <usepart part="30581-pivot-podr-kv">
            <column table="this" column="ep_date" group="" />
          </usepart>
        </column>
        <column table="a" column="ipr_fin_steps" as="count_fact_podr_kv" dimname="podr_kv_fact" title="К-во факт по подразделениям и кварталам" group="sum" exclude="1">
          <usepart part="30581-pivot-podr-kv">
            <column table="this" column="ef_date_uch" group="" />
          </usepart>
        </column>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_contr_steps_val">
            <link name="kod_doc" as="kod_doc_steps" />
            <link name="kod_template_contr_steps_val" />
            <link name="ipr_contr_steps_val_ord" hint="materialize" />
            <link name="ipr_contr_steps_val_dt" />
            <link name="kod_contr_steps_val_prev">
              <link name="ipr_contr_steps_val_dt" as="ipr_contr_steps_val_dt_prev" />
            </link>
          </link>
          <link name="kod_ipr">
            <link name="kod_main_titul">
              <link name="kod_subject" />
            </link>
          </link>
          <link name="kod_titul_ip">
            <link name="kod_direct">
              <dlink name="is_person" as="is_person_dir">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="is_person_dir" column="kod_spr_dolg" />
                      <const comment="44295 было 0">54</const>
                    </call>
                    <call function="is null">
                      <column table="is_person_dir" column="dat_udal" />
                    </call>
                  </call>
                </where>
              </dlink>
            </link>
            <link name="kod_ispolnit">
              <dlink name="is_person" as="is_person_isp">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="is_person_isp" column="kod_spr_dolg" />
                      <const comment="44295 было 0">54</const>
                    </call>
                    <call function="is null">
                      <column table="is_person_isp" column="dat_udal" />
                    </call>
                  </call>
                </where>
              </dlink>
            </link>
          </link>
          <!--<extendwhere target-query="ipr_contr_steps_val">
            <call function="=">
              <table
            </call>
          </extendwhere>-->
          <extendwhere>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="between" optional="1" selective="1" comment="если это условие применялось только к контр. этапам то теперь оно лишнее, dat  в конт. э. заменил   на dat_doc_steps ">
                <column table="*" column="dat" />
                <call function="year begin time">
                  <call function="year">
                    <useparam name="date" />
                  </call>
                </call>
                <useparam name="date" />
              </call>
              <call function="le" optional="1" selective="1">
                <column table="*" column="dat_doc_steps" />
                <useparam name="date" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in" optional="1">
                <column table="kod_main_ipr_ipr_data1" column="kod_klass" />
                <useparam name="kod_klass_titul" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>3</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>2</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
            </call>
            <call function="!=nvl" optional="1" exclude="1">
              <column table="kod_titul_ip1" column="is_head_tit" />
              <const>1</const>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <!--если документ не задан берем последний, иначе заданный документ-->
        <call function="and">
          <call function="true" />
          <call function="or">
            <call function="and">
              <call function="=">
                <!--nvl, чтобы попадали строки из ipr_fin_ipr,  они не привязаны к документам-->
                <call function="nvl">
                  <column table="a" column="pr_steps_last" />
                  <const>1</const>
                </call>
                <const>1</const>
              </call>
              <call function="in" optional="1">
                <const>-1</const>
                <useparam name="kod_doc_kontr" />
              </call>
            </call>
            <call function="or">
              <call function="false" />
              <call optional="1" function="in">
                <column table="kod_contr_steps_val" column="kod_doc" />
                <useparam name="kod_doc_kontr" />
              </call>
            </call>
          </call>
          <call function="not in">
            <column table="this" column="name" />
            <array>'нет','нет соответствия'</array>
          </call>
        </call>
      </where>
    </query>
    <query name="30923-cols-tek" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="30923-cols" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id" />
          <const>'Текущая'</const>
        </call>
      </where>
    </query>
    <query name="30923-cols" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <const as="id" type="string">'Текущая'</const>
      <const as="name" type="string" title="1">'Текущая'</const>
      <const>'Фиксированная'</const>
      <const>'Фиксированная'</const>
    </query>
    <query name="30923" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <usepart part="30923-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="30923-dat" as="a">
          <withparams>
            <useparam name="doc_osn" />
            <useparam name="kod_direct" />
            <useparam name="kod_dirisp_all" />
            <useparam name="pr_notaip" />
            <useparam name="mp" />
            <useparam name="kod_ofz" />
          </withparams>
          <grsets>
            <grset as="titul" title="Головной/ одиночный титул" level="1,2">
              <grset as="titul_h" title="Головной титул" level="">
                <where>
                  <call function="=">
                    <column table="a" column="is_head_tit" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset as="titul_s" title="Одиночный титул" level="3">
                <where>
                  <call function="!=">
                    <column table="a" column="is_head_tit" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset as="dogh" title="договоры заголовок" level="">
                <where>
                  <call function="and">
                    <call function="!=">
                      <column table="a" column="is_head_tit" />
                      <const>1</const>
                    </call>
                    <call function="or">
                      <call function="false" />
                      <call function="=1" optional="1">
                        <useparam name="show_dog" />
                      </call>
                    </call>
                  </call>
                </where>
                <grset as="dog" title="договоры" level="7">
                  <where>
                    <call function="is not null">
                      <column table="a" column="kod_dog_i" />
                    </call>
                  </where>
                </grset>
              </grset>
              <usepart part="30923-grset">
                <const>''</const>
              </usepart>
              <grset as="titul_ch" title="Дочерний титул" level="3,4">
                <where>
                  <call function="is not null">
                    <column table="a" column="kod_child_titul" />
                  </call>
                </where>
                <grset as="dogh_ch" title="договоры заголовок" level="">
                  <where>
                    <call function="or">
                      <call function="false" />
                      <call function="=1" optional="1">
                        <useparam name="show_dog" />
                      </call>
                    </call>
                  </where>
                  <grset as="dog_ch" title="договоры" level="7">
                    <where>
                      <call function="is not null">
                        <column table="a" column="kod_dog_i" />
                      </call>
                    </where>
                  </grset>
                </grset>
                <usepart part="30923-grset">
                  <const>'_ch'</const>
                </usepart>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="30923-dat" grouplevel="no" timestamp="13.12.2016 08:55:38" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <param name="doc_osn">
          <const>143403</const>
        </param>
        <param name="kod_direct" />
        <param name="kod_dirisp_all">
          <const>3</const>
        </param>
        <param name="pr_notaip" />
        <param name="mp">
          <const>0</const>
        </param>
        <param name="kod_ofz" />
      </params>
      <select>
        <call function="if" as="kod_podr" group="1">
          <call function="=">
            <useparam name="kod_dirisp_all" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="kod_direct" />
          <column table="kod_direct" column="kod_direct" />
        </call>
        <call function="if" as="podr_name" group="kod_podr">
          <call function="=">
            <useparam name="kod_dirisp_all" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name" />
          <column table="kod_direct" column="name" />
        </call>
        <call function="if" as="podr_name_kr" group="kod_podr">
          <call function="=">
            <useparam name="kod_dirisp_all" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit" column="name_kr" />
          <column table="kod_direct" column="name_kr" />
        </call>
        <column table="a" column="kod_ipr" group="max" />
        <column table="kod_ipr" column="kod_main_titul" group="2" />
        <column table="kod_ipr" column="kod_titul_ip" group="3" />
        <column table="kod_main_titul" column="tit_num_new" group="kod_main_titul" />
        <column table="kod_main_titul" column="name" as="tit_name" group="kod_main_titul" />
        <column table="kod_main_titul" column="beg_year" group="kod_main_titul" />
        <column table="kod_main_titul" column="end_year" group="kod_main_titul" />
        <column table="kod_main_titul" column="is_head_tit" group="kod_main_titul" />
        <column table="kod_ipr" column="kod_child_titul" group="4" />
        <column table="kod_titul_ip" column="tit_num_new" as="+_ch" group="kod_child_titul" />
        <column table="kod_titul_ip" column="name" as="tit_name_ch" group="kod_child_titul" />
        <column table="kod_titul_ip" column="beg_year" as="+_ch" group="kod_child_titul" />
        <column table="kod_titul_ip" column="end_year" as="+_ch" group="kod_child_titul" />
        <call function="if" as="podr_name_kr_ch" title="Подразделение дочернего титула" group="kod_child_titul">
          <call function="=">
            <useparam name="kod_dirisp_all" />
            <const>3</const>
          </call>
          <column table="kod_ispolnit_ch" column="name_kr" />
          <column table="kod_direct_ch" column="name_kr" />
        </call>
        <call function="+nvl" as="km" group="sum">
          <column table="a" column="km" />
          <column table="a" column="km_kl" />
        </call>
        <column table="a" column="pow" as="mva" group="sum" mp="-6" />
        <column table="a" column="other" group="sum" />
        <column table="a" column="kod_smet" group="5" />
        <column table="kod_smet_ext" column="name" as="name_smet_ext" group="kod_smet" />
        <column table="a" column="kod_smet_sub" group="6" />
        <column table="kod_smet_sub" column="name" as="name_smet" group="kod_smet_sub" />
        <usepart part="30923-smet_cols">
          <const>''</const>
          <const>'Фиксированная'</const>
        </usepart>
        <usepart part="30923-smet_cols">
          <const>'_tek'</const>
          <const>'Текущая'</const>
        </usepart>
        <column table="a" column="ipr_fin_ipr" group="max" />
        <column table="b" column="info" title="Комментарии" group="kod_titul_ip" />
        <column table="a" column="dog_plan_cost" mp="[:mp]" group="sum" />
        <column table="kod_dog_i" column="kod_dog_i" group="7" title="kod_dog" />
        <column table="kod_dog_i" column="num_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="predm_dog" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_end_i" group="kod_dog_i" />
        <column table="e_code" column="name_all" group="kod_dog_i" as="name_contr" />
        <column table="kod_dog_i" column="tip_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="status_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="name_i" group="kod_dog_i" />
        <!--чтобы всегда выводились МВА,КМ из характеристик-->
        <!--<column table="a" column="ipr_fin_ipr" group="max"/>-->
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_direct" as="kod_direct_ch" />
              <link name="kod_ispolnit" as="kod_ispolnit_ch" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
            </link>
          </link>
          <link name="kod_smet_ext" />
          <link name="kod_smet_sub" />
          <link name="kod_dog_i">
            <link name="kod_dog">
              <link name="e_code" />
            </link>
          </link>
          <extendwhere>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="doc_osn" />
              </call>
              <call function="=" selective="1">
                <column table="*" column="pr_last_smet" />
                <const>1</const>
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp_all" />
                    <array>1,3</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_dirisp_all" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp_all" />
                    <array>1,2</array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </extendwhere>
        </query>
        <query name="30923-old-info" as="b" join="left outer">
          <call function="=">
            <column table="a" column="kod_ipr" />
            <column table="b" column="kod_ipr" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="30923-old-info" timestamp="08.03.2016 02:10:27" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <param name="doc_osn">
          <const>143403</const>
        </param>
        <param name="kod_direct" />
        <param name="kod_dirisp_all">
          <const>3</const>
        </param>
        <param name="pr_notaip" />
        <param name="mp">
          <const>0</const>
        </param>
        <param name="kod_ofz" />
      </params>
      <select>
        <column table="a" column="kod_ipr" key="1" group="1" />
        <call function="replace" as="info" type="string">
          <call function="||" group="stragg_dist">
            <column table="doc_target_str" column="name" />
            <const>' '</const>
            <column table="kod_doc_smet" column="name" />
            <const>' '</const>
            <column table="a" column="summ_smet_tek_on_doc" />
            <const>' руб.'</const>
          </call>
          <const>','</const>
          <const>';'</const>
        </call>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="doc_osn" />
              </call>
              <call function="not" selective="1">
                <call function="=">
                  <column table="*" column="pr_last_smet" />
                  <const>1</const>
                </call>
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp_all" />
                    <array>1,3</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_dirisp_all" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp_all" />
                    <array>1,2</array>
                  </call>
                </call>
              </call>
            </call>
          </extendwhere>
          <link name="kod_doc_smet" />
          <link name="doc_target_str" />
        </query>
      </from>
    </query>
    <query name="32274-razdel-gor" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-razdel" as="a">
          <usepart part="32274-withparams-gor" />
        </query>
      </from>
    </query>
    <query name="32274-razdel-obl" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-razdel" as="a">
          <usepart part="32274-withparams-obl" />
        </query>
      </from>
    </query>
    <query name="32274-titul-gor" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-titul" as="a">
          <usepart part="32274-withparams-gor" />
        </query>
      </from>
    </query>
    <query name="32274-titul-obl" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-titul" as="a">
          <usepart part="32274-withparams-obl" />
        </query>
      </from>
    </query>
    <query name="32274-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <call function="mes-name-rp" as="mes1" type="string" key="1">
          <useparam name="mon1" />
        </call>
        <call function="mes-name" as="mes2" type="string">
          <useparam name="mon2" />
        </call>
        <call function="" as="year" type="number">
          <useparam name="year" />
        </call>
        <column table="a" column="name" as="mp" type="string" />
        <call function="get_reports_const" as="viza1_fio">
          <const>null</const>
          <const>1</const>
        </call>
        <call function="get_reports_const" as="viza1_dolzh">
          <const>null</const>
          <const>2</const>
        </call>
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_mp" />
            <useparam name="mp" />
          </call>
        </call>
      </where>
    </query>
    <query name="32274-rep-type-list" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <const as="id" type="string">'32274'</const>
      <const as="name" type="string">'Минэнерго'</const>
      <const>'32274-1'</const>
      <const>'Россети'</const>
    </query>
    <query name="32274-mp-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <const>-6</const>
        </call>
      </where>
    </query>
    <query name="32274-titul" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-dat" as="a">
          <usepart part="32274-withparams" />
          <grsets>
            <grset level="1,2,3" title="Сборный (узел)" as="sbor_node">
              <where>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_razdel7" />
                  </call>
                  <call function="!=">
                    <column table="a" column="kod_razdel" />
                    <const>248</const>
                  </call>
                </call>
              </where>
              <grset level="" title="Сборный (вывод)" as="sbor">
                <where>
                  <call function="and">
                    <call function="or">
                      <call function="false" />
                      <call function="and" optional="1">
                        <call function="=1">
                          <useparam name="pr_sbor" />
                        </call>
                        <!--<call function="!=">
                          <call function="nvlu">
                            <useparam name="pr_cognos" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>-->
                      </call>
                      <call function="=1" optional="1">
                        <useparam name="pr_cognos" />
                      </call>
                    </call>
                    <call function="is not null">
                      <column table="a" column="kod_titul_ip_sbor" />
                    </call>
                    <!--<call function="and" optional="1">
                      <call function="=1">
                        <useparam name="pr_cognos" />
                      </call>
                      <call function="=">
                        <column table="a" column="with_details_sbor" />
                        <const>1</const>
                      </call>
                    </call>-->
                  </call>
                </where>
              </grset>
              <grset level="4" title="Головной/Одиночный (узел)" as="main_node">
                <where>
                  <call function="and">
                    <call function="true" />
                    <call function="and" optional="1">
                      <call function="=1">
                        <useparam name="pr_cognos" />
                      </call>
                      <call function="or">
                        <call function="=">
                          <column table="a" column="with_details_sbor" />
                          <const>1</const>
                        </call>
                        <call function="is null">
                          <column table="a" column="kod_titul_ip_sbor" />
                        </call>
                      </call>
                    </call>
                  </call>
                </where>
                <grset level="" title="Головной/Одиночный (вывод)" as="main">
                  <where>
                    <call function="and">
                      <call function="true" />
                    </call>
                  </where>
                </grset>
                <grset level="5" title="Дочерний (вывод)" as="child">
                  <where>
                    <call function="and">
                      <call function="or">
                        <call function="false" />
                        <call function="and" optional="1">
                          <call function="=1">
                            <useparam name="pr_child" />
                          </call>
                          <!--<call function="!=">
                            <call function="nvlu">
                              <useparam name="pr_cognos" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>-->
                        </call>
                        <call function="=1" optional="1">
                          <useparam name="pr_cognos" />
                        </call>
                      </call>
                      <call function="is not null">
                        <column table="a" column="kod_child_titul" />
                      </call>
                      <call function="and" optional="1">
                        <call function="=1">
                          <useparam name="pr_cognos" />
                        </call>
                        <call function="=">
                          <column table="a" column="with_details_main" />
                          <const>1</const>
                        </call>
                      </call>
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32274-razdel" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="lvl" />
        <column table="a" column="rwn" />
        <column table="a" column="kod_parent_node" />
        <column table="a" column="kod_node" />
        <column table="a" column="kod_minenergo" />
        <column table="kod_minenergo" column="abbr" as="razdel_abbr" />
        <column table="kod_minenergo" column="full_name" />
        <column table="b" column="*" />
      </select>
      <from>
        <query name="ipv_razdel_mn_tree" as="a">
          <link name="kod_minenergo" />
        </query>
        <query name="32274-razdel-data" as="b" join="left outer">
          <usepart part="32274-withparams" />
          <using>
            <column column="kod_minenergo" />
          </using>
        </query>
      </from>
    </query>
    <query name="32274-razdel-rs" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="lvl" />
        <column table="a" column="rwn" />
        <column table="a" column="kod_parent_node" />
        <column table="a" column="kod_node" />
        <column table="a" column="kod_klass" />
        <column table="kod_klass" column="abbr_num" as="razdel_abbr" />
        <column table="kod_klass" column="full_name" />
        <column table="b" column="*" />
      </select>
      <from>
        <query name="ipv_razdel_rs_tree" as="a">
          <link name="kod_klass" />
        </query>
        <query name="32274-razdel-rs-data" as="b" join="left outer">
          <usepart part="32274-withparams" />
          <using>
            <column column="kod_klass" />
          </using>
        </query>
      </from>
    </query>
    <query name="32274-razdel-data" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-dat" as="a">
          <usepart part="32274-withparams" />
          <grsets>
            <grset level="1" title="Раздел" as="razdel"></grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32274-razdel-rs-data" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32274-dat" as="a">
          <usepart part="32274-withparams" />
          <grsets>
            <grset level="2" title="Раздел" as="razdel_rs"></grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32274-dat" grouplevel="no" use-repository="1" timestamp="18.04.2018 18:25:32" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <select>
        <column table="kod_minenergo" column="kod_minenergo" group="1" />
        <!--<column table="kod_titul_ip" column="kod_minenergo" group="1" />-->
        <column table="kod_razdel" column="kod_razdel" group="kod_minenergo" />
        <column table="kod_razdel_rs" column="kod_klass" group="2" />
        <!--<column table="kod_razdel" column="full_name" group="kod_razdel" exclude="1" />-->
        <column table="kod_sbor_titul" column="kod_sbor_titul" group="3" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new" as="tit_num_new_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="name" as="name_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="with_details" as="with_details_sbor" group="kod_sbor_titul" title="Раскрывать детализацию" nvl="0" />
        <column table="kod_ipr" column="kod_main_titul" group="4" />
        <column table="kod_main_titul" column="tit_num_new" as="tit_num_new_main" group="kod_main_titul" title="{+} (головной/одиночный)" />
        <column table="kod_main_titul" column="name" as="name_main" group="kod_main_titul" title="{+} (головной/одиночный)" />
        <column table="kod_main_titul" column="with_details" as="with_details_main" group="kod_main_titul" title="Раскрывать детализацию" nvl="0" />
        <column table="kod_ipr" column="kod_child_titul" group="5" />
        <column table="kod_child_titul" column="tit_num_new" as="tit_num_new_child" group="kod_child_titul" title="{+} (дочерний)" />
        <column table="kod_child_titul" column="name" as="name_child" group="kod_child_titul" title="{+} (дочерний)" />
        <column table="a" column="kod_ipr" group="kod_minenergo" />
        <!--<column table="kod_ipr" column="kod_titul_ip" group="1" />
        <column table="kod_titul_ip" column="name" group="kod_titul_ip" exclude="1" />-->
        <column table="kod_subject" column="abbr" group="kod_main_titul" />
        <column table="a" column="fp_sum_nds" as="fp_sum_by_smet" group="sum" dimname="smet" mp="[:mp]">
          <pivot title=" в разрезе сметы">
            <call function="and">
              <call function="between">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon2" />
                </call>
              </call>
              <call function="=">
                <column table="a" column="kod_smet" />
                <column table="dim" column="kod_smet" />
              </call>
            </call>
            <query order="decode(kod_smet,1,1,3,2,2,3,4,4,kod_smet)" comment="44341 заменить местами графы «строительно-монтажные работы» и «оборудование и материалы»">
              <select>
                <column table="ips_smet" column="kod_smet" />
                <column table="ips_smet" column="name_cognos" />
              </select>
              <from>
                <query name="ips_smet_structure" as="ips_smet" />
              </from>
              <where>
                <call function="and">
                  <call function="lt">
                    <column table="ips_smet" column="kod_smet" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="fp_sum_nds_fact_b" as="fp_sum_fact_by_smet" group="sum" dimname="smet" mp="[:mp]" />
        <call function="-nvl" as="fp_otkl" group="sum" title="Отклонение фактической стоимости работ от плановой стоимости" dimname="smet">
          <column table="a" column="fp_sum_nds_fact_b" mp="[:mp]" />
          <column table="a" column="fp_sum_nds" mp="[:mp]" />
        </call>
        <column table="a" column="kap_sum" group="sum" dimname="smet" mp="[:mp]" />
        <column table="a" column="kap_sum_fact_d" group="sum" dimname="smet" mp="[:mp]" as="kap_sum_fact" exclude="1" />
        <call function="-nvl" as="kap_otkl" group="sum" title="Отклонение фактического освоения от планового освоения" dimname="smet" exclude="1">
          <column table="a" column="kap_sum_fact_d" mp="[:mp]" />
          <column table="a" column="kap_sum" mp="[:mp]" />
        </call>
        <call function="if" as="kap_sum_fact" group="sum" title="Отклонение фактического освоения от планового освоения" dimname="smet" type="number">
          <call function="le">
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
            <const>201709</const>
          </call>
          <column table="a" column="kap_sum_fact_d" mp="[:mp]" />
          <column table="a" column="kap_sum_fact_n" mp="[:mp]" />
        </call>
        <call function="-nvl" as="kap_otkl" group="sum" title="Отклонение фактического освоения от планового освоения" dimname="smet">
          <call function="if">
            <call function="le">
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
              <const>201709</const>
            </call>
            <column table="a" column="kap_sum_fact_d" mp="[:mp]" />
            <column table="a" column="kap_sum_fact_n" mp="[:mp]" />
          </call>
          <column table="a" column="kap_sum" mp="[:mp]" />
        </call>
        <call function="nvl" title="Год ввода в эксплуатацию" group="max" as="year_vvod">
          <column table="kod_child_titul" column="end_year" />
          <column table="kod_main_titul" column="end_year" />
        </call>
        <column table="a" column="eksp_norm_podst" group="max" />
        <column table="a" column="phis_numtr_itog" if="itog" group="stragg_dist" as="name_tr">
          <section>
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </section>
        </column>
        <call function="to_char" group="stragg_dist" as="col_tr">
          <column table="a" column="phis_coltr_itog" if="itog" />
        </call>
        <column table="a" column="phis_mvatr_itog" as="phis_mvatr" if="itog" group="sum" mp="-6" />
        <column table="a" column="eksp_norm_lin" group="max" />
        <column table="a" column="phis_typel_itog" as="phis_typel" if="itog" group="stragg_dist" />
        <column table="a" column="phis_numl_itog" as="phis_numl" if="itog" group="stragg_dist" />
        <call function="+nvl" as="phis_km" group="sum">
          <column table="a" column="phis_km_vl_itog" if="itog" />
          <column table="a" column="phis_km_kl_itog" if="itog" />
        </call>
        <column table="a" column="phis_other_itog" as="phis_other" if="itog" group="sum" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr">
            <link name="kod_titul_ip" />
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
              </link>
            </link>
            <link name="kod_child_titul" />
            <link name="kod_minenergo" />
            <link name="kod_razdel_rs" />
            <link name="kod_razdel" />
          </link>
          <extendwhere exclude="1">
            <call function="=" exclude="1">
              <column table="kod_ipr" column="kod_titul_ip" />
              <const>8742</const>
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_ipr" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_ipr" column="kod_main_titul" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_sbor_titul1" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <!--<call function="between">
              <column table="*" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon1" />
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>-->
            <call function="or">
              <call function="between">
                <column table="*" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon2" />
                </call>
              </call>
              <call function="and">
                <call function="lt">
                  <column table="*" column="ym" />
                  <call function="num to ym2">
                    <useparam name="year" />
                    <useparam name="mon1" />
                  </call>
                </call>
                <call function="is null">
                  <column table="*" column="ym_nxt" />
                </call>
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>3</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="=">
                  <const>2</const>
                  <useparam name="kod_dirisp" />
                </call>
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="kod_subject" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="in" optional="1">
            <column table="kod_subject" column="kod_subject" />
            <useparam name="kod_2subject" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or">
            <call function="between">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon1" />
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>
            <call function="and">
              <call function="lt">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
              </call>
              <call function="is null">
                <column table="a" column="ym_nxt" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="ym" />
            </call>
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="=">
                <const>3</const>
                <useparam name="kod_dirisp" />
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="=">
                <const>2</const>
                <useparam name="kod_dirisp" />
              </call>
            </call>
            <call function="and">
              <call function="or">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
              </call>
              <call function="=">
                <const>1</const>
                <useparam name="kod_dirisp" />
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
        </call>
      </where>
    </query>
    <query name="32394" title="Отчет ГКПЗ" is-report="1" allow-save="1" folder="invpro" nogrid="1" with-behavior="0" timestamp="06.12.2017 15:21:00" can-use-simple-params="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\32394.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="year" name="p_year" column-mandatory="1" />
        <usefield field="ipr_doc_pz" name="kod_doc_pz" />
        <usefield field="ipr_kod_direct" name="p_department_id" />
        <usefield field="ipr_kod_dirisp_all" name="p_customer" column-mandatory="1" />
        <usefield field="ipr_subject" name="p_region_id" />
      </content>
      <params exclude="1">
        <param name="p_year" field="year" type="number" mandatory="0" />
        <param name="kod_doc_pz" field="ipr_doc_pz" type="array" mandatory="0" />
        <param name="p_department_id" field="ipr_kod_direct" type="array" mandatory="0" />
        <param name="p_customer" field="ipr_kod_dirisp_all" type="number" mandatory="0" />
        <param name="p_region_id" field="ipr_subject" type="array" mandatory="0" />
      </params>
      <print-templates>
        <excel>
          <template name="32394.xlsx" title="Отчет ГКПЗ" del-cols="1" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <select>
        <call function="rownum" as="id" comment="так ошибка" exclude="1" />
        <call function="row_num" as="id" comment="а так нет. глюк оракла!?">
          <const>1</const>
        </call>
        <call function="to_char0" as="f0" type="string" title="">
          <useparam name="p_year" />
        </call>
        <column table="a" column="f1" type="string" title="" />
        <column table="a" column="f2" type="string" title="" />
        <column table="a" column="f3" type="string" title="" />
        <column table="a" column="f4" type="string" title="" />
        <column table="a" column="f5" type="string" title="" />
        <column table="a" column="f6" type="string" title="" />
        <column table="a" column="f7" type="string" title="" />
        <column table="a" column="f8" type="string" title="" />
        <column table="a" column="f9" type="string" title="" />
        <column table="a" column="f10" type="string" title="" />
        <column table="a" column="f11" type="string" title="" />
        <column table="a" column="f12" type="string" title="" />
        <column table="a" column="f13" type="string" title="" />
        <column table="a" column="f14" type="string" title="" />
        <column table="a" column="f15" type="string" title="" />
        <column table="a" column="f16" type="string" title="" />
        <column table="a" column="f17" type="string" title="" />
        <column table="a" column="f28" type="number" title="" />
        <column table="a" column="f29" type="number" title="" />
        <column table="a" column="f20" type="number" title="" />
        <column table="a" column="f21" type="string" title="" />
        <column table="a" column="f22" type="number" title="" />
        <column table="a" column="f23" type="number" title="" />
        <column table="a" column="f24" type="number" title="" />
        <column table="a" column="f25" type="number" title="" />
        <column table="a" column="f26" type="number" title="" />
        <column table="a" column="f27" type="number" title="" />
        <column table="a" column="f18" type="number" title="" />
        <column table="a" column="f19" type="number" title="" />
        <column table="a" column="f30" type="number" title="" />
        <column table="a" column="f31" type="number" title="" />
        <column table="a" column="f32" type="number" title="" />
        <column table="a" column="f33" type="number" title="" />
        <column table="a" column="f34" type="string" title="" />
        <column table="a" column="f35" type="string" title="" />
        <column table="a" column="f36" type="string" title="" />
        <column table="a" column="f37" type="string" title="" />
        <column table="a" column="f38" type="date" title="" />
        <column table="a" column="f39" type="date" title="" />
        <column table="a" column="f40" type="string" title="" />
        <column table="a" column="f41" type="string" title="" />
        <column table="a" column="f42" type="string" title="" />
        <column table="a" column="f43" type="string" title="" />
        <column table="a" column="f44" type="string" title="" />
        <column table="a" column="f45" type="string" title="" />
        <column table="a" column="f46" type="number" title="" />
        <column table="a" column="f47" type="string" title="" />
        <column table="a" column="f48" type="string" title="" />
        <column table="a" column="f49" type="date" title="" />
        <column table="a" column="f50" type="date" title="" />
        <column table="a" column="f51" type="date" title="" />
        <column table="a" column="f52" type="string" title="" />
        <column table="a" column="f53" type="string" title="" />
        <column table="a" column="f54" type="string" title="" />
        <column table="a" column="f55" type="string" title="" />
        <column table="a" column="f56" type="string" title="" />
        <column table="a" column="f57" type="string" title="" />
        <column table="a" column="f58" type="string" title="" />
        <column table="a" column="f59" type="string" title="" />
        <column table="a" column="f60" type="string" title="" />
        <column table="a" column="f61" type="number" title="" />
        <column table="a" column="f62" type="string" title="" />
        <column table="a" column="f63" type="number" title="" />
        <column table="a" column="f64" type="number" title="" />
        <column table="a" column="f65" type="string" title="" />
        <column table="a" column="f66" type="string" title="" />
        <column table="a" column="f67" type="string" title="" />
        <column table="a" column="f68" type="string" title="" />
        <column table="a" column="f69" type="string" title="" />
        <column table="a" column="f70" type="string" title="" />
        <column table="a" column="f71" type="string" title="" />
        <column table="a" column="f72" type="number" title="" />
        <column table="a" column="f73" type="number" title="" />
      </select>
      <from>
        <table name="32394-view" as="a" view="1" />
      </from>
    </query>
    <query name="32443-razdel-gor" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-razdel" as="a">
          <usepart part="32443-withparams-gor" />
        </query>
      </from>
    </query>
    <query name="32443-razdel-obl" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-razdel" as="a">
          <usepart part="32443-withparams-obl" />
        </query>
      </from>
    </query>
    <query name="32443-titul-gor" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-titul" as="a">
          <usepart part="32443-withparams-gor" />
        </query>
      </from>
    </query>
    <query name="32443-titul-obl" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-titul" as="a">
          <usepart part="32443-withparams-obl" />
        </query>
      </from>
    </query>
    <query name="32443-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <call function="mes-name-rp" as="mes1" type="string" key="1">
          <useparam name="mon1" />
        </call>
        <call function="mes-name" as="mes2" type="string">
          <useparam name="mon2" />
        </call>
        <call function="" as="year" type="number">
          <useparam name="year" />
        </call>
        <column table="a" column="name" as="mp" type="string" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_mp" />
            <useparam name="mp" />
          </call>
        </call>
      </where>
    </query>
    <query name="32443-rep-type-list" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <const as="id" type="string">'32443'</const>
      <const as="name" type="string">'Минэнерго'</const>
      <const>'32443-1'</const>
      <const>'Россети'</const>
    </query>
    <query name="32443-mp-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <const>-6</const>
        </call>
      </where>
    </query>
    <query name="32443-titul" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-dat" as="a">
          <usepart part="32443-withparams" />
          <grsets>
            <grset level="1,2,3" title="Сборный (узел)" as="sbor_node">
              <where>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_razdel7" />
                  </call>
                  <call function="!=">
                    <column table="a" column="kod_razdel" />
                    <const>248</const>
                  </call>
                </call>
              </where>
              <grset level="" title="Сборный (вывод)" as="sbor">
                <where>
                  <call function="and">
                    <call function="or">
                      <call function="false" />
                      <call function="and" optional="1">
                        <call function="=1">
                          <useparam name="pr_sbor" />
                        </call>
                        <!--<call function="!=">
                          <call function="nvlu">
                            <useparam name="pr_cognos" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>-->
                      </call>
                      <call function="=1" optional="1">
                        <useparam name="pr_cognos" />
                      </call>
                    </call>
                    <call function="is not null">
                      <column table="a" column="kod_titul_ip_sbor" />
                    </call>
                    <!--<call function="and" optional="1">
                      <call function="=1">
                        <useparam name="pr_cognos" />
                      </call>
                      <call function="=">
                        <column table="a" column="with_details_sbor" />
                        <const>1</const>
                      </call>
                    </call>-->
                  </call>
                </where>
              </grset>
              <grset level="4" title="Головной/Одиночный (узел)" as="main_node">
                <where>
                  <call function="and">
                    <call function="true" />
                    <call function="and" optional="1">
                      <call function="=1">
                        <useparam name="pr_cognos" />
                      </call>
                      <call function="or">
                        <call function="=">
                          <column table="a" column="with_details_sbor" />
                          <const>1</const>
                        </call>
                        <call function="is null">
                          <column table="a" column="kod_titul_ip_sbor" />
                        </call>
                      </call>
                    </call>
                  </call>
                </where>
                <grset level="" title="Головной/Одиночный (вывод)" as="main">
                  <where>
                    <call function="and">
                      <call function="true" />
                    </call>
                  </where>
                </grset>
                <grset level="5" title="Дочерний (вывод)" as="child">
                  <where>
                    <call function="and">
                      <call function="or">
                        <call function="false" />
                        <call function="and" optional="1">
                          <call function="=1">
                            <useparam name="pr_child" />
                          </call>
                          <!--<call function="!=">
                            <call function="nvlu">
                              <useparam name="pr_cognos" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>-->
                        </call>
                        <call function="=1" optional="1">
                          <useparam name="pr_cognos" />
                        </call>
                      </call>
                      <call function="is not null">
                        <column table="a" column="kod_child_titul" />
                      </call>
                      <call function="and" optional="1">
                        <call function="=1">
                          <useparam name="pr_cognos" />
                        </call>
                        <call function="=">
                          <column table="a" column="with_details_main" />
                          <const>1</const>
                        </call>
                      </call>
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32443-razdel" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="lvl" />
        <column table="a" column="rwn" />
        <column table="a" column="kod_parent_node" />
        <column table="a" column="kod_node" />
        <column table="a" column="kod_minenergo" />
        <column table="kod_minenergo" column="abbr" as="razdel_abbr" />
        <column table="kod_minenergo" column="full_name" />
        <column table="b" column="*" />
      </select>
      <from>
        <query name="ipv_razdel_mn_tree" as="a">
          <link name="kod_minenergo" />
        </query>
        <query name="32443-razdel-data" as="b" join="left outer">
          <usepart part="32443-withparams" />
          <using>
            <column column="kod_minenergo" />
          </using>
        </query>
      </from>
    </query>
    <query name="32443-razdel-rs" order="rwn" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="lvl" />
        <column table="a" column="rwn" />
        <column table="a" column="kod_parent_node" />
        <column table="a" column="kod_node" />
        <column table="a" column="kod_klass" />
        <column table="kod_klass" column="abbr_num" as="razdel_abbr" />
        <column table="kod_klass" column="full_name" />
        <column table="b" column="*" />
      </select>
      <from>
        <query name="ipv_razdel_rs_tree" as="a">
          <link name="kod_klass" />
        </query>
        <query name="32443-razdel-rs-data" as="b" join="left outer">
          <usepart part="32443-withparams" />
          <using>
            <column column="kod_klass" />
          </using>
        </query>
      </from>
    </query>
    <query name="32443-razdel-data" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-dat" as="a">
          <usepart part="32443-withparams" />
          <grsets>
            <grset level="1" title="Раздел" as="razdel"></grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32443-razdel-rs-data" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="32443-dat" as="a">
          <usepart part="32443-withparams" />
          <grsets>
            <grset level="2" title="Раздел" as="razdel_rs"></grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="32443-dat" title="Приложение 7.1 к отчету по исполнителю" grouplevel="no" use-repository="0" timestamp="25.10.2016 13:35:17" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <select>
        <column table="kod_minenergo" column="kod_minenergo" group="1" />
        <column table="kod_razdel" column="kod_razdel" group="kod_minenergo" />
        <column table="kod_razdel_rs" column="kod_klass" group="2" />
        <column table="kod_sbor_titul" column="kod_sbor_titul" group="3" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new" as="tit_num_new_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="name" as="name_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="with_details" as="with_details_sbor" group="kod_sbor_titul" title="Раскрывать детализацию" nvl="0" />
        <column table="kod_ipr" column="kod_main_titul" group="4" />
        <column table="kod_main_titul" column="tit_num_new" as="tit_num_new_main" group="kod_main_titul" title="{+} (головной/одиночный)" />
        <column table="kod_main_titul" column="name" as="name_main" group="kod_main_titul" title="{+} (головной/одиночный)" />
        <column table="kod_main_titul" column="with_details" as="with_details_main" group="kod_main_titul" title="Раскрывать детализацию" nvl="0" />
        <column table="kod_ipr" column="kod_child_titul" group="5" />
        <column table="kod_child_titul" column="tit_num_new" as="tit_num_new_child" group="kod_child_titul" title="{+} (дочерний)" />
        <column table="kod_child_titul" column="name" as="name_child" group="kod_child_titul" title="{+} (дочерний)" />
        <column table="kod_subject" column="abbr" group="kod_main_titul" />
        <column table="a" column="summ_k_rasp_tek" group="sum" />
        <column table="a" column="fp_sum_nds_fact_itog" as="fact_do" group="sum">
          <section>
            <call function="num to ym2">
              <call function="-">
                <useparam name="year" />
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
        </column>
        <call function="-nvl" as="summ_do" group="sum">
          <column table="this" column="summ_k_rasp_tek" />
          <column table="this" column="fact_do" />
        </call>
        <column table="a" column="fp_sum_nds" as="fp_sum_by_kv" group="sum" dimname="kv">
          <pivot title=" по кварталам">
            <call function="and">
              <call function="=">
                <column table="a" column="year" group="" />
                <useparam name="year" />
              </call>
              <call function="=">
                <call function="mes to kv">
                  <column table="a" column="period" group="" />
                </call>
                <column table="dim" column="id" />
              </call>
            </call>
            <query>
              <select>
                <column table="kv" column="*" />
              </select>
              <from>
                <query name="spr_time_kv" as="kv" />
              </from>
            </query>
          </pivot>
        </column>
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_fact_by_kv" group="sum" dimname="kv" />
        <column table="a" column="kap_sum_nds_fact" as="kap_sum_fact_all" group="sum">
          <if>
            <call function="between">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <const>1</const>
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <const>12</const>
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_kv" group="sum">
          <if>
            <call function="between">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon1" />
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>
          </if>
        </column>
        <!--<call function="-nvl" as="fp_otkl" group="sum" title="Отклонение фактической стоимости работ от плановой стоимости" dimname="smet">
          <column table="a" column="fp_sum_fact" mp="[:mp]" />
          <column table="a" column="fp_sum" mp="[:mp]" />
        </call>
        <column table="a" column="kap_sum" group="sum" dimname="smet" mp="[:mp]" />
        <column table="a" column="kap_sum_fact" group="sum" dimname="smet" mp="[:mp]" />
        <call function="-nvl" as="kap_otkl" group="sum" title="Отклонение фактического освоения от планового освоения" dimname="smet">
          <column table="a" column="kap_sum_fact" mp="[:mp]" />
          <column table="a" column="kap_sum" mp="[:mp]" />
        </call>
        <call function="nvl" title="Год ввода в эксплуатацию" group="max" as="year_vvod">
          <column table="kod_child_titul" column="end_year" />
          <column table="kod_main_titul" column="end_year" />
        </call>
        <column table="a" column="eksp_norm_podst" group="max" />
        <column table="a" column="phis_numtr_itog" if="itog" group="stragg_dist" as="name_tr">
          <section>
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </section>
        </column>
        <call function="to_char" group="stragg_dist" as="col_tr">
          <column table="a" column="phis_coltr_itog" if="itog" />
        </call>
        <column table="a" column="phis_mvatr_itog" as="phis_mvatr" if="itog" group="sum" mp="-6" />
        <column table="a" column="eksp_norm_lin" group="max" />
        <column table="a" column="phis_typel_itog" as="phis_typel" if="itog" group="stragg_dist" />
        <column table="a" column="phis_numl_itog" as="phis_numl" if="itog" group="stragg_dist" />
        <call function="+nvl" as="phis_km" group="sum">
          <column table="a" column="phis_km_vl_itog" if="itog" />
          <column table="a" column="phis_km_kl_itog" if="itog" />
        </call>
        <column table="a" column="phis_other_itog" as="phis_other" if="itog" group="sum" />-->
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr">
            <link name="kod_titul_ip" />
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
              </link>
            </link>
            <link name="kod_child_titul" />
            <link name="kod_minenergo" />
            <link name="kod_razdel_rs" />
            <link name="kod_razdel" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="kod_subject" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="in" optional="1">
            <column table="kod_subject" column="kod_subject" />
            <useparam name="kod_2subject" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_main_titul" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="a" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or">
            <call function="between">
              <column table="a" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon1" />
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>
            <call function="and">
              <call function="lt">
                <column table="a" column="ym" />
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon1" />
                </call>
              </call>
              <call function="is null">
                <column table="a" column="ym_nxt" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="ym" />
            </call>
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="=">
                <const>3</const>
                <useparam name="kod_dirisp" />
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="=">
                <const>2</const>
                <useparam name="kod_dirisp" />
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
        </call>
      </where>
    </query>
    <query name="38203_time_intervals" timestamp="14.09.2016 15:18:23" order="date_end, date_begin desc" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <param name="year" type="number">
          <const>2016</const>
        </param>
        <param name="mon2" type="number">
          <const>6</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod" />
        <call type="string" function="decode" as="name" title="Интервал">
          <column table="a" column="time_type" title="" />
          <const>'Год'</const>
          <const>'Итог с начала года'</const>
          <column table="a" column="name" />
        </call>
        <column table="a" column="kod_parent" />
        <column table="a" column="time_type" title="" />
        <column table="a" column="in_year_id" />
        <!--<column table="a" column="period_id"/>-->
        <column table="a" column="date_begin" />
        <call type="date" function="decode" as="date_end">
          <column table="a" column="time_type" title="" />
          <const>'Год'</const>
          <call function="ym2 end time">
            <call function="num to ym2">
              <useparam name="year" />
              <useparam name="mon2" />
            </call>
          </call>
          <column table="a" column="date_end" />
        </call>
      </select>
      <from>
        <query name="spr_time_intervals1" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <call function="year">
              <column table="a" column="date_begin" />
            </call>
            <useparam name="year" />
          </call>
          <call function="or">
            <call function="le">
              <call function="date to ym2">
                <column table="a" column="date_end" />
              </call>
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="mon2" />
              </call>
            </call>
            <call function="=">
              <column table="a" column="time_type" />
              <const>'Год'</const>
            </call>
          </call>
          <call function="or">
            <call function="in">
              <column table="a" column="time_type" />
              <array>'Год','Месяц','Полугодие','9 месяцев','Квартал'</array>
            </call>
            <call function="in" exclude="1">
              <column table="a" column="name" />
              <array>'I квартал'</array>
            </call>
          </call>
          <call function="!=" exclude="1">
            <column table="a" column="time_type" />
            <const>'Год'</const>
          </call>
        </call>
      </where>
    </query>
    <query name="38203-detail" timestamp="03.05.2018 04:28:28" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <usepart part="38203-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="38203" as="a">
          <withparams>
            <usepart part="38203-withparams" />
          </withparams>
          <grsets>
            <grset level="" title="Всего" as="itog" />
            <grset level="2" title="По СПб и ЛО" as="itog_spb_lo" />
            <grset level="1" title="По филиалам" as="ispoln">
              <grset level="2" title="По субъекту" as="spb">
                <grset level="3" title="По признаку АИП" as="spb_aip">
                  <grset level="5" as="sbor" title="Сборный титул" order="tit_num_new_sbor">
                    <grset level="" as="sborinfo" title="Сборный титул(информация)">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_titul_ip_sbor" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_sbor" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                    <grset level="6" as="main" title="Головной/ одиночный титул" order="tit_num_new_main">
                      <where>
                        <call function="and">
                          <call function="=0">
                            <column table="a" column="is_sbor_main" />
                          </call>
                        </call>
                      </where>
                      <grset level="" as="head" title="Головной титул">
                        <where>
                          <call function="and">
                            <call function="=">
                              <column table="a" column="is_head_tit" />
                              <const>1</const>
                            </call>
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_sbor" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                          </call>
                        </where>
                      </grset>
                      <grset level="" as="single" title="Одиночный титул">
                        <where>
                          <call function="!=nvl">
                            <column table="a" column="is_head_tit" />
                            <const>1</const>
                          </call>
                        </where>
                      </grset>
                      <grset level="7" as="child" title="Дочерний титул" order="tit_num_new">
                        <where>
                          <call function="and">
                            <call function="is not null">
                              <column table="a" column="kod_child_titul" />
                            </call>
                          </call>
                        </where>
                      </grset>
                    </grset>
                  </grset>
                  <grset level="4" title="По титулам" as="tit" exclude="1">
                    <where>
                      <call function="or">
                        <call function="false" />
                        <call function="and" optional="1">
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_ip" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip" />
                            <const>0</const>
                          </call>
                        </call>
                        <call function="and" optional="1">
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="pr_aip_detail" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                          <call function="=">
                            <column table="a" column="kod_aip" />
                            <const>1</const>
                          </call>
                        </call>
                        <!--<call function="=">
                          <call function="nvlu">
                            <useparam name="pr_ip" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>
                        <call function="or">
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>0</const>
                            </call>
                            <call function="=">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                            <call function="ge">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                        </call>-->
                      </call>
                    </where>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="is null">
            <column table="a" column="kod_titul_ip_sbor" />
            <column table="a" column="kod_main_titul" />
            <column table="a" column="kod_child_titul" />
          </call>
          <call function="and" optional="1">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_ip" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kod_aip_min" />
              <const>0</const>
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_aip_detail" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kod_aip_max" />
              <const>1</const>
            </call>
          </call>
          <!--<call function="=">
                          <call function="nvlu">
                            <useparam name="pr_ip" />
                            <const>0</const>
                          </call>
                          <const>1</const>
                        </call>
                        <call function="or">
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>0</const>
                            </call>
                            <call function="=">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                          <call function="and">
                            <call function="=">
                              <call function="nvlu">
                                <useparam name="pr_aip_detail" />
                                <const>0</const>
                              </call>
                              <const>1</const>
                            </call>
                            <call function="ge">
                              <column table="a" column="kod_aip"/>
                              <const>0</const>
                            </call>
                          </call>
                        </call>-->
        </call>
      </where>
    </query>
    <query name="38203" grouplevel="no" timestamp="08.01.2018 19:14:07" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <usepart part="38203-params" />
      </params>
      <select>
        <column table="kod_main_titul" column="kod_sbor_titul" group="5" exclude="1" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_sbor_titul" group="5" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title="Номер сборного" />
        <column table="kod_titul_ip_sbor" column="full_name" as="+_sbor" group="kod_sbor_titul" title="Наименование сборного титула" />
        <column table="kod_ipr" column="kod_main_titul" group="6" />
        <column table="kod_main_titul" column="tit_num_new_n" as="tit_num_new_main" group="kod_main_titul" title="Номер головного/одиночного титула" />
        <column table="kod_main_titul" column="full_name" as="full_name_main" group="kod_main_titul" title="Наименование головного/одиночного титула" />
        <column table="kod_main_titul" column="is_head_tit" group="kod_main_titul" />
        <column table="kod_main_titul" column="is_sbor" as="is_sbor_main" group="kod_main_titul" />
        <column table="kod_titul_ip" column="is_head_tit" as="is_head_tit1" />
        <column table="kod_ipr" column="kod_child_titul" group="7" />
        <column table="kod_titul_ip" column="is_sbor" group="kod_child_titul" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_child_titul" title="Номер дочернего титула" as="tit_num_new" />
        <column table="kod_titul_ip" column="full_name" group="kod_child_titul" title="Наименование дочернего титула" />
        <column table="kod_titul_ip" column="kod_ispolnit" group="1" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" group="kod_ispolnit" />
        <column table="kod_subject" column="kod_subject" group="2" />
        <column table="kod_subject" column="name" as="subject_name" group="kod_subject" />
        <column table="kod_titul_ip" column="kod_aip" group="3" />
        <!--<column table="kod_titul_ip" column="name_aip" group="kod_aip" />-->
        <call function="decode" as="name_aip" group="kod_aip" type="string">
          <column table="kod_titul_ip" column="kod_aip" />
          <const>0</const>
          <call function="||">
            <column table="kod_titul_ip" column="name_aip" />
            <column table="kod_ispolnit" column="name" />
          </call>
          <column table="kod_titul_ip" column="name_aip" />
        </call>
        <column table="kod_titul_ip" column="kod_titul_ip" group="4" exclude="1" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_titul_ip" as="tit_num_new" exclude="1" />
        <column table="kod_titul_ip" column="name" group="kod_titul_ip" exclude="1" />
        <column table="kod_titul_ip" column="kod_aip" group="max" as="kod_aip_max" title="1 - есть аип" />
        <column table="kod_titul_ip" column="kod_aip" group="max" as="kod_aip_min" title="0 - есть капстрой" />
        <column table="a" column="period" group="max" />
        <call function="()" type="number" as="dummy1" dimname="per" group="sum">
          <pivot title=" по периодам">
            <call function="between">
              <column table="a" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="38203_time_intervals" as="a">
                  <withparams>
                    <useparam name="year" />
                    <call function="greatest">
                      <useparam name="mon2" />
                      <useparam name="mon2w" />
                    </call>
                  </withparams>
                </query>
              </from>
              <where>
                <call function="or">
                  <call function="in">
                    <column table="a" column="kod" />
                    <useparam name="period" />
                  </call>
                  <call function="in">
                    <column table="a" column="kod" />
                    <useparam name="periodw" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
          <const>0</const>
        </call>
        <!--Освоение-->
        <column table="a" column="kap_sum" as="kap_sum_god" group="sum" mp="[:mp]" colset="освоение" />
        <column table="a" column="kap_sum" as="kap_sum" group="sum" dimname="per1" mp="[:mp]" colset="освоение">
          <pivot title=" по периодам">
            <call function="between">
              <column table="a" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="38203_time_intervals" as="a">
                  <withparams>
                    <useparam name="year" />
                    <useparam name="mon2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="in">
                  <column table="a" column="kod" />
                  <useparam name="period" />
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="kap_sum_fact_a" group="sum" mp="[:mp]" as="kap_sum_fact" dimname="per1" colset="освоение" exclude="1" />
        <column table="a" column="kap_sum_fact_d" group="sum" mp="[:mp]" as="kap_sum_fact" dimname="pern1" colset="освоение">
          <pivot title=" по периодам">
            <call function="between">
              <column table="a" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="38203_time_intervals" as="a">
                  <withparams>
                    <useparam name="year" />
                    <useparam name="mon2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="and">
                  <call function="in">
                    <column table="a" column="kod" />
                    <useparam name="period" />
                  </call>
                  <call function="lt">
                    <column table="a" column="date_end" />
                    <const>DATE'2017-10-01'</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="kap_sum_fact_n" group="sum" mp="[:mp]" as="kap_sum_fact_n" dimname="pern2" colset="освоение">
          <pivot title=" по периодам">
            <call function="between">
              <column table="a" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="38203_time_intervals" as="a">
                  <withparams>
                    <useparam name="year" />
                    <useparam name="mon2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="and">
                  <call function="in">
                    <column table="a" column="kod" />
                    <useparam name="period" />
                  </call>
                  <call function="ge">
                    <column table="a" column="date_end" />
                    <const>DATE'2017-10-01'</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="kap_sum_wait" group="sum" mp="[:mp]" dimname="per2" colset="освоение">
          <pivot title=" по периодам">
            <call function="between">
              <column table="a" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="in_year_id" />
                <column table="a" column="name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="38203_time_intervals_w" as="a">
                  <withparams>
                    <useparam name="year" />
                    <useparam name="mon2w" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="in">
                  <column table="a" column="kod" />
                  <useparam name="periodw" />
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <!--Финансирование-->
        <column table="a" column="fp_sum_nds" as="fp_sum_god" group="sum" mp="[:mp]" colset="финансирование" />
        <column table="a" column="fp_sum_nds" group="sum" mp="[:mp]" as="fp_sum" dimname="per1" colset="финансирование" />
        <column table="a" column="fp_sum_nds_fact_a" group="sum" mp="[:mp]" as="fp_sum_fact" dimname="per1" colset="финансирование" exclude="1" />
        <column table="a" column="fp_sum_nds_fact_b" group="sum" mp="[:mp]" as="fp_sum_fact" dimname="per1" colset="финансирование" />
        <column table="a" column="fp_sum_nds_wait" group="sum" mp="[:mp]" as="fp_sum_wait" dimname="per2" colset="финансирование" />
        <!--Ввод-->
        <column table="a" column="vvod_sum" as="vvod_sum_god" group="sum" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum" group="sum" dimname="per1" mp="[:mp]" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_fact" group="sum" mp="[:mp]" dimname="per1" colset="ввод в ОФ" />
        <column table="a" column="vvod_sum_wait" group="sum" mp="[:mp]" dimname="per2" colset="ввод в ОФ" />
        <!--МВА-->
        <column table="a" column="pow_mba" as="pow_mba_god" group="sum" colset="МВА" />
        <column table="a" column="pow_mba" group="sum" dimname="per1" colset="МВА" />
        <column table="a" column="pow_mba_fact_date" as="pow_mba_fact" group="sum" dimname="per1" colset="МВА" />
        <column table="a" column="pow_mba_wait" group="sum" dimname="per2" colset="МВА" />
        <!--КМ-->
        <column table="a" column="pow_km_all" as="pow_km_god" group="sum" colset="км" />
        <column table="a" column="pow_km_all" as="pow_km" group="sum" dimname="per1" colset="км" />
        <column table="a" column="pow_km_all_fact_date" as="pow_km_fact" group="sum" dimname="per1" colset="км" />
        <column table="a" column="pow_km_all_wait" as="pow_km_wait" group="sum" dimname="per2" colset="км" />
        <column table="a" column="ipr_fin_ipr" group="sum" />
        <call function="case" as="pr_check_plan_fact" title="Группа" type="number">
          <call function="when">
            <call function="is not null">
              <column table="check_pl_ft" column="pr_plan" />
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="is null">
                <column table="check_pl_ft" column="pr_plan" />
              </call>
              <call function="is not null">
                <column table="check_pl_ft" column="pr_fact" />
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="is null">
                <column table="check_pl_ft" column="pr_plan" />
              </call>
              <call function="is null">
                <column table="check_pl_ft" column="pr_fact" />
              </call>
            </call>
            <const>3</const>
          </call>
        </call>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor" />
              </link>
            </link>
          </link>
          <link name="check_pl_ft" />
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="=" selective="1">
                <useparam name="year" />
                <column table="*" column="year" />
              </call>
              <call function="le" selective="1" exclude="1">
                <call function="date to ym2">
                  <column table="*" column="dat" />
                </call>
                <call function="num to ym2">
                  <useparam name="year" />
                  <useparam name="mon2" />
                </call>
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or">
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_aip" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <call function="=">
              <call function="nvl0">
                <column table="kod_titul_ip" column="kod_aip" />
              </call>
              <const>0</const>
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="pr_no_zero" />
            </call>
            <call function="!=">
              <column table="this" column="pr_check_plan_fact" />
              <const>3</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="38203-title" timestamp="14.09.2016 14:29:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <usepart part="38203-params" />
      </params>
      <select>
        <call function="()" as="nyear" type="number">
          <useparam name="year" />
        </call>
        <call function="mes-name-rp" as="ddate" type="string">
          <useparam name="mon2" />
        </call>
        <call function="mes-name-rp" as="ddatew" type="string">
          <useparam name="mon2w" />
        </call>
        <call function="mes to kv" as="num_kv" type="number">
          <useparam name="mon2" />
        </call>
        <call function="/" as="nvalue">
          <useparam name="nvalue" />
          <const>100</const>
        </call>
        <column table="a" column="name" as="name_mp" />
        <call function="add_month" as="month_next" type="date">
          <call function="sysdate" />
        </call>
        <call function="()" as="month" type="date">
          <call function="sysdate" />
        </call>
        <const as="kap_exists" type="number" colset="освоение" comment="чтобы удалять колонки без переменных">1</const>
        <const as="fp_exists" type="number" colset="финансирование" comment="чтобы удалять колонки без переменных">1</const>
        <const as="vvod_exists" type="number" colset="ввод в ОФ" comment="чтобы удалять колонки без переменных">1</const>
        <const as="pow_exists" type="number" colset="МВА" comment="чтобы удалять колонки без переменных">1</const>
        <const as="pow_km_exists" type="number" colset="км" comment="чтобы удалять колонки без переменных">1</const>
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <useparam name="mp" />
        </call>
      </where>
    </query>
    <query name="38203_mon_def" timestamp="13.09.2016 15:18:49" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <select>
        <call function="month" as="mon">
          <call function="sysdate" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="38203_time_intervals_w" timestamp="14.09.2016 14:06:50" order="date_end, date_begin desc" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <param name="year" type="number" />
        <param name="mon2w" type="number" />
      </params>
      <select>
        <column table="a" column="*" />
        <!--<column table="a" column="period_id"/>-->
      </select>
      <from>
        <query name="38203_time_intervals" as="a">
          <withparams>
            <useparam name="year" />
            <useparam name="mon2w" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="38897" timestamp="21.11.2016 14:20:52" is-report="1" visible="0" folder="invpro" title="Выгрузка по заявке 38897" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\38897.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="38897.xlsx" title="Выгрузка по заявке 38897" print-proc="2" print-xlsx="1" />
          <template name="38897.xml" title="Выгрузка по заявке 38897-1" print-proc="2" exclude="1" />
        </excel>
      </print-templates>
      <select>
        <column table="ipr_kod_titul_ip" column="tit_num_new" />
        <column table="ipr_kod_titul_ip" column="name" />
        <column table="pr_ofz" column="kod" as="kod_ofz" />
        <column table="pr_ofz" column="name" as="name_ofz" />
        <fact column="ipr_last_tit_doc" as="kod_doc29" group="max">
          <withparams>
            <const>29</const>
          </withparams>
        </fact>
        <column table="ipr_doc29" column="doc_num" as="doc_num29" title="Номер приказа" group="max" />
        <column table="ipr_doc29" column="doc_date_c" as="doc_date_c29" title="Дата приказа" group="max" />
        <fact column="ipr_smet_summ_nds_utvpsd_tek" as="sum_nds_smet" group="sum" exclude="1" />
        <fact column="ipr_smet_summ_utvpsd_tek" as="sum_smet" group="sum" title="Сумма ПСД без НДС" />
        <column table="ipr_kod_vip_dog" column="kod_vip_dog" />
        <column table="kod_dog" column="name_unig_dog" />
        <column table="ipr_kod_vip_dog" column="num_doc" />
        <column table="ipr_kod_vip_dog" column="dat_doc" />
        <column table="ipr_kod_vip_dog" column="pr_ofz" nullif="0" />
        <fact table="akt" column="ipr_kap_fact_sum" nullif="0" group="sum" />
        <fact table="akt" column="ipr_fin_fact_sum_nds" nullif="0" group="sum" />
        <fact table="akt" column="ipr_fin_fact_sum" nullif="0" group="sum" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_titul_ip" all-rows="1">
            <link name="pr_ofz" />
          </link>
          <where>
            <call function="!=0">
              <column table="pr_ofz" column="kod" />
            </call>
          </where>
          <dimset as="akt">
            <link name="ipr_kod_vip_dog">
              <link name="kod_dog" />
            </link>
            <where>
              <call function="=">
                <column table="ipr_kod_vip_dog" column="kod_smet" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
        <query name="ipr_doc" join="left outer" as="ipr_doc29">
          <call function="=">
            <column table="this" column="kod_doc29" />
            <column table="ipr_doc29" column="kod_doc" />
          </call>
        </query>
      </from>
      <grouping>
        <grset as="tit" title="Титул" order="kod_ofz,tit_num_new">
          <group>
            <sourcelink table="ipr_kod_titul_ip" />
          </group>
          <grset as="smet" title="Смета">
            <where>
              <call function="true" />
            </where>
          </grset>
          <grset as="akt" title="Акт" order="name_unig_dog,dat_doc">
            <group>
              <sourcelink table="ipr_kod_vip_dog" />
            </group>
            <where>
              <call function="is not null">
                <column table="this" column="kod_vip_dog" />
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="41656" timestamp="19.12.2018 16:20:44" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <expressions>
        <usepart part="41656-cmn-expressions" />
        <call function="gt" as="titul_started">
          <call function="+nvl">
            <column table="ipr_vvod_fiz" column="km_vl_1c" />
            <column table="ipr_vvod_fiz" column="km_vl_2c" />
            <column table="ipr_vvod_fiz" column="km_kl" />
            <column table="ipr_vvod_fiz" column="mba" />
            <column table="ipr_vvod_fiz" column="cnt" />
            <column table="ipr_vvod_fiz" column="cnt_proch" />
            <column table="ipr_kod_hoz_sposob" column="val" />
          </call>
          <const>0</const>
        </call>
        <call function="or" as="titul_completed">
          <call function="=">
            <column table="kod_ipr" column="kod_status" />
            <const>4</const>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>189</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
        </call>
        <call function="or" as="titul_pir">
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>168</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_vip_dog" column="kodzatrat" />
              <const>80</const>
            </call>
            <call function="gt">
              <column column="vsego" table="ipr_kod_vip_dog" nvl="0" />
              <const>0</const>
            </call>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_doc" column="kod_doc_type" />
              <const>590</const>
            </call>
          </call>
        </call>
        <call function="or" as="titul_vvod">
          <call function="gt">
            <call function="+nvl">
              <column table="ipr_vvod_fiz" column="km_vl_1c" />
              <column table="ipr_vvod_fiz" column="km_vl_2c" />
              <column table="ipr_vvod_fiz" column="km_kl" />
              <column table="ipr_vvod_fiz" column="mba" />
              <column table="ipr_vvod_fiz" column="cnt" />
              <column table="ipr_vvod_fiz" column="cnt_proch" />
            </call>
            <const>0</const>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>207</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
        </call>
        <call function="()" as="obj_count_plan_started" type="number" group="sum" comment="титулы у которых заполнен факт по вводу в ОФ либо имеются данные в форме характеристик по хоз способу">
          <fact column="ipr_titul_ip_count" title="План за год. Кол-во объектов" nvl="0" condition="titul_started" />
        </call>
        <call function="()" as="obj_count_plan_completed" type="number" group="sum" comment="статус титула “Выполнен” либо заполнена дата фактического окончания по контрольному этапу 3.7">
          <fact column="ipr_titul_ip_count" title="План за год. Кол-во объектов" nvl="0" condition="titul_completed" />
        </call>
        <call function="()" as="obj_count_plan_pir" group="sum" comment="заполнена дата фактического окончания по контрольному этапу 1.10 либо имеется вид затрат 9.1 либо к титулу приложен документ с типом “ Акт выполненных работ (ПИР) по хоз способу”">
          <fact column="ipr_titul_ip_count" condition="titul_pir" />
        </call>
        <call function="()" as="obj_count_plan_vvod" group="sum" comment="заполнена дата фактического окончания по контрольному этапу 1.10 либо имеется вид затрат 9.1 либо к титулу приложен документ с типом “ Акт выполненных работ (ПИР) по хоз способу”">
          <fact column="ipr_titul_ip_count" condition="titul_vvod" />
        </call>
      </expressions>
      <select>
        <usepart part="41656-cmn-columns" />
        <call function="case" as="km_vl_1c_pp" type="number" title="План за год. ВЛ 1-цепные км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_1c" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_1c_wfact" nvl="0" table="vvod" />
          </call>
        </call>
        <call function="case" as="km_vl_2c_pp" type="number" title="План за год. ВЛ 2-цепные км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_2c" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_2c_wfact" nvl="0" table="vvod" />
          </call>
        </call>
        <call function="case" as="km_kl_pp" type="number" title="План за год. КЛ км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_kl" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_kl_wfact" nvl="0" table="vvod" />
          </call>
        </call>
        <call function="case" as="km_mba_pp" type="number" title="План за год. МВА" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_mba" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_mba_wfact" nvl="0" table="vvod" />
          </call>
        </call>
        <call function="case" as="km_cnt_pp" type="number" title="План за год. шт. (ПС, ТП)" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_wfact" nvl="0" table="vvod" />
          </call>
        </call>
        <call function="case" as="km_cnt_pr_pp" type="number" title="План за год. шт. (прочие)" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_proch" nvl="0" table="vvod" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_wfact_pr" nvl="0" table="vvod" />
          </call>
        </call>
        <fact column="ipr_titul_ip_count" group="sum" title="Факт за год. Кол-во объектов" as="obj_count_fact" table="hoz" nvl="0" />
        <fact column="isv_ad_evd_count" as="ad_count_fact" group="sum" title="Факт за год. Кол-во Заявителей" nvl="0" table="hoz" />
        <fact column="km_vl_1c_fact" group="sum" nvl="0" title="Факт за год, ВЛ 1-цепные км" table="hoz" />
        <fact column="km_vl_2c_fact" group="sum" nvl="0" title="Факт за год, ВЛ 2-цепные км" table="hoz" />
        <fact column="km_kl_fact" group="sum" nvl="0" title="Факт за год, КЛ км" table="hoz" />
        <fact column="km_mba_fact" group="sum" nvl="0" title="Факт за год, МВА" table="hoz" />
        <fact column="km_cnt_fact" group="sum" nvl="0" title="Факт за год, шт. (ПС, ТП)" table="hoz" />
        <fact column="km_cnt_pr_fact" group="sum" nvl="0" title="Факт за год, шт. (прочие)" table="hoz" />
        <fact column="ipr_titul_ip_count" group="sum" title="Факт за месяц на прошл неделю. Кол-во объектов" as="obj_count_fact_mes_prev" table="hoz_mes_prev" nvl="0" />
        <fact column="isv_ad_evd_count" as="ad_count_fact_mes_prev" group="sum" title="Факт за месяц на прошл неделю. Кол-во Заявителей" nvl="0" table="hoz_mes_prev" />
        <fact column="km_vl_1c_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, ВЛ 1-цепные км" table="hoz_mes_prev" as="km_vl_1c_fact_mes_prev" />
        <fact column="km_vl_2c_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, ВЛ 2-цепные км" table="hoz_mes_prev" as="km_vl_2c_fact_mes_prev" />
        <fact column="km_kl_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, КЛ км" table="hoz_mes_prev" as="km_kl_fact_mes_prev" />
        <fact column="km_mba_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, МВА" table="hoz_mes_prev" as="km_mba_fact_mes_prev" />
        <fact column="km_cnt_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, шт. (ПС, ТП)" table="hoz_mes_prev" as="km_cnt_fact_mes_prev" />
        <fact column="km_cnt_pr_fact" group="sum" nvl="0" title="Факт за месяц на прошл неделю, шт. (прочие)" table="hoz_mes_prev" as="km_cnt_pr_fact_mes_prev" />
        <fact column="obj_count_plan_started" group="sum" nvl="0" title="Кол-во объектов. Начато" table="titul" />
        <fact column="obj_count_plan_completed" group="sum" nvl="0" title="Кол-во объектов. Завершено" table="titul" />
        <fact column="obj_count_plan_pir" group="sum" nvl="0" title="Кол-во объектов. ПИР" table="titul" />
        <fact column="obj_count_plan_vvod" group="sum" nvl="0" title="Кол-во объектов. Введено" table="titul" />
        <fact column="ipr_kap_fact_sum" group="sum" nvl="0" title="Освоение, руб" table="titul_sum" as="obj_kap_sum" />
        <fact column="ipr_vvd_fact_sum" group="sum" nvl="0" title="Ввод, руб" table="titul_sum" as="obj_vvod_sum" />
        <fact column="ipr_titul_ip_count" group="sum" title="Факт за следующий месяц. Кол-во объектов" as="obj_count_plan_mes_next" table="titul_mes_next" nvl="0" />
        <fact column="isv_ad_evd_count" as="ad_count_plan_mes_next" group="sum" title="Факт за следующий месяц. Кол-во Заявителей" nvl="0" table="titul_mes_next" />
        <call function="case" as="km_vl_1c_pp_mes_next" type="number" title="План за следующий месяц. ВЛ 1-цепные км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_1c" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_1c_wfact" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="case" as="km_vl_2c_pp_mes_next" type="number" title="План за следующий месяц. ВЛ 2-цепные км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_2c" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_vl_2c_wfact" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="case" as="km_kl_pp_mes_next" type="number" title="План за следующий месяц. КЛ км" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_km_kl" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_km_kl_wfact" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="case" as="km_mba_pp_mes_next" type="number" title="План за следующий месяц. МВА" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_mba" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_mba_wfact" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="case" as="km_cnt_pp_mes_next" type="number" title="План за следующий месяц. шт. (ПС, ТП)" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_wfact" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="case" as="km_cnt_pr_pp_mes_next" type="number" title="План за следующий месяц. шт. (прочие)" group="sum">
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>1</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_proch" nvl="0" table="vvod_mes_next" />
          </call>
          <call function="when">
            <call function="=">
              <useparam name="plan_type" />
              <const>2</const>
            </call>
            <fact column="ipr_vvod_fiz_cnt_wfact_pr" nvl="0" table="vvod_mes_next" />
          </call>
        </call>
        <call function="-nvl" title="Остаток заявителей на отчетный год" group="sum" as="isv_ad_evd_count_ost">
          <fact column="isv_ad_evd_count" title="План за год. Кол-во Заявителей" nvl="0" table="main" />
          <fact column="isv_ad_evd_count" title="План за месяц. Кол-во Заявителей" table="titul_mes" nvl="0" />
          <fact column="isv_ad_evd_count" title="План за месяц. Кол-во Заявителей" table="hoz_mes_prev2" nvl="0" />
        </call>
      </select>
      <from>
        <qube single-way="1">
          <usepart part="41656-cmn-links" />
          <dimset as="vvod">
            <link name="ipr_ym" />
            <link name="ipr_kod_titul_ip" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="ipr_kod_titul_ip" column="pr_41656" />
                  <const>1</const>
                </call>
                <call function="=">
                  <call function="ym2 god">
                    <column table="ipr_ym" column="val" />
                  </call>
                  <useparam name="year">2017</useparam>
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="titul_sum">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_ym" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="=">
                  <call function="ym2 god">
                    <column table="ipr_ym" column="val" />
                  </call>
                  <useparam name="year" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="hoz">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="ipr_kod_hoz_sposob" column="year" />
                  <useparam name="year" />
                </call>
                <call function="le">
                  <column table="ipr_kod_hoz_sposob" column="week" />
                  <useparam name="week" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="hoz_mes_prev">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="ipr_kod_hoz_sposob" column="year" />
                  <useparam name="year" />
                </call>
                <call function="=">
                  <column table="ipr_kod_hoz_sposob" column="month" />
                  <useparam name="month" />
                </call>
                <call function="le">
                  <column table="ipr_kod_hoz_sposob" column="week" />
                  <useparam name="prev_week" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_prev_week" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="titul_mes_next">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_vvod_fiz" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="ipr_vvod_fiz" column="ym" />
                  <call function="num to ym2">
                    <useparam name="year_month_next">2017</useparam>
                    <useparam name="month_next">2017</useparam>
                  </call>
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="vvod_mes_next">
            <link name="ipr_ym" only-for-cond="1" />
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="ipr_ym" column="val" />
                  <call function="num to ym2">
                    <useparam name="year_month_next">2017</useparam>
                    <useparam name="month_next">2017</useparam>
                  </call>
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="hoz_mes_prev2">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
            <where>
              <call function="and">
                <usepart part="41656-cmn-where-tituls" />
                <call function="=">
                  <column table="ipr_kod_hoz_sposob" column="year" />
                  <useparam name="year" />
                </call>
                <call function="le">
                  <column table="ipr_kod_hoz_sposob" column="month" />
                  <call function="-nvl">
                    <useparam name="month" />
                    <const>1</const>
                  </call>
                </call>
                <call function="=" comment="пока так, по идее надо брать слайс на конец месяца">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </dimset>
          <where>
            <call function="and">
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_all" />
              </call>
              <usepart part="41656-cmn-where" />
              <call function="in">
                <column table="evd_kod_filial_tit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <usepart part="41656-cmn-grouping" />
      </grouping>
    </query>
    <query name="41656-2" timestamp="18.12.2018 14:47:33" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <expressions>
        <usepart part="41656-cmn-expressions" />
      </expressions>
      <select>
        <usepart part="41656-cmn-columns" />
      </select>
      <from>
        <qube single-way="1">
          <usepart part="41656-cmn-links" />
          <where>
            <call function="and">
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <usepart part="41656-cmn-where" />
              <call function="in">
                <column table="evd_kod_filial_tit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <usepart part="41656-cmn-grouping" />
      </grouping>
    </query>
    <query name="41656-title" timestamp="29.09.2017 13:10:52" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <select>
        <call function="()" as="date_cur" type="date">
          <useparam name="dat" />
        </call>
        <call function="()" as="sdate_cur" title="Дата отчёта" type="string">
          <call function="date to char">
            <useparam name="dat" />
          </call>
        </call>
        <call function="()" as="sweek" title="Отчётная неделя" type="string">
          <call function="to_char">
            <useparam name="week" />
          </call>
        </call>
        <call function="()" as="smonth_name" title="Отчётный месяц (ИП)" type="string">
          <call function="lower">
            <call function="mes-name">
              <useparam name="month" />
            </call>
          </call>
        </call>
        <call function="()" as="smonth_name_rp" title="Отчётный месяц (РП)" type="string">
          <call function="lower">
            <call function="mes-name-rp">
              <useparam name="month" />
            </call>
          </call>
        </call>
        <call function="()" as="syear" title="Отчётный год" type="string">
          <call function="to_char">
            <useparam name="year" />
          </call>
        </call>
        <call function="()" as="smonth_n1_name" title="Следующий месяц (ИП)" type="string">
          <call function="lower">
            <call function="mes-name">
              <useparam name="month_next" />
            </call>
          </call>
        </call>
        <call function="()" as="syear_n1" title="Отчётный год след месяца" type="string">
          <call function="to_char">
            <useparam name="year_month_next" />
          </call>
        </call>
        <call function="date to char" title="Понедельник пред недели" as="sdate_prev">
          <call function="trunc">
            <call function="date add days">
              <useparam name="dat" />
              <const>-7</const>
            </call>
            <const>'IW'</const>
          </call>
        </call>
        <call function="to_char" as="sdatetime" title="Дата и время формирования">
          <call function="sysdate" />
          <const>'dd.mm.yyyy hh24:mi:ss'</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="41656-plan-type" timestamp="08.08.2017 13:22:19" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <select>
        <column table="a" column="kod" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="41656-plan-type-view" as="a" view="1" />
      </from>
    </query>
    <query name="41656-week" timestamp="14.08.2017 18:02:21" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
      </params>
      <select>
        <column table="a" column="week" as="val" />
      </select>
      <from>
        <query name="spr_time_iso_weeks" as="a" />
      </from>
      <where>
        <call function="=">
          <call function="trunc">
            <column table="a" column="dat" />
          </call>
          <call function="trunc">
            <useparam name="dat" />
          </call>
        </call>
      </where>
    </query>
    <query name="41656-slice" timestamp="09.08.2017 15:02:16" order="dat_copy_time desc" comment="слайс на конец отчетной недели" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" />
        <column table="a" column="dat_copy_time" />
        <column table="a" column="pr_srez" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="le">
            <column table="a" column="dat_copy" />
            <call function="date add days">
              <call function="trunc">
                <useparam name="dat" />
                <const>'IW'</const>
              </call>
              <const>7</const>
            </call>
          </call>
          <!--<call function="=">
            <call function="rownum"/>
            <const>1</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="41656-slice-all" timestamp="28.09.2017 22:02:25" order="dat_copy_time desc" comment="слайс на конец отчетной недели" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="id_slice_prev_week" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" />
        <column table="a" column="dat_copy_time" />
        <column table="a" column="pr_srez" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_prev_week" />
          </call>
          <!--<call function="=">
            <call function="rownum"/>
            <const>1</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="41656-month" timestamp="15.08.2017 11:12:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
      </params>
      <select>
        <column table="a" column="month" as="val" />
      </select>
      <from>
        <query name="spr_time_iso_weeks" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="dat" />
          <useparam name="dat" />
        </call>
      </where>
    </query>
    <query name="41656-year" timestamp="15.08.2017 11:12:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
      </params>
      <select>
        <column table="a" column="year" as="val" />
      </select>
      <from>
        <query name="spr_time_iso_weeks" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="dat" />
          <useparam name="dat" />
        </call>
      </where>
    </query>
    <query name="41656-har-cols" timestamp="08.08.2017 15:50:46" order="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <select>
        <column table="a" column="description" as="title" />
        <call function="to_char" as="name">
          <column table="a" column="kod_character" />
        </call>
      </select>
      <from>
        <query name="ipr_character" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="har_me" />
          <const>1</const>
        </call>
      </where>
    </query>
    <query name="41656-prev-week" timestamp="14.08.2017 18:03:30" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
        <param name="month" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <column table="a" column="month" />
            <useparam name="month" />
          </call>
          <column table="a" column="week" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="spr_time_iso_weeks" as="a" />
      </from>
      <where>
        <call function="=">
          <call function="trunc">
            <column table="a" column="dat" />
          </call>
          <call function="trunc">
            <call function="date add days">
              <useparam name="dat" />
              <const>-7</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="41656-slice-prev-week" timestamp="14.08.2017 17:42:56" order="dat_copy_time desc" comment="слайс на конец прошлой недели" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="dat" type="date" />
        <param name="prev_week" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <useparam name="prev_week" />
            <const>0</const>
          </call>
          <const>0</const>
          <column table="a" column="id_slice" />
        </call>
        <column table="a" column="dat_copy_time" />
        <column table="a" column="pr_srez" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="le">
            <column table="a" column="dat_copy" />
            <call function="trunc">
              <useparam name="dat" />
              <const>'IW'</const>
            </call>
          </call>
          <!--<call function="=">
            <call function="rownum"/>
            <const>1</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="41656-test" timestamp="10.11.2017 18:15:50" visible="0" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="id_slice_all">
          <call function="array">
            <const>408</const>
            <const>412</const>
          </call>
        </param>
        <param name="dat">
          <const>to_date('10.11.2017','DD.MM.YYYY')</const>
        </param>
        <param name="plan_type">
          <const>1</const>
        </param>
        <param name="week">
          <const>45</const>
        </param>
        <param name="month">
          <const>11</const>
        </param>
        <param name="year">
          <const>2017</const>
        </param>
        <param name="id_slice">
          <const>412</const>
        </param>
        <param name="prev_week">
          <const>44</const>
        </param>
        <param name="id_slice_prev_week">
          <const>408</const>
        </param>
        <param name="month_next">
          <const>12</const>
        </param>
        <param name="year_month_next">
          <const>2017</const>
        </param>
        <param name="kod_titul_ip">
          <const>42497</const>
        </param>
        <param name="kod_direct" />
      </params>
      <expressions>
        <call function="is null" as="cond_tituls_absent" dontpushpred="1">
          <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        </call>
        <call function="=" as="hoz_vl_1c" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>621</const>
        </call>
        <call function="=" as="hoz_vl_2c" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>901</const>
        </call>
        <call function="=" as="hoz_kl" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>781</const>
        </call>
        <call function="=" as="hoz_mba" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>622</const>
        </call>
        <call function="=" as="hoz_cnt" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>624</const>
        </call>
        <call function="=" as="hoz_cnt_pr" dontpushpred="1">
          <column table="ipr_kod_hoz_sposob" column="kod_character" />
          <const>623</const>
        </call>
        <call function="gt" as="titul_started">
          <call function="+nvl">
            <column table="ipr_vvod_fiz" column="km_vl_1c" />
            <column table="ipr_vvod_fiz" column="km_vl_2c" />
            <column table="ipr_vvod_fiz" column="km_kl" />
            <column table="ipr_vvod_fiz" column="mba" />
            <column table="ipr_vvod_fiz" column="cnt" />
            <column table="ipr_vvod_fiz" column="cnt_proch" />
            <column table="ipr_kod_hoz_sposob" column="val" />
          </call>
          <const>0</const>
        </call>
        <call function="or" as="titul_completed">
          <call function="=">
            <column table="kod_ipr" column="kod_status" />
            <const>4</const>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>189</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
        </call>
        <call function="or" as="titul_pir">
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>168</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_vip_dog" column="kodzatrat" />
              <const>80</const>
            </call>
            <call function="gt">
              <column column="vsego" table="ipr_kod_vip_dog" nvl="0" />
              <const>0</const>
            </call>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_doc" column="kod_doc_type" />
              <const>590</const>
            </call>
          </call>
        </call>
        <call function="or" as="titul_vvod">
          <call function="gt">
            <call function="+nvl">
              <column table="ipr_vvod_fiz" column="km_vl_1c" />
              <column table="ipr_vvod_fiz" column="km_vl_2c" />
              <column table="ipr_vvod_fiz" column="km_kl" />
              <column table="ipr_vvod_fiz" column="mba" />
              <column table="ipr_vvod_fiz" column="cnt" />
              <column table="ipr_vvod_fiz" column="cnt_proch" />
            </call>
            <const>0</const>
          </call>
          <call function="and">
            <call function="=">
              <column table="ipr_kod_contr_steps_val" column="kod_template_contr_steps_val" />
              <const>207</const>
            </call>
            <call function="is not null">
              <column column="ef_date_mat" table="ipr_kod_contr_steps_val" />
            </call>
          </call>
        </call>
        <call function="()" as="isv_ad_evd_no_tits_count" group="sum">
          <fact column="isv_ad_evd_count" condition="cond_tituls_absent" />
        </call>
        <call function="()" as="km_vl_1c_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_vl_1c" />
        </call>
        <call function="()" as="km_vl_2c_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_vl_2c" />
        </call>
        <call function="()" as="km_kl_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_kl" />
        </call>
        <call function="()" as="km_mba_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_mba" />
        </call>
        <call function="()" as="km_cnt_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_cnt" />
        </call>
        <call function="()" as="km_cnt_pr_fact" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_cnt_pr" />
        </call>
        <call function="()" as="km_vl_1c_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_vl_1c" />
        </call>
        <call function="()" as="km_vl_2c_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_vl_2c" />
        </call>
        <call function="()" as="km_kl_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_kl" />
        </call>
        <call function="()" as="km_mba_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_mba" />
        </call>
        <call function="()" as="km_cnt_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_cnt" />
        </call>
        <call function="()" as="km_cnt_pr_fact_mes" group="sum">
          <fact column="ipr_hoz_sposob_val" condition="hoz_cnt_pr" />
        </call>
        <call function="()" as="obj_count_plan_started" type="number" group="sum" comment="титулы у которых заполнен факт по вводу в ОФ либо имеются данные в форме характеристик по хоз способу">
          <fact column="ipr_titul_ip_count" title="План за год. Кол-во объектов" nvl="0" condition="titul_started" />
        </call>
        <call function="()" as="obj_count_plan_completed" type="number" group="sum" comment="статус титула “Выполнен” либо заполнена дата фактического окончания по контрольному этапу 3.7">
          <fact column="ipr_titul_ip_count" title="План за год. Кол-во объектов" nvl="0" condition="titul_completed" />
        </call>
        <call function="()" as="obj_count_plan_pir" group="sum" comment="заполнена дата фактического окончания по контрольному этапу 1.10 либо имеется вид затрат 9.1 либо к титулу приложен документ с типом “ Акт выполненных работ (ПИР) по хоз способу”">
          <fact column="ipr_titul_ip_count" condition="titul_pir" />
        </call>
        <call function="()" as="obj_count_plan_vvod" group="sum" comment="заполнена дата фактического окончания по контрольному этапу 1.10 либо имеется вид затрат 9.1 либо к титулу приложен документ с типом “ Акт выполненных работ (ПИР) по хоз способу”">
          <fact column="ipr_titul_ip_count" condition="titul_vvod" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" exclude="1" />
        <column table="ipr_kod_hoz_sposob" column="kod_hoz_sposob" exclude="1" />
        <fact column="ipr_titul_ip_count" group="sum" title="Факт за год. Кол-во объектов" as="obj_count_fact" nvl="0" />
      </select>
      <from>
        <qube single-way="1">
          <link name="id_slice" />
          <link name="ipr_kod_hoz_sposob" />
          <link name="ipr_kod_titul_ip" />
          <dimset as="hoz_mes">
            <where>
              <call function="and">
                <call function="=">
                  <column table="ipr_kod_hoz_sposob" column="year" />
                  <useparam name="year" />
                </call>
              </call>
            </where>
          </dimset>
          <where>
            <call function="and">
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_all" />
              </call>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Всего" exclude="1">
          <where exclude="1">
            <call function="=">
              <column table="this" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </where>
          <grset title="По филиалам" as="dep" order="dep_name">
            <group>
              <sourcelink table="evd_kod_filial_tit" />
            </group>
            <grset title="По РЭС" as="res" order="res_name">
              <group>
                <sourcelink table="evd_kodres" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="41656-detail-tit" timestamp="05.12.2017 19:59:28" visible="0" title="План по выполнению работ хоз. способом (детализация)" is-report="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <select>
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        <column table="evd_kod_filial_tit" column="kod_direct" />
        <column column="kod_direct" as="kod_res" table="evd_kodres" />
        <column table="evd_kod_filial_tit" column="name_kr" title="Филиал" as="dep_name" />
        <column table="evd_kodres" column="name_kr" title="РЭС" as="res_name" />
        <column table="ipr_kod_titul_ip" column="tit_num_new" />
        <call function="ym2 to char" as="sym">
          <column table="ipr_ym" column="val" title="Период" format="F0" />
        </call>
        <column table="ipr_filial_res_valid" as="filial_res_valid" column="val" />
        <call function="()" as="[column]" type="number" title="Значение" halign="center">
          <call function="()" as="[column]" />
        </call>
      </select>
      <from>
        <qube single-way="1">
          <link name="evd_kod_filial_tit" />
          <link name="evd_kodres" />
          <link name="evd_pr_hoz_sposob" only-for-cond="1" />
          <link name="id_slice" only-for-cond="1" />
          <link name="evd_pr_vip" only-for-cond="1" />
          <link name="evd_pr_ostatok" only-for-cond="1" />
          <link name="evd_year_srok" only-for-cond="1" />
          <link name="evd_otch_list_3" only-for-cond="1" />
          <link name="evd_fl_build" only-for-cond="1" />
          <link name="evd_dt_contract" only-for-cond="1" />
          <link name="kod_isv_ad_evd" only-for-cond="1" />
          <link name="ipr_filial_res_valid" />
          <dimset as="titul_mes">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_vvod_fiz" only-for-cond="1" />
          </dimset>
          <dimset as="vvod_mes">
            <link name="ipr_ym" />
            <link name="ipr_kod_titul_ip" />
          </dimset>
          <dimset as="hoz_mes">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
          <dimset as="titul">
            <link name="ipr_kod_titul_ip" />
          </dimset>
          <dimset as="main" />
          <dimset as="vvod">
            <link name="ipr_ym" />
            <link name="ipr_kod_titul_ip" />
          </dimset>
          <dimset as="titul_sum">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_ym" />
          </dimset>
          <dimset as="hoz">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
          <dimset as="hoz_mes_prev">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_kod_hoz_sposob" />
          </dimset>
          <dimset as="titul_mes_next">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_vvod_fiz" only-for-cond="1" />
          </dimset>
          <dimset as="vvod_mes_next">
            <link name="ipr_ym" />
            <link name="ipr_kod_titul_ip" />
          </dimset>
          <dimset as="hoz_mes_prev2">
            <link name="ipr_kod_titul_ip" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="41656-detail-ad" timestamp="05.12.2017 20:06:44" visible="0" title="План по выполнению работ хоз. способом (детализация)" is-report="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <select>
        <column table="evd_kod_filial_tit" column="kod_direct" />
        <column column="kod_direct" as="kod_res" table="evd_kodres" />
        <column table="kod_isv_ad_evd" column="kod_dop_contract" />
        <column table="evd_kod_filial_tit" column="name_kr" title="Филиал" as="dep_name" />
        <column table="evd_kodres" column="name_kr" title="РЭС" as="res_name" />
        <column table="kod_isv_ad_evd" column="num_req" />
        <column table="kod_isv_ad_evd" column="num_ouco" />
        <column table="ipr_filial_res_valid" as="filial_res_valid" column="val" />
        <call function="()" as="[column]" type="number" title="Значение" halign="center">
          <call function="()" as="[column]" />
        </call>
      </select>
      <from>
        <qube single-way="1">
          <link name="evd_kod_filial_tit" />
          <link name="evd_kodres" />
          <link name="evd_pr_hoz_sposob" only-for-cond="1" />
          <link name="id_slice" only-for-cond="1" />
          <link name="evd_pr_vip" only-for-cond="1" />
          <link name="evd_pr_ostatok" only-for-cond="1" />
          <link name="evd_year_srok" only-for-cond="1" />
          <link name="evd_otch_list_3" only-for-cond="1" />
          <link name="evd_fl_build" only-for-cond="1" />
          <link name="evd_dt_contract" only-for-cond="1" />
          <link name="kod_isv_ad_evd" />
          <link name="ipr_filial_res_valid" />
          <dimset as="titul_mes">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_vvod_fiz" only-for-cond="1" />
          </dimset>
          <dimset as="vvod_mes">
            <link name="ipr_ym" only-for-cond="1" />
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
          </dimset>
          <dimset as="hoz_mes">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
          <dimset as="titul">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
          </dimset>
          <dimset as="main" />
          <dimset as="vvod">
            <link name="ipr_ym" />
            <link name="ipr_kod_titul_ip" />
          </dimset>
          <dimset as="titul_sum">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_ym" only-for-cond="1" />
          </dimset>
          <dimset as="hoz">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
          <dimset as="hoz_mes_prev">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
          <dimset as="titul_mes_next">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_vvod_fiz" only-for-cond="1" />
          </dimset>
          <dimset as="vvod_mes_next">
            <link name="ipr_ym" only-for-cond="1" />
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
          </dimset>
          <dimset as="hoz_mes_prev2">
            <link name="ipr_kod_titul_ip" only-for-cond="1" />
            <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="41656-month-next" timestamp="29.09.2017 12:54:43" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="month" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <useparam name="month" />
            <const>12</const>
          </call>
          <const>1</const>
          <call function="+">
            <useparam name="month" />
            <const>1</const>
          </call>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="41656-year-month-next" timestamp="29.09.2017 12:56:04" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <param name="month" type="number" />
        <param name="year" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <useparam name="month" />
            <const>12</const>
          </call>
          <call function="+">
            <useparam name="year" />
            <const>1</const>
          </call>
          <useparam name="year" />
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="41656-is_spr_direct_list" order="name" class="1" timestamp="13.11.2017 18:15:09" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="name" as="name_direct" fixed="1" />
        <column table="a" column="name_kr" as="name_kr_direct" />
      </select>
      <from>
        <query name="is_spr_direct" as="a">
          <link name="puser_ext" as="ipr_rights" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipr_rights" column="puser" />
            <const>user</const>
          </call>
          <call function="is null">
            <column table="a" column="god" />
          </call>
          <call function="=">
            <column table="a" column="invest_pr" />
            <const>1</const>
          </call>
          <call function="in">
            <column table="a" column="kod_direct" />
            <call function="array">
              <const>19</const>
              <const>20</const>
              <const>21</const>
              <const>22</const>
              <const>24</const>
              <const>26</const>
              <const>27</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="41656-2_1" timestamp="18.12.2018 14:48:22" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <select>
        <column table="evd_kod_filial_tit" column="kod_direct" />
        <column column="kod_direct" as="kod_res" table="evd_kodres" />
        <column table="ipr_filial_res_valid" as="filial_res_valid" column="val" />
        <column table="evd_kod_filial_tit" column="name_kr" title="Отделение" as="dep_name" group="max" />
        <column table="evd_kodres" column="name_kr" title="РЭС" as="res_name" group="max" />
        <call function="/0" group="sum" as="perc" nvl="0">
          <column table="evd_kod_filial_tit" column="kod_direct" />
          <column table="evd_kodres" column="kod_direct" />
        </call>
        <call function="dense_rank" as="res_rank">
          <call function="order by 2">
            <call function="desc nulls last">
              <column table="this" column="res_perc" />
            </call>
          </call>
        </call>
        <call function="dense_rank" as="filial_rank">
          <call function="order by 2">
            <call function="desc nulls last">
              <column table="this" column="filial_perc" />
            </call>
          </call>
        </call>
        <call function="over" as="res_perc">
          <call function="sum">
            <column table="this" column="perc" />
          </call>
          <call function="partition by">
            <column table="evd_kodres" column="kod_direct" />
          </call>
        </call>
        <call function="over" as="filial_perc">
          <call function="sum">
            <column table="this" column="perc" />
          </call>
          <call function="partition by">
            <column table="evd_kod_filial_tit" column="kod_direct" />
          </call>
        </call>
      </select>
      <from>
        <qube single-way="1">
          <link name="evd_kod_filial_tit" />
          <link name="evd_kodres" />
          <link name="evd_pr_hoz_sposob" only-for-cond="1" />
          <link name="id_slice" only-for-cond="1" />
          <link name="evd_pr_vip" only-for-cond="1" />
          <link name="evd_pr_ostatok" only-for-cond="1" />
          <link name="evd_year_srok" only-for-cond="1" />
          <link name="evd_otch_list_3" only-for-cond="1" />
          <link name="evd_fl_build" only-for-cond="1" />
          <link name="evd_dt_contract" only-for-cond="1" />
          <link name="kod_isv_ad_evd" all-rows="1" />
          <link name="ipr_filial_res_valid" />
          <where>
            <call function="and">
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <usepart part="41656-cmn-where" />
              <call function="in">
                <column table="evd_kod_filial_tit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <usepart part="41656-cmn-grouping" />
      </grouping>
    </query>
    <query name="29265-cols-tekfix-def" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="29265-cols" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id" />
          <const>'Текущая'</const>
        </call>
      </where>
    </query>
    <query name="29265-cols-def" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <param name="tekfix" type="string" />
        <param name="is_details" type="number" />
        <param name="is_show_akt" type="number" />
        <param name="is_show_sum_dog" type="number" />
      </params>
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="29265-cols" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="=">
            <column table="a" column="id" />
            <useparam name="tekfix" />
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="is_details" />
            </call>
            <call function="=">
              <column table="a" column="id" />
              <const>'Подробно'</const>
            </call>
          </call>
          <call function="and" optional="1">
            <call function="=1">
              <useparam name="is_show_akt" />
            </call>
            <call function="=">
              <column table="a" column="id" />
              <const>'Акт/РНО'</const>
            </call>
          </call>
          <call function="and">
            <call function="=1">
              <call function="nvlu">
                <useparam name="is_show_sum_dog" />
                <const>0</const>
              </call>
            </call>
            <call function="=">
              <column table="a" column="id" />
              <const>'сумма договора без НДС'</const>
            </call>
          </call>
          <call function="and">
            <call function="=0">
              <call function="nvlu">
                <useparam name="is_show_sum_dog" />
                <const>0</const>
              </call>
            </call>
            <call function="=">
              <column table="a" column="id" />
              <const>'сумма договора с НДС'</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="29265-cols" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <const as="id" type="string">'Текущая'</const>
      <const as="name" type="string" title="1">'Текущая'</const>
      <const>'Фиксированная'</const>
      <const>'Фиксированная'</const>
      <const>'Подробно'</const>
      <const>'Подробно'</const>
      <const>'Акт/РНО'</const>
      <const>'Акт/РНО'</const>
      <const>'сумма договора без НДС'</const>
      <const>'сумма договора без НДС'</const>
      <const>'сумма договора с НДС'</const>
      <const>'сумма договора с НДС'</const>
    </query>
    <query name="29265-dat-grsets" order="kod_titul_ip" timestamp="29.05.2017 16:44:56" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="29265-dat" as="a">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
          <grsets>
            <grset level="1" title="Сборный (узел)" as="sbor_node">
              <grset level="" title="Сборный (вывод)" as="sbor">
                <where>
                  <call function="is not null">
                    <column table="a" column="kod_titul_ip_sbor" />
                  </call>
                </where>
              </grset>
              <grset level="2" title="Головной(узел)" as="par_node">
                <grset level="" title="Головной(вывод)" as="par">
                  <where>
                    <call function="not">
                      <call function="is null or -1">
                        <column table="a" column="kod_parent" />
                      </call>
                    </call>
                  </where>
                </grset>
                <grset level="3" title="Одиночный/Дочерний" as="child">
                  <where>
                    <call function="!=nvl">
                      <column table="a" column="is_head_tit" />
                      <const>1</const>
                    </call>
                  </where>
                  <grset level="4" title="Договор" as="dog">
                    <where>
                      <call function="is not null">
                        <column table="a" column="kod_dog_i" />
                      </call>
                    </where>
                    <grset level="5" title="Акт" as="akt">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_vip_dog" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="is_show_akt" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                    <grset level="6" title="РНО" as="rno">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_opl_period" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="is_show_akt" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="29265-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <call function="year" as="year">
          <useparam name="dat" />
        </call>
        <call function="+" as="year_nxt">
          <call function="year">
            <useparam name="dat" />
          </call>
          <const>1</const>
        </call>
        <column table="a" column="name" as="mp_name" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <useparam name="mp" />
        </call>
      </where>
    </query>
    <query name="29265-dat" grouplevel="no" timestamp="16.03.2018 13:49:55" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <!--<column table="kod_titul_ip" column="kod_titul_ip" group="1" />
        <column table="a" column="kod_titul_ip_sb" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_titul_ip" />-->
        <column table="kod_sbor_titul" column="kod_sbor_titul" group="1" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="name" as="name_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_subject_sbor" column="abbr" as="subj_abbr_sbor" group="kod_sbor_titul" />
        <call function="if" type="string" as="podr_abbr_sbor" group="kod_sbor_titul" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct_sbor" column="name_kr" />
          <column table="kod_ispolnit_sbor" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_parent" group="2" />
        <column table="kod_parent" column="tit_num_new_n" as="tit_num_new_par" group="kod_parent" title="{+} (головной)" />
        <column table="kod_parent" column="name" as="name_par" group="kod_parent" title="{+} (головной)" />
        <column table="kod_subject_par" column="abbr" as="subj_abbr_par" group="kod_parent" />
        <call function="if" type="string" as="podr_abbr_par" group="kod_parent" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct_par" column="name_kr" />
          <column table="kod_ispolnit_par" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_titul_ip" group="3" />
        <column table="kod_titul_ip" column="tit_num_new_n" as="tit_num_new" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="kod_titul_ip" column="name" as="name_tit" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="kod_subject" column="abbr" as="subj_abbr" group="kod_titul_ip" />
        <column table="pr_ofz" column="name" as="ofz_name" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="is_head_tit" as="is_head_tit" group="kod_titul_ip" />
        <call function="substr" as="itip" group="kod_titul_ip">
          <column table="kod_ipr" column="itip" />
          <const>0</const>
          <const>1</const>
        </call>
        <call function="if" type="string" as="podr_abbr" group="kod_titul_ip" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct" column="name_kr" />
          <column table="kod_ispolnit" column="name_kr" />
        </call>
        <column table="a" column="ipr_fin_ipr" group="sum" c-master="kod_titul_ip" />
        <column table="a" column="summ_k_rasp" group="sum" colset="Фиксированная" c-master="kod_titul_ip" mp="[:mp]" />
        <column table="a" column="summ_k_rasp" as="summ_k_rasp_sm" group="sum" colset="Фиксированная" c-master="kod_titul_ip" dimname="sm" mp="[:mp]">
          <pivot title=" в разрезе сметы">
            <call function="=">
              <column table="a" column="kod_smet" />
              <column table="dim" column="kod_smet" />
            </call>
            <query order="kod_smet">
              <select>
                <column table="ips_smet" column="kod_smet" />
                <column table="ips_smet" column="name" />
              </select>
              <from>
                <query name="ips_smet_structure" as="ips_smet" />
              </from>
              <where>
                <call function="and">
                  <call function="lt">
                    <column table="ips_smet" column="kod_smet" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="summ_k_rasp_tek" group="sum" colset="Текущая" c-master="kod_titul_ip" mp="[:mp]" />
        <column table="a" column="summ_k_rasp_tek" as="summ_k_rasp_tek_sm" group="sum" colset="Текущая" c-master="kod_titul_ip" dimname="sm" mp="[:mp]" />
        <column table="a" column="dog_proch_plan_cost" as="dog_plan_cost_oks" group="sum" colset="Текущая" title="Затраты на содержание службы заказчика (затраты ОКСа)" mp="[:mp]">
          <if>
            <call function="in">
              <column table="a" column="kodzatrat" />
              <array>
                <const type="number">53</const>
              </array>
            </call>
          </if>
        </column>
        <column table="a" column="dog_proch_plan_cost" as="dog_plan_cost_75" group="sum" colset="Текущая" title="Затраты на содержание службы заказчика (затраты ОКСа)" mp="[:mp]">
          <if>
            <call function="in">
              <column table="a" column="kodzatrat" />
              <array>
                <const type="number">99</const>
              </array>
            </call>
          </if>
        </column>
        <column table="kod_dog_i" column="kod_dog_i" group="4" title="kod_dog" />
        <column table="kod_dog_i" column="num_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="predm_dog" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_end_i" group="kod_dog_i" />
        <column table="e_code" column="name_all" group="kod_dog_i" as="name_contr" />
        <column table="kod_dog_i" column="tip_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="status_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="name_i" group="kod_dog_i" />
        <call function="if" as="stadiya" type="string" title="Стадия реализации проекта С/П" agg="no" group="kod_titul_ip">
          <call function="between">
            <call function="year">
              <useparam name="dat" />
            </call>
            <column table="kod_titul_ip" column="beg_year" />
            <column table="kod_titul_ip" column="end_year" />
          </call>
          <call function="if">
            <call function="not 0">
              <column table="this" column="kap_sum_itog_23" />
            </call>
            <const>'С'</const>
            <const>'П'</const>
          </call>
          <const>null</const>
        </call>
        <column table="a" column="kap_sum_itog" as="kap_sum_itog_23" title="Плановые суммы освоения по виду затрат СМР,Оборудование на начало " group="sum" mp="-6" if="beg23" agg="sum">
          <section>
            <call function="num to ym2">
              <call function="-">
                <call function="year">
                  <useparam name="dat" />
                </call>
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
          <if>
            <call function="in">
              <column table="a" column="kod_smet" />
              <array>2,3</array>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_tek_pred" group="sum" if="tek_pred">
          <if>
            <call function="le">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <call function="if" as="dog_plan_cost_a" mp="[:mp]" type="number">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="this" column="kap_sum_fact_tek_pred" group="" />
          <column table="a" column="dog_plan_cost" />
        </call>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost" group="sum" colset="сумма договора без НДС" />
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_sm" group="sum" dimname="sm" colset="сумма договора без НДС" />
        <!--<const as="dog_plan_cost_sm_key" type="number" group="sum" colset="сумма договора без НДС">null</const>-->
        <call function="" as="dog_plan_cost_sm_key" type="number" group="sum" colset="сумма договора без НДС" title="1">
          <const>null</const>
        </call>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_pred" group="sum" colset="сумма договора без НДС" if="pred_y">
          <if>
            <call function="lt">
              <call function="year">
                <column table="kod_dog_i" column="date_end_i" />
              </call>
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_tek" group="sum" colset="сумма договора без НДС" if="tek_yd">
          <if>
            <call function="ge">
              <call function="year">
                <column table="kod_dog_i" column="date_end_i" />
              </call>
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_nds_fact" as="kap_sum_nds_fact_tek_pred" group="sum" if="tek_pred">
          <if>
            <call function="le">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <call function="if" as="dog_plan_cost_nds_a" mp="[:mp]" type="number">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="this" column="kap_sum_nds_fact_tek_pred" group="" />
          <column table="a" column="dog_plan_cost_nds" />
        </call>
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds" group="sum" colset="сумма договора с НДС" />
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds_sm" group="sum" dimname="sm" colset="сумма договора с НДС" />
        <!--<const as="dog_plan_cost_nds_sm_key" type="number" group="sum" colset="сумма договора с НДС">null</const>-->
        <call function="" as="dog_plan_cost_nds_sm_key" type="number" group="sum" colset="сумма договора с НДС" title="1">
          <const>null</const>
        </call>
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds_pred" group="sum" colset="сумма договора с НДС" if="pred_y" />
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds_tek" group="sum" colset="сумма договора с НДС" if="tek_yd" />
        <column table="a" column="kap_sum_fact" group="sum" mp="[:mp]" />
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_pr_y" group="sum" if="pr_y" mp="[:mp]" colset="Подробно">
          <if title=" (пред годы)">
            <call function="lt">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_tek_y" group="sum" if="tek_y" mp="[:mp]" colset="Подробно">
          <if title=" (тек год)">
            <call function="=">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_sm" group="sum" dimname="sm" mp="[:mp]" colset="Подробно" />
        <call function="if" as="kap_sum_a" mp="[:mp]" type="number">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="a" column="kap_sum_fact" />
          <column table="a" column="kap_sum" />
        </call>
        <column table="this" column="kap_sum_a" as="kap_sum_tek_pred" group="sum" if="tek_pred" colset="Подробно" />
        <column table="this" column="kap_sum_a" as="kap_sum_yrs" group="sum" dimname="years" colset="Подробно">
          <pivot title=" по годам">
            <call function="=">
              <column table="a" column="year" />
              <column table="dim" column="year" />
            </call>
            <query order="name">
              <select>
                <call function="-" as="id">
                  <column table="y" column="year" />
                  <call function="year">
                    <useparam name="dat" />
                  </call>
                </call>
                <column table="y" column="name" />
                <column table="y" column="year" />
              </select>
              <from>
                <query name="spr_time_year" as="y" />
              </from>
              <where>
                <call function="between">
                  <column table="y" column="year" />
                  <call function="+">
                    <call function="year">
                      <useparam name="dat" />
                    </call>
                    <const>1</const>
                  </call>
                  <call function="+">
                    <call function="year">
                      <useparam name="dat" />
                    </call>
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <!--<column table="a" column="kap_sum" group="sum" />-->
        <column table="a" column="fp_sum_nds_fact" group="sum" mp="[:mp]" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_pr_y" group="sum" if="pr_y" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_tek_y" group="sum" if="tek_y" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_sm" group="sum" dimname="sm" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_av" group="sum" if="av" mp="[:mp]" colset="Подробно">
          <if title=" (аванс)">
            <call function="=1">
              <column table="a" column="is_avans" />
            </call>
          </if>
        </column>
        <column table="a" column="kredit_fact_itog_dog" group="sum" if="idt" mp="[:mp]" colset="Подробно">
          <section>
            <call function="date to ym2">
              <call function="doomsday" />
            </call>
          </section>
        </column>
        <column table="a" column="debet_fact_itog_dog" group="sum" if="idt" mp="[:mp]" colset="Подробно" />
        <column table="a" column="kredit_fact_itog_smet" group="sum" if="idt" mp="[:mp]" colset="Подробно" />
        <column table="a" column="debet_fact_itog_smet" group="sum" isumm_k_rasp_tek_smf="idt" mp="[:mp]" colset="Подробно" />
        <column table="kod_vip_dog" column="kod_vip_dog" group="5" colset="Акт/РНО" />
        <column table="kod_vip_dog" column="num_doc" group="kod_vip_dog" colset="Акт/РНО" />
        <column table="kod_vip_dog" column="dat_doc" group="kod_vip_dog" colset="Акт/РНО" />
        <column table="kod_opl_period" column="kod_opl_period" group="6" colset="Акт/РНО" />
        <column table="kod_opl_period" column="num_rno" group="kod_opl_period" colset="Акт/РНО" />
        <column table="kod_opl_period" column="dat_opl" group="kod_opl_period" colset="Акт/РНО" />
        <column table="kod_opl_period" column="status" group="kod_opl_period" colset="Акт/РНО" title="Тип РНО" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_dog_i">
            <link name="kod_dog">
              <link name="e_code" />
            </link>
          </link>
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_parent">
              <link name="kod_subject" as="kod_subject_par" />
              <link name="kod_direct" as="kod_direct_par" />
              <link name="kod_ispolnit" as="kod_ispolnit_par" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                  <link name="kod_subject" as="kod_subject_sbor" />
                  <link name="kod_direct" as="kod_direct_sbor" />
                  <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                </link>
              </link>
            </link>
          </link>
          <link name="kod_vip_dog" />
          <link name="kod_opl_period" />
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="=" selective="1">
                <column table="*" column="pr_last_smet" />
                <const>1</const>
              </call>
              <!--<call function="=">
                <column table="kod_titul_ip1" column="kod_titul_ip" />
                <const>25788</const>
              </call>-->
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul1" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="le" selective="1">
                <column table="*" column="dat" />
                <useparam name="dat" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_status" />
                <useparam name="kod_status_tit" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is null">
              <column table="kod_dog_i" column="kod_dog_i" />
            </call>
            <call function="and">
              <call function="true" />
              <call function="le" selective="1" optional="1">
                <column table="kod_dog_i" column="date_i" />
                <useparam name="dat_dog_po" />
              </call>
              <call function="ge" selective="1" optional="1">
                <column table="kod_dog_i" column="date_i" />
                <useparam name="dat_dog_s" />
              </call>
            </call>
          </call>
          <call function="or">
            <call function="is null">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
            <call function="=1">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
          </call>
          <call function="or">
            <call function="is null">
              <column table="kod_dog" column="status" />
            </call>
            <call function="in">
              <column table="kod_dog" column="status" />
              <array>0,1,4,12,27,13</array>
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="29265-mp-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <const>-3</const>
        </call>
      </where>
    </query>
    <query name="29265-dat-grsets-vert-test" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="29265-dat-vert-test2" as="a">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
          <grsets>
            <grset level="1" title="Сборный (узел)" as="sbor_node">
              <grset level="" title="Сборный (вывод)" as="sbor">
                <where exclude="1">
                  <call function="is not null">
                    <column table="a" column="kod_titul_ip_sbor" />
                  </call>
                </where>
              </grset>
              <grset level="2" title="Головной(узел)" as="par_node">
                <grset level="" title="Головной(вывод)" as="par">
                  <where exclude="1">
                    <call function="not">
                      <call function="is null or -1">
                        <column table="a" column="kod_parent" />
                      </call>
                    </call>
                  </where>
                </grset>
                <grset level="3" title="Одиночный/Дочерний" as="child">
                  <grset level="4" title="Договор" as="dog">
                    <where exclude="1">
                      <call function="is not null">
                        <column table="a" column="kod_dog_i" />
                      </call>
                    </where>
                    <grset level="5" title="Акт" as="akt">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_vip_dog" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="is_show_akt" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                    <grset level="6" title="РНО" as="rno">
                      <where>
                        <call function="and">
                          <call function="is not null">
                            <column table="a" column="kod_opl_period" />
                          </call>
                          <call function="=">
                            <call function="nvlu">
                              <useparam name="is_show_akt" />
                              <const>0</const>
                            </call>
                            <const>1</const>
                          </call>
                        </call>
                      </where>
                    </grset>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="29265-dat-vert-test" grouplevel="no" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <column table="a" column="kod_sbor_titul" group="1" />
        <column table="a" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="a" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title=" (сборный)" />
        <column table="a" column="name" as="name_sbor" group="kod_sbor_titul" title=" (сборный)" />
        <column table="a" column="abbr" as="subj_abbr_sbor" group="kod_sbor_titul" />
        <column table="a" column="kod_parent" group="2" />
        <column table="a" column="tit_num_new_n" as="tit_num_new_par" group="kod_parent" title=" (головной)" />
        <column table="a" column="name" as="name_par" group="kod_parent" title=" (головной)" />
        <column table="a" column="abbr" as="subj_abbr_par" group="kod_parent" />
        <column table="a" column="kod_titul_ip" group="3" />
        <column table="a" column="tit_num_new_n" as="tit_num_new_n" group="kod_titul_ip" title=" (одиночный/дочерний)" />
        <column table="a" column="name" as="name_tit" group="kod_titul_ip" title=" (одиночный/дочерний)" />
        <column table="a" column="abbr" as="subj_abbr" group="kod_titul_ip" />
        <column table="a" column="kod_dog_i" group="4" title="kod_dog" exclude="1" />
        <column table="a" column="num_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="predm_dog" group="kod_dog_i" exclude="1" />
        <column table="a" column="date_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="date_end_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="tip_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="status_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="name_i" group="kod_dog_i" exclude="1" />
        <column table="a" column="kod_vip_dog" group="5" colset="Акт/РНО" exclude="1" />
        <column table="a" column="num_doc" group="kod_vip_dog" colset="Акт/РНО" exclude="1" />
        <column table="a" column="dat_doc" group="kod_vip_dog" colset="Акт/РНО" exclude="1" />
        <column table="a" column="kod_opl_period" group="6" colset="Акт/РНО" exclude="1" />
        <column table="a" column="num_rno" group="kod_opl_period" colset="Акт/РНО" exclude="1" />
        <column table="a" column="dat_opl" group="kod_opl_period" colset="Акт/РНО" exclude="1" />
        <column table="a" column="status" group="kod_opl_period" colset="Акт/РНО" title="Тип РНО" exclude="1" />
      </select>
      <from>
        <table name="temp" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is null">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
            <call function="=1">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
          </call>
          <call function="or" exclude="1">
            <call function="is null">
              <column table="kod_dog" column="status" />
            </call>
            <call function="in">
              <column table="kod_dog" column="status" />
              <array>0,1,4,12,27,13</array>
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="true" />
        </call>
      </where>
    </query>
    <query name="29265-dat-vert-test2" grouplevel="no" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <select>
        <!--<column table="kod_titul_ip" column="kod_titul_ip" group="1" />
        <column table="a" column="kod_titul_ip_sb" group="kod_titul_ip" />
        <column table="kod_titul_ip" column="tit_num_new_n" group="kod_titul_ip" />-->
        <column table="kod_sbor_titul" column="kod_sbor_titul" group="1" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" group="kod_sbor_titul" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_num_new_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_titul_ip_sbor" column="name" as="name_sbor" group="kod_sbor_titul" title="{+} (сборный)" />
        <column table="kod_subject_sbor" column="abbr" as="subj_abbr_sbor" group="kod_sbor_titul" />
        <call function="if" type="string" as="podr_abbr_sbor" group="kod_sbor_titul" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct_sbor" column="name_kr" />
          <column table="kod_ispolnit_sbor" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_parent" group="2" />
        <column table="kod_parent" column="tit_num_new_n" as="tit_num_new_par" group="kod_parent" title="{+} (головной)" />
        <column table="kod_parent" column="name" as="name_par" group="kod_parent" title="{+} (головной)" />
        <column table="kod_subject_par" column="abbr" as="subj_abbr_par" group="kod_parent" />
        <call function="if" type="string" as="podr_abbr_par" group="kod_parent" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct_par" column="name_kr" />
          <column table="kod_ispolnit_par" column="name_kr" />
        </call>
        <column table="kod_ipr" column="kod_titul_ip" group="3" />
        <column table="kod_titul_ip" column="tit_num_new_n" as="tit_num_new_n" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="kod_titul_ip" column="name" as="name_tit" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="kod_subject" column="abbr" as="subj_abbr" group="kod_titul_ip" />
        <call function="substr" as="itip" group="kod_titul_ip">
          <column table="kod_ipr" column="itip" />
          <const>0</const>
          <const>1</const>
        </call>
        <call function="if" type="string" as="podr_abbr" group="kod_titul_ip" title="Подразделение">
          <call function="=">
            <useparam name="kod_dirisp" />
            <const>2</const>
          </call>
          <column table="kod_direct" column="name_kr" />
          <column table="kod_ispolnit" column="name_kr" />
        </call>
        <column table="a" column="ipr_fin_ipr" group="sum" c-master="kod_titul_ip" />
        <column table="a" column="summ_k_rasp" group="sum" colset="Фиксированная" c-master="kod_titul_ip" mp="[:mp]" />
        <column table="a" column="summ_k_rasp" as="summ_k_rasp_sm" group="sum" colset="Фиксированная" c-master="kod_titul_ip" dimname="sm" mp="[:mp]">
          <pivot title=" в разрезе сметы">
            <call function="=">
              <column table="a" column="kod_smet" />
              <column table="dim" column="kod_smet" />
            </call>
            <query order="kod_smet">
              <select>
                <column table="ips_smet" column="kod_smet" />
                <column table="ips_smet" column="name" />
              </select>
              <from>
                <query name="ips_smet_structure" as="ips_smet" />
              </from>
              <where>
                <call function="and">
                  <call function="lt">
                    <column table="ips_smet" column="kod_smet" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="a" column="summ_k_rasp_tek" group="sum" colset="Текущая" c-master="kod_titul_ip" mp="[:mp]" />
        <column table="a" column="summ_k_rasp_tek" as="summ_k_rasp_tek_sm" group="sum" colset="Текущая" c-master="kod_titul_ip" dimname="sm" mp="[:mp]" />
        <column table="kod_dog_i" column="kod_dog_i" group="4" title="kod_dog" />
        <column table="kod_dog_i" column="num_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="predm_dog" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="date_end_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="tip_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="status_i" group="kod_dog_i" />
        <column table="kod_dog_i" column="name_i" group="kod_dog_i" />
        <call function="if" as="stadiya" type="string" title="Стадия реализации проекта С/П" agg="no" group="kod_titul_ip">
          <call function="between">
            <call function="year">
              <useparam name="dat" />
            </call>
            <column table="kod_titul_ip" column="beg_year" />
            <column table="kod_titul_ip" column="end_year" />
          </call>
          <call function="if">
            <call function="not 0">
              <column table="this" column="kap_sum_itog_23" />
            </call>
            <const>'С'</const>
            <const>'П'</const>
          </call>
          <const>null</const>
        </call>
        <column table="a" column="kap_sum_itog" as="kap_sum_itog_23" title="Плановые суммы освоения по виду затрат СМР,Оборудование на начало " group="sum" mp="-6" if="beg23" agg="sum">
          <section>
            <call function="num to ym2">
              <call function="-">
                <call function="year">
                  <useparam name="dat" />
                </call>
                <const>1</const>
              </call>
              <const>12</const>
            </call>
          </section>
          <if>
            <call function="in">
              <column table="a" column="kod_smet" />
              <array>2,3</array>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_tek_pred" group="sum" if="tek_pred">
          <if>
            <call function="le">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <call function="if" as="dog_plan_cost_a" mp="[:mp]">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="this" column="kap_sum_fact_tek_pred" group="" />
          <column table="a" column="dog_plan_cost" />
        </call>
        <column table="a" column="dog_plan_cost" as="dog_plan_cost_1" />
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost" group="sum" colset="сумма договора без НДС" />
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_sm" group="sum" dimname="sm" colset="сумма договора без НДС" />
        <const as="dog_plan_cost_sm_key" type="number" group="sum" colset="сумма договора без НДС">null</const>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_pred" group="sum" colset="сумма договора без НДС" if="pred_y">
          <if>
            <call function="lt">
              <call function="year">
                <column table="kod_dog_i" column="date_end_i" />
              </call>
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_tek" group="sum" colset="сумма договора без НДС" if="tek_y">
          <if>
            <call function="ge">
              <call function="year">
                <column table="kod_dog_i" column="date_end_i" />
              </call>
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_nds_fact" as="kap_sum_nds_fact_tek_pred" group="sum" if="tek_pred">
          <if>
            <call function="le">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <call function="if" as="dog_plan_cost_nds_a" mp="[:mp]">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="this" column="kap_sum_nds_fact_tek_pred" group="" />
          <column table="a" column="dog_plan_cost_nds" />
        </call>
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds" group="sum" colset="сумма договора с НДС" />
        <column table="this" column="dog_plan_cost_nds_a" as="dog_plan_cost_nds_sm" group="sum" dimname="sm" colset="сумма договора с НДС" />
        <const as="dog_plan_cost_nds_sm_key" type="number" group="sum" colset="сумма договора с НДС">null</const>
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_nds_pred" group="sum" colset="сумма договора с НДС" if="pred_y" />
        <column table="this" column="dog_plan_cost_a" as="dog_plan_cost_nds_tek" group="sum" colset="сумма договора с НДС" if="tek_y" />
        <column table="a" column="kap_sum_fact" group="sum" mp="[:mp]" />
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_pr_y" group="sum" if="pr_y" mp="[:mp]" colset="Подробно">
          <if title=" (пред годы)">
            <call function="lt">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_tek_y" group="sum" if="tek_y" mp="[:mp]" colset="Подробно">
          <if title=" (тек год)">
            <call function="=">
              <column table="a" column="year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
          </if>
        </column>
        <column table="a" column="kap_sum_fact" as="kap_sum_fact_sm" group="sum" dimname="sm" mp="[:mp]" colset="Подробно" />
        <call function="if" as="kap_sum_a" mp="[:mp]">
          <call function="in">
            <column table="kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <column table="a" column="kap_sum_fact" />
          <column table="a" column="kap_sum" />
        </call>
        <column table="this" column="kap_sum_a" as="kap_sum_tek_pred" group="sum" if="tek_pred" colset="Подробно" />
        <column table="this" column="kap_sum_a" as="kap_sum_yrs" group="sum" dimname="years" colset="Подробно">
          <pivot title=" по годам">
            <call function="=">
              <column table="a" column="year" />
              <column table="dim" column="year" />
            </call>
            <query order="name">
              <select>
                <call function="-" as="id">
                  <column table="y" column="year" />
                  <call function="year">
                    <useparam name="dat" />
                  </call>
                </call>
                <column table="y" column="name" />
                <column table="y" column="year" />
              </select>
              <from>
                <query name="spr_time_year" as="y" />
              </from>
              <where>
                <call function="between">
                  <column table="y" column="year" />
                  <call function="+">
                    <call function="year">
                      <useparam name="dat" />
                    </call>
                    <const>1</const>
                  </call>
                  <call function="+">
                    <call function="year">
                      <useparam name="dat" />
                    </call>
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <!--<column table="a" column="kap_sum" group="sum" />-->
        <column table="a" column="fp_sum_nds_fact" group="sum" mp="[:mp]" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_pr_y" group="sum" if="pr_y" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_tek_y" group="sum" if="tek_y" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_sm" group="sum" dimname="sm" mp="[:mp]" colset="Подробно" />
        <column table="a" column="fp_sum_nds_fact" as="fp_sum_nds_fact_av" group="sum" if="av" mp="[:mp]" colset="Подробно">
          <if title=" (аванс)">
            <call function="=1">
              <column table="a" column="is_avans" />
            </call>
          </if>
        </column>
        <column table="a" column="kredit_fact_itog_dog" group="sum" if="idt" mp="[:mp]" colset="Подробно">
          <section>
            <call function="date to ym2">
              <call function="doomsday" />
            </call>
          </section>
        </column>
        <column table="a" column="debet_fact_itog_dog" group="sum" if="idt" mp="[:mp]" colset="Подробно" />
        <column table="a" column="kredit_fact_itog_smet" group="sum" if="idt" mp="[:mp]" colset="Подробно" />
        <column table="a" column="debet_fact_itog_smet" group="sum" if="idt" mp="[:mp]" colset="Подробно" />
        <column table="kod_vip_dog" column="kod_vip_dog" group="5" colset="Акт/РНО" />
        <column table="kod_vip_dog" column="num_doc" group="kod_vip_dog" colset="Акт/РНО" />
        <column table="kod_vip_dog" column="dat_doc" group="kod_vip_dog" colset="Акт/РНО" />
        <column table="kod_opl_period" column="kod_opl_period" group="6" colset="Акт/РНО" />
        <column table="kod_opl_period" column="num_rno" group="kod_opl_period" colset="Акт/РНО" />
        <column table="kod_opl_period" column="dat_opl" group="kod_opl_period" colset="Акт/РНО" />
        <column table="kod_opl_period" column="status" group="kod_opl_period" colset="Акт/РНО" title="Тип РНО" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_dog_i">
            <link name="kod_dog" />
          </link>
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_parent">
              <link name="kod_subject" as="kod_subject_par" />
              <link name="kod_direct" as="kod_direct_par" />
              <link name="kod_ispolnit" as="kod_ispolnit_par" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                  <link name="kod_subject" as="kod_subject_sbor" />
                  <link name="kod_direct" as="kod_direct_sbor" />
                  <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                </link>
              </link>
            </link>
          </link>
          <link name="kod_vip_dog" />
          <link name="kod_opl_period" />
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="=" selective="1">
                <column table="*" column="pr_last_smet" />
                <const>1</const>
              </call>
              <!--<call function="=">
                <column table="kod_titul_ip1" column="kod_titul_ip" />
                <const>25788</const>
              </call>-->
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul1" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="le" selective="1">
                <column table="*" column="dat" />
                <useparam name="dat" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="=">
                    <const>3</const>
                    <useparam name="kod_dirisp" />
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="=">
                    <const>2</const>
                    <useparam name="kod_dirisp" />
                  </call>
                </call>
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is null">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
            <call function="=1">
              <column table="kod_dog_i" column="pr_kido" />
            </call>
          </call>
          <call function="or">
            <call function="is null">
              <column table="kod_dog" column="status" />
            </call>
            <call function="in">
              <column table="kod_dog" column="status" />
              <array>0,1,4,12,27,13</array>
            </call>
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="29265-cols-tekfix" timestamp="03.06.2021 13:47:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <select>
        <column table="a" column="id" key="1" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="29265-cols" as="a" />
      </from>
      <where>
        <call function="in">
          <column table="a" column="id" />
          <array>'Текущая','Фиксированная'</array>
        </call>
      </where>
    </query>
    <query name="34188" order="kod_titul_ip,kod_doc_type,kod_doc,kod_file" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="row_number" as="rown">
          <call function="partition by">
            <column table="this" column="kod_titul_ip" />
            <column table="this" column="kod_doc_type" />
          </call>
          <call function="order by 2">
            <column table="this" column="kod_doc" />
            <column table="this" column="kod_file" />
          </call>
        </call>
        <call function="dense_rank" as="rown1">
          <!--<call function="partition by">
            <column table="this" column="kod_titul_ip" />
            -->
          <!--<column table="this" column="kod_doc_type" />-->
          <!--
          </call>-->
          <call function="order by 2">
            <column table="this" column="kod_titul_ip" />
            <column table="this" column="kod_doc_type" />
          </call>
        </call>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="34188-dat-all" as="a" grouplevel="2">
          <withparams>
            <usepart part="34188-withparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="34188-dat-all" grouplevel="no" timestamp="08.12.2017 15:56:48" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <column table="a" column="kod_file" group="1" title="Идентификатор файла" />
        <column table="a" column="kod_doc" group="kod_file" />
        <column table="a" column="kod_sbor_titul" group="max" />
        <column table="a" column="kod_main_titul" group="max" />
        <column table="a" column="kod_titul_ip" group="2" />
        <column table="a" column="itip" group="kod_titul_ip" />
        <column table="a" column="tit_num_new" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="a" column="name_tit" group="kod_titul_ip" title="{+} (одиночный/дочерний)" />
        <column table="a" column="cognos_num" group="kod_titul_ip" title="Код для Минэнерго" />
        <column table="a" column="subj_abbr" group="kod_titul_ip" />
        <column table="a" column="podr_abbr_dir" group="kod_titul_ip" title="Подразделение заказчика" />
        <column table="a" column="podr_abbr_isp" group="kod_titul_ip" title="Подразделение исполнителя" />
        <column table="a" column="kod_doc_type" group="kod_file" />
        <column table="a" column="doc_date_c" group="kod_file" />
        <column table="a" column="doc_num" group="kod_file" />
        <column table="a" column="name" group="kod_file" />
        <column table="a" column="abbr" group="kod_file" />
        <column table="a" column="ipr_fin_doc" group="max" />
        <column table="a" column="kod_ipr" group="kod_file" />
        <column table="a" column="kod_file1" group="kod_file" />
        <column table="a" column="folders" title="Выходные каталоги" group="kod_file" />
      </select>
      <from>
        <query as="a">
          <union>
            <query title="Документы ИнвестПро">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО КС-3">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-ks3">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО КС-2">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-ks2" title="Документы КИДО КС-2">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО Договоры услуг, поставки, подряда">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-dog">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО Договоры ТП, АТП (новый вариант)">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-tp">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО АТП (из заявок)">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-atp1">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
            <query title="Документы КИДО АТП (старый вариант)">
              <select>
                <column table="a" column="*" />
              </select>
              <from>
                <query as="a" name="34188-dat-kido-atp2">
                  <withparams>
                    <usepart part="34188-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
    <query name="34188-dat" timestamp="25.12.2017 13:04:20" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <column table="ipr_doc_files_all" column="kod_file" />
        <column table="kod_doc" column="kod_doc" />
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" as="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <column table="kod_doc" column="kod_doc_type" />
        <column table="kod_doc" column="doc_date_c" />
        <column table="kod_doc" column="doc_num" />
        <column table="kod_doc_type" column="name" />
        <call function="nvl" as="abbr" type="string">
          <column table="kod_doc_type" column="abbr" />
          <column table="kod_doc_type" column="name" />
        </call>
        <column table="a" column="ipr_fin_doc" />
        <column table="a" column="kod_ipr" />
        <column table="ipr_doc_files_all" column="kod_file" as="kod_file1">
          <if>
            <call function="and">
              <call function="is not null">
                <column table="ipr_doc_files_all" column="file_name" />
              </call>
              <call function="is not null">
                <column table="ipr_doc_files_all" column="file_data" />
              </call>
            </call>
          </if>
        </column>
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <link name="kod_doc">
            <link name="kod_doc_type">
              <dlink name="vr_doc_reestr_types">
                <link name="kod_folder" />
              </dlink>
            </link>
            <elink name="ipr_doc_files_all" />
          </link>
          <link name="kod_ipr">
            <link name="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
            </link>
            <link name="kod_parent">
              <link name="kod_subject" as="kod_subject_par" />
              <link name="kod_direct" as="kod_direct_par" />
              <link name="kod_ispolnit" as="kod_ispolnit_par" />
            </link>
            <link name="kod_main_titul">
              <link name="kod_subject" />
              <link name="kod_sbor_titul">
                <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                  <link name="kod_subject" as="kod_subject_sbor" />
                  <link name="kod_direct" as="kod_direct_sbor" />
                  <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                </link>
              </link>
            </link>
          </link>
          <extendwhere>
            <call function="and">
              <call function="true" />
              <!--<call function="=">
                <column table="kod_doc" column="kod_doc" />
                <const>143579</const>
              </call>-->
              <call function="=">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="kod_doc" />
              </call>
              <call function="or" optional="1">
                <call function="in">
                  <column table="kod_sbor_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_main_titul1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_titul_ip" />
                  <useparam name="kod_titul_ip" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul1" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="or" optional="1">
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_direct" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,2</array>
                  </call>
                </call>
                <call function="and">
                  <call function="in">
                    <column table="kod_titul_ip1" column="kod_ispolnit" />
                    <useparam name="kod_direct" />
                  </call>
                  <call function="in">
                    <useparam name="kod_dirisp" />
                    <array>1,3</array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip1" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_status" />
                <useparam name="kod_status_tit" />
              </call>
            </call>
          </extendwhere>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_doc_type" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="is not null">
            <column table="kod_doc" column="link_storage" />
          </call>
          <call function="is not null">
            <column table="kod_doc" column="document" />
          </call>
          <call function="le" optional="1">
            <column table="kod_doc" column="doc_date_c" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="kod_doc" column="doc_date_c" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-ks3" timestamp="25.12.2017 13:05:21" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-ks3|'</const>
          <call function="to_char">
            <column table="kod_doc_vip" column="kod_doc_vip" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <const as="kod_doc_type" type="number">1191</const>
        <column table="kod_doc_vip" column="dat_doc" as="dat_doc_c" />
        <column table="kod_doc_vip" column="num" as="doc_num" />
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="is_doc_vip" as="kod_doc_vip">
          <link name="kod_titul_ip_ks3" as="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
            <elink name="ipr_ipr_data" as="kod_ipr">
              <link name="kod_main_titul">
                <link name="kod_subject" />
                <link name="kod_sbor_titul">
                  <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                    <link name="kod_subject" as="kod_subject_sbor" />
                    <link name="kod_direct" as="kod_direct_sbor" />
                    <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                  </link>
                </link>
              </link>
              <link name="kod_parent">
                <link name="kod_subject" as="kod_subject_par" />
                <link name="kod_direct" as="kod_direct_par" />
                <link name="kod_ispolnit" as="kod_ispolnit_par" />
              </link>
            </elink>
          </link>
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_doc_vip" column="kod_spr_doc" />
            <const>85</const>
          </call>
          <call function="is not null">
            <column table="kod_doc_vip" column="kod_titul_ip_ks3" />
          </call>
          <call function="is not null">
            <column table="kod_doc_vip" column="file_data" />
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="kod_doc_vip" column="dat_doc" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="kod_doc_vip" column="dat_doc" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-ks2" timestamp="25.12.2017 13:06:06" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-ks2|'</const>
          <call function="to_char">
            <column table="kod_ks2" column="kod" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <const as="kod_doc_type" type="number">1183</const>
        <column table="kod_ks2" column="date_doc" as="dat_doc_c" />
        <column table="kod_ks2" column="num" as="doc_num" />
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="is_ks2" as="kod_ks2">
          <link name="kod_titul" as="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
            <elink name="ipr_ipr_data" as="kod_ipr">
              <link name="kod_main_titul">
                <link name="kod_subject" />
                <link name="kod_sbor_titul">
                  <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                    <link name="kod_subject" as="kod_subject_sbor" />
                    <link name="kod_direct" as="kod_direct_sbor" />
                    <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                  </link>
                </link>
              </link>
              <link name="kod_parent">
                <link name="kod_subject" as="kod_subject_par" />
                <link name="kod_direct" as="kod_direct_par" />
                <link name="kod_ispolnit" as="kod_ispolnit_par" />
              </link>
            </elink>
          </link>
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="kod_ks2" column="kod_titul" />
          </call>
          <call function="is not null">
            <column table="kod_ks2" column="file_data" />
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="kod_ks2" column="date_doc" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="kod_ks2" column="date_doc" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-dog" timestamp="25.12.2017 13:06:58" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-dog|'</const>
          <call function="to_char">
            <column table="kod_dog" column="kod_dog" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <call as="kod_doc_type" type="number" function="case">
          <call function="when" comment="поставки">
            <call function="=">
              <column table="kod_tip_dog" column="kod_parent" />
              <const>220</const>
            </call>
            <const>1187</const>
          </call>
          <call function="when" comment="подряда">
            <call function="=">
              <column table="kod_tip_dog" column="kod_tip_dog" />
              <const>269</const>
            </call>
            <const>1188</const>
          </call>
          <call function="else" comment="услуг">
            <const>1189</const>
          </call>
        </call>
        <column table="kod_dog" column="dat_dog" as="dat_doc_c" />
        <call function="||" as="doc_num">
          <call function="substr">
            <call function="to_char">
              <column table="kod_dog" column="year" />
            </call>
            <const>3</const>
            <const>2</const>
          </call>
          <const>'-'</const>
          <call function="to_char">
            <column table="kod_dog" column="kod_unig_dog" />
          </call>
        </call>
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="is_dogovor" as="kod_dog">
          <elink name="is_fin_doc_dog_titul_uniq">
            <link name="kod_titul_ip" as="kod_titul_ip">
              <link name="kod_direct" />
              <link name="kod_ispolnit" />
              <elink name="ipr_ipr_data" as="kod_ipr">
                <link name="kod_main_titul">
                  <link name="kod_subject" />
                  <link name="kod_sbor_titul">
                    <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                      <link name="kod_subject" as="kod_subject_sbor" />
                      <link name="kod_direct" as="kod_direct_sbor" />
                      <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                    </link>
                  </link>
                </link>
                <link name="kod_parent">
                  <link name="kod_subject" as="kod_subject_par" />
                  <link name="kod_direct" as="kod_direct_par" />
                  <link name="kod_ispolnit" as="kod_ispolnit_par" />
                </link>
              </elink>
            </link>
          </elink>
          <link name="kod_tip_dog" />
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="kod_dog" column="dat_dog" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="kod_dog" column="dat_dog" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-tp" timestamp="25.12.2017 13:07:45" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-tp|'</const>
          <call function="to_char">
            <column table="a" column="kod_dop_doc" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <call function="case" as="kod_doc_type" type="number">
          <call function="when">
            <call function="=">
              <column table="kod_vid_doc" column="pr_rekv" />
              <const>284</const>
            </call>
            <const>1202</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_vid_doc" column="pr_rekv" />
              <const>293</const>
            </call>
            <const>1186</const>
          </call>
        </call>
        <const as="kod_doc_type" type="number" exclude="1">804</const>
        <column table="a" column="dat_doc" as="dat_doc_c" />
        <column table="a" column="num_doc" as="doc_num" />
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="c_dop_doc" as="a">
          <link name="kod_dop_contract">
            <elink name="ipr_titul_dop_contract">
              <link name="kod_titul_ip" as="kod_titul_ip">
                <link name="kod_direct" />
                <link name="kod_ispolnit" />
                <elink name="ipr_ipr_data" as="kod_ipr">
                  <link name="kod_main_titul">
                    <link name="kod_subject" />
                    <link name="kod_sbor_titul">
                      <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                        <link name="kod_subject" as="kod_subject_sbor" />
                        <link name="kod_direct" as="kod_direct_sbor" />
                        <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                      </link>
                    </link>
                  </link>
                  <link name="kod_parent">
                    <link name="kod_subject" as="kod_subject_par" />
                    <link name="kod_direct" as="kod_direct_par" />
                    <link name="kod_ispolnit" as="kod_ispolnit_par" />
                  </link>
                </elink>
              </link>
            </elink>
          </link>
          <link name="kod_vid_doc" />
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="doc_file_name" />
          </call>
          <call function="is not null">
            <column table="a" column="doc_file" />
          </call>
          <call function="in">
            <column table="kod_vid_doc" column="pr_rekv" />
            <array>
              <const>293</const>
              <const>284</const>
            </array>
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="dat_doc" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="a" column="dat_doc" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-atp2" timestamp="25.12.2017 13:09:17" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-atp2|'</const>
          <call function="to_char">
            <column table="a" column="kod_atp_dop_info" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <const as="kod_doc_type" type="number">1202</const>
        <column table="kn_sert_power" column="dt_reg" as="dat_doc_c" />
        <call function="to_char" as="doc_num">
          <column table="kn_sert_power" column="kn_sert_power" />
        </call>
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="is_atp_dop_info" as="a">
          <link name="kod_dop_contract">
            <elink name="ipr_titul_dop_contract">
              <link name="kod_titul_ip" as="kod_titul_ip">
                <link name="kod_direct" />
                <link name="kod_ispolnit" />
                <elink name="ipr_ipr_data" as="kod_ipr">
                  <link name="kod_main_titul">
                    <link name="kod_subject" />
                    <link name="kod_sbor_titul">
                      <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                        <link name="kod_subject" as="kod_subject_sbor" />
                        <link name="kod_direct" as="kod_direct_sbor" />
                        <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                      </link>
                    </link>
                  </link>
                  <link name="kod_parent">
                    <link name="kod_subject" as="kod_subject_par" />
                    <link name="kod_direct" as="kod_direct_par" />
                    <link name="kod_ispolnit" as="kod_ispolnit_par" />
                  </link>
                </elink>
              </link>
            </elink>
          </link>
          <link name="kn_sert_power" />
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="doc_data" />
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="kn_sert_power" column="dt_reg" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="kn_sert_power" column="dt_reg" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="34188-dat-kido-atp1" timestamp="25.12.2017 13:09:10" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <select>
        <call function="||" as="kod_file">
          <const>'kido-atp1|'</const>
          <call function="to_char">
            <column table="a" column="kn_dfile" />
          </call>
        </call>
        <const as="kod_doc" type="number">null</const>
        <column table="kod_sbor_titul" column="kod_sbor_titul" />
        <column table="kod_ipr" column="kod_main_titul" />
        <column table="kod_ipr" column="kod_titul_ip" />
        <column table="kod_ipr" column="itip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" as="name_tit" />
        <column table="kod_titul_ip" column="export_cognos_num" as="cognos_num" />
        <column table="kod_subject" column="abbr" as="subj_abbr" />
        <column table="kod_direct" column="name_kr" as="podr_abbr_dir" />
        <column table="kod_ispolnit" column="name_kr" as="podr_abbr_isp" />
        <const as="kod_doc_type" type="number">1202</const>
        <column table="a" column="dt_put" as="dat_doc_c" />
        <call function="to_char" as="doc_num">
          <column table="a" column="kn_dfile" />
        </call>
        <column as="name" type="string" table="kod_doc_type" column="name" />
        <column as="abbr" type="string" table="kod_doc_type" column="abbr" />
        <const as="ipr_fin_doc" type="number">null</const>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="this" column="kod_file" title="kod_file1" />
        <column table="kod_folder" column="name" as="folders" dgroup="stragg" />
      </select>
      <from>
        <query name="as_dfile" as="a">
          <link name="kn_request">
            <elink name="is_dop_contract">
              <elink name="ipr_titul_dop_contract">
                <link name="kod_titul_ip" as="kod_titul_ip">
                  <link name="kod_direct" />
                  <link name="kod_ispolnit" />
                  <elink name="ipr_ipr_data" as="kod_ipr">
                    <link name="kod_main_titul">
                      <link name="kod_subject" />
                      <link name="kod_sbor_titul">
                        <link name="kod_titul_ip" as="kod_titul_ip_sbor">
                          <link name="kod_subject" as="kod_subject_sbor" />
                          <link name="kod_direct" as="kod_direct_sbor" />
                          <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
                        </link>
                      </link>
                    </link>
                    <link name="kod_parent">
                      <link name="kod_subject" as="kod_subject_par" />
                      <link name="kod_direct" as="kod_direct_par" />
                      <link name="kod_ispolnit" as="kod_ispolnit_par" />
                    </link>
                  </elink>
                </link>
              </elink>
            </elink>
          </link>
        </query>
        <query name="ips_doc_type" as="kod_doc_type" join="left outer">
          <call function="=">
            <column table="this" column="kod_doc_type" />
            <column table="kod_doc_type" column="kod_doc_type" />
          </call>
          <dlink name="vr_doc_reestr_types">
            <link name="kod_folder" />
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kn_dkind" />
            <const>31</const>
          </call>
          <call function="is not null">
            <column table="a" column="dfile" />
          </call>
          <call function="=">
            <column table="kod_ipr" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="or" optional="1">
            <call function="in">
              <column table="kod_sbor_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_main_titul" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="kod_titul_ip" column="pr_ofz" />
            <useparam name="kod_ofz" />
          </call>
          <call function="not" optional="1">
            <call function="=">
              <column table="kod_titul_ip" column="kod_aip" />
              <useparam name="pr_notaip" />
            </call>
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_doc_type" />
            <useparam name="doc_type" />
          </call>
          <call function="in" optional="1">
            <column table="kod_ipr" column="kod_status" />
            <useparam name="kod_status_tit" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="dt_put" />
            <useparam name="dat_doc_po" />
          </call>
          <call function="ge" optional="1">
            <column table="a" column="dt_put" />
            <useparam name="dat_doc_s" />
          </call>
        </call>
      </where>
    </query>
    <query name="35316-2" timestamp="31.07.2017 13:38:08" title="Приложение 2 к соглашению Минэнерго" edit-columns="2" is-report="1" folder="invpro_ofz" form="35316-2" inherit="35316-cmn" nogrid="1" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-2.xml">
      <expressions>
        <call function="if" as="fin_sum_nds_ofz" group="sum">
          <call function="=">
            <column table="ipr_kod_opl_period" column="pr_ofz" />
            <const>1</const>
          </call>
          <fact column="ipr_fin_fact_sum_nds_npr" />
        </call>
      </expressions>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35316-2.xlsx" title="Приложение 2 к соглашению Минэнерго" print-proc="2" del-cols="1" print-xlsx="1" use-flexcel="1" />
        </excel>
      </print-templates>
      <select>
        <call function="date to char" as="sdat" group="max" exclude="1">
          <useparam name="dat" />
        </call>
        <call function="date to char" as="sdatdolg" group="max">
          <useparam name="dat_dolg" />
        </call>
        <call function="date to char" as="sdat1" group="max">
          <useparam name="dat1" />
        </call>
        <call function="date to char" as="sdat2" group="max">
          <useparam name="dat2" />
        </call>
        <call function="dense_rank" as="npp" group="max" title="№" exclude="1">
          <call function="order by 2">
            <column table="kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="dense_rank" as="npp" group="max" title="№">
          <call function="order by 2">
            <column table="kod_titul_ip" column="ofz_npp" />
            <column table="kod_titul_ip" column="tit_num_new" />
          </call>
        </call>
        <column table="kod_titul_ip" column="ofz_npp" as="npp" title="№" exclude="1" />
        <column table="kod_titul_ip" column="name" as="num_name" />
        <column table="pr_ofz" column="name" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" group="sum" nullif="0" colset="ИнвестPRO" table="tit_ofz" />
        <const as="nzs_on_dat_1c" type="number" title="НЗС (1C)" colset="1С" group="sum">null</const>
        <fact column="kredit_on_dat" title="Кредит" group="sum" nullif="0" table="tit_ofz" />
        <column table="kod_ispolnit" column="name" as="kod_ispolnit_name" />
        <fact column="smet_sum_nds" title="Сметная стоимость с НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum" title="Сметная стоимость без НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum_nds_np" title="Сметная стоимость с НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum_np" title="Сметная стоимость без НДС" group="sum" table="smet" nullif="0" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_dop_contract" column="num_ad_pref_no_dat" as="num_ad" />
        <column table="kod_dop_contract" column="dt_contract" />
        <column table="kod_dop_contract" column="isp_info" as="dog_ofz_name" />
        <fact table="dog" column="is_dop_cont_count" group="sum" />
        <fact column="kap_sum_nds_on_dat" group="sum" title="Освоение" exclude="1" />
        <fact column="ipr_kap_fact_sum_nds" group="sum" title="Освоение c НДС" table="fin_np" />
        <fact column="ipr_kap_fact_nds" group="sum" title="Освоение НДС" table="fin_np" />
        <fact column="ipr_fin_fact_sum_nds_npr" title="Профинансировано с НДС" group="sum" table="fin" />
        <fact column="ipr_fin_fact_nds_npr" title="Профинансировано НДС" group="sum" table="fin" />
        <fact column="fin_sum_nds_ofz" title="Профинансировано НДС" group="sum" table="fin" />
        <column table="ipr_kod_doc_vvod" column="kod_doc" />
        <column table="kod_doc_type" column="abbr" as="doc_type_abbr" />
        <column table="ipr_kod_doc_vvod" column="doc_num" />
        <column table="ipr_kod_doc_vvod" column="doc_date_c" />
        <fact column="ipr_vvd_fact_sum" title="Ввод без НДС" group="sum" table="fin_vvod" />
        <fact column="ipr_titul_ip_count" group="sum" table="tit_ofz" />
        <fact column="ipr_doc_vvod_count" group="sum" table="tit_ofz" />
      </select>
      <from>
        <qube>
          <where>
            <call function="in" exclude="1">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <array>11387</array>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <dimset as="tit_ofz">
            <where>
              <call function="and">
                <call function="true" />
                <call function="!=0" exclude="1">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="dog">
            <where>
              <call function="and">
                <call function="=1">
                  <column table="kod_dop_contract" column="pr_ofz" />
                </call>
                <call function="or">
                  <call function="=">
                    <useparam name="dog_cond" />
                    <const>3</const>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="dog_cond" />
                      <const>2</const>
                    </call>
                    <call function="is not null">
                      <column table="kod_titul_ip" column="kod_titul_ip" />
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="dog_cond" />
                      <const>1</const>
                    </call>
                    <call function="!=0">
                      <column table="kod_titul_ip" column="pr_ofz" />
                    </call>
                  </call>
                </call>
              </call>
            </where>
            <link name="kod_dop_contract" />
          </dimset>
          <dimset as="smet">
            <where exclude="1">
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="=1">
                  <column table="ipr_pr_last_smet" column="pr_last" />
                </call>
              </call>
            </where>
            <link name="ipr_pr_last_smet" only-for-cond="1" exclude="1" />
          </dimset>
          <dimset as="fin">
            <where>
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
          </dimset>
          <dimset as="fin_np">
            <where>
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
                <call function="!=">
                  <call function="nvl">
                    <column table="ipr_kod_vip_dog" column="kod_dog" />
                    <const>-1</const>
                  </call>
                  <const>-1</const>
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
            <link name="ipr_kod_vip_dog" />
          </dimset>
          <dimset as="fin_vvod">
            <where>
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
            <link name="ipr_kod_doc_vvod">
              <link name="kod_doc_type" />
            </link>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Итого">
          <grset as="tit" title="По титулу" order="npp">
            <group>
              <sourcelink table="kod_titul_ip" />
            </group>
            <grset as="dog" title="Договоры">
              <group>
                <sourcelink table="kod_dop_contract" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_dop_contract" />
                </call>
              </where>
            </grset>
            <grset as="vvod_doc" title="КС14 КС11">
              <group>
                <sourcelink table="ipr_kod_doc_vvod" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_doc" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
      <having exclude="1">
        <call function="and">
          <call function="gt">
            <column table="this" column="ipr_doc_vvod_count" group="sum" />
            <const>0</const>
          </call>
          <call function="gt">
            <column table="this" column="ipr_titul_ip_count" group="sum" />
            <const>0</const>
          </call>
        </call>
      </having>
    </query>
    <query name="35316-2-dat1-def" timestamp="29.02.2016 15:26:11" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-2.xml">
      <select>
        <call function="year begin time" as="val">
          <call function="year">
            <call function="sysdate" />
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="35316-2-dat2-def" timestamp="29.02.2016 15:26:30" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-2.xml">
      <select>
        <call function="sysdate" as="val" />
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="35316-dog-output-cond" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-2.xml">
      <const as="id" type="string">1</const>
      <const as="name" type="string">'Договоры ТП по ОФЗ, привязанные к титулам ОФЗ'</const>
      <const>2</const>
      <const>'Договоры ТП по ОФЗ, привязанные к титулам'</const>
      <const>3</const>
      <const>'Все договоры ТП по ОФЗ'</const>
    </query>
    <query name="35316-3" timestamp="21.11.2016 14:20:55" title="Приложение 3 к соглашению Минэнерго" is-report="1" folder="invpro_ofz" form="35316-3" nogrid="1" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-3.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35316-3.xml" title="Приложение 3 к соглашению Минэнерго" print-proc="2" />
        </excel>
      </print-templates>
      <expressions>
        <call function="over" group="min" as="min_num">
          <call function="min">
            <fact column="ipr_tit_ip_ofz_npp" />
          </call>
          <call function="partition by">
            <column table="ipr_kod_titul_ip" column="kod_ispolnit" />
          </call>
        </call>
      </expressions>
      <select>
        <call function="rownum" as="r" key="1" exclude="1" />
        <column table="kod_ispolnit" column="kod_direct" />
        <call function="date to char" as="sdat" group="max">
          <useparam name="dat" />
        </call>
        <call function="()" as="dat" group="max" type="date">
          <useparam name="dat" />
        </call>
        <call as="npp2" title="№ " function="trim" group="max">
          <call function="to_char">
            <call function="dense_rank">
              <call function="order by 2">
                <column table="ipr_kod_titul_ip" column="kod_ispolnit" exclude="1" />
                <fact column="min_num" />
              </call>
            </call>
            <const>'RM'</const>
          </call>
        </call>
        <column table="kod_ispolnit" column="name" as="isp_name" />
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        <call function="dense_rank" as="npp" title="№" group="max" exclude="1">
          <call function="partition by">
            <column table="ipr_kod_titul_ip" column="kod_ispolnit" />
          </call>
          <call function="order by 2">
            <column table="ipr_kod_titul_ip" column="ofz_npp" />
          </call>
        </call>
        <call function="dense_rank" as="npp1" group="max" title="№">
          <call function="order by 2">
            <column table="ipr_kod_titul_ip" column="ofz_npp" />
            <column table="ipr_kod_titul_ip" column="tit_num_new" />
          </call>
        </call>
        <column table="ipr_kod_titul_ip" column="ofz_npp" as="npp1" title="№" group="min" exclude="1" />
        <column table="ipr_kod_titul_ip" column="name" as="num_name" />
        <column table="pr_ofz" column="name" />
        <fact column="ipr_titul_ip_count" group="sum" />
        <column table="ipr_kod_contr_steps_val" column="kod_contr_steps_val" exclude="1" />
        <column table="kod_template_contr_steps_val" column="abbr" exclude="1" />
        <fact column="ipr_cstep_ep_dat_by_nums" as="dat_1p" group="max" table="seps">
          <withparams>
            <array>'1.9'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_cmnt_by_nums" as="cmnt_1" group="max" table="seps">
          <withparams>
            <array>'1.9'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_dat_by_nums_on_dat" as="dat_1f" group="max" table="seps">
          <withparams>
            <array>'1.9'</array>
            <useparam name="dat" />
          </withparams>
        </fact>
        <fact column="ipr_cstep_ep_dat_by_nums" as="dat_2p" group="max" table="seps">
          <withparams>
            <array>'1.11.1'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_cmnt_by_nums" as="cmnt_2" group="max" table="seps">
          <withparams>
            <array>'1.11.1'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_dat_by_nums_on_dat" as="dat_2f" group="max" table="seps">
          <withparams>
            <array>'1.11.1'</array>
            <useparam name="dat" />
          </withparams>
        </fact>
        <fact column="ipr_cstep_ep_dat_by_nums" as="dat_3p" group="max" table="seps">
          <withparams>
            <array>'2.3','2.4','2.5'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_cmnt_by_nums" as="cmnt_3" group="max" table="seps">
          <withparams>
            <array>'2.3','2.4','2.5'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_dat_by_nums_on_dat" as="dat_3f" group="max" table="seps">
          <withparams>
            <array>'2.3','2.4','2.5'</array>
            <useparam name="dat" />
          </withparams>
        </fact>
        <fact column="ipr_cstep_ep_dat_by_nums" as="dat_4p" group="max" table="seps">
          <withparams>
            <array>'3.5'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_cmnt_by_nums" as="cmnt_4" group="max" table="seps">
          <withparams>
            <array>'3.5'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_dat_by_nums_on_dat" as="dat_4f" group="max" table="seps">
          <withparams>
            <array>'3.5'</array>
            <useparam name="dat" />
          </withparams>
        </fact>
        <fact column="ipr_cstep_ep_dat_by_nums" as="dat_5p" group="max" table="seps">
          <withparams>
            <array>'4.3'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_cmnt_by_nums" as="cmnt_5" group="max" table="seps">
          <withparams>
            <array>'4.3'</array>
          </withparams>
        </fact>
        <fact column="ipr_cstep_ef_dat_by_nums_on_dat" as="dat_5f" group="max" table="seps">
          <withparams>
            <array>'4.3'</array>
            <useparam name="dat" />
          </withparams>
        </fact>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="in" exclude="1">
                <column table="kod_titul_ip" column="tit_num_new" />
                <array>'11135970000','10133351000','11142205600'</array>
              </call>
              <call function="!=0">
                <column table="ipr_kod_titul_ip" column="pr_ofz" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_titul_ip" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <dimset as="seps">
            <where>
              <call function="and">
                <call function="le">
                  <column table="ipr_kod_doc_steps" column="doc_date" />
                  <useparam name="dat" />
                </call>
              </call>
            </where>
            <link name="ipr_kod_doc_steps" />
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="itog" title="Итог">
          <grset as="podr" title="Подразделение" order="npp2">
            <group>
              <sourcelink table="kod_ispolnit" />
            </group>
            <grset title="Титул" as="tit" order="npp1">
              <group>
                <sourcelink table="ipr_kod_titul_ip" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="35316-check1" order="ofz_npp" timestamp="21.11.2016 14:20:57" edit-columns="2" is-report="1" folder="invpro_ofz" inherit="35316-cmn" title="Сверка данных с 1С для ОФЗ" dx-export="1" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-check.xml">
      <content>
        <usefield field="cmn_date" name="dat_dolg" title="Дата учета задолженности" checked="1" mandatory="1">
          <defaultquery>
            <query name="35316-dat-def" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_mp" />
      </content>
      <params exclude="1">
        <param name="mp" type="number">
          <const>-3</const>
        </param>
        <param name="dat_dolg" type="date">
          <const>to_date ('01.01.2016','DD.MM.YYYY')</const>
        </param>
      </params>
      <columns>
        <column name="kod_titul_ip" />
        <column name="dat" />
        <column name="mp" />
        <column name="ofz_npp" agg="no" />
        <column name="isp_name" />
        <column name="tit_num_new" />
        <column name="name" />
        <column name="nzs_color" />
        <column name="dlg_color" />
        <band title="НЗС">
          <column name="nzs_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_nzs" title="1C" />
          <column name="nzs_razn" title="Расхождение" />
        </band>
        <band title="Кредит">
          <column name="kredit_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_dlg" title="1C" />
          <column name="dolg_razn" title="Расхождение" />
        </band>
      </columns>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates exclude="1">
        <excel>
          <template name="35316-2.xml" title="Приложение 2 к соглашению Минэнерго" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <select>
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="()" as="dat" type="date">
          <useparam name="dat_dolg" />
        </call>
        <call function="()" as="mp" type="number">
          <useparam name="mp" />
        </call>
        <column table="kod_titul_ip" column="ofz_npp" title="№" agg="no" format="F0" />
        <column table="kod_ispolnit" column="name" title="Исполнитель" as="isp_name" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_ofz_1c_data_nzs" title="НЗС (1C)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" mp="[:mp]" />
        <call function="-nvl" as="nzs_razn" title="НЗС расх" color="nzs_color" format="{0:n2}">
          <column table="this" column="nzs_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_nzs" />
        </call>
        <fact column="kredit_on_dat" title="Кредит (ИнвестPRO)" nullif="0" color="dlg_color" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_ofz_1c_data_dlg" title="Кредит (1C)" nullif="0" colset="ИнвестPRO" color="dlg_color" format="{0:n2}" mp="[:mp]" />
        <call function="-nvl" as="dolg_razn" title="Кредит расх" color="dlg_color" format="{0:n2}">
          <column table="this" column="kredit_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_dlg" />
        </call>
        <call function="if" as="nzs_color" type="string">
          <call function="!=0">
            <column table="this" column="nzs_razn" />
          </call>
          <use-color color="pink" />
        </call>
        <call function="if" as="dlg_color" type="string">
          <call function="!=0">
            <column table="this" column="dolg_razn" />
          </call>
          <use-color color="pink" />
        </call>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" exclude="1">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <array>20380</array>
              </call>
              <call function="gt">
                <column table="kod_titul_ip" column="pr_ofz" />
                <const>0</const>
              </call>
              <call function="in" optional="1" exclude="1">
                <column table="kod_titul_ip" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
        </qube>
      </from>
      <events>
        <useaction action-type="open-report" call="35316-check1-detail" event-name="double-click">
          <column table="this" column="dat" />
          <column table="this" column="kod_titul_ip" />
          <column table="this" column="mp" />
        </useaction>
      </events>
    </query>
    <query name="35316-check1-detail" order="dat" timestamp="21.11.2016 14:20:58" edit-columns="2" is-report="1" folder="invpro" form="empty" inherit="35316-cmn" title="Сверка данных с 1С для ОФЗ (детализация)" dx-export="1" visible="0" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-check.xml">
      <params>
        <param name="dat_dolg" type="date" />
        <param name="kod_tit" type="number" />
        <param name="mp" type="number" />
        <param name="kod_zatrat" type="number" />
      </params>
      <columns>
        <column name="id" />
        <column name="kod_titul_ip" />
        <column name="tit_num_new" />
        <column name="dat" />
        <band title="Вид затрат">
          <column name="smet_name" title="  " />
          <column name="zatr_name" title="  " />
        </band>
        <band title="Освоение">
          <column name="num_doc" />
          <column name="dat_doc" />
          <column name="ipr_kap_fact_sum" title="без НДС" />
          <column name="ipr_kap_fact_sum_sp" title="списано без НДС" />
          <column name="ipr_kap_fact_sum_nds" title="c НДС (без прочих затрат)" />
        </band>
        <band title="Финансирование">
          <column name="num_rno" />
          <column name="dat_opl" />
          <column name="ipr_fin_fact_sum_nds_npr" title="с НДС" table="fin" />
        </band>
        <band title="Ввод">
          <column name="doc_num" />
          <column name="doc_date_c" />
          <column name="ipr_vvd_fact_sum" title="без НДС" />
        </band>
        <band title="Оборот">
          <column name="nzs" />
          <column name="saldo" />
        </band>
      </columns>
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="ipr_dat" column="val" as="dat" title="Дата операции" format="d" />
        <column table="kod_smet" column="name" as="smet_name" />
        <column table="ipr_kod_zatrat" column="full_name" as="zatr_name" />
        <column table="ipr_kod_vip_dog" column="num_doc" />
        <column table="ipr_kod_vip_dog" column="dat_doc" format="d" />
        <fact column="ipr_kap_fact_sum" title="Освоение без НДС" table="kap" nullif="0" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_kap_fact_sum_sp" title="Освоение списано без НДС" table="kap" nullif="0" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_kap_fact_sum_nds" title="Освоение c НДС" table="kap_np" nullif="0" format="{0:n2}" mp="[:mp]" />
        <column table="ipr_kod_opl_period" column="num_rno" />
        <column table="ipr_kod_opl_period" column="dat_opl" format="d" />
        <fact column="ipr_fin_fact_sum_nds_npr" title="Финансирование с НДС" table="fin" nullif="0" format="{0:n2}" mp="[:mp]" />
        <column table="ipr_kod_doc_vvod" column="doc_num" />
        <column table="ipr_kod_doc_vvod" column="doc_date_c" format="d" />
        <fact column="ipr_vvd_fact_sum" table="vvod" title="Ввод без НДС" nullif="0" format="{0:n2}" mp="[:mp]" />
        <call function="-nvl" as="nzs" title="НЗС" nullif="0">
          <column column="ipr_kap_fact_sum" table="this" />
          <column column="ipr_kap_fact_sum_sp" table="this" />
          <column column="ipr_vvd_fact_sum" table="this" />
        </call>
        <call function="-nvl" title="Кредит" as="saldo" nullif="0">
          <column column="ipr_kap_fact_sum_nds" table="this" />
          <column column="ipr_fin_fact_sum_nds_npr" table="this" />
        </call>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_tit" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_zatrat" column="kodzatrat" />
                <useparam name="kod_zatrat" />
              </call>
              <call function="!=0" exclude="1">
                <column table="kod_titul_ip" column="pr_ofz" />
              </call>
              <call function="lt">
                <column table="ipr_dat" column="val" />
                <useparam name="dat_dolg" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <link name="ipr_dat" />
          <link name="ipr_kod_zatrat">
            <link name="kod_smet" />
          </link>
          <dimset as="vvod">
            <link name="ipr_kod_doc_vvod" />
          </dimset>
          <dimset as="kap">
            <where exclude="1">
              <call function="!=">
                <call function="nvl">
                  <column table="ipr_kod_vip_dog" column="kod_dog" />
                  <const>-1</const>
                </call>
                <const>-1</const>
              </call>
            </where>
            <link name="ipr_kod_vip_dog" />
          </dimset>
          <dimset as="kap_np">
            <where>
              <call function="!=">
                <call function="nvl">
                  <column table="ipr_kod_vip_dog" column="kod_dog" />
                  <const>-1</const>
                </call>
                <const>-1</const>
              </call>
            </where>
            <link name="ipr_kod_vip_dog" />
          </dimset>
          <dimset as="fin">
            <link name="ipr_kod_opl_period" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="35316-check2" order="tit_num_new" timestamp="18.01.2017 20:19:23" edit-columns="2" is-report="1" folder="invpro_ofz" inherit="35316-cmn" title="Сверка данных с 1С" dx-export="1" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-check.xml">
      <content>
        <usefield field="cmn_date" name="dat_dolg" title="Дата учета задолженности" checked="1" mandatory="1">
          <defaultquery>
            <query name="35316-dat-def" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_mp" />
      </content>
      <columns>
        <column name="id" />
        <column name="kod_titul_ip" />
        <column name="dat" />
        <column name="mp" />
        <column name="ofz_npp" agg="no" exclude="1" />
        <column name="isp_name" />
        <column name="tit_num_new" />
        <column name="name" />
        <column name="nzs_color" />
        <column name="dlg_color" exclude="1" />
        <band title="НЗС">
          <column name="nzs_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_nzs" title="1C" />
          <column name="nzs_razn" title="Расхождение" />
        </band>
        <band title="Кредит" exclude="1">
          <column name="kredit_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_dlg" title="1C" />
          <column name="dolg_razn" title="Расхождение" />
        </band>
      </columns>
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="()" as="dat" type="date">
          <useparam name="dat_dolg" />
        </call>
        <call function="()" as="mp" type="number">
          <useparam name="mp" />
        </call>
        <column table="kod_titul_ip" column="ofz_npp" title="№" agg="no" exclude="1" />
        <column table="kod_ispolnit" column="name" title="Исполнитель" as="isp_name" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_1c_data_nzs" title="НЗС (1C)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" as="ipr_ofz_1c_data_nzs" mp="[:mp]" />
        <call function="-nvl" as="nzs_razn" title="НЗС расх" color="nzs_color" format="{0:n2}">
          <column table="this" column="nzs_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_nzs" />
        </call>
        <fact column="kredit_on_dat" title="Кредит (ИнвестPRO)" nullif="0" color="dlg_color" format="{0:n2}" exclude="1" />
        <fact column="ipr_1c_data_nzs" title="НЗС (1C)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" as="ipr_ofz_1c_data_dlg" exclude="1" />
        <call function="-nvl" as="dolg_razn" title="Кредит расх" color="dlg_color" format="{0:n2}" exclude="1">
          <column table="this" column="kredit_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_dlg" />
        </call>
        <call function="if" as="nzs_color" type="string">
          <call function="!=0">
            <column table="this" column="nzs_razn" />
          </call>
          <use-color color="pink" />
        </call>
        <call function="if" as="dlg_color" type="string" exclude="1">
          <call function="!=0">
            <column table="this" column="dolg_razn" />
          </call>
          <use-color color="pink" />
        </call>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_titul_ip" column="pr_ipt_summ_1c" />
              </call>
              <call function="in" exclude="1">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <array>20380</array>
              </call>
              <call function="gt" exclude="1">
                <column table="kod_titul_ip" column="pr_ofz" />
                <const>0</const>
              </call>
              <call function="in" optional="1" exclude="1">
                <column table="kod_titul_ip" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
        </qube>
      </from>
      <events>
        <useaction action-type="open-report" call="35316-check2-detail-zatrat" event-name="double-click">
          <column table="this" column="dat" />
          <column table="this" column="kod_titul_ip" />
          <column table="this" column="mp" />
        </useaction>
      </events>
      <menu>
        <uicommand action-type="open-report" call="35316-check2-detail" title="Детализация НЗС, КЗ по документам ИнвестPRO">
          <column table="this" column="dat" />
          <column table="this" column="kod_titul_ip" />
          <column table="this" column="mp" />
        </uicommand>
        <uicommand action-type="open-report" call="35316-check2-detail-zatrat" title="Детализация по видам затрат">
          <column table="this" column="dat" />
          <column table="this" column="kod_titul_ip" />
          <column table="this" column="mp" />
        </uicommand>
      </menu>
    </query>
    <query name="35316-check2-detail-zatrat" order="tit_num_new" timestamp="21.11.2016 14:20:58" edit-columns="2" is-report="1" folder="invpro_ofz" inherit="35316-cmn" title="Сверка данных с 1С (детализация по видам затрат)" dx-export="1" form="empty" visible="0" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-check.xml">
      <params>
        <param name="dat_dolg" type="date" />
        <param name="kod_tit" type="number" />
        <param name="mp" type="number" />
      </params>
      <columns>
        <column name="id" />
        <column name="kod_titul_ip" />
        <column name="kodzatrat" />
        <column name="dat" />
        <column name="mp" />
        <column name="ofz_npp" agg="no" exclude="1" />
        <column name="isp_name" />
        <column name="tit_num_new" />
        <column name="name" />
        <column name="nzs_color" />
        <column name="dlg_color" exclude="1" />
        <band title="Вид затрат">
          <column name="smet_name" title="  " />
          <column name="zatr_name" title="  " />
        </band>
        <band title="НЗС">
          <column name="nzs_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_nzs" title="1C" />
          <column name="nzs_razn" title="Расхождение" />
        </band>
        <band title="Кредит" exclude="1">
          <column name="kredit_on_dat" title="ИнвестPRO" />
          <column name="ipr_ofz_1c_data_dlg" title="1C" />
          <column name="dolg_razn" title="Расхождение" />
        </band>
      </columns>
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="ipr_kod_zatrat" column="kodzatrat" />
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="()" as="dat" type="date">
          <useparam name="dat_dolg" />
        </call>
        <call function="()" type="number" as="mp">
          <useparam name="mp" />
        </call>
        <column table="kod_titul_ip" column="ofz_npp" title="№" agg="no" exclude="1" />
        <column table="kod_ispolnit" column="name" title="Исполнитель" as="isp_name" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="kod_titul_ip" column="name" />
        <column table="kod_smet" column="name" as="smet_name" />
        <column table="ipr_kod_zatrat" column="full_name" as="zatr_name" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_1c_data_nzs" title="НЗС (1C)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" as="ipr_ofz_1c_data_nzs" mp="[:mp]" />
        <call function="-nvl" as="nzs_razn" title="НЗС расх" color="nzs_color" format="{0:n2}">
          <column table="this" column="nzs_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_nzs" />
        </call>
        <fact column="kredit_on_dat" title="Кредит (ИнвестPRO)" nullif="0" color="dlg_color" format="{0:n2}" exclude="1" />
        <fact column="ipr_1c_data_nzs" title="НЗС (1C)" nullif="0" colset="ИнвестPRO" color="nzs_color" format="{0:n2}" as="ipr_ofz_1c_data_dlg" exclude="1" />
        <call function="-nvl" as="dolg_razn" title="Кредит расх" color="dlg_color" format="{0:n2}" exclude="1">
          <column table="this" column="kredit_on_dat" />
          <column table="this" column="ipr_ofz_1c_data_dlg" />
        </call>
        <call function="if" as="nzs_color" type="string">
          <call function="!=0">
            <column table="this" column="nzs_razn" />
          </call>
          <use-color color="pink" />
        </call>
        <call function="if" as="dlg_color" type="string" exclude="1">
          <call function="!=0">
            <column table="this" column="dolg_razn" />
          </call>
          <use-color color="pink" />
        </call>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_titul_ip" column="pr_ipt_summ_1c" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_tit" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <link name="ipr_kod_zatrat">
            <link name="kod_smet" />
          </link>
        </qube>
      </from>
      <events>
        <useaction action-type="open-report" call="35316-check1-detail" event-name="double-click">
          <column table="this" column="dat" />
          <column table="this" column="kod_titul_ip" />
          <column table="this" column="mp" />
          <column table="this" column="kodzatrat" />
        </useaction>
      </events>
    </query>
    <query name="35316-check2-detail" order="dat" timestamp="19.01.2017 16:57:45" edit-columns="2" is-report="1" folder="invpro" form="empty" inherit="35316-cmn" title="Сверка данных с 1С для (детализация)" dx-export="1" visible="0" comment="копия check1 разные только заголовки" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-check.xml">
      <params>
        <param name="dat_dolg" type="date" />
        <param name="kod_tit" type="number" />
        <param name="mp" type="number" />
        <param name="kod_zatrat" type="number" />
      </params>
      <columns>
        <column name="id" />
        <column name="kod_titul_ip" />
        <column name="tit_num_new" />
        <column name="dat" />
        <band title="Вид затрат">
          <column name="smet_name" title="  " />
          <column name="zatr_name" title="  " />
        </band>
        <column name="schet_name" />
        <band title="Освоение">
          <column name="num_doc" />
          <column name="dat_doc" />
          <column name="ipr_kap_fact_sum" title="без НДС" />
          <column name="ipr_kap_fact_sum_sp" title="списано без НДС" />
          <column name="ipr_kap_fact_sum_nds" title="c НДС (без прочих затрат)" />
        </band>
        <band title="Финансирование">
          <column name="num_rno" />
          <column name="dat_opl" />
          <column name="ipr_fin_fact_sum_nds_npr" title="с НДС" table="fin" />
        </band>
        <band title="Ввод">
          <column name="doc_num" />
          <column name="doc_date_c" />
          <column name="ipr_vvd_fact_sum" title="без НДС" />
        </band>
        <band title="Оборот">
          <column name="nzs" />
          <column name="saldo" />
        </band>
      </columns>
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="ipr_dat" column="val" as="dat" title="Дата операции" format="d" />
        <column table="kod_smet" column="name" as="smet_name" />
        <column table="ipr_kod_zatrat" column="full_name" as="zatr_name" />
        <column table="ipr_kod_schet" column="name" as="schet_name" title="Счет" />
        <column table="ipr_kod_vip_dog" column="kod_vip_dog" />
        <column table="ipr_kod_vip_dog" column="num_doc" />
        <column table="ipr_kod_vip_dog" column="dat_doc" format="d" />
        <fact column="ipr_kap_fact_sum" title="Освоение без НДС" table="kap" nullif="0" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_kap_fact_sum_sp" title="Освоение списано без НДС" table="kap" nullif="0" format="{0:n2}" mp="[:mp]" />
        <fact column="ipr_kap_fact_sum_nds" title="Освоение c НДС" table="kap_np" nullif="0" format="{0:n2}" mp="[:mp]" />
        <column table="ipr_kod_opl_period" column="kod_opl_period" />
        <column table="ipr_kod_opl_period" column="num_rno" />
        <column table="ipr_kod_opl_period" column="dat_opl" format="d" />
        <fact column="ipr_fin_fact_sum_nds_npr" title="Финансирование с НДС" table="fin" nullif="0" format="{0:n2}" mp="[:mp]" />
        <column table="ipr_kod_doc_vvod" column="doc_num" />
        <column table="ipr_kod_doc_vvod" column="doc_date_c" format="d" />
        <fact column="ipr_vvd_fact_sum" table="vvod" title="Ввод без НДС" nullif="0" format="{0:n2}" mp="[:mp]" />
        <call function="-nvl" as="nzs" title="НЗС" nullif="0">
          <column column="ipr_kap_fact_sum" table="this" />
          <column column="ipr_kap_fact_sum_sp" table="this" />
          <column column="ipr_vvd_fact_sum" table="this" />
        </call>
        <call function="-nvl" title="Кредит" as="saldo" nullif="0">
          <column column="ipr_kap_fact_sum_nds" table="this" />
          <column column="ipr_fin_fact_sum_nds_npr" table="this" />
        </call>
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_tit" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_zatrat" column="kodzatrat" />
                <useparam name="kod_zatrat" />
              </call>
              <call function="!=0" exclude="1">
                <column table="kod_titul_ip" column="pr_ofz" />
              </call>
              <call function="lt">
                <column table="ipr_dat" column="val" />
                <useparam name="dat_dolg" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <link name="ipr_dat" />
          <link name="ipr_kod_zatrat">
            <link name="kod_smet" />
          </link>
          <dimset as="vvod">
            <link name="ipr_kod_doc_vvod" />
          </dimset>
          <dimset as="kap">
            <where exclude="1">
              <call function="!=">
                <call function="nvl">
                  <column table="ipr_kod_vip_dog" column="kod_dog" />
                  <const>-1</const>
                </call>
                <const>-1</const>
              </call>
            </where>
            <link name="ipr_kod_vip_dog" />
            <link name="ipr_kod_schet" />
          </dimset>
          <dimset as="kap_np">
            <where>
              <call function="!=">
                <call function="nvl">
                  <column table="ipr_kod_vip_dog" column="kod_dog" />
                  <const>-1</const>
                </call>
                <const>-1</const>
              </call>
            </where>
            <link name="ipr_kod_vip_dog" />
            <link name="ipr_kod_schet" />
          </dimset>
          <dimset as="fin">
            <link name="ipr_kod_opl_period" />
            <link name="ipr_kod_schet" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="35316-colsets" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <const as="id" type="string">'ИнвестPRO'</const>
      <const as="name" type="string">'ИнвестPRO'</const>
      <const as="pr" type="number">0</const>
      <const>'1С'</const>
      <const>'1С'</const>
      <const>1</const>
    </query>
    <query name="35316-colsets-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <params>
        <param name="pr_1c" type="number" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="35316-colsets" as="a" />
      </from>
      <where>
        <call function="=">
          <call function="nvlu">
            <useparam name="pr_1c" />
            <const>0</const>
          </call>
          <column table="a" column="pr" />
        </call>
      </where>
    </query>
    <query name="35316" timestamp="13.12.2016 01:43:36" title="Приложение 1 к соглашению Минэнерго" edit-columns="2" is-report="1" folder="invpro_ofz" form="35316" inherit="35316-cmn" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35316.xml" title="Приложение 1 к соглашению Минэнерго" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <select>
        <call function="date to char" as="sdat" group="max">
          <useparam name="dat" />
        </call>
        <call function="date to char" as="sdatdolg" group="max">
          <useparam name="dat_dolg" />
        </call>
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="dense_rank" as="npp" group="max" title="№">
          <call function="order by 2">
            <column table="kod_titul_ip" column="ofz_npp" />
            <column table="kod_titul_ip" column="tit_num_new" />
          </call>
        </call>
        <column table="kod_titul_ip" column="ofz_npp" as="npp1" title="№" exclude="1" />
        <column table="kod_titul_ip" column="name" as="num_name" />
        <column table="kod_titul_ip" column="tit_num_new" />
        <column table="pr_ofz" column="name" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" group="sum" nullif="0" colset="ИнвестPRO" />
        <const as="nzs_on_dat_1c" type="number" title="НЗС (1C)" colset="1С" group="sum">null</const>
        <fact column="kredit_on_dat" title="Кредит" group="sum" nullif="0" />
        <column table="kod_ispolnit" column="name" as="kod_ispolnit_name" />
        <fact column="ipr_last_tit_doc" group="max" as="kod_doc29" title=" ">
          <withparams>
            <const>29</const>
          </withparams>
        </fact>
        <column table="ipr_doc29" column="doc_num" group="max" as="doc_num29" title="Номер приказа" />
        <column table="ipr_doc29" column="doc_date_c" group="max" as="doc_date_c29" title="Дата приказа" />
        <fact column="ipr_last_tit_doc" group="max" as="kod_doc141" title=" ">
          <withparams>
            <const>141</const>
          </withparams>
        </fact>
        <column table="ipr_doc141" column="doc_num" group="max" as="doc_num141" title="Номер заключения" />
        <column table="ipr_doc141" column="doc_date_c" group="max" as="doc_date_c141" title="Дата заключения" />
        <column table="ipr_kod_doc" column="kod_doc" title="kod_doc1" exclude="1" />
        <column table="ipr_kod_doc" column="kod_doc_type" exclude="1" />
        <column table="ipr_kod_doc" column="doc_num" exclude="1" />
        <column table="ipr_kod_doc" column="doc_date_c" exclude="1" />
        <fact column="smet_sum_nds" title="Сметная стоимость с НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum" title="Сметная стоимость без НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum_nds_np" title="Сметная стоимость с НДС" group="sum" table="smet" nullif="0" />
        <fact column="smet_sum_np" title="Сметная стоимость без НДС" group="sum" table="smet" nullif="0" />
        <fact column="ipr_doc_count" table="doc" group="sum" exclude="1" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_dop_contract" column="num_ad_pref_no_dat" as="num_ad" />
        <column table="kod_dop_contract" column="dt_contract" />
        <fact table="dog" column="is_dop_cont_count" group="sum" />
        <fact column="ipr_titul_ip_count" group="sum" />
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="in" exclude="1">
                <column table="kod_titul_ip" column="tit_num_new" />
                <array>'11135970000','10133351000','11142205600'</array>
              </call>
              <call function="!=0">
                <column table="kod_titul_ip" column="pr_ofz" />
              </call>
              <call function="in" optional="1">
                <column table="kod_titul_ip" column="pr_ofz" />
                <useparam name="kod_ofz" />
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <dimset as="doc" exclude="1">
            <where>
              <call function="in">
                <column table="ipr_kod_doc" column="kod_doc_type" />
                <array>141,29</array>
              </call>
            </where>
            <link name="ipr_kod_doc" />
          </dimset>
          <dimset as="dog">
            <where>
              <call function="=1">
                <column table="kod_dop_contract" column="pr_ofz" />
              </call>
            </where>
            <link name="kod_dop_contract" />
          </dimset>
          <dimset as="smet">
            <where exclude="1">
              <call function="=1">
                <column table="ipr_pr_last_smet" column="pr_last" />
              </call>
            </where>
            <link name="ipr_pr_last_smet" exclude="1" />
          </dimset>
        </qube>
        <query name="ipr_doc" join="left outer" as="ipr_doc29">
          <call function="=">
            <column table="this" column="kod_doc29" />
            <column table="ipr_doc29" column="kod_doc" />
          </call>
        </query>
        <query name="ipr_doc" join="left outer" as="ipr_doc141">
          <call function="=">
            <column table="this" column="kod_doc141" />
            <column table="ipr_doc141" column="kod_doc" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="and" optional="1">
            <call function="is not null">
              <column table="this" column="kod_doc29" />
            </call>
            <call function="=1">
              <useparam name="pr_psd" />
            </call>
          </call>
        </call>
      </where>
      <grouping>
        <grset as="all" title="Итого">
          <grset as="tit" title="По титулу" order="npp">
            <group>
              <sourcelink table="kod_titul_ip" />
            </group>
            <grset as="doc1" title="Приказы" exclude="1">
              <group>
                <sourcelink table="ipr_kod_doc" />
              </group>
              <where>
                <call function="=">
                  <column table="this" column="kod_doc_type" />
                  <const>29</const>
                </call>
              </where>
            </grset>
            <grset as="doc2" title="Закючения" exclude="1">
              <group>
                <sourcelink table="ipr_kod_doc" />
              </group>
              <where>
                <call function="=">
                  <column table="this" column="kod_doc_type" />
                  <const>141</const>
                </call>
              </where>
            </grset>
            <grset as="dog" title="Договоры">
              <group>
                <sourcelink table="kod_dop_contract" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_dop_contract" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="35316-dat-def" timestamp="17.03.2016 01:51:54" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <select>
        <const type="date" as="val">DATE'2016-01-01'</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="35316-cmn" timestamp="17.10.2017 01:43:55" edit-columns="2" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <expressions>
        <call function="=1" as="last_smet">
          <column table="ipr_pr_last_smet" column="pr_last" />
        </call>
        <call function="=" as="used_version">
          <column table="ipr_kod_doc_main" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
        <call function="if" as="saldo_on_dat" group="sum">
          <call function="lt">
            <column table="ipr_dat" column="val" />
            <useparam name="dat_dolg" />
          </call>
          <fact column="ipr_sld_fact_sum_nds" />
        </call>
        <call function="if" as="nzs_on_dat" group="sum">
          <call function="lt">
            <column table="ipr_dat" column="val" />
            <useparam name="dat_dolg" />
          </call>
          <fact column="ipr_nzs_fact_sum" />
        </call>
        <call as="saldo_on_dat_by_ipr" function="over" group="sum">
          <call function="sum">
            <fact column="saldo_on_dat" />
          </call>
          <call function="partition by">
            <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <call as="saldo_on_dat_by_dog" function="over" group="sum">
          <call function="sum">
            <fact column="saldo_on_dat" />
          </call>
          <call function="partition by">
            <column table="ipr_kod_vip_dog" column="kod_vip_dog" />
            <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <call function="if" as="kredit_on_dat" group="sum">
          <call function="gt">
            <fact column="saldo_on_dat_by_dog" exclude="1" />
            <call function="over">
              <call function="sum">
                <fact column="saldo_on_dat" />
              </call>
              <call function="partition by">
                <column table="ipr_kod_dog" column="kod_dog" />
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </call>
            <const>0</const>
          </call>
          <fact column="saldo_on_dat" />
        </call>
        <call function="if" as="smet_sum" group="sum">
          <call function="=">
            <useparam name="tekfix" />
            <const>'Текущая'</const>
          </call>
          <fact column="smet_sum_tek" condition="last_smet" />
          <fact column="smet_sum_fix" condition="used_version" />
        </call>
        <call function="if" as="smet_sum_nds" group="sum">
          <call function="=">
            <useparam name="tekfix" />
            <const>'Текущая'</const>
          </call>
          <fact column="smet_sum_nds_tek" condition="last_smet" />
          <fact column="smet_sum_nds_fix" condition="used_version" />
        </call>
        <call function="if" as="smet_sum_np" group="sum">
          <call function="=">
            <useparam name="tekfix" />
            <const>'Текущая'</const>
          </call>
          <fact column="smet_sum_np_tek" condition="last_smet" />
          <fact column="smet_sum_np_fix" condition="used_version" />
        </call>
        <call function="if" as="smet_sum_nds_np" group="sum">
          <call function="=">
            <useparam name="tekfix" />
            <const>'Текущая'</const>
          </call>
          <fact column="smet_sum_nds_np_tek" condition="last_smet" />
          <fact column="smet_sum_nds_np_fix" condition="used_version" />
        </call>
        <call as="utvpsd_titul_tek" function="over" group="sum">
          <call function="sum">
            <fact column="ipr_smet_summ_utvpsd_tek" />
          </call>
          <call function="partition by">
            <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <call function="if" as="smet_sum_nds_tek" group="sum">
          <call function="gt">
            <fact column="utvpsd_titul_tek" />
            <const>0</const>
          </call>
          <fact column="ipr_smet_summ_nds_utvpsd_tek" />
          <fact column="ipr_smet_summ_nds_usr_tek" />
        </call>
        <call function="if" as="smet_sum_tek" group="sum">
          <call function="gt">
            <fact column="utvpsd_titul_tek" />
            <const>0</const>
          </call>
          <fact column="ipr_smet_summ_utvpsd_tek" />
          <fact column="ipr_smet_summ_usr_tek" />
        </call>
        <call function="if" as="smet_sum_nds_np_tek" group="sum">
          <call function="!=nvl">
            <column table="ipr_kod_smet_sub" column="kod_smet" />
            <const>6</const>
          </call>
          <fact column="smet_sum_nds_tek" />
        </call>
        <call function="if" as="smet_sum_np_tek" group="sum">
          <call function="!=nvl">
            <column table="ipr_kod_smet_sub" column="kod_smet" />
            <const>6</const>
          </call>
          <fact column="smet_sum_tek" />
        </call>
        <call as="utvpsd_titul_fix" function="over" group="sum">
          <call function="sum">
            <fact column="ipr_smet_summ_utvpsd" />
          </call>
          <call function="partition by">
            <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <call function="if" as="smet_sum_nds_fix" group="sum">
          <call function="gt">
            <fact column="utvpsd_titul_fix" />
            <const>0</const>
          </call>
          <fact column="ipr_smet_summ_nds_utvpsd" />
          <fact column="ipr_smet_summ_nds_usr" />
        </call>
        <call function="if" as="smet_sum_fix" group="sum">
          <call function="gt">
            <fact column="utvpsd_titul_fix" />
            <const>0</const>
          </call>
          <fact column="ipr_smet_summ_utvpsd" />
          <fact column="ipr_smet_summ_usr" />
        </call>
        <call function="if" as="smet_sum_nds_np_fix" group="sum">
          <call function="!=nvl">
            <column table="ipr_kod_smet_sub" column="kod_smet" />
            <const>6</const>
          </call>
          <fact column="smet_sum_nds_fix" />
        </call>
        <call function="if" as="smet_sum_np_fix" group="sum">
          <call function="!=nvl">
            <column table="ipr_kod_smet_sub" column="kod_smet" />
            <const>6</const>
          </call>
          <fact column="smet_sum_fix" />
        </call>
      </expressions>
    </query>
    <query name="35316-test" timestamp="03.02.2017 03:02:24" title="Приложение 1 к соглашению Минэнерго" edit-columns="2" is-report="1" folder="invpro_ofz" form="35316" nogrid="1" visible="0" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <params>
        <param name="dat_dolg">
          <const>to_date('28.10.2015','DD.MM.YYYY')</const>
        </param>
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35316.xml" title="Приложение 1 к соглашению Минэнерго" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <select>
        <column table="kod_titul_ip" column="kod_titul_ip" group="1" />
        <column table="ipr_dat" column="val" as="dd" group="1" exclude="1" />
        <column table="ipr_kod_vip_dog" column="kod_dog" group="1" exclude="1" />
        <fact column="kredit_on_dat" title="Кредит" nullif="0" group="sum" exclude="1" />
        <fact column="saldo_on_dat" group="sum" exclude="1" />
        <fact column="ipr_kap_fact_sum_nds" group="sum" exclude="1" />
        <fact column="ipr_fin_fact_sum_nds" group="sum" />
        <fact column="ipr_fin_fact_sum_nds_npr" title="Профинансировано с НДС" group="sum" />
        <fact column="ipr_fin_fact_sum_nds_b" group="sum" />
        <fact column="ipr_fin_fact_sum_nds_pri_b" group="sum" />
        <fact column="ipr_fin_fact_sum_nds_per_b" group="sum" />
        <fact column="ipr_kap_fact_sum_nds_pr" group="sum" exclude="1" />
      </select>
      <from>
        <qube>
          <where>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <array>11387</array>
              </call>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip" />
          <link name="ipr_dat" />
        </qube>
      </from>
    </query>
    <query name="35316-test2" timestamp="03.02.2017 12:32:16" title="Приложение 1 к соглашению Минэнерго" edit-columns="2" is-report="1" folder="invpro_ofz" form="35316" inherit="35316-cmn" nogrid="1" visible="0" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <expressions>
        <call function="if" as="fin_sum_nds_ofz" group="sum">
          <call function="=">
            <column table="ipr_kod_opl_period" column="pr_ofz" />
            <const>1</const>
          </call>
          <fact column="ipr_fin_fact_sum_nds_npr" />
        </call>
      </expressions>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35316-2.xml" title="Приложение 2 к соглашению Минэнерго" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <select>
        <call function="date to char" as="sdat" group="max" exclude="1">
          <useparam name="dat" />
        </call>
        <call function="date to char" as="sdatdolg" group="max" exclude="1">
          <useparam name="dat_dolg" />
        </call>
        <call function="date to char" as="sdat1" group="max" exclude="1">
          <useparam name="dat1" />
        </call>
        <call function="date to char" as="sdat2" group="max" exclude="1">
          <useparam name="dat2" />
        </call>
        <call function="dense_rank" as="npp" group="max" title="№" exclude="1">
          <call function="order by 2">
            <column table="kod_titul_ip" column="kod_titul_ip" />
          </call>
        </call>
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <call function="dense_rank" as="npp" title="№" exclude="1">
          <call function="order by 2">
            <column table="kod_titul_ip" column="ofz_npp" />
            <column table="kod_titul_ip" column="tit_num_new" />
          </call>
        </call>
        <column table="kod_titul_ip" column="ofz_npp" as="npp" title="№" exclude="1" />
        <column table="kod_titul_ip" column="name" as="num_name" exclude="1" />
        <column table="pr_ofz" column="name" exclude="1" />
        <fact column="nzs_on_dat" title="НЗС (ИнвестPRO)" nullif="0" colset="ИнвестPRO" table="tit_ofz" exclude="1" />
        <const as="nzs_on_dat_1c" type="number" title="НЗС (1C)" colset="1С" group="sum" exclude="1">null</const>
        <fact column="kredit_on_dat" title="Кредит" nullif="0" table="tit_ofz" exclude="1" />
        <column table="kod_ispolnit" column="name" as="kod_ispolnit_name" exclude="1" />
        <fact column="smet_sum_nds" title="Сметная стоимость с НДС" table="smet" nullif="0" exclude="1" />
        <fact column="smet_sum" title="Сметная стоимость без НДС" table="smet" nullif="0" exclude="1" />
        <fact column="smet_sum_nds_np" title="Сметная стоимость с НДС" table="smet" nullif="0" exclude="1" />
        <fact column="smet_sum_np" title="Сметная стоимость без НДС" table="smet" nullif="0" exclude="1" />
        <column table="kod_dop_contract" column="kod_dop_contract" exclude="1" />
        <column table="kod_dop_contract" column="num_ad_pref_no_dat" as="num_ad" exclude="1" />
        <column table="kod_dop_contract" column="dt_contract" exclude="1" />
        <column table="kod_dop_contract" column="isp_info" as="dog_ofz_name" exclude="1" />
        <fact table="dog" column="is_dop_cont_count" exclude="1" />
        <fact column="kap_sum_nds_on_dat" title="Освоение" exclude="1" />
        <fact column="ipr_kap_fact_sum_nds" title="Освоение c НДС" table="fin_np" />
        <fact column="ipr_kap_fact_nds" title="Освоение НДС" table="fin_np" />
        <fact column="ipr_fin_fact_sum_nds_npr" title="Профинансировано с НДС" table="fin" />
        <fact column="ipr_fin_fact_sum_nds" title="Профинансировано с НДС" table="fin" />
        <fact column="ipr_kap_fact_sum_nds_pr" table="fin" />
        <fact column="ipr_fin_fact_nds_npr" title="Профинансировано НДС" table="fin" />
        <fact column="fin_sum_nds_ofz" title="Профинансировано НДС" table="fin" />
        <column table="ipr_kod_doc_vvod" column="kod_doc" exclude="1" />
        <column table="kod_doc_type" column="abbr" as="doc_type_abbr" exclude="1" />
        <column table="ipr_kod_doc_vvod" column="doc_num" exclude="1" />
        <column table="ipr_kod_doc_vvod" column="doc_date_c" exclude="1" />
        <fact column="ipr_vvd_fact_sum" title="Ввод без НДС" table="fin_vvod" exclude="1" />
        <fact column="ipr_titul_ip_count" table="tit_ofz" exclude="1" />
        <fact column="ipr_doc_vvod_count" table="tit_ofz" exclude="1" />
      </select>
      <from>
        <qube>
          <where>
            <call function="in">
              <column table="kod_titul_ip" column="kod_titul_ip" />
              <array>11387</array>
            </call>
          </where>
          <link name="ipr_kod_titul_ip" as="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="pr_ofz" />
          </link>
          <dimset as="tit_ofz">
            <where>
              <call function="and">
                <call function="true" />
                <call function="!=0" exclude="1">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="dog">
            <where exclude="1">
              <call function="and">
                <call function="=1">
                  <column table="kod_dop_contract" column="pr_ofz" />
                </call>
                <call function="or">
                  <call function="=">
                    <useparam name="dog_cond" />
                    <const>3</const>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="dog_cond" />
                      <const>2</const>
                    </call>
                    <call function="is not null">
                      <column table="kod_titul_ip" column="kod_titul_ip" />
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="dog_cond" />
                      <const>1</const>
                    </call>
                    <call function="!=0">
                      <column table="kod_titul_ip" column="pr_ofz" />
                    </call>
                  </call>
                </call>
              </call>
            </where>
            <link name="kod_dop_contract" />
          </dimset>
          <dimset as="smet">
            <where exclude="1">
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="=1">
                  <column table="ipr_pr_last_smet" column="pr_last" />
                </call>
              </call>
            </where>
            <link name="ipr_pr_last_smet" only-for-cond="1" exclude="1" />
          </dimset>
          <dimset as="fin">
            <where exclude="1">
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
          </dimset>
          <dimset as="fin_np">
            <where exclude="1">
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
                <call function="!=">
                  <call function="nvl">
                    <column table="ipr_kod_vip_dog" column="kod_dog" />
                    <const>-1</const>
                  </call>
                  <const>-1</const>
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
            <link name="ipr_kod_vip_dog" />
          </dimset>
          <dimset as="fin_vvod">
            <where exclude="1">
              <call function="and">
                <call function="!=0">
                  <column table="kod_titul_ip" column="pr_ofz" />
                </call>
                <call function="le">
                  <column table="ipr_dat" column="val" />
                  <useparam name="dat2" />
                </call>
              </call>
            </where>
            <link name="ipr_dat" />
            <link name="ipr_kod_doc_vvod">
              <link name="kod_doc_type" />
            </link>
          </dimset>
        </qube>
      </from>
      <grouping exclude="1">
        <grset as="all" title="Итого">
          <grset as="tit" title="По титулу" order="npp">
            <group>
              <sourcelink table="kod_titul_ip" />
            </group>
            <grset as="dog" title="Договоры">
              <group>
                <sourcelink table="kod_dop_contract" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_dop_contract" />
                </call>
              </where>
            </grset>
            <grset as="vvod_doc" title="КС14 КС11">
              <group>
                <sourcelink table="ipr_kod_doc_vvod" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_doc" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="38486" timestamp="17.05.2017 15:34:26" inherit="35316-cmn" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <params>
        <usepart part="38486-params" />
      </params>
      <expressions>
        <call function="in" as="vidz_sod" dontpushpred="1">
          <column table="ipr_kod_zatrat" column="kodzatrat" />
          <array>99</array>
        </call>
        <call function="()" type="number" group="sum" as="dog_cost_sod">
          <fact column="ipr_fin_dog_cost_pr_sum" condition="vidz_sod" />
        </call>
        <call function="le" as="do_god" dontpushpred="1">
          <call function="year">
            <column table="ipr_dat" column="val" />
          </call>
          <call function="year">
            <useparam name="dat" />
          </call>
        </call>
        <call function="=" as="tek_god" dontpushpred="1">
          <call function="year">
            <column table="ipr_dat" column="val" />
          </call>
          <call function="year">
            <useparam name="dat" />
          </call>
        </call>
        <call function="lt" as="pred_god" dontpushpred="1">
          <call function="year">
            <column table="ipr_dat" column="val" />
          </call>
          <call function="year">
            <useparam name="dat" />
          </call>
        </call>
        <call function="le" as="do_dat" dontpushpred="1">
          <column table="ipr_dat" column="val" />
          <useparam name="dat" />
        </call>
        <call function="ge" as="dog_tek" dontpushpred="1">
          <call function="year">
            <column table="ipr_kod_dog" column="dat_udal" />
          </call>
          <call function="year">
            <useparam name="dat" />
          </call>
        </call>
        <call function="lt" as="dog_pred" dontpushpred="1">
          <call function="year">
            <column table="ipr_kod_dog" column="dat_udal" />
          </call>
          <call function="year">
            <useparam name="dat" />
          </call>
        </call>
        <call function="!=nvl" as="is_ofz" dontpushpred="1">
          <column table="ipr_kod_titul_ip" column="pr_ofz" />
          <const>0</const>
        </call>
        <call function="=nvl" as="is_not_ofz" dontpushpred="1">
          <column table="ipr_kod_titul_ip" column="pr_ofz" />
          <const>0</const>
        </call>
        <call function="=1" as="last_smet">
          <column table="ipr_pr_last_smet" column="pr_last" />
        </call>
        <call function="()" as="sum_k_rasp_tek" type="number" group="sum">
          <fact column="ipr_smet_summ_k_rasp_tek" condition="last_smet" />
        </call>
        <call function="if" as="sum_k_rasp" type="number" group="sum">
          <call function="=">
            <useparam name="tekfix" />
            <const>'Текущая'</const>
          </call>
          <fact column="sum_k_rasp_tek" />
          <fact column="ipr_smet_summ_k_rasp" />
        </call>
        <call function="()" as="kap_sum_do_god" type="number" group="sum">
          <fact column="ipr_kap_fact_sum" condition="do_god" />
        </call>
        <call function="()" as="kap_sum_do_dat" type="number" group="sum">
          <fact column="ipr_kap_fact_sum" condition="do_dat" />
        </call>
        <call function="()" as="kap_sum_nds_do_god" type="number" group="sum">
          <fact column="ipr_kap_fact_sum_nds" condition="do_god" />
        </call>
        <call function="if" as="dog_sum_a" type="number" group="sum">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="is_bez_nds" />
            </call>
          </call>
          <fact column="dog_sum" />
          <fact column="dog_sum_nds_a" />
        </call>
        <call function="if" as="dog_sum" type="number" group="sum">
          <call function="in">
            <column table="ipr_kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <fact column="kap_sum_do_god" />
          <fact column="ipr_vid_zatr_plan_cost" />
        </call>
        <call function="if" as="dog_sum_nds_a" type="number" group="sum">
          <call function="in">
            <column table="ipr_kod_dog" column="status" />
            <array>4,12,27,13</array>
          </call>
          <fact column="kap_sum_nds_do_god" />
          <fact column="ipr_vid_zatr_plan_cost_nds" />
        </call>
        <call function="()" as="dog_sum_pred" type="number" group="sum">
          <fact column="dog_sum_a" condition="dog_pred" />
        </call>
        <call function="()" as="dog_sum_tek" type="number" group="sum">
          <fact column="dog_sum_a" condition="dog_tek" />
        </call>
        <call function="()" as="dog_sum_nds_pred" type="number" group="sum" exclude="1">
          <fact column="dog_sum_nds_a" condition="dog_pred" />
        </call>
        <call function="()" as="dog_sum_nds_tek" type="number" group="sum" exclude="1">
          <fact column="dog_sum_nds_a" condition="dog_tek" />
        </call>
        <call function="()" as="kap_sum_pred" type="number" group="sum">
          <fact column="kap_sum_do_dat" condition="pred_god" />
        </call>
        <call function="()" as="kap_sum_tek" type="number" group="sum">
          <fact column="kap_sum_do_dat" condition="tek_god" />
        </call>
        <call function="()" as="mba_ofz" type="number" group="sum">
          <fact column="ipr_fin_pow_mba_ft_dt" condition="is_ofz" />
        </call>
        <call function="()" as="mba_not_ofz" type="number" group="sum">
          <fact column="ipr_fin_pow_mba_ft_dt" condition="is_not_ofz" />
        </call>
        <call function="()" as="usr_ofz" type="number" group="sum">
          <fact column="ipr_smet_summ_usr_tek" condition="is_ofz" />
        </call>
        <call function="()" as="usr_not_ofz" type="number" group="sum">
          <fact column="ipr_smet_summ_usr_tek" condition="is_not_ofz" />
        </call>
      </expressions>
      <select>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="ipr_kod_smet" column="kod_smet" />
        <column table="ipr_kod_dog" column="kod_dog" />
        <column table="kod_titul_ip" column="kod_titul_ip" />
        <column table="kod_titul_ip_par" column="kod_titul_ip" as="kod_titul_ip_par" />
        <column table="kod_titul_ip_sbor" column="kod_titul_ip" as="kod_titul_ip_sbor" />
        <column table="kod_titul_ip" column="tit_num_new_n" as="tit_num" />
        <column table="kod_titul_ip" column="name" as="tit_name" />
        <column table="kod_ispolnit" column="name_kr" as="isp" />
        <column table="kod_titul_ip_par" column="tit_num_new_n" as="tit_par_num" />
        <column table="kod_titul_ip_par" column="name" as="tit_par_name" />
        <column table="kod_ispolnit_par" column="name_kr" as="isp_par" />
        <column table="kod_titul_ip_sbor" column="tit_num_new_n" as="tit_sbor_num" />
        <column table="kod_titul_ip_sbor" column="name" as="tit_sbor_name" />
        <column table="kod_ispolnit_sbor" column="name_kr" as="isp_sbor" />
        <column table="pr_ofz" column="name" as="ofz" />
        <column table="ipr_kod_vip_dog" column="kod_vip_dog" />
        <column table="ipr_kod_vip_dog" column="dat_doc" />
        <column table="ipr_kod_dog" column="name_unig_dog" as="num_dog" />
        <column table="ipr_kod_dog" column="predm_dog" />
        <column table="ipr_kod_dog" column="dat_dog" />
        <column table="ipr_kod_dog" column="dat_udal" />
        <column table="e_code" column="name_all" as="name_contr" />
        <column table="status" column="name" as="status_dog" />
        <column table="kod_tip_dog" column="name" as="tip_dog" />
        <column table="ipr_kod_dog_i" column="kod_dog_i" />
        <fact column="is_dop_cont_sel_pos_name" group="max" as="selpos" />
        <fact column="is_dop_cont_nasp_name" group="max" as="nasp" />
        <fact column="is_dop_contract_name_r" group="max" as="rayon" />
        <call function="substr" as="itip" group="max">
          <column table="kod_ipr" column="itip" />
          <const>0</const>
          <const>1</const>
        </call>
        <fact column="mba_ofz" group="sum" mp="3" />
        <fact column="mba_not_ofz" group="sum" mp="3" />
        <fact column="ipr_smet_summ_usr" group="sum" table="ks" mp="[:mp]" exclude="1" />
        <fact column="usr_ofz" table="smet1" group="sum" mp="[:mp]" />
        <fact column="usr_not_ofz" table="smet1" group="sum" mp="[:mp]" />
        <fact column="ipr_smet_summ_k_rasp_psd" group="sum" table="ks" mp="[:mp]" exclude="1" />
        <fact column="smet_sum_nds" title="Сметная стоимость с НДС" nullif="0" table="smet" group="sum" mp="[:mp]" />
        <fact column="smet_sum" title="Сметная стоимость без НДС" nullif="0" table="smet" group="sum" mp="[:mp]" />
        <fact column="smet_sum_nds_np" title="Сметная стоимость с НДС" nullif="0" table="smet" group="sum" mp="[:mp]" />
        <fact column="smet_sum_np" title="Сметная стоимость без НДС" nullif="0" table="smet" group="sum" mp="[:mp]" />
        <fact column="dog_cost_sod" group="sum" table="ks" mp="[:mp]" />
        <fact column="ipr_last_tit_doc" group="max" as="kod_doc29" title=" ">
          <withparams>
            <const>29</const>
          </withparams>
        </fact>
        <column table="ipr_doc29" column="doc_num" group="max" as="doc_num29" title="Номер приказа" />
        <column table="ipr_doc29" column="doc_date_c" group="max" as="doc_date_c29" title="Дата приказа" />
        <fact column="ipr_last_tit_doc" group="max" as="kod_doc141" title=" ">
          <withparams>
            <const>141</const>
          </withparams>
        </fact>
        <column table="ipr_doc141" column="doc_num" group="max" as="doc_num141" title="Номер заключения" />
        <column table="ipr_doc141" column="doc_date_c" group="max" as="doc_date_c141" title="Дата заключения" />
        <fact column="sum_k_rasp" group="sum" table="ks" as="smet" colset="Фиксированная" title="1" mp="[:mp]" />
        <fact column="sum_k_rasp" group="sum" dimname="sm" table="ks" as="smet_by_vid" colset="Фиксированная" title="3" mp="[:mp]">
          <pivot title=" в разрезе сметы">
            <call function="=">
              <column table="this" column="kod_smet" />
              <column table="dim" column="kod_smet" />
            </call>
            <query order="kod_smet">
              <select>
                <column table="ips_smet" column="kod_smet" />
                <column table="ips_smet" column="name" />
              </select>
              <from>
                <query name="ips_smet_structure" as="ips_smet" />
              </from>
              <where>
                <call function="and">
                  <call function="lt">
                    <column table="ips_smet" column="kod_smet" />
                    <const>5</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </fact>
        <fact table="dog" column="dog_sum_a" as="dog_cost_sum" group="sum" colset="сумма договора без НДС" title="сумма договора без НДС" mp="[:mp]" />
        <fact table="dog" column="dog_sum_a" as="dog_cost_sum_by_vid" dimname="sm" group="sum" colset="сумма договора без НДС" title="сумма договора без НДС" mp="[:mp]" />
        <call function="" as="dog_cost_sum_key" type="number" group="sum" colset="сумма договора без НДС" title="сумма договора без НДС" mp="[:mp]">
          <const>null</const>
        </call>
        <fact table="dog" column="dog_sum_pred" group="sum" colset="сумма договора без НДС" title="сумма договора без НДС" mp="[:mp]" />
        <fact table="dog" column="dog_sum_tek" group="sum" colset="сумма договора без НДС" title="сумма договора без НДС" mp="[:mp]" />
        <fact table="kap" column="kap_sum_do_dat" group="sum" mp="[:mp]" />
        <fact table="kap" column="kap_sum_do_dat" group="sum" as="kap_sum_by_smet" dimname="sm" mp="[:mp]" />
        <fact table="kap" column="kap_sum_pred" group="sum" mp="[:mp]" />
        <fact table="kap" column="kap_sum_tek" group="sum" mp="[:mp]" />
        <fact table="kap" column="kap_sum_pred" group="sum" as="kap_sum_by_god" dimname="god" mp="[:mp]">
          <pivot title=" по годам">
            <call function="=">
              <call function="year">
                <column table="this" column="dat_doc" />
              </call>
              <column table="dim" column="god" />
            </call>
            <query order="god">
              <select>
                <column table="a" column="god" />
                <column table="a" column="god" as="name" />
                <column table="a" column="summ" />
              </select>
              <from>
                <query name="38486-kap_years" as="a">
                  <withparams>
                    <usepart part="38486-withparams" />
                  </withparams>
                </query>
              </from>
            </query>
          </pivot>
        </fact>
        <fact table="kap" column="kap_sum_tek" group="sum" as="kap_sum_by_mon" dimname="mon" mp="[:mp]">
          <pivot title=" по месяцам">
            <call function="=">
              <call function="month">
                <column table="this" column="dat_doc" />
              </call>
              <column table="dim" column="mon" />
            </call>
            <query order="mon">
              <select>
                <column table="a" column="mon" />
                <column table="a" column="name" />
              </select>
              <from>
                <query name="spr_time_mes" as="a" />
              </from>
              <where>
                <call function="le">
                  <column table="a" column="mon" />
                  <call function="month">
                    <useparam name="dat" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </fact>
      </select>
      <from>
        <qube merge-dimsets="1">
          <dimset as="smet">
            <where exclude="1">
              <call function="=1">
                <column table="ipr_pr_last_smet" column="pr_last" />
              </call>
            </where>
            <link name="ipr_pr_last_smet" exclude="1" />
            <link name="ipr_kod_smet" />
          </dimset>
          <dimset as="smet1">
            <where>
              <call function="=1">
                <column table="ipr_pr_last_smet" column="pr_last" />
              </call>
            </where>
            <link name="ipr_pr_last_smet" />
            <link name="ipr_kod_smet" />
          </dimset>
          <dimset as="ks">
            <link name="ipr_kod_smet" />
          </dimset>
          <dimset as="dog">
            <link name="ipr_kod_dog">
              <link name="e_code" />
              <link name="kod_tip_dog" />
              <link name="status" />
            </link>
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_dog_i" />
            <where>
              <call function="is not null">
                <column table="ipr_kod_dog" column="kod_dog" />
              </call>
              <call function="in">
                <column table="ipr_kod_dog" column="status" />
                <array>0,1,4,12,27,13</array>
              </call>
              <call function="is not null">
                <column table="ipr_kod_dog_i" column="kod_dog_i" />
              </call>
            </where>
          </dimset>
          <dimset as="kap">
            <link name="ipr_kod_dog" />
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_vip_dog" />
            <link name="ipr_kod_dog_i" />
            <where>
              <call function="is not null">
                <column table="ipr_kod_dog" column="kod_dog" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_dog_i" column="kod_dog_i" />
              </call>
              <call function="in">
                <column table="ipr_kod_dog" column="status" />
                <array>0,1,4,12,27,13</array>
              </call>
            </where>
          </dimset>
          <link name="kod_ipr">
            <link name="kod_main_titul" />
            <link name="kod_parent" as="kod_titul_ip_par">
              <link name="kod_ispolnit" as="kod_ispolnit_par" />
              <link name="kod_parent_sbor" as="kod_titul_ip_sbor">
                <link name="kod_ispolnit" as="kod_ispolnit_sbor" />
              </link>
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
          </link>
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_titul_ip_sbor" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip_par" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
          </where>
        </qube>
        <query name="ipr_doc" join="left outer" as="ipr_doc29">
          <call function="=">
            <column table="this" column="kod_doc29" />
            <column table="ipr_doc29" column="kod_doc" />
          </call>
        </query>
        <query name="ipr_doc" join="left outer" as="ipr_doc141">
          <call function="=">
            <column table="this" column="kod_doc141" />
            <column table="ipr_doc141" column="kod_doc" />
          </call>
        </query>
      </from>
      <grouping>
        <grset as="sbor" title="Сборный">
          <group>
            <sourcelink table="kod_titul_ip_sbor" />
          </group>
          <grset as="sbor_vis" title="Сборный вывод">
            <where>
              <call function="is not null">
                <column table="this" column="kod_titul_ip_sbor" />
              </call>
            </where>
          </grset>
          <grset as="par" title="Головной">
            <group>
              <sourcelink table="kod_titul_ip_par" />
            </group>
            <grset as="par_vis" title="Головной вывод">
              <where>
                <call function="is not null">
                  <column table="this" column="kod_titul_ip_par" />
                </call>
              </where>
            </grset>
            <grset as="sc" title="Одиночный/дочерний">
              <group>
                <sourcelink table="kod_titul_ip" />
              </group>
              <where>
                <call function="and">
                  <call function="is not null">
                    <column table="this" column="kod_titul_ip" />
                  </call>
                  <call function="in">
                    <column table="this" column="itip" />
                    <array>'О','Д'</array>
                  </call>
                </call>
              </where>
              <grset as="dog" title="Договор">
                <group>
                  <sourcelink table="ipr_kod_dog" />
                </group>
                <where>
                  <call function="and">
                    <call function="is not null">
                      <column table="this" column="kod_dog" />
                    </call>
                    <call function="is not null">
                      <column table="this" column="kod_dog_i" />
                    </call>
                  </call>
                </where>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="38486-gr" timestamp="30.11.2016 17:20:42" title="Отчет для департамента строительного контроля" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <params>
        <usepart part="38486-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="38486" as="a">
          <withparams>
            <usepart part="38486-withparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="38486-kap_years" timestamp="29.11.2016 12:27:20" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <params>
        <usepart part="38486-params" />
      </params>
      <select>
        <call function="year" as="god" group="1">
          <column table="a" column="dat_doc" />
        </call>
        <column table="a" column="kap_sum_pred" group="sum" as="summ" />
      </select>
      <from>
        <query name="38486" as="a" nogrouping="1">
          <withparams>
            <usepart part="38486-withparams" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="this" column="summ" />
          </call>
        </call>
      </where>
    </query>
    <query name="38486-title" timestamp="02.12.2016 18:11:35" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <params>
        <usepart part="38486-params" />
      </params>
      <select>
        <call function="year" as="year">
          <useparam name="dat" />
        </call>
        <call function="+" as="year_nxt">
          <call function="year">
            <useparam name="dat" />
          </call>
          <const>1</const>
        </call>
        <column table="a" column="name" as="mp_name" />
        <call function="if" type="string" as="nds_name">
          <call function="or">
            <call function="false" />
            <call function="=1" optional="1">
              <useparam name="is_bez_nds" />
            </call>
          </call>
          <const>'без НДС'</const>
          <const>'с НДС'</const>
        </call>
      </select>
      <from>
        <query name="26630-mp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_mp" />
          <useparam name="mp" />
        </call>
      </where>
    </query>
    <query name="39463" timestamp="03.05.2018 15:16:51" is-report="1" with-behavior="1" title="Коды титулов по условиям" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" visible="0" />
        </fieldgroup>
        <usefield field="cmn_combo_num" name="god_info" title="Год Х раскрытия информации" column-mandatory="1">
          <listquery>
            <query name="39463-years-list" />
          </listquery>
          <defaultquery>
            <query name="39463-ipr-year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов вместо Факта" />
        <usefield field="cmn_check" title="Использование Лимитов и Приростов физ. характеристик вместо Плана" name="use_fiz_limits">
          <defaultquery>
            <query name="one" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="use_fiz_limits_ft" title="Использование Лимитов и Приростов физ. характеристик вместо Факта" />
        <fieldgroup title="Не формировать паспорта ИП с нулевыми данными">
          <usefield field="cmn_check" name="pr_not_null" title="Применить" />
          <usefield field="ipr_ym" name="not_null_ym1" title="С" mandatory="pr_not_null" editable="pr_not_null">
            <defaultquery>
              <query name="spr_time_ym2_beg_year" />
            </defaultquery>
          </usefield>
          <usefield field="ipr_ym" name="not_null_ym2" title="По" mandatory="pr_not_null" editable="pr_not_null">
            <defaultquery>
              <query name="spr_time_ym2_cur" />
            </defaultquery>
          </usefield>
        </fieldgroup>
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=0">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_sbor_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_main_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-1" timestamp="26.04.2018 21:41:06" is-report="1" with-behavior="1" title="Коды титулов по условиям 2" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev">
              <withparams>
                <useparam name="kod_doc" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" />
          <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
          <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
            <defaultquery>
              <query name="39463-doc-type-default" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_check" title="Заполнить поле &quot;Текущая стадия реализации ИП&quot;" name="fill_cur_stage_ip" />
        </fieldgroup>
        <usefield field="cmn_check" name="output_xml" title="Вывод отчёта в хml-формате" column-editable="0" />
        <usefield field="cmn_check" name="replace_existed" title="Заменить существующие" />
        <usefield field="ipr_passport_doc_control" />
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" visible="kod_doc_kontr" visible-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=0">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_sbor_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_main_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-data-for-report" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <column table="a" column="kod" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="39463-data-for-report" as="a" view="1" />
      </from>
    </query>
    <query name="39463-kod-doc-corr-visible" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="data_for_report" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <useparam name="data_for_report" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-doc-type-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="data_for_report" type="number" />
      </params>
      <select>
        <call function="case" as="val" type="number">
          <call function="when">
            <call function="=">
              <useparam name="data_for_report" />
              <const>1</const>
            </call>
            <const>470</const>
          </call>
          <call function="when">
            <call function="=">
              <useparam name="data_for_report" />
              <const>2</const>
            </call>
            <const>902</const>
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-ipr-year-message" timestamp="13.10.2017 14:57:50" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <call function="||" as="val" type="string">
          <const>'Год N = году ИПР '</const>
          <call function="to_char">
            <column table="a" column="god_ip" />
          </call>
        </call>
      </select>
      <from>
        <table name="ipr_doc" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-data-for-report-default" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <const type="number" as="val">1</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-2" timestamp="08.11.2018 19:21:10" is-report="1" with-behavior="1" title="Паспорт ИП" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
        <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
          <defaultquery>
            <query name="39463-doc-type-default" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" editable="kod_doc_kontr" visible="1" editable-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="dual" column="dummy" />
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="39463-ipr-year" timestamp="16.10.2017 16:41:53" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <column table="a" column="god_ip" as="val" />
      </select>
      <from>
        <table name="ipr_doc" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-years-list" timestamp="13.10.2017 15:32:00" order="god desc" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <column table="a" column="god" key="1" />
        <call function="to_char" as="name" title="Год">
          <column table="a" column="god" />
        </call>
      </select>
      <from>
        <query name="is_god" as="a" />
      </from>
      <where>
        <call function="lt">
          <column table="a" column="god" />
          <const>3000</const>
        </call>
      </where>
    </query>
    <query name="39463-goriz_plan-default" timestamp="11.12.2017 15:20:49" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <const type="number" as="val">5</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-3" timestamp="26.04.2018 21:41:06" is-report="1" with-behavior="1" title="Коды титулов по условиям 3" visible="0" comment="41356(14)" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_titul_ip_head" name="kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev">
              <withparams>
                <useparam name="kod_doc" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" />
          <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
          <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
            <defaultquery>
              <query name="39463-doc-type-default" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_check" title="Заполнить поле &quot;Текущая стадия реализации ИП&quot;" name="fill_cur_stage_ip" />
        </fieldgroup>
        <usefield field="cmn_check" name="output_xml" title="Вывод отчёта в хml-формате" column-editable="0" />
        <usefield field="cmn_check" name="replace_existed" title="Заменить существующие" />
        <usefield field="ipr_passport_doc_control" />
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" visible="kod_doc_kontr" visible-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=1">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-god_x-default" timestamp="11.12.2017 15:22:36" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <const type="number" as="val">0</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-4" timestamp="25.02.2019 13:56:25" is-report="1" with-behavior="1" title="Массовое копирование титулов" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc_new" column-mandatory="1" title="Версия ИПР (источник данных) " />
        <usefield field="ipr_kod_doc_new" column-mandatory="1" title="Версия ИПР (получатель данных)" name="kod_doc_target">
          <listquery>
            <query name="39463-ipr_version_adv" />
          </listquery>
          <defaultquery>
            <query name="39463-ipr_version_project" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_direct" title="Подразделение (источник данных)" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" title="Заказчик/Исполнитель (источник данных)">
          <defaultquery>
            <query name="is_spr_dirisp_isp_1" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_str" title="Статус титула (получатель данных)" name="kod_status_tit" type="number">
          <listquery>
            <query name="ipv_status_tit" />
          </listquery>
        </usefield>
        <usefield field="cmn_check" name="only_aip_flag" title="Только титулы АИП" type="number" />
        <usefield field="ipr_kod_titul_ip_plain" />
      </content>
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" title="kod_ipr " />
        <column table="ipr_ipr_data" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <query name="ipr_ipr_data">
          <link name="kod_titul_ip">
            <link name="kod_direct" exclude="1" />
            <link name="kod_ispolnit" exclude="1" />
            <link name="kod_subject" as="kod_subject1" exclude="1" />
          </link>
          <link name="kod_razdel" exclude="1" />
          <link name="kod_parent" exclude="1">
            <link name="kod_parent_sbor" />
          </link>
          <link name="kod_main_titul" exclude="1">
            <link name="kod_subject" />
          </link>
        </query>
        <query name="ipr_ipr_data" as="ipr_ipr_data_target" join="left outer">
          <call function="and">
            <call function="=">
              <column table="ipr_ipr_data" column="kod_titul_ip" />
              <column table="ipr_ipr_data_target" column="kod_titul_ip" />
            </call>
            <call function="=">
              <column table="ipr_ipr_data_target" column="kod_doc_osn" />
              <useparam name="kod_doc_target" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in" optional="1">
            <column table="ipr_ipr_data" column="kod_ipr" />
            <useparam name="kod_titul_ip" />
          </call>
          <call function="!=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Сборный'</const>
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=" optional="1">
            <column table="kod_titul_ip" column="kod_aip" />
            <useparam name="only_aip_flag" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
          </call>
          <call function="is null">
            <column table="ipr_ipr_data_target" column="kod_ipr" />
          </call>
        </call>
      </where>
    </query>
    <query name="39463-ipr_version" timestamp="17.09.2018 17:44:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
        <column table="ipv_ipr_version" column="full_name" vid="1" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
    </query>
    <query name="39463-ipr_version_active" timestamp="17.09.2018 17:51:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipv_ipr_version" column="status_name" />
            <const>'Утвержденная ИПР'</const>
          </call>
          <call function="=">
            <call function="rownum" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="39463-ipr_version_adv" timestamp="17.09.2018 18:00:57" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
        <column table="ipv_ipr_version" column="full_name" vid="1" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="!=">
          <column table="ipv_ipr_version" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-ipr_version_project" timestamp="17.09.2018 18:03:20" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipv_ipr_version" column="status_name" />
            <const>'Проект'</const>
          </call>
          <call function="=">
            <call function="rownum" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="39463-tituls_plain" timestamp="25.02.2019 13:56:25" with-behavior="1" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <params>
        <param name="kod_doc" type="number">
          <const>143403</const>
        </param>
        <param name="kod_doc_target" type="number" />
        <param name="kod_direct" type="array" />
        <param name="kod_dirisp" type="number" />
        <param name="only_aip_flag" type="number" />
      </params>
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" />
        <column table="kod_titul_ip" column="tit_num_new" title="Код титула" />
        <column table="ipr_ipr_data" column="name" />
        <call function="if" as="itip" vid="1" title="Тип" type="string">
          <call function="=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Одиночный/Дочерний'</const>
          </call>
          <call function="if">
            <call function="gt">
              <column table="ipr_ipr_data" column="kod_parent" />
              <const>0</const>
            </call>
            <const>'Дочерний'</const>
            <const>'Одиночный'</const>
          </call>
          <column table="kod_titul_ip" column="itip" />
        </call>
        <column table="kod_direct" column="name" as="direct_name" title="Подразделение заказчика" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" title="Подразделение исполнителя" />
        <call function="nvl" type="string" as="subject_name">
          <column table="kod_subject" column="name" as="subject_name" />
          <column table="kod_subject1" column="name" as="subject_name" />
        </call>
        <column table="kod_parent" column="tit_num_new" title="Код головного титула" as="tit_num_new_h" />
        <column table="kod_parent_sbor" column="tit_num_new" title="Код сборного титула" as="tit_num_new_s" />
        <column table="ipr_ipr_data_target" column="kod_ipr" as="kod_ipr_t" title="kod_ipr_tqqq" exclude="1" />
      </select>
      <from>
        <query name="ipr_ipr_data">
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
            <link name="kod_subject" as="kod_subject1" />
          </link>
          <link name="kod_razdel" />
          <link name="kod_parent">
            <link name="kod_parent_sbor" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" />
          </link>
        </query>
        <query name="ipr_ipr_data" as="ipr_ipr_data_target" join="left outer">
          <call function="and">
            <call function="=">
              <column table="ipr_ipr_data" column="kod_titul_ip" />
              <column table="ipr_ipr_data_target" column="kod_titul_ip" />
            </call>
            <call function="=">
              <column table="ipr_ipr_data_target" column="kod_doc_osn" />
              <useparam name="kod_doc_target" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Сборный'</const>
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=" optional="1">
            <column table="kod_titul_ip" column="kod_aip" />
            <useparam name="only_aip_flag" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
          </call>
          <call function="is null">
            <column table="ipr_ipr_data_target" column="kod_ipr" />
          </call>
        </call>
      </where>
    </query>
    <query name="qry_39463_2" timestamp="22.05.2017 12:54:32" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463_2.xml">
      <params>
        <param name="p_kod_ipr" type="number">
          <const>61105</const>
        </param>
      </params>
      <select>
        <column table="kod_ipr" column="kod_ipr" />
        <fact column="ipr_smet_summ_k_rasp_fnt" as="fix_smet" />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" />
          <link name="ipr_pr_last_smet" />
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_ipr" />
                <useparam name="p_kod_ipr" />
              </call>
              <call function="=1">
                <column table="ipr_pr_last_smet" column="pr_last" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="qry_39463_3" timestamp="22.05.2017 12:57:10" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463_2.xml">
      <params>
        <param name="p_kod_ipr" type="number">
          <const>55253</const>
        </param>
      </params>
      <select>
        <column table="kod_ipr" column="kod_ipr" />
        <column table="ipr_kod_doc_smet" column="kod_doc" />
        <fact column="ipr_smet_summ_k_rasp_fnt" as="fix_smet" />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" />
          <link name="ipr_kod_doc_smet" />
          <link name="ipr_pr_last_smet" />
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_ipr" column="kod_ipr" />
                <useparam name="p_kod_ipr" />
              </call>
              <call function="=1">
                <column table="ipr_pr_last_smet" column="pr_last" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="!=0">
          <column table="this" column="fix_smet" />
        </call>
      </where>
    </query>
    <query name="39589-1" class="1" timestamp="01.03.2017 10:55:44" is-report="1" visible="0" title="Анализ привязки актов к бух счетам" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39589.xml">
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <column table="a" column="kod_ip" as="kod_titul_ip" />
        <column table="kod_ip" column="tit_num_new" />
        <column table="a" column="kod_vip_dog" />
        <column table="a" column="num_doc" />
        <column table="a" column="dat_doc" />
        <column table="kod_dog" column="name_unig_dog" title="Номер подр. логовора" />
        <column table="kod_smet" column="name" title="Вид затрат(группа)" />
        <column table="kodzatrat" column="abbr" title="Вид затрат(номер)" />
        <column table="kodzatrat" column="name" as="name_zatr" title="Вид затрат(наименование)" />
        <column table="kodzatrat" column="name_kr" title="Вид затрат(кратко)" />
        <column table="buh_akt_vip_dog_2" column="name_vid_zatrat" title="Вид затрат(интеграционная таблица)" />
        <column table="a" column="vsego" title="Сумма освоения с НДС" />
        <column table="kod_schet" column="name" title="Номер счета (справочник видов затрат)" as="schet1" />
        <column table="buh_akt_vip_dog_2" column="name" as="schet2" title="Номер счета (интеграционная таблица)" />
      </select>
      <from>
        <query name="isv_ip_vip_dog_for_plan" as="a">
          <link name="kod_smet" />
          <link name="kod_ip">
            <elink name="vv_ipr_ipr_data_extra">
              <link name="kod_ipr_ext" as="ipr_ipr_data" />
            </elink>
          </link>
          <link name="kod_vip_dog">
            <link name="kod_vip_dog_ip" exclude="1">
              <link name="kodzatrat">
                <link name="kod_schet" />
              </link>
              <link name="buh_akt_vip_dog_2" />
            </link>
            <link name="kod_dog" />
          </link>
          <link name="kodzatrat">
            <link name="kod_schet" />
          </link>
          <link name="buh_akt_vip_dog_2" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="is null">
            <column table="kod_smet" column="kod_parent" />
          </call>
        </call>
      </where>
    </query>
    <query name="40796" timestamp="06.03.2017 21:18:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\40796.xml">
      <select>
        <column table="ipr_kod_titul_ip" column="tit_num_new" />
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        <fact column="ipr_kap_fact_sum" />
        <fact column="ipr_kap_fact_sum_a" />
        <fact column="ipr_kap_fact_sum_pri" />
        <fact column="ipr_kap_fact_sum_per" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_titul_ip" />
          <link name="ipr_dat" />
          <where>
            <call function="lt">
              <column table="ipr_dat" column="val" />
              <const>DATE'2016-01-01'</const>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="41354" timestamp="05.05.2017 10:59:26" is-report="1" with-behavior="1" title="Паспорт ИП" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\41354.xml">
      <!--<print-templates>
        <excel>
          <template name="26630.xlsx" title="Отчет по исполнителю" print-xlsx="1" print-proc="2" del-cols="1" output-format="xlsb" />
        </excel>
      </print-templates>-->
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_passport_doc_control" />
        <usefield field="cmn_check" name="replace_existed" title="Заменить существующие" />
      </content>
      <select>
        <column table="dual" column="dummy" />
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="generator_ipr" is-report="1" title="ИПР Сводный (демо)" params-customization="1" allow-save="1" edit-columns="1" form="frm_generator_ipr" add-names="1" autobands="1" folder="invpro" timestamp="21.11.2016 14:21:00" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\generator.xml">
      <customers>
        <customer id="17" />
      </customers>
      <columns>
        <column name="doc_osn_fname" title="Год ИПР/Документ" />
        <column name="ym" title="Период" />
        <band title="Вид затрат">
          <band title="Вид">
            <column name="smet_num" title="Номер" />
            <column name="smet_name" title="Наименование" />
          </band>
          <band title="Подвид">
            <column name="vidzatrat_abbr" title="Номер" />
            <column name="vidzatrat_name" title="Наименование" />
          </band>
        </band>
        <band title="Подразделение">
          <column name="direct_name" title="Заказчик" />
          <column name="ispolnit_name" title="Исполнитель" />
        </band>
        <band title="Титул">
          <band title="Сборный">
            <column name="sbor_tit_num_new" title="Код" />
            <column name="sbor_tit_name" title="Наименование" />
          </band>
          <band title="Головной">
            <column name="parent_tit_num_new" title="Код" />
            <column name="parent_tit_name" title="Наименование" />
          </band>
          <band title="Головной/Одиночный">
            <column name="main_tit_num_new" title="Код" />
            <column name="main_tit_name" title="Наименование" />
            <band title="Субъект федерации">
              <column name="subject_name" title="Наименование" />
              <column name="subject_abbr" title="Аббревиатура" />
            </band>
          </band>
          <band title="Одиночный/Дочерний">
            <column name="tit_num_new" title="Код" />
            <column name="tit_name" title="Наименование" />
            <column name="priority_name" title="Степень важности" />
          </band>
          <band title="Дочерний">
            <column name="child_tit_num_new" title="Код" />
            <column name="child_tit_name" title="Наименование" />
          </band>
        </band>
        <band title="Раздел">
          <column name="razdel_root_fname" title="Наименование раздела первого уровня" />
          <column name="razdel_fname" title="Наименование раздела" />
        </band>
        <band title="Сметная стоимость">
          <band title="Текущая">
            <band title="УРС">
              <column name="summ_usr_tek" title="без НДС" />
              <column name="summ_nds_usr_tek" title="c НДС" />
              <band title="-10 %">
                <column name="summ_10_usr_tek" title="без НДС" />
                <column name="summ_10_nds_usr_tek" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_30_usr_tek" title="без НДС" />
                <column name="summ_30_nds_usr_tek" title="с НДС" />
              </band>
            </band>
            <band title="ПСД">
              <column name="summ_psd_tek" title="без НДС" />
              <column name="summ_nds_psd_tek" title="c НДС" />
              <band title="-10 %">
                <column name="summ_psd_10_tek" title="без НДС" />
                <column name="summ_nds_psd_10_tek" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_psd_30_tek" title="без НДС" />
                <column name="summ_nds_psd_30_tek" title="с НДС" />
              </band>
            </band>
            <band title="Утвержденная ПСД">
              <column name="summ_utvpsd_tek" title="без НДС" />
              <column name="summ_nds_utvpsd_tek" title="c НДС" />
            </band>
          </band>
          <band title="Фисированная">
            <band title="УРС">
              <column name="summ_usr" title="без НДС" />
              <column name="summ_nds_usr" title="c НДС" />
              <band title="-10 %">
                <column name="summ_10_usr" title="без НДС" />
                <column name="summ_10_nds_usr" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_30_usr" title="без НДС" />
                <column name="summ_30_nds_usr" title="с НДС" />
              </band>
            </band>
            <band title="ПСД">
              <column name="summ_psd" title="без НДС" />
              <column name="summ_nds_psd" title="c НДС" />
              <band title="-10 %">
                <column name="summ_psd_10" title="без НДС" />
                <column name="summ_nds_psd_10" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_psd_30" title="без НДС" />
                <column name="summ_nds_psd_30" title="с НДС" />
              </band>
            </band>
            <band title="Утвержденная ПСД">
              <column name="summ_utvpsd" title="без НДС" />
              <column name="summ_nds_utvpsd" title="c НДС" />
            </band>
          </band>
        </band>
        <band title="План">
          <band title="На начало периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_beg" />
              <column title="НДС" name="fp_nds_beg" />
              <column title="c НДС" name="fp_sum_nds_beg" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_beg" />
              <column title="НДС" name="kap_nds_beg" />
              <column title="c НДС" name="kap_sum_nds_beg" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_beg" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_itog_beg" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_itog_beg" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_itog_beg" />
            </band>
          </band>
          <band title="За отчетный период">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_per" />
              <column title="НДС" name="fp_nds_per" />
              <column title="c НДС" name="fp_sum_nds_per" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_per" />
              <column title="НДС" name="kap_nds_per" />
              <column title="c НДС" name="kap_sum_nds_per" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_per" />
            </band>
          </band>
          <band title="По выделенным периодам">
            <band title="Финансирование">
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="fp_sum_nds_by_per" />
              </band>
              <band title="cНДС">
                <column title="[Период]" dimension="period" name="fp_nds_by_per" />
              </band>
            </band>
            <band title="Освоение">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="kap_sum_by_per" />
              </band>
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="kap_sum_nds_by_per" />
              </band>
            </band>
            <band title="Ввод">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="vvod_sum_by_per" />
              </band>
            </band>
          </band>
          <band title="На конец периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_end" />
              <column title="НДС" name="fp_nds_end" />
              <column title="c НДС" name="fp_sum_nds_end" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_end" />
              <column title="НДС" name="kap_nds_end" />
              <column title="c НДС" name="kap_sum_nds_end" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_end" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_itog_end" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_itog_end" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_itog_end" />
            </band>
          </band>
        </band>
        <band title="Факт">
          <band title="На начало периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_beg" />
              <column title="НДС" name="fp_nds_fact_beg" />
              <column title="c НДС" name="fp_sum_nds_fact_beg" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_beg" />
              <column title="НДС" name="kap_nds_fact_beg" />
              <column title="c НДС" name="kap_sum_nds_fact_beg" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_beg" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_fact_itog_beg" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_fact_itog_beg" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_fact_itog_beg" />
            </band>
          </band>
          <band title="За отчетный период">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_per" />
              <column title="НДС" name="fp_nds_fact_per" />
              <column title="c НДС" name="fp_sum_nds_fact_per" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_per" />
              <column title="НДС" name="kap_nds_fact_per" />
              <column title="c НДС" name="kap_sum_nds_fact_per" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_per" />
            </band>
          </band>
          <band title="По выделенным периодам">
            <band title="Финансирование">
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="fp_sum_nds_fact_by_per" />
              </band>
              <band title="cНДС">
                <column title="[Период]" dimension="period" name="fp_nds_fact_by_per" />
              </band>
            </band>
            <band title="Освоение">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="kap_sum_fact_by_per" />
              </band>
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="kap_sum_nds_fact_by_per" />
              </band>
            </band>
            <band title="Ввод">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="vvod_sum_fact_by_per" />
              </band>
            </band>
          </band>
          <band title="На конец периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_end" />
              <column title="НДС" name="fp_nds_fact_end" />
              <column title="c НДС" name="fp_sum_nds_fact_end" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_end" />
              <column title="НДС" name="kap_nds_fact_end" />
              <column title="c НДС" name="kap_sum_nds_fact_end" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_end" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_fact_itog_end" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_fact_itog_end" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_fact_itog_end" />
            </band>
          </band>
        </band>
      </columns>
      <columnspreset />
      <select>
        <column table="ym" column="name" group="1" as="ym" />
        <column table="kod_smet" column="name" group="1" as="smet_name" />
        <column table="kod_smet" column="kod_smet" group="1" as="smet_num" />
        <column table="kodzatrat" column="abbr" group="1" as="vidzatrat_abbr" />
        <column table="kodzatrat" column="name" group="1" as="vidzatrat_name" />
        <column table="kod_doc_osn" column="full_name" title="Год ИПР/Документ" group="1" as="doc_osn_fname" />
        <column table="kod_priority" column="name" group="1" as="priority_name" />
        <column table="kod_subject" column="name" group="1" as="subject_name" />
        <column table="kod_subject" column="abbr" group="1" as="subject_abbr" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" group="1" />
        <column table="kod_direct" column="name" as="direct_name" group="1" />
        <column table="kod_titul_ip" column="tit_num_new" group="1" />
        <column table="kod_titul_ip" column="full_name" group="1" as="tit_name" />
        <column table="kod_parent" column="tit_num_new" as="parent_tit_num_new" group="1" />
        <column table="kod_parent" column="full_name" group="1" as="parent_tit_name" />
        <column table="kod_main_titul" column="tit_num_new" as="main_tit_num_new" group="1" />
        <column table="kod_main_titul" column="full_name" group="1" as="main_tit_name" />
        <column table="kod_child_titul" column="tit_num_new" as="child_tit_num_new" group="1" />
        <column table="kod_child_titul" column="full_name" group="1" as="child_tit_name" />
        <column table="kod_parent_sbor" column="tit_num_new" group="1" as="sbor_tit_num_new" />
        <column table="kod_parent_sbor" column="full_name" group="1" as="sbor_tit_name" />
        <column table="razdel_root" column="full_name" as="razdel_root_fname" group="1" title="{+} первого уровня" />
        <column table="kod_razdel" column="full_name" as="razdel_fname" group="1" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="period">
          <if pfx="_per">
            <call function="and">
              <call function="true" />
              <call function="ge" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym1" />
              </call>
              <call function="le" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym2" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="beg">
          <if pfx="_beg">
            <call function="or">
              <call function="false" />
              <call function="lt" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym1" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="end">
          <if pfx="_end">
            <call function="or">
              <call function="false" />
              <call function="le" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym2" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="debet_itog" group="sum" as="debet_itog_beg" title="{+} на начало периода" if="beg_sect">
          <section>
            <call function="ym2 add month">
              <call function="nvlu">
                <useparam name="ym1" />
                <call function="nativity_ym2" />
              </call>
              <const>-1</const>
            </call>
          </section>
        </column>
        <column table="ipr_fin_body_united" column="kredit_itog" group="sum" as="kredit_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="nzs_itog" group="sum" as="nzs_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="debet_itog" group="sum" as="debet_itog_end" title="{+} на конец периода" if="end_sect">
          <section>
            <call function="nvlu">
              <useparam name="ym2" />
              <call function="doomsday_ym2" />
            </call>
          </section>
        </column>
        <column table="ipr_fin_body_united" column="kredit_itog" group="sum" as="kredit_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="nzs_itog" group="sum" as="nzs_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" dimname="period">
          <pivot title=" по периодам" pfx="_by_per">
            <call function="between">
              <column table="ipr_fin_body_united" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="kod" />
                <column table="a" column="full_name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="ipr_time_intervals" as="a">
                  <withparams>
                    <useparam name="ym1" />
                    <useparam name="ym2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="or">
                  <call function="false" />
                  <call function="in" optional="1">
                    <column table="a" column="kod" />
                    <useparam name="time_interval" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" dimname="period">
          <pivot title=" по периодам" pfx="_by_per">
            <call function="between">
              <column table="ipr_fin_body_united" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="kod" />
                <column table="a" column="full_name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="ipr_time_intervals" as="a">
                  <withparams>
                    <useparam name="ym1" />
                    <useparam name="ym2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="or">
                  <call function="false" />
                  <call function="in" optional="1">
                    <column table="a" column="kod" />
                    <useparam name="time_interval" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="debet_fact_itog" group="sum" as="debet_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="kredit_fact_itog" group="sum" as="kredit_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="nzs_fact_itog" group="sum" as="nzs_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="debet_fact_itog" group="sum" as="debet_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kredit_fact_itog" group="sum" as="kredit_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="nzs_fact_itog" group="sum" as="nzs_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="summ_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_utvpsd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_utvpsd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_30" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_10" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_30" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_10" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_utvpsd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_utvpsd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_30_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_10_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_30_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_10_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_nds_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_nds_usr_tek" group="sum" />
      </select>
      <from>
        <query name="ipr_fin_body_united">
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="doc_osn" />
              </call>
              <call function="in" optional="1">
                <column table="*" column="kod_ipr" />
                <useparam name="kod_ipr_simple" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_parent" />
                <useparam name="kod_titul_ip_head" />
              </call>
              <call function="in" optional="1" selective="1">
                <column table="kod_titul_ip1" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in" optional="1" selective="1">
                <column table="kod_titul_ip1" column="kod_ispolnit" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="or" optional="1" selective="1">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_dir_or_isp" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_dir_or_isp" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul1" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_priority" />
                <useparam name="kod_priority" />
              </call>
              <call function="in" optional="1" exclude="1">
                <column table="*" column="kod_sbor_titul" />
                <useparam name="kod_titul_ip_sbor" />
              </call>
              <call function="le" optional="1" selective="1" exclude="1">
                <column table="*" column="ym" />
                <useparam name="ym2" />
              </call>
              <call function="ge" optional="1" selective="1" exclude="1">
                <column table="*" column="ym" />
                <useparam name="ym1" />
              </call>
            </call>
          </extendwhere>
          <link name="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="kod_direct" />
          </link>
          <link name="kod_ipr">
            <link name="kod_doc_osn" />
            <link name="kod_parent" />
            <link name="kod_main_titul">
              <link name="kod_razdel">
                <link name="kod_root" as="razdel_root" />
              </link>
              <link name="kod_parent_sbor" />
              <link name="kod_subject" />
            </link>
            <link name="kod_child_titul" />
            <link name="kod_priority" />
          </link>
          <link name="ym" />
          <link name="kod_smet" />
          <link name="kodzatrat" />
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="true" />
          <call function="ge" optional="1" exclude="1">
            <column table="ipr_fin_body_united" column="ym" />
            <useparam name="ym1" />
          </call>
          <call function="le" optional="1" exclude="1">
            <column table="ipr_fin_body_united" column="ym" />
            <useparam name="ym2" />
          </call>
          <call function="ge" optional="1">
            <call function="nvl">
              <column table="ipr_fin_body_united" column="ym_nxt" />
              <useparam name="ym1" />
            </call>
            <useparam name="ym1" />
          </call>
        </call>
      </where>
    </query>
    <query name="ipr_time_intervals" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\generator.xml">
      <params>
        <param name="ym1" type="number">
          <const>201404</const>
        </param>
        <param name="ym2" type="number">
          <const>201510</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod" />
        <column table="a" column="full_name" />
        <column table="a" column="kod_parent" />
        <column table="a" column="time_type" />
        <column table="a" column="in_year_id" />
        <!--<column table="a" column="period_id"/>-->
        <column table="a" column="date_begin" />
        <column table="a" column="date_end" />
      </select>
      <from>
        <query name="spr_time_intervals1" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="ge">
            <call function="date to ym2">
              <column table="a" column="date_begin" />
            </call>
            <useparam name="ym1" />
          </call>
          <call function="le">
            <call function="date to ym2">
              <column table="a" column="date_end" />
            </call>
            <useparam name="ym2" />
          </call>
        </call>
      </where>
    </query>
    <query name="ipr_ipr_data_check_pl_ft" timestamp="30.01.2017 00:45:13" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\ipr_ipr_data_check_pl_ft.xml">
      <select>
        <column table="a" column="kod_ipr_ext" group="1" />
        <column table="a" column="kod_ipr" group="1" />
        <column table="a" column="kod_doc_osn" group="1" />
        <call function="if" as="pr_plan" type="number">
          <call function="!=0">
            <column table="a" column="kap_sum" group="sum" />
            <column table="a" column="vvod_sum" group="sum" />
            <column table="a" column="fp_sum" group="sum" />
            <column table="a" column="pow_any" group="sum" />
          </call>
          <const>1</const>
        </call>
        <call function="if" as="pr_fact" type="number">
          <call function="!=0">
            <column table="a" column="kap_sum_fact" group="sum" />
            <column table="a" column="vvod_sum_fact" group="sum" />
            <column table="a" column="fp_sum_fact" group="sum" />
            <column table="a" column="pow_any" group="sum" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a">
          <extendwhere>
            <call function="in">
              <column table="*" column="kod_ipr_ext" />
              <array>36205,35632,42169,29290,30796</array>
            </call>
          </extendwhere>
        </query>
      </from>
    </query>
    <query name="ipr_data_check_pl_ft_ym" timestamp="25.04.2018 17:48:23" use-repository="1" stored="vv_ipr_data_check_pl_ft_ym" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\ipr_ipr_data_check_pl_ft.xml">
      <select>
        <column table="kod_ipr" column="kod_ipr" group="1" is-private-dimension="kod_ipr" is-final-dimension="kod_ipr" dimension="kod_ipr" index="1" />
        <column table="ipr_ym" column="val" group="1" as="ym" is-private-dimension="ipr_ym" is-final-dimension="ipr_ym" dimension="ipr_ym" index="1" />
        <call function="if" as="pr_plan" type="number" is-fact="1" fact="ipr_pr_plan" agg="max">
          <call function="!=0">
            <fact column="ipr_kap_sum" group="sum" />
            <fact column="ipr_fin_sum" group="sum" />
            <fact column="ipr_vvd_sum" group="sum" />
          </call>
          <const>1</const>
        </call>
        <call function="if" as="pr_fact" type="number" fact="ipr_pr_fact" agg="max">
          <call function="!=0">
            <fact column="ipr_kap_fact_sum" group="sum" />
            <fact column="ipr_fin_fact_sum" group="sum" />
            <fact column="ipr_vvd_fact_sum" group="sum" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_ym" />
          <link name="kod_ipr">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
        </qube>
      </from>
    </query>
    <query name="ipr_vvod_fiz_dop_fact" timestamp="24.01.2017 19:48:36" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\ipr_vvod_fiz_dop.xml">
      <select>
        <column table="phis_param" column="kod_titul_ip" group="1" />
        <call function="date to ym2" as="ym" group="1">
          <column table="kod_doc" column="doc_date" />
        </call>
        <call function="()" group="sum" as="km_vl1">
          <usepart part="ipr_fin_phis_param-val-num">
            <const>19</const>
          </usepart>
        </call>
        <call function="()" group="sum" as="km_vl2">
          <usepart part="ipr_fin_phis_param-val-num">
            <const>20</const>
          </usepart>
        </call>
        <call function="-nvl" group="sum" as="km_vl1_pr">
          <column table="this" column="km_vl1" group="" />
          <usepart part="ipr_fin_phis_param-val-dem-num">
            <const>19</const>
          </usepart>
        </call>
        <call function="-nvl" group="sum" as="km_vl2_pr">
          <column table="this" column="km_vl2" group="" />
          <usepart part="ipr_fin_phis_param-val-dem-num">
            <const>20</const>
          </usepart>
        </call>
      </select>
      <from>
        <query name="ipv_phys_param_values" as="phis_param">
          <link name="kod_titul_ip" />
          <link name="kod_doc" />
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="this" column="ym" />
        </call>
      </where>
    </query>
    <query name="vv_tit_kap_fact" timestamp="18.08.2016 18:18:12" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\vv_tit_kap_fact.xml">
      <select>
        <column table="a" column="kod_titul_ip" />
        <column table="a" column="kod_smet" />
        <column table="a" column="kap_sum_fact" />
        <column table="a" column="kap_sum_nds_fact" />
      </select>
      <from>
        <query name="ipr_fin_body_united" as="a" />
      </from>
    </query>
    <query name="30196-begin-year" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <select>
        <call function="year begin time" as="val">
          <call function="year">
            <const>sysdate</const>
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="30196-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="dates" />
        <param name="datepo" />
      </params>
      <select>
        <call function="day" as="day" type="number">
          <useparam name="datepo" />
        </call>
        <call function="mes-name-rp" as="month" type="string">
          <call function="month">
            <useparam name="datepo" />
          </call>
        </call>
        <call function="year" as="year" type="number">
          <useparam name="datepo" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="30196-group" order="kod_dop_contract,n_row" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="dates" />
        <param name="datepo" />
      </params>
      <select>
        <column table="a" column="kod_dop_contract" group="1" />
        <column table="a" column="n_row" group="1" />
        <column table="a" column="name" group="max" />
        <column table="a" column="lp_addr" group="max" />
        <column table="a" column="kn_zone" group="max" />
        <column table="a" column="num_req" group="max" />
        <column table="a" column="dt_request" group="max" />
        <column table="a" column="power" group="max" />
        <column table="a" column="category" group="max" />
        <column table="a" column="num_dog" group="max" />
        <column table="a" column="dat_ouco" group="max" />
        <column table="a" column="dt_contract" group="max" />
        <column table="a" column="dat_post" group="max" />
        <column table="a" column="kod_direct" group="max" />
        <column table="a" column="kod_viza" group="max" />
        <column table="a" column="dat_post_671" group="max" />
        <call function="dense_rank" as="ndoc_671">
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
          <call function="order by 2">
            <column table="this" column="dat_post_671" />
            <call function="if">
              <call function="is not null">
                <column table="this" column="dat_post_671" />
              </call>
              <column table="this" column="kod_viza" />
            </call>
          </call>
        </call>
        <column table="a" column="dat_viz_671" group="max" />
        <column table="a" column="name_tech_671" group="max" />
        <column table="a" column="dat_post_424" group="max" />
        <call function="dense_rank" as="ndoc_424">
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
          <call function="order by 2">
            <column table="this" column="dat_post_424" />
          </call>
        </call>
        <column table="a" column="dat_viz_424" group="max" />
        <column table="a" column="dat_post_1" group="max" />
        <call function="dense_rank" as="ndoc_1">
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
          <call function="order by 2">
            <column table="this" column="dat_post_1" />
          </call>
        </call>
        <column table="a" column="dat_viz_1" group="max" />
        <column table="a" column="dat_post_6" group="max" />
        <column table="a" column="name_kr" group="max" />
        <column table="a" column="dat_post_732" group="max" />
        <column table="a" column="dat_viz_732" group="max" />
        <column table="a" column="dat_post_other" group="max" />
        <column table="a" column="dat_viz_other" group="max" />
        <column table="a" column="name_go_other" group="max" />
        <column table="a" column="name_kr1_other" group="max" />
        <column table="a" column="dat_viz_131" group="max" />
        <column table="a" column="dat_viz_37" group="max" />
        <column table="a" column="dat_viz_125" group="max" />
        <column table="a" column="dat_viz_133" group="max" />
        <!-- тут число между днями -->
        <column table="a" column="dat_viz_125_cntr" group="max" />
        <column table="a" column="dat_viz_37_cntr" group="max" />
        <call function="decode" as="dayregistr" type="number">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dayperson" />
              </call>
              <call function="is not null">
                <column table="this" column="allday" />
              </call>
            </call>
            <call function="-">
              <column table="this" column="allday" />
              <column table="this" column="dayperson" />
            </call>
          </call>
          <const>0</const>
          <const>1</const>
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dayperson" />
              </call>
              <call function="is not null">
                <column table="this" column="allday" />
              </call>
            </call>
            <call function="-">
              <column table="this" column="allday" />
              <column table="this" column="dayperson" />
            </call>
          </call>
        </call>
        <call function="decode" as="dayperson" type="number">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dat_viz_125_cntr" />
              </call>
              <call function="is not null">
                <column table="this" column="dat_viz_37_cntr" />
              </call>
            </call>
            <call function="is_period_.get_srok_doc">
              <column table="this" column="dat_viz_125_cntr" />
              <column table="this" column="dat_viz_37_cntr" />
            </call>
          </call>
          <const>0</const>
          <const>1</const>
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dat_viz_125_cntr" />
              </call>
              <call function="is not null">
                <column table="this" column="dat_viz_37_cntr" />
              </call>
            </call>
            <call function="is_period_.get_srok_doc">
              <column table="this" column="dat_viz_125_cntr" />
              <column table="this" column="dat_viz_37_cntr" />
            </call>
          </call>
        </call>
        <call function="decode" as="allday" type="number">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dat_ouco" />
              </call>
              <call function="is not null">
                <column table="this" column="dt_contract" />
              </call>
            </call>
            <call function="is_period_.get_srok_doc">
              <column table="this" column="dt_contract" />
              <column table="this" column="dat_ouco" />
            </call>
          </call>
          <const>0</const>
          <const>1</const>
          <call function="if" as="allday" type="number">
            <call function="and">
              <call function="is not null">
                <column table="this" column="dat_ouco" />
              </call>
              <call function="is not null">
                <column table="this" column="dt_contract" />
              </call>
            </call>
            <call function="is_period_.get_srok_doc">
              <column table="this" column="dt_contract" />
              <column table="this" column="dat_ouco" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="30196-analytics" as="a">
          <withparams>
            <useparam name="dates" />
            <useparam name="datepo" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="30196-analytics" grouplevel="no" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="dates" />
        <param name="datepo" />
      </params>
      <select>
        <column table="a" column="*" />
        <call function="over" as="n_department_b" type="number">
          <call function="lag">
            <column table="this" column="n_department_a" />
            <const>1</const>
            <const>0</const>
          </call>
          <call function="order by 2">
            <column table="this" column="kod_dop_contract" />
            <column table="this" column="dat_post" />
            <column table="this" column="kod_viza" />
          </call>
        </call>
        <call function="if" as="n_department_c">
          <call function="and">
            <call function="ge">
              <column table="this" column="n_department_b" />
              <column table="this" column="n_department_a" />
            </call>
            <!--<call function="!=">
              <column table="this" column="n_department_b" />
              <const>6</const>
            </call>-->
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="over" as="n_row" type="number">
          <call function="sum">
            <column table="this" column="n_department_c" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
          <call function="order by 2">
            <column table="this" column="kod_dop_contract" />
            <column table="this" column="dat_post" />
            <column table="this" column="kod_viza" />
          </call>
        </call>
        <call function="over" as="dat_viz_125_cntr" type="date">
          <call function="max">
            <column table="this" column="dat_viz_125" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" as="dat_viz_37_cntr" type="date">
          <call function="max">
            <column table="this" column="dat_viz_37" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
      </select>
      <from>
        <query name="30196-data" as="a" order="kod_dop_contract,dat_post,kod_viza">
          <withparams>
            <useparam name="dates" />
            <useparam name="datepo" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is not null">
              <column table="a" column="dat_post_671" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_post_424" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_post_1" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_post_6" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_post_732" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_viz_131" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_viz_37" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_viz_125" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_viz_133" />
            </call>
            <call function="is not null">
              <column table="a" column="dat_post_other" />
            </call>
          </call>
          <call function="ge">
            <column table="a" column="n_department_a" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="30196-data" grouplevel="no" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="dates" />
        <param name="datepo" />
      </params>
      <select>
        <column table="a" column="kod_dop_contract" />
        <column table="kn_customer" column="name" />
        <column table="kod_dop_contract" column="lp_addr" />
        <column table="kod_dop_contract" column="kn_zone" />
        <column table="kod_dop_contract" column="num_req" />
        <column table="kod_dop_contract" column="dt_request" />
        <column table="kod_dop_contract" column="power" />
        <column table="kod_dop_contract" column="category" />
        <column table="kod_dop_contract" column="dat_ouco" />
        <column table="kod_dop_contract" column="dt_contract" />
        <call function="if" as="num_dog" type="string">
          <call function="is not null">
            <column table="kod_dop_contract" column="kn_contract_p" />
          </call>
          <call function="||">
            <column table="kod_dop_contract" column="num_ouco" />
            <const>'/'</const>
            <column table="kod_dop_contract" column="num_ds" />
          </call>
          <column table="kod_dop_contract" column="num_ouco" />
        </call>
        <column table="a" column="dat_post" />
        <column table="a" column="dat_viz" />
        <column table="kod_person" column="kod_direct" />
        <column table="a" column="kod_viza" />
        <call function="case" as="n_department_a" type="number">
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="kod_person" column="kod_direct" />
                <query>
                  <select>
                    <column table="a" column="kod_direct" />
                  </select>
                  <from>
                    <query name="is_spr_direct-listchild" as="a">
                      <withparams>
                        <const>671</const>
                      </withparams>
                    </query>
                  </from>
                </query>
                <!--<const>671</const>-->
              </call>
              <call function="not in">
                <column table="a" column="kod_spr_viz" />
                <array>4,6,131,37,141,125,133</array>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_person" column="kod_direct" />
                <const>424</const>
              </call>
              <call function="not in">
                <column table="a" column="kod_spr_viz" />
                <array>4,6,131,37,141,125,133</array>
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="a" column="kod_spr_viz" />
                <array>4</array>
              </call>
              <call function="is not null">
                <column table="a" column="dat_viz" />
              </call>
              <!--<call function="=">
                <call function="qg_settings_read.f_is_contains_value_nb">
                  <call function="to_char">
                    <column table="a" column="kod_person" />
                  </call>
                </call>
                <const>1</const>
              </call>-->
              <!--<call function="in">
                <column table="a" column="kod_person" />
                <array>301394</array>
              </call>-->
            </call>
            <const>3</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_person" column="kod_direct" />
                <const>732</const>
              </call>
              <call function="not in">
                <column table="a" column="kod_spr_viz" />
                <array>4,6,131,37,141,125,133</array>
              </call>
            </call>
            <const>4</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>6</array>
            </call>
            <const>6</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>131</array>
            </call>
            <const>7</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>37,141</array>
            </call>
            <const>8</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>125</array>
            </call>
            <const>9</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>133</array>
            </call>
            <const>10</const>
          </call>
          <call function="else">
            <const>5</const>
          </call>
        </call>
        <column table="a" column="dat_post" title="технический аудит на согласование (дата)">
          <usepart part="30196-if-dir-list">
            <const>671</const>
          </usepart>
        </column>
        <column table="a" column="dat_viz" title="технический аудит согласовано (дата)">
          <usepart part="30196-if-dir-list">
            <const>671</const>
          </usepart>
        </column>
        <column table="a" column="name_direct" as="name_tech" title="служба тех.аудита">
          <usepart part="30196-if-dir-list">
            <const>671</const>
          </usepart>
        </column>
        <column table="a" column="dat_post" title="юридическая служба на согласование (дата)">
          <usepart part="30196-if-dir">
            <const>424</const>
          </usepart>
        </column>
        <column table="a" column="dat_viz" title="юридическая служба согласовано (дата)">
          <usepart part="30196-if-dir">
            <const>424</const>
          </usepart>
        </column>
        <column table="a" column="dat_post" as="+_1" title="на подпись (дата)">
          <usepart part="30196-if-viz-notnull">
            <array>4</array>
          </usepart>
        </column>
        <column table="a" column="dat_viz" as="+_1" title="подписано (дата)">
          <usepart part="30196-if-viz-notnull">
            <array>4</array>
          </usepart>
        </column>
        <column table="a" column="dat_post" as="+_6" title="возврат на доработку (дата)">
          <usepart part="30196-if-viz">
            <array>6</array>
          </usepart>
        </column>
        <column table="a" column="name_direct" as="name_kr" title="служба">
          <usepart part="30196-if-viz">
            <array>6</array>
          </usepart>
        </column>
        <column table="a" column="dat_post" title="передано в ЦРКП (дата)">
          <usepart part="30196-if-dir">
            <const>732</const>
          </usepart>
        </column>
        <column table="a" column="dat_viz" title="передано ЦРКП (дата)">
          <usepart part="30196-if-dir">
            <const>732</const>
          </usepart>
        </column>
        <column table="a" column="dat_viz" as="+_131" title="сообщено о готовности (дата)">
          <usepart part="30196-if-viz">
            <array>131</array>
          </usepart>
        </column>
        <column table="a" column="dat_viz" as="+_37" title="выдано на подпись (дата)">
          <usepart part="30196-if-viz">
            <array>37,141</array>
          </usepart>
        </column>
        <column table="a" column="dat_viz" as="+_125" title="подписано заявителем (дата)">
          <usepart part="30196-if-viz">
            <array>125</array>
          </usepart>
        </column>
        <column table="a" column="dat_viz" as="+_133" title="отказ заявителя (дата)">
          <usepart part="30196-if-viz">
            <array>133</array>
          </usepart>
        </column>
        <column table="a" column="dat_post">
          <usepart part="30196-if-depart">
            <array>5</array>
          </usepart>
        </column>
        <column table="a" column="dat_viz">
          <usepart part="30196-if-depart">
            <array>5</array>
          </usepart>
        </column>
        <column table="kod_spr_viz" column="name" as="name_go">
          <usepart part="30196-if-depart">
            <array>5</array>
          </usepart>
        </column>
        <column table="a" column="name_direct" as="name_kr1">
          <usepart part="30196-if-depart">
            <array>5</array>
          </usepart>
        </column>
      </select>
      <from>
        <query name="is_viza" as="a">
          <link name="kod_dop_contract">
            <link name="kn_customer" />
          </link>
          <link name="kod_spr_viz" />
          <link name="kod_person">
            <link name="kod_direct" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="in">
            <column table="a" column="kod_dop_contract" />
            <array>3179091</array>
          </call>-->
          <!--<call function="or">
            <call function="in">
              <column table="kod_person" column="kod_direct" />
              <array>857,424,732</array>
            </call>
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <array>1,4,6,131,37,125,133</array>
            </call>
          </call>-->
          <call function="between" optional="1">
            <column table="a" column="dat_post" />
            <useparam name="dates" />
            <useparam name="datepo" />
          </call>
          <call function="is not null">
            <column table="a" column="kod_dop_contract" />
          </call>
          <!--<call function="=">
            <column table="kod_dop_contract" column="status" />
            <const>0</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="33535-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <call function="date to char" as="date_begin" title="Начальная отчётная дата">
          <call function="year begin time">
            <useparam name="year" />
          </call>
        </call>
        <call function="date to char" as="date_end" title="Начальная отчётная дата">
          <call function="year end time">
            <useparam name="year" />
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="33535" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="33535-data" as="a">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
          <grsets>
            <grset level="1" title="Субъект федерации" as="ro">
              <where>
                <call function="is not null">
                  <column table="a" column="ro" />
                </call>
              </where>
              <grset level="" title="до 15 кВт включительно, всего" as="ro_do15">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="в т.ч. физ.лица до 15 кВт включительно" as="ro_do15fiz">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="a" column="prizn_power" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="a" column="ur_lico" />
                      <const>0</const>
                    </call>
                  </call>
                </where>
              </grset>
              <grset level="" title="свыше 15 и до 150 кВт включительно" as="ro_ot15do150">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="свыше 150 кВт и менее 670 кВт" as="ro_ot150do670">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>3</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="не менее 670 кВт" as="ro_ot670">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>4</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="объекты по производству электрической энергии" as="ro_vrem2">
                <where>
                  <call function="=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="ВСЕГО без учета временного ТП" as="ro_novrem1">
                <where>
                  <call function="!=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="временное технологическое присоединение" as="ro_vrem1">
                <where>
                  <call function="=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <!--<grset level="" title="ВСЕГО с учетом временного ТП" as="ro_all"/>-->
              <grset level="" title="садоводческие, огороднические, дачные некоммерческие объединения и иные некоммерческие объединения" as="ro_garden">
                <where>
                  <call function="or">
                    <call function="=">
                      <column table="a" column="pr_garden_obj" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="a" column="pr_nonprofit" />
                      <const>1</const>
                    </call>
                  </call>
                </where>
              </grset>
            </grset>
            <grset level="" title="до 15 кВт включительно, всего" as="do15">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="в т.ч. физ.лица до 15 кВт включительно" as="do15fiz">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="a" column="ur_lico" />
                    <const>0</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="" title="свыше 15 и до 150 кВт включительно" as="ot15do150">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>2</const>
                </call>
              </where>
            </grset>
            <grset level="" title="свыше 150 кВт и менее 670 кВт" as="ot150do670">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>3</const>
                </call>
              </where>
            </grset>
            <grset level="" title="не менее 670 кВт" as="ot670">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>4</const>
                </call>
              </where>
            </grset>
            <grset level="" title="объекты по производству электрической энергии" as="vrem2">
              <where>
                <call function="=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>2</const>
                </call>
              </where>
            </grset>
            <grset level="" title="ВСЕГО без учета временного ТП" as="novrem1">
              <where>
                <call function="!=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="временное технологическое присоединение" as="vrem1">
              <where>
                <call function="=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="ВСЕГО с учетом временного ТП" as="all" />
            <grset level="" title="садоводческие, огороднические, дачные некоммерческие объединения и иные некоммерческие объединения" as="garden">
              <where>
                <call function="or">
                  <call function="=">
                    <column table="a" column="pr_garden_obj" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="a" column="pr_nonprofit" />
                    <const>1</const>
                  </call>
                </call>
              </where>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="33535-data" grouplevel="no" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <call function="case" as="ro" type="number" group="1">
          <call function="when">
            <call function="=">
              <column table="a" column="kn_zone" />
              <const>0</const>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="!=">
              <column table="a" column="kn_zone" />
              <const>0</const>
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="case" as="ro_name" type="string" group="max">
          <call function="when">
            <call function="=">
              <column table="this" column="ro" />
              <const>0</const>
            </call>
            <const>'Лененградская область'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="this" column="ro" />
              <const>1</const>
            </call>
            <const>'Санкт-Петербург'</const>
          </call>
        </call>
        <column table="a" column="isv_rep_ad_id" group="2" />
        <column table="a" column="ur_lico" group="2" />
        <column table="a" column="fl_vrem_tp" group="2" />
        <column table="a" column="pr_garden_obj" group="2" />
        <column table="a" column="pr_nonprofit" group="2" />
        <column table="a" column="sum_power" group="2" />
        <call function="case" as="prizn_power" group="2">
          <call function="when">
            <call function="le">
              <column table="a" column="sum_power" />
              <const>15</const>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="gt">
                <column table="a" column="sum_power" />
                <const>15</const>
              </call>
              <call function="le">
                <column table="a" column="sum_power" />
                <const>150</const>
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="gt">
                <column table="a" column="sum_power" />
                <const>150</const>
              </call>
              <call function="lt">
                <column table="a" column="sum_power" />
                <const>670</const>
              </call>
            </call>
            <const>3</const>
          </call>
          <call function="when">
            <call function="ge">
              <column table="a" column="sum_power" />
              <const>670</const>
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="case" as="voltage_kod" type="number" group="2">
          <call function="when">
            <call function="=">
              <column table="a" column="voltage" />
              <const>'НН'</const>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="voltage" />
              <const>'СН2'</const>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="voltage" />
              <array>
                <const>'СН1'</const>
                <const>'ВН'</const>
              </array>
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="if" as="col2_7" group="2">
          <call function="and">
            <call function="lt">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
            </call>
            <call function="or">
              <call function="is null">
                <column table="a" column="srok_uslug" />
              </call>
              <call function="gt">
                <column table="a" column="srok_uslug" />
                <call function="year begin time">
                  <useparam name="year" />
                </call>
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col2_7" as="col2_7_count" type="number" dimname="volt" group="sumnvl" title="шт">
          <pivot title=" по уровням напряжения">
            <column table="this" column="voltage_kod" />
            <query order="kod">
              <select>
                <column table="a" column="kod" />
                <column table="a" column="title" />
              </select>
              <from>
                <query name="33535-voltage" as="a" />
              </from>
            </query>
          </pivot>
        </column>
        <call function="if" as="power2_7" group="2">
          <call function="=">
            <column table="this" column="col2_7" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power2_7" as="power2_7_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col8_19" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="date_coming" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col8_19" as="col8_19_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power8_19" group="2">
          <call function="=">
            <column table="this" column="col8_19" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power8_19" as="power8_19_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col20_25" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_project" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col20_25" as="col20_25_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power20_25" group="2">
          <call function="=">
            <column table="this" column="col20_25" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power20_25" as="power20_25_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col26_31" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col20_25" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col26_31" as="col26_31_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power26_31" group="2">
          <call function="=">
            <column table="this" column="col26_31" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power26_31" as="power26_31_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col32_33" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col20_25" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="proekttu_over" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col32_33" as="col32_33_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power32_33" group="2">
          <call function="=">
            <column table="this" column="col32_33" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power32_33" as="power32_33_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col34_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col20_25" />
            <const>1</const>
          </call>
          <column table="a" column="srok_project" />
        </call>
        <call function="if" as="col35_36" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="date_off" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="=">
              <column table="a" column="kn_st_req" />
              <const>1</const>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col35_36" as="col35_36_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power35_36" group="2">
          <call function="=">
            <column table="this" column="col35_36" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power35_36" as="power35_36_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col37_38" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col35_36" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kn_off_reason" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col37_38" as="col37_38_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power37_38" group="2">
          <call function="=">
            <column table="this" column="col37_38" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power37_38" as="power37_38_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col39_44" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col39_44" as="col39_44_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power39_44" group="2">
          <call function="=">
            <column table="this" column="col39_44" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power39_44" as="power39_44_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col45_50" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col45_50" as="col45_50_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power45_50" group="2">
          <call function="=">
            <column table="this" column="col45_50" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power45_50" as="power45_50_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col51_54" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_51_54" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col51_54" as="col51_54_count" type="number" dimname="volt_s" group="sumnvl" title="шт">
          <pivot title=" по уровням напряжения">
            <column table="this" column="voltage_kod" />
            <query order="kod">
              <select>
                <column table="a" column="kod" />
                <column table="a" column="title" />
              </select>
              <from>
                <query name="33535-voltage" as="a" />
              </from>
              <where>
                <call function="in">
                  <column table="a" column="kod" />
                  <array>
                    <const>1</const>
                    <const>2</const>
                  </array>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <call function="if" as="power51_54" group="2">
          <call function="=">
            <column table="this" column="col51_54" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power51_54" as="power51_54_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col55_58" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_55_58" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col55_58" as="col55_58_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power55_58" group="2">
          <call function="=">
            <column table="this" column="col55_58" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power55_58" as="power55_58_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col59_60" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="=">
              <column table="a" column="kod_vid_ds" />
              <const>14</const>
            </call>
            <call function="is not null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col59_60" as="col59_60_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power59_60" group="2">
          <call function="=">
            <column table="this" column="col59_60" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power59_60" as="power59_60_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col61_62" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dat_rastorg" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col61_62" as="col61_62_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power61_62" group="2">
          <call function="=">
            <column table="this" column="col61_62" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power61_62" as="power61_62_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col63_68" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_akt" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col63_68" as="col63_68_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power63_68" group="2">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power63_68" as="power63_68_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col69_74" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col69_74" as="col69_74_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power69_74" group="2">
          <call function="=">
            <column table="this" column="col69_74" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power69_74" as="power69_74_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col75_78" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col51_54" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col75_78" as="col75_78_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power75_78" group="2">
          <call function="=">
            <column table="this" column="col75_78" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power75_78" as="power75_78_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col79_82" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col55_58" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col79_82" as="col79_82_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power79_82" group="2">
          <call function="=">
            <column table="this" column="col79_82" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power79_82" as="power79_82_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col83_84" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_83_84" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col83_84" as="col83_84_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power83_84" group="2">
          <call function="=">
            <column table="this" column="col83_84" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power83_84" as="power83_84_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col85_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="srok_project" />
        </call>
        <call function="if" as="col86_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="col_86" />
        </call>
        <call function="if" as="col89_94" group="2">
          <call function="and">
            <call function="lt">
              <column table="a" column="dt_contract" />
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="or">
              <call function="is null">
                <column table="a" column="srok_uslug" />
              </call>
              <call function="gt">
                <column table="a" column="srok_uslug" />
                <call function="year end time">
                  <useparam name="year" />
                </call>
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col89_94" as="col89_94_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power89_94" group="2">
          <call function="=">
            <column table="this" column="col89_94" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power89_94" as="power89_94_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col95_96" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="or">
              <call function="gt">
                <column table="a" column="dt_akt" />
                <column table="a" column="srok_uslug" />
              </call>
              <call function="and">
                <call function="is null">
                  <column table="a" column="dt_akt" />
                </call>
                <call function="lt">
                  <column table="a" column="srok_uslug" />
                  <call function="year end time">
                    <useparam name="year" />
                  </call>
                </call>
              </call>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col95_96" as="col95_96_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power95_96" group="2">
          <call function="=">
            <column table="this" column="col95_96" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power95_96" as="power95_96_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col99_100" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col99_100" as="col99_100_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power99_100" group="2">
          <call function="=">
            <column table="this" column="col99_100" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power99_100" as="power99_100_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col101_102" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>2</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col101_102" as="col101_102_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power101_102" group="2">
          <call function="=">
            <column table="this" column="col101_102" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power101_102" as="power101_102_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col103_104" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>3</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col103_104" as="col103_104_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power103_104" group="2">
          <call function="=">
            <column table="this" column="col103_104" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power103_104" as="power103_104_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col105_106" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>4</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col105_106" as="col105_106_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power105_106" group="2">
          <call function="=">
            <column table="this" column="col105_106" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power105_106" as="power105_106_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col109_110" group="2">
          <call function="=">
            <column table="this" column="col89_94" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col109_110" as="col109_110_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power109_110" group="2">
          <call function="=">
            <column table="this" column="col109_110" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power109_110" as="power109_110_sum" group="sumnvl" title="кВт" />
      </select>
      <from>
        <query name="isv_rep_ad_m" as="a" />
      </from>
    </query>
    <query name="33535-voltage" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <select>
        <column table="a" column="kod" type="number" />
        <column table="a" column="title" type="string" />
      </select>
      <from>
        <table name="33535-voltage_view" view="1" as="a" />
      </from>
    </query>
    <query name="33536-region" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33536.xml">
      <const as="id" type="number" key="1">0</const>
      <const as="name" type="string" title="Регион">'ЛО'</const>
      <const>1</const>
      <const>'СПб'</const>
    </query>
    <query name="33536" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33536.xml">
      <params>
        <param name="dat">
          <const>sysdate</const>
        </param>
        <param name="kod_region" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="33536-data" as="a">
          <withparams>
            <useparam name="dat" />
          </withparams>
          <grsets>
            <grset level="1" as="reg_g" title="по СПб">
              <where>
                <call function="and">
                  <call function="gt">
                    <column table="a" column="kod_region" />
                    <const>0</const>
                  </call>
                  <call function="in" optional="1">
                    <const>1</const>
                    <useparam name="kod_region" />
                  </call>
                </call>
              </where>
              <grset level="4" as="g_lg_allg" title="всего льготные по СПб">
                <where>
                  <call function="=1">
                    <column table="a" column="fl_discount" />
                  </call>
                </where>
              </grset>
              <grset level="5" as="g_load_allg" title="всего группа мощности по СПб"></grset>
              <grset level="" as="g_srok_allg" title="всего просроченные по СПб">
                <where>
                  <call function="lt">
                    <column table="a" column="srok_uslug" />
                    <useparam name="dat" />
                  </call>
                </where>
                <grset level="4" as="g_lg_srokg" title="льготные просроченые по СПб">
                  <where>
                    <call function="=1">
                      <column table="a" column="fl_discount" />
                    </call>
                  </where>
                </grset>
                <grset level="5" as="g_load_srokg" title="группа мощности просроченные по СПб"></grset>
              </grset>
              <grset level="3" as="g_buil" title="работы по СПб">
                <grset level="4" as="g_lg_all" title="всего льготные по СПб (работы)">
                  <where>
                    <call function="=1">
                      <column table="a" column="fl_discount" />
                    </call>
                  </where>
                </grset>
                <grset level="5" as="g_load_all" title="всего группа мощности по СПб (работы)"></grset>
                <grset level="" as="g_srok_all" title="всего просроченные по СПб (работы)">
                  <where>
                    <call function="lt">
                      <column table="a" column="srok_uslug" />
                      <useparam name="dat" />
                    </call>
                  </where>
                  <grset level="4" as="g_lg_srok" title="льготные просроченые по СПб (работы)">
                    <where>
                      <call function="=1">
                        <column table="a" column="fl_discount" />
                      </call>
                    </where>
                  </grset>
                  <grset level="5" as="g_load_srok" title="группа мощности просроченные по СПб (работы)"></grset>
                </grset>
              </grset>
            </grset>
            <grset level="1" as="reg_l" title="по ЛО">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="a" column="kod_region" />
                    <const>0</const>
                  </call>
                  <call function="in" optional="1">
                    <const>0</const>
                    <useparam name="kod_region" />
                  </call>
                </call>
              </where>
              <grset level="4" as="g_lg_alll" title="всего льготные по СПб">
                <where>
                  <call function="=1">
                    <column table="a" column="fl_discount" />
                  </call>
                </where>
              </grset>
              <grset level="5" as="g_load_alll" title="всего группа мощности по СПб"></grset>
              <grset level="" as="g_srok_alll" title="всего просроченные по СПб">
                <where>
                  <call function="lt">
                    <column table="a" column="srok_uslug" />
                    <useparam name="dat" />
                  </call>
                </where>
                <grset level="4" as="g_lg_srokl" title="льготные просроченые по СПб">
                  <where>
                    <call function="=1">
                      <column table="a" column="fl_discount" />
                    </call>
                  </where>
                </grset>
                <grset level="5" as="g_load_srokl" title="группа мощности просроченные по СПб"></grset>
              </grset>
              <grset level="3" as="l_buil" title="работы по ЛО">
                <grset level="4" as="l_lg_all" title="всего льготные по ЛО">
                  <where>
                    <call function="=1">
                      <column table="a" column="fl_discount" />
                    </call>
                  </where>
                </grset>
                <grset level="5" as="l_load_all" title="всего группа мощности по ЛО"></grset>
                <grset level="" as="l_srok_all" title="всего просроченные по ЛО">
                  <where>
                    <call function="lt">
                      <column table="a" column="srok_uslug" />
                      <useparam name="dat" />
                    </call>
                  </where>
                  <grset level="4" as="l_lg_srok" title="льготные просроченые по ЛО">
                    <where>
                      <call function="=1">
                        <column table="a" column="fl_discount" />
                      </call>
                    </where>
                  </grset>
                  <grset level="5" as="l_load_srok" title="группа мощности просроченные по ЛО"></grset>
                </grset>
              </grset>
              <grset level="2" as="l_nr" title="по филиалам">
                <grset level="4" as="l_lg_alllf" title="всего льготные по СПб">
                  <where>
                    <call function="=1">
                      <column table="a" column="fl_discount" />
                    </call>
                  </where>
                </grset>
                <grset level="5" as="l_load_alllf" title="всего группа мощности по СПб"></grset>
                <grset level="" as="l_srok_alllf" title="всего просроченные по СПб">
                  <where>
                    <call function="lt">
                      <column table="a" column="srok_uslug" />
                      <useparam name="dat" />
                    </call>
                  </where>
                  <grset level="4" as="l_lg_sroklf" title="льготные просроченые по СПб">
                    <where>
                      <call function="=1">
                        <column table="a" column="fl_discount" />
                      </call>
                    </where>
                  </grset>
                  <grset level="5" as="l_load_sroklf" title="группа мощности просроченные по СПб"></grset>
                </grset>
                <grset level="3" as="lf_buil" title="работы">
                  <grset level="4" as="lf_lg_all" title="всего льготные по ЛО по филиалам">
                    <where>
                      <call function="=1">
                        <column table="a" column="fl_discount" />
                      </call>
                    </where>
                  </grset>
                  <grset level="5" as="lf_load_all" title="всего группа мощности по ЛО по филиалам"></grset>
                  <grset level="" as="lf_srok_all" title="всего просроченные по ЛО по филиалам">
                    <where>
                      <call function="lt">
                        <column table="a" column="srok_uslug" />
                        <useparam name="dat" />
                      </call>
                    </where>
                    <grset level="4" as="lf_lg_srok" title="льготные просроченые по ЛО по филиалам">
                      <where>
                        <call function="=1">
                          <column table="a" column="fl_discount" />
                        </call>
                      </where>
                    </grset>
                    <grset level="5" as="lf_load_srok" title="группа мощности просроченные по ЛО по филиалам"></grset>
                  </grset>
                </grset>
              </grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="33536-data" grouplevel="no" timestamp="17.02.2016 18:55:48" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33536.xml">
      <params>
        <param name="dat">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <call function="date to char" as="sdate" group="max">
          <useparam name="dat" />
        </call>
        <column table="kod_dop_contract" column="kod_region" group="1" />
        <column table="kod_dop_contract" column="name_region" group="kod_region" />
        <column table="kod_dop_contract" column="kodres" group="2" />
        <column table="kodres" column="name" as="name_r" title="Район" group="kodres" />
        <column table="fl_build" column="id" group="3" />
        <column table="fl_build" column="name" as="name_build" title="Наличие работ" group="id" />
        <column table="kod_dop_contract" column="fl_discount" group="4" title="1 - льготные" />
        <column table="kod_spr_load" column="id" as="id_load" group="5" />
        <column table="kod_spr_load" column="name" as="name_load" title="Группа мощности" group="id_load" />
        <column table="kod_dop_contract" column="kod_dop_contract" group="6" />
        <column table="kod_dop_contract" column="srok_uslug" group="kod_dop_contract" />
        <fact column="is_dop_cont_count" group="sum" />
        <!--<call function="/" as="is_dop_cont_load123_mvt" title="Заявленная мощность, МВт" group="sum">
          <column table="this" column="is_dop_cont_load123_kvt" />
          <const>1000</const>
        </call>
        <call function="/" as="is_dop_cont_load_all_mvt" title="Суммарная мощность, МВт" group="sum">
          <column table="this" column="is_dop_cont_load_all_kvt" />
          <const>1000</const>
        </call>-->
        <fact column="is_dop_cont_load123_kvt" group="sum" mp="-3" />
        <fact column="is_dop_cont_load_all_kvt" group="sum" mp="-3" />
        <call function="+nvl" as="id_dop_cont_sum_all_nds" title="Стоимость АД c НДС" group="sum">
          <column table="this" column="id_dop_cont_contr_sum_m" />
          <column table="this" column="id_dop_cont_contr_sum_e" />
        </call>
        <fact column="id_dop_cont_contr_sum_m" group="sum" />
        <fact column="id_dop_cont_contr_sum_e" group="sum" />
        <!--<fact column="c_opl_opl_den"/>-->
        <call function="+nvl" as="opl_sum_all_nds" title="Сумма оплаты АД c НДС" group="sum">
          <column table="this" column="c_opl_opl_nds_den" />
          <column table="this" column="c_imuch_opl_nds" />
        </call>
        <fact column="c_opl_opl_nds_den" group="sum" table="opl" />
        <fact column="c_imuch_opl_nds" group="sum" table="opl" />
        <call function="+nvl" as="kido_ob_sum_all_nds" title="Остаток оплаты АД c НДС" group="sum">
          <column table="this" column="kido_ob_nds_den" />
          <column table="this" column="kido_ob_nds_imuch" />
        </call>
        <fact column="kido_ob_nds_den" group="sum" />
        <fact column="kido_ob_nds_imuch" group="sum" />
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract">
            <link name="kodres" />
            <link name="fl_build" />
            <link name="kod_spr_load" />
          </link>
          <dimset as="opl">
            <link name="kido_dat_opl" />
            <where>
              <call function="le">
                <column table="kido_dat_opl" column="val" />
                <useparam name="dat" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <where>
        <call function="and">
          <!--<call function="ge">
            <column table="kod_dop_contract" column="kn_zone" />
            <const>0</const>
          </call>-->
          <call function="=">
            <column table="kod_dop_contract" column="status" />
            <const>1</const>
          </call>
          <call function="is null">
            <column table="kod_dop_contract" column="kn_contract_p" />
          </call>
          <call function="between" optional="1">
            <useparam name="dat" />
            <column table="kod_dop_contract" column="dt_contract" />
            <call function="nvl">
              <call function="latest">
                <column table="kod_dop_contract" column="dat_status_2" />
                <column table="kod_dop_contract" column="dat_status_4" />
                <column table="kod_dop_contract" column="dat_rastorg" />
              </call>
              <const>sysdate</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="35058-rep" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <select>
        <call function="date to char" as="cur_date">
          <const>sysdate</const>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="35058-gr" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="35058" as="a">
          <grsets>
            <grset level="2" title="По подразделению" as="podr">
              <grset level="5" title="По годам" as="year"></grset>
              <grset level="3" title="По статусам" as="status"></grset>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="35058-simple" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="kod_direct_name" />
        <column table="a" column="req_year_fl" />
        <column table="a" column="status" />
        <column table="a" column="status_name" />
        <column table="a" column="kod_mo" />
        <column table="a" column="kod_mo_name" />
        <column table="a" column="is_dop_cont_count" />
      </select>
      <from>
        <query name="35058" as="a" grouplevel="5" />
      </from>
    </query>
    <query name="35058-detail" timestamp="15.02.2016 10:32:35" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <params>
        <param name="kod_direct" />
        <param name="status" />
        <param name="year" />
        <param name="kod_mo" />
      </params>
      <select>
        <column table="is_dop_contract" column="kod_dop_contract" />
        <column table="is_dop_contract" column="req_year_fl" title="Год" />
        <column table="kodres" column="kod_direct" />
        <column table="kodres" column="name" as="kod_direct_name" />
        <column table="status" column="status" />
        <column table="status" column="name" as="status_name" />
        <column table="kod_mo" column="kod" as="kod_mo" />
        <column table="kod_mo" column="name" as="kod_mo_name" />
        <column table="is_dop_contract" column="num_ad" />
        <column table="is_dop_contract" column="dt_contract" />
        <column table="is_dop_contract" column="contr_kind" />
      </select>
      <from>
        <query name="is_dop_contract">
          <link name="kodres" />
          <link name="status" />
          <link name="kod_mo" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=nvl">
            <column table="kodres" column="kod_direct" />
            <useparam name="kod_direct" />
          </call>
          <call function="=nvl">
            <column table="is_dop_contract" column="status" />
            <useparam name="status" />
          </call>
          <call function="=nvl">
            <column table="is_dop_contract" column="req_year_fl" />
            <useparam name="year" />
          </call>
          <call function="=nvl">
            <column table="kod_mo" column="kod" />
            <useparam name="kod_mo" />
          </call>
        </call>
      </where>
    </query>
    <query name="35058" timestamp="08.02.2016 13:01:22" grouplevel="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <select>
        <column table="is_dop_contract" column="kod_dop_contract" group="6" />
        <column table="is_dop_contract" column="req_year_fl" group="5" title="Год" />
        <column table="kodres" column="kod_direct" group="2" />
        <column table="kodres" column="name" as="kod_direct_name" group="kod_direct" />
        <column table="status" column="status" group="3" />
        <column table="status" column="name" as="status_name" group="status" />
        <column table="kod_mo" column="kod" as="kod_mo" group="4" />
        <column table="kod_mo" column="name" as="kod_mo_name" group="kod_mo" />
        <fact column="is_dop_cont_count" group="sum" title="Количество" />
        <fact column="is_dop_cont_count" as="is_dop_cont_count_by_mo" group="sum" title="Количество по подразделениям" dimname="mo">
          <pivot>
            <column table="kod_mo" column="kod" />
            <query order="kod_mo_name">
              <select>
                <column table="a" column="kod_mo" />
                <column table="a" column="kod_mo_name" />
              </select>
              <from>
                <query name="35058-mo" as="a" />
              </from>
            </query>
          </pivot>
        </fact>
      </select>
      <from>
        <query name="is_dop_contract">
          <link name="kodres" />
          <link name="status" />
          <link name="kod_mo" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" exclude="1">
            <column table="is_dop_contract" column="kod_direct" />
            <const>21</const>
          </call>
          <call function="in">
            <column table="is_dop_contract" column="status" />
            <array>
              <const>1</const>
              <const>2</const>
              <const>4</const>
            </array>
          </call>
          <call function="in" exclude="1">
            <column table="is_dop_contract" column="req_year" />
            <const>7</const>
          </call>
        </call>
      </where>
    </query>
    <query name="35058-mo" timestamp="08.02.2016 13:01:22" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <select>
        <column table="a" column="kod_mo" group="1" />
        <column table="a" column="kod_mo_name" group="max" />
      </select>
      <from>
        <query name="35058" as="a" grouplevel="no" />
      </from>
      <where>
        <call function="is not null">
          <column table="a" column="kod_mo" />
        </call>
      </where>
    </query>
    <query name="35210-title" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <params>
        <param name="dat" />
      </params>
      <select>
        <call function="date to char" as="sdate" group="max">
          <useparam name="dat" />
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="35210" timestamp="05.04.2016 09:59:06" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <params>
        <param name="dat">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="35210-data" as="a">
          <!--<withparams>
            <useparam name="dat" />
          </withparams>-->
          <grsets>
            <grset level="1" as="np2" title="2">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>3</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np31" title="3.1">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>2</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np311" title="3.1.1">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>2</const>
                  </call>
                  <call function="=">
                    <column table="a" column="status" />
                    <const>4</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np312" title="3.1.2">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>2</const>
                  </call>
                  <call function="in">
                    <column table="a" column="status" />
                    <array>2,12</array>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np313" title="3.1.3">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>2</const>
                  </call>
                  <call function="not in">
                    <column table="a" column="status" />
                    <array>2,12,4</array>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np32" title="3.2">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>1</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np321" title="3.2.1">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="a" column="status" />
                    <const>4</const>
                  </call>
                  <call function="le">
                    <call function="trunc">
                      <column table="a" column="dat_status_4" />
                    </call>
                    <useparam name="dat" />
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np322" title="3.2.2">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>1</const>
                  </call>
                  <call function="or">
                    <call function="and">
                      <call function="=">
                        <column table="a" column="status" />
                        <const>2</const>
                      </call>
                      <call function="le">
                        <call function="trunc">
                          <column table="a" column="dat_status_2" />
                        </call>
                        <useparam name="dat" />
                      </call>
                    </call>
                    <call function="and">
                      <call function="=">
                        <column table="a" column="status" />
                        <const>12</const>
                      </call>
                      <call function="le">
                        <call function="trunc">
                          <column table="a" column="dat_rastorg" />
                        </call>
                        <useparam name="dat" />
                      </call>
                    </call>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="1" as="np323" title="3.2.3">
              <where>
                <call function="and">
                  <call function="=nvl">
                    <column table="a" column="pr_ofz" />
                    <const>1</const>
                  </call>
                  <call function="not">
                    <call function="or">
                      <call function="and">
                        <call function="=">
                          <column table="a" column="status" />
                          <const>4</const>
                        </call>
                        <call function="le">
                          <call function="trunc">
                            <column table="a" column="dat_status_4" />
                          </call>
                          <useparam name="dat" />
                        </call>
                      </call>
                      <call function="and">
                        <call function="=">
                          <column table="a" column="status" />
                          <const>2</const>
                        </call>
                        <call function="le">
                          <call function="trunc">
                            <column table="a" column="dat_status_2" />
                          </call>
                          <useparam name="dat" />
                        </call>
                      </call>
                      <call function="and">
                        <call function="=">
                          <column table="a" column="status" />
                          <const>12</const>
                        </call>
                        <call function="le">
                          <call function="trunc">
                            <column table="a" column="dat_rastorg" />
                          </call>
                          <useparam name="dat" />
                        </call>
                      </call>
                    </call>
                  </call>
                </call>
              </where>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="35210-data" grouplevel="no" timestamp="25.02.2016 21:22:36" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <!--<params>
        <param name="dat">
          <const>sysdate</const>
        </param>
      </params>-->
      <select>
        <const as="npp" key="1" group="1" type="number">1</const>
        <column table="kod_dop_contract" column="kod_dop_contract" group="2" />
        <column table="kod_dop_contract" column="pr_ofz" nvl="0" group="3" />
        <column table="kod_dop_contract" column="status" group="4" />
        <column table="kod_dop_contract" column="dat_status_4" group="5" />
        <column table="kod_dop_contract" column="dat_status_2" group="6" />
        <column table="kod_dop_contract" column="dat_rastorg" group="7" />
        <fact column="is_dop_cont_count" as="is_dop_cont_count" group="sum" title="Всего по Ленэнерго" />
        <fact column="is_dop_cont_count" as="is_dop_cont_count_spb" group="sum" title="Всего СПб">
          <!--<if>
            <call function="gt">
              <column table="kod_dop_contract" column="kod_region" />
              <const>0</const>
            </call>
          </if>-->
          <if>
            <call function="not in">
              <column table="kod_dop_contract" column="kodres" />
              <array>21,22,24,26,20,27,23</array>
            </call>
          </if>
        </fact>
        <fact column="is_dop_cont_count" as="is_dop_cont_count_lo" group="sum" title="Всего ЛО">
          <!--<if>
            <call function="=">
              <column table="kod_dop_contract" column="kod_region" />
              <const>0</const>
            </call>
          </if>-->
          <if>
            <call function="in">
              <column table="kod_dop_contract" column="kodres" />
              <array>21,22,24,26,20,27,23</array>
            </call>
          </if>
        </fact>
        <column table="this" column="is_dop_cont_count_lo" group="sum" dimname="fil" as="is_dop_cont_count_f">
          <pivot title="по филиалам">
            <column table="kod_dop_contract" column="kodres" group="1" as="kod_direct" />
            <query order="name">
              <select>
                <column table="kod_direct" column="kod_direct" />
                <column table="kod_direct" column="name_kr" as="name" />
              </select>
              <from>
                <query name="is_spr_direct" as="kod_direct" />
              </from>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="kod_direct" column="gor_obl" />
                    <const>0</const>
                  </call>
                  <call function="=1">
                    <column table="kod_direct" column="invest_pr" />
                  </call>
                  <call function="=">
                    <column table="kod_direct" column="kod_parent" />
                    <const>3</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract">
            <link name="kodres" />
          </link>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
        </call>
      </where>
    </query>
    <query name="35210-detail" grouplevel="no" timestamp="21.11.2016 14:21:01" is-report="1" title="Абонентские договоры" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <params>
        <param name="gor_obl" />
        <param name="kodres" />
      </params>
      <select>
        <column table="level1" column="kod_dop_contr_anl_gr" as="kod_dop_contr_anl_gr1" />
        <column table="level2" column="kod_dop_contr_anl_gr" as="kod_dop_contr_anl_gr2" />
        <column table="level3" column="kod_dop_contr_anl_gr" as="kod_dop_contr_anl_gr3" />
        <call function="coalesce" as="num" title="№">
          <column table="level3" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr3" />
          <column table="level2" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr2" />
          <column table="level1" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr1" />
        </call>
        <call function="coalesce" as="g_name" title="Группа">
          <column table="level3" column="name" as="name3" />
          <column table="level2" column="name" as="name2" />
          <column table="level1" column="name" as="name1" />
        </call>
        <column table="kodres" column="name_kr" />
        <column table="kn_customer" column="name" />
        <column table="kod_dop_contract" column="num_ad" />
        <column table="kod_dop_contract" column="dt_contract" />
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract" all-rows="1">
            <link name="kodres" />
            <link name="kn_customer" />
          </link>
          <link name="kido_kod_dop_contr_anl_gr" as="kod_dop_contr_anl_gr">
            <link name="level1" />
            <link name="level2" />
            <link name="level3" />
          </link>
          <where>
            <call function="=" optional="1">
              <column table="kod_dop_contract" column="kod_region" />
              <useparam name="gor_obl" />
            </call>
            <call function="=" optional="1">
              <column table="kod_dop_contract" column="kodres" />
              <useparam name="kodres" />
            </call>
          </where>
        </qube>
      </from>
      <!--<params>
        <param name="dat">
          <const>sysdate</const>
        </param>
      </params>-->
    </query>
    <query name="35210-new" timestamp="19.04.2019 19:13:12" is-report="1" folder="invpro_ofz" title="Аналитика по абонентским договорам и договорам подряда ПАО 'Ленэнерго'" mode="excel" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <content>
        <usefield field="date" name="dat" valuequery="cur-date" />
      </content>
      <procedure>
        <text>BEGIN
    vg_kido_analytics.fill_dop_contr_anl (:dat);

END;
</text>
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35210-new.xml" title="Аналитика по абонентским договорам и договорам подряда ПАО 'Ленэнерго'" print-proc="2" />
        </excel>
      </print-templates>
      <events>
        <useaction event-name="double-click" action-type="open-grouping-detail" call="35210-detail" column="is_dop_cont_count_spb">
          <const>1</const>
        </useaction>
        <useaction event-name="double-click" action-type="open-grouping-detail" call="35210-detail" column="is_dop_cont_count_lo">
          <const>0</const>
        </useaction>
        <useaction event-name="double-click" action-type="open-grouping-detail" call="35210-detail" column="is_dop_cont_count_f">
          <const>0</const>
          <col-dim-val name="fil" />
        </useaction>
        <useaction event-name="double-click" action-type="open-grouping-detail" call="35210-detail" column="is_dop_cont_count" />
      </events>
      <!--<params>
        <param name="dat">
          <const>sysdate</const>
        </param>
      </params>-->
      <select>
        <call function="date to char" as="sdate" group="max">
          <useparam name="dat" />
        </call>
        <column table="level1" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr1" />
        <column table="level1" column="name" as="name1" />
        <column table="level2" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr2" />
        <column table="level2" column="name" as="name2" />
        <column table="level3" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr3" />
        <column table="level3" column="name" as="name3" />
        <call function="coalesce" as="num" title="№" group="max" exclude="1">
          <column table="level3" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr3" />
          <column table="level2" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr2" />
          <column table="level1" column="kod_dop_contr_anl_gr" title="№" as="kod_dop_contr_anl_gr1" />
        </call>
        <fact column="is_dop_cont_count" as="is_dop_cont_count" group="sum" title="Всего по Ленэнерго" />
        <fact column="is_dop_cont_count" as="is_dop_cont_count_spb" group="sum" title="Всего СПб">
          <if>
            <call function="=">
              <column table="kod_dop_contract" column="kod_region" />
              <const>1</const>
            </call>
            <call function="not in" exclude="1">
              <column table="kod_dop_contract" column="kodres" />
              <array>21,22,24,26,20,27,23</array>
            </call>
          </if>
          <!--<if>
            <call function="gt">
              <column table="kod_dop_contract" column="kod_region" />
              <const>0</const>
            </call>
          </if>-->
        </fact>
        <fact column="is_dop_cont_count" as="is_dop_cont_count_lo" group="sum" title="Всего ЛО">
          <if>
            <call function="in" exclude="1">
              <column table="kod_dop_contract" column="kodres" />
              <array>21,22,24,26,20,27,23</array>
            </call>
            <call function="=">
              <column table="kod_dop_contract" column="kod_region" />
              <const>0</const>
            </call>
          </if>
          <!--<if>
            <call function="=">
              <column table="kod_dop_contract" column="kod_region" />
              <const>0</const>
            </call>
          </if>-->
        </fact>
        <column table="kod_dop_contract" column="kodres" group="max" />
        <column table="this" column="is_dop_cont_count_lo" group="sum" dimname="fil" as="is_dop_cont_count_f">
          <pivot title="по филиалам">
            <column table="this" column="kodres" group="" />
            <query order="name">
              <select>
                <column table="kodres" column="kod_direct" group="1" />
                <column table="kodres" column="name_kr" as="name" group="max" />
              </select>
              <from>
                <qube>
                  <link name="kod_dop_contract" all-rows="1">
                    <link name="kodres" />
                  </link>
                  <link name="kido_kod_dop_contr_anl_gr" as="kod_dop_contr_anl_gr" />
                  <where>
                    <call function="=">
                      <column table="kod_dop_contract" column="kod_region" />
                      <const>0</const>
                    </call>
                    <call function="is not null">
                      <column table="kod_dop_contr_anl_gr" column="kod_dop_contr_anl_gr" />
                    </call>
                  </where>
                </qube>
                <query name="is_dop_contract" as="kod_dop_contract" exclude="1">
                  <link name="kodres" />
                  <link name="kod_direct" />
                </query>
              </from>
              <where exclude="1">
                <call function="and">
                  <call function="=">
                    <column table="kod_direct" column="gor_obl" />
                    <const>0</const>
                  </call>
                  <call function="=1">
                    <column table="kod_direct" column="invest_pr" />
                  </call>
                  <call function="=">
                    <column table="kod_direct" column="kod_parent" />
                    <const>3</const>
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract">
            <link name="kodres" />
          </link>
          <link name="kido_kod_dop_contr_anl_gr" all-rows="1" as="kod_dop_contr_anl_gr">
            <link name="level1" />
            <link name="level2" />
            <link name="level3" />
          </link>
        </qube>
      </from>
      <grouping>
        <grset as="all">
          <where>
            <call function="is not null">
              <column table="this" column="kod_dop_contr_anl_gr1" />
            </call>
          </where>
        </grset>
        <grset as="np1">
          <group>
            <sourcelink table="level1" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr1" />
              <const>'1'</const>
            </call>
          </where>
        </grset>
        <grset as="np1x">
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr1" />
              <const>'1'</const>
            </call>
            <call function="is not null">
              <column table="this" column="kod_dop_contr_anl_gr2" />
            </call>
          </where>
          <group>
            <sourcelink table="level2" />
          </group>
        </grset>
        <grset as="np2">
          <group>
            <sourcelink table="level1" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr1" />
              <const>'2'</const>
            </call>
          </where>
        </grset>
        <grset as="np2x">
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr1" />
              <const>'2'</const>
            </call>
            <call function="is not null">
              <column table="this" column="kod_dop_contr_anl_gr2" />
            </call>
          </where>
          <group>
            <sourcelink table="level2" />
          </group>
        </grset>
        <grset as="np3">
          <group>
            <sourcelink table="level1" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr1" />
              <const>'3'</const>
            </call>
          </where>
        </grset>
        <grset as="np31">
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr2" />
              <const>'3.1'</const>
            </call>
          </where>
          <group>
            <sourcelink table="level2" />
          </group>
          <grset as="np31x">
            <where>
              <call function="is not null">
                <column table="this" column="kod_dop_contr_anl_gr3" />
              </call>
            </where>
            <group>
              <sourcelink table="level3" />
            </group>
          </grset>
        </grset>
        <grset as="np32">
          <where>
            <call function="=">
              <column table="this" column="kod_dop_contr_anl_gr2" />
              <const>'3.2'</const>
            </call>
          </where>
          <group>
            <sourcelink table="level2" />
          </group>
          <grset as="np32x">
            <where>
              <call function="le">
                <column table="this" column="kod_dop_contr_anl_gr3" />
                <const>'3.2.4'</const>
              </call>
            </where>
            <group>
              <sourcelink table="level3" />
            </group>
          </grset>
          <grset as="np32xo">
            <where>
              <call function="gt">
                <column table="this" column="kod_dop_contr_anl_gr3" />
                <const>'3.2.4'</const>
              </call>
            </where>
            <group>
              <sourcelink table="level3" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="41293-data" timestamp="17.01.2018 16:32:00" order="decode(status,4,0,1,1,5,2,0,3,2,4,5), num_req desc, num_ouco" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <params>
        <usepart part="41293-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="is_ad_all" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is not null">
            <column table="a" column="kod_dop_contract" />
          </call>
        </call>
      </where>
    </query>
    <query name="41293-zayavka-list-pre" timestamp="05.10.2018 13:37:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <column table="a" column="num_req" as="id" title="-" group="1" />
        <column table="a" column="num_req" as="name" group="max" />
      </select>
      <from>
        <query name="is_dop_contract" as="a" />
      </from>
    </query>
    <query name="41293-data-par" timestamp="09.01.2019 15:32:14" order="decode(status,4,0,1,1,5,2,0,3,2,4,5), num_req desc, num_ouco" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <params>
        <usepart part="41293-params-ext" />
      </params>
      <select>
        <column table="a" column="*" />
        <call as="ost_viruchki" function="-nvl">
          <column table="a" column="contr_sumf" />
          <column table="a" column="sum_akts" />
        </call>
        <call as="key" function="||">
          <column table="a" column="num_ouco" />
          <column table="a" column="num_req" />
        </call>
      </select>
      <from>
        <query name="vr_ad_all_base_cur" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="kod_dop_contract" />
          </call>
          <call function="or">
            <call function="=">
              <const>1</const>
              <const>0</const>
            </call>
            <call function="in" optional="1">
              <column table="a" column="kod_dop_contract" />
              <useparam name="kod_dop_contract" />
            </call>
          </call>
          <call function="is null" comment="Не ДС (доп согл)">
            <column table="a" column="kn_contract_p" />
          </call>
          <call function="=" comment="договорами на ТП не являются договоры типа &quot;К&quot;, &quot;Р&quot;, &quot;ИП&quot;, а также договоры, имеющие признак &quot;ЦП&quot; (например, &quot;тестовые&quot;)">
            <call function="nvl0">
              <column table="a" column="cp" />
            </call>
            <const>0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="41293-zayavka-list" timestamp="05.10.2018 13:34:20" order="name" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <column table="a" column="id" as="id" title="-" group="1" />
        <column table="a" column="name" as="name" group="max" is-name="1" />
      </select>
      <from>
        <query name="41293-zayavka-list-pre" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="name" />
          </call>
        </call>
      </where>
    </query>
    <query name="41293-sel-ids" timestamp="21.11.2018 13:44:25" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <params>
        <usepart part="41293-params-ext" />
      </params>
      <select>
        <column table="a" column="kod_dop_contract" />
      </select>
      <from>
        <query name="is_dop_contract" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="kod_dop_contract" />
          </call>
          <call function="or">
            <call function="=">
              <const>1</const>
              <const>0</const>
            </call>
            <call function="in" optional="1">
              <column table="a" column="num_req" />
              <useparam name="num_req" />
            </call>
            <call function="in" optional="1">
              <column table="a" column="kod_dop_contract" />
              <useparam name="kod_dop_contr_filtr" />
            </call>
            <call function="in" optional="1">
              <call function="||">
                <column table="a" column="num_ouco" />
                <column table="a" column="num_req" />
              </call>
              <useparam name="key" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="41293-ad-list" timestamp="21.11.2018 13:51:37" order="name" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <column table="a" column="id" as="id" title="-" group="1" />
        <column table="a" column="name" as="name" is-name="1" group="max" />
      </select>
      <from>
        <query name="41293-ad-list-pre" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="name" />
          </call>
        </call>
      </where>
    </query>
    <query name="41293-key-list" timestamp="21.11.2018 14:32:44" order="name" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <column table="a" column="id" as="id" title="-" group="1" />
        <column table="a" column="name" as="name" is-name="1" group="max" />
      </select>
      <from>
        <query name="41293-key-list-pre" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="name" />
          </call>
        </call>
      </where>
    </query>
    <query name="41293-ad-list-pre" timestamp="21.11.2018 13:41:49" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <column table="a" column="kod_dop_contract" as="id" title="-" />
        <column table="a" column="num_ouco" as="name" />
      </select>
      <from>
        <query name="is_dop_contract" as="a" />
      </from>
    </query>
    <query name="41293-key-list-pre" timestamp="21.11.2018 14:33:29" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <select>
        <call title="-" as="id" function="||" group="1">
          <column table="a" column="num_ouco" />
          <column table="a" column="num_req" />
        </call>
        <call title="Ключ" as="name" function="||" group="max">
          <column table="a" column="num_ouco" />
          <column table="a" column="num_req" />
        </call>
      </select>
      <from>
        <query name="is_dop_contract" as="a" />
      </from>
    </query>
    <query name="42415" timestamp="10.07.2017 13:33:16" is-report="1" nogrid="1" title="Данные об авансовых платежах по договорам ТП ОФЗ" folder="kido" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\42415.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="42415.xlsx" title="Данные об авансовых платежах по договорам ТП ОФЗ" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <select>
        <column table="a" column="kod" exclude="1" />
        <column table="a" column="col_1" title="col1" group="max" />
        <column table="a" column="col_2" title="col2" group="max" />
        <column table="year" column="val" as="v1" title="Период" />
        <column table="pr_str" column="val" as="v2" />
        <fact column="br_kz_ad_ofz_opl_vsego" title="Оплата всего" group="sum" as="opl_vsego" nvl="0" />
        <fact column="br_kz_ad_ofz_akts_vsego" title="Выручка всего" group="sum" as="akts_vsego" nvl="0" />
        <fact column="br_kz_ad_ofz_kz_start" title="КЗ на начало периода" group="sum" as="kz_start" nvl="0" />
        <fact column="br_kz_ad_ofz_opl" title="Поступление оплаты" group="sum" as="opl" nvl="0" />
        <fact column="br_kz_ad_ofz_storno" title="Закрытие выручки" group="sum" as="storno" nvl="0" />
        <fact column="br_kz_ad_ofz_kz_end" title="КЗ на конец периода" group="sum" as="kz_end" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="buh_reestr_kz_ad_ofz" as="a" />
          <link name="pr_str" />
          <link name="year" />
        </qube>
      </from>
      <grouping>
        <grset as="all">
          <usepart part="42415-grsets">
            <const>'all_'</const>
          </usepart>
        </grset>
        <grset as="go">
          <group>
            <sourcelink table="pr_str" />
          </group>
          <usepart part="42415-grsets">
            <const>'go_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="43107" timestamp="07.12.2017 12:30:26" is-report="1" title="Отчёт по социально-значимым и приоритетным объектам" order="col1 desc nulls last" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43107.xml">
      <print-templates>
        <excel>
          <template name="43107.xlsx" title="Отчёт по социально-значимым и приоритетным объектам" print-proc="2" print-xlsx="1" use-flexcel="1" />
        </excel>
      </print-templates>
      <content>
        <usefield field="cmn_list" title="Титулы" type="number" name="kod_titul_ip" rows-limit="100">
          <listquery>
            <query name="ipr_titul_ip_prior_simple_list" />
          </listquery>
        </usefield>
        <usefield field="cmn_list" show-nulls="1" type="number" name="kod_person" title="Кураторы">
          <listquery>
            <query name="is_person_43107_list" />
          </listquery>
        </usefield>
        <!--<usefield field="ipr_kod_person" show-nulls="1" />-->
      </content>
      <expressions>
        <call function="and" as="dog_pir" exclude="1">
          <call function="in">
            <column table="ipr_kod_vip_dog" column="kodzatrat" />
            <array>
              <const>1</const>
              <const>80</const>
            </array>
          </call>
          <call function="gt">
            <column column="vsego" table="ipr_kod_vip_dog" nvl="0" />
            <const>0</const>
          </call>
        </call>
        <call function="and" as="dog_smr" exclude="1">
          <call function="in">
            <column table="ipr_kod_vip_dog" column="kodzatrat" />
            <array>
              <const>2</const>
              <const>81</const>
            </array>
          </call>
          <call function="gt">
            <column column="vsego" table="ipr_kod_vip_dog" nvl="0" />
            <const>0</const>
          </call>
        </call>
        <call function="and" as="dog_pir">
          <call function="=">
            <column table="ipr_kod_dog" column="prizn_pir" />
            <const>1</const>
          </call>
        </call>
        <call function="and" as="dog_smr">
          <call function="=">
            <column table="ipr_kod_dog" column="prizn_smr" />
            <const>1</const>
          </call>
        </call>
        <call function="and" as="dop_doc_rtn" dontpushpred="1">
          <call function="=">
            <column table="kido_kod_dop_doc" column="kod_vid_doc" />
            <const>131</const>
          </call>
        </call>
        <call function="and" as="dop_doc_ks11" dontpushpred="1">
          <call function="=">
            <column table="kido_kod_dop_doc" column="kod_vid_doc" />
            <const>103</const>
          </call>
        </call>
        <call function="and" as="dop_doc_ks14" dontpushpred="1">
          <call function="=">
            <column table="kido_kod_dop_doc" column="kod_vid_doc" />
            <const>104</const>
          </call>
        </call>
        <call group="/*inner*/" as="stage_project" function="listagg" type="string">
          <fact condition="dog_pir" column="is_dogovor_dat_srok_f_text" />
          <const>','||chr(13)||chr(10)</const>
          <const>1</const>
        </call>
        <call group="/*inner*/" as="stage_smr" function="listagg" type="string">
          <fact column="is_dogovor_dat_srok_f_text" condition="dog_smr" />
          <const>','||chr(13)||chr(10)</const>
          <const>1</const>
        </call>
        <call group="stragg" as="podr_pir_name" function="()" type="string">
          <fact column="is_creditors_name" condition="dog_pir" />
        </call>
        <call group="stragg" as="podr_smr_name" function="()" type="string">
          <fact column="is_creditors_name" condition="dog_smr" />
        </call>
        <call group="max" as="stage_rtn" function="trunc" type="string">
          <call function="coalesce">
            <fact column="c_dop_doc_dat_doc" condition="dop_doc_rtn" />
            <fact column="c_dop_doc_dat_doc" condition="dop_doc_ks11" />
            <fact column="c_dop_doc_dat_doc" condition="dop_doc_ks14" />
          </call>
        </call>
        <call function="||" as="atp" group="max">
          <call function="date to char">
            <fact column="as_sert_power_dop_contract_dt_delivery" />
          </call>
          <const>' '</const>
          <fact column="as_sert_power_dop_contract_vid_atp" />
        </call>
        <call function="listagg" as="col20" group="/*inner*/">
          <fact column="ipr_sost_del_column_info_last_ipr" />
          <const>chr(13)||chr(10)||chr(13)||chr(10)</const>
          <column table="ipr_kod_sost_del" column="kod_sost_del" />
        </call>
        <call function="listagg" as="col21" group="/*inner*/">
          <fact column="ipr_sost_del_sost_del_text_last_ipr" />
          <const>chr(13)||chr(10)||chr(13)||chr(10)</const>
          <column table="ipr_kod_sost_del" column="kod_sost_del" />
        </call>
      </expressions>
      <select>
        <column table="kod_dop_contract" column="kod_dop_contract" group="1" />
        <column table="ipr_kod_titul_ip" column="tit_num_new" group="max" as="col_inv1" comment="для проверки по просьбе Грошевой" />
        <column table="ipr_kod_titul_ip" column="name" group="max" as="col_inv2" comment="для проверки по просьбе Грошевой" />
        <column table="kod_dop_contract" column="num_req" title="Заявка" group="max" as="col1" comment="по комментарию Победри (файл)" />
        <column table="kod_dop_contract" column="lp_addr" title="Адрес объекта" group="max" as="col2" comment="по комментарию Победри (файл)" />
        <call function="||" as="col3" title="Заявитель и присоединяемый объект" group="max" comment="по комментарию Победри (файл)">
          <column table="e_code" column="name" />
          <const>', '</const>
          <column table="kod_obj" column="name" />
        </call>
        <column table="kod_dop_contract" column="name_region_kr" title="Регион" group="max" as="col4" comment="по комментарию Победри (файл)" />
        <column table="kod_dop_contract" column="ks_region" title="Район" group="max" as="col5" comment="по комментарию Победри (файл)" />
        <call function="nvl" as="col6" group="max" comment="по комментарию Победри (файл)">
          <column table="kod_org_active" column="name" title="ДЗО" />
          <const>'Ленэнерго'</const>
        </call>
        <band title="Персональная ответственность/должностное лицо">
          <column title="Блок капитального строительства" group="max" as="col7" comment="по разговору с Грошевой - из последней заполненной версии ИПР" table="kod_kurator" column="fio" />
          <column table="kod_spr_kurators" column="name" title="Блок технологического присоединения" group="max" as="col8" comment="по разговору с Ретневой/Грошевой" />
        </band>
        <column table="kod_dop_contract" column="srok_uslug" group="max" title="Срок оказания услуг по АД" as="col9" comment="по комментарию Победри (файл)" />
        <call function="||" as="col10" group="max" comment="по комментарию Победри (файл)">
          <call function="lpad">
            <call function="to_char">
              <column table="ipr_kod_titul_ip" column="end_period" />
            </call>
            <const>2</const>
            <const>'0'</const>
          </call>
          <call function="if">
            <call function="is not null">
              <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
            </call>
            <const>'.'</const>
          </call>
          <call function="lpad">
            <call function="to_char">
              <column table="ipr_kod_titul_ip" column="end_year" />
            </call>
            <const>4</const>
            <const>'0'</const>
          </call>
        </call>
        <fact column="podr_pir_name" as="col11" group="stragg" title="Подрядчик на выполнение ПИР" comment="по разговору с Ретневой" />
        <fact column="podr_smr_name" as="col12" group="stragg" title="Подрядчик на выполнение СМР" comment="по разговору с Ретневой" />
        <call function="if" as="col13" title="Работы на источнике питания (да/нет)" group="max" type="string" comment="по разговору с Ретневой">
          <call function="=">
            <column table="kod_dop_contract" column="fl_work_ps" />
            <const>1</const>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <band title="Стадии реализации проекта">
          <fact as="col14" type="string" column="stage_project" title="Проектирование" group="max" comment="по комментарию Грошевой (файл)" />
          <band title="Строительно-монтажные работы">
            <fact as="col15" type="string" column="stage_smr" title="Выполнение СМР" group="max" comment="по комментарию Грошевой (файл)" />
            <const as="col16" type="string" comment="не заполняем">null</const>
          </band>
          <band title="Включение объекта">
            <call function="date to char" group="max" title="Акт допуска РТН" as="col17" comment="по комментарию Грошевой (файл)">
              <fact type="string" column="stage_rtn" />
            </call>
            <const as="col18" type="string" comment="не заполняем">null</const>
          </band>
          <fact as="col19" type="string" column="atp" title="АТП" group="max" comment="по комментарию Грошевой (файл)" />
        </band>
        <fact type="string" title="Объём работ" group="max" comment="по разговору с Грошевой - из последней заполненной версии ИПР" column="col20" />
        <fact type="string" title="Состояние дел по объекту и проблематика" group="max" comment="по разговору с Грошевой - из последней заполненной версии ИПР" column="col21" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_titul_ip">
            <link name="kod_kurator" />
          </link>
          <link name="kod_ipr" only-for-cond="1" />
          <link name="kod_dop_contract">
            <link name="e_code" />
            <link name="kod_obj" />
            <link name="kod_org_active" />
            <link name="kod_spr_kurators" />
          </link>
          <where>
            <call function="le" comment="для отладки" exclude="1">
              <call function="rownum" />
              <const>100</const>
            </call>
            <call function="=" exclude="1">
              <column table="kod_dop_contract" column="kod_dop_contract" />
              <const>3087929</const>
            </call>
            <call function="is not null">
              <column table="kod_ipr" column="kod_prin_soc_val" />
            </call>
            <call function="!=">
              <column table="kod_ipr" column="kod_prin_soc_val" />
              <const>81</const>
            </call>
            <call function="is not null">
              <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
            </call>
            <call function="in nnull" optional="1">
              <column table="ipr_kod_titul_ip" column="kod_kurator" />
              <useparam name="kod_person" />
            </call>
            <call function="in" optional="1">
              <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="43430-detail" timestamp="31.08.2017 11:41:44" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <params>
        <usepart part="43430-params" />
      </params>
      <select>
        <column table="a" column="isv_pd_msp_akt_id" />
        <column table="a" column="kod_dog" />
        <column table="a" column="kod_vip_dog" />
        <call function="dense_rank" as="npp" title="№">
          <call function="partition by">
            <column table="a" column="kod_dog" />
            <column table="a" column="kod_vip_dog" exclude="1" />
          </call>
          <call function="order by 2">
            <column table="a" column="kod_dog" exclude="1" />
            <column table="a" column="kod_vip_dog" />
          </call>
        </call>
        <column table="a" column="num_dog" />
        <column table="a" column="dat_dog" />
        <column table="a" column="predm_dog" />
        <column table="a" column="name_kred" />
        <column table="a" column="inn" />
        <column table="a" column="kpp" />
        <column table="a" column="vsego_dog" mp="-3" />
        <column table="a" column="dat_doc" />
        <column table="a" column="dat_srok" />
        <column table="a" column="dat_opl" />
        <column table="a" column="sum_akt" mp="-3" />
        <column table="a" column="sum_opl" mp="-3" />
        <column table="a" column="srok_zadol" />
        <column table="a" column="reason_zadol" />
        <column table="a" column="dat_plan_zadol" />
        <column table="a" column="dop_info" />
      </select>
      <from>
        <query name="isv_pd_msp_akt" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="a" column="kod_predpr" />
            <useparam name="kod_predpr" />
          </call>
        </call>
      </where>
    </query>
    <query name="43430-itog" timestamp="17.01.2019 15:05:10" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <params>
        <usepart part="43430-params" />
      </params>
      <select>
        <call function="trunc" as="vsego_dog">
          <column table="a" column="vsego_dog" group="sumnvl" mp="-3" />
        </call>
        <call function="trunc" as="zadol_kred">
          <column table="a" column="zadol_kred" group="sumnvl" mp="-3" />
        </call>
        <call function="trunc" as="zadol_kred_srok">
          <column table="a" column="zadol_kred_srok" group="sumnvl" mp="-3" />
        </call>
        <call function="trunc" as="zadol_kred_srok_msp">
          <column table="a" column="zadol_kred_srok_msp" group="sumnvl" mp="-3" />
        </call>
        <call function="date to char" as="sdate" exclude="1">
          <useparam name="p_date" />
        </call>
        <call as="sdate" function="||">
          <call function="||" optional="1">
            <const>' с '</const>
            <call function="date to char">
              <useparam name="p_date_s" />
            </call>
          </call>
          <const>' по '</const>
          <call function="date to char">
            <useparam name="p_date_po" />
          </call>
        </call>
      </select>
      <from>
        <query name="isv_pd_msp_akt_itog" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="a" column="kod_predpr" />
            <useparam name="kod_predpr" />
          </call>
        </call>
      </where>
    </query>
    <query name="43430-deps" timestamp="07.09.2017 16:30:45" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <select>
        <column table="a" column="id" type="number" key="1" vid="1" />
        <column table="a" column="name" type="string" title="Наименование" vid="1" />
        <column table="a" column="cnt_dog" type="number" title="К-во дог." vid="1" />
        <column table="a" column="kod_parent" type="number" vid="1" />
      </select>
      <from>
        <table name="43430-deps-view" view="1" as="a" />
      </from>
    </query>
    <query name="53499" timestamp="09.07.2020 17:04:27" is-report="1" with-behavior="1" title="Заявки за весь период (OLD)" visible="0" mode="default" nogrid="1" datareader="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <print-templates>
        <excel>
          <template name="53499.xlsx" title="Заявки за весь период" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <!--<print-templates>
        <excel>
          <template name="26630.xlsx" title="Отчет по исполнителю" print-xlsx="1" print-proc="2" del-cols="1" output-format="xlsb" />
        </excel>
      </print-templates>-->
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <column table="zz" column="kod_zayav" />
        <column table="zz" column="num_zayav" />
        <call as="dat_zayav" function="trunc" type="date">
          <column table="zz" column="dat_zayav" />
        </call>
        <column table="kod_spr_query" column="name" as="type_zayav" />
        <column table="c_zayav_family" column="name_path" />
        <column table="kodp" column="name" as="kontragent" />
        <call as="region" type="string" function="case">
          <call function="when">
            <call function="=">
              <call function="nvl0">
                <column table="c_zayav_family" column="pr_city" />
              </call>
              <const>1</const>
            </call>
            <const>'Город'</const>
          </call>
          <call function="when">
            <call function="=">
              <call function="nvl0">
                <column table="c_zayav_family" column="pr_city" />
              </call>
              <const>0</const>
            </call>
            <const>'Область'</const>
          </call>
        </call>
        <column table="c_zayav_family" column="name_filial" />
        <column table="c_zayav_family" column="str_adr" />
        <call as="n_zayav" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="d_k2" />
          <column table="oz" column="d_k3" />
        </call>
        <column table="oz" column="d_k1" as="n_zayav1" />
        <column table="oz" column="d_k2" as="n_zayav2" />
        <column table="oz" column="d_k3" as="n_zayav3" />
        <call as="n_susch" function="+">
          <column table="oz" column="s_k1" />
          <column table="oz" column="s_k2" />
          <column table="oz" column="s_k3" />
        </call>
        <column table="oz" column="s_k1" as="n_susch1" />
        <column table="oz" column="s_k2" as="n_susch2" />
        <column table="oz" column="s_k3" as="n_susch3" />
        <call as="n" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="d_k2" />
          <column table="oz" column="d_k3" />
          <column table="oz" column="s_k1" />
          <column table="oz" column="s_k2" />
          <column table="oz" column="s_k3" />
        </call>
        <call as="n1" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="s_k1" />
        </call>
        <call as="n2" function="+">
          <column table="oz" column="d_k2" />
          <column table="oz" column="s_k2" />
        </call>
        <call as="n3" function="+">
          <column table="oz" column="d_k3" />
          <column table="oz" column="s_k3" />
        </call>
        <column table="kod_voltage" column="name_kr" />
        <column table="ist_pit" column="name_tp_1" />
        <column table="ist_pit" column="name_ist_1" />
        <column table="ist_pit" column="name_ist_2" />
        <column table="kn_st_req" column="name" as="status_zayav" />
        <column table="st_det" column="status_zayav_det" />
        <call as="date_coming" function="trunc" type="date">
          <column table="rq" column="date_coming" />
        </call>
        <call function="()" as="dt_project" type="date">
          <const>pres.AS_CONTR_PROPS(rq.kn_request, 2)</const>
        </call>
        <call as="dat_ready" function="trunc" type="date">
          <column table="dt_docs" column="dat_ready" />
        </call>
        <call as="dat_download" function="trunc" type="date">
          <column table="dt_docs" column="dat_download" />
        </call>
        <call as="dat_sign" function="trunc" type="date">
          <column table="dt_docs" column="dat_sign" />
        </call>
      </select>
      <from>
        <query name="c_zayav" as="zz">
          <link name="c_zayav_energo">
            <link name="kod_voltage" />
          </link>
          <link name="c_zayav_family" />
          <link name="kodp" />
          <link name="kod_spr_query" />
        </query>
        <query name="as_request" as="rq" join="inner">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="rq" column="kod_zayav" />
          </call>
          <link name="kn_st_req" />
        </query>
        <query name="53499-zayav_power" as="oz" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="oz" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_status_detailed" as="st_det" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="st_det" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_ist_pit" as="ist_pit" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="ist_pit" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_dats_doc" as="dt_docs" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="dt_docs" column="kod_zayav" />
          </call>
        </query>
      </from>
    </query>
    <query name="53499-zayav_power" timestamp="19.07.2019 12:17:54" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="a" column="kod_zayav" group="1" />
        <call function="nvl0" as="s_k1" title="Существующая мощность, кат. 1" group="sum">
          <column table="a" column="qs_so" />
        </call>
        <call function="nvl0" as="s_k2" title="Существующая мощность, кат. 2" group="sum">
          <column table="a" column="qs_sw" />
        </call>
        <call function="nvl0" as="s_k3" title="Существующая мощность, кат. 3" group="sum">
          <column table="a" column="qs_sk" />
        </call>
        <call function="nvl0" as="d_k1" title="Добавленная мощность, кат. 1" group="sum">
          <column table="a" column="qd_so" />
        </call>
        <call function="nvl0" as="d_k2" title="Добавленная мощность, кат. 2" group="sum">
          <column table="a" column="qd_sw" />
        </call>
        <call function="nvl0" as="d_k3" title="Добавленная мощность, кат. 3" group="sum">
          <column table="a" column="qd_sk" />
        </call>
      </select>
      <from>
        <query name="qr_numobj_zayav" as="a" />
      </from>
    </query>
    <query name="53499-zayav_status_detailed" timestamp="19.07.2019 12:17:55" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="zz" column="kod_zayav" group="1" />
        <column table="kod_spr_viz" column="name" group="stragg_dist" as="status_zayav_det" />
      </select>
      <from>
        <query name="c_zayav" as="zz" />
        <query name="is_viza_agr_doc_last" as="l" join="left outer">
          <call function="=">
            <column table="l" column="full_kod_doc" />
            <call function="nvl">
              <column table="zz" column="full_code_doc" />
              <call function="||">
                <const>'ZYV_'</const>
                <column table="zz" column="kod_zayav" />
              </call>
            </call>
          </call>
          <link name="kod_spr_viz" />
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="kod_spr_viz" column="name" />
        </call>
      </where>
    </query>
    <query name="53499-zayav_ist_pit" timestamp="19.07.2019 12:17:55" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="l" column="kod_zayav" group="1" />
        <column table="qr_tu_energo" column="name_tp_1" group="stragg_dist" />
        <column table="qr_tu_energo" column="name_ist_1" group="stragg_dist" />
        <column table="qr_tu_energo" column="name_ist_2" group="stragg_dist" />
      </select>
      <from>
        <query name="qr_links" as="l">
          <link name="kod_tu">
            <link name="qr_tu_energo" />
          </link>
        </query>
      </from>
    </query>
    <query name="53499-zayav_dt_download_lkk" timestamp="19.07.2019 11:58:25" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="a" column="kod_dop_contract" />
        <column table="a" column="dat_first_download_lkk" />
      </select>
      <from>
        <query name="c_dop_doc" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_vid_doc" />
            <const>27</const>
          </call>
          <call function="is null">
            <column table="a" column="dat_end" />
          </call>
        </call>
      </where>
    </query>
    <query name="53499-zayav_dt_sign_lkk" timestamp="19.07.2019 11:58:25" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="a" column="kod_dop_contract" />
        <column table="kod_dop_doc" column="dt_sign" />
      </select>
      <from>
        <query name="c_dop_doc" as="a" />
        <query name="c_dop_doc_sign" as="kod_dop_doc" join="left outer">
          <call function="=">
            <column table="a" column="kod_dop_doc" />
            <column table="kod_dop_doc" column="kod_dop_doc" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_vid_doc" />
            <const>27</const>
          </call>
          <call function="is null">
            <column table="a" column="dat_end" />
          </call>
          <call function="=">
            <call function="nvl0">
              <column table="kod_dop_doc" column="pr_sign" />
            </call>
            <const>2</const>
          </call>
          <call function="is not null">
            <column table="kod_dop_doc" column="dt_sign" />
          </call>
          <call function="or">
            <call function="is not null">
              <column table="kod_dop_doc" column="prim" />
            </call>
            <call function="gt">
              <call function="length">
                <column table="kod_dop_doc" column="file_sign" />
              </call>
              <const>0</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="53499-zayav_dats_doc" timestamp="19.07.2019 18:18:45" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="kod_dop_contract" column="kod_zayav" group="1" />
        <call as="dat_ready" group="max" type="date" function="case">
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <const>(84, 131, 681)</const>
            </call>
            <column table="a" column="dat_viz" />
          </call>
        </call>
        <call as="dat_download" group="max" type="date" function="greatest">
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="a" column="kod_spr_viz" />
                <const comment="Передано контрагенту на подпись, Контрагент скачал договор ЛКК">(37, 671)</const>
              </call>
              <column table="a" column="dat_viz" />
            </call>
          </call>
          <call function="nvl">
            <column table="ddl" column="dat_first_download_lkk" />
            <call function="nativity" />
          </call>
        </call>
        <call as="dat_sign" group="max" type="date" function="greatest">
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="a" column="kod_spr_viz" />
                <const>(125, 670)</const>
              </call>
              <column table="a" column="dat_viz" />
            </call>
          </call>
          <call function="nvl">
            <column table="dsl" column="dt_sign" />
            <call function="nativity" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_viza_agr_doc" as="a" />
        <query name="is_dop_contract" as="kod_dop_contract" join="inner">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="kod_dop_contract" column="kod_dop_contract" />
          </call>
        </query>
        <query name="53499-zayav_dt_download_lkk" as="ddl" join="left outer">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="ddl" column="kod_dop_contract" />
          </call>
        </query>
        <query name="53499-zayav_dt_sign_lkk" as="dsl" join="left outer">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="dsl" column="kod_dop_contract" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="pref" />
            <const>'ABD_'</const>
          </call>
          <call function="in">
            <column table="a" column="kod_spr_viz" />
            <const>(84, 131, 681, 125, 670, 37, 671)</const>
          </call>
        </call>
      </where>
    </query>
    <query name="53499-zayav_dats_doc_v1_data" timestamp="10.06.2020 17:29:08" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="kod_dop_contract" column="kod_zayav" />
        <call as="dat_ready" type="date" function="case">
          <call function="when">
            <call function="in">
              <column table="a" column="kod_spr_viz" />
              <const>(84, 131, 681)</const>
            </call>
            <column table="a" column="dat_viz" />
          </call>
        </call>
        <call as="dat_download" type="date" function="greatest">
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="a" column="kod_spr_viz" />
                <const comment="Передано контрагенту на подпись, Контрагент скачал договор ЛКК">(37, 671)</const>
              </call>
              <column table="a" column="dat_viz" />
            </call>
          </call>
          <call function="nvl">
            <column table="ddl" column="dat_first_download_lkk" />
            <call function="nativity" />
          </call>
        </call>
        <call as="dat_sign" type="date" function="greatest">
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="a" column="kod_spr_viz" />
                <const>(125, 670)</const>
              </call>
              <column table="a" column="dat_viz" />
            </call>
          </call>
          <call function="nvl">
            <column table="dsl" column="dt_sign" />
            <call function="nativity" />
          </call>
        </call>
        <call function="over" as="max_dat_sign">
          <call function="min">
            <column table="this" column="dat_sign" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_zayav" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_viza_agr_doc" as="a" />
        <query name="is_dop_contract" as="kod_dop_contract" join="inner">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="kod_dop_contract" column="kod_dop_contract" />
          </call>
        </query>
        <query name="53499-zayav_dt_download_lkk" as="ddl" join="left outer">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="ddl" column="kod_dop_contract" />
          </call>
        </query>
        <query name="53499-zayav_dt_sign_lkk" as="dsl" join="left outer">
          <call function="=">
            <column table="a" column="kod_doc" />
            <column table="dsl" column="kod_dop_contract" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="pref" />
            <const>'ABD_'</const>
          </call>
          <call function="in">
            <column table="a" column="kod_spr_viz" />
            <const>(84, 131, 681, 125, 670, 37, 671)</const>
          </call>
        </call>
      </where>
    </query>
    <query name="53499_v1" timestamp="09.07.2020 17:07:04" is-report="1" with-behavior="1" title="Заявки за весь период" visible="0" mode="default" nogrid="1" datareader="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <print-templates>
        <excel>
          <template name="53499.xlsx" title="Заявки за весь период" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <!--<print-templates>
        <excel>
          <template name="26630.xlsx" title="Отчет по исполнителю" print-xlsx="1" print-proc="2" del-cols="1" output-format="xlsb" />
        </excel>
      </print-templates>-->
      <customers>
        <customer id="17" />
      </customers>
      <select>
        <column table="zz" column="kod_zayav" />
        <column table="zz" column="num_zayav" />
        <call as="dat_zayav" function="trunc" type="date">
          <column table="zz" column="dat_zayav" />
        </call>
        <column table="kod_spr_query" column="name" as="type_zayav" />
        <column table="is_spr_from_path" column="name" as="name_path" />
        <column table="kodp" column="name" as="kontragent" />
        <call as="region" type="string" function="case">
          <call function="when">
            <call function="=">
              <call function="nvl0">
                <column table="c_zayav_family" column="pr_city" />
              </call>
              <const>1</const>
            </call>
            <const>'Город'</const>
          </call>
          <call function="when">
            <call function="=">
              <call function="nvl0">
                <column table="c_zayav_family" column="pr_city" />
              </call>
              <const>0</const>
            </call>
            <const>'Область'</const>
          </call>
        </call>
        <column table="c_zayav_family" column="name_filial" />
        <column table="c_zayav_family" column="str_adr" />
        <call as="n_zayav" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="d_k2" />
          <column table="oz" column="d_k3" />
        </call>
        <column table="oz" column="d_k1" as="n_zayav1" />
        <column table="oz" column="d_k2" as="n_zayav2" />
        <column table="oz" column="d_k3" as="n_zayav3" />
        <call as="n_susch" function="+">
          <column table="oz" column="s_k1" />
          <column table="oz" column="s_k2" />
          <column table="oz" column="s_k3" />
        </call>
        <column table="oz" column="s_k1" as="n_susch1" />
        <column table="oz" column="s_k2" as="n_susch2" />
        <column table="oz" column="s_k3" as="n_susch3" />
        <call as="n" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="d_k2" />
          <column table="oz" column="d_k3" />
          <column table="oz" column="s_k1" />
          <column table="oz" column="s_k2" />
          <column table="oz" column="s_k3" />
        </call>
        <call as="n1" function="+">
          <column table="oz" column="d_k1" />
          <column table="oz" column="s_k1" />
        </call>
        <call as="n2" function="+">
          <column table="oz" column="d_k2" />
          <column table="oz" column="s_k2" />
        </call>
        <call as="n3" function="+">
          <column table="oz" column="d_k3" />
          <column table="oz" column="s_k3" />
        </call>
        <column table="kod_voltage" column="name_kr" />
        <column table="ist_pit" column="name_tp_1" />
        <column table="ist_pit" column="name_ist_1" />
        <column table="ist_pit" column="name_ist_2" />
        <column table="kn_st_req" column="name" as="status_zayav" />
        <column table="st_det" column="status_zayav_det" />
        <call as="date_coming" function="trunc" type="date">
          <column table="rq" column="date_coming" />
        </call>
        <call function="()" as="dt_project" type="date">
          <const>pres.as_contr_props_56484(rq.kn_request, 2)</const>
        </call>
        <call as="dat_ready" function="trunc" type="date">
          <column table="dt_docs" column="dat_ready" />
        </call>
        <call as="dat_download" function="trunc" type="date">
          <column table="dt_docs" column="dat_download" />
        </call>
        <call as="dat_sign" function="trunc" type="date">
          <column table="dt_docs" column="dat_sign" />
        </call>
      </select>
      <from>
        <query name="c_zayav" as="zz">
          <link name="c_zayav_energo">
            <link name="kod_voltage" />
            <link name="is_spr_from_path" />
          </link>
          <link name="c_zayav_family" />
          <link name="kodp" />
          <link name="kod_spr_query" />
        </query>
        <query name="as_request" as="rq" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="rq" column="kod_zayav" />
          </call>
          <link name="kn_st_req" />
        </query>
        <query name="53499-zayav_power" as="oz" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="oz" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_status_detailed" as="st_det" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="st_det" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_ist_pit" as="ist_pit" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="ist_pit" column="kod_zayav" />
          </call>
        </query>
        <query name="53499-zayav_dats_doc_v1" as="dt_docs" join="left outer">
          <call function="=">
            <column table="zz" column="kod_zayav" />
            <column table="dt_docs" column="kod_zayav" />
          </call>
        </query>
      </from>
    </query>
    <query name="53499-zayav_dats_doc_v1" timestamp="10.06.2020 17:32:26" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\53499.xml">
      <select>
        <column table="a" column="kod_zayav" group="1" />
        <call function="if" as="dat_ready" group="max">
          <call function="le">
            <column table="a" column="dat_ready" />
            <call function="nvl">
              <column table="a" column="max_dat_sign" />
              <call function="doomsday" />
            </call>
          </call>
          <column table="a" column="dat_ready" />
        </call>
        <call function="if" as="dat_download" group="max">
          <call function="le">
            <column table="a" column="dat_download" />
            <call function="nvl">
              <column table="a" column="max_dat_sign" />
              <call function="doomsday" />
            </call>
          </call>
          <column table="a" column="dat_download" />
        </call>
        <column table="a" column="dat_sign" group="min" />
      </select>
      <from>
        <query name="53499-zayav_dats_doc_v1_data" as="a" />
      </from>
    </query>
    <query name="ASV_REQUEST_ALL" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\asv_request_all.xml">
      <select>
        <call function="rownum" as="id" />
        <column table="a" column="kn_request" type="number" title="" qlikview="1" />
        <column table="a" column="req_year" type="number" title="" qlikview="1" />
        <column table="a" column="req_num" type="number" title="" qlikview="1" />
        <column table="a" column="fl_vip" type="number" title="" qlikview="1" />
        <column table="a" column="fl_check" type="number" title="" qlikview="1" />
        <column table="a" column="docsaved" type="number" title="" qlikview="1" />
        <column table="a" column="user_contr" type="string" title="" qlikview="1" />
        <column table="a" column="dt_contr_b" type="date" title="" qlikview="1" />
        <column table="a" column="dt_proj_b" type="date" title="" qlikview="1" />
        <column table="a" column="dt_mess" type="date" title="" qlikview="1" />
        <column table="a" column="dt_client_proj" type="date" title="" qlikview="1" />
        <column table="a" column="dt_client_sign" type="date" title="" qlikview="1" />
        <column table="a" column="dt_to_client" type="date" title="" qlikview="1" />
        <column table="a" column="contr_id" type="string" title="" qlikview="1" />
        <column table="a" column="folder_num" type="string" title="" qlikview="1" />
        <column table="a" column="dt_estate_contr" type="date" title="" qlikview="1" />
        <column table="a" column="dt_reject_eb" type="date" title="" qlikview="1" />
        <column table="a" column="kn_st_req" type="number" title="" qlikview="1" />
        <column table="a" column="st_req" type="string" title="" qlikview="1" />
        <column table="a" column="fl_arc" type="number" title="" qlikview="1" />
        <column table="a" column="kn_off_reason" type="number" title="" qlikview="1" />
        <column table="a" column="off_reason" type="string" title="" qlikview="1" />
        <column table="a" column="date_off" type="date" title="" qlikview="1" />
        <column table="a" column="fl_anp" type="number" title="" qlikview="1" />
        <column table="a" column="act_nonc_num" type="string" title="" qlikview="1" />
        <column table="a" column="dt_act_noncontr" type="date" title="" qlikview="1" />
        <column table="a" column="fl_amnesty" type="number" title="" qlikview="1" />
        <column table="a" column="cad_num" type="string" title="" qlikview="1" />
        <column table="a" column="kn_customer" type="number" title="" qlikview="1" />
        <column table="a" column="customer" type="string" title="" qlikview="1" />
        <column table="a" column="jurid" type="number" title="" qlikview="1" />
        <column table="a" column="custaddr" type="string" title="" qlikview="1" />
        <column table="a" column="custinn" type="string" title="" qlikview="1" />
        <column table="a" column="kn_load_type" type="number" title="" qlikview="1" />
        <column table="a" column="load_type" type="string" title="" qlikview="1" />
        <column table="a" column="kn_load_kind" type="number" title="" qlikview="1" />
        <column table="a" column="load_kind" type="string" title="" qlikview="1" />
        <column table="a" column="kn_cons_group" type="number" title="" qlikview="1" />
        <column table="a" column="cons_group" type="string" title="" qlikview="1" />
        <column table="a" column="kn_creator" type="number" title="" qlikview="1" />
        <column table="a" column="creator" type="string" title="" qlikview="1" />
        <column table="a" column="kn_user" type="number" title="" qlikview="1" />
        <column table="a" column="suzer" type="string" title="" qlikview="1" />
        <column table="a" column="kn_coming_way" type="number" title="" qlikview="1" />
        <column table="a" column="coming_way" type="string" title="" qlikview="1" />
        <column table="a" column="kn_service_src" type="number" title="" qlikview="1" />
        <column table="a" column="service_src" type="string" title="" qlikview="1" />
        <column table="a" column="kn_user_tb" type="number" title="" qlikview="1" />
        <column table="a" column="executive" type="string" title="" qlikview="1" />
        <column table="a" column="exe_phone" type="string" title="" qlikview="1" />
        <column table="a" column="addr_type" type="number" title="" qlikview="1" />
        <column table="a" column="link_name" type="string" title="" qlikview="1" />
        <column table="a" column="link_phone" type="string" title="" qlikview="1" />
        <column table="a" column="kn_house" type="number" title="" qlikview="1" />
        <column table="a" column="addr" type="string" title="" qlikview="1" />
        <column table="a" column="addrro" type="string" title="" qlikview="1" />
        <column table="a" column="d_house" type="string" title="" qlikview="1" />
        <column table="a" column="d_appart" type="string" title="" qlikview="1" />
        <column table="a" column="addr_aux" type="string" title="" qlikview="1" />
        <column table="a" column="num_coming" type="string" title="" qlikview="1" />
        <column table="a" column="date_coming" type="date" title="" qlikview="1" />
        <column table="a" column="guess_sum" type="number" title="" qlikview="1" />
        <column table="a" column="ad_sum" type="number" title="" qlikview="1" />
        <column table="a" column="loss_sum" type="number" title="" qlikview="1" />
        <column table="a" column="fl_loss" type="number" title="" qlikview="1" />
        <column table="a" column="loadunits" type="string" title="" qlikview="1" />
        <column table="a" column="result" type="string" title="" qlikview="1" />
        <column table="a" column="kn_region" type="number" title="" qlikview="1" />
        <column table="a" column="region" type="string" title="" qlikview="1" />
        <column table="a" column="kn_zone" type="number" title="" qlikview="1" />
        <column table="a" column="org_dep" type="string" title="" qlikview="1" />
        <column table="a" column="kod_direct" type="number" title="" qlikview="1" />
        <column table="a" column="depcreator" type="string" title="" qlikview="1" />
        <column table="a" column="kn_dep_user" type="number" title="" qlikview="1" />
        <column table="a" column="depuser" type="string" title="" qlikview="1" />
        <column table="a" column="load_cat1" type="number" title="" qlikview="1" />
        <column table="a" column="load_cat2" type="number" title="" qlikview="1" />
        <column table="a" column="load_cat3" type="number" title="" qlikview="1" />
        <column table="a" column="load_totale" type="number" title="" qlikview="1" />
        <column table="a" column="load_ex1" type="number" title="" qlikview="1" />
        <column table="a" column="load_ex2" type="number" title="" qlikview="1" />
        <column table="a" column="load_ex3" type="number" title="" qlikview="1" />
        <column table="a" column="load_totalex" type="number" title="" qlikview="1" />
        <column table="a" column="loadtotal" type="number" title="" qlikview="1" />
        <column table="a" column="kn_voltage" type="number" title="" qlikview="1" />
        <column table="a" column="voltage" type="number" title="" qlikview="1" />
        <column table="a" column="load_point" type="string" title="" qlikview="1" />
        <column table="a" column="let_num" type="string" title="" qlikview="1" />
        <column table="a" column="let_delivered" type="date" title="" qlikview="1" />
        <column table="a" column="doc_list" type="string" title="" qlikview="1" />
        <column table="a" column="to_price" type="date" title="" qlikview="1" />
        <column table="a" column="priced" type="date" title="" qlikview="1" />
        <column table="a" column="indtar_ask" type="date" title="" qlikview="1" />
        <column table="a" column="indtar_got" type="date" title="" qlikview="1" />
        <column table="a" column="dt_corr_tu" type="date" title="" qlikview="1" />
        <column table="a" column="dt_lack_req" type="date" title="" qlikview="1" />
        <column table="a" column="dt_docs_got" type="date" title="" qlikview="1" />
        <column table="a" column="pass_up" type="date" title="" qlikview="1" />
        <column table="a" column="kod_tb_unit" type="number" title="" qlikview="1" />
        <column table="a" column="tb_unit" type="string" title="" qlikview="1" />
        <column table="a" column="revision" type="date" title="" qlikview="1" />
        <column table="a" column="dt_pass_ks" type="date" title="" qlikview="1" />
        <column table="a" column="answer_ks" type="date" title="" qlikview="1" />
        <column table="a" column="dt_query_fil" type="date" title="" qlikview="1" />
        <column table="a" column="dt_pass_res" type="date" title="" qlikview="1" />
        <column table="a" column="dt_answer_res" type="date" title="" qlikview="1" />
        <column table="a" column="pz" type="date" title="" qlikview="1" />
        <column table="a" column="dt_pass_eb" type="date" title="" qlikview="1" />
        <column table="a" column="dt_reject_tb" type="date" title="" qlikview="1" />
        <column table="a" column="dt_pass_tbcc" type="date" title="" qlikview="1" />
        <column table="a" column="dt_back_tbcc" type="date" title="" qlikview="1" />
        <column table="a" column="cost_put" type="date" title="" qlikview="1" />
        <column table="a" column="pass_cc" type="date" title="" qlikview="1" />
        <column table="a" column="dt_from_ks" type="date" title="" qlikview="1" />
        <column table="a" column="dt_from_tb" type="date" title="" qlikview="1" />
        <column table="a" column="pass_od" type="date" title="" qlikview="1" />
        <column table="a" column="pass_branch" type="date" title="" qlikview="1" />
        <column table="a" column="denial" type="date" title="" qlikview="1" />
        <column table="a" column="reject_sent_num" type="string" title="" qlikview="1" />
        <column table="a" column="dt_reject_sent" type="date" title="" qlikview="1" />
        <column table="a" column="atp_ask" type="date" title="" qlikview="1" />
        <column table="a" column="atp_ask_num" type="string" title="" qlikview="1" />
        <column table="a" column="atp_ks" type="date" title="" qlikview="1" />
        <column table="a" column="atp_ready" type="date" title="" qlikview="1" />
        <column table="a" column="kn_atp_case" type="number" title="" qlikview="1" />
        <column table="a" column="atp_case" type="string" title="" qlikview="1" />
        <column table="a" column="atp_expire" type="date" title="" qlikview="1" />
        <column table="a" column="atp_reg" type="date" title="" qlikview="1" />
        <column table="a" column="atp_deliver" type="date" title="" qlikview="1" />
        <column table="a" column="atp_num" type="number" title="" qlikview="1" />
        <column table="a" column="atp_power" type="number" title="" qlikview="1" />
        <column table="a" column="atp_units" type="string" title="" qlikview="1" />
        <column table="a" column="kn_supply1" type="number" title="" qlikview="1" />
        <column table="a" column="supply1" type="string" title="" qlikview="1" />
        <column table="a" column="kn_supply2" type="number" />
        <column table="a" column="supply2" type="string" />
        <column table="a" column="fl_work_ps" type="number" title="" qlikview="1" />
        <column table="a" column="flwork_ps" type="string" title="" qlikview="1" />
        <column table="a" column="fl_work_net" type="number" />
        <column table="a" column="flwork_net" type="string" />
        <column table="a" column="fl_build" type="number" />
        <column table="a" column="getto_up" type="date" title="" qlikview="1" />
        <column table="a" column="dt_query_vs" type="date" title="" qlikview="1" />
        <column table="a" column="dt_answer_vs" type="date" title="" qlikview="1" />
        <column table="a" column="reply_to_custom" type="string" title="" qlikview="1" />
        <column table="a" column="dt_reply_to_client" type="date" title="" qlikview="1" />
        <column table="a" column="note_el" type="string" title="" qlikview="1" />
        <column table="a" column="pass_ks" type="string" title="" qlikview="1" />
        <column table="a" column="dt_passw" type="date" title="" qlikview="1" />
        <column table="a" column="kn_fin_src" type="number" title="" qlikview="1" />
        <column table="a" column="name_src" type="string" title="" qlikview="1" />
        <column table="a" column="psk_ask_num" type="string" title="" qlikview="1" />
        <column table="a" column="dt_psk_ask" type="date" title="" qlikview="1" />
        <column table="a" column="psk_answer_num" type="string" title="" qlikview="1" />
        <column table="a" column="dt_psk_answer" type="date" title="" qlikview="1" />
      </select>
      <from>
        <table name="ASV_REQUEST_ALL" as="a" />
      </from>
    </query>
    <query name="asv_request_all_qv" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\asv_request_all_qv.xml">
      <select>
        <call function="rownum" as="id" />
        <column table="a" column="kn_request" type="number" title="Уникальный код заявки" />
        <!--<column table="a" column="req_year" type="number" title="Год заявки (4 знака)"></column>-->
        <!--<column table="a" column="req_num" type="number" title="№ заявки"></column>-->
        <column table="a" column="req_year_qv" type="number" title="Год заявки (4 знака)" />
        <column table="a" column="req_num_qv" type="string" title="№ заявки" />
        <column table="a" column="group_power_qv" type="string" title="Группа мощности" />
        <column table="a" column="depuser_qv" type="string" title="подразделение куратора приема" />
        <!--<column table="a" column="fl_vip" type="number" title=""></column>
        <column table="a" column="fl_check" type="number" title=""></column>
        <column table="a" column="docsaved" type="number" title=""></column>
        <column table="a" column="user_contr" type="string" title=""></column>-->
        <!--<column table="a" column="dt_contr_b" type="date" title="Дата договора"></column>
        <column table="a" column="dt_proj_b" type="date" title="Дата проекта"></column>
        <column table="a" column="dt_mess" type="date" title="Сообщено клиенту"></column>
        <column table="a" column="dt_client_proj" type="date" title="На подпись клиенту"></column>
        <column table="a" column="dt_client_sign" type="date" title="Подписан клиентом"></column>-->
        <!--<column table="a" column="dt_to_client" type="date" title="Выдан клиенту"></column>-->
        <column table="a" column="num_ouco" type="string" title="№ договора" />
        <!--<column table="a" column="contr_id" type="string" title="№ договора"></column>-->
        <!--<column table="a" column="folder_num" type="string" title="№ папки"></column>
        <column table="a" column="dt_estate_contr" type="date" title="Признак инд. тарифа"></column>
        <column table="a" column="dt_reject_eb" type="date" title="Уведомл. заявителю"></column>
        <column table="a" column="kn_st_req" type="number" title="Код статуса заявки"></column>-->
        <column table="a" column="status" type="string" title="Статус заявки" />
        <!--<column table="a" column="st_req" type="string" title="Статус заявки"></column>-->
        <!--<column table="a" column="fl_arc" type="number" title="Фл. архива"></column>
        <column table="a" column="kn_off_reason" type="number" title="Код причины анннулирования"></column>
        <column table="a" column="off_reason" type="string" title="Причина анннулирования"></column>
        <column table="a" column="date_off" type="date" title="Дата аннул."></column>
        <column table="a" column="fl_anp" type="number" title="Наличие акта о бездог. польз."></column>
        <column table="a" column="act_nonc_num" type="string" title="№ акта о бездог. пользовании"></column>
        <column table="a" column="dt_act_noncontr" type="date" title="Дата акта о бездог.польз."></column>
        <column table="a" column="fl_amnesty" type="number" title="Амнистия"></column>
        <column table="a" column="cad_num" type="string" title="Кадастровый номер"></column>
        <column table="a" column="kn_customer" type="number" title="Код клиента"></column>-->
        <column table="a" column="cr_name" type="string" title="Организация или ФИО клиента" />
        <!--<column table="a" column="customer" type="string" title="Организация или ФИО клиента"></column>-->
        <!--<column table="a" column="jurid" type="number" title="Юр. лицо"></column>-->
        <column table="a" column="adr_fakt" type="string" title="Юридический адрес клиента" />
        <!--<column table="a" column="custaddr" type="string" title="Юридический адрес клиента"></column>-->
        <column table="a" column="inn" type="string" title="ИНН клиента" />
        <!--<column table="a" column="custinn" type="string" title="ИНН клиента"></column>-->
        <column table="a" column="kn_load_type" type="number" title="Код типа заявки" />
        <column table="a" column="load_type" type="string" title="Тип заявки" />
        <!--<column table="a" column="kn_load_kind" type="number" title="Код Вида объекта нагрузки"></column>-->
        <column table="a" column="object" type="string" title="Вид объекта нагрузки" />
        <!--<column table="a" column="load_kind" type="string" title="Вид объекта нагрузки"></column>-->
        <!--<column table="a" column="kn_cons_group" type="number" title="Код Отрасли"></column>
        <column table="a" column="cons_group" type="string" title="Отрасль"></column>
        
        <column table="a" column="kn_creator" type="number" title="Код Куратора ввода (создатель)"></column>
        <column table="a" column="creator" type="string" title="Куратор ввода (создатель)"></column>
        
        <column table="a" column="kn_user" type="number" title="Код Куратора (актуальный)"></column>  
        <column table="a" column="suzer" type="string" title="Куратор (актуальный)"></column>
        
        <column table="a" column="kn_coming_way" type="number" title="Код Пути приёма заявки"></column>
        <column table="a" column="coming_way" type="string" title="Путь приёма заявки"></column> 
        
        <column table="a" column="kn_service_src" type="number" title="Код Службы-источника"></column>
        <column table="a" column="service_src" type="string" title="Служба - источник"></column>
        
        <column table="a" column="kn_user_tb" type="number" title=""></column>-->
        <!--<column table="a" column="executive" type="string" title="Исполнитель"></column>
        <column table="a" column="exe_phone" type="string" title="Телефон Исполнителя"></column>
        
     
        <column table="a" column="link_name" type="string" title="ФИО контактного лица клиента"></column>
        <column table="a" column="link_phone" type="string" title="Тел. конт. лица"></column>
        
        <column table="a" column="addr" type="string" title=""></column>-->
        <column table="a" column="lp_addr" type="string" title="Полный адрес присоединения" />
        <!--<column table="a" column="addrro" type="string" title="Полный адрес присоединения"></column>  -->
        <!--<column table="a" column="addr_aux" type="string" title=""></column>
        <column table="a" column="num_coming" type="string" title="№ вход. заявки"></column>-->
        <column table="a" column="date_coming" type="date" title="Дата приёма заявки" />
        <column table="a" column="guess_sum" type="number" title="Сумма оценки (руб.)" />
        <column table="a" column="contr_sumf" type="number" title="Стоимость АД (руб.)" />
        <!--<column table="a" column="ad_sum" type="number" title="Стоимость АД (руб.)"></column>-->
        <!--<column table="a" column="loss_sum" type="number" title="Сумма убытка (руб.) "></column>
        <column table="a" column="fl_loss" type="number" title="Призн. убыт."></column>-->
        <column table="a" column="loadunits" type="string" title="Ед.изм. мощн." />
        <!--<column table="a" column="result" type="string" title="Архив (Тех.блок)"></column>
        <column table="a" column="kn_region" type="number" title="Код региона города/области"></column>-->
        <column table="a" column="region" type="string" title="Регион" />
        <column table="a" column="kn_zone" type="number" title="Зона" />
        <column table="a" column="name_res" type="string" title="Район КС/ЭС (подразделение)" />
        <!--<column table="a" column="org_dep" type="string" title="Район КС/ЭС (подразделение)"></column>-->
        <!--<column table="a" column="kod_direct" type="number" title="Код Района КС/ЭС (подразделение)"></column>
        <column table="a" column="depcreator" type="string" title="Подразделение куратора ввода"></column>-->
        <!--<column table="a" column="depuser" type="string" title="Подразделение куратора приёма"></column>-->
        <column table="a" column="load1" type="number" title="Заявл. мощность 1 кат." />
        <column table="a" column="load2" type="number" title="Заявл. мощность 2 кат." />
        <column table="a" column="load3" type="number" title="Заявл. мощность 3 кат." />
        <column table="a" column="sum_load" type="number" title="Всего:Заявл. мощность" />
        <!--<column table="a" column="load_totale" type="number" title="Всего:Заявл. мощность"></column>-->
        <!--<column table="a" column="load_ex1" type="number" title="Существ. мощность 1 кат."></column>
        <column table="a" column="load_ex2" type="number" title="Существ. мощность 2 кат."></column>
        <column table="a" column="load_ex3" type="number" title="Существ. мощность 3 кат."></column>-->
        <column table="a" column="sum_load_ext" type="number" title="Всего: Существ.мощность" />
        <!--<column table="a" column="load_totalex" type="number" title="Всего: Существ.мощность"></column>-->
        <column table="a" column="sum_power" type="number" title="Суммарная мощность" />
        <!--<column table="a" column="loadtotal" type="number" title="Суммарная мощность"></column>-->
        <!--<column table="a" column="kn_voltage" type="number" title="Код Уровня напряж."></column>
        <column table="a" column="voltage" type="number" title="Уровень напряж."></column>-->
        <column table="a" column="load_point" type="string" title="Точка подключения" />
        <!--<column table="a" column="let_num" type="string" title="№ письма 2 клиенту (прочее)"></column>
        <column table="a" column="let_delivered" type="date" title="Дата п.2 клиенту (разное)"></column>
        <column table="a" column="doc_list" type="string" title="Примечание"></column>
        <column table="a" column="to_price" type="date" title="Принято в ЭБ на оценку"></column>
        <column table="a" column="priced" type="date" title="Принято ЦОК из ЭБ"></column>
        <column table="a" column="indtar_ask" type="date" title="Передано на инд.тариф"></column>
        <column table="a" column="indtar_got" type="date" title="Получено инд.тариф"></column>
        <column table="a" column="dt_corr_tu" type="date" title="На коррект. ТУ"></column>
        <column table="a" column="dt_lack_req" type="date" title="Письмо о недост.док."></column>
        <column table="a" column="dt_docs_got" type="date" title="Получены все док."></column>
        <column table="a" column="pass_up" type="date" title="ЦОК=> в ТБ/KC"></column>-->
        <!--<column table="a" column="kod_tb_unit" type="number" title="Код Службы Тех. блока"></column>
        <column table="a" column="tb_unit" type="string" title="Служба Тех. блока"></column>
        <column table="a" column="revision" type="date" title="Возвр. в ЦОК из ТБ "></column>
        <column table="a" column="dt_pass_ks" type="date" title="Передано в РДУ"></column>
        <column table="a" column="answer_ks" type="date" title="Ответ из РДУ"></column>
        
        <column table="a" column="dt_query_fil" type="date" title=""></column>
        
        <column table="a" column="dt_pass_res" type="date" title="Филиал: в РЭС"></column>
        <column table="a" column="dt_answer_res" type="date" title="Филиал: из РЭС"></column>
        <column table="a" column="pz" type="date" title="Подготовл. ТУ"></column>
        <column table="a" column="dt_pass_eb" type="date" title="Передано ТБ=>Экон.упр-е"></column>
        <column table="a" column="dt_reject_tb" type="date" title="Служ. записка об отказе"></column>
        <column table="a" column="dt_pass_tbcc" type="date" title="Передано в ЦОК"></column>
        <column table="a" column="dt_back_tbcc" type="date" title="Возврат в ЦОК"></column>
        <column table="a" column="cost_put" type="date" title="Оценка выполнена"></column>
        <column table="a" column="pass_cc" type="date" title="Передано из ЭБ в ЦОК"></column>
        <column table="a" column="dt_from_ks" type="date" title="Получены ТУ из КС"></column>-->
        <!--<column table="a" column="dt_from_tb" type="date" title="Получено из ТБ"></column>
        <column table="a" column="pass_od" type="date" title="Передано в ОД"></column>
        <column table="a" column="pass_branch" type="date" title="Передано в филиал"></column>
        <column table="a" column="denial" type="date" title="Получен отказ (ЦОК)"></column>

        <column table="a" column="reject_sent_num" type="string" title="№ письма 3 клиенту (увед. об отказе)"></column>
        <column table="a" column="dt_reject_sent" type="date" title="Дата п.3 клиенту (увед.об отказе)"></column>
        <column table="a" column="atp_ask" type="date" title="Запрос АТП"></column>
        <column table="a" column="atp_ask_num" type="string" title="№ запроса АТП"></column>
        <column table="a" column="atp_ks" type="date" title="АТП передан из КС=>ЦОК"></column>
        <column table="a" column="atp_ready" type="date" title="АТП готов"></column>

        <column table="a" column="atp_case" type="string" title="Вид АТП"></column>
        <column table="a" column="atp_expire" type="date" title="Действ. до"></column>
        <column table="a" column="atp_reg" type="date" title="Регистр. АТП"></column>
        <column table="a" column="atp_deliver" type="date" title="Выдача АТП клиенту"></column>

        <column table="a" column="atp_num" type="number" title="№ АТП"></column>
        <column table="a" column="atp_power" type="number" title="Мощн. АТП"></column>
        <column table="a" column="atp_units" type="string" title="Ед.изм. мощн."></column>
        <column table="a" column="kn_supply1" type="number" title="Код Источника 1 (основной)"></column>-->
        <column table="a" column="supply" type="string" title="Источник 1 (основной)" />
        <!--<column table="a" column="supply1" type="string" title="Источник 1 (основной)"></column>-->
        <!--<column table="a" column="kn_supply2" type="number" title="Код ИП2 (резервный)"></column>
        <column table="a" column="supply2" type="string" title="Источник 2 (резервный)"></column>-->
        <!--<column table="a" column="flwork_ps" type="string" title="Работы ИП"></column>
        <column table="a" column="flwork_net" type="string" title="Работы распр. сеть"></column>-->
        <column table="a" column="fl_work_ps" type="string" title="Работы ИП" />
        <column table="a" column="fl_work_net" type="string" title="Работы распр. сеть" />
        <column table="a" column="fl_build" type="number" title="Работы в целом" />
        <!--<column table="a" column="getto_up" type="date" title="Получено в Тех.блок"></column>
        
        <column table="a" column="dt_query_vs" type="date" title=""></column>
        <column table="a" column="dt_answer_vs" type="date" title=""></column>
        
        <column table="a" column="reply_to_custom" type="string" title="№ письма 1 клиенту (ИТК, субабонентство)"></column>
        <column table="a" column="dt_reply_to_client" type="date" title="Дата п.1 (ИТК,субабон-во)"></column>
        
        <column table="a" column="note_el" type="string" title=""></column>
        <column table="a" column="dt_passw" type="date" title="Дата и время присв. пароля"></column>
        <column table="a" column="kn_fin_src" type="number" title="Код источник финансирования"></column>
        <column table="a" column="name_src" type="string" title="Источник финансирования"></column>-->
        <!--<column table="a" column="psk_ask_num" type="string" title="Запрос в ПСК, №"></column>
        <column table="a" column="dt_psk_ask" type="date" title="Дата запроса в ПСК"></column>
        <column table="a" column="psk_answer_num" type="string" title="Ответ из ПСК, №"></column>
        <column table="a" column="dt_psk_answer" type="date" title="Дата ответа из ПСК"></column>-->
        <column table="a" column="ruk_podr" type="string" title="Руководитель подразд. приема заявок" />
        <column table="a" column="sum_cat1" type="number" title="Суммарная мощность 1 Категории, кВт" />
        <column table="a" column="sum_cat2" type="number" title="Суммарная мощность 2 Категории, кВт" />
        <column table="a" column="sum_cat3" type="number" title="Суммарная мощность 3 Категории, кВт" />
      </select>
      <from>
        <table name="isv_request_kido" as="a" />
      </from>
    </query>
    <query name="test_gen_kido" is-report="1" title="КИДО Сводный" visible="0" params-customization="1" allow-save="1" edit-columns="1" folder="kido" with-behavior="0" timestamp="21.11.2016 14:21:02" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\generators_kido.xml">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <param name="kod_dog" field="kido_kod_dog">
          <const>3169797</const>
        </param>
        <param name="datas" field="date" title="Дата с">
          <const>sysdate</const>
        </param>
        <param name="datapo" field="date" title="Дата по">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1" title="kod_dog" exclude="1" />
        <column table="a" column="kod_period" group="1" title="kod_period" exclude="1" />
        <column table="kod_predpr" column="name" group="1" as="name_direct" removeable="1" />
        <column table="kod_dog" column="name" group="1" removeable="1" />
        <column table="kod_spr_stage" column="name_kr" group="1" as="name_stage" removeable="1" />
        <column table="kod_fin_doc_tit" column="num" group="1" title="Номер титула" removeable="1" />
        <column table="a" column="vsego" group="sum" />
        <column table="a" column="avans" group="sum" />
        <column table="a" column="sum_avans" group="sum" />
        <column table="a" column="sum_akts" group="sum" />
        <column table="a" column="opl" group="sum" />
        <column table="a" column="opl_vzaim" group="sum" />
        <column table="a" column="opl_close" group="sum" />
        <column table="a" column="summa_opl" group="sum" />
        <column table="a" column="summa_vzaim" group="sum" />
        <column table="a" column="summa_close" group="sum" />
        <column table="a" column="oborot_itog" group="sum" title="Задолженность ">
          <section title=" на начало" pfx="_beg">
            <useparam name="datas" />
          </section>
        </column>
        <column table="a" column="oborot_itog" group="sum" title="Задолженность ">
          <section title=" на конец">
            <useparam name="datapo" />
          </section>
        </column>
      </select>
      <from>
        <query name="gen_kido_united" as="a">
          <link name="kod_period">
            <link name="kod_fin_doc_tit" />
            <link name="kod_spr_stage" />
          </link>
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="*" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </extendwhere>
          <link name="kod_dog">
            <link name="kod_predpr" />
          </link>
        </query>
      </from>
    </query>
    <query name="gen_kido_united" cstyle="union" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\generators_kido.xml">
      <select>
        <column table="*" column="kod_dog" group="1" />
        <column table="*" column="kod_period" group="1" />
        <column table="*" column="kod_vip_dog" group="1" />
        <column table="*" column="data" group="1" timeline="1" />
        <column table="*" column="dat_nachisl" group="1" />
        <column table="*" column="dat_opl" group="1" />
        <column table="gen_kido_fin_all" column="vsego" group="sum" />
        <column table="gen_kido_fin_all" column="avans" group="sum" />
        <column table="gen_kido_fin_nachisl" column="sum_avans" group="sum" />
        <column table="gen_kido_fin_nachisl" column="sum_akts" group="sum" />
        <column table="gen_kido_fin_opl" column="opl" group="sum" />
        <column table="gen_kido_fin_opl" column="opl_vzaim" group="sum" />
        <column table="gen_kido_fin_opl" column="opl_close" group="sum" />
        <column table="gen_kido_fin_opl" column="summa_opl" group="sum" />
        <column table="gen_kido_fin_opl" column="summa_vzaim" group="sum" />
        <column table="gen_kido_fin_opl" column="summa_close" group="sum" />
        <call function="-nvl" as="oborot" group="sum" title="Задолженность">
          <column table="this" column="sum_akts" group="" />
          <column table="this" column="opl" group="" />
        </call>
        <column table="this" column="oborot" as="oborot_itog" cumulate="data" />
      </select>
      <from>
        <query name="gen_kido_fin_nachisl" title="Начисления по договору" />
        <query name="gen_kido_fin_opl" title="Оплаты по договору" />
        <query name="gen_kido_fin_all" title="Основные данные по договору" />
      </from>
      <push>
        <from>
          <query name="is_dogovor" as="kod_dog" join="left outer">
            <using>
              <column column="kod_dog" />
            </using>
          </query>
          <query name="is_period" as="kod_period" join="left outer">
            <using>
              <column column="kod_period" />
            </using>
          </query>
        </from>
      </push>
    </query>
    <query name="gen_kido_fin_all" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\generators_kido.xml">
      <select>
        <column table="is_period" column="kod_dog" />
        <column table="is_period" column="kod_period" />
        <column table="is_period" column="vsego" title="Стоимость договора" />
        <column table="is_period" column="avans" title="Сумма авансов по договору" />
      </select>
      <from>
        <query name="is_period" />
      </from>
    </query>
    <query name="gen_kido_fin_nachisl" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\generators_kido.xml">
      <select>
        <column table="kod_period" column="kod_dog" />
        <column table="is_vip_dog" column="kod_period" />
        <column table="is_vip_dog" column="kod_vip_dog" />
        <column table="is_vip_dog" column="dat_doc" as="dat_nachisl" />
        <column table="is_vip_dog" column="dat_doc" as="data" />
        <column table="is_vip_dog" column="summa" title="Сумма аванса" as="sum_avans">
          <if>
            <call function="and">
              <call function="=">
                <column table="is_vip_dog" column="kod_spr_doc" />
                <const>21</const>
              </call>
              <call function="=">
                <column table="is_vip_dog" column="prizn_r" />
                <const>0</const>
              </call>
            </call>
          </if>
        </column>
        <column table="is_vip_dog" column="summa" title="Сумма актов выполненных работ" as="sum_akts">
          <if>
            <call function="and">
              <call function="=">
                <column table="is_vip_dog" column="prizn_r" />
                <const>1</const>
              </call>
            </call>
          </if>
        </column>
      </select>
      <from>
        <query name="is_vip_dog">
          <link name="kod_period" />
        </query>
      </from>
    </query>
    <query name="gen_kido_fin_opl" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\generators_kido.xml">
      <select>
        <column table="is_opl_period" column="kod_dog" />
        <column table="is_opl_period" column="kod_period" />
        <column table="is_opl_period" column="kod_vip_dog" />
        <call as="dat_opl" function="if" description="Дата оплаты">
          <call function="is not null">
            <column table="kod_opl_ro" column="kod_parent" />
          </call>
          <column table="is_opl_period" column="dat_close_avans" />
          <column table="kod_opl_ro" column="dat_opl" />
        </call>
        <column table="this" column="dat_opl" as="data" />
        <column table="is_opl_period" column="sum_opl" title="Сумма оплаты" />
        <column table="is_opl_period" column="sum_opl" title="Сумма оплаты " as="opl" if="opl">
          <if title=" чистая">
            <call function="and">
              <call function="is null">
                <column table="is_opl_period" column="kod_parent" />
              </call>
              <call function="is null">
                <column table="is_opl_period" column="kod_opl_period_offset" />
              </call>
            </call>
          </if>
        </column>
        <column table="is_opl_period" column="sum_opl" title="Сумма оплаты" as="opl_vzaim" if="vzaim">
          <if title=" взаимозачет">
            <call function="and">
              <call function="is null">
                <column table="is_opl_period" column="kod_parent" />
              </call>
              <call function="is not null">
                <column table="is_opl_period" column="kod_opl_period_offset" />
              </call>
            </call>
          </if>
        </column>
        <column table="is_opl_period" column="sum_opl" as="opl_close" title="Сумма оплаты " if="close">
          <if title=" закрытие">
            <call function="and">
              <call function="is not null">
                <column table="is_opl_period" column="kod_parent" />
              </call>
            </call>
          </if>
        </column>
        <column table="is_opl_period" column="summa" title="Оплата без НДС " />
        <column table="is_opl_period" column="summa" title="Оплата без НДС " as="summa_opl" if="opl" />
        <column table="is_opl_period" column="summa" as="summa_vzaim" title="Оплата без НДС " if="vzaim" />
        <column table="is_opl_period" column="summa" as="summa_close" title="Оплата без НДС " if="close" />
        <column table="is_opl_period" column="nds" title="Оплата НДС" />
        <column table="is_opl_period" column="nds" if="opl" as="nds_opl" title="Оплата НДС" />
        <column table="is_opl_period" column="nds" if="vzaim" as="nds_vzaim" title="Оплата НДС" />
        <column table="is_opl_period" column="nds" as="nds_close" title="Оплата НДС" />
      </select>
      <from>
        <query name="is_opl_period">
          <link name="kod_opl_ro">
            <link name="kod_ro" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=">
            <column table="kod_ro" column="status" />
            <const>2</const>
          </call>
        </call>
      </where>
    </query>
    <query name="is_rep_rosseti" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\is_rep_rosseti.xml">
      <select>
        <call function="rownum" as="id" />
        <column table="a" column="kn_request" type="number" title="" />
        <column table="a" column="kod_dop_contract" type="number" />
        <column table="a" column="region" type="string" title="" />
        <column table="a" column="kod_region" type="string" />
        <column table="a" column="organization" type="string" title="" />
        <column table="a" column="kod_organization" type="string" />
        <column table="a" column="num_req" type="string" title="" />
        <column table="a" column="date_coming" type="date" title="" />
        <column table="a" column="dt_lack_req" type="date" title="" />
        <column table="a" column="dt_docs_got" type="date" title="" />
        <column table="a" column="cr_name_all" type="string" title="" />
        <column table="a" column="cr_name" type="string" title="" />
        <column table="a" column="inn" type="string" title="" />
        <column table="a" column="phone" type="string" title="" />
        <column table="a" column="e_mail" type="string" title="" />
        <column table="a" column="adr_post" type="string" title="" />
        <column table="a" column="adr_fakt" type="string" title="" />
        <column table="a" column="object" type="string" title="" />
        <column table="a" column="lp_addr" type="string" title="" />
        <column table="a" column="sum_load" type="number" title="" />
        <column table="a" column="sum_load_ext" type="number" title="" />
        <column table="a" column="s_voltage" type="string" title="" />
        <column table="a" column="kateg" type="string" title="" />
        <column table="a" column="load_point_gr1" type="string" title="" />
        <column table="a" column="load_point_gr2" type="string" title="" />
        <column table="a" column="load_point_gr3" type="string" title="" />
        <column table="a" column="load_point_gr4" type="string" title="" />
        <column table="a" column="load_point_gr5" type="string" title="" />
        <column table="a" column="load_point_gr6" type="string" title="" />
        <column table="a" column="supply" type="string" title="" />
        <column table="a" column="name_okved" type="string" title="" />
        <column table="a" column="dt_project" type="date" title="" />
        <column table="a" column="dt_cancel" type="date" title="" />
        <column table="a" column="num_ouco" type="string" title="" />
        <column table="a" column="dt_contract" type="date" title="" />
        <column table="a" column="srok_uslug" type="date" title="" />
        <column table="a" column="contr_sumf" type="number" title="" />
        <column table="a" column="tarif_name" type="string" title="" />
        <column table="a" column="tarif_name_calc" type="string" title="" />
        <column table="a" column="tarif" type="string" title="" />
        <column table="a" column="sum_opl_im" type="number" title="" />
        <column table="a" column="sum_opl_d" type="number" title="" />
        <column table="a" column="contr_opl" type="number" title="" />
        <column table="a" column="sum_avans" type="number" title="" />
        <column table="a" column="sum_vst_graf" type="number" title="" />
        <column table="a" column="contr_zadol_srok" type="number" title="" />
        <column table="a" column="dog_rab" type="number" title="" />
        <column table="a" column="contr_zadol" type="number" title="" />
        <column table="a" column="fl_build" type="string" title="" />
        <column table="a" column="kod_kateg_dog" type="string" />
        <column table="a" column="dat_rastorg" type="date" title="" />
        <column table="a" column="dt_atp_reg" type="date" title="" />
        <column table="a" column="dat_read_to_close" type="date" title="" />
        <column table="a" column="dat_got_to_close" type="date" title="" />
        <column table="a" column="stoim_ip" type="number" title="" />
        <column table="a" column="ostatok_kz" type="number" title="" />
        <column table="a" column="dt_fakt_vip_pir" type="date" title="" />
        <column table="a" column="dt_fakt_vip_smr" type="date" title="" />
        <column table="a" column="fl_work_net" type="number" title="" />
        <column table="a" column="kod_status" type="number" />
        <column table="a" column="status" type="string" title="" />
        <column table="a" column="load_point" type="string" title="" />
        <column table="a" column="pr_noncontr" type="string" title="" />
        <column table="a" column="name_res" type="string" title="" />
        <column table="a" column="kod_razd" type="string" title="" />
        <column table="a" column="load_units" type="string" title="" />
        <column table="a" column="koef_load_units" type="number" title="" />
        <column table="a" column="ud_stavka" type="number" title="Удельная ставка" />
        <column table="a" column="stavka_list" type="string" title="Ставка в перечне" />
      </select>
      <from>
        <table name="isv_rep_rosseti" as="a" />
      </from>
    </query>
    <query name="ISV_OTCHET_147_DOG_SOBSTV" timestamp="25.10.2021 10:05:38" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <select>
        <call function="rownum" as="pk" />
        <column table="a" column="pp" type="string" title="" />
        <column table="a" column="pp2" as="id" type="string" title="" />"
        <column table="a" column="polzov" type="string" title="" />"
        <column table="a" column="d_c" type="date" title="" />"
        <column table="a" column="e_code" type="string" title="" />"
        <column table="a" column="kod_dog" type="string" title="" />"
        <column table="a" column="kod_kr_owner" type="string" title="" />"
        <column table="a" column="contr_type" type="string" />"
        <column table="a" column="contr_type_kod" type="number" title="" />"
        <column table="a" column="contr_publ_type" type="string" title="" />"
        <column table="a" column="contr_publ_type_kod" type="number" title="" />"
        <column table="a" column="inn" type="string" title="" />"
        <column table="a" column="contr_reg_num" type="string" title="" />"
        <column table="a" column="is_contr_filial" type="string" title="" />"
        <column table="a" column="ogrn" type="string" title="" />"
        <column table="a" column="address" type="string" title="" />"
        <column table="a" column="fs_name" type="string" title="" />"
        <column table="a" column="fs_kod" type="number" title="" />"
        <column table="a" column="contr_name" type="string" title="" />"
        <column table="a" column="okved_kod" type="string" title="" />"
        <column table="a" column="fio" type="string" title="" />"
        <column table="a" column="passport" type="string" title="" />"
        <column table="a" column="site" type="string" title="" />"
        <column table="a" column="offshore" type="string" title="" />"
        <column table="a" column="offshore_kod" type="number" title="" />"
        <column table="a" column="kod_unig_dog" type="string" title="" />"
        <column table="a" column="dat_dog" type="string" title="" />"
        <column table="a" column="predm_dog" type="string" title="" />"
        <column table="a" column="price_type" type="string" title="" />"
        <column table="a" column="price_type_kod" type="number" title="" />"
        <column table="a" column="sum_dog" type="number" title="" />"
        <column table="a" column="data_type" type="string" title="" />"
        <column table="a" column="data_type_kod" type="number" title="" />"
        <column table="a" column="dat_beg" type="string" title="" />"
        <column table="a" column="dat_udal" type="string" title="" />"
        <column table="a" column="dog_type" type="string" title="" />"
        <column table="a" column="dog_type_kod" type="number" title="" />"
        <column table="a" column="invest_dog" type="string" title="" />"
        <column table="a" column="dog_conditions" type="string" title="" />"
        <column table="a" column="dog_num" type="string" title="" />"
        <column table="a" column="org_type" type="string" title="" />"
        <column table="a" column="org_type_kod" type="number" title="" />"
        <column table="a" column="publ_type" type="string" title="" />"
        <column table="a" column="publ_type_kod" type="number" title="" />"
        <column table="a" column="inn_sobs" type="string" title="" />"
        <column table="a" column="reg_num_sobs" type="string" title="" />"
        <column table="a" column="ogrn_sobs" type="string" title="" />"
        <column table="a" column="fs_name_sobs" type="string" title="" />"
        <column table="a" column="fs_kod_sobs" type="number" title="" />"
        <column table="a" column="name_sobs" type="string" title="" />"
        <column table="a" column="address_sobs" type="string" title="" />"
        <column table="a" column="passport_sobs" type="string" title="" />"
        <column table="a" column="type_sobs" type="string" title="" />"
        <column table="a" column="type_kod_sobs" type="number" title="" />"
        <column table="a" column="dol_sobs" type="string" title="" />"
        <column table="a" column="site_sobs" type="string" title="" />"
        <column table="a" column="inf_doc" type="string" title="" />"
        <column table="a" column="offshore_sobs" type="string" title="" />"
        <column table="a" column="offshore_kod_sobs" type="number" title="" />"
        <column table="a" column="podr" type="string" title="" />"
        <column table="a" column="curator" type="string" title="" />"
        <column table="a" column="curator_email" type="string" title="" /><column table="a" column="curator_tel" type="string" title="" />"
        <column table="a" column="ispoln" type="string" title="" />"
        <column table="a" column="ispoln_email" type="string" title="" />"
        <column table="a" column="num_dop_dog" type="string" title="" />"
        <column table="a" column="dat_dop_dog" type="string" title="" />"
        <column table="a" column="dop_dog_type" type="string" title="" />"
        <column table="a" column="dop_dog_type_kod" type="number" title="" />"
        <column table="a" column="dat_beg_dop_dog" type="string" title="" />"
      </select>
      <from>
        <table name="isv_otchet_147_dog_sobstv" as="a" view="1" />
      </from>
    </query>
    <query name="isv_otchet_147_dog_types" timestamp="14.11.2021 15:16:43" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <select>
        <column table="a" column="id" type="number" title="" />
        <column table="a" column="dog_type" type="string" title="" />
      </select>
      <from>
        <table name="isv_otchet_147_dog_types" as="a" view="1" />
      </from>
    </query>
    <query name="isv_otchet_subpodr_dog_types" timestamp="18.07.2022 15:16:37" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      <select>
        <column table="a" column="id" type="number" title="" />
        <column table="a" column="dog_type" type="string" title="" />
      </select>
      <from>
        <table name="isv_otchet_subpodr_dog_types" as="a" view="1" />
      </from>
    </query>
    <query name="ISV_OTCHET_SUBPODR" timestamp="18.07.2022 15:35:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      <select>
        <column table="a" column="col1" type="string" title="" />
        <column table="a" column="kod_dog" type="number" title="" />
        <column table="a" column="col2" type="string" title="" />
        <column table="a" column="col3" type="string" title="" />
        <column table="a" column="col4" type="string" title="" />
        <column table="a" column="col4_kod" type="number" title="" />
        <column table="a" column="col5" type="string" title="" />
        <column table="a" column="col6" type="string" title="" />
        <column table="a" column="col7" type="string" title="" />
        <column table="a" column="col8" type="string" title="" />
        <column table="a" column="col8_kod" type="number" title="" />
        <column table="a" column="col9" type="string" title="" />
        <column table="a" column="col9_kod" type="number" title="" />
        <column table="a" column="col10" type="string" title="" />
        <column table="a" column="col11" type="string" title="" />
        <column table="a" column="col12" type="string" title="" />
        <column table="a" column="col13" type="string" title="" />
        <column table="a" column="col14" type="string" title="" />
        <column table="a" column="col15" type="string" title="" />
        <column table="a" column="col15_kod" type="number" title="" />
        <column table="a" column="col16" type="string" title="" />
        <column table="a" column="col17" type="string" title="" />
        <column table="a" column="col18" type="string" title="" />
        <column table="a" column="col19" type="string" title="" />
        <column table="a" column="col20" type="string" title="" />
        <column table="a" column="col21" type="string" title="" />
        <column table="a" column="col21_kod" type="number" title="" />
      </select>
      <from>
        <table name="isv_otchet_subpodr" as="a" view="1" />
      </from>
    </query>
    <query name="ISV_REP_SHABL5_PRIS" timestamp="30.01.2020 13:29:02" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <select>
        <call function="rownum" as="id" />
        <column table="a" column="id_dog" type="string" title="" />
        <column table="a" column="kod_org" type="string" title="" />
        <column table="a" column="num_dog" type="string" title="" />
        <column table="a" column="dat_dog" type="date" />
        <column table="a" column="type_corr" type="string" />
        <column table="a" column="id_ds" type="string" title="" />
        <column table="a" column="num_ds" type="string" title="" />
        <column table="a" column="dat_ds" type="date" title="" />
        <column table="a" column="id_org" type="string" title="" />
        <column table="a" column="inn" type="string" title="" />
        <column table="a" column="kpp" type="string" title="" />
        <column table="a" column="grp" type="string" title="" />
        <column table="a" column="name_org" type="string" title="" />
        <column table="a" column="poluch_pl" type="string" title="" />
        <column table="a" column="vid_dog" type="string" title="" />
        <column table="a" column="tip_dog" type="string" title="" />
        <column table="a" column="ini_dog" type="string" title="" />
        <column table="a" column="predm_dog" type="string" title="" />
        <column table="a" column="kod_val" type="string" title="" />
        <column table="a" column="sum_vsego" type="number" title="" />
        <column table="a" column="pfm" type="string" title="" />
        <column table="a" column="finpos" type="string" title="" />
        <column table="a" column="status" type="number" title="" />
        <column table="a" column="kod_val_pl" type="string" title="" />
        <column table="a" column="dat_b_dog" type="date" title="" />
        <column table="a" column="dat_e_dog" type="date" title="" />
        <column table="a" column="dat_podpis" type="date" title="" />
        <column table="a" column="text_prizn" type="string" title="" />
        <column table="a" column="proc" type="number" title="" />
        <column table="a" column="sum_bez_nds" type="number" title="" />
        <column table="a" column="sum_nds" type="number" title="" />
        <column table="a" column="inn_strah" type="string" title="" />
        <column table="a" column="kpp_strah" type="string" title="" />
        <column table="a" column="name_strah" type="string" title="" />
        <column table="a" column="num_dog_strah" type="string" title="" />
        <column table="a" column="dat_start_strah" type="date" title="" />
        <column table="a" column="dat_end_strah" type="date" title="" />
        <column table="a" column="dat_end_dog" type="date" title="" />
        <column table="a" column="srok_strah" type="number" title="" />
        <column table="a" column="sum_strah" type="number" title="" />
        <column table="a" column="bonus_strah" type="number" title="" />
        <column table="a" column="vid_strah" type="string" />
        <column table="a" column="object_strah" type="string" />
        <column table="a" column="strah_sum" type="number" />
        <column table="a" column="cnt_strah" type="number" />
        <column table="a" column="kod_dog" type="number" />
        <column table="a" column="num_ram_dog" type="string" title="" />
        <column table="a" column="centr" type="string" />
        <column table="a" column="filial" type="string" />
        <column table="a" column="dat_start_smr_from_pd" type="date" />
        <column table="a" column="status_finish_rab" type="string" />
        <column table="a" column="dat_vvod" type="string" />
        <column table="a" column="dat_start_garant_from_pd" type="date" />
        <column table="a" column="dat_finish_garant_from_pd" type="date" />
        <column table="a" column="dat_start_smr" type="date" />
        <column table="a" column="dat_start_garant" type="date" />
        <column table="a" column="sum_strah_smr" type="number" />
        <column table="a" column="sum_strah_dav_mat" type="number" />
        <column table="a" column="sum_strah_garant" type="number" />
        <column table="a" column="sum_strah_gr_otv" type="number" />
        <column table="a" column="sum_franchise_1" type="number" />
        <column table="a" column="sum_franchise_2" type="number" />
        <column table="a" column="sum_prem_1" type="number" />
        <column table="a" column="sum_prem_2" type="number" />
        <column table="a" column="complex" type="string" />
        <column table="a" column="complex_link" type="string" />
        <column table="a" column="prich_strah" type="string" />
      </select>
      <from>
        <table name="isv_rep_shabl5_pris" as="a" view="1" />
      </from>
    </query>
    <query name="ISV_REP_SHABL6_PRIS" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <select>
        <call function="rownum" as="id" />
        <column table="a" column="id_cred" type="string" title="Идентификатор" />
        <column table="a" column="kod_org" type="string" title="Код организации" />
        <column table="a" column="grp" type="string" title="Группа" />
        <column table="a" column="name_cred" type="string" title="Наименование" />
        <column table="a" column="poluch_pl" type="string" title="Получатель платежа" />
        <column table="a" column="name_kr" type="string" title="Кр. наименование" />
        <column table="a" column="inn" type="string" title="ИНН" />
        <column table="a" column="kpp" type="string" title="КПП" />
        <column table="a" column="strana" type="string" title="Страна" />
        <column table="a" column="ind" type="string" title="Индекс" />
        <column table="a" column="region" type="string" title="Регион" />
        <column table="a" column="distr" type="string" title="Район" />
        <column table="a" column="nasp" type="string" title="Город" />
        <column table="a" column="ul" type="string" title="Улица" />
        <column table="a" column="num_d" type="string" title="Номер дома" />
        <column table="a" column="text_prizn" type="string" title="" />
      </select>
      <from>
        <table name="isv_rep_shabl6_pris" as="a" view="1" />
      </from>
    </query>
    <query name="ISV_REP_SHABL7_PRIS" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <select>
        <call function="rownum" as="idn" />
        <column table="a" column="id" type="string" title="Идентификатор" />
        <column table="a" column="kod_org" type="string" title="Код организации" />
        <column table="a" column="bic" type="string" title="БИК банка" />
        <column table="a" column="rs" type="string" title="Расчетный счет" />
        <column table="a" column="text_prizn" type="string" title="" />
      </select>
      <from>
        <table name="isv_rep_shabl7_pris" as="a" view="1" />
      </from>
    </query>
    <query name="33535-f1-data" timestamp="24.05.2017 19:12:23" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <expressions>
        <call function="if" as="tarif_st1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>0.4</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg2" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st2" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>0.4</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg3" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st3" group="sum">
          <call function="and">
            <call function="between">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>1</const>
              <const>20</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg2" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st4" group="sum">
          <call function="and">
            <call function="between">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>1</const>
              <const>20</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg3" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
      </expressions>
      <select>
        <column table="kod_gor_obl" column="kod_gor_obl" />
        <column table="kod_gor_obl" column="name" title="Субъект" />
        <column table="kod_ad_otch_f1" column="sum_load" />
        <column table="kod_ad_otch_f1" column="ur_lico" />
        <column table="kod_ad_otch_f1" column="fl_discount" />
        <column table="kod_ad_otch_f1" column="pr_cnt_mes" />
        <column table="kod_ad_otch_f1" column="pr_gen" />
        <column table="kod_ad_otch_f1" column="vrem_tp" />
        <fact column="tarif_st1" group="sum" nvl="0" />
        <fact column="tarif_st2" group="sum" nvl="0" />
        <fact column="tarif_st3" group="sum" nvl="0" />
        <fact column="tarif_st4" group="sum" nvl="0" />
        <fact column="isv_ad_otch_f1_sredn_vir" as="sredn_vir" title="Средняя выручка" group="sum" />
        <fact column="isv_ad_otch_f1_sredn_opl" as="sredn_opl" title="Средняя выручка" group="sum" />
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract" exclude="1" />
          <link name="kod_ad_otch_f1" all-rows="1">
            <link name="id_slice" exclude="1" />
          </link>
          <link name="kod_gor_obl" />
          <where exclude="1">
            <call function="or" exclude="1">
              <call function="and">
                <call function="!=">
                  <useparam name="id_slice" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
              <call function="=">
                <column table="id_slice" column="pr_srez" />
                <const>0</const>
              </call>
            </call>
            <call function="and">
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Гор/Обл">
          <group exclude="1">
            <sourcelink table="kod_gor_obl" />
          </group>
          <grset as="ls15" title="до 15 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="le">
                  <column column="sum_load" table="this" />
                  <const>15</const>
                </call>
              </call>
            </where>
            <grset as="ls15_fiz" title="до 15 кВт физ. лица">
              <where>
                <call function="and">
                  <call function="=0">
                    <column column="ur_lico" table="this" />
                  </call>
                </call>
              </where>
            </grset>
          </grset>
          <grset as="15to150" title="свыше 15 и до 150 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="gt">
                  <column column="sum_load" table="this" />
                  <const>15</const>
                </call>
                <call function="le">
                  <column column="sum_load" table="this" />
                  <const>150</const>
                </call>
              </call>
            </where>
            <grset as="15to150_dc" title="свыше 15 и до 150 кВт с льготами">
              <where>
                <call function="=1">
                  <column table="this" column="fl_discount" />
                </call>
              </where>
            </grset>
            <grset as="15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
              <where>
                <call function="=1">
                  <column table="this" column="pr_cnt_mes" />
                </call>
              </where>
            </grset>
          </grset>
          <grset as="150to670" title="свыше 150 кВт и менее 670 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="gt">
                  <column column="sum_load" table="this" />
                  <const>150</const>
                </call>
                <call function="lt">
                  <column column="sum_load" table="this" />
                  <const>670</const>
                </call>
              </call>
            </where>
          </grset>
          <grset as="gt670" title="не менее 670 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="ge">
                  <column column="sum_load" table="this" />
                  <const>670</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="объекты по производству электрической энергии" as="gen" exclude="1">
            <where>
              <call function="and">
                <call function="=1">
                  <column column="pr_gen" table="this" />
                </call>
              </call>
            </where>
          </grset>
          <grset title="временное технологическое присоединение" as="vrem" exclude="1">
            <where>
              <call function="and">
                <call function="=1">
                  <column column="vrem_tp" table="this" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="o" title="Обл">
            <where>
              <call function="=">
                <column table="this" column="kod_gor_obl" />
                <const>0</const>
              </call>
            </where>
            <usepart part="33535-f1-grsets">
              <const>'o_'</const>
            </usepart>
          </grset>
          <grset as="g" title="Гор">
            <where>
              <call function="=">
                <column table="this" column="kod_gor_obl" />
                <const>1</const>
              </call>
            </where>
            <usepart part="33535-f1-grsets">
              <const>'g_'</const>
            </usepart>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="33535-f2-data" timestamp="13.02.2018 10:36:45" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_gor_obl" column="kod_gor_obl" />
        <column table="kod_gor_obl" column="name" as="name_gor_obl" />
        <column table="kod_ad_otch_f2" column="filial" group="max" exclude="1" />
        <column table="kod_ad_otch_f2" column="str" group="max" />
        <column table="kod_ad_otch_f2" column="str1" group="max" />
        <column table="kod_ad_otch_f2" column="str2" group="max" />
        <column table="kod_ad_otch_f2" column="col_2" as="col_2" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_3" as="col_3" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_4" as="col_4" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_5" as="col_5" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_6" as="col_6" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_7" as="col_7" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_8" as="col_8" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_9" as="col_9" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_10" as="col_10" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_11" as="col_11" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_12" as="col_12" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_13" as="col_13" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_14" as="col_14" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_15" as="col_15" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_16" as="col_16" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_17" as="col_17" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_18" as="col_18" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_19" as="col_19" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_20" as="col_20" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_21" as="col_21" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_22" as="col_22" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_23" as="col_23" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_24" as="col_24" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_25" as="col_25" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_26" as="col_26" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_27" as="col_27" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_28" as="col_28" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_29" as="col_29" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_30" as="col_30" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_31" as="col_31" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_32" as="col_32" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_33" as="col_33" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_34_cnt" as="col_34" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_35" as="col_35" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_36" as="col_36" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_37" as="col_37" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_38" as="col_38" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_39" as="col_39" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_40" as="col_40" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_41" as="col_41" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_42" as="col_42" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_43" as="col_43" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_44" as="col_44" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_45" as="col_45" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_46" as="col_46" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_47" as="col_47" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_48" as="col_48" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_49" as="col_49" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_50" as="col_50" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_51" as="col_51" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_52" as="col_52" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_53" as="col_53" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_54" as="col_54" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_55" as="col_55" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_56" as="col_56" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_57" as="col_57" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_58" as="col_58" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_59" as="col_59" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_60" as="col_60" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_61" as="col_61" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_62" as="col_62" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_63" as="col_63" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_64" as="col_64" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_65" as="col_65" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_66" as="col_66" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_67" as="col_67" group="sum" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f2" all-rows="1" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_gor_obl" />
        </qube>
      </from>
      <grouping>
        <grset as="all">
          <usepart part="33535-f2-grsets">
            <const>'all_'</const>
          </usepart>
        </grset>
        <grset as="dep" order="filial" exclude="1">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="33535-f2-grsets">
            <const>'dep_'</const>
          </usepart>
        </grset>
        <grset as="dep" order="kod_gor_obl desc">
          <group>
            <sourcelink table="kod_gor_obl" />
          </group>
          <usepart part="33535-f2-grsets">
            <const>'dep_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="33535-f4-data" timestamp="25.05.2017 15:56:42" order="name_fil, num_ouco" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f4" column="isv_ad_otch_f4_id" key="1" />
        <column table="kod_ad_otch_f4" column="name_fil" />
        <column table="kod_ad_otch_f4" column="name_all" />
        <column table="kod_ad_otch_f4" column="supply" />
        <column table="kod_ad_otch_f4" column="lp_addr" />
        <column table="kod_ad_otch_f4" column="date_coming" />
        <column table="kod_ad_otch_f4" column="num_ouco" />
        <column table="kod_ad_otch_f4" column="dt_contract" />
        <column table="kod_ad_otch_f4" column="load123_kvt" />
        <column table="kod_ad_otch_f4" column="voltage" />
        <column table="kod_ad_otch_f4" column="kateg" />
        <column table="kod_ad_otch_f4" column="sum_dog" />
        <column table="kod_ad_otch_f4" column="opl_d" />
        <column table="kod_ad_otch_f4" column="col_14" />
        <column table="kod_ad_otch_f4" column="col_15" />
        <column table="kod_ad_otch_f4" column="srok_uslug" />
        <column table="kod_ad_otch_f4" column="year_plan" />
        <column table="kod_ad_otch_f4" column="col_18" />
        <column table="kod_ad_otch_f4" column="col_19" />
        <column table="kod_ad_otch_f4" column="col_20" />
        <column table="kod_ad_otch_f4" column="col_21" />
        <column table="kod_ad_otch_f4" column="proc_isp_pir" />
        <column table="kod_ad_otch_f4" column="proc_isp_smr" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f4" all-rows="1" />
          <link name="ipr_kod_ispolnit" only-for-cond="1" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="33535-gor_obl" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <select>
        <column table="a" column="kod_gor_obl" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="33535-gor_obl" as="a" view="1" />
      </from>
    </query>
    <query name="33535-f1-title" timestamp="02.06.2017 16:49:27" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <call function="date to char" as="sdate_form">
          <column table="a" column="dat_copy" />
        </call>
        <call function="date to char" as="sdate_year_begin">
          <call function="year begin time">
            <call function="year">
              <column table="a" column="dat_copy" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="33535-f6-data" timestamp="25.05.2017 16:53:56" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_ad_otch_f6" column="name_fil" as="col_2" group="max" />
        <column table="kod_ad_otch_f6" column="num_req" as="col_3" group="max" />
        <column table="kod_ad_otch_f6" column="supply" as="col_4" group="max" />
        <column table="kod_ad_otch_f6" column="date_coming" as="col_5" group="max" />
        <column table="kod_ad_otch_f6" column="col_6" as="col_6" group="max" />
        <column table="kod_ad_otch_f6" column="num_ouco" as="col_7" group="max" />
        <column table="kod_ad_otch_f6" column="dt_contract" as="col_8" group="max" />
        <column table="kod_ad_otch_f6" column="load123_kvt" as="col_9" group="max" />
        <column table="kod_ad_otch_f6" column="voltage" as="col_10" group="max" />
        <fact column="isv_ad_otch_f6_sum_dog" as="col_11" group="max" mp="-6" />
        <fact column="isv_ad_otch_f6_opl_d" as="col_12" group="max" mp="-6" />
        <column table="kod_ad_otch_f6" column="col_13" as="col_13" group="max" />
        <column table="kod_ad_otch_f6" column="col_14" as="col_14" group="max" />
        <column table="kod_ad_otch_f6" column="srok_uslug" as="col_15" group="max" />
        <column table="kod_ad_otch_f6" column="year_plan" as="col_16" group="max" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f6" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_dop_contract" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ad_otch_f6" column="kod_filial" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="itog" title="Итог" />
        <grset as="detail" title="Детализация" order="col_2, col_11">
          <group>
            <sourcelink table="kod_dop_contract" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="33535-f7-data" timestamp="25.05.2017 16:30:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f7" column="isv_ad_otch_f7_id" exclude="1" />
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_ad_otch_f7" column="name_fil" as="col_2" group="max" />
        <column table="kod_ad_otch_f7" column="name_all" as="col_3" group="max" />
        <column table="kod_ad_otch_f7" column="supply" as="col_4" group="max" />
        <column table="kod_ad_otch_f7" column="load123_kvt" as="col_6" group="max" />
        <column table="kod_ad_otch_f7" column="voltage" as="col_7" group="max" />
        <column table="kod_ad_otch_f7" column="date_coming" as="col_9" group="max" />
        <column table="kod_ad_otch_f7" column="col_10" as="col_10" group="max" />
        <column table="kod_ad_otch_f7" column="num_ouco" as="col_11" group="max" />
        <column table="kod_ad_otch_f7" column="dt_contract" as="col_12" group="max" />
        <fact column="isv_ad_otch_f7_sum_dog" as="col_13" group="max" />
        <column table="kod_ad_otch_f7" column="sum_dog" as="col_13" exclude="1" group="max" />
        <fact column="isv_ad_otch_f7_opl_d" as="col_14" group="max" />
        <column table="kod_ad_otch_f7" column="opl_d" as="col_14" exclude="1" group="max" />
        <column table="kod_ad_otch_f7" column="col_15" as="col_15" group="max" />
        <column table="kod_ad_otch_f7" column="col_16" as="col_16" group="max" />
        <column table="kod_ad_otch_f7" column="srok_uslug" as="col_17" group="max" />
        <column table="kod_ad_otch_f7" column="year_plan" as="col_18" group="max" />
        <column table="kod_ad_otch_f7" column="col_19" as="col_19" group="max" />
        <column table="kod_ad_otch_f7" column="col_20" as="col_20" group="max" />
        <column table="kod_ad_otch_f7" column="col_21" as="col_21" group="max" />
        <column table="kod_ad_otch_f7" column="col_22" as="col_22" group="max" />
        <column table="kod_ad_otch_f7" column="proc_isp_pir" as="col_23" group="max" />
        <column table="kod_ad_otch_f7" column="proc_isp_smr" as="col_24" group="max" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f7" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_dop_contract" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ad_otch_f7" column="kod_filial" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="itog" title="Итог" />
        <grset as="detail" title="Детализация" order="col_2, col_11">
          <group>
            <sourcelink table="kod_dop_contract" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="33535-f8-data" timestamp="30.05.2017 10:50:36" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f8" column="sum_load" group="sum" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_15" group="sum" if="15" nvl="0">
          <if>
            <call function="le">
              <column table="kod_ad_otch_f8" column="sum_load" />
              <const>15</const>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_150" group="sum" if="150" nvl="0">
          <if>
            <call function="and">
              <call function="gt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>15</const>
              </call>
              <call function="le">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>150</const>
              </call>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_670" group="sum" if="670" nvl="0">
          <if>
            <call function="and">
              <call function="gt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>150</const>
              </call>
              <call function="lt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>670</const>
              </call>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_999" group="sum" if="999" nvl="0">
          <if>
            <call function="ge">
              <column table="kod_ad_otch_f8" column="sum_load" />
              <const>670</const>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_999" group="sum" if="999" nvl="0" />
        <column table="okved2" column="val" as="okved2" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f8" all-rows="1" />
          <link name="okved2" />
          <where>
            <call function="and">
              <call function="true" />
            </call>
            <call function="le" exclude="1">
              <call function="rownum" />
              <const>100</const>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Итог" />
        <grset as="de" title="Детализация" order="case when okved2 like 'Прочее%' then 'ЯЯЯЯ' else okved2 end">
          <group>
            <sourcelink table="okved2" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="33535-f5" timestamp="07.06.2017 16:58:05" is-report="1" title="Форма 5" folder="forms_tp" can-use-simple-params="1" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <customers>
        <customer id="17" />
      </customers>
      <events>
        <useaction event-name="double-click" action-type="open-grouping-detail" call="34397-detail">
          <useparam name="kod_doc_osn" />
          <useparam name="dat1" />
          <useparam name="dat2" />
        </useaction>
      </events>
      <params exclude="1">
        <usepart part="34397-params" />
      </params>
      <print-templates>
        <excel>
          <template name="34397.xml" title="Форма 5" print-proc="2" client-view="1" />
        </excel>
      </print-templates>
      <content>
        <usefield field="ipr_doc_osn" name="kod_doc_osn" column-mandatory="1" />
        <fieldgroup title="Отчетный период">
          <usefield field="cmn_date" name="dat1" title="C" column-mandatory="1">
            <defaultquery>
              <query name="30196-begin-year" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date_cur" name="dat2" title="По" column-mandatory="1" />
        </fieldgroup>
      </content>
      <expressions>
        <usepart part="34397-expr" />
      </expressions>
      <select>
        <usepart part="34397-select" />
      </select>
      <from>
        <usepart part="34397-from" />
      </from>
      <grouping>
        <grset as="all">
          <usepart part="34397-grsets">
            <const>'all_'</const>
          </usepart>
        </grset>
        <grset as="spb">
          <usepart part="34397-grsets">
            <const>'spb_'</const>
          </usepart>
          <where>
            <call function="=">
              <column table="this" column="kod_subject" />
              <const>0</const>
            </call>
          </where>
        </grset>
        <grset as="lo">
          <usepart part="34397-grsets">
            <const>'lo_'</const>
          </usepart>
          <where>
            <call function="=">
              <column table="this" column="kod_subject" />
              <const>1</const>
            </call>
          </where>
        </grset>
      </grouping>
      <!--<where >
        <call function="and">
          <call function="=">
            <column table="a" column="kod_dogplat" />
            <const>1000001107</const>
          </call>
        </call>
      </where>-->
    </query>
    <query name="34397-detail" timestamp="31.05.2017 17:17:33" is-report="1" visible="0" folder="forms_tp" title="Форма 5. Детализация" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <usepart part="34397-params" />
      </params>
      <expressions>
        <usepart part="34397-expr" />
      </expressions>
      <select>
        <usepart part="34397-select" />
      </select>
      <from>
        <usepart part="34397-from" />
      </from>
      <grouping />
      <!--<where >
        <call function="and">
          <call function="=">
            <column table="a" column="kod_dogplat" />
            <const>1000001107</const>
          </call>
        </call>
      </where>-->
    </query>
    <query name="vr_rep_34397_col" timestamp="29.05.2017 18:16:18" class="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\vr_rep_34397_col.xml">
      <select>
        <column table="a" column="kod_rep_34397_col" type="number" key="1" />
        <column table="a" column="name" type="string" data-size="300" title="Наименование колонки" />
        <!--<column table="kod_podr" column="name" />
        <column table="kodp" column="nump" />-->
        <!--<column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="num_sf" />-->
        <!--<column table="kod_opl" column="kod_opl" />
        <column table="kod_opl" column="dat_opl" />-->
        <!--<fact column="fin_ul_fl_opl" />
        <fact column="ur_opl" />
        <fact column="sr_facras_nachisl" />-->
      </select>
      <from>
        <table name="vr_rep_34397_col" as="a" />
        <!--<query name="ur_mat" as="a">
        </query>-->
      </from>
    </query>
    <query name="vr_rep_34397_col_razdel" timestamp="29.05.2017 19:38:40" class="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\vr_rep_34397_col_razdel.xml">
      <select>
        <column table="a" column="kod_rep_34397_col_rzd" type="number" key="1" />
        <column table="a" column="kod_rep_34397_col" type="number" />
        <column table="a" column="kod_razdel" type="number" />
        <column table="a" column="with_childs" type="number" controlType="UICheck" title="С дочерними" />
        <call function="||" as="name" fact="vr_rep_34397_col_raz_nm" agg="list">
          <column table="kod_razdel" column="abbr" as="name" />
          <call function="if">
            <call function="=1">
              <column table="this" column="with_childs" />
            </call>
            <const>'*'</const>
          </call>
        </call>
        <!--<column table="kod_podr" column="name" />
        <column table="kodp" column="nump" />-->
        <!--<column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="num_sf" />-->
        <!--<column table="kod_opl" column="kod_opl" />
        <column table="kod_opl" column="dat_opl" />-->
        <!--<fact column="fin_ul_fl_opl" />
        <fact column="ur_opl" />
        <fact column="sr_facras_nachisl" />-->
      </select>
      <from>
        <table name="vr_rep_34397_col_razdel" as="a" />
        <query join="left outer" name="vr_rep_34397_col" as="kod_rep_34397_col" ConstrDelOption="cascade" dimension="1" is-final-dimension="1" is-private-dimension="1">
          <call function="=">
            <column table="a" column="kod_rep_34397_col" />
            <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
          </call>
        </query>
        <query join="left outer" name="ips_razdel_ip" as="kod_razdel" ConstrDelOption="cascade">
          <call function="=">
            <column table="a" column="kod_razdel" />
            <column table="kod_razdel" column="kod_razdel" />
          </call>
        </query>
        <!--<query name="ur_mat" as="a">
        </query>-->
      </from>
    </query>
    <query name="vr_rep_34397_col_r_all" timestamp="30.05.2017 14:43:06" class="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\vr_rep_34397_col_razdel.xml">
      <select>
        <column table="a" column="kod_rep_34397_col" />
        <column table="c" column="kod_razdel_child" as="kod_razdel" />
      </select>
      <from>
        <query name="vr_rep_34397_col_razdel" as="a">
          <link name="kod_razdel" as="b">
            <elink name="ips_razdel_ip_ext_tree_p" as="c" />
          </link>
        </query>
        <query name="ips_razdel_ip" as="kod_razdel" join="left outer">
          <call function="=">
            <column table="kod_razdel" column="kod_razdel" />
            <column table="this" column="kod_razdel" />
          </call>
        </query>
        <query join="left outer" name="vr_rep_34397_col" as="kod_rep_34397_col" ConstrDelOption="cascade">
          <call function="=">
            <column table="this" column="kod_rep_34397_col" />
            <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="=">
            <column table="c" column="kod_razdel_parent" />
            <column table="c" column="kod_razdel_child" />
          </call>
          <call function="=1">
            <column table="a" column="with_childs" />
          </call>
        </call>
      </where>
      <!--<where >
        <call function="and">
          <call function="=">
            <column table="a" column="kod_dogplat" />
            <const>1000001107</const>
          </call>
        </call>
      </where>-->
    </query>
    <query name="44098-dat-month" timestamp="25.01.2018 13:07:12" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="kod_dop_contract" />
        <column table="b" column="ym2" as="ym" />
        <column table="b" column="name_str" as="month_name" />
        <call function="if" as="day_req" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_req" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_docs_got" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_req" />
        </call>
        <call function="if" as="day_tu" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_tu" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_pz" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_tu" />
        </call>
        <call function="if" as="day_ocen" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_ocen" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_cost_put" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_ocen" />
        </call>
        <call function="if" as="day_proj" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_proj" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_project" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_proj" />
        </call>
        <call function="if" as="day_dog" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_dog" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_sogl_dog" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_dog" />
        </call>
        <call function="if" as="day_sign" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_sign" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_podp_dog" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_sign" />
        </call>
        <call function="if" as="day_mess" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_mess" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_mess" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_mess" />
        </call>
        <call function="if" as="day_client_proj" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_client_proj" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_client_proj" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <column table="a" column="day_client_proj" />
        </call>
        <call function="if" as="cnt_zayav" type="number">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="ym" type="number" title="" />
            </call>
            <call function="between">
              <column table="a" column="dt_request" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" type="number" as="cnt_uved_ok">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_mess" type="number" title="" />
            </call>
            <call function="=0">
              <column table="a" column="tbl_uved" />
            </call>
            <call function="between">
              <column table="a" column="dt_mess" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" type="number" as="cnt_uved_not_ok">
          <call function="and">
            <call function="=">
              <column table="b" column="ym" />
              <column table="a" column="mes_mess" type="number" title="" />
            </call>
            <call function="=1">
              <column table="a" column="tbl_uved" />
            </call>
            <call function="between">
              <column table="a" column="dt_mess" />
              <useparam name="p_dt1" />
              <useparam name="p_dt2" />
            </call>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="44098-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-months" join="cross" as="b">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-1" timestamp="22.01.2018 10:45:16" use-repository="1" order="2,3,4,5" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="a" column="kod_dop_contract" />
        <column table="a" column="kn_request" />
        <column table="a" column="num_ouco" />
        <column table="a" column="dat_ouco" />
        <column table="a" column="dt_contract" />
        <column table="a" column="num_req" />
        <column table="a" column="dt_request" />
        <column table="a" column="kurator_req" />
        <column table="a" column="load_type" />
        <column table="a" column="st_req" />
        <column table="a" column="creat_req_db" />
        <column table="a" column="req_path" />
        <column table="a" column="customer" />
        <column table="a" column="contr_kind" />
        <column table="a" column="contr_sum_f" />
        <column table="a" column="contr_sum_m" />
        <column table="a" column="contr_sum_e" />
        <column table="a" column="kn_zone" />
        <column table="a" column="load" />
        <column table="a" column="load1" />
        <column table="a" column="load2" />
        <column table="a" column="load3" />
        <column table="a" column="load_existed" />
        <column table="a" column="list_load" />
        <column table="a" column="list_eskl" />
        <column table="a" column="tbl_uved" />
        <column table="a" column="tbl_req" />
        <column table="a" column="tbl_tu" />
        <column table="a" column="tbl_ocen" />
        <column table="a" column="tbl_proj" />
        <column table="a" column="tbl_dog" />
        <column table="a" column="tbl_sign" />
        <column table="a" column="tbl_mess" />
        <column table="a" column="kateg_depend" />
        <column table="a" column="fl_build" />
        <column table="a" column="filial" />
        <column table="a" column="kurator" />
        <column table="a" column="name_status" />
        <column table="a" column="status" />
        <column table="a" column="fio" />
        <column table="a" column="name_direct" />
        <column table="a" column="name_viza" />
        <column table="a" column="dat_post" />
        <column table="a" column="dat_viz" />
        <column table="a" column="prim" />
        <column table="a" column="spec_text" />
        <column table="a" column="tel" />
        <column table="a" column="dolgn" />
        <column table="a" column="polzov" />
        <column table="a" column="dpk" />
        <column table="a" column="ym" />
        <column table="a" column="dt_lack_req" />
        <column table="a" column="dt_lack_req_max" />
        <column table="a" column="dt_docs_got" />
        <column table="a" column="dt_pz" />
        <column table="a" column="dt_cost_put" />
        <column table="a" column="dt_project" />
        <column table="a" column="dt_mess" />
        <column table="a" column="dt_mess_too" />
        <column table="a" column="dt_client_proj" />
        <column table="a" column="dt_client_sign" />
        <column table="a" column="dt_pass_up" />
        <column table="a" column="dt_pass_eb" />
        <column table="a" column="dt_pass_cc" />
        <column table="a" column="dt_pass_od" />
        <column table="a" column="dt_rmo" />
        <column table="a" column="dt_rmo_max" />
        <column table="a" column="mes_req" />
        <column table="a" column="day_req" />
        <column table="a" column="srok_req" />
        <column table="a" column="otkl_req" />
        <column table="a" column="mes_tu" />
        <column table="a" column="day_tu" />
        <column table="a" column="srok_tu" />
        <column table="a" column="otkl_tu" />
        <column table="a" column="mes_ocen" />
        <column table="a" column="day_ocen" />
        <column table="a" column="srok_ocen" />
        <column table="a" column="otkl_ocen" />
        <column table="a" column="mes_proj" />
        <column table="a" column="day_proj" />
        <column table="a" column="srok_proj" />
        <column table="a" column="otkl_proj" />
        <column table="a" column="mes_dog" />
        <column table="a" column="day_dog" />
        <column table="a" column="srok_dog" />
        <column table="a" column="otkl_dog" />
        <column table="a" column="mes_sign" />
        <column table="a" column="day_sign" />
        <column table="a" column="srok_sign" />
        <column table="a" column="otkl_sign" />
        <column table="a" column="day_22_4_sign" />
        <column table="a" column="srok_22_4_sign" />
        <column table="a" column="otkl_22_4_sign" />
        <column table="a" column="mes_mess" />
        <column table="a" column="day_mess" />
        <column table="a" column="srok_mess" />
        <column table="a" column="otkl_mess" />
        <column table="a" column="mes_client_proj" />
        <column table="a" column="day_client_proj" />
        <column table="a" column="mes_all" />
        <column table="a" column="day_all" />
        <column table="a" column="srok_all" />
        <column table="a" column="otkl_all" />
        <column table="a" column="dat_lkk" />
        <column table="a" column="dt_sogl_dog" />
        <column table="a" column="dt_podp_dog" />
        <column table="a" column="dt_podp_dog_ep" />
        <column table="a" column="fio_podp_dog" />
        <column table="a" column="fio_kont" />
        <column table="a" column="e_mail_kont" />
        <column table="a" column="phone_kont" />
      </select>
      <from>
        <query name="44098-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-dat-status" timestamp="25.01.2018 12:38:11" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="kod_dop_contract" />
        <column table="b" column="id" as="st_id" />
        <column table="b" column="name" as="st_name" />
        <call function="case" as="cnt_ok" type="number">
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_req" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_docs_got" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>2</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_tu" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_pz" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>3</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_ocen" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_cost_put" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>4</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_proj" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_project" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>5</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_dog" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_sogl_dog" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>6</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_sign" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_podp_dog" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>7</const>
              </call>
              <call function="=">
                <column table="a" column="tbl_mess" />
                <const>0</const>
              </call>
              <call function="between">
                <column table="a" column="dt_mess" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="case" as="cnt_not_ok" type="number">
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>1</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_req" />
              </call>
              <call function="between">
                <column table="a" column="dt_docs_got" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>2</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_tu" />
              </call>
              <call function="between">
                <column table="a" column="dt_pz" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>3</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_ocen" />
              </call>
              <call function="between">
                <column table="a" column="dt_cost_put" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>4</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_proj" />
              </call>
              <call function="between">
                <column table="a" column="dt_project" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>5</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_dog" />
              </call>
              <call function="between">
                <column table="a" column="dt_sogl_dog" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>6</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_sign" />
              </call>
              <call function="between">
                <column table="a" column="dt_podp_dog" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="b" column="id" />
                <const>7</const>
              </call>
              <call function="=1">
                <column table="a" column="tbl_mess" />
              </call>
              <call function="between">
                <column table="a" column="dt_mess" />
                <useparam name="p_dt1" />
                <useparam name="p_dt2" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
      </select>
      <from>
        <query name="44098-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-status" join="left outer" as="b">
          <call function="true" />
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-pre" timestamp="06.03.2018 15:37:31" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
        <column table="lt" column="id" as="lt_id" />
        <column table="lt" column="name" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
        <query name="44098-ltype" join="left outer" as="lt">
          <call function="and">
            <call function="=">
              <column table="a" column="list_load" />
              <column table="lt" column="load" />
            </call>
            <call function="=">
              <column table="a" column="list_eskl" />
              <column table="lt" column="eskl" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="ge">
            <call function="coalesce">
              <column table="a" column="dt_client_proj" />
              <column table="a" column="dt_mess" />
              <column table="a" column="dt_podp_dog" />
              <column table="a" column="dt_sogl_dog" />
              <column table="a" column="dt_project" />
              <column table="a" column="dt_cost_put" />
              <column table="a" column="dt_pz" />
              <column table="a" column="dt_docs_got" />
              <column table="a" column="dt_request" />
            </call>
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_request" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge" optional="1">
            <column table="a" column="dt_request" />
            <useparam name="p_dt3" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="dt_request" />
            <useparam name="p_dt4" />
          </call>
          <call function="=">
            <column table="this" column="lt_id" />
            <useparam name="p_list_type" />
          </call>
          <call function="is not null" comment="только заявки, по которым есть виза «Подписано»">
            <column table="a" column="dt_podp_dog" />
          </call>
          <call function="!=">
            <column table="a" column="status" />
            <const>29</const>
          </call>
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17,24,38,21,32</array>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-months" timestamp="22.01.2018 12:48:59" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="spr_time_ym" as="a" />
      </from>
      <where>
        <call function="between">
          <column table="a" column="ym2" />
          <call function="date to ym2">
            <useparam name="p_dt1" />
          </call>
          <call function="date to ym2">
            <useparam name="p_dt2" />
          </call>
        </call>
      </where>
    </query>
    <query name="44098-2" timestamp="01.12.2017 15:27:03" use-repository="1" order="ym" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="row_num" as="id" key="1">
          <const>null</const>
        </call>
        <column table="a" column="ym" group="1" />
        <column table="a" column="month_name" group="max" />
        <column table="a" column="day_req" type="number" title="" group="avg" />
        <column table="a" column="day_tu" type="number" title="" group="avg" />
        <column table="a" column="day_ocen" type="number" title="" group="avg" />
        <column table="a" column="day_proj" type="number" title="" group="avg" />
        <column table="a" column="day_dog" type="number" title="" group="avg" />
        <column table="a" column="day_sign" type="number" title="" group="avg" />
        <column table="a" column="day_mess" type="number" title="" group="avg" />
        <column table="a" column="day_client_proj" type="number" title="" group="avg" />
        <column table="a" column="cnt_zayav" type="number" title="" group="sum" />
        <column table="a" column="cnt_uved_ok" type="number" title="" group="sum" />
        <column table="a" column="cnt_uved_not_ok" type="number" title="" group="sum" />
      </select>
      <from>
        <query name="44098-dat-month" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-2-3" timestamp="23.01.2018 15:51:09" use-repository="1" order="name_direct" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="row_num" as="id" key="1">
          <const>null</const>
        </call>
        <column table="a" column="filial" group="1" as="name_direct" />
        <call function="if" as="day_req" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_req" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_req" />
        </call>
        <call function="if" as="day_req" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_docs_got" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_req" />
        </call>
        <call function="if" as="day_tu" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_tu" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_tu" />
        </call>
        <call function="if" as="day_tu" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_pz" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_tu" />
        </call>
        <call function="if" as="day_ocen" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_ocen" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_ocen" />
        </call>
        <call function="if" as="day_ocen" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_cost_put" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_ocen" />
        </call>
        <call function="if" as="day_proj" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_proj" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_proj" />
        </call>
        <call function="if" as="day_proj" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_project" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_proj" />
        </call>
        <call function="if" as="day_dog" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_dog" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_dog" />
        </call>
        <call function="if" as="day_dog" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_sogl_dog" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_dog" />
        </call>
        <call function="if" as="day_sign" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_sign" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_sign" />
        </call>
        <call function="if" as="day_sign" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_podp_dog" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_sign" />
        </call>
        <call function="if" as="day_mess" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_mess" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_mess" />
        </call>
        <call function="if" as="day_mess" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_mess" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_mess" />
        </call>
        <call function="if" as="day_client_proj" type="number" group="avg" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="mes_client_proj" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <column table="a" column="day_client_proj" />
        </call>
        <call function="if" as="day_client_proj" type="number" group="avg">
          <call function="between">
            <column table="a" column="dt_client_proj" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <column table="a" column="day_client_proj" />
        </call>
        <call function="if" as="cnt_zayav" type="number" group="sum" exclude="1">
          <call function="between">
            <call function="*">
              <column table="a" column="ym" />
              <const>100</const>
            </call>
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
          </call>
          <const>1</const>
        </call>
        <call function="if" as="cnt_zayav" type="number" group="sum">
          <call function="between">
            <column table="a" column="dt_request" />
            <useparam name="p_dt1" />
            <useparam name="p_dt2" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="44098-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-mon2" timestamp="30.11.2017 17:11:30" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="ym2" />
      </select>
      <from>
        <query name="spr_time_ym" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym2" />
          <call function="ym2 add month">
            <call function="date to ym2">
              <call function="sysdate" />
            </call>
            <const>-1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-mon1" timestamp="30.11.2017 15:39:00" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="ym2" />
      </select>
      <from>
        <query name="spr_time_ym" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym2" />
          <call function="ym2 add month">
            <call function="date to ym2">
              <call function="sysdate" />
            </call>
            <const>-12</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-ltype" timestamp="30.11.2017 20:39:15" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'мощность до 150 кВт (включительно), подписант ЭСКЛ'</const>
      <const as="load" type="number">1</const>
      <const as="eskl" type="number">1</const>
      <const>2</const>
      <const>'мощность до 150 кВт (включительно), подписант не ЭСКЛ'</const>
      <const>1</const>
      <const>0</const>
      <const>3</const>
      <const>'мощность свыше 150 кВт, подписант ЭСКЛ'</const>
      <const>0</const>
      <const>1</const>
      <const>4</const>
      <const>'мощность свыше 150 кВт, подписант не ЭСКЛ'</const>
      <const>0</const>
      <const>0</const>
    </query>
    <query name="44098-status" timestamp="01.12.2017 16:11:12" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'Обработка заявки'</const>
      <const>2</const>
      <const>'Подготовка ТУ'</const>
      <const>3</const>
      <const>'Оценка ТУ'</const>
      <const>4</const>
      <const>'Подготовка договора'</const>
      <const>5</const>
      <const>'Согласование договора'</const>
      <const>6</const>
      <const>'Подписание договора'</const>
      <const>7</const>
      <const>'Уведомление о готовности'</const>
    </query>
    <query name="44098-2-4" timestamp="23.01.2018 15:51:10" use-repository="1" order="st_id" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="row_num" as="id" key="1">
          <const>null</const>
        </call>
        <column table="a" column="st_id" group="1" />
        <column table="a" column="st_name" group="max" />
        <column table="a" column="cnt_ok" group="sum" />
        <column table="a" column="cnt_not_ok" group="sum" />
      </select>
      <from>
        <query name="44098-dat-status" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-2-2" timestamp="03.12.2017 17:41:19" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="row_num" as="id" key="1">
          <const>null</const>
        </call>
        <column table="a" column="day_req" type="number" title="" group="avg" />
        <column table="a" column="day_tu" type="number" title="" group="avg" />
        <column table="a" column="day_ocen" type="number" title="" group="avg" />
        <column table="a" column="day_proj" type="number" title="" group="avg" />
        <column table="a" column="day_dog" type="number" title="" group="avg" />
        <column table="a" column="day_sign" type="number" title="" group="avg" />
        <column table="a" column="day_mess" type="number" title="" group="avg" />
        <column table="a" column="day_client_proj" type="number" title="" group="avg" />
      </select>
      <from>
        <query name="44098-dat-month" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44098-dt1" timestamp="30.01.2018 13:38:52" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <call as="dt1" function="trunc" type="date">
          <call table="a" column="ym2" function="-" type="date">
            <call function="sysdate" />
            <const>1</const>
          </call>
          <const>'MM'</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="44098-dt2" timestamp="30.01.2018 13:36:29" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <call function="-" as="dt2" type="date">
          <call table="a" column="ym2" function="trunc" type="date">
            <call function="sysdate" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="44098-dt_vld" timestamp="22.01.2018 11:00:14" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <param name="p_dt1" type="date">
          <const>date'2017-02-01'</const>
        </param>
        <param name="p_dt2" type="date">
          <const>date'2018-01-01'</const>
        </param>
      </params>
      <select>
        <call function="case" type="string" as="val">
          <call function="when">
            <call function="gt">
              <call function="months_between">
                <call function="trunc" type="date">
                  <useparam name="p_dt2" />
                  <const>'MM'</const>
                </call>
                <call function="trunc" type="date">
                  <useparam name="p_dt1" />
                  <const>'MM'</const>
                </call>
              </call>
              <const>11</const>
            </call>
            <const>'Период не должен превышать 12 месяцев'</const>
          </call>
          <call function="when">
            <call function="lt">
              <call function="-">
                <useparam name="p_dt2" />
                <useparam name="p_dt1" />
              </call>
              <const>0</const>
            </call>
            <const>'Период задан некорректно'</const>
          </call>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="44098-ltype2" timestamp="23.01.2018 15:23:37" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'от 0 до 150 кВт'</const>
      <const as="load" type="number">1</const>
      <const>2</const>
      <const>'свыше 150 кВт'</const>
      <const>0</const>
    </query>
    <query name="44098-direct" timestamp="25.01.2018 17:31:38" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="kod_predpr" />
        <column table="a" column="name_kr" />
      </select>
      <from>
        <query name="is_spr_direct" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_spr_doc" />
            <const>63</const>
          </call>
          <call function="!=">
            <column table="a" column="kod_predpr" />
            <const>'9999'</const>
          </call>
          <call function="is null">
            <column table="a" column="god" />
          </call>
        </call>
      </where>
    </query>
    <query name="44098-direct-det-list" timestamp="26.01.2018 12:27:02" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'ЭСКЛ'</const>
      <const>2</const>
      <const>'филиал'</const>
      <const>3</const>
      <const>'ИА ЛЭ'</const>
    </query>
    <query name="44098-direct-det" timestamp="30.01.2018 13:29:47" use-repository="1" order="kod_predpr, id_podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="kod_predpr" />
        <column table="a" column="name_kr" />
        <column table="d" column="id" as="id_podr" />
        <call function="if" as="name_podr" type="string">
          <call function="=">
            <column table="d" column="name" />
            <const>'филиал'</const>
          </call>
          <column table="a" column="name_kr" />
          <column table="d" column="name" />
        </call>
      </select>
      <from>
        <query name="44098-direct" as="a" />
        <query name="44098-direct-det-list" as="d" join="cross" />
      </from>
      <where>
        <call function="not">
          <call function="and">
            <call function="in">
              <column table="a" column="name_kr" />
              <array>'КС','СПбВС'</array>
            </call>
            <call function="=">
              <column table="d" column="name" />
              <const>'филиал'</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-detail" timestamp="28.09.2018 17:00:41" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" part-id="44098-3-detail-select" />
        <column table="a" column="kod_dop_contract" part-id="44098-3-detail-select" />
        <column table="a" column="kn_request" part-id="44098-3-detail-select" />
        <column table="a" column="num_ouco" part-id="44098-3-detail-select" />
        <column table="a" column="dat_ouco" part-id="44098-3-detail-select" />
        <column table="a" column="dt_contract" part-id="44098-3-detail-select" />
        <column table="a" column="num_req" part-id="44098-3-detail-select" />
        <column table="a" column="dt_request" part-id="44098-3-detail-select" />
        <column table="a" column="kurator_req" part-id="44098-3-detail-select" />
        <column table="a" column="load_type" part-id="44098-3-detail-select" />
        <column table="a" column="st_req" part-id="44098-3-detail-select" />
        <column table="a" column="creat_req_db" part-id="44098-3-detail-select" />
        <column table="a" column="req_path" part-id="44098-3-detail-select" />
        <column table="a" column="customer" part-id="44098-3-detail-select" />
        <column table="a" column="contr_kind" part-id="44098-3-detail-select" />
        <column table="a" column="contr_sum_f" part-id="44098-3-detail-select" />
        <column table="a" column="contr_sum_m" part-id="44098-3-detail-select" />
        <column table="a" column="contr_sum_e" part-id="44098-3-detail-select" />
        <column table="a" column="kn_zone" part-id="44098-3-detail-select" />
        <column table="a" column="load" part-id="44098-3-detail-select" />
        <column table="a" column="load1" part-id="44098-3-detail-select" />
        <column table="a" column="load2" part-id="44098-3-detail-select" />
        <column table="a" column="load3" part-id="44098-3-detail-select" />
        <column table="a" column="load_existed" part-id="44098-3-detail-select" />
        <column table="a" column="list_load" part-id="44098-3-detail-select" />
        <column table="a" column="list_eskl" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_uved" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_req" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_tu" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_ocen" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_proj" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_dog" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_sign" part-id="44098-3-detail-select" />
        <column table="a" column="tbl_mess" part-id="44098-3-detail-select" />
        <column table="a" column="kateg_depend" part-id="44098-3-detail-select" />
        <column table="a" column="fl_build" part-id="44098-3-detail-select" />
        <column table="a" column="filial" part-id="44098-3-detail-select" />
        <column table="a" column="kurator" part-id="44098-3-detail-select" />
        <column table="a" column="name_status" part-id="44098-3-detail-select" />
        <column table="a" column="status" part-id="44098-3-detail-select" />
        <column table="a" column="fio" part-id="44098-3-detail-select" />
        <column table="a" column="name_direct" part-id="44098-3-detail-select" />
        <column table="a" column="name_viza" part-id="44098-3-detail-select" />
        <column table="a" column="dat_post" part-id="44098-3-detail-select" />
        <column table="a" column="dat_viz" part-id="44098-3-detail-select" />
        <column table="a" column="prim" part-id="44098-3-detail-select" />
        <column table="a" column="spec_text" part-id="44098-3-detail-select" />
        <column table="a" column="tel" part-id="44098-3-detail-select" />
        <column table="a" column="dolgn" part-id="44098-3-detail-select" />
        <column table="a" column="polzov" part-id="44098-3-detail-select" />
        <column table="a" column="dpk" part-id="44098-3-detail-select" />
        <column table="a" column="ym" part-id="44098-3-detail-select" />
        <column table="a" column="dt_lack_req" part-id="44098-3-detail-select" />
        <column table="a" column="dt_lack_req_max" part-id="44098-3-detail-select" />
        <column table="a" column="dt_docs_got" part-id="44098-3-detail-select" />
        <column table="a" column="dt_pz" part-id="44098-3-detail-select" />
        <column table="a" column="dt_cost_put" part-id="44098-3-detail-select" />
        <column table="a" column="dt_project" part-id="44098-3-detail-select" />
        <column table="a" column="dt_mess" part-id="44098-3-detail-select" />
        <column table="a" column="dt_mess_too" part-id="44098-3-detail-select" />
        <column table="a" column="dt_client_proj" part-id="44098-3-detail-select" />
        <column table="a" column="dt_client_sign" part-id="44098-3-detail-select" />
        <column table="a" column="dt_pass_up" part-id="44098-3-detail-select" />
        <column table="a" column="dt_pass_eb" part-id="44098-3-detail-select" />
        <column table="a" column="dt_pass_cc" part-id="44098-3-detail-select" />
        <column table="a" column="dt_pass_od" part-id="44098-3-detail-select" />
        <column table="a" column="dt_rmo" part-id="44098-3-detail-select" />
        <column table="a" column="dt_rmo_max" part-id="44098-3-detail-select" />
        <column table="a" column="mes_req" part-id="44098-3-detail-select" />
        <column table="a" column="day_req" part-id="44098-3-detail-select" />
        <column table="a" column="srok_req" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_req" part-id="44098-3-detail-select" />
        <column table="a" column="mes_tu" part-id="44098-3-detail-select" />
        <column table="a" column="day_tu" part-id="44098-3-detail-select" />
        <column table="a" column="srok_tu" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_tu" part-id="44098-3-detail-select" />
        <column table="a" column="mes_ocen" part-id="44098-3-detail-select" />
        <column table="a" column="day_ocen" part-id="44098-3-detail-select" />
        <column table="a" column="srok_ocen" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_ocen" part-id="44098-3-detail-select" />
        <column table="a" column="mes_proj" part-id="44098-3-detail-select" />
        <column table="a" column="day_proj" part-id="44098-3-detail-select" />
        <column table="a" column="srok_proj" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_proj" part-id="44098-3-detail-select" />
        <column table="a" column="mes_dog" part-id="44098-3-detail-select" />
        <column table="a" column="day_dog" part-id="44098-3-detail-select" />
        <column table="a" column="srok_dog" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_dog" part-id="44098-3-detail-select" />
        <column table="a" column="mes_sign" part-id="44098-3-detail-select" />
        <column table="a" column="day_sign" part-id="44098-3-detail-select" />
        <column table="a" column="srok_sign" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_sign" part-id="44098-3-detail-select" />
        <column table="a" column="day_22_4_sign" part-id="44098-3-detail-select" />
        <column table="a" column="srok_22_4_sign" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_22_4_sign" part-id="44098-3-detail-select" />
        <column table="a" column="mes_mess" part-id="44098-3-detail-select" />
        <column table="a" column="day_mess" part-id="44098-3-detail-select" />
        <column table="a" column="srok_mess" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_mess" part-id="44098-3-detail-select" />
        <column table="a" column="mes_client_proj" part-id="44098-3-detail-select" />
        <column table="a" column="day_client_proj" part-id="44098-3-detail-select" />
        <column table="a" column="mes_all" part-id="44098-3-detail-select" />
        <column table="a" column="day_all" part-id="44098-3-detail-select" />
        <column table="a" column="srok_all" part-id="44098-3-detail-select" />
        <column table="a" column="otkl_all" part-id="44098-3-detail-select" />
        <column table="a" column="dat_lkk" part-id="44098-3-detail-select" />
        <column table="a" column="dt_sogl_dog" part-id="44098-3-detail-select" />
        <column table="a" column="dt_podp_dog" part-id="44098-3-detail-select" />
        <column table="a" column="dt_podp_dog_ep" part-id="44098-3-detail-select" />
        <column table="a" column="fio_podp_dog" part-id="44098-3-detail-select" />
        <column table="a" column="fio_kont" part-id="44098-3-detail-select" />
        <column table="a" column="e_mail_kont" part-id="44098-3-detail-select" />
        <column table="a" column="phone_kont" part-id="44098-3-detail-select" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" part-id="44098-3-detail_from" />
        <query name="44098-ltype2" join="left outer" as="lt" part-id="44098-3-detail_from">
          <call function="and">
            <call function="=">
              <column table="a" column="list_load" />
              <column table="lt" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in" part-id="44098-3-detail-where">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge" part-id="44098-3-detail-where">
            <call function="coalesce">
              <column table="a" column="dt_client_proj" />
              <column table="a" column="dt_mess" />
              <column table="a" column="dt_podp_dog" />
              <column table="a" column="dt_sogl_dog" />
              <column table="a" column="dt_project" />
              <column table="a" column="dt_cost_put" />
              <column table="a" column="dt_pz" />
              <column table="a" column="dt_docs_got" />
              <column table="a" column="dt_request" />
            </call>
            <useparam name="p_dt1" />
          </call>
          <call function="le" part-id="44098-3-detail-where">
            <column table="a" column="dt_request" />
            <useparam name="p_dt2" />
          </call>
          <call function="=">
            <column table="lt" column="id" />
            <useparam name="p_list_type" />
          </call>
        </call>
      </where>
    </query>
    <query name="44098-dt3" timestamp="12.03.2018 10:29:18" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <const as="dt3" type="date">date'2017-01-01'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="44098-4" timestamp="24.05.2018 13:29:58" use-repository="1" order="num_req" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <param name="p_dt3" type="date">
          <const>to_date('19.03.2018','DD.MM.YYYY')</const>
        </param>
        <param name="p_dt4" type="date">
          <const>to_date('26.03.2018','DD.MM.YYYY')</const>
        </param>
        <param name="load_type_id" type="array" />
        <param name="kod_subject" type="array" />
        <param name="p_power_gt" type="number" />
        <param name="p_power_ls" type="number" />
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="a" column="kod_dop_contract" />
        <column table="a" column="kn_request" />
        <column table="a" column="num_ouco" />
        <column table="a" column="dat_ouco" />
        <column table="a" column="dt_contract" />
        <column table="a" column="num_req" />
        <column table="a" column="dt_request" />
        <column table="a" column="kurator_req" />
        <column table="a" column="load_type" />
        <column table="a" column="st_req" />
        <column table="a" column="creat_req_db" />
        <column table="a" column="req_path" />
        <column table="a" column="customer" />
        <column table="a" column="contr_kind" />
        <column table="a" column="contr_sum_f" />
        <column table="a" column="contr_sum_m" />
        <column table="a" column="contr_sum_e" />
        <column table="a" column="kn_zone" />
        <column table="a" column="load" />
        <column table="a" column="load1" />
        <column table="a" column="load2" />
        <column table="a" column="load3" />
        <column table="a" column="load_existed" />
        <column table="a" column="list_load" />
        <column table="a" column="list_eskl" />
        <column table="a" column="tbl_uved" />
        <column table="a" column="tbl_req" />
        <column table="a" column="tbl_tu" />
        <column table="a" column="tbl_ocen" />
        <column table="a" column="tbl_proj" />
        <column table="a" column="tbl_dog" />
        <column table="a" column="tbl_sign" />
        <column table="a" column="tbl_mess" />
        <column table="a" column="kateg_depend" />
        <column table="a" column="fl_build" />
        <column table="a" column="filial" />
        <column table="a" column="kurator" />
        <column table="a" column="name_status" />
        <column table="a" column="status" />
        <column table="a" column="fio" />
        <column table="a" column="name_direct" />
        <column table="a" column="name_viza" />
        <column table="a" column="dat_post" />
        <column table="a" column="dat_viz" />
        <column table="a" column="prim" />
        <column table="a" column="spec_text" />
        <column table="a" column="tel" />
        <column table="a" column="dolgn" />
        <column table="a" column="polzov" />
        <column table="a" column="dpk" />
        <column table="a" column="ym" />
        <column table="a" column="dt_lack_req" />
        <column table="a" column="dt_lack_req_max" />
        <column table="a" column="dt_docs_got" />
        <column table="a" column="dt_pz" />
        <column table="a" column="dt_cost_put" />
        <column table="a" column="dt_project" />
        <column table="a" column="dt_mess" />
        <column table="a" column="dt_mess_too" />
        <column table="a" column="dt_client_proj" />
        <column table="a" column="dt_client_sign" />
        <column table="a" column="dt_pass_up" />
        <column table="a" column="dt_pass_eb" />
        <column table="a" column="dt_pass_cc" />
        <column table="a" column="dt_pass_od" />
        <column table="a" column="dt_rmo" />
        <column table="a" column="dt_rmo_max" />
        <column table="a" column="mes_req" />
        <column table="a" column="day_req" />
        <column table="a" column="srok_req" />
        <column table="a" column="otkl_req" />
        <column table="a" column="mes_tu" />
        <column table="a" column="day_tu" />
        <column table="a" column="srok_tu" />
        <column table="a" column="otkl_tu" />
        <column table="a" column="mes_ocen" />
        <column table="a" column="day_ocen" />
        <column table="a" column="srok_ocen" />
        <column table="a" column="otkl_ocen" />
        <column table="a" column="mes_proj" />
        <column table="a" column="day_proj" />
        <column table="a" column="srok_proj" />
        <column table="a" column="otkl_proj" />
        <column table="a" column="mes_dog" />
        <column table="a" column="day_dog" />
        <column table="a" column="srok_dog" />
        <column table="a" column="otkl_dog" />
        <column table="a" column="mes_sign" />
        <column table="a" column="day_sign" />
        <column table="a" column="srok_sign" />
        <column table="a" column="otkl_sign" />
        <column table="a" column="day_22_4_sign" />
        <column table="a" column="srok_22_4_sign" />
        <column table="a" column="otkl_22_4_sign" />
        <column table="a" column="mes_mess" />
        <column table="a" column="day_mess" />
        <column table="a" column="srok_mess" />
        <column table="a" column="otkl_mess" />
        <column table="a" column="mes_client_proj" />
        <column table="a" column="day_client_proj" />
        <column table="a" column="mes_all" />
        <column table="a" column="day_all" />
        <column table="a" column="srok_all" />
        <column table="a" column="otkl_all" />
        <column table="a" column="dat_lkk" />
        <column table="a" column="dt_sogl_dog" />
        <column table="a" column="dt_podp_dog" />
        <column table="a" column="dt_podp_dog_ep" />
        <column table="a" column="fio_podp_dog" />
        <column table="a" column="fio_kont" />
        <column table="a" column="e_mail_kont" />
        <column table="a" column="phone_kont" />
        <column table="a" column="region" type="string" title="" />
        <call as="kod_subject" function="case" type="number">
          <call function="when">
            <call function="=">
              <column table="a" column="region" />
              <const>'Город'</const>
            </call>
            <const>0</const>
          </call>
          <item />
          <call function="when">
            <call function="=">
              <column table="a" column="region" />
              <const>'Область'</const>
            </call>
            <const>1</const>
          </call>
        </call>
        <column table="a" column="lp_addr" type="string" title="" />
        <column table="a" column="zayav_status" type="string" title="" />
        <column table="a" column="name_obj" type="string" title="" />
        <column table="a" column="dt_atp_ready" type="date" title="" />
        <column table="a" column="dt_atp_signed" type="date" title="" />
        <column table="a" column="dt_atp_sogl" type="date" title="" />
        <column table="a" column="dt_atp_signed_le" type="date" title="" />
        <column table="a" column="dt_atp_signed_to_eskl" type="date" title="" />
        <column table="a" column="dt_reg" type="date" title="" />
        <column table="a" column="dt_delivery" type="date" title="" />
        <column table="a" column="atp_num" type="number" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="ge" optional="1">
            <column table="a" column="dt_request" />
            <useparam name="p_dt3" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="dt_request" />
            <useparam name="p_dt4" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="load_type_kod" />
            <useparam name="load_type_id" />
          </call>
          <call function="in" optional="1">
            <column table="this" column="kod_subject" />
            <useparam name="kod_subject" />
          </call>
          <call function="ge" optional="1">
            <column table="a" column="load" />
            <useparam name="p_power_gt" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="load" />
            <useparam name="p_power_ls" />
          </call>
        </call>
      </where>
    </query>
    <query name="47106-dt1" timestamp="26.04.2018 17:28:23" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <call table="a" column="ym2" function="trunc" type="date" as="dt1">
          <call function="sysdate" />
          <const>'MM'</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="44098-direct-det-ltype" timestamp="01.05.2018 12:11:25" use-repository="1" order="kod_predpr, id_podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="kod_predpr" />
        <column table="a" column="name_kr" />
        <column table="a" column="id_podr" as="id_podr" />
        <column table="a" column="name_podr" as="name_podr" />
        <column table="lt" column="load" />
        <column table="lt" column="id" as="lt_id" />
      </select>
      <from>
        <query name="44098-direct-det" as="a" />
        <query name="44098-ltype2" as="lt" join="cross" />
      </from>
    </query>
    <query name="44098-3-1-pre" timestamp="01.05.2018 12:19:46" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_docs_got" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_docs_got" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <column table="a" column="day_req" />
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-1" timestamp="24.09.2018 14:58:04" use-repository="1" order="kod_predpr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="filial" exclude="1" />
        <column table="dr" column="kod_predpr" />
        <column table="dr" column="name_kr" as="filial" />
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="sum" as="sum_0_2" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_req" />
            <const>0</const>
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_3_4" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_req" />
            <const>3</const>
            <const>4</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_5_6" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_req" />
            <const>5</const>
            <const>6</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_6" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_req" />
            <const>6</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_2" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_req" />
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_2" nvl="0">
          <column table="this" column="sum_more_2" />
          <column table="this" column="sum_all" />
        </call>
      </select>
      <from>
        <query name="44098-3-1-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-direct-ltype" timestamp="01.05.2018 12:13:09" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <select>
        <column table="a" column="kod_direct" />
        <column table="a" column="kod_predpr" />
        <column table="a" column="name_kr" />
        <column table="lt" column="load" />
        <column table="lt" column="id" as="lt_id" />
      </select>
      <from>
        <query as="a" name="44098-direct" />
        <query name="44098-ltype2" as="lt" join="cross" />
      </from>
    </query>
    <query name="44098-3-2-pre" timestamp="01.05.2018 12:57:21" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_pz" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_pz" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <column table="a" column="day_tu" />
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-2" timestamp="01.05.2018 13:04:56" use-repository="1" order="kod_predpr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="filial" exclude="1" />
        <column table="dr" column="kod_predpr" />
        <call function="if" type="string" as="filial">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <column table="dr" column="name_kr" />
          <call function="||">
            <const>'ОПТУ + '</const>
            <column table="dr" column="name_kr" />
          </call>
        </call>
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="sum" as="sum_0_4" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_tu" />
            <const>0</const>
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>4</const>
              <const>8</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_5_10" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_tu" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>5</const>
              <const>9</const>
            </call>
            <const>10</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_11_15" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_tu" />
            <const>11</const>
            <const>15</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_16_20" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_tu" />
            <const>16</const>
            <const>20</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_20" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_tu" />
            <const>20</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_4" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_tu" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>4</const>
              <const>8</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_4" nvl="0">
          <column table="this" column="sum_more_4" />
          <column table="this" column="sum_all" />
        </call>
        <call function="if" type="string" as="col_name1" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'0-4 к.д'</const>
          <const>'0-8 к.д'</const>
        </call>
        <call function="if" type="string" as="col_name2" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'5-10 к.д'</const>
          <const>'9-10 к.д'</const>
        </call>
        <call function="if" type="number" as="num_days" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>4</const>
          <const>8</const>
        </call>
      </select>
      <from>
        <query name="44098-3-2-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-3-3-pre" timestamp="01.05.2018 13:09:01" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_cost_put" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_cost_put" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <column table="a" column="day_ocen" />
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-3" timestamp="01.05.2018 13:18:15" use-repository="1" order="kod_predpr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="filial" exclude="1" />
        <column table="dr" column="kod_predpr" />
        <call function="if" type="string" as="filial">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <column table="dr" column="name_kr" />
          <call function="||">
            <const>'ДЭТП по '</const>
            <column table="dr" column="name_kr" />
          </call>
        </call>
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="sum" as="sum_0_2" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_ocen" />
            <const>0</const>
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_3_4" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_ocen" />
            <const>3</const>
            <const>4</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_3_5" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_ocen" />
            <const>3</const>
            <const>5</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_5_6" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_ocen" />
            <const>5</const>
            <const>6</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_7_8" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_ocen" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>7</const>
              <const>6</const>
            </call>
            <const>8</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_8" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_ocen" />
            <const>8</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_2" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_ocen" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>2</const>
              <const>5</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_2" nvl="0">
          <column table="this" column="sum_more_2" />
          <column table="this" column="sum_all" />
        </call>
        <call function="if" type="string" as="col_name" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'7-8 к.д'</const>
          <const>'6-8 к.д'</const>
        </call>
        <call function="if" type="number" as="num_days" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>2</const>
          <const>5</const>
        </call>
      </select>
      <from>
        <query name="44098-3-3-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-3-4-pre" timestamp="01.05.2018 13:25:39" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_project" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_project" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <column table="a" column="day_proj" />
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-4" timestamp="01.05.2018 13:29:04" use-repository="1" order="kod_predpr, id_podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="dr" column="kod_predpr" />
        <column table="dr" column="name_kr" as="filial" />
        <call function="over" as="sum_filial" type="number">
          <call function="count">
            <column table="a" column="kod_dop_contract" />
          </call>
          <call function="partition by">
            <column table="dr" column="name_kr" />
          </call>
        </call>
        <column table="dr" column="id_podr" />
        <column table="dr" column="name_podr" as="podr_for_vks" />
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="sum" as="sum_0_2" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_proj" />
            <const>0</const>
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_3_5" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_proj" />
            <const>3</const>
            <const>5</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_3_4" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_proj" />
            <const>3</const>
            <const>4</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_5_6" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_proj" />
            <const>5</const>
            <const>6</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_7_8" type="number" nvl="0">
          <call function="between">
            <column table="a" column="day_proj" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>7</const>
              <const>6</const>
            </call>
            <const>8</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_8" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_proj" />
            <const>8</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_2" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_proj" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>2</const>
              <const>5</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_2" nvl="0">
          <column table="this" column="sum_more_2" />
          <column table="this" column="sum_all" />
        </call>
        <call function="if" type="string" as="col_name" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'7-8 к.д'</const>
          <const>'6-8 к.д'</const>
        </call>
        <call function="if" type="number" as="num_days" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>2</const>
          <const>5</const>
        </call>
      </select>
      <from>
        <query name="44098-3-4-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-det-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="podr_for_vks" />
              <column table="dr" column="name_podr" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
              <column table="this" column="id_podr" />
              <column table="this" column="podr_for_vks" />
              <column table="this" column="sum_filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-3-5-pre" timestamp="01.05.2018 13:35:23" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_podp_dog" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_podp_dog" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <call function="if">
              <call function="is null">
                <call function="nvl">
                  <column table="a" column="day_dog" />
                  <column table="a" column="day_sign" />
                </call>
              </call>
              <const>null</const>
              <call function="+nvl">
                <column table="a" column="day_dog" />
                <column table="a" column="day_sign" />
              </call>
            </call>
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-5" timestamp="03.05.2018 11:48:45" use-repository="1" order="kod_predpr, id_podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="dr" column="kod_predpr" />
        <column table="dr" column="name_kr" as="filial" />
        <call function="over" as="sum_filial" type="number">
          <call function="count">
            <column table="a" column="kod_dop_contract" />
          </call>
          <call function="partition by">
            <column table="dr" column="name_kr" />
          </call>
        </call>
        <column table="dr" column="id_podr" />
        <column table="dr" column="name_podr" as="podr_for_vks" />
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="sum" as="sum_0_2" type="number" nvl="0">
          <call function="between">
            <call function="if">
              <call function="is null">
                <call function="nvl">
                  <column table="a" column="day_dog" />
                  <column table="a" column="day_sign" />
                </call>
              </call>
              <const>null</const>
              <call function="+nvl">
                <column table="a" column="day_dog" />
                <column table="a" column="day_sign" />
              </call>
            </call>
            <const>0</const>
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>2</const>
              <const>3</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" group="sum" as="sum_more_2" type="number" nvl="0">
          <call function="gt">
            <call function="if">
              <call function="is null">
                <call function="nvl">
                  <column table="a" column="day_dog" />
                  <column table="a" column="day_sign" />
                </call>
              </call>
              <const>null</const>
              <call function="+nvl">
                <column table="a" column="day_dog" />
                <column table="a" column="day_sign" />
              </call>
            </call>
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>2</const>
              <const>3</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_2" nvl="0">
          <column table="this" column="sum_more_2" />
          <column table="this" column="sum_all" />
        </call>
        <call function="if" type="string" as="col_name1" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'0-2 к.д'</const>
          <const>'0-3 к.д'</const>
        </call>
        <call function="if" type="string" as="col_name2" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>'более 2 к.д.'</const>
          <const>'более 3 к.д.'</const>
        </call>
        <call function="if" type="number" as="num_days" group="max">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>2</const>
          <const>3</const>
        </call>
      </select>
      <from>
        <query name="44098-3-5-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-det-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="podr_podp_for_vks" />
              <column table="dr" column="name_podr" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
              <column table="this" column="id_podr" />
              <column table="this" column="podr_for_vks" />
              <column table="this" column="sum_filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-3-6-pre" timestamp="01.05.2018 13:37:01" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="isv_viza_abon" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="load_type_kod" />
            <array>1,2,33,36,9,17</array>
          </call>
          <call function="ge">
            <column table="a" column="dt_mess" />
            <useparam name="p_dt1" />
          </call>
          <call function="le">
            <column table="a" column="dt_mess" />
            <useparam name="p_dt2" />
          </call>
          <call function="ge">
            <column table="a" column="day_all" />
            <const name="p_dt2">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44098-3-6" timestamp="01.05.2018 13:39:52" use-repository="1" order="kod_predpr" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <select>
        <column table="dr" column="kod_predpr" />
        <column table="dr" column="name_kr" as="filial" />
        <column table="a" column="kod_dop_contract" group="count" as="sum_all" />
        <call function="if" group="max" type="number" as="num_days">
          <call function="=">
            <useparam table="a" column="list_load" name="p_list_type" />
            <const>1</const>
          </call>
          <const>15</const>
          <const>20</const>
        </call>
        <call function="if" as="sum_less_15" group="sum" type="number" nvl="0">
          <call function="le">
            <column table="a" column="day_all" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>15</const>
              <const>20</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="sum_more_15" group="sum" type="number" nvl="0">
          <call function="gt">
            <column table="a" column="day_all" />
            <call function="if" type="number">
              <call function="=">
                <useparam table="a" column="list_load" name="p_list_type" />
                <const>1</const>
              </call>
              <const>15</const>
              <const>20</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="/" as="percent_more_15" nvl="0">
          <column table="this" column="sum_more_15" />
          <column table="this" column="sum_all" />
        </call>
      </select>
      <from>
        <query name="44098-3-6-pre" as="a">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-direct-ltype" join="right outer" as="dr">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="dr" column="kod_direct" />
            </call>
            <call function="=">
              <column table="a" column="list_load" />
              <column table="dr" column="load" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="dr" column="lt_id" />
          <useparam name="p_list_type" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="itog" title="Итог">
          <grset as="det" title="По филиалам">
            <group>
              <column table="this" column="kod_predpr" />
              <column table="this" column="filial" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44098-3-49576-detail" timestamp="02.10.2018 14:26:54" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-3-49576-params" />
      </params>
      <select>
        <usepart part="44098-3-detail-select" />
      </select>
      <from>
        <usepart part="44098-3-detail_from" />
      </from>
      <where>
        <call function="and">
          <usepart part="44098-3-detail-where" />
          <call function="in" optional="1" exclude="1">
            <column table="lt" column="id" />
            <useparam name="p_list_type" />
          </call>
        </call>
      </where>
    </query>
    <query name="44164-test" timestamp="26.10.2017 02:05:47" use-repository="1" title="Отчёт по использованию денежных средств (авансов) от заявителей" is-report="1" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <params>
        <usepart part="44164-params" />
      </params>
      <change-sources>
        <change-source name="ipr_titul_dop_contract" call="44164_ipr_tit_dc" />
      </change-sources>
      <expressions>
        <call as="on_dat" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat" />
        </call>
        <call as="sch_uch" function="in" dontpushpred="1">
          <column table="ipr_kod_schet" column="kod" />
          <array>3,4,5</array>
        </call>
        <call as="sch_neuch" function="in" dontpushpred="1">
          <column table="ipr_kod_schet" column="kod" />
          <array>1</array>
        </call>
        <call as="pir" function="and" dontpushpred="1">
          <call function="in">
            <column table="ipr_kod_smet" column="kod_smet" />
            <array>1</array>
          </call>
          <call function="not like">
            <column table="ipr_kod_zatrat" column="abbr" />
            <const>'9.%'</const>
          </call>
        </call>
        <call as="smr" function="and" dontpushpred="1">
          <call function="in">
            <column table="ipr_kod_smet" column="kod_smet" />
            <array>2</array>
          </call>
          <call function="not like">
            <column table="ipr_kod_zatrat" column="abbr" />
            <const>'9.%'</const>
          </call>
        </call>
        <call function="like" as="hoz" dontpushpred="1">
          <column table="ipr_kod_zatrat" column="abbr" />
          <const>'9.%'</const>
        </call>
        <call function="like" as="proch" dontpushpred="1">
          <column table="ipr_kod_zatrat" column="abbr" />
          <const>'7.%'</const>
        </call>
        <call as="is_avans" function="=1" dontpushpred="1">
          <column table="ipr_kod_opl_per" column="is_avans" />
        </call>
        <call as="dlg_on_dat" function="le" dontpushpred="1">
          <column table="kido_dat_dolg" column="val" />
          <useparam name="dat" />
        </call>
        <call function="()" group="sum" as="opl_kido">
          <fact column="is_opl_period_sum" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="avans">
          <fact column="opl_kido" condition="is_avans" />
        </call>
        <call function="()" as="kap" group="sum">
          <fact column="ipr_kap_fact_sum" condition="on_dat" />
        </call>
        <call function="()" as="kap_uch" group="sum">
          <fact column="kap" condition="sch_uch" />
        </call>
        <call function="()" as="kap_neuch" group="sum">
          <fact column="kap" condition="sch_neuch" />
        </call>
        <call function="()" as="pir_kap_uch" group="sum">
          <fact column="kap_uch" condition="pir" />
        </call>
        <call function="()" as="smr_kap_uch" group="sum">
          <fact column="kap_uch" condition="smr" />
        </call>
        <call function="()" as="prch_kap_uch" group="sum">
          <fact column="kap_uch" condition="proch" />
        </call>
        <call function="()" as="hoz_kap_uch" group="sum">
          <fact column="kap_uch" condition="hoz" />
        </call>
        <call function="()" as="sld" group="sum">
          <fact column="ipr_sld_fact_sum" condition="on_dat" />
        </call>
        <call function="if" as="kz" group="sum">
          <call function="gt">
            <call function="over">
              <call function="sum">
                <fact column="sld" />
              </call>
              <call function="partition by">
                <column table="ipr_kod_dog" column="kod_dog" />
                <column table="ipr_kod_titul_ip_teh_pr" column="kod_titul_ip" />
              </call>
            </call>
            <const>0</const>
          </call>
          <fact column="sld" />
        </call>
        <call function="=1" as="pr_part_akt">
          <column table="kod_atp_dop_info" column="pr_part_akt" />
        </call>
        <call function="()" group="sum" as="tp_sum_akt">
          <fact column="kido_c_akt_sum_bn" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="tp_kred_akt">
          <fact column="kido_ob_tp_akt_kred_bn" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="tp_sum_akt_part">
          <fact column="tp_sum_akt" condition="pr_part_akt" />
        </call>
        <call function="-nvl" as="tp_ostatok" group="sum" exclude="1">
          <fact column="is_dop_cont_contr_sum" />
          <fact column="tp_sum_akt" />
        </call>
        <call function="()" group="sum" as="tp_dlg_pros">
          <fact column="kido_ob_for_pros_dlg_bn" condition="dlg_on_dat" />
        </call>
        <call function="()" group="sum" as="tp_dlg_pros_s_nds">
          <fact column="kido_ob_for_pros_dlg" condition="dlg_on_dat" />
        </call>
      </expressions>
      <select>
        <call function="row_num" as="npp" group="max" title=" " exclude="1">
          <column table="this" column="podr_name" />
          <column table="this" column="tit_name" />
        </call>
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" exclude="1" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <call function="over" as="tit_in_dog" group="outer" type="number" exclude="1">
          <call function="count">
            <column table="this" column="kod_titul_ip" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" as="first_tit_in_dog" group="outer" type="number" exclude="1">
          <call function="max">
            <column table="this" column="kod_titul_ip" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <call function="if" group="outer" type="number" as="un_dog" exclude="1">
          <call function="=">
            <column table="this" column="first_tit_in_dog" />
            <column table="this" column="kod_titul_ip" />
          </call>
          <const>1</const>
        </call>
        <column table="kod_ispolnit" column="name" as="podr_name_tit" title="Наименование филиала (из титула)" group="max" comment="1" exclude="1" />
        <column table="kod_filial" column="name" as="podr_name_dog" title="Наименование филиала (и договора ТП)" group="max" comment="1" exclude="1" />
        <call function="nvl" as="podr" exclude="1">
          <column table="kod_ispolnit" column="kod_direct" title="Наименование филиала (из титула)" comment="1" />
          <column table="kod_filial" column="kod_direct" title="Наименование филиала (и договора ТП)" comment="1" />
        </call>
        <call function="nvl" title="Наименование филиала" as="podr_name" group="max" exclude="1">
          <column table="this" column="podr_name_tit" group="no" />
          <column table="this" column="podr_name_dog" group="no" />
        </call>
        <call function="nvl" as="mgr_id" group="max" exclude="1">
          <column table="this" column="kod_titul_ip" group="no" />
          <column table="this" column="kod_dop_contract" group="no" />
        </call>
        <column table="kn_customer" column="name" as="cust_name" title="Наименование заявителя" group="max" comment="1" exclude="1" />
        <column table="kod_dop_contract" column="num_ad_pref_nvl" as="num_ad" title="Реквизиты договора ТП" group="max" comment="1" exclude="1" />
        <call function="if" as="name_region" title="Льготная категория по 550 руб" qlikview="1" type="string" group="max" comment="?" exclude="1">
          <call function="=">
            <column table="kod_dop_contract" column="fl_discount" />
            <const>1</const>
          </call>
          <const>'Да'</const>
        </call>
        <call function="/" as="is_dop_cont_contr_sum" group="sum" mp="-6" exclude="1">
          <call function="+nvl">
            <column table="ad_all" column="contr_sum_m" title="Срок исполнения обязательств по ТП по договору" />
            <column table="ad_all" column="contr_sum_e" title="Срок исполнения обязательств по ТП по договору" />
          </call>
          <call function="+nvl">
            <const>1</const>
            <call function="/">
              <call function="nvl">
                <column table="kod_dop_contract" column="proc" />
                <const>18</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="tp_sum_akt_part" table="dc" title="Заактировано выручки" group="sum" comment="1" mp="-6" exclude="1" />
        <call function="-nvl" as="tp_ostatok" group="sum" mp="-6" title="Отстаток" exclude="1">
          <column table="this" column="is_dop_cont_contr_sum" />
          <fact column="tp_sum_akt" table="dc" />
        </call>
        <column table="ad_all" column="srok_uslug" title="Срок исполнения обязательств по ТП по договору" group="max" exclude="1" />
        <call function="if" as="tp_dlg_pros" type="number" mp="-6" group="sum" title=" " exclude="1">
          <call function="=1">
            <fact column="is_reestr_44164_pr" table="dc" />
          </call>
          <fact column="is_reestr_44164_dolg_pr" table="dc" />
          <fact column="tp_dlg_pros" table="dc" comment="1" title=" " />
        </call>
        <call function="if" title="Признак просроченных обязательств по договору" as="pr_pros" type="string" group="max" exclude="1">
          <call function="gt">
            <column table="this" column="tp_dlg_pros" />
            <const>0</const>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <call function="if" as="pr_vina" type="string" group="max" title="Признак просрочнного договора по вине заявителя" exclude="1">
          <call function="and">
            <call function="lt">
              <column table="this" column="srok_uslug" />
              <useparam name="dat" />
            </call>
            <call function="or">
              <call function="in">
                <column table="ad_all" column="status" />
                <array>5,30</array>
              </call>
              <call function="and">
                <call function="in">
                  <column table="ad_all" column="status" />
                  <array>1</array>
                </call>
                <call function="or">
                  <call function="=1">
                    <column table="ad_all" column="read_to_close" />
                  </call>
                  <call function="=">
                    <column table="ad_all" column="vid_opl_ad" />
                    <const>'ОДИ'</const>
                  </call>
                  <call function="!=nvl">
                    <column table="ad_all" column="fl_build" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="=">
                      <column table="ad_all" column="contr_sum_m" />
                      <const>550</const>
                    </call>
                    <call function="gt">
                      <column table="this" column="tp_dlg_pros" />
                      <const>0</const>
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <fact column="is_reestr_44164_saldo" table="dc" exclude="1" />
        <fact column="is_reestr_44164_pr" table="dc" exclude="1" />
        <call function="if" as="tp_kred_akt" type="number" mp="-6" group="sum" exclude="1">
          <call function="=1">
            <fact column="is_reestr_44164_pr" table="dc" />
          </call>
          <fact column="is_reestr_44164_saldo" table="dc" />
          <fact column="tp_kred_akt" table="dc" comment="1" mp="-6" title=" Кредиторская задолженность по суммам перечисленных в рамках договоров ТП авансов " />
        </call>
        <call function="if" title="Наличие мероприятий в договоре ТП, требующих от ДЗО капвложений" type="string" group="max" as="pr_build" exclude="1">
          <call function="=1">
            <column table="ad_all" column="fl_build" />
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <column table="ipr_kod_titul_ip" column="num_name" as="tit_name" title="Наименование титула в инвестпрограмме" comment="1" />
        <fact table="dc" column="is_dop_cont_count" />
        <fact column="cube_ipr_tit_smet" as="smet" title="Стоимость титула в инвестпрограмме" group="sum" comment="1" mp="-6" table="tit" exclude="1" />
        <fact column="is_dogovor_dog_info" table="pir_n" as="pir_dog_info" title="Реквизиты договора на ПИР" group="max" comment="1" exclude="1" />
        <fact column="cube_ipr_dog_cost" table="pir" as="pir_dog_cost" title="Стоимость договора на ПИР" group="sum" comment="1" mp="-6" exclude="1" />
        <fact column="is_dogovor_dat_end" table="pir_n" as="pir_dog_end" title="Срок исполнения услуг по договору ПИР" group="max" comment="1" exclude="1" />
        <fact column="pir_kap_uch" title="Стоимость принятых актов выполненных работ по ПИР " group="sum" comment="1" mp="-6" table="tit" exclude="1" />
        <fact column="is_dogovor_dog_info" table="smr_n" as="smr_dog_info" title="Реквизиты договора на СМР" group="max" comment="1" exclude="1" />
        <fact column="cube_ipr_dog_cost" table="smr" as="smr_dog_cost" title="Стоимость договора на СМР" group="sum" comment="1" mp="-6" exclude="1" />
        <fact column="is_dogovor_dat_end" table="smr_n" as="smr_dog_end" title="Срок исполнения услуг по договору СМР" group="max" comment="1" exclude="1" />
        <fact column="smr_kap_uch" title="Стоимость принятых актов выполненных работ по СМР " group="sum" comment="1" mp="-6" type="number" table="tit" exclude="1" />
        <fact column="kap_neuch" title="Стоимость закупленного, но не переданного в монтаж оборудования " group="sum" comment="1" mp="-6" type="number" table="tit" exclude="1" />
        <fact column="prch_kap_uch" title="Прочие затраты" group="sum" comment="1" mp="-6" type="number" table="tit" exclude="1" />
        <fact column="hoz_kap_uch" title="Произведенные затраты по работам, осуществленным хозспособом" group="sum" comment="1" mp="-6" type="number" table="tit" exclude="1" />
        <call function="+nvl" as="kap" title="Итого капвложений" group="sum" comment="1" mp="-6" exclude="1">
          <column table="this" column="pir_kap_uch" group="no" />
          <column table="this" column="smr_kap_uch" group="no" />
          <column table="this" column="kap_neuch" group="no" />
          <column table="this" column="prch_kap_uch" group="no" />
          <column table="this" column="hoz_kap_uch" group="no" />
        </call>
        <fact column="kz" title="Кредиторская задолженность поставщикам и подрядчикам по титулу" group="sum" comment="1" mp="-6" table="tit" exclude="1" />
        <call function="+nvl" as="opl" title="Итого капвложения оплаченные" group="sum" comment="1" mp="-6" exclude="1">
          <column table="this" column="kap" group="no" />
          <column table="this" column="kz" group="no" />
        </call>
        <fact column="avans" title="Авансы, выплаченные поставщикам и подрядчикам" group="sum" comment="1" mp="-6" table="tit" exclude="1" />
        <call as="isp_sr" function="if" type="number" title="Итого использовано средств на цели ТП" group="sum" mp="-6" exclude="1">
          <call function="=1">
            <column table="ad_all_tit" column="fl_build" group="no" />
          </call>
          <call function="+nvl">
            <column table="this" column="opl" group="no" />
            <column table="this" column="avans" group="no" />
          </call>
          <column table="this" column="tp_kred_akt" group="no" />
        </call>
        <call as="razn" function="-nvl" type="number" title="Разница между полученными авансами по договору ТП и оплаченными затратами" group="sum" mp="-6" exclude="1">
          <column table="this" column="tp_kred_akt" group="no" />
          <column table="this" column="isp_sr" group="no" />
        </call>
        <call function="over" as="razn_tit" type="number" group="sum" exclude="1">
          <call function="sum">
            <column table="this" column="razn" group="no" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_titul_ip" />
          </call>
        </call>
        <call as="nepok" function="if" type="number" title="Итого использовано средств на цели ТП" group="sum" mp="-6" exclude="1">
          <call function="gt">
            <column table="this" column="razn_tit" group="no" />
            <const>0</const>
          </call>
          <column table="this" column="razn" group="no" />
          <const>0</const>
        </call>
      </select>
      <from>
        <qube merge-dimsets="1">
          <link name="ipr_kod_titul_ip" as="ipr_kod_titul_ip">
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_reestr_44164" />
          <link name="kod_dop_contract" only-for-cond="1">
            <link name="kod_filial" />
            <link name="kn_customer" />
          </link>
          <where>
            <call function="=">
              <column table="kod_dop_contract" column="kod_dop_contract" />
              <const>3166820</const>
            </call>
            <call function="=" dont-push="1" exclude="1">
              <column table="kod_reestr_44164" column="dat" />
              <useparam name="dat" />
            </call>
            <call function="!=" dont-push="1" exclude="1">
              <column table="kod_reestr_44164" column="pr550" />
              <const>1</const>
            </call>
          </where>
          <dimset as="pir_n">
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_vid_zt_tit" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>1</const>
              </call>
              <call function="!=0" dont-push="1">
                <column table="ipr_kod_vid_zt_tit" column="plan_cost" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="pir">
            <link name="ipr_kod_smet" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>1</const>
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="smr_n">
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_vid_zt_tit" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>2</const>
              </call>
              <call function="!=0" dont-push="1">
                <column table="ipr_kod_vid_zt_tit" column="plan_cost" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="smr">
            <link name="ipr_kod_smet" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>2</const>
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="dc">
            <link name="kod_dop_contract" all-rows="1">
              <link name="kn_customer" />
            </link>
          </dimset>
          <dimset as="tit">
            <where>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
        </qube>
        <query name="41164_isv_s_of_ad_all" as="ad_all" join="left outer" exclude="1">
          <call function="=">
            <column table="this" column="kod_dop_contract" />
            <column table="ad_all" column="kod_dop_contract" />
          </call>
        </query>
        <query name="41164_isv_s_of_ad_all_tit" as="ad_all_tit" join="left outer" exclude="1">
          <call function="=">
            <column table="this" column="kod_titul_ip" />
            <column table="ad_all_tit" column="kod_titul_ip" />
          </call>
        </query>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Всего" exclude="1">
          <grset as="dep" title="По филиалам">
            <group>
              <sourcelink table="kod_ispolnit" exclude="1" />
              <column table="this" column="podr" />
            </group>
            <grset as="tit" title="По титулам" order="tit_name">
              <group>
                <sourcelink table="ipr_kod_titul_ip" />
              </group>
              <grset as="dog" title="По договорам">
                <where exclude="1">
                  <call function="is not null">
                    <column table="this" column="kod_dop_contract" />
                  </call>
                </where>
                <group>
                  <sourcelink table="kod_dop_contract" />
                </group>
              </grset>
            </grset>
          </grset>
          <grset as="all_prosr" title="Всего - просроченные">
            <where>
              <call function="lt">
                <column table="this" column="srok_uslug" />
                <useparam name="dat" />
              </call>
            </where>
          </grset>
          <grset as="all_2017" title="Всего - СОУ 2017">
            <where>
              <call function="=">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2017</const>
              </call>
            </where>
          </grset>
          <grset as="all_2018" title="Всего - СОУ 2018">
            <where>
              <call function="=">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2018</const>
              </call>
            </where>
          </grset>
          <grset as="all_2019" title="Всего - СОУ 2019+">
            <where>
              <call function="ge">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2019</const>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44164" timestamp="26.10.2017 01:40:31" use-repository="1" title="Отчёт по использованию денежных средств (авансов) от заявителей" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <params>
        <usepart part="44164-params" />
      </params>
      <expressions>
        <call as="on_dat" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat" />
        </call>
        <call as="sch_uch" function="in" dontpushpred="1">
          <column table="ipr_kod_schet" column="kod" />
          <array>3,4,5</array>
        </call>
        <call as="sch_neuch" function="in" dontpushpred="1">
          <column table="ipr_kod_schet" column="kod" />
          <array>1</array>
        </call>
        <call as="pir" function="and" dontpushpred="1">
          <call function="in">
            <column table="ipr_kod_smet" column="kod_smet" />
            <array>1</array>
          </call>
          <call function="not like">
            <column table="ipr_kod_zatrat" column="abbr" />
            <const>'9.%'</const>
          </call>
        </call>
        <call as="smr" function="and" dontpushpred="1">
          <call function="in">
            <column table="ipr_kod_smet" column="kod_smet" />
            <array>2</array>
          </call>
          <call function="not like">
            <column table="ipr_kod_zatrat" column="abbr" />
            <const>'9.%'</const>
          </call>
        </call>
        <call function="like" as="hoz" dontpushpred="1">
          <column table="ipr_kod_zatrat" column="abbr" />
          <const>'9.%'</const>
        </call>
        <call function="like" as="proch" dontpushpred="1">
          <column table="ipr_kod_zatrat" column="abbr" />
          <const>'7.%'</const>
        </call>
        <call as="is_avans" function="=1" dontpushpred="1">
          <column table="ipr_kod_opl_per" column="is_avans" />
        </call>
        <call as="dlg_on_dat" function="le" dontpushpred="1">
          <column table="kido_dat_dolg" column="val" />
          <useparam name="dat" />
        </call>
        <call function="()" group="sum" as="opl_kido">
          <fact column="is_opl_period_sum" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="avans">
          <fact column="opl_kido" condition="is_avans" />
        </call>
        <call function="()" as="kap" group="sum">
          <fact column="ipr_kap_fact_sum" condition="on_dat" />
        </call>
        <call function="()" as="kap_uch" group="sum">
          <fact column="kap" condition="sch_uch" />
        </call>
        <call function="()" as="kap_neuch" group="sum">
          <fact column="kap" condition="sch_neuch" />
        </call>
        <call function="()" as="pir_kap_uch" group="sum">
          <fact column="kap_uch" condition="pir" />
        </call>
        <call function="()" as="smr_kap_uch" group="sum">
          <fact column="kap_uch" condition="smr" />
        </call>
        <call function="()" as="prch_kap_uch" group="sum">
          <fact column="kap_uch" condition="proch" />
        </call>
        <call function="()" as="hoz_kap_uch" group="sum">
          <fact column="kap_uch" condition="hoz" />
        </call>
        <call function="()" as="sld" group="sum">
          <fact column="ipr_sld_fact_sum" condition="on_dat" />
        </call>
        <call function="if" as="kz" group="sum">
          <call function="gt">
            <call function="over">
              <call function="sum">
                <fact column="sld" />
              </call>
              <call function="partition by">
                <column table="ipr_kod_dog" column="kod_dog" />
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </call>
            <const>0</const>
          </call>
          <fact column="sld" />
        </call>
        <call function="=1" as="pr_part_akt">
          <column table="kod_atp_dop_info" column="pr_part_akt" />
        </call>
        <call function="()" group="sum" as="tp_sum_akt">
          <fact column="kido_c_akt_sum_bn" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="tp_kred_akt">
          <fact column="kido_ob_tp_akt_kred_bn" condition="on_dat" />
        </call>
        <call function="()" group="sum" as="tp_sum_akt_part">
          <fact column="tp_sum_akt" condition="pr_part_akt" />
        </call>
        <call function="-nvl" as="tp_ostatok" group="sum" exclude="1">
          <fact column="is_dop_cont_contr_sum" />
          <fact column="tp_sum_akt" />
        </call>
        <call function="()" group="sum" as="tp_dlg_pros">
          <fact column="kido_ob_for_pros_dlg_bn" condition="dlg_on_dat" />
        </call>
        <call function="()" group="sum" as="tp_dlg_pros_s_nds">
          <fact column="kido_ob_for_pros_dlg" condition="dlg_on_dat" />
        </call>
      </expressions>
      <change-sources>
        <change-source name="ipr_titul_dop_contract" call="44164_ipr_tit_dc" />
      </change-sources>
      <select>
        <call function="row_num" as="npp" group="max" title=" " key="1">
          <column table="this" column="podr_name" />
          <column table="this" column="tit_name" />
        </call>
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <call function="over" as="tit_in_dog" group="outer" type="number">
          <call function="count">
            <column table="this" column="kod_titul_ip" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" as="first_tit_in_dog" group="outer" type="number">
          <call function="max">
            <column table="this" column="kod_titul_ip" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <call function="if" group="outer" type="number" as="un_dog">
          <call function="=nvl">
            <column table="this" column="first_tit_in_dog" />
            <column table="this" column="kod_titul_ip" />
          </call>
          <const>1</const>
        </call>
        <column table="kod_ispolnit" column="name" as="podr_name_tit" title="Наименование филиала (из титула)" group="max" comment="1" />
        <column table="kod_filial" column="name" as="podr_name_dog" title="Наименование филиала (и договора ТП)" group="max" comment="1" />
        <call function="nvl" as="podr">
          <column table="kod_ispolnit" column="kod_direct" title="Наименование филиала (из титула)" comment="1" />
          <column table="kod_filial" column="kod_direct" title="Наименование филиала (и договора ТП)" comment="1" />
        </call>
        <call function="nvl" title="Наименование филиала" as="podr_name" group="max">
          <column table="this" column="podr_name_tit" group="no" />
          <column table="this" column="podr_name_dog" group="no" />
        </call>
        <call function="nvl" as="mgr_id" group="max">
          <column table="this" column="kod_titul_ip" group="no" />
          <column table="this" column="kod_dop_contract" group="no" />
        </call>
        <column table="kn_customer" column="name" as="cust_name" title="Наименование заявителя" group="max" comment="1" />
        <column table="kod_dop_contract" column="num_ad_pref_nvl" as="num_ad" title="Реквизиты договора ТП" group="max" comment="1" />
        <call function="if" as="name_region" title="Льготная категория по 550 руб" qlikview="1" type="string" group="max" comment="?">
          <call function="=">
            <column table="kod_dop_contract" column="fl_discount" />
            <const>1</const>
          </call>
          <const>'Да'</const>
        </call>
        <call function="/" as="is_dop_cont_contr_sum" group="sum" mp="-6">
          <call function="+nvl">
            <column table="ad_all" column="contr_sum_m" title="Срок исполнения обязательств по ТП по договору" />
            <column table="ad_all" column="contr_sum_e" title="Срок исполнения обязательств по ТП по договору" />
          </call>
          <call function="+nvl">
            <const>1</const>
            <call function="/">
              <call function="nvl">
                <column table="kod_dop_contract" column="proc" />
                <const>18</const>
              </call>
              <const>100</const>
            </call>
          </call>
        </call>
        <fact column="tp_sum_akt_part" table="dc" title="Заактировано выручки" group="sum" comment="1" mp="-6" />
        <call function="-nvl" as="tp_ostatok" group="sum" mp="-6" title="Отстаток">
          <column table="this" column="is_dop_cont_contr_sum" />
          <fact column="tp_sum_akt" table="dc" />
        </call>
        <column table="ad_all" column="srok_uslug" title="Срок исполнения обязательств по ТП по договору" group="max" />
        <call function="if" as="tp_dlg_pros" type="number" mp="-6" group="sum" title=" ">
          <call function="=1">
            <fact column="is_reestr_44164_pr" table="dc" />
          </call>
          <fact column="is_reestr_44164_dolg_pr" table="dc" />
          <fact column="tp_dlg_pros" table="dc" comment="1" title=" " />
        </call>
        <call function="if" title="Признак просроченных обязательств по договору" as="pr_pros" type="string" group="max">
          <call function="gt">
            <column table="this" column="tp_dlg_pros" />
            <const>0</const>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <call function="if" as="pr_vina" type="string" group="max" title="Признак просрочнного договора по вине заявителя">
          <call function="and">
            <call function="lt">
              <column table="this" column="srok_uslug" />
              <useparam name="dat" />
            </call>
            <call function="or">
              <call function="in">
                <column table="ad_all" column="status" />
                <array>5,30</array>
              </call>
              <call function="and">
                <call function="in">
                  <column table="ad_all" column="status" />
                  <array>1</array>
                </call>
                <call function="or">
                  <call function="=1">
                    <column table="ad_all" column="read_to_close" />
                  </call>
                  <call function="=">
                    <column table="ad_all" column="vid_opl_ad" />
                    <const>'ОДИ'</const>
                  </call>
                  <call function="!=nvl">
                    <column table="ad_all" column="fl_build" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="=">
                      <column table="ad_all" column="contr_sum_m" />
                      <const>550</const>
                    </call>
                    <call function="gt">
                      <column table="this" column="tp_dlg_pros" />
                      <const>0</const>
                    </call>
                  </call>
                </call>
              </call>
            </call>
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <call function="if" as="tp_kred_akt" type="number" mp="-6" group="sum">
          <call function="=1">
            <fact column="is_reestr_44164_pr" table="dc" />
          </call>
          <fact column="is_reestr_44164_saldo" table="dc" />
          <fact column="tp_kred_akt" table="dc" comment="1" mp="-6" title=" Кредиторская задолженность по суммам перечисленных в рамках договоров ТП авансов " />
        </call>
        <call function="if" title="Наличие мероприятий в договоре ТП, требующих от ДЗО капвложений" type="string" group="max" as="pr_build">
          <call function="=1">
            <column table="ad_all" column="fl_build" />
          </call>
          <const>'да'</const>
          <const>'нет'</const>
        </call>
        <column table="ipr_kod_titul_ip" column="num_name" as="tit_name" title="Наименование титула в инвестпрограмме" comment="1" />
        <fact column="cube_ipr_tit_smet" as="smet" title="Стоимость титула в инвестпрограмме" group="sum" comment="1" mp="-6" table="tit" />
        <fact column="is_dogovor_dog_info" table="pir_n" as="pir_dog_info" title="Реквизиты договора на ПИР" group="max" comment="1" />
        <fact column="cube_ipr_dog_cost" table="pir" as="pir_dog_cost" title="Стоимость договора на ПИР" group="sum" comment="1" mp="-6" />
        <fact column="is_dogovor_dat_end" table="pir_n" as="pir_dog_end" title="Срок исполнения услуг по договору ПИР" group="max" comment="1" />
        <fact column="pir_kap_uch" title="Стоимость принятых актов выполненных работ по ПИР " group="sum" comment="1" mp="-6" table="tit" />
        <fact column="is_dogovor_dog_info" table="smr_n" as="smr_dog_info" title="Реквизиты договора на СМР" group="max" comment="1" />
        <fact column="cube_ipr_dog_cost" table="smr" as="smr_dog_cost" title="Стоимость договора на СМР" group="sum" comment="1" mp="-6" />
        <fact column="is_dogovor_dat_end" table="smr_n" as="smr_dog_end" title="Срок исполнения услуг по договору СМР" group="max" comment="1" />
        <fact column="smr_kap_uch" title="Стоимость принятых актов выполненных работ по СМР " group="sum" comment="1" mp="-6" type="number" table="tit" />
        <fact column="kap_neuch" title="Стоимость закупленного, но не переданного в монтаж оборудования " group="sum" comment="1" mp="-6" type="number" table="tit" />
        <fact column="prch_kap_uch" title="Прочие затраты" group="sum" comment="1" mp="-6" type="number" table="tit" />
        <fact column="hoz_kap_uch" title="Произведенные затраты по работам, осуществленным хозспособом" group="sum" comment="1" mp="-6" type="number" table="tit" />
        <call function="+nvl" as="kap" title="Итого капвложений" group="sum" comment="1" mp="-6">
          <column table="this" column="pir_kap_uch" group="no" />
          <column table="this" column="smr_kap_uch" group="no" />
          <column table="this" column="kap_neuch" group="no" />
          <column table="this" column="prch_kap_uch" group="no" />
          <column table="this" column="hoz_kap_uch" group="no" />
        </call>
        <fact column="kz" title="Кредиторская задолженность поставщикам и подрядчикам по титулу" group="sum" comment="1" mp="-6" table="tit" />
        <call function="+nvl" as="opl" title="Итого капвложения оплаченные" group="sum" comment="1" mp="-6">
          <column table="this" column="kap" group="no" />
          <column table="this" column="kz" group="no" />
        </call>
        <fact column="avans" title="Авансы, выплаченные поставщикам и подрядчикам" group="sum" comment="1" mp="-6" table="tit" />
        <call as="isp_sr" function="if" type="number" title="Итого использовано средств на цели ТП" group="sum" mp="-6">
          <call function="=1">
            <column table="ad_all_tit" column="fl_build" group="no" />
          </call>
          <call function="+nvl">
            <column table="this" column="opl" group="no" />
            <column table="this" column="avans" group="no" />
          </call>
          <column table="this" column="tp_kred_akt" group="no" />
        </call>
        <call as="razn" function="-nvl" type="number" title="Разница между полученными авансами по договору ТП и оплаченными затратами" group="sum" mp="-6">
          <column table="this" column="tp_kred_akt" group="no" />
          <column table="this" column="isp_sr" group="no" />
        </call>
        <call function="over" as="razn_tit" type="number" group="sum">
          <call function="sum">
            <column table="this" column="razn" group="no" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_titul_ip" />
          </call>
        </call>
        <call as="nepok" function="if" type="number" title="Итого использовано средств на цели ТП" group="sum" mp="-6">
          <call function="gt">
            <column table="this" column="razn_tit" group="no" />
            <const>0</const>
          </call>
          <column table="this" column="razn" group="no" />
          <const>0</const>
        </call>
      </select>
      <from>
        <qube merge-dimsets="1">
          <change-source name="ipr_titul_dop_contract" call="44164_ipr_tit_dc" />
          <link name="ipr_kod_titul_ip" as="ipr_kod_titul_ip">
            <link name="kod_ispolnit" />
          </link>
          <link name="kod_reestr_44164" />
          <link name="kod_dop_contract" only-for-cond="1">
            <link name="kod_filial" />
            <link name="kn_customer" />
          </link>
          <where>
            <call function="=" exclude="1">
              <column table="kod_dop_contract" column="kod_dop_contract" />
              <const>3148198</const>
            </call>
            <call function="=" dont-push="1">
              <column table="kod_reestr_44164" column="dat" />
              <useparam name="dat" />
            </call>
            <call function="!=" dont-push="1">
              <column table="kod_reestr_44164" column="pr550" />
              <const>1</const>
            </call>
          </where>
          <dimset as="pir_n">
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_vid_zt_tit" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>1</const>
              </call>
              <call function="!=0" dont-push="1">
                <column table="ipr_kod_vid_zt_tit" column="plan_cost" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="pir">
            <link name="ipr_kod_smet" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>1</const>
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="smr_n">
            <link name="ipr_kod_smet" />
            <link name="ipr_kod_vid_zt_tit" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>2</const>
              </call>
              <call function="!=0" dont-push="1">
                <column table="ipr_kod_vid_zt_tit" column="plan_cost" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="smr">
            <link name="ipr_kod_smet" />
            <where>
              <call function="=">
                <column table="ipr_kod_smet" column="kod_smet" />
                <const>2</const>
              </call>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
          <dimset as="dc">
            <link name="kod_dop_contract" all-rows="1">
              <link name="kn_customer" />
            </link>
          </dimset>
          <dimset as="tit">
            <where>
              <call function="is not null">
                <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
              </call>
            </where>
          </dimset>
        </qube>
        <query name="41164_isv_s_of_ad_all" as="ad_all" join="left outer">
          <call function="=">
            <column table="this" column="kod_dop_contract" />
            <column table="ad_all" column="kod_dop_contract" />
          </call>
        </query>
        <query name="41164_isv_s_of_ad_all_tit" as="ad_all_tit" join="left outer">
          <call function="=">
            <column table="this" column="kod_titul_ip" />
            <column table="ad_all_tit" column="kod_titul_ip" />
          </call>
        </query>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Всего">
          <grset as="dep" title="По филиалам">
            <group>
              <sourcelink table="kod_ispolnit" exclude="1" />
              <column table="this" column="podr" />
            </group>
            <grset as="tit" title="По титулам" order="tit_name">
              <group>
                <sourcelink table="ipr_kod_titul_ip" />
              </group>
              <grset as="dog" title="По договорам">
                <where>
                  <call function="is not null">
                    <column table="this" column="kod_dop_contract" />
                  </call>
                </where>
                <group>
                  <sourcelink table="kod_dop_contract" />
                </group>
              </grset>
            </grset>
          </grset>
          <grset as="all_prosr" title="Всего - просроченные">
            <where>
              <call function="lt">
                <column table="this" column="srok_uslug" />
                <useparam name="dat" />
              </call>
            </where>
          </grset>
          <grset as="all_2017" title="Всего - СОУ 2017">
            <where>
              <call function="=">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2017</const>
              </call>
            </where>
          </grset>
          <grset as="all_2018" title="Всего - СОУ 2018">
            <where>
              <call function="=">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2018</const>
              </call>
            </where>
          </grset>
          <grset as="all_2019" title="Всего - СОУ 2019+">
            <where>
              <call function="ge">
                <call function="year">
                  <column table="this" column="srok_uslug" />
                </call>
                <const>2019</const>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="41164_isv_s_of_ad_all" class="1" materialize="1" timestamp="20.10.2017 19:29:22" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <select>
        <column table="a" column="kod_dop_contract" type="number" />
        <column table="a" column="srok_uslug" type="date" title="" />
        <column table="a" column="contr_sum_m" />
        <column table="a" column="contr_sum_e" />
        <column table="a" column="status" />
        <column table="a" column="fl_build" />
        <column table="a" column="vid_opl_ad" />
        <column table="a" column="read_to_close" />
      </select>
      <from>
        <query name="isv_slice_of_ad_all" as="a" />
      </from>
    </query>
    <query name="41164_isv_s_of_ad_all_tit" class="1" materialize="1" timestamp="21.10.2017 19:28:50" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <select>
        <column table="b" column="kod_titul_ip" type="number" group="1" />
        <column table="a" column="fl_build" title="" group="max" />
      </select>
      <from>
        <query name="isv_slice_of_ad_all" as="a">
          <elink name="isv_slice_of_tdc_all" as="b" />
        </query>
      </from>
    </query>
    <query name="44164_ipr_tit_dc1" timestamp="26.10.2017 02:43:55" materialize="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <select>
        <column table="a" column="*" />
        <call function="over" as="cnt_tit_on_dog" type="number">
          <call function="count">
            <column table="this" column="kod_titul_ip" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
        <column table="kod_titul_ip" column="is_teh_pris" type="number" />
      </select>
      <from>
        <query name="ipr_titul_dop_contract" as="a">
          <link name="kod_titul_ip" />
        </query>
      </from>
    </query>
    <query name="44164_ipr_tit_dc" timestamp="26.10.2017 02:43:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164-test.xml">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="44164_ipr_tit_dc1" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="=1">
            <column table="a" column="is_teh_pris" />
          </call>
          <call function="=1">
            <column table="a" column="cnt_tit_on_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="44164-title" timestamp="19.10.2017 18:02:20" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <usepart part="44164-params" />
      </params>
      <select>
        <call function="()" as="date_cur" type="date">
          <useparam name="dat" />
        </call>
        <call function="()" as="sdate_cur" title="Дата отчёта" type="string">
          <call function="date to char">
            <useparam name="dat" />
          </call>
        </call>
        <call function="()" as="sdat6" type="string">
          <call function="date to char">
            <useparam name="dat6" />
          </call>
        </call>
        <call function="()" as="sdat12" type="string">
          <call function="date to char">
            <useparam name="dat12" />
          </call>
        </call>
        <call function="()" as="sdat18" type="string">
          <call function="date to char">
            <useparam name="dat18" />
          </call>
        </call>
        <call function="()" as="sdat24" type="string">
          <call function="date to char">
            <useparam name="dat24" />
          </call>
        </call>
        <call function="()" as="sdat30" type="string">
          <call function="date to char">
            <useparam name="dat30" />
          </call>
        </call>
        <call function="()" as="sdat36" type="string">
          <call function="date to char">
            <useparam name="dat36" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="cube_ipr_tit_smet" timestamp="21.10.2017 22:39:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <expressions>
        <call function="=1" as="last_smet">
          <column table="ipr_pr_last_smet" column="pr_last" />
        </call>
        <call function="()" as="smet_sum_tek" group="sum" type="number">
          <fact column="ipr_smet_summ_k_rasp_tek" condition="last_smet" />
        </call>
        <call function="()" as="smet_sum_fix" group="sum" type="number">
          <fact column="ipr_smet_summ_k_rasp" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" group="1" key="1" />
        <call function="keep last" as="smet_fix" group="/*inner*/">
          <call function="min">
            <fact column="smet_sum_fix" />
          </call>
          <call function="decode">
            <call function="nvl0">
              <fact column="smet_sum_fix" />
            </call>
            <const>0</const>
            <const>1</const>
          </call>
          <column table="kod_doc_osn" column="doc_date" />
        </call>
        <call function="keep last" as="smet_tek" group="/*inner*/">
          <call function="min">
            <fact column="smet_sum_tek" />
          </call>
          <call function="decode">
            <call function="nvl0">
              <fact column="smet_sum_tek" />
            </call>
            <const>0</const>
            <const>1</const>
          </call>
          <column table="kod_doc_osn" column="doc_date" />
        </call>
        <call function="nvl" as="smet" is-fact="1" agg="sum" fact="cube_ipr_tit_smet" type="number">
          <column table="this" column="smet_fix" />
          <column table="this" column="smet_tek" />
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_titul_ip" />
          <link name="kod_ipr">
            <link name="kod_doc_osn" />
          </link>
          <link name="kod_dop_contract" />
          <link name="kod_reestr_44164" />
        </qube>
        <query name="ipr_titul_ip" as="kod_titul_ip" join="left outer">
          <call function="=">
            <column table="this" column="kod_titul_ip" />
            <column table="kod_titul_ip" column="kod_titul_ip" />
          </call>
        </query>
      </from>
      <links>
        <link name="kod_titul_ip" dimension="1">
          <dimlink name="kod_dop_contract" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_reestr_44164" dimension="1" is-final-dimension="1" is-private-dimension="1" />
        </link>
      </links>
    </query>
    <query name="cube_ipr_dog_cost" timestamp="20.10.2017 15:48:51" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <expressions>
        <call function="=1" as="last_smet">
          <column table="ipr_pr_last_smet" column="pr_last" />
        </call>
        <call function="()" as="smet_sum_tek" group="sum" type="number">
          <fact column="ipr_smet_summ_k_rasp_tek" condition="last_smet" />
        </call>
        <call function="()" as="smet_sum_fix" group="sum" type="number">
          <fact column="ipr_smet_summ_k_rasp" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_vid_zt_tit" column="kod_vid_zatrat_titul" group="max" />
        <column table="ipr_kod_dog" column="kod_dog" group="1" />
        <column table="kod_ipr" column="kod_titul_ip" group="1" />
        <column table="ipr_kod_smet" column="kod_smet" group="1" dimension="ipr_kod_smet" />
        <call function="keep last" group="/*inner*/" as="plan_cost" is-fact="1" agg="sum" fact="cube_ipr_dog_cost" type="number">
          <call function="min">
            <fact column="ipr_vid_zatrat_titul_plan_cost" />
          </call>
          <column table="kod_doc_osn" column="doc_date" />
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="ipr_kod_dog" />
          <link name="ipr_kod_vid_zt_tit" />
          <link name="ipr_kod_smet" />
          <link name="ipr_kod_titul_ip" />
          <link name="kod_reestr_44164" />
          <link name="kod_ipr">
            <link name="kod_doc_osn" />
          </link>
          <where>
            <call function="is not null">
              <column table="ipr_kod_dog" column="kod_dog" />
            </call>
            <call function="!=0">
              <column table="ipr_kod_vid_zt_tit" column="plan_cost" />
            </call>
          </where>
        </qube>
        <query name="is_dogovor" as="kod_dog" join="left outer">
          <!--добавил вручную фк нет-->
          <call function="=">
            <column table="this" column="kod_dog" />
            <column table="kod_dog" column="kod_dog" />
          </call>
        </query>
        <query name="ipr_titul_ip" as="kod_titul_ip" join="left outer">
          <call function="=">
            <column table="this" column="kod_titul_ip" />
            <column table="kod_titul_ip" column="kod_titul_ip" />
          </call>
        </query>
      </from>
      <links>
        <link name="kod_dog" dimension="1" />
        <link name="kod_titul_ip" dimension="1">
          <dimlink name="kod_dop_contract" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_reestr_44164" dimension="1" is-final-dimension="1" is-private-dimension="1" />
        </link>
      </links>
    </query>
    <query name="44164-p1" timestamp="22.10.2017 02:38:08" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <usepart part="44164-params" />
      </params>
      <expressions>
        <call as="do_dat" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat" />
        </call>
        <call as="do_dat6" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat6" />
        </call>
        <call as="do_dat12" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat12" />
        </call>
        <call as="do_dat18" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat18" />
        </call>
        <call as="do_dat24" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat24" />
        </call>
        <call as="do_dat30" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat30" />
        </call>
        <call as="do_dat36" function="le">
          <column table="ipr_dat" column="val" />
          <useparam name="dat36" />
        </call>
        <call as="is_avans" function="=1" dontpushpred="1">
          <column table="ipr_kod_opl_per" column="is_avans" />
        </call>
        <call as="v_dat" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat" />
        </call>
        <call as="v_dat6" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat6" />
        </call>
        <call as="v_dat12" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat12" />
        </call>
        <call as="v_dat18" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat18" />
        </call>
        <call as="v_dat24" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat24" />
        </call>
        <call as="v_dat30" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat30" />
        </call>
        <call as="v_dat36" function="=">
          <column table="ipr_dat" column="val" />
          <useparam name="dat36" />
        </call>
        <call function="()" group="sum" as="kz" is-fact="1">
          <fact column="is_reestr_44164_saldo" />
        </call>
        <call function="()" group="sum" as="kz_pr" is-fact="1">
          <fact column="is_reestr_44164_dolg_pr" />
        </call>
        <call function="()" group="sum" as="av">
          <fact column="is_opl_period_sum" condition="is_avans" />
        </call>
        <call function="()" group="sum" as="kz_0" is-fact="1">
          <fact column="kz" condition="v_dat" />
        </call>
        <call function="()" group="sum" as="kz_6" is-fact="1">
          <fact column="kz" condition="v_dat6" />
        </call>
        <call function="()" group="sum" as="kz_12" is-fact="1">
          <fact column="kz" condition="v_dat12" />
        </call>
        <call function="()" group="sum" as="kz_18" is-fact="1">
          <fact column="kz" condition="v_dat18" />
        </call>
        <call function="()" group="sum" as="kz_24" is-fact="1">
          <fact column="kz" condition="v_dat24" />
        </call>
        <call function="()" group="sum" as="kz_30" is-fact="1">
          <fact column="kz" condition="v_dat30" />
        </call>
        <call function="()" group="sum" as="kz_36" is-fact="1">
          <fact column="kz" condition="v_dat36" />
        </call>
        <call function="()" group="sum" as="kz_pr_0" is-fact="1">
          <fact column="kz_pr" condition="v_dat" />
        </call>
        <call function="()" group="sum" as="kz_pr_6" is-fact="1">
          <fact column="kz_pr" condition="v_dat6" />
        </call>
        <call function="()" group="sum" as="kz_pr_12" is-fact="1">
          <fact column="kz_pr" condition="v_dat12" />
        </call>
        <call function="()" group="sum" as="kz_pr_18" is-fact="1">
          <fact column="kz_pr" condition="v_dat18" />
        </call>
        <call function="()" group="sum" as="kz_pr_24" is-fact="1">
          <fact column="kz_pr" condition="v_dat24" />
        </call>
        <call function="()" group="sum" as="kz_pr_30" is-fact="1">
          <fact column="kz_pr" condition="v_dat30" />
        </call>
        <call function="()" group="sum" as="kz_pr_36" is-fact="1">
          <fact column="kz_pr" condition="v_dat36" />
        </call>
        <call function="()" group="sum" as="av_0" is-fact="1">
          <fact column="av" condition="do_dat" />
        </call>
        <call function="()" group="sum" as="av_6" is-fact="1">
          <fact column="av" condition="do_dat6" />
        </call>
        <call function="()" group="sum" as="av_12" is-fact="1">
          <fact column="av" condition="do_dat12" />
        </call>
        <call function="()" group="sum" as="av_18" is-fact="1">
          <fact column="av" condition="do_dat18" />
        </call>
        <call function="()" group="sum" as="av_24" is-fact="1">
          <fact column="av" condition="do_dat24" />
        </call>
        <call function="()" group="sum" as="av_30" is-fact="1">
          <fact column="av" condition="do_dat30" />
        </call>
        <call function="()" group="sum" as="av_36" is-fact="1">
          <fact column="av" condition="do_dat36" />
        </call>
      </expressions>
      <select>
        <column table="kod_reestr_44164" column="pr550" as="pr_discount" />
        <fact column="kz_0" group="sum" type="number" mp="-6" />
        <fact column="kz_6" group="sum" exclude="1" />
        <fact column="kz_12" group="sum" exclude="1" />
        <fact column="kz_18" group="sum" exclude="1" />
        <fact column="kz_24" group="sum" exclude="1" />
        <fact column="kz_30" group="sum" exclude="1" />
        <fact column="kz_36" group="sum" exclude="1" />
        <fact column="kz_pr_0" group="sum" type="number" mp="-6" />
        <fact column="kz_pr_6" group="sum" exclude="1" />
        <fact column="kz_pr_12" group="sum" exclude="1" />
        <fact column="kz_pr_18" group="sum" exclude="1" />
        <fact column="kz_pr_24" group="sum" exclude="1" />
        <fact column="kz_pr_30" group="sum" exclude="1" />
        <fact column="kz_pr_36" group="sum" exclude="1" />
        <fact column="av_0" group="sum" exclude="1" />
        <fact column="av_6" group="sum" exclude="1" />
        <fact column="av_12" group="sum" exclude="1" />
        <fact column="av_18" group="sum" exclude="1" />
        <fact column="av_24" group="sum" exclude="1" />
        <fact column="av_30" group="sum" exclude="1" />
        <fact column="av_36" group="sum" exclude="1" />
        <call function="/" as="prc_0" exclude="1">
          <column table="this" column="kz_pr_0" />
          <column table="this" column="av_0" />
        </call>
        <call function="/" as="prc_6" exclude="1">
          <column table="this" column="kz_pr_6" />
          <column table="this" column="av_6" />
        </call>
        <call function="/" as="prc_12" exclude="1">
          <column table="this" column="kz_pr_12" />
          <column table="this" column="av_12" />
        </call>
        <call function="/" as="prc_18" exclude="1">
          <column table="this" column="kz_pr_18" />
          <column table="this" column="av_18" />
        </call>
        <call function="/" as="prc_24" exclude="1">
          <column table="this" column="kz_pr_24" />
          <column table="this" column="av_24" />
        </call>
        <call function="/" as="prc_30" exclude="1">
          <column table="this" column="kz_pr_30" />
          <column table="this" column="av_30" />
        </call>
        <call function="/" as="prc_36" exclude="1">
          <column table="this" column="kz_pr_36" />
          <column table="this" column="av_36" />
        </call>
      </select>
      <from>
        <qube merge-dimsets="1" star-scheme="1">
          <link name="kod_reestr_44164" />
          <where>
            <call function="=">
              <column table="kod_reestr_44164" column="dat" />
              <useparam name="dat" />
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего" />
        <grset as="nodisc" title="в т.ч. без льготной категории (550 руб.)">
          <where>
            <call function="=">
              <column table="this" column="pr_discount" />
              <const>0</const>
            </call>
          </where>
        </grset>
      </grouping>
    </query>
    <query name="44164-calc-date" timestamp="21.10.2017 16:09:25" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number">
          <const>2017</const>
        </param>
        <param name="months" type="number">
          <const>-12</const>
        </param>
      </params>
      <select>
        <call function="trunc" as="val" type="date">
          <call function="add_months">
            <call function="year end time">
              <call function="nvl">
                <useparam name="god" />
                <call function="year">
                  <call function="sysdate" />
                </call>
              </call>
            </call>
            <useparam name="months" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="44164-calc-date6" timestamp="21.10.2017 16:06:02" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number" />
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-6</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-calc-date12" timestamp="21.10.2017 16:06:02" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number" />
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-12</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-calc-date18" timestamp="21.10.2017 16:06:02" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number" />
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-18</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-calc-date24" timestamp="21.10.2017 16:06:02" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number" />
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-24</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-calc-date30" timestamp="21.10.2017 16:06:02" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number" />
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-30</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-calc-date36" timestamp="21.10.2017 16:07:54" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="god" type="number">
          <const>2017</const>
        </param>
      </params>
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <query name="44164-calc-date" as="a">
          <withparams>
            <useparam name="god" />
            <const>-36</const>
          </withparams>
        </query>
      </from>
    </query>
    <query name="44164-id_slice_def" class="1" timestamp="21.10.2017 15:43:36" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <const>DATE'2017-08-31'</const>
          </call>
        </call>
      </where>
    </query>
    <query name="44164-dat_def" class="1" timestamp="21.10.2017 15:46:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="id_slice" type="number" />
      </params>
      <select>
        <column table="a" column="dat_copy" title="" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="44164-god_def" class="1" timestamp="21.10.2017 15:50:07" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <param name="dat" type="date" />
      </params>
      <select>
        <call function="year" as="val">
          <useparam name="dat" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="44890-detail" timestamp="07.12.2018 11:26:15" order="rn1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <params>
        <param name="id_slice" type="number">
          <const>424</const>
        </param>
      </params>
      <select>
        <call function="rownum" as="id" key="1" />
        <column table="a" column="num_req" />
        <call function="nvl" as="name_all">
          <column table="a" column="a_customer" />
          <column table="a" column="name_all" />
        </call>
        <call function="decode" as="region" title="Регион" type="string">
          <call function="nvl">
            <column table="a" column="kn_zone" />
            <const>0</const>
          </call>
          <const>0</const>
          <const>'Область'</const>
          <const>'Город'</const>
        </call>
        <column table="a" column="filial" />
        <column table="a" column="lp_addr" />
        <column table="a" column="date_coming" />
        <call function="trunc" as="dt_docs_got" type="date">
          <column table="a" column="dt_docs_got" />
        </call>
        <column table="a" column="dt_project" />
        <call function="-" as="srok">
          <column table="id_slice" column="dat_copy" />
          <call function="trunc" type="date">
            <column table="a" column="dt_docs_got" />
          </call>
        </call>
        <column table="a" column="contr_sumf" />
        <column table="a" column="guess_sum" />
        <column table="a" column="load123_kvt" />
        <call function="+" as="sum_kvt">
          <column table="a" column="load123_kvt" />
          <column table="a" column="load_existed_kvt" />
        </call>
        <column table="a" column="status" />
        <column table="id_slice" column="dat_copy" />
        <call function="case" as="req_type" title="Тип заявки">
          <call function="when">
            <call function="=">
              <column table="a" column="pr_gen" />
              <const>1</const>
            </call>
            <const comment="Генерация">3</const>
          </call>
          <call function="when">
            <call function="=">
              <call function="nvl">
                <column table="a" column="kn_zone" />
                <const>0</const>
              </call>
              <const>0</const>
            </call>
            <const comment="Область">2</const>
          </call>
          <call function="else">
            <const comment="Город">1</const>
          </call>
        </call>
        <call function="case" as="gr1" title="gr1" type="number">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="dt_project" />
              </call>
              <call table="a" column="pr_gen" function="is null" exclude="1">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="gt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dt_project" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when" exclude="1">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="dt_project" />
              </call>
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="gt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dat_ouco" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr2" title="gr2" type="number">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="dt_project" />
              </call>
              <call table="a" column="pr_gen" function="is null" exclude="1">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="lt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dt_project" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when" exclude="1">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="dt_project" />
              </call>
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="lt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dat_ouco" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr3" title="gr3" type="number">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is null" exclude="1">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call table="a" column="pr_gen" function="is null">
                <column table="a" column="dt_project" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr4" title="gr4" type="number">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is null" exclude="1">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call table="a" column="pr_gen" function="is null">
                <column table="a" column="dt_project" />
              </call>
              <call function="gt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dt_docs_got" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="row_number" as="rn1" title="№ п/п">
          <call function="partition by">
            <call function="case" as="req_type" title="Тип заявки">
              <call function="when">
                <call function="=">
                  <column table="a" column="pr_gen" />
                  <const>1</const>
                </call>
                <const comment="Генерация">3</const>
              </call>
              <call function="when">
                <call function="=">
                  <call function="nvl">
                    <column table="a" column="kn_zone" />
                    <const>0</const>
                  </call>
                  <const>0</const>
                </call>
                <const comment="Область">2</const>
              </call>
              <call function="else">
                <const comment="Город">1</const>
              </call>
            </call>
          </call>
          <call function="order by 2">
            <column table="a" column="num_req" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_ad_all" as="a">
          <withparams exclude="1">
            <useparam name="id_slice" />
          </withparams>
          <link name="id_slice" />
          <link name="kod_zayav" exclude="1">
            <link name="c_zayav_family" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="or">
            <call function="ge">
              <column table="a" column="load123" />
              <const name="id_slice">5000</const>
            </call>
            <call function="=">
              <column table="a" column="pr_gen" />
              <const>1</const>
            </call>
          </call>
          <call function="not in">
            <call function="nvl">
              <column table="a" column="kn_contr_kind" />
              <const name="id_slice">0</const>
            </call>
            <array>-1,6,7,9</array>
          </call>
          <call function="=">
            <call function="nvl">
              <column table="a" column="cp" />
              <const name="id_slice">0</const>
            </call>
            <const>0</const>
          </call>
          <call function="in">
            <column table="a" column="kn_load_type" />
            <array>1,2,9,17,32,33,35,36</array>
          </call>
          <call function="or">
            <call function="and">
              <call function="is not null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="=">
                <column table="a" column="status" />
                <const>0</const>
              </call>
              <call function="is null">
                <column table="a" column="kn_contract_p" />
              </call>
            </call>
            <call function="and">
              <call function="is null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call function="in">
                <column table="a" column="status" />
                <array>0,1</array>
              </call>
              <call function="is null" exclude="1">
                <column table="kod_zayav" column="dat_an" />
              </call>
              <call function="is null" exclude="1">
                <column table="kod_zayav" column="dat_close" />
              </call>
              <call function="is not null" exclude="1">
                <column table="c_zayav_family" column="dat_zayav" />
              </call>
            </call>
          </call>
          <call function="is not null">
            <column table="a" column="kn_req" />
          </call>
        </call>
      </where>
    </query>
    <query name="44890-gr" timestamp="20.12.2017 15:30:20" order="req_type" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <params>
        <param name="id_slice" type="number">
          <const>425</const>
        </param>
        <param type="date" name="p_dat">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="t" column="id" group="1" as="req_type" />
        <call function="||" as="title" group="1">
          <column table="t" column="title" />
          <const>' (по состоянию на '</const>
          <call function="date to char">
            <useparam name="p_dat" />
          </call>
          <const>')'</const>
        </call>
        <column table="t" column="name" group="1" />
        <call function="||" as="list_name" group="1">
          <column table="t" column="id" />
          <const>'. '</const>
          <column table="t" column="name" />
        </call>
        <column function="count" as="sum0" group="count" table="a" column="num_req" />
        <column table="a" column="gr1" group="sum" nvl="0" />
        <column table="a" column="gr2" group="sum" nvl="0" />
        <column table="a" column="gr3" group="sum" nvl="0" />
        <column table="a" column="gr4" group="sum" nvl="0" />
      </select>
      <from>
        <query name="44890-detail" as="a">
          <withparams>
            <useparam name="id_slice" />
          </withparams>
        </query>
        <query name="44890-types" join="right outer" as="t">
          <call function="=">
            <column table="a" column="req_type" />
            <column table="t" column="id" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
        </call>
      </where>
    </query>
    <query name="44890-1" timestamp="13.12.2017 14:26:32" is-report="1" title="Реестр заявок на постоянное ТП свыше 5 МВт" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <content>
        <usefield field="kido_id_slice" />
      </content>
      <print-templates>
        <excel>
          <template name="44890.xlsx" title="Реестр заявок на постоянное ТП свыше 5 МВт" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <params>
        <param name="id_slice" type="number">
          <const>424</const>
        </param>
      </params>
      <select>
        <call function="||-" as="id">
          <column table="a" column="kod_dop_contract" />
          <column table="a" column="kn_req" />
        </call>
        <column table="a" column="num_req" group="max" />
        <column table="a" column="name_all" title="Заявитель" group="max" />
        <call function="decode" as="region" title="Регион" type="string" group="max">
          <column table="a" column="kn_zone" />
          <const>'0'</const>
          <const>'Область'</const>
          <const>'Город'</const>
        </call>
        <column table="a" column="filial" group="max" />
        <column table="a" column="lp_addr" group="max" />
        <column table="a" column="date_coming" group="max" />
        <call function="trunc" as="dt_docs_got" type="date" group="max">
          <column table="a" column="dt_docs_got" />
        </call>
        <column table="a" column="dat_ouco" as="dt_project" group="max" />
        <call function="-" as="srok" group="max">
          <column table="id_slice" column="dat_copy" />
          <call function="trunc" type="date">
            <column table="a" column="dt_docs_got" />
          </call>
        </call>
        <column table="a" column="contr_sumf" group="sum" />
        <column table="a" column="guess_sum" group="sum" />
        <column table="a" column="load123_kvt" group="sum" />
        <call function="+" as="sum_kvt" group="sum">
          <column table="a" column="load123_kvt" />
          <column table="a" column="load_existed_kvt" />
        </call>
        <column table="a" column="status" group="max" />
        <column table="a" column="kod_dop_contract" group="max" />
        <column table="a" column="load123" group="max" />
        <column table="id_slice" column="dat_copy" group="max" />
        <call function="case" as="req_type" title="Тип заявки">
          <call function="when">
            <call function="=">
              <column table="a" column="pr_gen" />
              <const>1</const>
            </call>
            <const comment="Генерация">3</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="kn_zone" />
              <const>0</const>
            </call>
            <const comment="Область">2</const>
          </call>
          <call function="else">
            <const comment="Город">1</const>
          </call>
        </call>
        <call function="case" as="gr1" title="gr1" type="number" group="sum">
          <call function="when">
            <call function="gt">
              <call table="a" column="pr_gen" function="-">
                <column table="id_slice" column="dat_copy" />
                <column table="a" column="dat_ouco" />
              </call>
              <const>30</const>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr2" title="gr2" type="number" group="sum">
          <call function="when">
            <call function="lt">
              <call table="a" column="pr_gen" function="-">
                <column table="id_slice" column="dat_copy" />
                <column table="a" column="dat_ouco" />
              </call>
              <const>30</const>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr3" title="gr3" type="number" group="sum">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call table="a" column="pr_gen" function="is null">
                <column table="a" column="dat_ouco" />
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call table="a" column="pr_gen" function="=">
                <column table="a" column="status" />
                <const>0</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="gr4" title="gr4" type="number" group="sum">
          <call function="when">
            <call function="and">
              <call table="a" column="pr_gen" function="is not null">
                <column table="a" column="kod_dop_contract" />
              </call>
              <call table="a" column="pr_gen" function="=">
                <column table="a" column="status" />
                <const>0</const>
              </call>
              <call function="gt">
                <call table="a" column="pr_gen" function="-">
                  <column table="id_slice" column="dat_copy" />
                  <column table="a" column="dat_ouco" />
                </call>
                <const>30</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="row_number" as="rn1" title="№ п/п" group="max">
          <call function="partition by">
            <call function="case" as="req_type" title="Тип заявки">
              <call function="when">
                <call function="=">
                  <column table="a" column="pr_gen" />
                  <const>1</const>
                </call>
                <const>3</const>
              </call>
              <call function="when">
                <call function="=">
                  <column table="a" column="kn_zone" />
                  <const>0</const>
                </call>
                <const>2</const>
              </call>
              <call function="else">
                <const>1</const>
              </call>
            </call>
          </call>
          <call function="order by 2">
            <column table="a" column="num_req" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_ad_all" as="a">
          <withparams exclude="1">
            <useparam name="id_slice" />
          </withparams>
          <link name="id_slice" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="this" column="load123" />
            <const name="id_slice">5000</const>
          </call>
          <call function="or">
            <call function="and">
              <call function="is not null">
                <column table="this" column="kod_dop_contract" />
              </call>
              <call function="=">
                <column table="this" column="status" />
                <const>0</const>
              </call>
            </call>
            <call function="and">
              <call function="is null">
                <column table="this" column="kod_dop_contract" />
              </call>
              <call function="in">
                <column table="this" column="status" />
                <array>0,1</array>
              </call>
            </call>
          </call>
        </call>
      </where>
      <grouping>
        <grset as="itog" title="Итог">
          <group>
            <column table="this" column="req_type" />
          </group>
          <grset as="det" title="Детализация">
            <group>
              <column table="this" column="id" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="44890-types" timestamp="20.12.2017 11:01:28" title="Типы заявок" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <const as="id" type="number">1</const>
      <const as="name" type="string">'Город'</const>
      <const as="title" type="string">'Информация по заявкам на постоянное ТП свыше 5 МВт по Санкт-Петербургу'</const>
      <const>2</const>
      <const>'Область'</const>
      <const>'Информация по заявкам на постоянное ТП свыше 5 МВт по Ленинградской области'</const>
      <const>3</const>
      <const>'Генерация'</const>
      <const>'Информация по заявкам на генерацию'</const>
    </query>
    <query name="44890-dat-val" timestamp="19.12.2017 18:14:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <params>
        <param name="id_slice" type="number">
          <const>425</const>
        </param>
      </params>
      <select>
        <column table="a" column="dat_copy" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam function="true" name="id_slice" />
        </call>
      </where>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id">
    <part id="25499-dat-kod_titul_ip" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <call function="if" as="kod_titul_ip" group="1" type="number" agg="no">
        <call function="or">
          <call function="false" />
          <call function="=1" optional="1">
            <useparam name="pr_child" />
          </call>
        </call>
        <column table="ipr_ipr_data" column="kod_titul_ip" agg="no" />
        <column table="ipr_ipr_data" column="kod_main_titul" agg="no" />
      </call>
    </part>
    <part id="25499-columns" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <call function="if" as="format" type="string" agg="no">
        <call function="is not null">
          <column table="tree" column="kod_titul_ip" />
        </call>
        <column table="tree" column="itip" />
        <call function="case">
          <call function="when">
            <call function="=">
              <column table="tree" column="lvl" />
              <const>1</const>
            </call>
            <const>'все'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="tree" column="lvl" />
              <const>2</const>
            </call>
            <const>'1 уровень'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="tree" column="lvl" />
              <const>3</const>
            </call>
            <const>'2 уровень'</const>
          </call>
          <call function="else">
            <const>'раздел'</const>
          </call>
        </call>
      </call>
      <column table="tree" column="rwn" title="№пп" agg="no" />
      <column table="tree" column="lvl" agg="no" />
      <column table="tree" column="har" agg="no" />
      <column table="tree" column="prog" agg="no" />
      <column table="tree" column="razdel_abbr" title="№№" agg="no" />
      <column table="tree" column="tit_num_new" agg="no" />
      <column table="tree" column="kod_razdel_if_root" agg="no" />
      <column table="tree" column="itip" agg="no" />
      <!--<const as="har" type="string">'НС'</const>-->
      <call function="||" as="full_name" agg="no">
        <!--<call function="space">
          <call function="*">
            <call function="-">
              <column table="tree" column="lvl"/>
              <const>1</const>
            </call>
            <const>5</const>
          </call>
        </call>-->
        <column table="tree" column="full_name" />
      </call>
      <column table="tree" column="kod_node" key="1" agg="no" />
      <column table="tree" column="kod_parent_node" agg="no" />
    </part>
    <part id="25499-columns-sum-a" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <call function="smallest" as="summ_k_rasp" title="Полная стоимость строительства к распределению, млн. руб. с НДС" agg="sum">
        <column table="a" column="summ" />
        <column table="a" column="summ_10" />
        <column table="a" column="summ_30" />
      </call>
      <call function="smallest" as="summ_k_rasp_bn" title="Полная стоимость строительства к распределению, млн. руб. без НДС" agg="sum">
        <column table="a" column="summ_bn" />
        <column table="a" column="summ_10_bn" />
        <column table="a" column="summ_30_bn" />
      </call>
    </part>
    <part id="25499-fields" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <field name="kod_doc" type="number" controlType="UICombo" title="Документ" mandatory="1">
        <listquery>
          <query name="25499-ipr_doc_main_list" />
        </listquery>
      </field>
      <field name="kod_subject" type="number" controlType="UIList" title="Субъект Федерации" show-nulls="0">
        <listquery>
          <query name="ips_subjects" />
        </listquery>
      </field>
      <field name="kod_direct" type="number" controlType="UIList" title="Подразделение" show-nulls="0">
        <listquery>
          <query name="25499-ipr_direct" />
        </listquery>
      </field>
      <field name="kod_dirisp" type="number" controlType="UICombo" title="Заказчик/Исполнитель" mandatory="1">
        <listquery>
          <query name="is_spr_dirisp" />
        </listquery>
        <defaultquery>
          <query name="is_spr_dirisp_def" />
        </defaultquery>
      </field>
      <field name="pr_sbor" type="number" controlType="UICheck" title="Отображать сборные" />
      <field name="pr_child" type="number" controlType="UICheck" title="Отображать дочерние" />
    </part>
    <part id="25499-detail-pars" timestamp="24.10.2016 11:18:27" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <param name="kod_doc">
        <const>43383</const>
      </param>
      <param name="year">
        <const>2014</const>
      </param>
      <param name="kod_subject" />
      <param name="kod_direct" />
      <param name="pr_sbor" />
      <param name="pr_child">
        <const>1</const>
      </param>
      <param name="kod_dirisp" />
      <param name="pr_all_razdel" />
      <param name="pr_dont_show_wfp" />
      <param name="pr_zatrat">
        <const>1</const>
      </param>
      <param name="pr_dog">
        <const>1</const>
      </param>
      <param name="kod_ofz" />
    </part>
    <part id="25499-detail-wpars" timestamp="24.10.2016 11:18:42" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <useparam name="kod_doc" />
      <useparam name="year" />
      <useparam name="kod_subject" />
      <useparam name="kod_direct" />
      <useparam name="pr_sbor" />
      <useparam name="pr_child" />
      <useparam name="kod_dirisp" />
      <useparam name="pr_all_razdel" />
      <useparam name="pr_dont_show_wfp" />
      <useparam name="pr_zatrat" />
      <useparam name="pr_dog" />
      <useparam name="kod_ofz" />
    </part>
    <part id="25499-wfp-cond" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <call function="and" optional="1">
        <call function="=">
          <useparam name="pr_dont_show_wfp" />
          <const>1</const>
        </call>
        <call function="in">
          <column table="a" column="kod_titul_ip" />
          <query>
            <select>
              <column table="ttt" column="kod_titul_ip" />
            </select>
            <from>
              <query name="25499-ipr-fp" as="ttt">
                <withparams>
                  <useparam name="kod_doc" />
                  <useparam name="year" />
                </withparams>
              </query>
            </from>
          </query>
        </call>
      </call>
    </part>
    <part id="26630-rownum" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <params>
        <param name="pr_sb" />
        <param name="gr_sb" />
        <param name="gr_od" />
        <param name="gr_par" />
        <param name="gr_child" />
      </params>
      <call function="if" as="num_sb_od" type="number" client-calc="1" title="Номеру первого уровня">
        <call function="or">
          <call function="in">
            <column table="this" column="grsetid" />
            <useparam name="gr_sb" />
          </call>
          <call function="in">
            <column table="this" column="grsetid" />
            <useparam name="gr_od" />
          </call>
          <call function="and">
            <call function="in">
              <column table="this" column="grsetid" />
              <useparam name="gr_par" />
            </call>
            <call function="=">
              <useparam name="pr_sb" />
              <const>0</const>
            </call>
          </call>
        </call>
        <call function="+nvl">
          <column table="this" column="num_sb_od" row-selector="prev-row" />
          <const>1</const>
        </call>
        <column table="this" column="num_sb_od" row-selector="prev-row" />
      </call>
      <call function="if" as="num_prt" title="Номер головного при наличии сборных" type="number" client-calc="1">
        <call function="in">
          <column table="this" column="grsetid" />
          <useparam name="gr_par" />
        </call>
        <call function="if">
          <call function="=">
            <column table="this" column="num_sb_od" />
            <column table="this" column="num_sb_od" row-selector="prev" />
          </call>
          <call function="+nvl">
            <column table="this" column="num_prt" row-selector="prev" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="num_prt" row-selector="parent" />
      </call>
      <call function="if" as="num_cld" title="Номер дочернего" type="number" client-calc="1">
        <call function="in">
          <column table="this" column="grsetid" />
          <useparam name="gr_child" />
        </call>
        <call function="+nvl">
          <column table="this" column="num_cld" row-selector="prev-sibling" />
          <const>1</const>
        </call>
        <column table="this" column="num_cld" row-selector="parent" />
      </call>
      <call function="||" as="num_full" title="Номер" client-calc="1">
        <column table="this" column="num_sb_od" />
        <call function="if">
          <call function="and">
            <call function="or">
              <call function="in">
                <column table="this" column="grsetid" />
                <useparam name="gr_child" />
              </call>
              <call function="in">
                <column table="this" column="grsetid" />
                <useparam name="gr_par" />
              </call>
            </call>
            <call function="=">
              <useparam name="pr_sb" />
              <const>1</const>
            </call>
          </call>
          <call function="||">
            <const>'.'</const>
            <column table="this" column="num_prt" />
          </call>
        </call>
        <call function="if">
          <call function="in">
            <column table="this" column="grsetid" />
            <useparam name="gr_child" />
          </call>
          <call function="||">
            <const>'.'</const>
            <column table="this" column="num_cld" />
          </call>
        </call>
      </call>
    </part>
    <part id="26630-pivot-facts-ym" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <!--<column column="zt_kz_pl_sn_cm" />
      <column column="zt_dz_pl_sn_cm" />-->
    </part>
    <part id="26630-pivot-facts-kv" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <column column="nzs_sp_ag" />
      <column column="nzs_pp_ag" />
      <column column="nzs_sp_tg" />
      <column column="nzs_pp_tg" />
      <column column="nzs_sp_pg" />
      <column column="nzs_pp_pg" />
      <column column="fin_sp_ag" />
      <column column="fin_pp_ag" />
      <column column="fin_sp_tg" />
      <column column="fin_pp_tg" />
      <column column="fin_sp_pg" />
      <column column="fin_pp_pg" />
    </part>
    <part id="26630-pivot-facts-ym-kv-m6-m9" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <column column="os_pl_bn" />
      <column column="os_pl_nn" />
      <column column="fn_pl_sn" />
      <column column="fn_pl_nn" />
      <column column="vv_pl_bn" />
      <column column="os_wf_bn" />
      <column column="os_wf_nn" />
      <column column="fn_wf_sn" />
      <column column="fn_wf_nn" />
      <column column="vv_wf_bn" />
      <column column="os_ft_bn" />
      <column column="os_ft_nn" />
      <column column="os_ft_bn_n" />
      <column column="os_ft_nn_n" />
      <column column="fn_ft_sn" />
      <column column="fn_ft_nn" />
      <column column="vv_ft_bn" />
      <column column="os_ft_bn_s1" />
      <column column="os_ft_bn_s2" />
      <column column="os_ft_bn_s3" />
      <column column="os_ft_bn_s3_n" />
      <column column="os_ft_bn_s4" />
      <column column="os_ft_bn_s5" />
      <column column="os_ft_bn_s6" />
      <column column="os_ft_bn_s7" />
      <column column="fn_ft_sn_s1" />
      <column column="fn_ft_sn_s2" />
      <column column="fn_ft_sn_s3" />
      <column column="fn_ft_sn_s4" />
      <column column="fn_ft_sn_s5" />
      <column column="vv_pl_bn_s1" />
      <column column="vv_wf_bn_s1" />
      <column column="vv_ft_bn_s1" />
      <column column="vv_pl_bn_s4" />
      <column column="vv_wf_bn_s4" />
      <column column="vv_ft_bn_s4" />
    </part>
    <part id="26630-pivot-facts-ym_cm-smet" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <column column="smet_dz_pl_sn_cm" />
      <column column="smet_kz_pl_sn_cm" />
      <column column="smet_dz_wf_sn_cm" />
      <column column="smet_kz_wf_sn_cm" />
      <column column="smet_dz_ft_sn_cm" />
      <column column="smet_kz_ft_sn_cm" />
    </part>
    <part id="26630-pivot-facts-ym_cm-dog" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <column column="dog_dz_pl_sn_cm" />
      <column column="dog_kz_pl_sn_cm" />
      <column column="dog_dz_wf_sn_cm" />
      <column column="dog_kz_wf_sn_cm" />
      <column column="dog_dz_ft_sn_cm" />
      <column column="dog_kz_ft_sn_cm" />
    </part>
    <part id="26630-pivot-facts-ym_cm" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <column column="os_pl_bn_cm" />
      <column column="os_pl_nn_cm" />
      <column column="fn_pl_sn_cm" />
      <column column="fn_pl_nn_cm" />
      <column column="nzs_pl_bn_cm" />
      <column column="sld_pl_sn_cm" />
      <column column="os_wf_bn_cm" />
      <column column="os_wf_nn_cm" />
      <column column="fn_wf_sn_cm" />
      <column column="fn_wf_nn_cm" />
      <column column="nzs_wf_bn_cm" />
      <column column="sld_wf_sn_cm" />
      <column column="os_ft_bn_cm" />
      <column column="os_ft_nn_cm" />
      <column column="os_ft_bn_cm_n" />
      <column column="os_ft_nn_cm_n" />
      <column column="fn_ft_sn_cm" />
      <column column="fn_ft_nn_cm" />
      <column column="nzs_ft_bn_cm" />
      <column column="sld_ft_sn_cm" />
      <column column="os_ft_bn_cm_s1" />
      <column column="os_ft_bn_cm_s2" />
      <column column="os_ft_bn_cm_s3" />
      <column column="os_ft_bn_cm_s3_n" />
      <column column="os_ft_bn_cm_s4" />
      <column column="os_ft_bn_cm_s5" />
      <column column="os_ft_bn_cm_s6" />
      <column column="os_ft_bn_cm_s7" />
      <column column="fn_ft_sn_cm_s1" />
      <column column="fn_ft_sn_cm_s2" />
      <column column="fn_ft_sn_cm_s3" />
      <column column="fn_ft_sn_cm_s4" />
      <column column="fn_ft_sn_cm_s5" />
      <column column="vv_pl_bn_cm" />
      <column column="vv_wf_bn_cm" />
      <column column="vv_ft_bn_cm" />
      <column column="vv_pl_bn_cm_s1" />
      <column column="vv_wf_bn_cm_s1" />
      <column column="vv_ft_bn_cm_s1" />
      <column column="vv_pl_bn_cm_s4" />
      <column column="vv_wf_bn_cm_s4" />
      <column column="vv_ft_bn_cm_s4" />
    </part>
    <part id="26630-vvod-pivot-facts-ym-kv-m6-m9" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-vvod-new3.xml">
      <column column="vv_pl_bn" />
      <column column="vv_ft_bn" />
      <column column="vv_mba_pl" />
      <column column="vv_mba_ft" />
      <column column="vv_km_pl" />
      <column column="vv_km_ft" />
      <column column="vv_kmkl_pl" />
      <column column="vv_kmkl_ft" />
      <column column="vv_kmvl_pl" />
      <column column="vv_kmvl_ft" />
      <column column="vv_kmvl1_pl" />
      <column column="vv_kmvl1_ft" />
      <column column="vv_kmvl2_pl" />
      <column column="vv_kmvl2_ft" />
      <column column="vv_pstp_pl" />
      <column column="vv_pstp_ft" />
      <column column="vv_prch_pl" />
      <column column="vv_prch_ft" />
      <column column="vv_any_pl" />
      <column column="vv_any_ft" />
      <column column="pr_mba_pl" />
      <column column="pr_mba_ft" />
      <column column="pr_km_pl" />
      <column column="pr_km_ft" />
      <column column="pr_kmkl_pl" />
      <column column="pr_kmkl_ft" />
      <column column="pr_kmvl_pl" />
      <column column="pr_kmvl_ft" />
      <column column="pr_kmvl1_pl" />
      <column column="pr_kmvl1_ft" />
      <column column="pr_kmvl2_pl" />
      <column column="pr_kmvl2_ft" />
      <column column="pr_pstp_pl" />
      <column column="pr_pstp_ft" />
      <column column="pr_prch_pl" />
      <column column="pr_prch_ft" />
      <column column="pr_any_pl" />
      <column column="pr_any_ft" />
    </part>
    <part id="26630-vvod-pivot-facts-ym_cm" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-vvod-new3.xml">
      <column column="vv_pl_bn_cm" />
      <column column="vv_ft_bn_cm" />
      <column column="vv_mba_pl_cm" />
      <column column="vv_mba_ft_cm" />
      <column column="vv_km_pl_cm" />
      <column column="vv_km_ft_cm" />
      <column column="vv_kmkl_pl_cm" />
      <column column="vv_kmkl_ft_cm" />
      <column column="vv_kmvl_pl_cm" />
      <column column="vv_kmvl_ft_cm" />
      <column column="vv_kmvl1_pl_cm" />
      <column column="vv_kmvl1_ft_cm" />
      <column column="vv_kmvl2_pl_cm" />
      <column column="vv_kmvl2_ft_cm" />
      <column column="vv_pstp_pl_cm" />
      <column column="vv_pstp_ft_cm" />
      <column column="vv_prch_pl_cm" />
      <column column="vv_prch_ft_cm" />
      <column column="vv_any_pl_cm" />
      <column column="vv_any_ft_cm" />
    </part>
    <part id="26630-params" timestamp="23.01.2018 15:07:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <param name="kod_doc" type="number">
        <const>143403</const>
      </param>
      <param name="year" type="number">
        <const>2017</const>
      </param>
      <param name="period" type="array" />
      <param name="pr_child" type="number">
        <const>1</const>
      </param>
      <param name="pr_sbor" type="number" />
      <param name="pr_zatrat" type="number" />
      <param name="pr_dog" type="number" />
      <param name="kod_titul_ip" type="array" />
      <param name="kod2_titul_ip" type="array" />
      <param name="mon1" type="number">
        <const>1</const>
      </param>
      <param name="mon2" type="number">
        <const>12</const>
      </param>
      <param name="kod_dirisp" type="number">
        <const>1</const>
      </param>
      <param name="kod_subject" type="array" />
      <param name="kod_direct" type="array">
        <const>21</const>
      </param>
      <param name="mp" type="number">
        <const>-3</const>
      </param>
      <param name="pr_notaip" type="number" />
      <param name="pr_all_fact" type="number" />
      <param name="pr_all_fact_not" type="number" />
      <param name="kod_ofz" type="array" />
      <param name="pr_gorobl" type="number" />
      <param name="pr_tek_smet" type="number" />
      <param name="pr_no_zero" type="number" />
      <param name="pr_pf_gr" type="number" />
    </part>
    <part id="26630-withparams" timestamp="02.02.2017 19:50:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <useparam name="kod_doc" />
      <useparam name="year" />
      <useparam name="period" />
      <useparam name="pr_child" />
      <useparam name="pr_sbor" />
      <useparam name="pr_zatrat" />
      <useparam name="pr_dog" />
      <useparam name="kod_titul_ip" />
      <useparam name="kod2_titul_ip" />
      <useparam name="mon1" />
      <useparam name="mon2" />
      <useparam name="kod_dirisp" />
      <useparam name="kod_subject" />
      <useparam name="kod_direct" />
      <useparam name="mp" />
      <useparam name="pr_notaip" />
      <useparam name="pr_all_fact" />
      <useparam name="pr_all_fact_not" />
      <useparam name="kod_ofz" />
      <useparam name="pr_gorobl" />
      <useparam name="pr_tek_smet" />
      <useparam name="pr_no_zero" />
      <useparam name="pr_pf_gr" />
    </part>
    <part id="26630-smet-cond" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <call function="and">
        <call function="=">
          <call function="nvlu">
            <useparam name="pr_zatrat" />
            <const>0</const>
          </call>
          <const>1</const>
        </call>
        <call function="in">
          <column table="a" column="kod_smet" />
          <array>1,2,3,4</array>
        </call>
      </call>
    </part>
    <part id="26630-zt-cond" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <call function="and">
        <call function="=">
          <call function="nvlu">
            <useparam name="pr_zatrat" />
            <const>0</const>
          </call>
          <const>1</const>
        </call>
        <call function="=">
          <column table="a" column="zatr_parent" />
          <const>52</const>
        </call>
      </call>
    </part>
    <part id="26630-dog-cond" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <call function="and">
        <call function="=">
          <call function="nvlu">
            <useparam name="pr_dog" />
            <const>0</const>
          </call>
          <const>1</const>
        </call>
        <call function="is not null">
          <column table="a" column="kod_dog_i" />
        </call>
      </call>
    </part>
    <part id="26630-common-columns" timestamp="02.11.2016 18:04:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <column table="a" column="kod_ipr" exclude="1" />
      <column table="kod_main_titul" column="kod_sbor_titul" group="6" />
      <column table="kod_sbor_titul" column="kod_titul_ip" as="kod_titul_ip_sb" group="kod_sbor_titul" />
      <column table="kod_sbor_titul" column="kod_sbor_titul" as="kod_sbor_titul_sb" group="kod_sbor_titul" />
      <column table="kod_titul_ip_sbor" column="tit_num_new" as="tit_num_new_sbor" group="kod_sbor_titul" title="Код сборного титула" />
      <column table="kod_titul_ip_sbor" column="full_name" as="full_name_sbor" group="kod_sbor_titul" title="Наименование сборного титула" />
      <column table="kod_razdel" column="path" group="kod_sbor_titul" />
      <column table="kod_main_titul" column="kod_titul_ip" group="1" as="kod_main_titul" />
      <column table="kod_status" column="name" as="st_name" group="max" title="Статус титула" />
      <column table="ipr_ipr_data" column="kod_doc_osn" group="max" exclude="1" />
      <column table="ipr_ipr_data" column="pr_last" group="max" exclude="1" />
      <column table="kod_main_titul" column="tit_num_new" as="tit_num_new_main" group="kod_main_titul" />
      <column table="kod_main_titul" column="full_name" as="full_name_main" group="kod_main_titul" title="Наименование головного/одиночного титула" />
      <column table="kod_main_titul" column="is_head_tit" group="kod_main_titul" />
      <column table="kod_ipr_ext" column="kod_child_titul" group="5" />
      <column table="kod_ipr_ext" column="kod_parent" group="kod_child_titul" />
      <column table="kod_titul_ip" column="tit_num_new" group="kod_child_titul" title="Код дочернего титула" />
      <column table="kod_titul_ip" column="full_name" as="full_name_child" group="kod_child_titul" title="Наименование дочернего титула" />
      <column table="kod_direct_main" column="name" as="direct_name_main" group="kod_main_titul" />
      <column table="kod_ispolnit_main" column="name" as="ispolnit_name_main" group="kod_main_titul" />
      <column table="kod_subject_main" column="name" as="subject_name_main" group="kod_main_titul" />
      <column table="kod_direct" column="name" as="direct_name" group="kod_child_titul" />
      <column table="kod_ispolnit" column="name" as="ispolnit_name" group="kod_child_titul" />
      <column table="a" column="ym" />
      <call function="if" as="go_grp" group="7" title="Группа">
        <call function="=">
          <call function="nvlu">
            <useparam name="pr_gorobl" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <const>'СПб и ЛО'</const>
        <column table="kod_subject_main" column="abbr" />
      </call>
      <call function="time ym2 id" as="ym_id" group="8">
        <column table="a" column="ym" />
      </call>
      <call function="time y k id" as="kv_id" group="11">
        <call function="ym2 god">
          <column table="a" column="ym" />
        </call>
        <call function="ym2 to kv">
          <column table="a" column="ym" />
        </call>
      </call>
      <call function="if" as="m6_id" group="12">
        <call function="le">
          <call function="ym2 mes">
            <column table="a" column="ym" />
          </call>
          <const>6</const>
        </call>
        <call function="time y k id">
          <call function="ym2 god">
            <column table="a" column="ym" />
          </call>
          <const>5</const>
        </call>
      </call>
      <call function="if" as="m9_id" group="13">
        <call function="le">
          <call function="ym2 mes">
            <column table="a" column="ym" />
          </call>
          <const>9</const>
        </call>
        <call function="time y k id">
          <call function="ym2 god">
            <column table="a" column="ym" />
          </call>
          <const>6</const>
        </call>
      </call>
      <call function="time ym2 id" as="ym_nxt_id" group="14">
        <column table="a" column="ym_nxt" />
      </call>
      <call function="if" as="op_id" group="15" type="number">
        <call function="between">
          <column table="a" column="ym" />
          <call function="num to ym2">
            <useparam name="year" />
            <useparam name="mon1" />
          </call>
          <call function="num to ym2">
            <useparam name="year" />
            <useparam name="mon2" />
          </call>
        </call>
        <const>0</const>
      </call>
      <call function="case" as="pr_check_plan_fact" title="Группа" type="number">
        <call function="when">
          <call function="is not null">
            <column table="check_pl_ft" column="pr_plan" />
          </call>
          <const>1</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="is null">
              <column table="check_pl_ft" column="pr_plan" />
            </call>
            <call function="is not null">
              <column table="check_pl_ft" column="pr_fact" />
            </call>
          </call>
          <const>2</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="is null">
              <column table="check_pl_ft" column="pr_plan" />
            </call>
            <call function="is null">
              <column table="check_pl_ft" column="pr_fact" />
            </call>
          </call>
          <const>3</const>
        </call>
      </call>
      <call function="if" as="gr_check_plan_fact" group="16" title="Группа" type="number">
        <call function="or">
          <call function="false" />
          <call function="=1" optional="1">
            <useparam name="pr_pf_gr" />
          </call>
        </call>
        <column table="this" column="pr_check_plan_fact" />
        <const>0</const>
      </call>
      <call function="decode" as="gr_check_plan_fact_name" group="gr_check_plan_fact" title="Группа" type="string">
        <column table="this" column="gr_check_plan_fact" />
        <const>0</const>
        <const>'Все'</const>
        <const>1</const>
        <const>'1. Титулы, имеющие плановые экономические или физические параметры'</const>
        <const>2</const>
        <const>'2. Титулы, не имеющие плановых экономических или физических параметров, но имеющие фактические плановые экономические или физические параметры'</const>
        <const>3</const>
        <const>'3. Не имеющие плановых экономических или физических параметров, а также не имеющие фактических плановых экономических или физических параметров'</const>
      </call>
    </part>
    <part id="26630-if-all" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <if title=" за отчетный период">
        <call function="between">
          <column table="a" column="ym" />
          <call function="num to ym2">
            <useparam name="year" />
            <useparam name="mon1" />
          </call>
          <call function="num to ym2">
            <useparam name="year" />
            <useparam name="mon2" />
          </call>
        </call>
      </if>
    </part>
    <part id="26630-if-god" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <if title=" за год">
        <call function="=">
          <column table="a" column="year" />
          <useparam name="year" />
        </call>
      </if>
    </part>
    <part id="26630-if-ng" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <section title=" на начало отчетного периода" pfx="_ng">
        <call function="ym2 add month">
          <call function="num to ym2">
            <useparam name="year" />
            <useparam name="mon1" />
          </call>
          <const>-1</const>
        </call>
      </section>
    </part>
    <part id="26630-if-eg" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <section title=" на конец отчетного периода" pfx="_eg">
        <call function="num to ym2">
          <useparam name="year" />
          <useparam name="mon2" />
        </call>
      </section>
    </part>
    <part id="26630-dim-period" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <pivot title=" по периодам">
        <call function="between">
          <column table="a" column="ym" />
          <column table="dim" column="ym1" />
          <column table="dim" column="ym2" />
        </call>
        <query>
          <select>
            <column table="a" column="in_year_id" />
            <column table="a" column="name" />
            <call function="date to ym2" as="ym1">
              <column table="a" column="date_begin" />
            </call>
            <call function="date to ym2" as="ym2">
              <column table="a" column="date_end" />
            </call>
          </select>
          <from>
            <query name="26630_time_intervals" as="a">
              <withparams>
                <useparam name="year" />
                <useparam name="mon1" />
                <useparam name="mon2" />
              </withparams>
            </query>
          </from>
          <where>
            <call function="in">
              <column table="a" column="kod" />
              <useparam name="period" />
            </call>
          </where>
        </query>
      </pivot>
    </part>
    <part id="29611-params" timestamp="24.10.2016 11:01:48" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <param name="year" />
      <param name="kv" />
      <param name="kod_doc" />
      <param name="kod_direct" />
      <param name="kod_dirisp" />
      <param name="pr_notaip" />
      <param name="pr_gorobl" />
      <param name="krit_autor" />
      <param name="pr_sbor" />
      <param name="mes" />
      <param name="pr_aip_detail" />
      <param name="kod_ofz" />
    </part>
    <part id="29611-withparams" timestamp="24.10.2016 11:02:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="kv" />
        <useparam name="kod_doc" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_notaip" />
        <useparam name="pr_gorobl" />
        <useparam name="krit_autor" />
        <useparam name="pr_sbor" />
        <useparam name="mes" />
        <useparam name="pr_aip_detail" />
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="30576_dat_doc" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <params>
        <param name="kod_doc_type" />
      </params>
      <call function="if" type="date">
        <call function="=">
          <column table="kod_doc" column="kod_doc_type" />
          <useparam name="kod_doc_type" />
        </call>
        <column table="kod_doc" column="doc_date" />
      </call>
    </part>
    <part id="30576_num_doc" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <params>
        <param name="kod_doc_type" />
      </params>
      <call function="if">
        <call function="=">
          <column table="kod_doc" column="kod_doc_type" />
          <useparam name="kod_doc_type" />
        </call>
        <column table="kod_doc" column="doc_num" />
      </call>
    </part>
    <part id="30581-qry-podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <query order="name_direct">
        <select>
          <column table="a" column="kod_direct" />
          <column table="a" column="name_kr_direct" as="name_direct" />
        </select>
        <from>
          <query name="25499-ipr_direct" as="a" />
        </from>
        <where>
          <usepart part="30581-cond-podr" />
        </where>
      </query>
    </part>
    <part id="30581-cond-podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <call function="and">
        <call function="true" />
        <call function="in" optional="1">
          <column table="a" column="kod_direct" />
          <useparam name="kod_direct" />
        </call>
      </call>
    </part>
    <part id="30581-pivot-podr-year" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="dat" />
      </params>
      <pivot>
        <call function="and">
          <call function="=">
            <call function="year">
              <useparam name="datef" />
            </call>
            <call function="year">
              <useparam name="dat" />
            </call>
          </call>
          <call function="=">
            <column table="dim" column="kod_direct" />
            <column table="this" column="kod_podr" />
          </call>
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>1</const>
          </call>
        </call>
        <query>
          <select>
            <column table="a" column="*" />
          </select>
          <from>
            <usepart part="30581-qry-podr" as="a" />
          </from>
        </query>
      </pivot>
    </part>
    <part id="30581-pivot-podr" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <pivot>
        <call function="and">
          <call function="=">
            <column table="dim" column="kod_direct" />
            <column table="this" column="kod_podr" />
          </call>
        </call>
        <query>
          <select>
            <column table="a" column="*" />
          </select>
          <from>
            <usepart part="30581-qry-podr" as="a" />
          </from>
        </query>
      </pivot>
    </part>
    <part id="30581-pivot-podr-kv" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="dat" />
      </params>
      <pivot>
        <call function="and">
          <call function="=">
            <call function="year">
              <useparam name="datef" />
            </call>
            <call function="year">
              <useparam name="dat" />
            </call>
          </call>
          <call function="le">
            <call function="date to kv">
              <useparam name="dat" />
            </call>
            <column table="dim" column="id" />
          </call>
          <call function="=">
            <column table="dim" column="kod_direct" />
            <column table="this" column="kod_podr" />
          </call>
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>1</const>
          </call>
        </call>
        <query>
          <select>
            <call function="||" as="kod">
              <column table="a" column="kod_direct" />
              <const>'_'</const>
              <column table="kv" column="id" />
            </call>
            <call function="||" as="title">
              <column table="a" column="name_direct" />
              <const>' '</const>
              <column table="kv" column="name" />
            </call>
            <column table="a" column="kod_direct" />
            <column table="kv" column="id" />
          </select>
          <from>
            <usepart part="30581-qry-podr" as="a" />
            <query name="spr_time_kv" as="kv" join="cross" />
          </from>
        </query>
      </pivot>
    </part>
    <part id="30581-pivot-kv" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="dat" />
      </params>
      <pivot>
        <call function="and">
          <call function="=">
            <call function="year">
              <useparam name="datef" />
            </call>
            <call function="year">
              <useparam name="dat" />
            </call>
          </call>
          <call function="le">
            <call function="date to kv">
              <useparam name="dat" />
            </call>
            <column table="dim" column="id" />
          </call>
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>1</const>
          </call>
        </call>
        <query>
          <select>
            <column table="kv" column="*" />
          </select>
          <from>
            <query name="spr_time_kv" as="kv" />
          </from>
        </query>
      </pivot>
    </part>
    <part id="30581-if-year" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="dat" />
      </params>
      <if>
        <call function="and">
          <call function="=">
            <call function="year">
              <useparam name="datef" />
            </call>
            <call function="year">
              <useparam name="dat" />
            </call>
          </call>
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>1</const>
          </call>
        </call>
      </if>
    </part>
    <part id="30581-if-period" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <param name="dat" />
      </params>
      <if>
        <call function="and">
          <call function="=">
            <call function="year">
              <useparam name="datef" />
            </call>
            <call function="year">
              <useparam name="dat" />
            </call>
          </call>
          <call function="le">
            <useparam name="dat" />
            <useparam name="datef" />
          </call>
          <call function="=">
            <column table="ipr_contr_steps_val_ord" column="last_level" />
            <const>1</const>
          </call>
        </call>
      </if>
    </part>
    <part id="30581-params" timestamp="17.04.2017 18:30:32" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <param name="date">
        <const>to_date('31.03.2017','DD.MM.YYYY')</const>
      </param>
      <param name="datef">
        <const>to_date('31.03.2017','DD.MM.YYYY')</const>
      </param>
      <param name="kod_doc">
        <const>242796</const>
      </param>
      <param name="kod_direct" />
      <param name="kod_dirisp">
        <const>2</const>
      </param>
      <param name="pr_svod" />
      <param name="kod_doc_kontr">
        <const>(242476)</const>
      </param>
      <param name="pr_detail">
        <const>1</const>
      </param>
      <param name="kod_titul_ip">
        <const>15555</const>
      </param>
      <param name="kod_name_tmp">
        <const>2</const>
      </param>
      <param name="pr_gorobl" />
      <param name="kod_klass_titul" />
      <param name="kod_ofz" />
    </part>
    <part id="30581-withparams" timestamp="21.10.2016 18:29:04" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <withparams>
        <useparam name="date" />
        <useparam name="datef" />
        <useparam name="kod_doc" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_svod" />
        <useparam name="kod_doc_kontr" />
        <useparam name="pr_detail" />
        <useparam name="kod_titul_ip" />
        <useparam name="kod_name_tmp" />
        <useparam name="pr_gorobl" />
        <useparam name="kod_klass_titul" />
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="30581-params-typed" timestamp="28.03.2017 13:16:26" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <param name="date" type="date">
        <const>sysdate</const>
      </param>
      <param name="datef" type="date">
        <const>sysdate</const>
      </param>
      <param name="kod_doc" type="number">
        <const>43383</const>
      </param>
      <param name="kod_direct" type="array" />
      <param name="kod_dirisp" type="number">
        <const>2</const>
      </param>
      <param name="pr_svod" type="number" />
      <param name="kod_doc_kontr" type="array" />
      <param name="pr_detail" type="number">
        <const>1</const>
      </param>
      <param name="kod_titul_ip" type="array">
        <const>7655</const>
      </param>
      <param name="kod_name_tmp" type="number" />
      <param name="pr_gorobl" type="number" />
      <param name="kod_klass_titul" type="array" />
      <param name="kod_ofz" type="array" />
    </part>
    <part id="30923-params" timestamp="13.12.2016 08:39:09" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <param name="doc_osn">
        <const>43383</const>
      </param>
      <param name="kod_direct" />
      <param name="kod_dirisp_all">
        <const>2</const>
      </param>
      <param name="pr_notaip" />
      <param name="pr_smet_detail">
        <const>1</const>
      </param>
      <param name="mp">
        <const>-3</const>
      </param>
      <param name="kod_curfixs" />
      <param name="kod_ofz" />
      <param name="show_dog" />
    </part>
    <part id="30923-withparams" timestamp="13.12.2016 08:39:23" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <withparams>
        <useparam name="doc_osn" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp_all" />
        <useparam name="pr_notaip" />
        <useparam name="pr_smet_detail" />
        <useparam name="mp" />
        <useparam name="kod_curfixs" />
        <useparam name="kod_ofz" />
        <useparam name="show_dog" />
      </withparams>
    </part>
    <part id="30923-smet_cols" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <param name="pfx" />
        <param name="clset" />
      </params>
      <column table="a" column="summ_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_10_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_30_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_psd[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_psd_10[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_psd_30[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_utvpsd[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_psd[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_psd_10[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_psd_30[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_10_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_30_usr[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="all_utvpsd[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <column table="a" column="summ_30_mva[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <call function="+nvl" as="all_km[:pfx]" colset="[:clset]" group="sum">
        <column table="a" column="summ_30_kl_km[:pfx]" colset="[:clset]" mp="[:mp]" />
        <column table="a" column="summ_30_vl_km[:pfx]" colset="[:clset]" mp="[:mp]" />
      </call>
      <column table="a" column="summ_k_rasp[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />
      <!--<column table="a" column="summ_k_rasp_old[:pfx]" as="summ_k_rasp[:pfx]" group="sum" colset="[:clset]" mp="[:mp]" />-->
    </part>
    <part id="30923-grset" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <param name="ngr" />
      </params>
      <grset as="smet[:ngr]" title="части сметы основные" level="5">
        <where>
          <call function="and">
            <call function="le">
              <column table="a" column="kod_smet" />
              <const>4</const>
            </call>
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_smet_detail" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
          </call>
        </where>
      </grset>
      <grset as="smet2[:ngr]" title="расшифровка сметы прочие" level="6">
        <where>
          <call function="and">
            <call function="between">
              <column table="a" column="kod_smet" />
              <const>4</const>
              <const>6</const>
            </call>
            <call function="is not null">
              <column table="a" column="kod_smet_sub" />
            </call>
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_smet_detail" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
          </call>
        </where>
      </grset>
      <grset as="smet_dop[:ngr]" title="части сметы дополнительные" level="5">
        <where>
          <call function="and">
            <call function="ge">
              <column table="a" column="kod_smet" />
              <const>100</const>
            </call>
            <call function="=">
              <call function="nvlu">
                <useparam name="pr_smet_detail" />
                <const>0</const>
              </call>
              <const>1</const>
            </call>
            <!--<call function="or">
              <call function="in" optional="1">
                <const>'Фиксированная'</const>
                <useparam name="kod_curfixs"/>
              </call>
              <call function="false"/>
            </call>-->
          </call>
        </where>
      </grset>
    </part>
    <part id="32274-params" timestamp="25.10.2016 15:47:23" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <param name="year">
        <const>2015</const>
      </param>
      <param name="mon1">
        <const>1</const>
      </param>
      <param name="mon2">
        <const>12</const>
      </param>
      <param name="kod_doc">
        <const>43383</const>
      </param>
      <param name="kod_subject" />
      <param name="kod_direct" />
      <param name="kod_dirisp" />
      <param name="pr_sbor" />
      <param name="pr_child" />
      <param name="pr_cognos" />
      <param name="pr_razdel7" />
      <param name="kod_titul_ip">
        <const>15177</const>
      </param>
      <param name="mp">
        <const>0</const>
      </param>
      <param name="kod_2subject" />
      <param name="kod_ofz" />
    </part>
    <part id="32274-withparams" timestamp="25.10.2016 15:47:33" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <useparam name="kod_2subject" />
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="32274-withparams-gor" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <const>0</const>
      </withparams>
    </part>
    <part id="32274-withparams-obl" timestamp="25.10.2016 15:48:28" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <const>1</const>
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="32443-params" timestamp="25.10.2016 15:47:58" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <param name="year">
        <const>2015</const>
      </param>
      <param name="mon1">
        <const>1</const>
      </param>
      <param name="mon2">
        <const>12</const>
      </param>
      <param name="kod_doc">
        <const>43383</const>
      </param>
      <param name="kod_subject" />
      <param name="kod_direct" />
      <param name="kod_dirisp" />
      <param name="pr_sbor" />
      <param name="pr_child" />
      <param name="pr_cognos" />
      <param name="pr_razdel7" />
      <param name="kod_titul_ip">
        <const>15177</const>
      </param>
      <param name="mp">
        <const>0</const>
      </param>
      <param name="kod_2subject" />
      <param name="kod_ofz" />
    </part>
    <part id="32443-withparams" timestamp="25.10.2016 11:28:29" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <useparam name="kod_2subject" />
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="32443-withparams-gor" timestamp="25.10.2016 11:32:51" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <const>0</const>
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="32443-withparams-obl" timestamp="25.10.2016 11:33:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <withparams>
        <useparam name="year" />
        <useparam name="mon1" />
        <useparam name="mon2" />
        <useparam name="kod_doc" />
        <useparam name="kod_subject" />
        <useparam name="kod_direct" />
        <useparam name="kod_dirisp" />
        <useparam name="pr_sbor" />
        <useparam name="pr_child" />
        <useparam name="pr_cognos" />
        <useparam name="pr_razdel7" />
        <useparam name="kod_titul_ip" />
        <useparam name="mp" />
        <const>1</const>
        <useparam name="kod_ofz" />
      </withparams>
    </part>
    <part id="38203-params" timestamp="06.04.2017 15:59:27" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <param name="year" />
      <param name="mon2" />
      <param name="period" />
      <param name="mon2w" />
      <param name="periodw" />
      <param name="pr_aip" />
      <param name="kod_doc" />
      <param name="mp" />
      <param name="pr_ip" />
      <param name="pr_aip_detail" />
      <param name="kod_direct" />
      <param name="kod_dirisp" />
      <param name="pr_sbor" />
      <param name="nvalue" />
      <param name="kod_ofz" />
      <param name="kod_titul_ip" />
      <param name="pr_no_zero" />
    </part>
    <part id="38203-withparams" timestamp="06.04.2017 15:59:45" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <useparam name="year" />
      <useparam name="mon2" />
      <useparam name="period" />
      <useparam name="mon2w" />
      <useparam name="periodw" />
      <useparam name="pr_aip" />
      <useparam name="kod_doc" />
      <useparam name="mp" />
      <useparam name="pr_ip" />
      <useparam name="pr_aip_detail" />
      <useparam name="kod_direct" />
      <useparam name="kod_dirisp" />
      <useparam name="pr_sbor" />
      <useparam name="nvalue" />
      <useparam name="kod_ofz" />
      <useparam name="kod_titul_ip" />
      <useparam name="pr_no_zero" />
    </part>
    <part id="41656-params" timestamp="09.11.2017 19:38:08" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <param name="kod_direct" type="array" />
      <param name="kod_titul_ip" type="array">
        <const>10907</const>
      </param>
      <param name="dat" type="date">
        <const>to_date('09.11.2017','DD.MM.YYYY')</const>
      </param>
      <param name="plan_type" type="number">
        <const>1</const>
      </param>
      <param name="week" type="number">
        <const>36</const>
      </param>
      <param name="month" type="number">
        <const>9</const>
      </param>
      <param name="year" type="number">
        <const>2017</const>
      </param>
      <param name="id_slice" type="number">
        <const>411</const>
      </param>
      <param name="prev_week" type="number">
        <const>35</const>
      </param>
      <param name="id_slice_prev_week" type="number">
        <const>404</const>
      </param>
      <param name="id_slice_all" type="array">
        <const>(404,411)</const>
      </param>
      <param name="month_next" type="number">
        <const>10</const>
      </param>
      <param name="year_month_next" type="number">
        <const>2017</const>
      </param>
    </part>
    <part id="41656-useparams" timestamp="02.10.2017 19:17:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <useparam name="kod_direct" />
      <useparam name="kod_titul_ip" />
      <useparam name="dat" />
      <useparam name="plan_type" />
      <useparam name="week" />
      <useparam name="month" />
      <useparam name="year" />
      <useparam name="id_slice" />
      <useparam name="prev_week" />
      <useparam name="id_slice_prev_week" />
      <useparam name="id_slice_all" />
      <useparam name="month_next" />
      <useparam name="year_month_next" />
    </part>
    <part id="41656-cmn-where-tituls" timestamp="02.10.2017 19:17:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <call function="=">
        <column table="ipr_kod_titul_ip" column="pr_41656" />
        <const>1</const>
      </call>
      <call function="in" comment="данные только по титулам с филиалами-исполнителями КС, ВЭС, ГтЭС, КнЭС, НлЭС, ПрЭС, ТхЭС">
        <column table="ipr_kod_titul_ip" column="kod_ispolnit" />
        <call function="array">
          <const>19</const>
          <const>20</const>
          <const>21</const>
          <const>22</const>
          <const>24</const>
          <const>26</const>
          <const>27</const>
        </call>
      </call>
      <call function="in" optional="1">
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
        <useparam name="kod_titul_ip" />
      </call>
    </part>
    <part id="41656-cmn-events" timestamp="02.10.2017 19:17:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="ad_count_plan_mes">
        <usepart part="41656-useparams" />
      </useaction>
      <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="ad_count_fact_mes">
        <usepart part="41656-useparams" />
      </useaction>
      <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="ad_count_fact_mes_prev">
        <usepart part="41656-useparams" />
      </useaction>
      <useaction event-name="double-click" column="dep_name" />
      <useaction event-name="double-click" column="res_name" />
    </part>
    <part id="41656-cmn-expressions" timestamp="02.10.2017 19:17:14" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <call function="is null" as="cond_tituls_absent" dontpushpred="1">
        <column table="ipr_kod_titul_ip" column="kod_titul_ip" />
      </call>
      <call function="()" as="isv_ad_evd_no_tits_count" group="sum">
        <fact column="isv_ad_evd_count" condition="cond_tituls_absent" />
      </call>
      <call function="=" as="hoz_vl_1c" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>621</const>
      </call>
      <call function="=" as="hoz_vl_2c" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>901</const>
      </call>
      <call function="=" as="hoz_kl" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>781</const>
      </call>
      <call function="=" as="hoz_mba" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>622</const>
      </call>
      <call function="=" as="hoz_cnt" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>624</const>
      </call>
      <call function="=" as="hoz_cnt_pr" dontpushpred="1">
        <column table="ipr_kod_hoz_sposob" column="kod_character" />
        <const>623</const>
      </call>
      <call function="()" as="km_vl_1c_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_vl_1c" />
      </call>
      <call function="()" as="km_vl_2c_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_vl_2c" />
      </call>
      <call function="()" as="km_kl_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_kl" />
      </call>
      <call function="()" as="km_mba_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_mba" />
      </call>
      <call function="()" as="km_cnt_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_cnt" />
      </call>
      <call function="()" as="km_cnt_pr_fact" group="sum">
        <fact column="ipr_hoz_sposob_val" condition="hoz_cnt_pr" />
      </call>
    </part>
    <part id="41656-cmn-columns" timestamp="23.01.2018 14:06:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <column table="evd_kod_filial_tit" column="kod_direct" agg="no" />
      <column column="kod_direct" as="kod_res" table="evd_kodres" agg="no" />
      <column table="ipr_filial_res_valid" as="filial_res_valid" column="val" agg="no" />
      <call function="dense_rank" as="rank" group="max" agg="no">
        <call function="partition by">
          <column table="this" column="filial_res_valid" />
        </call>
        <call function="order by 2">
          <column table="evd_kod_filial_tit" column="name_kr" />
        </call>
      </call>
      <column table="evd_kod_filial_tit" column="name_kr" title="Отделение" as="dep_name" group="max" agg="no" />
      <column table="evd_kodres" column="name_kr" title="РЭС" as="res_name" group="max" agg="no" />
      <fact column="ipr_titul_ip_count" group="sum" title="План за год. Кол-во объектов" as="obj_count_plan" table="titul" nvl="0" agg="no" />
      <fact column="isv_ad_evd_count" as="ad_count_plan" title="План за год. Кол-во Заявителей" group="sum" nvl="0" table="main" agg="no" />
      <fact column="isv_ad_evd_no_tits_count" as="no_tits_count_plan" title="План за год. Не привяз. к объекту" group="sum" nvl="0" table="main" agg="no" />
      <fact column="ipr_titul_ip_count" group="sum" title="План за месяц. Кол-во объектов" as="obj_count_plan_mes" table="titul_mes" nvl="0" agg="no" />
      <fact column="isv_ad_evd_count" as="ad_count_plan_mes" title="План за месяц. Кол-во Заявителей" group="sum" table="titul_mes" nvl="0" agg="no" />
      <call function="case" as="km_vl_1c_pp_mes" type="number" title="План за месяц. ВЛ 1-цепные км" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_km_vl_1c" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_km_vl_1c_wfact" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <call function="case" as="km_vl_2c_pp_mes" type="number" title="План за месяц. ВЛ 2-цепные км" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_km_vl_2c" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_km_vl_2c_wfact" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <call function="case" as="km_kl_pp_mes" type="number" title="План за месяц. КЛ км" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_km_kl" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_km_kl_wfact" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <call function="case" as="km_mba_pp_mes" type="number" title="План за месяц. МВА" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_mba" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_mba_wfact" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <call function="case" as="km_cnt_pp_mes" type="number" title="План за месяц. шт. (ПС, ТП)" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_cnt" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_cnt_wfact" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <call function="case" as="km_cnt_pr_pp_mes" type="number" title="План за месяц. шт. (прочие)" group="sum" agg="no">
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>1</const>
          </call>
          <fact column="ipr_vvod_fiz_cnt_proch" nvl="0" table="vvod_mes" />
        </call>
        <call function="when">
          <call function="=">
            <useparam name="plan_type" />
            <const>2</const>
          </call>
          <fact column="ipr_vvod_fiz_cnt_wfact_pr" nvl="0" table="vvod_mes" />
        </call>
      </call>
      <fact column="ipr_titul_ip_count" group="sum" title="Факт за месяц на текущ неделю. Кол-во объектов" as="obj_count_fact_mes" table="hoz_mes" nvl="0" agg="no" />
      <fact column="isv_ad_evd_count" as="ad_count_fact_mes" group="sum" title="Факт за месяц на текущ неделю. Кол-во Заявителей" nvl="0" table="hoz_mes" agg="no" />
      <fact column="km_vl_1c_fact" as="km_vl_1c_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, ВЛ 1-цепные км" table="hoz_mes" agg="no" />
      <fact column="km_vl_2c_fact" as="km_vl_2c_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, ВЛ 2-цепные км" table="hoz_mes" agg="no" />
      <fact column="km_kl_fact" as="km_kl_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, КЛ км" table="hoz_mes" agg="no" />
      <fact column="km_mba_fact" as="km_mba_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, МВА" table="hoz_mes" agg="no" />
      <fact column="km_cnt_fact" as="km_cnt_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, шт. (ПС, ТП)" table="hoz_mes" agg="no" />
      <fact column="km_cnt_pr_fact" as="km_cnt_pr_fact_mes" group="sum" nvl="0" title="Факт за месяц на текущ неделю, шт. (прочие)" table="hoz_mes" agg="no" />
      <call function="+nvl" as="perc" nvl="0" agg="no" title="Коэфициент успеха">
        <call function="/" title="Процент за месяц, Кол-во объектов" nvl="0">
          <column table="this" column="obj_count_fact_mes" title=" " />
          <column table="this" column="obj_count_plan_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, Кол-во Заявителей" nvl="0">
          <column table="this" column="ad_count_fact_mes" title=" " />
          <column table="this" column="ad_count_plan_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, ВЛ 1-цепные км" nvl="0">
          <column table="this" column="km_vl_1c_fact_mes" title=" " />
          <column table="this" column="km_vl_1c_pp_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, ВЛ 2-цепные км" nvl="0">
          <column table="this" column="km_vl_2c_fact_mes" title=" " />
          <column table="this" column="km_vl_2c_pp_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, КЛ" nvl="0">
          <column table="this" column="km_kl_fact_mes" title=" " />
          <column table="this" column="km_kl_pp_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, МВА" nvl="0">
          <column table="this" column="km_mba_fact_mes" title=" " />
          <column table="this" column="km_mba_pp_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, (ПС, ТП)" nvl="0">
          <column table="this" column="km_cnt_fact_mes" title=" " />
          <column table="this" column="km_cnt_pp_mes" title=" " />
        </call>
        <call function="/" title="Процент за месяц, (прочие)" nvl="0">
          <column table="this" column="km_cnt_pr_fact_mes" title=" " />
          <column table="this" column="km_cnt_pr_pp_mes" title=" " />
        </call>
      </call>
      <call function="over" as="res_perc" agg="no" title="Суммарный процент по РЭС">
        <call function="max">
          <column table="this" column="perc" />
        </call>
        <call function="partition by">
          <column table="evd_kodres" column="kod_direct" />
        </call>
      </call>
      <call function="over" as="filial_perc" agg="no" title="Суммарный процент по филиалу">
        <call function="max">
          <column table="this" column="perc" />
        </call>
        <call function="partition by">
          <column table="evd_kod_filial_tit" column="kod_direct" />
        </call>
      </call>
      <call function="dense_rank" as="res_rank" agg="no" title="Рейтинг по РЭС">
        <call function="order by 2">
          <call function="desc nulls last">
            <column table="this" column="res_perc" />
          </call>
        </call>
      </call>
      <call function="dense_rank" as="filial_rank" agg="no" title="Рейтинг по филиалу">
        <call function="order by 2">
          <call function="desc nulls last">
            <column table="this" column="filial_perc" />
          </call>
        </call>
      </call>
    </part>
    <part id="41656-cmn-links" timestamp="23.01.2018 14:17:32" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <link name="evd_kod_filial_tit" />
      <link name="evd_kodres" />
      <link name="evd_pr_hoz_sposob" only-for-cond="1" />
      <link name="id_slice" only-for-cond="1" />
      <link name="evd_pr_vip" only-for-cond="1" />
      <link name="evd_pr_ostatok" only-for-cond="1" />
      <link name="evd_year_srok" only-for-cond="1" />
      <link name="evd_otch_list_3" only-for-cond="1" />
      <link name="evd_fl_build" only-for-cond="1" />
      <link name="evd_dt_contract" only-for-cond="1" />
      <link name="kod_isv_ad_evd" only-for-cond="1" />
      <link name="ipr_filial_res_valid" />
      <dimset as="titul_mes">
        <link name="ipr_kod_titul_ip" only-for-cond="1" />
        <link name="ipr_vvod_fiz" only-for-cond="1" />
        <where>
          <call function="and">
            <usepart part="41656-cmn-where-tituls" />
            <call function="=">
              <column table="ipr_vvod_fiz" column="ym" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="month" />
              </call>
            </call>
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </where>
      </dimset>
      <dimset as="vvod_mes">
        <link name="ipr_ym" only-for-cond="1" />
        <link name="ipr_kod_titul_ip" only-for-cond="1" />
        <where>
          <call function="and">
            <usepart part="41656-cmn-where-tituls" />
            <call function="=">
              <column table="ipr_ym" column="val" />
              <call function="num to ym2">
                <useparam name="year" />
                <useparam name="month" />
              </call>
            </call>
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </where>
      </dimset>
      <dimset as="hoz_mes">
        <link name="ipr_kod_titul_ip" only-for-cond="1" />
        <link name="ipr_kod_hoz_sposob" only-for-cond="1" />
        <where>
          <call function="and">
            <usepart part="41656-cmn-where-tituls" />
            <call function="=">
              <column table="ipr_kod_hoz_sposob" column="year" />
              <useparam name="year" />
            </call>
            <call function="=">
              <column table="ipr_kod_hoz_sposob" column="month" />
              <useparam name="month" />
            </call>
            <call function="le">
              <column table="ipr_kod_hoz_sposob" column="week" />
              <useparam name="week" />
            </call>
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </where>
      </dimset>
      <dimset as="titul">
        <link name="ipr_kod_titul_ip" only-for-cond="1" />
        <where>
          <call function="and">
            <usepart part="41656-cmn-where-tituls" />
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </where>
      </dimset>
      <dimset as="main">
        <where>
          <call function="and">
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </where>
      </dimset>
    </part>
    <part id="41656-cmn-where" timestamp="22.01.2018 20:01:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <call function="=">
        <call function="nvl0">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <const>1</const>
      </call>
      <call function="or">
        <call function="=">
          <column table="evd_pr_vip" column="val" />
          <const>1</const>
        </call>
        <call function="=">
          <column table="evd_pr_ostatok" column="val" />
          <const>1</const>
        </call>
      </call>
      <call function="le">
        <column table="evd_year_srok" column="val" />
        <useparam name="year" />
      </call>
      <call function="or">
        <call function="=">
          <column table="evd_otch_list_3" column="val" />
          <const>1</const>
        </call>
        <call function="and">
          <call function="=">
            <call function="year">
              <column table="evd_dt_contract" column="val" />
            </call>
            <useparam name="year" />
          </call>
          <call function="is null">
            <column table="kod_isv_ad_evd" column="kod_org_active" />
          </call>
        </call>
      </call>
      <call function="=">
        <column table="evd_fl_build" column="val" />
        <const>1</const>
      </call>
      <call function="in" optional="1">
        <column table="evd_kod_filial_tit" column="kod_direct" />
        <useparam name="kod_direct" />
      </call>
    </part>
    <part id="41656-cmn-grouping" timestamp="05.12.2017 18:17:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <grset as="all" title="Всего">
        <grset title="По филиалам" as="dep" order="dep_name">
          <group>
            <sourcelink table="evd_kod_filial_tit" />
          </group>
          <where>
            <call function="=">
              <column table="this" column="filial_res_valid" />
              <const>1</const>
            </call>
          </where>
          <grset title="По РЭС" as="res" order="res_name">
            <group>
              <sourcelink table="evd_kodres" />
            </group>
          </grset>
        </grset>
        <grset as="all_nv" title="Всего - Левый РЭС">
          <where>
            <call function="=">
              <column table="this" column="filial_res_valid" />
              <const>0</const>
            </call>
          </where>
        </grset>
      </grset>
    </part>
    <part id="29265-params" timestamp="16.03.2018 13:09:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <param name="kod_doc">
        <const>56042</const>
      </param>
      <param name="dat">
        <const>sysdate</const>
      </param>
      <param name="kod_dirisp">
        <const>2</const>
      </param>
      <param name="kod_direct" />
      <param name="kod_subject" />
      <param name="cmn_date_cur" />
      <param name="dat_dog_s" />
      <param name="dat_dog_po" />
      <param name="pr_notaip" />
      <param name="kod_titul_ip" />
      <param name="is_show_akt" />
      <param name="mp">
        <const>-3</const>
      </param>
      <param name="kod_ofz" />
      <param name="kod_status_tit" />
    </part>
    <part id="29265-withparams" timestamp="16.03.2018 13:11:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <useparam name="kod_doc" />
      <useparam name="dat" />
      <useparam name="kod_dirisp" />
      <useparam name="kod_direct" />
      <useparam name="kod_subject" />
      <useparam name="cmn_date_cur" />
      <useparam name="dat_dog_s" />
      <useparam name="dat_dog_po" />
      <useparam name="pr_notaip" />
      <useparam name="kod_titul_ip" />
      <useparam name="is_show_akt" />
      <useparam name="mp" />
      <useparam name="kod_ofz" />
      <useparam name="kod_status_tit" />
    </part>
    <part id="34188-params" timestamp="25.12.2017 13:01:38" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <param name="kod_doc">
        <const>43383</const>
      </param>
      <param name="kod_dirisp">
        <const exclude="1">2</const>
      </param>
      <param name="kod_direct" />
      <param name="kod_subject" />
      <param name="pr_notaip" />
      <param name="pr_sbor" />
      <param name="pr_child" />
      <param name="kod_titul_ip">
        <array>
          <const>143403</const>
        </array>
      </param>
      <param name="doc_type" />
      <param name="kod_ofz" />
      <param name="kod_status_tit" />
      <param name="dat_doc_s" />
      <param name="dat_doc_po" />
    </part>
    <part id="34188-withparams" timestamp="25.12.2017 13:01:57" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <useparam name="kod_doc" />
      <useparam name="kod_dirisp" />
      <useparam name="kod_direct" />
      <useparam name="kod_subject" />
      <useparam name="pr_notaip" />
      <useparam name="pr_sbor" />
      <useparam name="pr_child" />
      <useparam name="kod_titul_ip" />
      <useparam name="doc_type" />
      <useparam name="kod_ofz" />
      <useparam name="kod_status_tit" />
      <useparam name="dat_doc_s" />
      <useparam name="dat_doc_po" />
    </part>
    <part id="38486-params" timestamp="30.11.2016 18:55:09" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <param name="kod_doc">
        <const>143403</const>
      </param>
      <param name="dat">
        <const>sysdate</const>
      </param>
      <param name="kod_dirisp">
        <const>2</const>
      </param>
      <param name="kod_direct" />
      <param name="kod_subject" />
      <param name="cmn_date_cur" />
      <param name="pr_notaip" />
      <param name="kod_titul_ip" />
      <param name="is_show_akt" exclude="1" />
      <param name="mp">
        <const>-3</const>
      </param>
      <param name="kod_ofz" />
      <param name="is_bez_nds" />
      <param name="tekfix" />
    </part>
    <part id="38486-withparams" timestamp="30.11.2016 18:55:16" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <useparam name="kod_doc" />
      <useparam name="dat" />
      <useparam name="kod_dirisp" />
      <useparam name="kod_direct" />
      <useparam name="kod_subject" />
      <useparam name="cmn_date_cur" />
      <useparam name="pr_notaip" />
      <useparam name="kod_titul_ip" />
      <useparam name="is_show_akt" exclude="1" />
      <useparam name="mp" />
      <useparam name="kod_ofz" />
      <useparam name="is_bez_nds" />
      <useparam name="tekfix" />
    </part>
    <part id="39463-fields1" timestamp="22.05.2018 18:51:25" comment="41356(3)" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_params_visible">
        <defaultquery>
          <query name="39463-kod-doc-corr-visible" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" title="Горизонт планирования N+" name="goriz_plan" max-length="2" column-mandatory="1">
        <defaultquery>
          <query name="39463-goriz_plan-default" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_combo_num" name="god_info" title="Год Х раскрытия информации" column-mandatory="1">
        <listquery>
          <query name="39463-years-list" />
        </listquery>
        <defaultquery>
          <query name="39463-ipr-year" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" title="Кол-во лет, от года Х для поквартального раскрытия информации" name="god_x" max-length="2" column-mandatory="0">
        <defaultquery>
          <query name="39463-god_x-default" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_combo_num" name="god_last_ipr" title="Последний год утвержденной ИПР" column-mandatory="1">
        <listquery>
          <query name="39463-years-list" />
        </listquery>
        <defaultquery>
          <query name="39463-ipr-year" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" visible="1" />
      <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов вместо Факта" visible="kod_doc_corr_visible" visible-invert="1" />
      <usefield field="cmn_check" title="Использование Лимитов и Приростов физ. характеристик вместо Плана" name="use_fiz_limits" visible="1">
        <defaultquery>
          <query name="one" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_check" name="use_fiz_limits_ft" title="Использование Лимитов и Приростов физ. характеристик вместо Факта" visible="kod_doc_corr_visible" visible-invert="1" />
      <usefield field="cmn_check" title="Расшифровка источников финансирования (графы 3-7,9-12,14-17) раздела 6.2." name="rassh_ist_fin62" />
      <usefield field="cmn_check" title="Расшифровка видов затрат освоения КВЛ (графы 3-7,9-12,14-17) раздела 6.2." name="rassh_vid_zatr62" />
      <fieldgroup title="Не формировать паспорта ИП с нулевыми данными">
        <usefield field="cmn_check" name="pr_not_null" title="Применить" />
        <usefield field="ipr_ym" name="not_null_ym1" title="С" mandatory="pr_not_null" editable="pr_not_null">
          <defaultquery>
            <query name="spr_time_ym2_beg_year" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_ym" name="not_null_ym2" title="По" mandatory="pr_not_null" editable="pr_not_null">
          <defaultquery>
            <query name="spr_time_ym2_cur" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <usefield field="cmn_check" title="Не выводить букву в наименовании Паспорта ИП" name="pasp_hide_letter" />
    </part>
    <part id="30196-if-dir-list" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="kod_dir" type="number" />
      </params>
      <if pfx="_[:kod_dir]">
        <call function="and">
          <call function="in">
            <column table="kod_person" column="kod_direct" />
            <query>
              <select>
                <column table="a" column="kod_direct" />
              </select>
              <from>
                <query name="is_spr_direct-listchild" as="a">
                  <withparams>
                    <useparam name="kod_dir" />
                  </withparams>
                </query>
              </from>
            </query>
          </call>
          <call function="not in">
            <column table="a" column="kod_spr_viz" />
            <array>4,6,131,37,141,125,133</array>
          </call>
        </call>
      </if>
    </part>
    <part id="30196-if-dir" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="kod_dir" type="number" />
      </params>
      <if pfx="_[:kod_dir]">
        <call function="and">
          <call function="in">
            <column table="kod_person" column="kod_direct" />
            <useparam name="kod_dir" />
          </call>
          <call function="not in">
            <column table="a" column="kod_spr_viz" />
            <array>4,6,131,37,141,125,133</array>
          </call>
        </call>
      </if>
    </part>
    <part id="30196-if-depart" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="kod_depart" type="number" />
      </params>
      <if pfx="_other">
        <call function="and">
          <call function="in">
            <column table="this" column="n_department_a" />
            <useparam name="kod_depart" />
          </call>
          <call function="not in">
            <column table="a" column="kod_spr_viz" />
            <array>4,6,131,37,141,125,133</array>
          </call>
        </call>
      </if>
    </part>
    <part id="30196-if-viz" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="kod_spr_viz" type="array" />
      </params>
      <if>
        <call function="in">
          <column table="a" column="kod_spr_viz" />
          <useparam name="kod_spr_viz" />
        </call>
      </if>
    </part>
    <part id="30196-if-viz-notnull" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="kod_spr_viz" type="array" />
      </params>
      <if>
        <call function="and">
          <call function="in">
            <column table="a" column="kod_spr_viz" />
            <useparam name="kod_spr_viz" />
          </call>
          <call function="is not null">
            <column table="a" column="dat_viz" />
          </call>
          <!--<call function="=">
            <call function="qg_settings_read.f_is_contains_value_nb">
              <call function="to_char">
                <column table="a" column="kod_person" />
              </call>
            </call>
            <const>1</const>
          </call>-->
          <!--<call function="in">
            <column table="a" column="kod_person" />
            <array>301394</array>
          </call>-->
        </call>
      </if>
    </part>
    <part id="33535-params" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <param name="year">
        <const>2014</const>
      </param>
    </part>
    <part id="33535-useparams" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <useparam name="year" />
    </part>
    <part id="41293-params" timestamp="03.09.2018 16:00:44" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <param name="id_slice" type="number" />
    </part>
    <part id="41293-withparams" timestamp="18.04.2017 12:36:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <useparam name="id_slice" />
    </part>
    <part id="41293-params-ext" timestamp="20.11.2018 15:54:41" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <param name="num_req" type="array" />
      <param name="kod_dop_contr_filtr" type="array" />
      <param name="key" type="array" />
      <param name="kod_dop_contract" type="array" />
    </part>
    <part id="41293-withparams-ext" timestamp="20.11.2018 15:54:41" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <useparam name="num_req" />
      <useparam name="kod_dop_contr_filtr" />
      <useparam name="key" />
      <useparam name="kod_dop_contract" />
    </part>
    <part id="42415-grsets" timestamp="13.06.2017 16:04:50" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\42415.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]vsego">
        <group>
          <sourcelink table="year" />
        </group>
        <where>
          <call function="=">
            <column table="this" column="col_2" />
            <const>'Всего'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]lg">
        <group>
          <sourcelink table="year" />
        </group>
        <where>
          <call function="=">
            <column table="this" column="col_2" />
            <const>'Льготные (по ставке 550 руб)'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]fl">
        <group>
          <sourcelink table="year" />
        </group>
        <where>
          <call function="=">
            <column table="this" column="col_2" />
            <const>'Тарифные (Физ.лица)'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ul">
        <group>
          <sourcelink table="year" />
        </group>
        <where>
          <call function="=">
            <column table="this" column="col_2" />
            <const>'Тарифные (Юр.лица)'</const>
          </call>
        </where>
      </grset>
    </part>
    <part id="43430-params" timestamp="17.01.2019 14:09:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <param name="kod_predpr" type="array" />
      <param name="p_date_s" type="date" />
      <param name="p_date_po" type="date" />
    </part>
    <part id="43430-useparams" timestamp="17.01.2019 14:09:32" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <useparam name="kod_predpr" />
      <useparam name="p_date_s" />
      <useparam name="p_date_po" />
    </part>
    <part id="33535-f1-params" timestamp="18.04.2017 12:36:40" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <param name="id_slice" type="number" />
    </part>
    <part id="33535-f1-withparams" timestamp="18.04.2017 12:36:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <useparam name="id_slice" />
    </part>
    <part id="33535-f4-params" timestamp="18.04.2017 12:36:40" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <param name="id_slice" type="number" />
      <param name="kod_ispolnit" type="number" />
    </part>
    <part id="33535-f4-withparams" timestamp="18.04.2017 12:36:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <useparam name="id_slice" />
      <useparam name="kod_ispolnit" />
    </part>
    <part id="33535-f1-grsets" timestamp="24.05.2017 17:02:09" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]ls15" title="до 15 кВт">
        <where>
          <call function="and">
            <call function="le">
              <column column="sum_load" table="this" />
              <const>15</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]ls15_fiz" title="до 15 кВт физ. лица">
          <where>
            <call function="and">
              <call function="=0">
                <column column="ur_lico" table="this" />
              </call>
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]15to150" title="свыше 15 и до 150 кВт">
        <where>
          <call function="and">
            <call function="gt">
              <column column="sum_load" table="this" />
              <const>15</const>
            </call>
            <call function="le">
              <column column="sum_load" table="this" />
              <const>150</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]15to150_dc" title="свыше 15 и до 150 кВт с льготами">
          <where>
            <call function="=1">
              <column table="this" column="fl_discount" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
          <where>
            <call function="=1">
              <column table="this" column="pr_cnt_mes" />
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]150to670" title="свыше 150 кВт и менее 670 кВт">
        <where>
          <call function="and">
            <call function="gt">
              <column column="sum_load" table="this" />
              <const>150</const>
            </call>
            <call function="lt">
              <column column="sum_load" table="this" />
              <const>670</const>
            </call>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]gt670" title="не менее 670 кВт">
        <where>
          <call function="and">
            <call function="ge">
              <column column="sum_load" table="this" />
              <const>670</const>
            </call>
          </call>
        </where>
      </grset>
      <grset title="объекты по производству электрической энергии" as="[:pfx]gen">
        <where>
          <call function="and">
            <call function="=1">
              <column column="pr_gen" table="this" />
            </call>
          </call>
        </where>
      </grset>
      <grset title="временное технологическое присоединение" as="[:pfx]vrem">
        <where>
          <call function="and">
            <call function="=1">
              <column column="vrem_tp" table="this" />
            </call>
          </call>
        </where>
      </grset>
    </part>
    <part id="33535-f2-grsets" timestamp="27.12.2017 16:34:28" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]ls15" title="до 15 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>12</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ls15_fiz" title="до 15 кВт физ. лица">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const>13</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150" title="свыше 15 и до 150 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>14</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150_lg" title="свыше 15 и до 150 кВт с льготой">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const comment="Победря сказала данных нет. Выводим нули">15</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const>16</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]150to670" title="свыше 150 кВт и менее 670 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>17</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]gt670" title="не менее 670 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>18</const>
          </call>
        </where>
      </grset>
      <grset title="объекты по производству электрической энергии" as="[:pfx]gen">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>19</const>
          </call>
        </where>
      </grset>
      <grset title="временное технологическое присоединение" as="[:pfx]vrem">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>21</const>
          </call>
        </where>
      </grset>
      <grset title="некоммерческая организация" as="[:pfx]nonpr">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>24</const>
          </call>
        </where>
      </grset>
      <grset title="Объекты МРСК/РСК Группы Россети" as="[:pfx]mrsk" comment="Победря сказала данных нет. Выводим нули">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>25</const>
          </call>
        </where>
      </grset>
      <grset title="Объекты ТСО" as="[:pfx]tso" comment="Победря сказала данных нет. Выводим нули">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>26</const>
          </call>
        </where>
      </grset>
    </part>
    <part id="34397-grsets" timestamp="30.05.2017 17:06:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]vzn">
        <where>
          <call function="is not null">
            <column table="this" column="kod_klass" />
          </call>
        </where>
        <grset as="[:pfx]vzn_gen">
          <where>
            <call function="=">
              <column table="this" column="kod_vid_z" />
              <const>7</const>
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]tp">
        <where>
          <call function="=">
            <column table="this" column="kod_vz_parent" />
            <const>2</const>
          </call>
        </where>
        <grset as="[:pfx]tp_l1">
          <where>
            <call function="=">
              <column table="this" column="kod_vid_z" />
              <const>6</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]tp_l2">
          <where>
            <call function="=">
              <column table="this" column="kod_vid_z" />
              <const>5</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]tp_gen">
          <where>
            <call function="=">
              <column table="this" column="kod_vid_z" />
              <const>7</const>
            </call>
          </where>
        </grset>
      </grset>
    </part>
    <part id="34397-expr" timestamp="01.08.2017 11:19:57" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <call function="()" type="number" group="sum" as="vvd_fiz_km">
        <fact column="ipr_vvod_fiz_km_fact" />
      </call>
      <call function="*" type="number" group="sum" as="vvd_fiz_kva">
        <call function="nvl0">
          <fact column="ipr_vvod_fiz_mba_fact" />
        </call>
        <const>1000</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_cnt">
        <fact column="ipr_vvod_fiz_cnt_fact" />
      </call>
      <call as="is_col1" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>1</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col1_km">
        <fact column="ipr_vvod_fiz_km_fact" condition="is_col1" />
      </call>
      <call as="is_col2" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>2</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col2_km">
        <fact column="ipr_vvod_fiz_km_fact" condition="is_col2" />
      </call>
      <call as="is_col3" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>3</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col3_cnt">
        <fact column="ipr_vvod_fiz_cnt_fact" condition="is_col3" />
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col3_kva">
        <fact column="vvd_fiz_kva" condition="is_col3" />
      </call>
      <call as="is_col4" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>4</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col4_cnt">
        <fact column="ipr_vvod_fiz_cnt_fact" condition="is_col4" />
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col4_kva">
        <fact column="vvd_fiz_kva" condition="is_col4" />
      </call>
      <call as="is_col5" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>5</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col5_km">
        <fact column="ipr_vvod_fiz_km_fact" condition="is_col5" />
      </call>
      <call as="is_col6" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>6</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col6_km">
        <fact column="ipr_vvod_fiz_km_fact" condition="is_col6" />
      </call>
      <call as="is_col7" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>7</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col7_cnt">
        <fact column="ipr_vvod_fiz_cnt_fact" condition="is_col7" />
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col7_kva">
        <fact column="vvd_fiz_kva" condition="is_col7" />
      </call>
      <call as="is_col8" function="=">
        <column table="kod_rep_34397_col" column="kod_rep_34397_col" />
        <const>8</const>
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col8_cnt">
        <fact column="ipr_vvod_fiz_cnt_fact" condition="is_col8" />
      </call>
      <call function="()" type="number" group="sum" as="vvd_fiz_col8_kva">
        <fact column="vvd_fiz_kva" condition="is_col8" />
      </call>
      <call function="()" type="number" group="sum" as="os_ft_bn">
        <fact column="ipr_kap_fact_sum" />
      </call>
      <call function="()" type="number" group="sum" as="fn_ft_bn">
        <fact column="ipr_fin_fact_sum" />
      </call>
      <call function="()" type="number" group="sum" as="os_pl_bn">
        <fact column="ipr_kap_sum" />
      </call>
      <call function="()" type="number" group="sum" as="fn_pl_bn">
        <fact column="ipr_fin_sum" />
      </call>
    </part>
    <part id="34397-params" timestamp="31.05.2017 14:19:40" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <param name="kod_doc_osn" type="number">
        <const>143403</const>
      </param>
      <param name="dat1" type="date">
        <const>to_date('01.01.2016','DD.MM.YYYY')</const>
      </param>
      <param name="dat2" type="date">
        <const>to_date('31.12.2016','DD.MM.YYYY')</const>
      </param>
    </part>
    <part id="34397-select" timestamp="31.05.2017 15:24:27" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <call function="date to char" as="sdat2" group="max">
        <useparam name="dat2" />
      </call>
      <column table="ipr_kod_doc_main" column="kod_doc" as="kod_doc_main" />
      <column table="ipr_kod_doc_main" column="doc_num" as="kod_doc_main_name" title="Версия ИПР" />
      <column table="kod_parent_titul" column="tit_num_new" as="kod_parent_titul_num" title="Код головного титула" />
      <column table="kod_titul_ip" column="tit_num_new" as="kod_titul_ip_num" title="Код одиночного/дочернего титула" />
      <column table="kod_subject" column="kod_subject" />
      <column table="kod_subject" column="name" as="kod_subject_name" />
      <column table="kod_ipr" column="kod_ipr" />
      <column table="kod_klass" column="kod_klass" />
      <column table="kod_klass" column="name" as="kod_klass_name" title="Принадлежность к важн. объекта, программам" />
      <column table="kod_vid_zajavki" column="kod_vid_z" />
      <column table="kod_vid_zajavki" column="kod_parent" as="kod_vz_parent" />
      <column table="kod_vid_zajavki" column="name" as="kod_vid_zajavki_name" title="Направление инвестиций" />
      <column table="kod_razdel" column="kod_razdel" />
      <column table="kod_razdel" column="vid_full" as="kod_razdel_name" title="Раздел" />
      <band title="Ввод">
        <fact column="vvd_fiz_km" group="sumnvl" title="км" />
        <fact column="vvd_fiz_cnt" group="sumnvl" title="шт" />
        <fact column="vvd_fiz_kva" group="sumnvl" title="кВА" />
        <band title="Техническое перевооружение и реконструкция  ВЛ/КЛ 20/10/6/0,4 кВ">
          <fact column="vvd_fiz_col1_km" group="sumnvl" title="км" />
        </band>
        <band title="Строительство ВЛ/КЛ 20/10/6/0,4 кВ">
          <fact column="vvd_fiz_col2_km" group="sumnvl" title="км" />
        </band>
        <band title="Техническое перевооружение и реконструкция ТП/РП/ЦРП с заменой трансформаторов 20/10/6/0,4 кВ">
          <fact column="vvd_fiz_col3_cnt" group="sumnvl" title="шт" />
          <fact column="vvd_fiz_col3_kva" group="sumnvl" title="кВА" />
        </band>
        <band title="Строительство  ТП/РП/ЦРП 20/10/6/0,4 кВ">
          <fact column="vvd_fiz_col4_cnt" group="sumnvl" title="шт" />
          <fact column="vvd_fiz_col4_kva" group="sumnvl" title="кВА" />
        </band>
        <band title="Техническое перевооружение и реконструкция ВЛ/КЛ с высшим классом напряжения не менее 35 кВ">
          <fact column="vvd_fiz_col5_km" group="sumnvl" title="км" />
        </band>
        <band title="Строительство ВЛ/КЛ с высшим классом напряжения не менее 35 кВ">
          <fact column="vvd_fiz_col6_km" group="sumnvl" title="км" />
        </band>
        <band title="Техническое перевооружение и реконструкция ПС с высшим классом напряжения не менее 35 кВ  с заменой трансформаторов">
          <fact column="vvd_fiz_col7_cnt" group="sumnvl" title="шт" />
          <fact column="vvd_fiz_col7_kva" group="sumnvl" title="кВА" />
        </band>
        <band title="Строительство ПС с высшим классом напряжения не менее 35 кВ">
          <fact column="vvd_fiz_col8_cnt" group="sumnvl" title="шт" />
          <fact column="vvd_fiz_col8_kva" group="sumnvl" title="кВА" />
        </band>
      </band>
      <band title="Финансирование ">
        <fact column="fn_pl_bn" group="sumnvl" title="План" mp="-6" />
        <fact column="fn_ft_bn" group="sumnvl" title="Факт" mp="-6" />
      </band>
      <band title="Освоение">
        <fact column="os_pl_bn" group="sumnvl" title="План" mp="-6" />
        <fact column="os_ft_bn" group="sumnvl" title="Факт" mp="-6" />
      </band>
    </part>
    <part id="34397-from" timestamp="31.05.2017 14:43:30" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\34397.xml">
      <qube merge-dimsets="1">
        <where>
          <call function="and">
            <call function="ge">
              <column table="ipr_dat" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="le">
              <column table="ipr_dat" column="val" />
              <useparam name="dat2" />
            </call>
            <call function="=">
              <column table="ipr_kod_doc_main" column="kod_doc" />
              <useparam name="kod_doc_osn" />
            </call>
            <call function="=">
              <column table="kod_vid_zajavki" column="kod_parent" />
              <const>2</const>
            </call>
          </call>
        </where>
        <link name="kod_ipr_ext" as="kod_ipr">
          <link name="kod_titul_ip" />
          <link name="kod_main_titul">
            <link name="kod_subject" />
          </link>
          <link name="kod_parent" as="kod_parent_titul" />
          <link name="kod_vid_zajavki" />
          <link name="kod_klass" />
          <link name="kod_razdel" />
        </link>
        <link name="ipr_kod_doc_main" />
        <link name="ipr_dat" />
      </qube>
    </part>
    <part id="44098-3-49576-params" timestamp="02.10.2018 14:24:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <param name="p_dt1" type="date">
        <const>date'2018-03-01'</const>
      </param>
      <param name="p_dt2" type="date">
        <const>date'2018-03-30'</const>
      </param>
    </part>
    <part id="44098-3-49576-withparams" timestamp="02.10.2018 14:25:13" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <useparam name="p_dt1" />
      <useparam name="p_dt2" />
    </part>
    <part id="44164-params" timestamp="19.10.2017 19:02:15" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <param name="dat" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="id_slice" type="number">
        <const>338</const>
      </param>
      <param name="dat6" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="dat12" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="dat18" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="dat24" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="dat30" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
      <param name="dat36" type="date">
        <const>DATE'2017-08-31'</const>
      </param>
    </part>
    <part id="44164-useparams" timestamp="19.10.2017 19:01:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <useparam name="dat" />
      <useparam name="id_slice" />
      <useparam name="dat6" />
      <useparam name="dat12" />
      <useparam name="dat18" />
      <useparam name="dat24" />
      <useparam name="dat30" />
      <useparam name="dat36" />
    </part>
  </parts>
  <views child-name="view" key-name="id">
    <view name="32394-view" file="sql.builder.templates\sql.builder\projects\ipr\reports\32394.xml">
      select distinct 
      case when substr(razd.abbr1,1,2) = '1.' then '2'
      when substr(razd.abbr1,1,2) = '2.' then '1'
      else null
      end as f1,
      gkpz.num_zakup as f2,
      'ОАО "Ленэнерго"' as f3,
      dir.name as f4,
      gkpz.func_block as f5,
      okved.code as f6,
      okdp.code as f7,
      gkpz.lot_num as f8,
      gkpz.lot_name as f9,
      gr_pr.name as f10,
      vid_pr.abbr || ' ' || vid_pr.name as f11,
      fin_src.name as f12,
      kod_bdr.abbr as f13,
      kod_bdr.name as f14,
      gkpz.num_stat_smet as f15,
      dpn.kod_budget as f16,
      gkpz.doc_osn_zak as f17,
      gkpz.lot_cost_izv as f28,
      gkpz.lot_cost_izv_nds as f29,
      gkpz.base_cost_2010 as f20,
      defl_name.name as f21,
      gkpz.index_defl_10 as f22,
      gkpz.index_defl_11 as f23,
      gkpz.index_defl_12 as f24,
      gkpz.index_defl_13 as f25,
      gkpz.index_defl_14 as f26,
      case when gkpz.koef_down = 1 then null else gkpz.koef_down
      end as f27,
      gkpz.lot_cost_por as f18,
      gkpz.lot_cost_por_nds as f19,
      gkpz.plan_lim_cost_30 as f30,
      gkpz.plan_lim_cost_30_nds as f31,
      case when last_doc.is_closed = 1 then gkpz.max_lot_cost else
      (select sum(PLAN_COST)/1000 from IPR_VID_ZATRAT_TITUL where KOD_IPR_DOG =
      dogs.KOD_IPR_DOG) end as f32,
      case when last_doc.is_closed = 1 then gkpz.max_lot_cost_nds
      else (select sum(PLAN_COST_NDS)/1000 from IPR_VID_ZATRAT_TITUL where
      KOD_IPR_DOG = dogs.KOD_IPR_DOG) end as f33,
      spos_zak.name as f34,
      org_zak.name as f35,
      lev_kom.name as f36,
      case when nvl(gkpz.is_zak_elektr, 0) = 1 then 'Электронная'
      else 'Неэлектронная' end as f37,
      case when last_doc.is_closed = 1 then
      gkpz.plan_date_objavl_konk else
      ipr_tituls_gkpz.GetPlanKonkDate(gkpz.kod_ipr_dog, gkpz.KOD_SPOSOB_ZAK) end
      as f38,
      gkpz.plan_date_zakup_itog as f39,
      gkpz.osn_zak_ei as f40,
      gkpz.e_code_name as f41,
      gkpz.predm_dog as f42,
      gkpz.min_req_zak as f43,
      okei.code as f44,
      okei.name as f45,
      gkpz.ed_izm_value as f46,
      okato.code as f47,
      okato.name as f48,
      case when last_doc.is_closed = 1 then gkpz.dat_podpis else
      dogs.dat_podpis end as f49,
      case when last_doc.is_closed = 1 then gkpz.dat_create else
      dogs.dat_create end as f50,
      case when last_doc.is_closed = 1 then gkpz.dat_udal else
      dogs.dat_udal end as f51,
      case
      when extract(year from gkpz.dat_create) = extract(year from
      gkpz.dat_udal)
      then to_char(extract(year from gkpz.dat_udal))
      else to_char(extract(year from gkpz.dat_create)) || '-' ||
      to_char(extract(year from gkpz.dat_udal))
      end as f52,
      gkpz.comments as f53,
      case when nvl(gkpz.is_usl_post_zak, 0) = 0 then 'Нет' else
      'Да' end as f54,
      gkpz.doc_usl_post_zak as f55,
      case
      when tit.beg_year = tit.end_year
      then to_char(tit.beg_year)
      else to_char(tit.beg_year) || '-' || to_char(tit.end_year)
      end as f56,
      tit.tit_num_new as f57,
      tit.name as f58,
      null as f59,
      gkpz.end_period as f60,
      gkpz.smet_cost_nds as f61,
      null as f62,
      gkpz.mba as f63,
      gkpz.KM as f64,
      case when nvl(tit.KOD_VID_ZAJAVKI, 0) &gt; 1 then 'Да' else
      'Нет' end f65,
      gkpz.prim as f66,
      smp.name as f67,
      gkpz.zak_cat as f68,
      case when gkpz.is_innov=1 then 'Да' else 'Нет' end as f69,
      cred.inn as f70,
      cred.kpp as f71,
      gkpz.kod_okved2 as f72,
      gkpz.kod_okdp2 as f73
      from IPR_GKPZ gkpz
      join IPR_V_DOC_LAST_GKPZ last_doc on gkpz.kod_gkpz = last_doc.kod_gkpz
      and last_doc.god_ip &gt; 0
      { and last_doc.god_ip = :p_year  }
      and

      ( (last_doc.inc = 1 {or 1=1 /* :kod_doc_pz */} )
      {and last_doc.kod_doc in :kod_doc_pz }
      )
      -- Емцов 07.12.17 28694(19) сделал как ipr_tituls_gkpz.GetGKPZCurs
      join ipr_dogs dogs on dogs.kod_ipr_dog_all = gkpz.kod_ipr_dog_all and nvl(gkpz.reglam_zak, 0) = 0
      --join ipr_dogs dogs on dogs.kod_ipr_dog = gkpz.kod_ipr_dog and nvl(gkpz.reglam_zak, 0) = 0
      join IPR_TITUL_IP tit on tit.kod_titul_ip =
      last_doc.kod_titul_ip and tit.kod_subject &gt;= 0
      {
      and (  /* nvl(:p_region_id , -1) = -1 or */
      tit.kod_subject in :p_region_id )
      }
      { and (
      ( :p_customer = 2 and
      tit.kod_direct in :p_department_id )
      or
      ( :p_customer = 3 and
      tit.kod_ispolnit in :p_department_id  )
      or
      ( :p_customer = 0 and
      (tit.kod_ispolnit in :p_department_id  or tit.kod_direct in :p_department_id ))
      )
      }
      join IS_SPR_DIRECT dir on dir.kod_direct = tit.kod_direct
      and tit.kod_direct &gt; 0
      join ips_razdel_ip razd on razd.kod_razdel =
      last_doc.kod_razdel
      left join IPR_DOC doc_smet on doc_smet.kod_doc =
      gkpz.kod_doc_smet
      left join IPS_GROUP_PRODUCT gr_pr on gr_pr.kod_group_product
      = gkpz.kod_product_group
      left join IPS_VID_PRODUCT vid_pr on vid_pr.kod_vid_product =
      gkpz.kod_vid_product
      left join IPS_TARIFS fin_src on fin_src.kod_tarif =
      gkpz.kod_fin_source
      left join IPS_KOD_BDR kod_bdr on kod_bdr.kod_bdr =
      gkpz.kod_bdr
      left join IS_SPR_BUDGET dpn on dpn.kod_spr_budget =
      gkpz.kod_spr_budget
      left join IPS_INDDEFL_NAME defl_name on
      defl_name.kod_inddefl_name = gkpz.kod_inddefl_name
      left join Z_SPR_SPOSOB_ZAK spos_zak on
      spos_zak.KOD_SPR_SPOSOB_ZAK = gkpz.kod_sposob_zak
      left join IPS_ORG_ZAK org_zak on org_zak.kod_org_zak =
      gkpz.kod_org_zak
      left join IPS_LEVEL_ZAK_KOMIS lev_kom on
      lev_kom.KOD_LEVEL_ZAK_KOMIS = gkpz.kod_level_zak_komis
      left join IS_SPR_CLASSIFIER_OKEI okei on okei.id =
      gkpz.kod_okei
      left join IS_SPR_CLASSIFIER_OKATO okato on okato.id =
      gkpz.kod_okato
      left join IS_SPR_CLASSIFIER_OKVED okved on okved.id =
      gkpz.kod_okved
      left join IS_SPR_CLASSIFIER_OKDP okdp on okdp.id =
      gkpz.kod_okdp
      left join is_creditors cred on cred.e_code = gkpz.e_code
      left join plan.ips_smp smp on smp.kod_smp = gkpz.smp_dog
    </view>
    <view name="41656-plan-type-view" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      select 1 as kod, 'План по вводу в ОФ' as name from dual
      union all
      select 2, 'Ожидаемый факт по вводу в ОФ' from dual
    </view>
    <view name="39463-data-for-report" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\39463.xml">
      select 1 as kod, 'План + Коррект.плана' as name from dual
      union all
      select 2, 'План + Факт' from dual
    </view>
    <view name="33535-voltage_view" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      select 1 as kod, '0,4' as title from dual
      union all
      select 2 ,'1-20' from dual
      union all
      select 3, 'не менее 35 кВ' from dual
    </view>
    <view name="43430-deps-view" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      isv_vks_predpr
    </view>
    <view name="isv_otchet_147_dog_sobstv" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      SELECT
      polzov,
      d_c,
      e_code,
      kod_dog,
      kod_kr_owner,
      col1 AS pp,
      col1_pp2 as pp2,
      col2 AS contr_type,
      col2_kod AS contr_type_kod,
      col3 AS contr_publ_type,
      col3_kod AS contr_publ_type_kod,
      col4 AS inn,
      col5 AS contr_reg_num,
      col6 AS is_contr_filial,
      col7 AS ogrn,
      col8 AS address,
      col9 AS fs_name,
      col9_kod AS fs_kod,
      col10 AS contr_name,
      col11 AS okved_kod,
      col12 AS fio,
      col13 AS passport,
      col14 AS site,
      col15 AS offshore,
      col15_kod AS offshore_kod,
      col16 AS kod_unig_dog,
      col17 AS dat_dog,
      col18 AS predm_dog,
      col19 AS price_type,
      col19_kod AS price_type_kod,
      col20 AS sum_dog,
      col21 AS data_type,
      col21_kod AS data_type_kod,
      col22 AS dat_beg,
      col23 AS dat_udal,
      col24 AS dog_type,
      col24_kod AS dog_type_kod,
      col25 AS invest_dog,
      col26 AS dog_conditions,
      col27 AS dog_num,
      col28 AS org_type,
      col28_kod AS org_type_kod,
      col29 AS publ_type,
      col29_kod AS publ_type_kod,
      col30 AS inn_sobs,
      col31 AS reg_num_sobs,
      col32 AS ogrn_sobs,
      col33 AS fs_name_sobs,
      col33_kod AS fs_kod_sobs,
      col34 AS name_sobs,
      col35 AS address_sobs,
      col36 AS passport_sobs,
      col37 AS type_sobs,
      col37_kod AS type_kod_sobs,
      col38 AS dol_sobs,
      col39 AS site_sobs,
      col40 AS inf_doc,
      col41 AS offshore_sobs,
      col41_kod AS offshore_kod_sobs,
      col42 AS podr,
      col43 AS curator,
      col44 AS curator_email,
      col45 AS curator_tel,
      col46 AS ispoln,
      col47 AS ispoln_email,
      col8_ds AS num_dop_dog,
      col9_ds AS dat_dop_dog,
      col10_ds AS dop_dog_type,
      col_10_kod_ds AS dop_dog_type_kod,
      col_11_ds AS dat_beg_dop_dog
      FROM is_otchet_147_dog_sobstv
      WHERE polzov = user
      ORDER BY order_flag, e_code, col1_pp2, col1
    </view>
    <view name="isv_otchet_147_dog_types" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      SELECT 0 AS id, 'Доходные' AS dog_type FROM dual
      UNION ALL
      SELECT 1, 'Расходные' FROM dual
      UNION ALL
      SELECT 2, 'Прочие' FROM dual
      UNION ALL
      SELECT 3, 'Договоры ТП' FROM dual
    </view>
    <view name="isv_otchet_subpodr" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      SELECT
      col1,
      kod_dog,
      col2,
      col3,
      col4,
      col4_kod,
      col5,
      col6,
      col7,
      col8,
      col8_kod,
      col9,
      col9_kod,
      col10,
      col11,
      col12,
      col13,
      col14,
      col15,
      col15_kod,
      col16,
      col17,
      col18,
      col19,
      col20,
      col21,
      col21_kod
      FROM is_otchet_subpodr_tbl
      WHERE polzov = user
      ORDER BY col1
    </view>
    <view name="isv_otchet_subpodr_dog_types" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      SELECT 0 AS id, 'Доходные' AS dog_type FROM dual
      UNION ALL
      SELECT 1, 'Расходные' FROM dual
      UNION ALL
      SELECT 2, 'Прочие' FROM dual
    </view>
    <view name="isv_rep_shabl5_pris" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      select         s2      as id_dog
      ,s3      as kod_org
      ,s4      as num_dog
      ,d1      as dat_dog
      ,s5      as type_corr
      ,s6      as id_ds
      ,s7      as num_ds
      ,d2      as dat_ds
      ,s8      as id_org
      ,s9      as inn
      ,s10     as kpp
      ,s11     as grp
      ,s12     as name_org
      ,s13     as poluch_pl
      ,s14     as vid_dog
      ,s15     as tip_dog
      ,s16     as ini_dog
      ,s17     as predm_dog
      ,s18     as kod_val
      ,n1      as sum_vsego
      ,s19     as pfm
      ,s22     as finpos
      ,s21     as num_ram_dog
      ,sl1     as prim
      ,n2      as status
      ,s20     as kod_val_pl
      ,d3      as dat_b_dog
      ,d4      as dat_e_dog
      ,d5      as dat_podpis
      ,s30     as text_prizn
      ,n3      as proc
      ,n4      as sum_bez_nds
      ,n5      as sum_nds

      ,s31     as inn_strah
      ,s32     as kpp_strah
      ,s33     as name_strah
      ,s34     as num_dog_strah
      ,d6      as dat_start_strah
      ,d7      as dat_end_strah
      ,d8      as dat_end_dog
      ,n6      as srok_strah
      ,n7      as sum_strah
      ,n8      as bonus_strah

      ,s35    as vid_strah
      ,s36    as object_strah
      ,n9     as strah_sum
      ,n10    as cnt_strah
      ,kod_dog as kod_dog
      ,s52    as centr
      ,s53    as filial
      ,d23    as dat_start_smr_from_pd
      ,s54    as status_finish_rab
      ,d27    as dat_start_garant_from_pd
      ,d28    as dat_finish_garant_from_pd
      ,d29    as dat_start_smr
      ,d30    as dat_start_garant
      ,n52    as sum_strah_smr
      ,n53    as sum_strah_dav_mat
      ,n54    as sum_strah_garant
      ,n55    as sum_strah_gr_otv
      ,n56    as sum_franchise_1
      ,n57    as sum_franchise_2
      ,n58    as sum_prem_1
      ,n59    as sum_prem_2
      ,s55    as complex
      ,s56    as complex_link
      ,s57    as dat_vvod
      ,s58    as prich_strah

      from is_rab
      where polzov = user and s1= 'для ЕК: шаблон 5 договоры'
      order by n60
    </view>
    <view name="isv_rep_shabl6_pris" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      select         s2      as id_cred
      ,s3      as kod_org
      ,s4      as grp
      ,s5      as name_cred
      ,s6      as poluch_pl
      ,s7      as name_kr
      ,s8      as inn
      ,s9      as kpp
      ,s10     as strana
      ,s11     as ind
      ,s12     as region
      ,s13     as distr
      ,s14     as nasp
      ,s15     as ul
      ,s16     as num_d
      ,s30     as text_prizn
      from is_rab
      where polzov = user and s1= 'для ЕК: шаблон 6 кредиторы'
      order by s5
    </view>
    <view name="isv_rep_shabl7_pris" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      select         s2      as id
      ,s3      as kod_org
      ,s4      as bic
      ,s5      as rs
      ,s30     as text_prizn
      from is_rab
      where polzov = user and s1= 'для ЕК: шаблон 7 расчетные счета'
      order by s3, s5
    </view>
    <view name="33535-gor_obl" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      select 0 as kod_gor_obl, 'Ленинградская область' as name from dual
      union all
      select 1, 'Санкт-Петербург' from dual
    </view>
  </views>
  <reports child-name="report" key-name="name">
    <report name="25499" title="Приложение 1.1." form="25499" folder="invpro" nogrid="1" timestamp="24.10.2016 11:19:12" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc" />
        <param name="year" />
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <print-templates>
        <excel>
          <template name="25499.xml" title="Приложение 1.1" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="25499" as="a" title="1" calctree="1">
          <!--<columns>
            <column name="kod_node" />
            <column name="format" agg="no" />
            <column name="rwn" />
            <column name="lvl" />
            <column name="kod_main_titul" />
            <column name="tip_obj" />
            <column name="subject_name" />
            <column name="direct_name" />
            <column name="ispolnit_name" />
            <column name="itip" />
            <column name="kod_titul_ip" agg="no" />
            <column name="kod_doc_osn" agg="no" />
            <column name="razdel_abbr" />
            <column name="tit_num_new" />
            <column name="full_name" agg="no" />
            <column name="har" agg="no" />
            <band title="Тип объекта">
              <column name="tip_obj1" agg="no" />
              <column name="tip_obj2" agg="no" />
              <column name="tip_obj3" agg="no" />
              <column name="tip_obj0" agg="no" />
            </band>
            <column name="km" agg="sum" />
            <column name="km_kl" agg="sum" />
            <column name="pow" agg="sum" />
            <column name="prog" agg="no" />
            <column name="beg_year" agg="no" />
            <column name="end_year" agg="no" />
            <column name="summ_s" agg="sum" />
            <column name="summ" agg="sum" />
            <column name="summ_10" agg="sum" />
            <column name="summ_30" agg="sum" />
            <column name="summ_bn" agg="sum" />
            <column name="summ_10_bn" agg="sum" />
            <column name="summ_30_bn" agg="sum" />
            <column name="summ_30_mva" agg="sum" />
            <column name="summ_30_vl_km" agg="sum" />
            <column name="summ_30_kl_km" agg="sum" />
            <column name="summ_30_prch" agg="sum" />
            <column name="fp_sum_nds_itog" agg="sum" />
            <column name="kap_sum_itog" agg="sum" />
            <column name="vvod_sum_itog" agg="sum" />
            <column name="pow_mba_itog" agg="sum" />
            <column name="pow_km_itog" agg="sum" />
            <column name="pow_km_kl_itog" agg="sum" />
            <column name="summ_k_rasp" agg="sum" />
            <column name="summ_k_rasp_bn" agg="sum" />
            <column name="ost_st_stro" agg="sum" />
            <column name="ost_st_stro_kap" agg="sum" />
            <column name="ost_st_stro_vvod" agg="sum" />
            <column name="kz" agg="sum" />
            <column name="dz" agg="sum" />
            <column name="kredit_itog" agg="sum" />
            <column name="debet_itog" agg="sum" />
            <column name="kredit2_itog" agg="sum" />
            <column name="debet2_itog" agg="sum" />
            <column name="nzs_itog" agg="sum" />
            <column name="nzs2_itog" agg="sum" />
            <column name="pow_km_by_y" agg="sum" />
            <column name="pow_km" agg="sum" />
            <column name="pow_km_kl_by_y" agg="sum" />
            <column name="pow_km_kl" agg="sum" />
            <column name="pow_mba_by_y" agg="sum" />
            <column name="pow_mba" agg="sum" />
            <column name="kap_sum_by_y" agg="sum" />
            <column name="kap_sum_sz_by_y" agg="sum" />
            <column name="kap_sum" agg="sum" />
            <column name="nzs_by_y" agg="sum" />
            <column name="nzs2_by_y" agg="sum" />
            <column name="fp_sum_nds_by_y" agg="sum" />
            <column name="fp_sum_nds" agg="sum" />
            <column name="vvod_sum_by_y" agg="sum" />
            <column name="vvod_sum" agg="sum" />
            <band dimension="ipr_year" title="">
              <column name="kredit_by_y" agg="sum" />
              <column name="debet_by_y" agg="sum" />
              <column name="kredit2_by_y" agg="sum" />
              <column name="debet2_by_y" agg="sum" />
            </band>
            <column name="energ_eff_kvt" agg="no" />
            <column name="energ_eff_proc" agg="no" />
            <column name="kriteria_name" agg="no" />
            <column name="priority_name" agg="no" />
            <column name="klass_name" agg="no" />
            <column name="prin_sogl_name" agg="no" />
            <column name="in_ozp_name" agg="no" />
            <column name="prior_name" agg="no" />
            <column name="soc_val_name" agg="no" />
            <column name="kap_sum_itog_23" agg="sum" />
            <column name="stadiya" agg="no" />
          </columns>-->
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="25499-title" as="b" title="2">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="25499-t" title="Приложение 1.1. test" form="25499" folder="invpro" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc" />
        <param name="year" />
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <print-templates>
        <excel>
          <template name="25499.xml" title="Приложение 1.1" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="25499-dat-test" as="a" title="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="25499-1" title="Приложение 1.1 с детализацией" form="25499-1" folder="invpro" nogrid="1" timestamp="24.10.2016 11:17:54" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <params>
        <param name="kod_doc" />
        <param name="year" />
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="pr_zatrat" />
        <param name="pr_dog" />
        <param name="kod_ofz" />
      </params>
      <print-templates>
        <excel>
          <template name="25499-1.xml" title="Приложение 1.1" print-proc="2" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="25499" as="a" calctree="1" title="По разделам и титулам">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
          <query name="25499-detail" as="a1" title="Детализация для титулов">
            <withparams>
              <usepart part="25499-detail-wpars" />
            </withparams>
            <call function="=">
              <column table="a" column="kod_titul_ip" />
              <column table="a1" column="kod_titul_ip" />
            </call>
          </query>
          <query name="25499-detail-razdel" as="a2" title="Детализация для разделов">
            <withparams>
              <usepart part="25499-detail-wpars" />
            </withparams>
            <call function="=">
              <column table="a" column="kod_razdel_if_root" />
              <column table="a2" column="razdel_kod_root" />
            </call>
          </query>
        </query>
        <query name="25499-title" as="b" title="Доп. данные">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
          </withparams>
        </query>
        <query name="form:25499-1" as="p" title="Параметры" />
      </queries>
    </report>
    <report name="26553" title="Приложение 1.2. Стоимость основных этапов работ по реализации инвестиционной программы на год" form="25499" autobands="1" folder="invpro" nogrid="1" timestamp="24.10.2016 13:23:51" file="sql.builder.templates\sql.builder\projects\ipr\reports\26553.xml">
      <params>
        <param name="kod_doc" />
        <param name="year" />
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <print-templates>
        <excel>
          <template name="26533.xml" title="Приложение 1.2" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="26553" as="a" title="1" calctree="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="25499-title" as="b" title="2">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="26630-testcolgr" title="Тест группировки в колонках (сальдо)" use-repository="1" visible="0" datareader1="1" use-temp1="1" timestamp="16.01.2017 18:30:37" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new.xml">
      <customers>
        <customer id="17" />
      </customers>
      <!--<print-templates>
        <excel>
          <template name="test_colgroup_saldo.xlsx" title="Тест группировки в колонках" print-xlsx="1" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>-->
      <queries>
        <query name="ipr_fin_body_united_test4_gr" as="a">
          <!--<dimquery table="ym1" dimension="ym" />
          <dimquery table="ym1" dimension="ymtit" />
          <dimquery table="ym1" dimension="ymfc" />
          <dimquery table="ym1" dimension="ym1" />-->
        </query>
        <!--<query name="test_colgroup_saldo_ym" as="ym1" />-->
      </queries>
    </report>
    <report name="26630-test-cols" form="26630" use-repository="1" datareader="1" use-temp="1" timestamp="06.01.2018 22:56:40" title="Отчет по исполнителю" folder="invpro" edit-columns="2" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="26630.xlsx" title="Отчет по исполнителю(тест колонок)" print-xlsx="1" print-proc="2" del-cols="1" output-format="xlsb" />
        </excel>
      </print-templates>
      <queries>
        <query name="26630-xl-vv-cols0-2b" as="c0b_2" title="Колонки c0b_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-cols1-2" as="c1_2" title="Колонки c1_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-colsx-2" as="cx_2" title="Колонки cx_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-cols0-2e" as="c0e_2" title="Колонки c0e_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1o" as="c1o" title="Колонки1o">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1f" as="c1f" title="Колонки1f">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1v" as="c1v" title="Колонки1v">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols2" as="c2" title="Колонки2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols3" as="c3" title="Колонки3">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols4" as="c4" title="Колонки4">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols0b" as="c0b" title="Колонки 0 b">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols0e" as="c0e" title="Колонки 0 e">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="26630" form="26630" use-repository="1" datareader="1" timestamp="23.01.2018 15:42:53" title="Отчет по исполнителю" folder="invpro" edit-columns="2" nogrid="1" use-temp="1" save-compiled="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630-new3.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="26630.xlsx" title="Отчет по исполнителю" print-xlsx="1" print-proc="2" del-cols="1" output-format="xlsb" />
        </excel>
      </print-templates>
      <queries>
        <query name="26630-dat-grsets-vvod-new3" as="vv" title="Ввод физ параметров">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <dimquery table="pym" dimension="ym" />
          <dimquery table="pym" dimension="ym_cm" />
          <dimquery table="pkv" dimension="kv" />
          <dimquery table="pm6" dimension="m6" />
          <dimquery table="pm9" dimension="m9" />
          <dimquery table="pop" dimension="op" />
        </query>
        <query name="26630-xl-vv-cols0-2b" as="c0b_2" title="Колонки c0b_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-cols1-2" as="c1_2" title="Колонки c1_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-colsx-2" as="cx_2" title="Колонки cx_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-vv-cols0-2e" as="c0e_2" title="Колонки c0e_2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-dat-grsets-new3" as="a" title="Главный">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
          <dimquery table="pym" dimension="ym" />
          <dimquery table="pym" dimension="ym_cm" />
          <dimquery table="pym" dimension="ym_cm_smet" />
          <dimquery table="pym" dimension="ym_cm_dog" />
          <dimquery table="pkv" dimension="kv" />
          <dimquery table="pm6" dimension="m6" />
          <dimquery table="pm9" dimension="m9" />
          <dimquery table="pop" dimension="op" />
        </query>
        <query name="form:26630" as="b" title="Параметры" />
        <query name="26630-pivot-ym" as="pym" title="Месяцы">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-pivot-kv" as="pkv" title="Кварталы">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-pivot-m6" as="pm6" title="Полугодие">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-pivot-m9" as="pm9" title="9 Месяцев">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-pivot-op" as="pop" title="Отчетный период">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1o" as="c1o" title="Колонки1o">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1f" as="c1f" title="Колонки1f">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols1v" as="c1v" title="Колонки1v">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols2" as="c2" title="Колонки2">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols3" as="c3" title="Колонки3">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols4" as="c4" title="Колонки4">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols0b" as="c0b" title="Колонки 0 b">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-xl-cols0e" as="c0e" title="Колонки 0 e">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="26630-old2" title="Отчет по исполнителю" form="26630" folder="invpro" edit-columns="2" visible="0" timestamp="03.01.2017 19:54:31" use-repository="1" datareader="1" nogrid="1" save-compiled="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <params>
        <usepart part="26630-params" />
      </params>
      <print-templates>
        <excel>
          <template name="26630.xml" title="Отчет по исполнителю" del-cols="1" print-xlsx="1" print-proc="2" output-format="xlsb" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="26630-dat-grsets" as="a" title="Главный">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="26630-dat-grsets-vvod" as="vv" title="Ввод">
          <withparams>
            <usepart part="26630-withparams" />
          </withparams>
        </query>
        <query name="form:26630" as="b" title="Параметры" />
      </queries>
    </report>
    <report name="27332" title="Приложение 1.3" form="25499" folder="invpro" nogrid="1" timestamp="24.10.2016 19:35:28" file="sql.builder.templates\sql.builder\projects\ipr\reports\27332.xml">
      <params>
        <param name="kod_doc" />
        <param name="year" />
        <param name="kod_subject" />
        <param name="kod_direct" />
        <param name="pr_sbor" />
        <param name="pr_child" />
        <param name="kod_dirisp" />
        <param name="pr_all_razdel" />
        <param name="pr_dont_show_wfp" />
        <param name="kod_ofz" />
      </params>
      <print-templates>
        <excel>
          <template name="27332.xml" title="Приложение 1.3" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="27332" as="a" title="1" calctree="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
            <useparam name="kod_subject" />
            <useparam name="kod_direct" />
            <useparam name="pr_sbor" />
            <useparam name="pr_child" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_all_razdel" />
            <useparam name="pr_dont_show_wfp" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="25499-title" as="b" title="2">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="year" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="29319" form="29319" title="Отчет к селектору у генерального директора" edit-columns="2" folder="invpro" nogrid="1" timestamp="08.09.2016 13:46:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <params>
        <param name="date" />
        <param name="pr_aip" />
        <param name="kod_doc" />
        <param name="mp" />
        <param name="nvalue" />
        <param name="pr_ip" />
        <param name="pr_aip_detail" />
        <param name="kod_direct" />
        <param name="kod_dir_isp" />
        <param name="pr_sbor" />
        <param name="kod_ofz" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="29319.xml" del-cols="1" print-proc="2" title="Отчет к селектору у генерального директора" />
        </excel>
      </print-templates>
      <queries>
        <query name="29319-detail" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="pr_aip" />
            <useparam name="kod_doc" />
            <useparam name="mp" />
            <useparam name="pr_ip" />
            <useparam name="pr_aip_detail" />
            <useparam name="kod_direct" />
            <useparam name="kod_dir_isp" />
            <useparam name="pr_sbor" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="29319-title" as="b">
          <withparams>
            <useparam name="date" />
            <useparam name="nvalue" />
            <useparam name="mp" />
          </withparams>
        </query>
        <query name="form:29319" as="p" title="Параметры" />
      </queries>
    </report>
    <report name="29611" title="План-факторный анализ" form="29611" folder="invpro" nogrid="1" edit-columns="2" timestamp="03.10.2016 13:32:30" datareader="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <params>
        <usepart part="29611-params" />
      </params>
      <print-templates>
        <excel>
          <template name="29611.xml" title="План-факторный анализ" conv-to-openxml="0" print-proc="2" del-cols="1" headmarker="1" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="29611-gr" as="a" node-id="growid" parent-node-id="parent_growid">
          <usepart part="29611-withparams" />
        </query>
        <query name="29611-title" as="b">
          <usepart part="29611-withparams" />
        </query>
      </queries>
    </report>
    <report name="30576" title="Отчет о проверке наличия вложенных документов в АИС 'ИнвестPRO'" form="30576" visible="1" autobands="1" folder="invpro" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <params>
        <param name="kod_doc" />
        <param name="kod_direct" />
        <param name="kod_dirisp" />
        <param name="pr_notaip" />
        <param name="kod_titul_ip" />
        <param name="kod_ofz" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="30576.xml" title="Отчет о проверке наличия вложенных документов в АИС 'ИнвестPRO'" print-proc="2" headmarker="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="30576_dat" as="a" grouplevel="1">
          <withparams>
            <useparam name="kod_doc" />
            <useparam name="kod_direct" />
            <useparam name="kod_dirisp" />
            <useparam name="pr_notaip" />
            <useparam name="kod_titul_ip" />
            <useparam name="kod_ofz" />
          </withparams>
        </query>
        <query name="form:30576" as="p" title="Параметры" />
      </queries>
    </report>
    <report name="30581" title="Отчет по контрольным этапам" form="30581" folder="invpro" nogrid="1" timestamp="04.08.2017 18:26:56" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="30581.xlsx" title="Отчет по контрольным этапам" print-proc="2" headmarker="1" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="30581" as="a">
          <usepart part="30581-withparams" />
        </query>
        <query name="30581_user_name" as="b" />
      </queries>
    </report>
    <report name="30581-passport" title="Отчет по контрольным этапам" form="30581" folder="invpro" nogrid="1" timestamp="13.08.2018 12:44:15" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <params>
        <usepart part="30581-params-typed" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="30581 - passport.xml" title="Отчет по контрольным этапам" print-proc="2" headmarker="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query name="30581-passport" as="a">
          <usepart part="30581-withparams" />
        </query>
        <query name="30581_user_name" as="b" />
      </queries>
    </report>
    <report name="30923" title="Отчет по сметной стоимости" form="30923" folder="invpro" edit-columns="2" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <params>
        <usepart part="30923-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="30923.xml" title="Отчет по сметной стоимости" del-cols="1" print-proc="2" headmarker="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="30923" as="a">
          <usepart part="30923-withparams" />
        </query>
        <query name="form:30923" as="p" title="Параметры" />
      </queries>
    </report>
    <report name="32274" title="Отчет об исполнении основных этапов работ к отчету по исполнителю" form="32274" folder="invpro" use-repository="1" nogrid="1" timestamp="16.04.2017 16:07:38" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <!--<template name="32274.xml" title="Приложение 7.2 к отчету по исполнителю (формат Минэнерго)" print-proc="2" />-->
          <template name="32274.xlsx" title="Отч. об. исп. осн. этапов работ к отч. по исп. " print-xlsx="1" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="32274-razdel" as="a" calctree="1" title="По разделам(Сводный)">
          <usepart part="32274-withparams" />
          <query name="32274-titul" as="b" title="По титулам(Сводный)">
            <usepart part="32274-withparams" />
            <call function="=">
              <column table="a" column="kod_minenergo" />
              <column table="b" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="32274-razdel-gor" as="a1" calctree="1" title="По разделам(Город)">
          <usepart part="32274-withparams" />
          <query name="32274-titul-gor" as="b1" title="По титулам(Город)">
            <usepart part="32274-withparams" />
            <call function="=">
              <column table="a1" column="kod_minenergo" />
              <column table="b1" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="32274-razdel-obl" as="a2" calctree="1" title="По разделам(Область)">
          <usepart part="32274-withparams" />
          <query name="32274-titul-obl" as="b2" title="По титулам(Область)">
            <usepart part="32274-withparams" />
            <call function="=">
              <column table="a2" column="kod_minenergo" />
              <column table="b2" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="form:32274" as="p" title="Параметры" />
        <query name="32274-title" as="c" title="Данные для шапки">
          <usepart part="32274-withparams" />
        </query>
      </queries>
    </report>
    <report name="32274-1" title="Отчет об исполнении основных этапов работ к отчету по исполнителю (формат регламента Россети)" form="32274" folder="invpro" use-repository="1" nogrid="1" visible="0" timestamp="12.04.2017 17:27:04" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <params>
        <usepart part="32274-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <!--<template name="32274-rs.xml" title="Приложение 7.2 к отчету по исполнителю (формат регламента Россети)" print-proc="2" />-->
          <template name="32274-rs.xlsx" title="Отч. об. исп. осн. этапов работ к отч. по исп. (ф-т рег. Россети)" print-xlsx="1" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="32274-razdel-rs" as="a" calctree="1" title="По разделам">
          <usepart part="32274-withparams" />
          <query name="32274-titul" as="b" title="По титулам">
            <usepart part="32274-withparams" />
            <call function="=">
              <column table="a" column="kod_klass" />
              <column table="b" column="kod_klass" />
            </call>
          </query>
        </query>
        <query name="form:32274" as="p" title="Параметры" />
        <query name="32274-title" as="c" title="Данные для шапки">
          <usepart part="32274-withparams" />
        </query>
      </queries>
    </report>
    <report name="32443" title="Приложение 7.1 к отчету по исполнителю" form="32443" folder="invpro" use-repository="1" nogrid="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="32443.xml" title="Приложение 7.1 к отчету по исполнителю (формат Минэнерго)" print-proc="2" output-format="xlsb" />
        </excel>
      </print-templates>
      <queries>
        <query name="32443-razdel" as="a" calctree="1" title="По разделам(Сводный)">
          <usepart part="32443-withparams" />
          <query name="32443-titul" as="b" title="По титулам(Сводный)">
            <usepart part="32443-withparams" />
            <call function="=">
              <column table="a" column="kod_minenergo" />
              <column table="b" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="32443-razdel-gor" as="a1" calctree="1" title="По разделам(Город)">
          <usepart part="32443-withparams" />
          <query name="32443-titul-gor" as="b1" title="По титулам(Город)">
            <usepart part="32443-withparams" />
            <call function="=">
              <column table="a1" column="kod_minenergo" />
              <column table="b1" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="32443-razdel-obl" as="a2" calctree="1" title="По разделам(Область)">
          <usepart part="32443-withparams" />
          <query name="32443-titul-obl" as="b2" title="По титулам(Область)">
            <usepart part="32443-withparams" />
            <call function="=">
              <column table="a2" column="kod_minenergo" />
              <column table="b2" column="kod_minenergo" />
            </call>
          </query>
        </query>
        <query name="form:32443" as="p" title="Параметры" />
        <query name="32443-title" as="c" title="Данные для шапки">
          <usepart part="32443-withparams" />
        </query>
      </queries>
    </report>
    <report name="32443-1" title="Приложение 7.1 к отчету по исполнителю (формат регламента Россети)" form="32443" folder="invpro" use-repository="1" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <params>
        <usepart part="32443-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="32443-rs.xml" title="Приложение 7.1 к отчету по исполнителю (формат регламента Россети)" print-proc="2" output-format="xlsb" />
        </excel>
      </print-templates>
      <queries>
        <query name="32443-razdel-rs" as="a" calctree="1" title="По разделам">
          <usepart part="32443-withparams" />
          <query name="32443-titul" as="b" title="По титулам">
            <usepart part="32443-withparams" />
            <call function="=">
              <column table="a" column="kod_klass" />
              <column table="b" column="kod_klass" />
            </call>
          </query>
        </query>
        <query name="form:32443" as="p" title="Параметры" />
        <query name="32443-title" as="c" title="Данные для шапки">
          <usepart part="32443-withparams" />
        </query>
      </queries>
    </report>
    <report name="38203" form="38203" title="Отчет к селектору у ГД с выделением периодов" edit-columns="2" folder="invpro" nogrid="1" timestamp="12.09.2016 17:32:09" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <params>
        <usepart part="38203-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="38203.xml" print-proc="2" title="Отчет к селектору у ГД с выделением периодов" del-cols="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="38203-detail" as="a">
          <withparams>
            <usepart part="38203-withparams" />
          </withparams>
        </query>
        <query name="38203-title" as="b">
          <withparams>
            <usepart part="38203-withparams" />
          </withparams>
        </query>
        <query name="form:38203" as="p" title="Параметры" />
      </queries>
    </report>
    <report name="41656" title="План по выполнению работ хозяйственным способом" timestamp="17.11.2017 11:32:39" form="41656" mode="excel" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <print-templates>
        <excel>
          <template name="41656.xlsx" title="План по выполнению работ хозяйственным способом" print-proc="2" print-xlsx="1" use-flexcel="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="41656-title" as="t">
          <withparams>
            <usepart part="41656-useparams" />
          </withparams>
        </query>
        <query as="a" main="1" name="41656">
          <withparams>
            <usepart part="41656-useparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-tit">
              <usepart part="41656-useparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="no_tits_count_plan">
              <usepart part="41656-useparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="isv_ad_evd_count_ost">
              <usepart part="41656-useparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="ad_count_plan">
              <usepart part="41656-useparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-ad" column="ad_count_fact">
              <usepart part="41656-useparams" />
            </useaction>
            <usepart part="41656-cmn-events" />
          </events>
        </query>
      </queries>
    </report>
    <report name="41656-2" title="План по выполнению работ хозяйственным способом (сокр)" timestamp="23.01.2018 14:16:19" form="41656" mode="excel" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <params>
        <usepart part="41656-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <print-templates>
        <excel>
          <template name="41656-2.xlsx" title="План по выполнению работ хозяйственным способом (сокр)" print-proc="2" print-xlsx="1" use-flexcel="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="41656-title" as="t">
          <withparams>
            <usepart part="41656-useparams" />
          </withparams>
        </query>
        <query as="a" main="1" name="41656-2">
          <withparams>
            <usepart part="41656-useparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="41656-detail-tit">
              <usepart part="41656-useparams" />
            </useaction>
            <usepart part="41656-cmn-events" />
          </events>
        </query>
      </queries>
    </report>
    <report name="29265" form="29265" title="Анализ договоров в титуле" edit-columns="2" nogrid="1" folder="invpro" timestamp="02.11.2016 13:35:13" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="29265.xml" title="Анализ договоров в титуле" conv-to-openxml="0" del-cols="1" print-proc="2" headmarker="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="29265-dat-grsets" as="a" title="Данные">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
        </query>
        <query name="form:29265" as="b" title="Параметры" />
        <query name="29265-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="29265-vertica-test" form="29265" title="Анализ договоров в титуле" edit-columns="2" nogrid="1" folder="invpro" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <params>
        <usepart part="29265-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="29265.xml" title="Анализ договоров в титуле" del-cols="1" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="29265-dat-grsets-vert-test" as="a" title="Данные">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
        </query>
        <!--<query name="29265-dat" grouplevel="0" as="a" title="Данные">
          <withparams>
            <usepart part="29265-withparams" />
          </withparams>
        </query>-->
      </queries>
    </report>
    <report name="34188" form="34188" title="Отчет о вложенных документах с реестром" edit-columns="2" nogrid="1" folder="invpro" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="34188.xml" title="Отчет о вложенных документах с реестром" del-cols="1" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="34188" as="a" title="Данные">
          <withparams>
            <usepart part="34188-withparams" />
          </withparams>
        </query>
        <query name="form:34188" as="b" title="Параметры" />
      </queries>
    </report>
    <report name="34189-test-vertica" form="34188" title="Отчет о вложенных документах с реестром" edit-columns="2" nogrid="1" folder="invpro" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <params>
        <usepart part="34188-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="34188.xml" title="Отчет о вложенных документах с реестром" del-cols="1" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="34188" as="a" title="Данные">
          <withparams>
            <usepart part="34188-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="38486" form="38486" title="Отчет для департамента строительного контроля" nogrid="1" folder="invpro" timestamp="22.05.2017 13:16:55" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <params>
        <usepart part="38486-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="38486.xml" title="Отчет для департамента строительного контроля" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="38486-gr" as="a" title="Данные">
          <withparams>
            <usepart part="38486-withparams" />
          </withparams>
        </query>
        <query name="form:38486" as="b" title="Параметры" />
        <query name="38486-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="38486-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="30196" folder="kido" form="30196" visible="1" title="Отчет о согласовании и подписании договоров об осуществлении технологического присоединения" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <params>
        <param name="dates" />
        <param name="datepo" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="30196.xml" title="Отчет о согласовании и подписании договоров об осуществлении технологического присоединения" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="30196-group" as="a">
          <withparams>
            <useparam name="dates" />
            <useparam name="datepo" />
          </withparams>
        </query>
        <query name="30196-title" as="t">
          <withparams>
            <useparam name="dates" />
            <useparam name="datepo" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535" title="Форма 2 (Старая)" form="33535" folder="forms_tp" timestamp="02.06.2017 16:14:30" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <usepart part="33535-params" />
      </params>
      <print-templates>
        <excel>
          <template name="33535.xml" title="Форма 2" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-title" as="m" title="Шапка">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
        </query>
        <query name="33535" as="a" title="Данные" main="1">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
          <!--<columns>
            <column table="a" name="grsetid"/>
            <column table="a" name="parent_growid"/>
            <band title ="Действующие  договоры на начало">
              <band title ="ВСЕГО">
                <column table="a" name="power2_7_sum" type="number" title="кВт"/>
                <column table="a" name="col2_7_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество поданных заявок на ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power8_19_sum" type="number" title="кВт"/>
                <column table="a" name="col8_19_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество направленных проектов договоров ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power20_25_sum" type="number" title="кВт"/>
                <column table="a" name="col20_25_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power26_31_sum" type="number" title="кВт"/>
                <column table="a" name="col26_31_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество направленных проектов договоров ТП за отчетный период с нарушением установленных сроков направления">
              <column table="a" name="power32_33_sum" type="number" title="кВт"/>
              <column table="a" name="col32_33_count" type="number" title="шт"/>
            </band>
            <band title ="Фактическая длительность рассмотрения заявки ТП &quot;заявка-оферта&quot; по офертам, направленным в отчетном периоде">
              <column table="a" name="col34_count" type="number" title="суммарное количество дней"/>
            </band>
            <band title ="Заявки, аннулированные за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power35_36_sum" type="number" title="кВт"/>
                <column table="a" name="col35_36_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по инициативе заявителя">
                <column table="a" name="power37_38_sum" type="number" title="кВт"/>
                <column table="a" name="col37_38_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Заключено договоров ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power39_44_sum" type="number" title="кВт"/>
                <column table="a" name="col39_44_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power45_50_sum" type="number" title="кВт"/>
                <column table="a" name="col45_50_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 4 мес.для заявителей до 670 кВт или 1 год для заявителей свыше 670 кВт&quot;">
                <column table="a" name="power51_54_sum" type="number" title="кВт"/>
                <column table="a" name="col51_54_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 6 мес.&quot;">
                <column table="a" name="power55_58_sum" type="number" title="кВт"/>
                <column table="a" name="col55_58_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Заключено дополнительных соглашений за отчетный период на изменение запрашиваемой максимальной мощности по договорам ТП">
              <column table="a" name="power59_60_sum" type="number" title="кВт"/>
              <column table="a" name="col59_60_count" type="number" title="шт"/>
            </band>
            <band title ="Расторгнутые договоры ТП за отчетный период">
              <column table="a" name="power61_62_sum" type="number" title="кВт"/>
              <column table="a" name="col61_62_count" type="number" title="шт"/>
            </band>
            <band title ="Исполнено договоров ТП за отчетный период (подписанные акты ТП) по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power63_68_sum" type="number" title="кВт"/>
                <column table="a" name="col63_68_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power69_74_sum" type="number" title="кВт"/>
                <column table="a" name="col69_74_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 4 мес.для заявителей до 670 кВт или 1 год для заявителей свыше 670 кВт&quot;">
                <column table="a" name="power75_78_sum" type="number" title="кВт"/>
                <column table="a" name="col75_78_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 6 мес.&quot;">
                <column table="a" name="power79_82_sum" type="number" title="кВт"/>
                <column table="a" name="col79_82_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Исполнено договоров ТП за отчетный период (подписанные акты ТП) с нарушением установленных сроков технологического присоединения">
              <column table="a" name="power83_84_sum" type="number" title="кВт"/>
              <column table="a" name="col83_84_count" type="number" title="шт"/>
            </band>
            <band title ="Общее количество дней на осуществление ТП по договорам ТП, исполненным за отчетный период &quot;заявка-акт&quot;">
              <column table="a" name="col85_count" type="number" title="суммарное количество дней"/>
            </band>
            <band title ="Фактическая длительность выполнения договора ТП по договорам ТП, исполненным за отчетный период &quot;договор-акт&quot;">
              <column table="a" name="col86_count" type="number" title="суммарное количество дней"/>
            </band>

            <band title ="Действующие договоры ТП на конец">
              <band title ="ВСЕГО">
                <column table="a" name="power89_94_sum" type="number" title="кВт"/>
                <column table="a" name="col89_94_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. договоры, по которым не исполнены в срок обязательства по договору ТП на конец">
                <band title="ВСЕГО">
                  <column table="a" name="power95_96_sum" type="number" title="кВт"/>
                  <column table="a" name="col95_96_count" type="number" title="шт"/>
                </band>
              </band>
              <band title="Действующие договоры ТП на конец по типу тарифообразования">
                <band title="объем договоров, по ставке C1">
                  <column table="a" name="power99_100_sum" type="number" title="кВт"/>
                  <column table="a" name="col99_100_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по ставке за единицу максимальной мощности &quot;руб./кВт&quot;">
                  <column table="a" name="power101_102_sum" type="number" title="кВт"/>
                  <column table="a" name="col101_102_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по стандартизированным ставкам &quot;руб./км&quot;">
                  <column table="a" name="power103_104_sum" type="number" title="кВт"/>
                  <column table="a" name="col103_104_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по индивидуальному тарифу">
                  <column table="a" name="power105_106_sum" type="number" title="кВт"/>
                  <column table="a" name="col105_106_count" type="number" title="шт"/>
                </band>
              </band>
              <band title="Действующие договоры ТП на конец по типу обязательств">
                <band title="объем договоров с затратами, выполняемых &quot;подрядным способом&quot;">
                  <column table="a" name="power109_110_sum" type="number" title="кВт"/>
                  <column table="a" name="col109_110_count" type="number" title="шт"/>
                </band>
              </band>
            </band>
          </columns>-->
        </query>
      </queries>
    </report>
    <report name="33536" folder="kido" form="33536" visible="1" title="Сводный отчет по действующим ДТПр" timestamp="17.03.2016 01:34:23" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33536.xml">
      <params>
        <param name="dat" type="date" />
        <param name="kod_region" type="array" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33536.xml" title="Сводный отчет по действующим ДТПр" print-proc="2" output-format="xlsb" />
        </excel>
      </print-templates>
      <queries>
        <query name="33536" as="a">
          <withparams>
            <useparam name="dat" />
            <useparam name="kod_region" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="35058" title="Приложение №3 к Приказу от 25.12.15 №609" form="empty" folder="kido" timestamp="29.02.2016 19:17:24" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <print-templates>
        <excel>
          <template name="35058.xml" title="Приложение №3 к Приказу от 25.12.15 №609" print-proc="2" cells-delete="1" rows-height="1" page-breaks="1" />
        </excel>
      </print-templates>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="35058-rep" as="h" title="0" />
        <query name="35058-gr" as="a" node-id="growid" parent-node-id="parent_growid" title="1" />
        <query name="35058-simple" as="s" main="1" title="2">
          <events>
            <useaction action-type="open-report" call="35058-detail" event-name="double-click">
              <column table="s" column="kod_direct" />
              <column table="s" column="status" />
              <column table="s" column="req_year_fl" />
              <column table="s" column="kod_mo" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="35058-detail" title="Приложение №3 к Приказу от 25.12.15 №609 (детализация)" form="empty" folder="kido" visible="0" timestamp="12.02.2016 17:42:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35058.xml">
      <params>
        <param name="kod_direct" />
        <param name="status" />
        <param name="year" />
        <param name="kod_mo" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <queries>
        <query name="35058-detail" as="a">
          <withparams>
            <useparam name="kod_direct" />
            <useparam name="status" />
            <useparam name="year" />
            <useparam name="kod_mo" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="35210" folder="invpro_ofz" visible="0" form="35210" title="Аналитика по абонентским договорам и договорам подряда ПАО 'Ленэнерго'" timestamp="11.04.2016 10:18:54" mode="excel" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <params>
        <param name="dat" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="35210.xml" title="Аналитика по абонентским договорам и договорам подряда ПАО 'Ленэнерго'" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="35210" as="a">
          <withparams>
            <useparam name="dat" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-grouping-detail" call="35210-detail" />
          </events>
        </query>
        <query name="35210-title" as="t">
          <withparams>
            <useparam name="dat" />
          </withparams>
        </query>
      </queries>
    </report>
    <report form="41293" name="41293" title="Абонентские договоры 2 (ВСЯ БАЗА)" nogrid="1" folder="kido" datareader="1" timestamp="11.08.2017 14:04:03" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <params>
        <usepart part="41293-params" />
      </params>
      <procedure>
begin
    is_job.set_id_slice(:id_slice);
end;
</procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="41293.xlsx" title="Абонентские договоры 2 (ВСЯ БАЗА)" print-proc="2" output-format="xlsb" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query name="41293-data" as="a">
          <withparams>
            <usepart part="41293-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report form="41293-cur" name="41293-cur" title="Абонентские договоры (ВСЯ БАЗА) оперативный" nogrid="1" folder="kido" timestamp="17.01.2019 18:52:05" visible="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <params>
        <usepart part="41293-params-ext" />
      </params>
      <procedure exclude="1">
begin
    is_job.set_id_slice(:id_slice);
end;
</procedure>
      <procedure>
begin
    declare arr_count number:=0;
    begin
        delete from vr_number_array where array_id = 'is_ad_sl_ADs';
        insert into vr_number_array
        select 'is_ad_sl_ADs' as array_id, a.kod_dop_contract as val
        from is_dop_contract a
        where {a.kod_dop_contract in :kod_dop_contract or} 1=0;

        select count(*) into arr_count from vr_number_array where array_id = 'is_ad_sl_ADs';

        if arr_count &gt; 0 then	    
            is_ad_slice.ins_ad_all(sysdate, 1);
        end if;
    end;
end;
</procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="41293-cur.xlsx" title="Абонентские договоры 2 (ВСЯ БАЗА) оперативный" print-proc="2" output-format="xlsb" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query name="41293-data-par" as="a">
          <withparams>
            <usepart part="41293-withparams-ext" />
          </withparams>
        </query>
      </queries>
    </report>
    <report form="empty" name="41293-actual" title="Абонентские договоры (ВСЯ БАЗА)" nogrid="1" folder="kido" datareader="1" timestamp="11.08.2017 14:03:29" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="41293.xlsx" title="Абонентские договоры (ВСЯ БАЗА)" print-proc="2" output-format="xlsb" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query name="isv_ad_all" as="a" />
      </queries>
    </report>
    <report name="43430" title="Отчет по оплате договоров, заключенных ПАО «Россети Ленэнерго» с субъектами МСП" timestamp="02.10.2020 10:28:46" form="43430" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <params>
        <usepart part="43430-params" />
      </params>
      <procedure>
declare
    status number;
    errmsg VARCHAR2(100);
    --date_s date;

begin

--select min(a.dat_doc) into date_s from is_vip_dog a {where a.dat_doc = :p_date_s};

insert into vr_number_array
select 'p_kod_predpr', a.id
from isv_vks_predpr a {where a.id in :kod_predpr};

is_soh_otchet.p_pd_msp_akt( 150,    -----Номер отчета 150
                            --date_s,      ---- Дата отчета
                            :p_date_s,      ---- Дата отчета
                            :p_date_po,      ---- Дата отчета
                            null,   ----Перечисление подразделений. заполняется , если n_flag = 1 для QueryView
                            'p_kod_predpr',   --- Наименов массива (от Бельченко А)
                            0,     ---n_flag = 1 для QueryView.иначе 0 или пусто
                            status,
                            errmsg
                            );
   
end;
</procedure>
      <print-templates>
        <excel>
          <template name="43430.xlsx" title="Отчет по оплате договоров, заключенных ПАО «Россети Ленэнерго» с субъектами МСП" print-proc="2" print-xlsx="1" use-flexcel="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="43430-detail" as="a">
          <withparams>
            <usepart part="43430-useparams" />
          </withparams>
        </query>
        <query name="43430-itog" as="b">
          <withparams>
            <usepart part="43430-useparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report form="empty" name="ASV_REQUEST_ALL" title="Журнал Заявок на ТП" nogrid="1" folder="kido" datareader="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\asv_request_all.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="ASV_REQUEST_ALL.xml" title="Журнал Заявок на ТП" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="ASV_REQUEST_ALL" as="a" />
      </queries>
    </report>
    <report form="empty" name="is_rep_rosseti" title="Отчет для Россетей" nogrid="1" folder="kido" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\is_rep_rosseti.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="is_rep_rosseti.xml" title="Данные заявок на ТП" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="is_rep_rosseti" as="a" />
      </queries>
    </report>
    <report name="OTCHET_147_DOG_SOBSTV" title="Отчет о заключенных договорах и собственниках контрагентов" folder="kido" form="OTCHET_147_DOG_SOBSTV" timestamp="25.11.2023 22:29:47" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="27207_dog.xlsx" title="Отчет о заключенных договорах и собственниках контрагентов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <params>
        <param name="s_dog_type" type="array" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="n_sum_s" type="number" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="n_sum_po" type="number" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="s_status" type="array" />
        <param name="s_date_active_s" type="date" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="s_date_active_po" type="date" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="s_year" type="array" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="n_ram" type="number" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="n_status" type="number" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="s_errmsg" type="string" part-id="OTCHET_147_DOG_SOBSTV_PARAM" />
        <param name="is_dogovor_list" type="array" />
        <param name="is_dop_contr_list" type="array" />
      </params>
      <procedure>
    declare
        v_dog_type            VARCHAR2(100 CHAR);
        v_status              VARCHAR2(100 CHAR);
        v_year                VARCHAR2(500 CHAR);
        /*v_is_dog_list         CLOB;
        v_is_dop_contr_list   CLOB;*/
    begin
        SELECT NVL(LISTAGG(id, ',') WITHIN GROUP(ORDER BY id), '0,1,2,3')
        INTO v_dog_type
        FROM (
            SELECT 0 AS id, 'Доходные' AS dog_type FROM dual
            UNION ALL
            SELECT 1, 'Расходные' FROM dual
            UNION ALL
            SELECT 2, 'Прочие' FROM dual
            UNION ALL
            SELECT 3, 'Договоры ТП' FROM dual
            )
        WHERE id IN /*nvlu*/ :s_dog_type;

        SELECT LISTAGG(status, ',') WITHIN GROUP(ORDER BY status)
        INTO v_status
        FROM is_status
        WHERE status IN /*nvlu*/ :s_status ;

        SELECT LISTAGG(y, ',') WITHIN GROUP(ORDER BY y)
        INTO v_year
        FROM (
            select distinct EXTRACT(YEAR FROM dat_day) y
            from vv_day
            where EXTRACT(YEAR FROM dat_day) IN /*nvlu*/ :s_year 
            );

        /*select
            RTRIM(
                XMLAGG(XMLELEMENT(e, d.kod_dog, ',').EXTRACT('//text()')).GetClobVal(),
                ',')
        into v_is_dog_list
        from is_dogovor d
        where d.kod_dog IN*/ /*nvlu*/ /*:is_dogovor_list ;*/
          
        DELETE FROM is_rab WHERE polzov = 'TBL_DOG_SOBSTV_IS_DOGOVOR' and s51 = user;
        INSERT INTO is_rab (polzov, s51, n1)
        SELECT 'TBL_DOG_SOBSTV_IS_DOGOVOR', user, d.kod_dog
        FROM is_dogovor d
        WHERE d.kod_dog IN /*nvlu*/ :is_dogovor_list;

        /*select
            RTRIM(
                XMLAGG(XMLELEMENT(e, dc.kod_dop_contract, ',').EXTRACT('//text()')).GetClobVal(),
                ',')
        into v_is_dop_contr_list
        from is_dop_contract dc
        where dc.kod_dop_contract IN*/ /*nvlu*/ /*:is_dop_contr_list ;*/
          
        DELETE FROM is_rab WHERE polzov = 'TBL_DOG_SOBSTV_IS_DOP_CONTRACT' and s51 = user;
        INSERT INTO is_rab (polzov, s51, n1)
        SELECT 'TBL_DOG_SOBSTV_IS_DOP_CONTRACT', user, dc.kod_dop_contract
        FROM is_dop_contract dc
        WHERE dc.kod_dop_contract IN /*nvlu*/ :is_dop_contr_list;

        is_otchet_147.p_otch_147(/*nvlu*/ :n_sum_s, /*nvlu*/ :n_sum_po, v_status, /*nvlu*/ :s_date_active_s, /*nvlu*/ :s_date_active_po, v_year, 0, NVL(/*nvlu*/ :n_ram, 0), v_dog_type, /*v_is_dog_list, v_is_dop_contr_list,*/ :n_status, :s_errmsg);
    end;
</procedure>
      <queries>
        <query name="ISV_OTCHET_147_DOG_SOBSTV" as="a" />
      </queries>
    </report>
    <report name="OTCHET_147_DOG_SOBSTV_DOP" title="Отчет о дополнительных соглашениях" folder="kido" form="OTCHET_147_DOG_SOBSTV_DOP" timestamp="01.12.2023 20:51:51" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="27207_dop_dog.xlsx" title="Отчет о дополнительных соглашениях" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <params>
        <usepart part="OTCHET_147_DOG_SOBSTV_PARAM" />
      </params>
      <procedure>
        declare
          v_dog_type            VARCHAR2(100 CHAR);
          v_status              VARCHAR2(100 CHAR);
          v_year                VARCHAR2(500 CHAR);
        begin
          SELECT NVL(LISTAGG(id, ',') WITHIN GROUP(ORDER BY id), '0,1,2,3')
          INTO v_dog_type
          FROM (
            SELECT 0 AS id, 'Доходные' AS dog_type FROM dual
            UNION ALL
            SELECT 1, 'Расходные' FROM dual
            UNION ALL
            SELECT 2, 'Прочие' FROM dual
            UNION ALL
            SELECT 3, 'Договоры ТП' FROM dual
            )
          WHERE id IN /*nvlu*/ :s_dog_type;

          SELECT LISTAGG(y, ',') WITHIN GROUP(ORDER BY y)
          INTO v_year
          FROM (
              select distinct EXTRACT(YEAR FROM dat_day) y
              from vv_day
              where EXTRACT(YEAR FROM dat_day) IN /*nvlu*/ :s_year 
              );
        
        	is_otchet_147.p_otch_147(/*nvlu*/ :n_sum_s, /*nvlu*/ :n_sum_po, NULL, /*nvlu*/ :s_date_active_s, /*nvlu*/ :s_date_active_po, v_year, 1, NVL(/*nvlu*/ :n_ram, 0), v_dog_type, /*NULL, NULL,*/ :n_status, :s_errmsg);
        end;
      </procedure>
      <queries>
        <query name="ISV_OTCHET_147_DOG_SOBSTV" as="a" />
      </queries>
    </report>
    <report name="OTCHET_SUBPODR" title="Отчет по субподрядчикам" folder="kido" timestamp="18.07.2022 15:36:33" form="OTCHET_SUBPODR" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="63870.xlsx" title="Отчет по субподрядчикам" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <params>
        <param name="s_dog_type" type="array" />
        <param name="n_sum_s" type="number" />
        <param name="n_sum_po" type="number" />
        <param name="s_status" type="array" />
        <param name="s_date_active_s" type="date" />
        <param name="s_date_active_po" type="date" />
        <param name="s_year" type="array" />
        <param name="n_ram" type="number" />
        <param name="n_status" type="number" />
        <param name="s_errmsg" type="string" />
        <param name="is_dogovor_list" type="array" />
      </params>
      <procedure>
        declare
        v_dog_type            VARCHAR2(100 CHAR);
        v_status              VARCHAR2(100 CHAR);
        v_year                VARCHAR2(500 CHAR);
        v_is_dog_list         CLOB;
        begin
        SELECT NVL(LISTAGG(id, ',') WITHIN GROUP(ORDER BY id), '0,1,2')
        INTO v_dog_type
        FROM (
        SELECT 0 AS id, 'Доходные' AS dog_type FROM dual
        UNION ALL
        SELECT 1, 'Расходные' FROM dual
        UNION ALL
        SELECT 2, 'Прочие' FROM dual
        )
        WHERE id IN /*nvlu*/ :s_dog_type;

        select LISTAGG(status, ',') WITHIN GROUP(ORDER BY status)
        into v_status
        from is_status
        where status IN /*nvlu*/ :s_status ;

        SELECT LISTAGG(y, ',') WITHIN GROUP(ORDER BY y)
        INTO v_year
        FROM (
        select distinct EXTRACT(YEAR FROM dat_day) y
        from vv_day
        where EXTRACT(YEAR FROM dat_day) IN /*nvlu*/ :s_year
        );

        select
        RTRIM(
        XMLAGG(XMLELEMENT(e, d.kod_dog, ',').EXTRACT('//text()')).GetClobVal(),
        ',')
        into v_is_dog_list
        from is_dogovor d
        where d.kod_dog IN /*nvlu*/ :is_dogovor_list ;

        is_otchet_subpodr.p_otch_subpodr(/*nvlu*/ :n_sum_s, /*nvlu*/ :n_sum_po, v_status, /*nvlu*/ :s_date_active_s, /*nvlu*/ :s_date_active_po, v_year, 0, NVL(/*nvlu*/ :n_ram, 0), v_dog_type, v_is_dog_list, :n_status, :s_errmsg);
        end;
      </procedure>
      <queries>
        <query name="ISV_OTCHET_SUBPODR" as="a" />
      </queries>
    </report>
    <report name="SHABL5_DOG_PRIS" folder="kido" visible="1" form="SHABL5_DOG_PRIS" title="Приложение 5 Шаблон предоставления сведений договорам" timestamp="16.07.2021 09:52:37" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON5_DOG_PRIS.xml" title="Приложение 5 Шаблон предоставления сведений договорам" print-proc="2" />
        </excel>
      </print-templates>
      <params>
        <param name="n_prizn" type="number" />
        <param name="s_status" type="array" />
        <param name="s_num_dog" type="string" />
        <param name="n_kind_prizn" type="number" />
        <param name="s_date_active_s" type="date" />
        <param name="s_date_active_po" type="date" />
      </params>
      <procedure>
        begin
        is_prn_shab.p_rep_shabl_dog(:n_prizn, :s_status, :s_num_dog, /*nvlu*/ :s_date_active_s, /*nvlu*/ :s_date_active_po, null, null, :n_kind_prizn);
        end;
</procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL5_DOG_PRIS_0" title="Шаблон 5 Договоры (доходные)" nogrid="1" folder="kido" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON5_DOG_PRIS.xml" title="Приложение 5 Шаблон предоставления сведений по доходным договорам" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_dog (0);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL5_DOG_PRIS_2" title="Шаблон 5 Договоры (присоединения АДДТП)" nogrid="1" folder="kido" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON5_DOG_PRIS.xml" title="Приложение 5 Шаблон предоставления сведений по договорам присоединения" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_dog (2);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL5_DOG_PRIS_3" title="Шаблон 5 Договоры (присоединения ДД)" nogrid="1" folder="kido" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON5_DOG_PRIS.xml" title="Приложение 5 Шаблон предоставления сведений по договорам присоединения" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_dog (3);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report name="SHABL6_CRED_PRIS" folder="kido" visible="1" form="SHABL6_CRED_PRIS" title="Шаблон 6 Контрагенты" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON6_CRED_PRIS.xml" title="Приложение 6 Шаблон предоставления сведений по контрагентам" print-proc="2" />
        </excel>
      </print-templates>
      <params>
        <param name="n_prizn" type="number" />
      </params>
      <procedure>
        begin
        is_prn_shab.p_rep_shabl_cred(:n_prizn);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL6_PRIS" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL6_CRED_1" title="Шаблон 6 Контрагенты (по расходным договорам)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:27:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON6_CRED_PRIS.xml" title="Приложение 6 Шаблон предоставления сведений по контрагентам (расходные договоры)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_cred (1);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL6" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL6_CRED_0" title="Шаблон 6 Контрагенты (по доходным договорам)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:27:44" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON6_CRED_PRIS.xml" title="Приложение 6 Шаблон предоставления сведений по контрагентам (доходные договоры)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_cred (0);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL6" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL6_CRED_2" title="Шаблон 6 Контрагенты (присоединение)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:28:58" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON6_CRED_PRIS.xml" title="Приложение 6 Шаблон предоставления сведений по контрагентам (присоединение)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_cred (2);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL6" as="a" />
      </queries>
    </report>
    <report name="SHABL7_RS_PRIS" folder="kido" visible="1" form="SHABL7_RS_PRIS" title="Шаблон 7 Расч.счета" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON7_RS_PRIS.xml" title="Приложение 7 Шаблон представления сведений по расчетным счетам" print-proc="2" />
        </excel>
      </print-templates>
      <params>
        <param name="n_prizn" type="number" />
      </params>
      <procedure>
        begin
        is_prn_shab.p_rep_shabl_rs(:n_prizn);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL7_PRIS" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL7_RS_0" title="Шаблон 7 Расч.счета (доходные договоры)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:41:35" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON7_RS_PRIS.xml" title="Приложение 7 Шаблон представления сведений по расчетным счетам (доходные договоры)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_rs (0);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL7" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL7_RS_1" title="Шаблон 7 Расч.счета (расходные договоры)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:42:48" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON7_RS_PRIS.xml" title="Приложение 7 Шаблон представления сведений по расчетным счетам (расходные договоры)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_rs (1);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL7" as="a" />
      </queries>
    </report>
    <report form="empty" name="SHABL7_RS_2" title="Шаблон 7 Расч.счета (присоединение)" nogrid="1" folder="kido" visible="0" timestamp="26.02.2016 23:42:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABLON7_RS_PRIS.xml" title="Приложение 7 Шаблон представления сведений по расчетным счетам (присоединение)" print-proc="2" />
        </excel>
      </print-templates>
      <procedure>
        begin
        IS_PRN_SHAB.p_rep_shabl_rs (2);
        end;
      </procedure>
      <queries>
        <query name="ISV_REP_SHABL7" as="a" />
      </queries>
    </report>
    <report name="SHABL5_DOG_PODR_INSURANCE" folder="kido" visible="1" form="SHABL5_DOG_PODR_INSURANCE" title="Шаблон предоставления сведений по договорам подряда СМР и страхования" timestamp="21.04.2023 10:56:06" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shabl_dog_podr_insurance.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABL5_DOG_PODR_INSURANCE.xml" print-proc="2" title="Шаблон предоставления сведений по договорам подряда СМР и страхования" />
        </excel>
      </print-templates>
      <params>
        <param name="s_status" type="array" />
        <param name="s_num_dog" type="string" />
        <param name="n_kind_prizn" type="number" />
        <param name="s_date_active_s" type="date" />
        <param name="s_date_active_po" type="date" />
        <param name="s_date_insur_s" type="date" />
        <param name="s_date_insur_po" type="date" />
        <param name="s_date_active2_s" type="date" />
        <param name="s_date_active2_po" type="date" />
        <param name="s_date_insur2_s" type="date" />
        <param name="s_date_insur2_po" type="date" />
        <param name="s_dog_predpr" type="array" />
      </params>
      <procedure>
    begin
        is_prn_shab.p_rep_shabl_dog(4, :s_status, :s_num_dog, :s_date_active_s, :s_date_active_po, :s_date_insur_s, :s_date_insur_po, :n_kind_prizn, :s_date_active2_s, :s_date_active2_po, :s_date_insur2_s, :s_date_insur2_po, :s_dog_predpr);
    end;
</procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report name="SHABL5_DOG_PODR_INSURANCE_2" folder="kido" visible="1" form="SHABL5_DOG_PODR_INSURANCE_2" title="Шаблон предоставления сведений по договорам страхования" timestamp="02.09.2020 12:17:31" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shabl_dog_podr_insurance.xml">
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="SHABL5_DOG_PODR_INSURANCE_2.xml" print-proc="2" title="Шаблон предоставления сведений по договорам страхования" />
        </excel>
      </print-templates>
      <params>
        <param name="s_status" type="array" />
        <param name="s_num_dog" type="string" />
        <param name="s_date_active_s" type="date" />
        <param name="s_date_active_po" type="date" />
        <param name="s_date_insur_s" type="date" />
        <param name="s_date_insur_po" type="date" />
      </params>
      <procedure>
    begin
        is_prn_shab.p_rep_shabl_dog(5, :s_status, :s_num_dog, :s_date_active_s, :s_date_active_po, :s_date_insur_s, :s_date_insur_po);
    end;
</procedure>
      <queries>
        <query name="ISV_REP_SHABL5_PRIS" as="a" />
      </queries>
    </report>
    <report name="33535-f1" title="Форма 1" nogrid="1" timestamp="31.05.2017 17:16:09" folder="forms_tp" form="33535-f1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f1.xlsx" title="Форма 1" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f1-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f2" title="Форма 2" nogrid="1" timestamp="27.12.2017 15:40:26" folder="forms_tp" form="33535-f1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <print-templates>
        <excel>
          <template name="33535-f2.xlsx" title="Форма 2" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f2-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f4" title="Форма 4" nogrid="1" timestamp="31.05.2017 17:16:04" folder="forms_tp" form="33535-f4" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f4.xlsx" title="Форма 4" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f4-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f6" title="Форма 6" nogrid="1" timestamp="31.05.2017 17:15:54" folder="forms_tp" datareader="1" form="33535-f4" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f6.xlsx" title="Форма 6" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f6-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f7" title="Форма 7" nogrid="1" timestamp="31.05.2017 17:15:45" folder="forms_tp" datareader="1" form="33535-f4" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f7.xlsx" title="Форма 7" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f7-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f8" title="Форма 8" nogrid="1" timestamp="02.06.2017 16:15:25" folder="forms_tp" datareader="1" form="33535-f1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f8.xlsx" title="Форма 8" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f8-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44098" timestamp="01.05.2018 12:50:19" title="Отчет по срокам подготовки договоров(подробный)" nogrid="1" form="44098" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <param name="p_ym1" type="number" part-id="44098-params" exclude="1">
          <const>201701</const>
        </param>
        <param name="p_ym2" type="number" part-id="44098-params" exclude="1">
          <const>201712</const>
        </param>
        <param name="p_ym3" type="number" part-id="44098-params" exclude="1">
          <const>201701</const>
        </param>
        <param name="p_ym4" type="number" part-id="44098-params" exclude="1">
          <const>201712</const>
        </param>
        <param name="p_dt1" type="date" part-id="44098-params">
          <const>date'2018-03-01'</const>
        </param>
        <param name="p_dt2" type="date" part-id="44098-params">
          <const>date'2018-03-30'</const>
        </param>
        <param name="p_dt3" type="date" part-id="44098-params">
          <const>date'2018-03-01'</const>
        </param>
        <param name="p_dt4" type="date" part-id="44098-params">
          <const>date'2018-03-30'</const>
        </param>
        <param name="p_list_type" type="number" part-id="44098-params">
          <const>1</const>
        </param>
      </params>
      <print-templates>
        <excel>
          <template name="44098-1.xlsx" title="Отчет по срокам подготовки договоров" print-proc="2" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query name="44098-1" as="a">
          <withparams>
            <useparam name="p_dt1" part-id="44098-useparams" />
            <useparam name="p_dt2" part-id="44098-useparams" />
            <useparam name="p_dt3" part-id="44098-useparams" />
            <useparam name="p_dt4" part-id="44098-useparams" />
            <useparam name="p_list_type" part-id="44098-useparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44098-2" timestamp="23.01.2018 15:51:40" title="Отчет по срокам подготовки договоров (сводный)" nogrid="1" form="44098" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <print-templates>
        <excel>
          <template name="44098-2.xlsx" title="Отчет по срокам подготовки договоров(сводный)" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="44098-2" as="b">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-2-2" as="bi">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-2-3" as="c">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-2-4" as="d">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44098-3" timestamp="24.09.2018 14:58:33" title="Отчет по срокам подготовки договоров (ВКС)" nogrid="1" form="44098-3" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" />
      </params>
      <print-templates>
        <excel>
          <template name="44098-3.xlsx" title="Отчет по срокам подготовки договоров (ВКС)" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="44098-3-1" as="q1">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-3-2" as="q2">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-3-3" as="q3">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-3-4" as="q4">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-3-5" as="q5">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query name="44098-3-6" as="q6">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
        <query as="a" name="44098-3-detail">
          <withparams>
            <usepart part="44098-useparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44098-4" timestamp="24.05.2018 12:54:55" title="Отчет по заявкам для ИЦ" nogrid="1" form="44098-4" use-repository="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-params" exclude="1" />
        <param name="p_dt3" type="date">
          <const>to_date('19.03.2018','DD.MM.YYYY')</const>
        </param>
        <param name="p_dt4" type="date">
          <const>to_date('26.03.2018','DD.MM.YYYY')</const>
        </param>
        <param name="load_type_id" type="array" />
        <param type="array" name="kod_subject" />
        <param name="p_power_gt" type="number" />
        <param name="p_power_ls" type="number" />
      </params>
      <print-templates>
        <excel>
          <template name="44098-4.xlsx" title="Отчет по заявкам для ИЦ" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query as="a" name="44098-4">
          <withparams>
            <useparam name="p_dt3" type="date" />
            <useparam name="p_dt4" type="date" />
            <useparam name="load_type_id" type="array" />
            <useparam name="kod_subject" />
            <useparam name="p_power_gt" />
            <useparam name="p_power_ls" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44098-3-49576" timestamp="08.10.2018 15:55:48" title="Отчет по срокам подготовки договоров (ВКС все договоры)" nogrid="1" form="44098-3-49576" use-repository="1" datareader="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <params>
        <usepart part="44098-3-49576-params" />
      </params>
      <print-templates>
        <excel>
          <template name="44098-3-49576.xlsx" title="Отчет по срокам подготовки договоров (ВКС)" print-proc="2" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <queries>
        <query as="a" name="44098-3-49576-detail">
          <withparams>
            <usepart part="44098-3-49576-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="44164" form="44164" title="Отчёт по использованию денежных средств (авансов) от заявителей" visible="0" timestamp="26.10.2017 01:38:10" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <params>
        <usepart part="44164-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <print-templates>
        <excel>
          <template name="44164.xlsx" print-proc="2" print-xlsx="1" title="Отчёт по использованию денежных средств (авансов) от заявителей" />
        </excel>
      </print-templates>
      <queries>
        <query as="p2" main="1" name="44164" title="прил 2">
          <withparams>
            <usepart part="44164-useparams" />
          </withparams>
        </query>
        <query name="44164-title" as="t">
          <withparams>
            <usepart part="44164-useparams" />
          </withparams>
        </query>
        <query as="p1" name="44164-p1" title="прил 1">
          <withparams>
            <usepart part="44164-useparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report form="44890" name="44890" title="Реестр заявок на постоянное ТП свыше 5 МВт" timestamp="28.03.2018 15:12:19" nogrid="1" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <params>
        <param name="id_slice" type="number">
          <const>424</const>
        </param>
        <param type="date" name="p_dat">
          <const>sysdate</const>
        </param>
      </params>
      <print-templates>
        <excel>
          <template name="44890.xlsx" title="Реестр заявок на постоянное ТП свыше 5 МВт" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="44890-gr" as="b" title="111">
          <query name="44890-detail" as="a" title="222">
            <call function="=">
              <column table="a" column="req_type" />
              <column table="b" column="req_type" />
            </call>
            <withparams>
              <useparam name="id_slice" />
            </withparams>
          </query>
          <withparams>
            <useparam name="id_slice" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="ipr_ofz_tit_order" title="Нумерация титулов в отчетах ОФЗ" timestamp="07.11.2018 11:47:46" is-report="1" folder="invpro_ofz" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\forms\ipr_ofz_tit_order.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <grid table="a" show-toolbar="1">
          <columns>
            <column table="a" column="npp" title="Порядковый номер" />
            <column table="a" column="kod_titul_ip" title="Титул" />
            <column table="kod_titul_ip" column="name" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="ipr_ofz_tit_order" as="a">
          <link name="kod_titul_ip" />
        </query>
      </from>
    </form>
    <form name="ipt_summ_1c" timestamp="07.11.2018 11:47:16" title="ipt_summ_1c" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\forms\ipt_summ_1c.xml">
      <content>
        <grid show-toolbar="1" table="a">
          <columns>
            <column table="a" column="kod_ipt_summ_1c" />
            <column table="a" column="requests" />
            <column table="a" column="tit_num_new" />
            <column table="a" column="kod_titul_ip" />
            <column table="a" column="name" />
            <column table="a" column="kod_ispolnit" />
            <column table="a" column="kod_vid_zatrat" />
            <column table="a" column="summ" />
            <column table="a" column="pr" />
            <column table="a" column="kod_vid_zajavki" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="ipt_summ_1c" as="a" />
      </from>
    </form>
    <form name="vr_doc_reestr_folders" title="Настройка списка выходных каталогов" timestamp="07.11.2018 11:45:35" is-report="1" folder="rep_avans" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\forms\vr_doc_reestr_folders.xml">
      <customers exclude="1">
        <customer id="17" />
      </customers>
      <content>
        <grid table="vr_doc_reestr_folders" show-toolbar="1">
          <columns>
            <column table="vr_doc_reestr_folders" column="name" title="Каталог" column-width="227" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="vr_doc_reestr_folders" />
      </from>
    </form>
    <form name="vr_doc_reestr_types" title="Настройка выходных каталогов для документов" timestamp="07.11.2018 11:45:53" is-report="1" folder="rep_avans" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\forms\vr_doc_reestr_types.xml">
      <customers exclude="1">
        <customer id="17" />
      </customers>
      <content>
        <grid table="vr_doc_reestr_types" show-toolbar="1">
          <toolbar>
            <uicommand action-type="dynamic-form" call="vr_doc_reestr_folders" modal="1" />
          </toolbar>
          <columns>
            <column table="vr_doc_reestr_types" column="kod_doc_type" title="Тип документа" column-width="238" />
            <column table="vr_doc_reestr_types" column="kod_folder" title="Каталог" column-width="231" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="vr_doc_reestr_types" />
      </from>
    </form>
    <form name="25499" timestamp="21.11.2016 14:26:45" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <content>
        <field name="year" type="number" controlType="UICombo" title="Год" mandatory="1">
          <listquery>
            <query name="25499-year_list" />
          </listquery>
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </field>
        <usepart part="25499-fields" />
        <field name="pr_all_razdel" type="number" controlType="UICheck" title="Выводить пустые разделы ИПР" checked="1" />
        <field name="pr_dont_show_wfp" type="number" controlType="UICheck" title="Не выводить титулы без данных фин.плана" checked="1" />
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="25499-1" timestamp="21.11.2016 14:26:46" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\25499.xml">
      <content>
        <field name="year" type="number" controlType="UICombo" title="Год" mandatory="1">
          <listquery>
            <query name="25499-year_list" />
          </listquery>
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </field>
        <usepart part="25499-fields" />
        <field name="pr_zatrat" type="number" controlType="UICheck" title="Детализация по видам затрат" checked="1" />
        <field name="pr_dog" type="number" controlType="UICheck" title="Детализация по договорам" checked="1" />
        <field name="pr_all_razdel" type="number" controlType="UICheck" title="Выводить пустые разделы ИПР" checked="1" />
        <field name="pr_dont_show_wfp" type="number" controlType="UICheck" title="Не выводить титулы без данных фин.плана" checked="1" />
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="26630" timestamp="14.06.2018 17:45:22" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\26630.xml">
      <content>
        <field name="year" type="number" controlType="UICombo" title="Год" mandatory="1">
          <listquery>
            <query name="25499-year_list" />
          </listquery>
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </field>
        <field name="mon1" type="number" controlType="UICombo" title="С месяца" mandatory="1">
          <listquery>
            <query name="spr_time_mes" />
          </listquery>
        </field>
        <field name="mon2" type="number" controlType="UICombo" title="По месяц" mandatory="1">
          <listquery>
            <query name="spr_time_mes" />
          </listquery>
          <defaultquery>
            <query name="26630_mon_def" />
          </defaultquery>
        </field>
        <field name="period" type="number" controlType="UIList" title="Выделять периоды" parent-field-name="kod_parent" show-nulls="0">
          <listquery>
            <query name="26630_time_intervals" />
          </listquery>
          <defaultquery>
            <query name="26630_time_intervals_def" />
          </defaultquery>
        </field>
        <usepart part="25499-fields" />
        <field name="pr_notaip" type="number" controlType="UICheck" title="Исключить титулы АИП" />
        <field name="kod_titul_ip" type="number" controlType="UIList" title="Титул" parent-field-name="kod_parent_node" val-field-name="kod_titul_ip" expand-all="1">
          <buttons>
            <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
            <menu title="save/load" side="Right">
              <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
              <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
            </menu>
          </buttons>
          <listquery>
            <query name="26630_tituls" />
          </listquery>
        </field>
        <field name="kod2_titul_ip" type="number" controlType="UIList" title="Дочерний/Одиночный титул" visible="0">
          <listquery>
            <query name="26630_list_ipr_data_default" />
          </listquery>
          <defaultquery>
            <query name="26630_list_ipr_data_default" />
          </defaultquery>
        </field>
        <field name="pr_zatrat" type="number" controlType="UICheck" title="Детализация по видам затрат" />
        <field name="pr_dog" type="number" controlType="UICheck" title="Детализация по договорам" />
        <field name="mp" type="number" controlType="UICombo" title="Денежная единица" mandatory="1">
          <listquery>
            <query name="26630-mp" />
          </listquery>
        </field>
        <field name="colsets" type="string" controlType="UIList" title="План/Ожидаемый факт/Факт" special-type="colsets">
          <defaultquery>
            <query name="26630-cols" />
          </defaultquery>
        </field>
        <field name="pr_all_fact" type="number" controlType="UICheck" title="Вывод факта не зависимо от версии ИПР" />
        <field name="pr_all_fact_not" type="number" controlType="UICheck" title="Вывод факта только для выбранной версии ИПР" visible="0">
          <defaultquery>
            <query name="26630-pr_all_fact_not-default_1" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_ofz" />
        <field name="pr_gorobl" type="number" controlType="UICheck" title="Город/область" />
        <field name="pr_tek_smet" type="number" controlType="UICheck" title="Тек. смет. стоимость вместо фикс." />
        <field name="pr_no_zero" type="number" controlType="UICheck" title="Не отображать титулы с нулевыми данными" />
        <field name="pr_pf_gr" type="number" controlType="UICheck" title="Группировать по плановым и внеплановым титулам" />
      </content>
    </form>
    <form name="29319" timestamp="21.11.2016 14:26:57" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\29319.xml">
      <content>
        <field name="date" type="date" controlType="UIDate" title="На дату" mandatory="1">
          <defaultquery>
            <query name="today" />
          </defaultquery>
        </field>
        <field name="pr_aip" type="number" controlType="UICheck" title="Включать объекты АИП" checked="1" />
        <field name="kod_doc" type="number" controlType="UICombo" title="Документ" mandatory="1">
          <listquery>
            <query name="25499-ipr_doc_main_list" />
          </listquery>
        </field>
        <usefield field="ipr_kod_direct" />
        <usefield field="ipr_kod_dirisp_all" name="kod_dir_isp" />
        <field name="mp" type="number" controlType="UICombo" title="Денежная единица" mandatory="1">
          <listquery>
            <query name="26630-mp" />
          </listquery>
          <defaultquery>
            <query name="26630-mp-default" />
          </defaultquery>
        </field>
        <field name="nvalue" type="string" title="Величина процента для форматирования" mandatory="1" controlType="UIText" valuequery="n-const" />
        <field name="pr_ip" type="number" controlType="UICheck" title="Детализация по титулам КС" />
        <field name="pr_aip_detail" type="number" controlType="UICheck" title="Детализация по титулам АИП" />
        <field name="pr_sbor" type="number" controlType="UICheck" title="Отображать головные и  сборные" />
        <field name="colsets" type="string" controlType="UIList" title="Показатели" special-type="colsets" mandatory="1">
          <defaultquery>
            <query name="29319-cols" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="29611" timestamp="21.11.2016 14:26:58" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\29611.xml">
      <content>
        <field name="year" type="number" controlType="UICombo" title="Год" mandatory="1">
          <listquery>
            <query name="25499-year_list" />
          </listquery>
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </field>
        <field name="kv" type="number" controlType="UICombo" title="Период" mandatory="1">
          <listquery>
            <query name="spr_time_kv_ni" />
          </listquery>
          <defaultquery>
            <query name="spr_time_kv_ni_cur" />
          </defaultquery>
        </field>
        <field name="kod_doc" type="number" controlType="UICombo" title="Документ" mandatory="1">
          <listquery>
            <query name="25499-ipr_doc_main_list" />
          </listquery>
        </field>
        <field name="kod_direct" type="number" controlType="UIList" title="Подразделение" show-nulls="0">
          <listquery>
            <query name="25499-ipr_direct" />
          </listquery>
        </field>
        <field name="kod_dirisp" type="number" controlType="UICombo" title="Заказчик/Исполнитель" mandatory="1">
          <listquery>
            <query name="is_spr_dirisp2" />
          </listquery>
          <defaultquery>
            <query name="is_spr_dirisp_isp" />
          </defaultquery>
        </field>
        <field name="pr_notaip" type="number" controlType="UICheck" title="Исключить титулы АИП" />
        <field name="pr_gorobl" type="number" controlType="UICheck" title="Город/область" />
        <field name="krit_autor" type="number" controlType="UICombo" title="ОАО «Россети»/Минэнерго" mandatory="1">
          <listquery>
            <query name="ips_kriteria_otklon_autor" />
          </listquery>
          <defaultquery>
            <query name="ips_kriteria_otklon_autor_def" />
          </defaultquery>
        </field>
        <field name="pr_sbor" type="number" controlType="UICheck" title="Отображать сборные" />
        <field name="colsets_pre" type="string" controlType="UIList" title="План/Лимит">
          <listquery>
            <query name="29611_cols_pf" />
          </listquery>
          <defaultquery>
            <query name="29611_cols_pf" />
          </defaultquery>
        </field>
        <field name="pr_wait" type="number" controlType="UICheck" title="План и ожидаемый факт на месяц" />
        <field name="mes" type="number" controlType="UICombo" mandatory="1" title="Месяц для анализа ожидаемого факта" visible="pr_wait">
          <listquery>
            <query name="spr_time_mes" />
          </listquery>
          <defaultquery>
            <query name="29611_mon_def" />
          </defaultquery>
        </field>
        <field name="colsets" type="string" controlType="UIList" special-type="colsets" title="Вывод колонок" visible="0">
          <defaultquery>
            <query name="29611_cols_def" />
          </defaultquery>
        </field>
        <field name="pr_aip_detail" type="number" controlType="UICheck" title="Детализация по титулам АИП" checked="1" />
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="30576" timestamp="21.11.2016 14:27:01" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\30576.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <field name="kod_doc" type="number" controlType="UICombo" title="Документ" mandatory="1">
          <listquery>
            <query name="25499-ipr_doc_main_list" />
          </listquery>
        </field>
        <field name="kod_direct" type="number" controlType="UIList" title="Подразделение" show-nulls="0">
          <listquery>
            <query name="25499-ipr_direct" />
          </listquery>
        </field>
        <field name="kod_dirisp" type="number" controlType="UICombo" title="Заказчик/Исполнитель" mandatory="1">
          <listquery>
            <query name="is_spr_dirisp2" />
          </listquery>
          <defaultquery>
            <query name="is_spr_dirisp_isp" />
          </defaultquery>
        </field>
        <field name="pr_notaip" type="number" controlType="UICheck" title="Исключить титулы АИП" checked="1" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="30581" timestamp="13.06.2018 14:32:10" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\30581.xml">
      <content>
        <field name="kod_doc" type="number" controlType="UICombo" title="Год ИПР/Документ" mandatory="1">
          <listquery>
            <query name="25499-ipr_doc_main_list" />
          </listquery>
        </field>
        <field name="kod_direct" type="number" controlType="UIList" title="Подразделение">
          <listquery>
            <query name="25499-ipr_direct" />
          </listquery>
        </field>
        <field name="kod_dirisp" type="number" controlType="UICombo" title="Заказчик/Исполнитель" mandatory="1">
          <listquery>
            <query name="is_spr_dirisp2" />
          </listquery>
          <defaultquery>
            <query name="is_spr_dirisp_isp" />
          </defaultquery>
        </field>
        <!--<field name="pr_last" controlType="UICheck" title="Последний документ" checked="1">
        </field>-->
        <field name="kod_doc_kontr" type="number" controlType="UIList" title="Документ-основание (если не задан, берется последний)">
          <listquery>
            <query name="ipr_doc_kontr_list" />
          </listquery>
        </field>
        <field name="date" type="date" controlType="UIDate" title="Документ-основание на дату" mandatory="1">
          <defaultquery>
            <query name="30581-date-def" />
          </defaultquery>
        </field>
        <field name="datef" type="date" controlType="UIDate" title="Фактические данные на дату" mandatory="1">
          <defaultquery>
            <query name="30581-date-def" />
          </defaultquery>
        </field>
        <field name="pr_svod" type="number" controlType="UICheck" title="Сводно по ЛЭ" />
        <field name="pr_detail" type="number" controlType="UICheck" title="С детализацией по титулам" />
        <field name="kod_titul_ip" type="number" controlType="UIList" title="Титул" parent-field-name="kod_parent_node" val-field-name="kod_titul_ip" expand-all="1">
          <buttons>
            <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
            <menu title="save/load" side="Right">
              <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
              <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
            </menu>
          </buttons>
          <listquery>
            <query name="30581_tituls_list">
              <withparams exclude="1">
                <useparam name="kod_doc" />
                <useparam name="kod_direct" />
                <useparam name="kod_dirisp" />
              </withparams>
            </query>
          </listquery>
        </field>
        <field name="kod_name_tmp" type="number" controlType="UICombo" title="Наименование контрольных этапов" mandatory="1">
          <listquery>
            <query name="is_spr_name_template" />
          </listquery>
          <defaultquery>
            <query name="is_spr_name_template_1" />
          </defaultquery>
        </field>
        <field name="pr_gorobl" type="number" controlType="UICheck" title="Город/область" />
        <field name="kod_klass_titul" type="number" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="30923" timestamp="13.12.2016 08:38:30" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\30923.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_doc_osn" />
        <usefield field="ipr_kod_direct" />
        <usefield field="ipr_kod_dirisp_all" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_curfixs" type="string" controlType="UIList" title="Стоимость ИПР" special-type="colsets">
          <defaultquery>
            <query name="30923-cols-tek" />
          </defaultquery>
        </field>
        <field name="pr_smet_detail" type="number" controlType="UICheck" title="Детализация по видам затрат" checked="1" />
        <usefield field="ipr_mp" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="cmn_check" name="show_dog" title="Детализация по договорам" />
      </content>
    </form>
    <form name="32274" timestamp="21.11.2016 14:27:07" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\32274.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="year">
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_mon1" />
        <usefield field="ipr_mon2" />
        <usefield field="ipr_kod_doc" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_pr_sbor" />
        <usefield field="ipr_pr_child" />
        <usefield field="ipr_pr_cognos" />
        <usefield field="ipr_pr_razdel7" />
        <usefield name="kod_titul_ip" field="ipr_kod_titul_ip_full" />
        <usefield field="ipr_mp">
          <defaultquery>
            <query name="32274-mp-default" />
          </defaultquery>
        </usefield>
        <field name="rep_type" type="string" controlType="UICombo" mandatory="1" title="Формат" special-type="selectrep">
          <listquery>
            <query name="32274-rep-type-list" />
          </listquery>
        </field>
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="32443" timestamp="21.11.2016 14:27:09" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\32443.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="year">
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_mon1" />
        <usefield field="ipr_mon2" />
        <usefield field="ipr_kod_doc" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_pr_sbor" />
        <usefield field="ipr_pr_child" />
        <usefield field="ipr_pr_cognos" />
        <usefield field="ipr_pr_razdel7" />
        <usefield name="kod_titul_ip" field="ipr_kod_titul_ip_full" />
        <usefield field="ipr_mp">
          <defaultquery>
            <query name="32443-mp-default" />
          </defaultquery>
        </usefield>
        <field name="rep_type" controlType="UICombo" mandatory="1" title="Формат" special-type="selectrep">
          <listquery>
            <query name="32443-rep-type-list" />
          </listquery>
        </field>
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="38203" timestamp="06.04.2017 16:01:51" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\38203.xml">
      <content>
        <field name="date" type="date" controlType="UIDate" title="На дату" mandatory="1" exclude="1" />
        <field name="year" type="number" controlType="UICombo" title="Год" mandatory="1">
          <listquery>
            <query name="25499-year_list" />
          </listquery>
          <defaultquery>
            <query name="25499-year_def" />
          </defaultquery>
        </field>
        <fieldgroup title="Для плана и факта">
          <field name="mon2" type="number" controlType="UICombo" title="Месяц" mandatory="1">
            <listquery>
              <query name="spr_time_mes" />
            </listquery>
            <defaultquery>
              <query name="38203_mon_def" />
            </defaultquery>
          </field>
          <field name="period" type="number" controlType="UIList" title="Выделять периоды" show-nulls="0">
            <listquery>
              <query name="38203_time_intervals" />
            </listquery>
            <defaultquery>
              <query name="38203_time_intervals" />
            </defaultquery>
          </field>
        </fieldgroup>
        <fieldgroup title="Для ожидаемого факта">
          <field name="mon2w" type="number" controlType="UICombo" title="Месяц" mandatory="1">
            <listquery>
              <query name="spr_time_mes" />
            </listquery>
            <defaultquery>
              <query name="38203_mon_def" />
            </defaultquery>
          </field>
          <field name="periodw" type="number" controlType="UIList" title="Выделять периоды" show-nulls="0">
            <listquery>
              <query name="38203_time_intervals_w" />
            </listquery>
            <defaultquery>
              <query name="38203_time_intervals_w" />
            </defaultquery>
          </field>
        </fieldgroup>
        <field name="pr_aip" type="number" controlType="UICheck" title="Включать объекты АИП" checked="1" />
        <field name="kod_doc" type="number" controlType="UICombo" title="Документ" mandatory="1">
          <listquery>
            <query name="25499-ipr_doc_main_list" />
          </listquery>
        </field>
        <usefield field="ipr_kod_direct" />
        <usefield field="ipr_kod_dirisp_all" name="kod_dirisp" />
        <usefield field="ipr_subject" exclude="1" />
        <field name="mp" type="number" controlType="UICombo" title="Денежная единица" mandatory="1">
          <listquery>
            <query name="26630-mp" />
          </listquery>
          <defaultquery>
            <query name="26630-mp-default" />
          </defaultquery>
        </field>
        <field name="nvalue" type="string" title="Величина процента для форматирования" mandatory="1" controlType="UIText" valuequery="n-const" />
        <usefield field="ipr_kod_titul_ip" />
        <field name="pr_ip" type="number" controlType="UICheck" title="Детализация по титулам КС" />
        <field name="pr_aip_detail" type="number" controlType="UICheck" title="Детализация по титулам АИП" />
        <field name="pr_sbor" type="number" controlType="UICheck" title="Отображать головные и  сборные" />
        <field name="colsets" type="string" controlType="UIList" title="Показатели" special-type="colsets" mandatory="1">
          <defaultquery>
            <query name="29319-cols" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_ofz" />
        <field name="pr_no_zero" type="number" controlType="UICheck" title="Не отображать титулы с нулевыми данными" />
      </content>
    </form>
    <form name="41656" timestamp="17.01.2018 11:42:33" file="sql.builder.templates\sql.builder\projects\ipr\reports\41656.xml">
      <content>
        <usefield field="ipr_kod_direct" title="Филиалы" exclude="1" />
        <usefield field="cmn_list" title="Филиалы" type="number" name="kod_direct" exclude="1">
          <listquery>
            <query name="41656-is_spr_direct_list" />
          </listquery>
        </usefield>
        <usefield field="kido_kod_direct" />
        <usefield field="cmn_list" title="Титулы" type="number" name="kod_titul_ip" rows-limit="100">
          <listquery>
            <query name="ipr_titul_ip_hoz_simple_list" />
          </listquery>
        </usefield>
        <usefield field="cmn_date_cur" title="Дата отчёта" name="dat" show-checkbox="0" mandatory="1" />
        <usefield field="cmn_combo_num" title="Плановые показатели" name="plan_type" show-checkbox="0" mandatory="1">
          <listquery>
            <query name="41656-plan-type" />
          </listquery>
        </usefield>
        <usefield field="cmn_integer" name="week" title="Отчётная неделя" column-editable="0" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-week" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="month" column-editable="0" title="Отчётный месяц" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-month" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="year" column-editable="0" title="Отчётный год" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="id_slice" column-editable="0" title="Слайс" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-slice" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="prev_week" title="Предыдущая неделя месяца" column-editable="0" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-prev-week" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="id_slice_prev_week" column-editable="0" title="Слайс пред. недели" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-slice-prev-week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 1" name="id_slice_all" column-visible="0">
          <defaultquery>
            <query name="41656-slice-all" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="month_next" column-editable="0" title="Следующий месяц" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-month-next" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="year_month_next" column-editable="0" title="Год следующего месяца" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="41656-year-month-next" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="29265" timestamp="04.09.2018 10:38:39" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\29265.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc" mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" mandatory="1" />
        <usefield field="ipr_subject" />
        <usefield field="cmn_combo_str" name="tekfix" title="Cметная стоимость (фиксированная/текущая)" mandatory="1">
          <listquery>
            <query name="29265-cols-tekfix" />
          </listquery>
          <defaultquery>
            <query name="29265-cols-tekfix-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date_cur" name="dat" title="По состоянию на дату" mandatory="1" />
        <usefield field="ipr_pr_notaip" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="cmn_check" title="Подробно" name="is_details" />
        <usefield field="cmn_check" title="Вывод. инф. по актам и РНО" name="is_show_akt" />
        <usefield field="cmn_check" title="Отображать сумму договора без НДС" name="is_show_sum_dog" checked="1" />
        <field name="cols" type="string" controlType="UIList" title="Колонки" special-type="colsets" column-visible="0">
          <defaultquery>
            <query name="29265-cols-def" />
          </defaultquery>
        </field>
        <usefield field="ipr_mp">
          <defaultquery>
            <query name="29265-mp-default" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_ofz" />
        <fieldgroup title="Дата дата начала действия договора">
          <usefield field="cmn_date" title="С" name="dat_dog_s" />
          <usefield field="cmn_date" title="По" name="dat_dog_po" />
        </fieldgroup>
      </content>
    </form>
    <form name="34188" timestamp="25.12.2017 12:58:44" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\34188.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_pr_notaip" />
        <usefield field="ipr_pr_sbor" />
        <usefield field="ipr_pr_child" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_doc_type" />
        <usefield field="ipr_kod_ofz" />
        <fieldgroup title="Дата документа-основания">
          <usefield field="cmn_date" title="С" name="dat_doc_s" width-perc="50" />
          <usefield field="cmn_date" title="По" name="dat_doc_po" width-perc="50" />
        </fieldgroup>
        <usefield field="cmn_check" name="by_cognos_num" title="Формирование пакета обосновывающих документов к титулу" />
        <uicommand action-type="dynamic-form" call="vr_doc_reestr_types" modal="1" title="Настройка выходных каталогов для документов" />
      </content>
    </form>
    <form name="35316-2" timestamp="13.12.2016 01:22:21" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316-2.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_date_cur" name="dat" title="Дата подписания перечня объектов" checked="1" mandatory="1" exclude="1" />
        <usefield field="ipr_kod_doc" title="Год ИПР/Документ" mandatory="1" />
        <usefield field="cmn_date" name="dat_dolg" title="Дата учета задолженности" checked="1" mandatory="1">
          <defaultquery>
            <query name="35316-dat-def" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Отчетный период">
          <usefield field="cmn_date" name="dat1" title="с" checked="1" mandatory="1">
            <defaultquery>
              <query name="35316-2-dat1-def" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="dat2" title="по" checked="1" mandatory="1">
            <defaultquery>
              <query name="35316-2-dat2-def" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <usefield field="ipr_kod_ofz" />
        <usefield field="cmn_check" name="pr_psd" title="Только титулы с утверждённой ПСД" checked="1" exclude="1" />
        <usefield field="cmn_check" name="pr_1c" title="С учетом данных 1С" checked="1" exclude="1" />
        <usefield field="cmn_list" name="cols" special-type="colsets" title="ИнвестPRO/1С" visible="0" exclude="1">
          <defaultquery>
            <query name="35316-colsets-default" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_num" title="Вывод договоров" name="dog_cond" mandatory="1">
          <listquery>
            <query name="35316-dog-output-cond" />
          </listquery>
        </usefield>
        <usefield field="cmn_combo_str" name="tekfix" title="Cметная стоимость (фиксированная/текущая)" mandatory="1">
          <listquery>
            <query name="29265-cols-tekfix" />
          </listquery>
          <defaultquery>
            <query name="29265-cols-tekfix-def" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="35316" timestamp="13.12.2016 02:01:49" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc" title="Год ИПР/Документ" mandatory="1" />
        <usefield field="cmn_date_cur" name="dat" title="Дата подписания перечня объектов" checked="1" mandatory="1" />
        <usefield field="cmn_date" name="dat_dolg" title="Дата учета задолженности" checked="1" mandatory="1">
          <defaultquery>
            <query name="35316-dat-def" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_ofz" />
        <usefield field="cmn_check" name="pr_psd" title="Только титулы с утверждённой ПСД" checked="1" />
        <usefield field="cmn_check" name="pr_1c" title="С учетом данных 1С" checked="1" />
        <usefield field="cmn_list" name="cols" special-type="colsets" title="ИнвестPRO/1С" visible="0" type="string">
          <defaultquery>
            <query name="35316-colsets-default" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_str" name="tekfix" title="Cметная стоимость (фиксированная/текущая)" mandatory="1">
          <listquery>
            <query name="29265-cols-tekfix" />
          </listquery>
          <defaultquery>
            <query name="29265-cols-tekfix-def" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="35316-3" timestamp="21.11.2016 14:27:50" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\35316.xml">
      <content>
        <usefield field="cmn_date_cur" name="dat" title="Дата" checked="1" mandatory="1" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="cmn_check" name="pr_psd" title="Только титулы с утверждённой ПСД" checked="1" exclude="1" />
        <usefield field="cmn_check" name="pr_1c" title="С учетом данных 1С" checked="1" exclude="1" />
        <usefield field="cmn_list" name="cols" special-type="colsets" title="ИнвестPRO/1С" visible="0" exclude="1">
          <defaultquery>
            <query name="35316-colsets-default" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="38486" timestamp="30.11.2016 18:56:08" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\38486.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="cmn_combo_str" name="tekfix" title="Cметная стоимость (фиксированная/текущая)" mandatory="1">
          <listquery>
            <query name="29265-cols-tekfix" />
          </listquery>
          <defaultquery>
            <query name="29265-cols-tekfix-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date_cur" name="dat" title="По состоянию на дату" mandatory="1" />
        <usefield field="ipr_pr_notaip" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="cmn_check" title="Подробно" name="is_details" column-visible="0" exclude="1" />
        <usefield field="cmn_check" title="Вывод. инф. по актам и РНО" name="is_show_akt" column-visible="0" exclude="1" />
        <usefield field="cmn_check" title="Отображать сумму договора без НДС" name="is_bez_nds" checked="1" />
        <field name="cols" controlType="UIList" title="Колонки" special-type="colsets" visible="0" exclude="1">
          <defaultquery>
            <query name="29265-cols-def" />
          </defaultquery>
        </field>
        <usefield field="ipr_mp">
          <defaultquery>
            <query name="29265-mp-default" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_ofz" />
      </content>
    </form>
    <form name="frm_generator_ipr" with-behavior="0" timestamp="12.05.2017 19:46:34" file="sql.builder.templates\sql.builder\projects\ipr\reports\ipr\generator.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_doc_osn_list" />
        <fieldgroup title="Отчетный период">
          <usefield field="ipr_ym" name="ym1" title="С" />
          <usefield field="ipr_ym" name="ym2" title="По" />
          <usefield field="ipr_time_interval" />
        </fieldgroup>
        <fieldgroup title="Подразделение">
          <usefield field="ipr_kod_direct" title="Подразделение исполнителя" name="kod_ispolnit" />
          <usefield field="ipr_kod_direct" title="Подразделение заказчика" />
          <usefield field="ipr_kod_direct" title="Подразделение" name="kod_dir_or_isp" />
        </fieldgroup>
        <fieldgroup title="Титул">
          <usefield field="ipr_titul_ip_sbor" />
          <usefield field="ipr_titul_ip_head" />
          <usefield field="ipr_ipr_data_simple" />
          <usefield field="ipr_subject" />
          <usefield field="ipr_priority" />
        </fieldgroup>
      </content>
    </form>
    <form name="30196" timestamp="21.11.2016 14:27:50" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\30196.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_date" name="dates" title="С даты" mandatory="1">
          <defaultquery>
            <query name="30196-begin-year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date_cur" name="datepo" title="По дату" mandatory="1" />
      </content>
    </form>
    <form name="33535" with-behavior="0" timestamp="21.11.2016 14:27:52" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33535.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="asuse_year" name="year" title="Отчётный год" />
      </content>
    </form>
    <form name="33536" with-behavior="0" timestamp="21.11.2016 14:27:53" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\33536.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <field name="dat" type="date" controlType="UIDate" title="Дата" mandatory="1" />
        <field name="kod_region" type="number" controlType="UIList" title="Регион">
          <listquery>
            <query name="33536-region" />
          </listquery>
        </field>
      </content>
    </form>
    <form name="35210" with-behavior="0" timestamp="21.11.2016 14:27:54" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\35210.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="date" name="dat" valuequery="cur-date" />
      </content>
    </form>
    <form name="41293" timestamp="18.04.2017 15:47:30" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="kido_id_slice" />
      </content>
    </form>
    <form name="41293-cur" timestamp="04.12.2018 17:15:19" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\41293.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="kido_id_slice" exclude="1" />
        <usefield field="cmn_list" name="num_req" type="string" rows-limit="100" title="Заявки">
          <buttons>
            <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
            <menu title="save/load" side="Right">
              <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
              <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
            </menu>
          </buttons>
          <listquery>
            <query name="41293-zayavka-list" />
          </listquery>
        </usefield>
        <usefield field="cmn_list" name="kod_dop_contr_filtr" type="number" rows-limit="100" title="Договоры">
          <buttons>
            <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
            <menu title="save/load" side="Right">
              <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
              <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
            </menu>
          </buttons>
          <listquery>
            <query name="41293-ad-list" />
          </listquery>
        </usefield>
        <usefield field="cmn_list" name="key" type="string" rows-limit="100" title="Ключи">
          <buttons>
            <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
            <menu title="save/load" side="Right">
              <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
              <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
            </menu>
          </buttons>
          <listquery>
            <query name="41293-key-list" />
          </listquery>
        </usefield>
        <usefield field="cmn_list" type="string" rows-limit="100" title="Коды" name="kod_dop_contract" column-visible="0">
          <listquery>
            <query name="41293-sel-ids" />
          </listquery>
          <defaultquery>
            <query name="41293-sel-ids" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="43430" timestamp="17.01.2019 15:36:41" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\43430.xml">
      <content>
        <usefield field="cmn_list" name="kod_predpr" title="Подразделения" parent-field-name="kod_parent" type="number">
          <listquery>
            <query name="43430-deps" />
          </listquery>
        </usefield>
        <usefield name="p_date_s" field="cmn_date_cur" title="Дата начала" column-mandatory="1" />
        <usefield name="p_date_po" field="cmn_date_cur" title="Дата окончания" column-mandatory="1" />
      </content>
    </form>
    <form name="OTCHET_147_DOG_SOBSTV" timestamp="14.11.2021 21:46:08" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield name="s_dog_type" field="cmn_list" part-id="OTCHET_147_DOG_SOBSTV_FORM" title="Тип договора" show-checkbox="0" type="number">
          <listquery>
            <query name="isv_otchet_147_dog_types" />
          </listquery>
        </usefield>
        <fieldgroup title="Сумма по договору" part-id="OTCHET_147_DOG_SOBSTV_FORM">
          <usefield field="cmn_float" name="n_sum_s" title="C" show-checkbox="0" />
          <usefield field="cmn_float" name="n_sum_po" title="ПО" show-checkbox="0" />
        </fieldgroup>
        <usefield field="cmn_list" name="s_status" type="number" is-scalar="1" title="Статус договора" show-checkbox="0">
          <listquery>
            <query name="is_status_list_insurance_147_rep" />
          </listquery>
        </usefield>
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot;" part-id="OTCHET_147_DOG_SOBSTV_FORM">
          <usefield field="cmn_date" name="s_date_active_s" title="C" show-checkbox="0" />
          <usefield field="cmn_date" name="s_date_active_po" title="ПО" show-checkbox="0" />
        </fieldgroup>
        <usefield field="asuse_year_list" name="s_year" title="Год регистрации" type="number" show-checkbox="0" part-id="OTCHET_147_DOG_SOBSTV_FORM">
          <defaultquery>
            <query name="spr_time_year_cur" />
          </defaultquery>
        </usefield>
        <usefield name="n_ram" title="Исключить Рамочные дог-ры" field="cmn_check" part-id="OTCHET_147_DOG_SOBSTV_FORM" />
        <usefield field="cmn_integer" name="n_status" title="Статус" type="number" visible="0" part-id="OTCHET_147_DOG_SOBSTV_FORM">
          <defaultquery>
            <query name="zero" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" name="s_errmsg" title="Сообщение об ошибке" type="string" visible="0" part-id="OTCHET_147_DOG_SOBSTV_FORM">
          <defaultquery>
            <query name="zero" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Фильтр по номеру договора" expanded="0">
          <field controlType="UIList" title="Доходные / Расходные" val-field-name="kod_dog" name="is_dogovor_list" type="number">
            <buttons>
              <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
              <menu title="save/load" side="Right">
                <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
                <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
              </menu>
            </buttons>
            <listquery>
              <query name="is_dogovor_num_list" />
            </listquery>
          </field>
          <field controlType="UIList" title="Договоры ТП" val-field-name="kod_dop_contract" name="is_dop_contr_list" type="number">
            <buttons>
              <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
              <menu title="save/load" side="Right">
                <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
                <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
              </menu>
            </buttons>
            <listquery>
              <query name="is_dop_contract_num_list" />
            </listquery>
          </field>
        </fieldgroup>
      </content>
    </form>
    <form name="OTCHET_147_DOG_SOBSTV_DOP" timestamp="14.11.2021 21:46:59" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_147_dog_sobstv.xml">
      <usepart part="OTCHET_147_DOG_SOBSTV_FORM" />
    </form>
    <form name="OTCHET_SUBPODR" timestamp="18.07.2022 15:16:52" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\otchet_subpodr.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield name="s_dog_type" field="cmn_list" title="Тип договора" show-checkbox="0" type="number">
          <listquery>
            <query name="isv_otchet_subpodr_dog_types" />
          </listquery>
        </usefield>
        <fieldgroup title="Сумма по договору">
          <usefield field="cmn_float" name="n_sum_s" title="C" show-checkbox="0" />
          <usefield field="cmn_float" name="n_sum_po" title="ПО" show-checkbox="0" />
        </fieldgroup>
        <usefield field="cmn_list" name="s_status" type="number" is-scalar="1" title="Статус договора" show-checkbox="0">
          <listquery>
            <query name="is_status_list_insurance_147_rep" />
          </listquery>
        </usefield>
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot;">
          <usefield field="cmn_date" name="s_date_active_s" title="C" show-checkbox="0" />
          <usefield field="cmn_date" name="s_date_active_po" title="ПО" show-checkbox="0" />
        </fieldgroup>
        <usefield field="asuse_year_list" name="s_year" title="Год регистрации" type="number" show-checkbox="0">
          <defaultquery>
            <query name="spr_time_year_cur" />
          </defaultquery>
        </usefield>
        <usefield name="n_ram" title="Исключить Рамочные дог-ры" field="cmn_check" />
        <usefield field="cmn_integer" name="n_status" title="Статус" type="number" visible="0">
          <defaultquery>
            <query name="zero" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" name="s_errmsg" title="Сообщение об ошибке" type="string" visible="0">
          <defaultquery>
            <query name="zero" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Фильтр по номеру договора" expanded="0">
          <field controlType="UIList" title="Доходные / Расходные" val-field-name="kod_dog" name="is_dogovor_list" type="number">
            <buttons>
              <uicommand action-type="show-popup" side="Left" type="Combo" title="Показать" />
              <menu title="save/load" side="Right">
                <uicommand action-type="save-field-to-clipboard" title="Копировать" notification="Параметры скопированы." />
                <uicommand action-type="fill-field-from-clipboard" title="Вставить" />
              </menu>
            </buttons>
            <listquery>
              <query name="is_dogovor_num_list" />
            </listquery>
          </field>
        </fieldgroup>
      </content>
    </form>
    <form name="SHABL5_DOG_PRIS" with-behavior="0" timestamp="01.06.2023 17:00:00" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab5_dog_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_dog_type_prizn" name="n_prizn" />
        <usefield field="cmn_list" name="s_status" type="number" is-scalar="1" title="Статус договора">
          <listquery>
            <query name="is_status_list_insurance" />
          </listquery>
        </usefield>
        <usefield field="cmn_string" name="s_num_dog" title="№ дох./расх. договора" />
        <usefield field="ipr_dog_kind_prizn" name="n_kind_prizn" />
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot;">
          <usefield field="cmn_date" name="s_date_active_s" title="C">
            <defaultquery>
              <query name="today" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="s_date_active_po" title="ПО">
            <defaultquery>
              <query name="today" />
            </defaultquery>
          </usefield>
        </fieldgroup>
      </content>
    </form>
    <form name="SHABL6_CRED_PRIS" with-behavior="0" timestamp="21.11.2016 14:27:55" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab6_cred_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_dog_type_prizn_ls" name="n_prizn" mandatory="1" />
      </content>
    </form>
    <form name="SHABL7_RS_PRIS" with-behavior="0" timestamp="21.11.2016 14:27:56" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shab7_rs_pris.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_dog_type_prizn_ls" name="n_prizn" mandatory="1" />
      </content>
    </form>
    <form name="SHABL5_DOG_PODR_INSURANCE" with-behavior="0" timestamp="01.06.2023 16:50:00" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shabl_dog_podr_insurance.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_list" name="s_dog_predpr" type="number" is-scalar="1" title="Заказчик">
          <listquery>
            <query name="isv_dog_predpr" />
          </listquery>
        </usefield>
        <usefield field="cmn_list" name="s_status" type="number" is-scalar="1" title="Статус подр.договора">
          <listquery>
            <query name="is_status_list_insurance" />
          </listquery>
        </usefield>
        <usefield field="cmn_string" name="s_num_dog" title="№ договора" />
        <usefield field="ipr_dog_kind_prizn_insurance" name="n_kind_prizn" mandatory="1" />
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot; подрядного договора">
          <usefield field="cmn_date" name="s_date_active_s" title="C" />
          <usefield field="cmn_date" name="s_date_active_po" title="ПО" />
        </fieldgroup>
        <fieldgroup title="Дата изменения подрядного договора">
          <usefield field="cmn_date" name="s_date_insur_s" title="C" />
          <usefield field="cmn_date" name="s_date_insur_po" title="ПО" />
        </fieldgroup>
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot; договора страхования">
          <usefield field="cmn_date" name="s_date_active2_s" title="C" />
          <usefield field="cmn_date" name="s_date_active2_po" title="ПО" />
        </fieldgroup>
        <fieldgroup title="Дата изменения договора страхования">
          <usefield field="cmn_date" name="s_date_insur2_s" title="C" />
          <usefield field="cmn_date" name="s_date_insur2_po" title="ПО" />
        </fieldgroup>
      </content>
    </form>
    <form name="SHABL5_DOG_PODR_INSURANCE_2" with-behavior="0" timestamp="01.06.2023 16:50:00" file="sql.builder.templates\sql.builder\projects\ipr\reports\kido\shabl_dog_podr_insurance.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_list" name="s_status" type="number" is-scalar="1" title="Статус договора">
          <listquery>
            <query name="is_status_list_insurance" />
          </listquery>
        </usefield>
        <usefield field="cmn_string" name="s_num_dog" title="№ договора" />
        <fieldgroup title="Дата перевода в статус &quot;Действующий&quot;">
          <usefield field="cmn_date" name="s_date_active_s" title="C" />
          <usefield field="cmn_date" name="s_date_active_po" title="ПО" />
        </fieldgroup>
        <fieldgroup title="Дата изменения договора страхования">
          <usefield field="cmn_date" name="s_date_insur_s" title="C" />
          <usefield field="cmn_date" name="s_date_insur_po" title="ПО" />
        </fieldgroup>
      </content>
    </form>
    <form name="33535-f1" timestamp="25.05.2017 12:55:13" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="kido_id_slice" />
      </content>
    </form>
    <form name="33535-f4" timestamp="25.05.2017 12:55:13" with-behavior="0" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_direct_no_rights" name="kod_ispolnit" />
        <usefield field="kido_id_slice" />
      </content>
    </form>
    <form name="vr_rep_34397_col" timestamp="31.05.2017 18:58:32" title="Форма 5. Настройка" is-report="1" folder="forms_tp_preset" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\vr_rep_34397_col.xml">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <grid table="a" show-toolbar="1">
          <toolbar>
            <uicommand button-type="grid-add" visible="0" />
            <uicommand button-type="grid-delete" visible="0" />
            <uicommand button-type="grid-save" visible="0" />
          </toolbar>
          <columns>
            <column table="a" column="kod_rep_34397_col" parname="kod_tree" column-visible="0" />
            <column table="a" column="name" column-width="400" />
            <fact column="vr_rep_34397_col_raz_nm" title="Раздел" table="a" column-width="365">
              <buttons>
                <uicommand action-type="dynamic-form" call="vr_rep_34397_razdel_select" modal="1" side="Right" visible="kod_tree">
                  <useparam name="kod_tree" />
                </uicommand>
              </buttons>
            </fact>
          </columns>
        </grid>
      </content>
      <from>
        <query name="vr_rep_34397_col" as="a" column-editable="0" />
      </from>
    </form>
    <form name="44098" timestamp="22.01.2018 12:17:22" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <content>
        <usefield field="cmn_combo_num" name="p_list_type" title="Группа" column-mandatory="1">
          <listquery>
            <query name="44098-ltype" />
          </listquery>
        </usefield>
        <fieldgroup title="Регистрация заявки">
          <usefield field="cmn_date" name="p_dt3" title="С">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt4" title="По">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Период времени (для этапов)">
          <usefield field="cmn_date" name="p_dt1" title="С" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt2" title="По" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <usefield name="p_dt_vld" field="cmn_string" column-visible="0">
          <defaultquery>
            <query name="44098-dt_vld" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="44098-3" timestamp="25.09.2018 14:17:26" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <content>
        <usefield field="cmn_combo_num" name="p_list_type" title="Мощность" column-mandatory="1" type="number">
          <listquery>
            <query name="44098-ltype2" />
          </listquery>
        </usefield>
        <fieldgroup title="Регистрация заявки" exclude="1">
          <usefield field="cmn_date" name="p_dt3" title="С">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt4" title="По">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Период времени (для этапов)" exclude="1">
          <usefield field="cmn_date" name="p_dt1" title="С" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt2" title="По" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Период времени (для этапов)">
          <usefield field="cmn_date" name="p_dt1" title="С" column-mandatory="1">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt2" title="По" column-mandatory="1">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <usefield name="p_dt_vld" field="cmn_string" column-visible="0" exclude="1">
          <defaultquery>
            <query name="44098-dt_vld" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="4409" timestamp="07.03.2018 11:44:57" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <content>
        <usefield field="cmn_combo_num" name="p_list_type" title="Группа" column-mandatory="1">
          <listquery>
            <query name="44098-ltype" />
          </listquery>
        </usefield>
        <fieldgroup title="Регистрация заявки">
          <usefield field="cmn_date" name="p_dt3" title="С">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt4" title="По">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Период времени (для этапов)">
          <usefield field="cmn_date" name="p_dt1" title="С" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt2" title="По" column-mandatory="1" valid="p_dt_vld">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <usefield name="p_dt_vld" field="cmn_string" column-visible="0">
          <defaultquery>
            <query name="44098-dt_vld" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="44098-4" timestamp="24.05.2018 13:25:16" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <content>
        <fieldgroup title="Регистрация заявки">
          <usefield field="cmn_date" name="p_dt3" title="С">
            <defaultquery>
              <query name="44098-dt3" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt4" title="По">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <usefield field="load_type" title="Тип заявки" />
        <usefield field="ipr_subject" />
        <fieldgroup title="Нагрузка всего">
          <usefield field="cmn_float" title="C" name="p_power_gt" />
          <usefield name="p_power_ls" title="По" field="cmn_float" />
          <field name="p_power_gt" type="number" controlType="UINumber" edit-mask="f" title="С" exclude="1" />
          <field title="По" name="p_power_ls" type="number" controlType="UINumber" edit-mask="f" step="0" exclude="1" />
        </fieldgroup>
      </content>
    </form>
    <form name="44098-3-49576" timestamp="02.10.2018 14:24:46" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44098\44098.xml">
      <content>
        <fieldgroup title="Период времени (для этапов)">
          <usefield field="cmn_date" name="p_dt1" title="С" column-mandatory="1">
            <defaultquery>
              <query name="44098-dt1" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_date" name="p_dt2" title="По" column-mandatory="1">
            <defaultquery>
              <query name="44098-dt2" />
            </defaultquery>
          </usefield>
        </fieldgroup>
      </content>
    </form>
    <form name="44164" timestamp="21.10.2017 16:14:00" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44164\44164.xml">
      <content>
        <usefield field="kido_id_slice_d" column-mandatory="1">
          <defaultquery>
            <query name="44164-id_slice_def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" mandatory="1" name="dat" column-editable="0">
          <defaultquery>
            <query name="44164-dat_def" />
          </defaultquery>
        </usefield>
        <usefield field="year" mandatory="1" name="god">
          <defaultquery>
            <query name="44164-god_def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat6" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date6" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat12" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date12" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat18" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date18" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat24" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date24" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat30" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date30" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="dat36" column-editable="0">
          <defaultquery>
            <query name="44164-calc-date36" />
          </defaultquery>
        </usefield>
      </content>
    </form>
    <form name="44890" timestamp="20.12.2017 13:45:19" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\44890\44890.xml">
      <content>
        <usefield field="kido_id_slice" />
        <usefield field="cmn_date" name="p_dat" title="Дата" column-visible="0">
          <defaultquery>
            <query name="44890-dat-val" />
          </defaultquery>
        </usefield>
      </content>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name">
    <dimension-package name="33535" timestamp="27.12.2017 15:14:17" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\33535\33535.xml">
      <dimension name="kod_gor_obl" class-type="33535-gor_obl" />
      <dimension name="kod_ad_otch_f1" class-type="isv_ad_otch_f1" />
      <dimension name="kod_ad_otch_f2" class-type="isv_ad_otch_f2_new" />
      <dimension name="kod_ad_otch_f4" class-type="isv_ad_otch_f4" />
      <dimension name="kod_ad_otch_f6" class-type="isv_ad_otch_f6" />
      <dimension name="kod_ad_otch_f7" class-type="isv_ad_otch_f7" />
      <dimension name="kod_ad_otch_f8" class-type="isv_ad_otch_f8" />
      <dimension name="okved2" time-type="string" />
      <dimension name="buh_reestr_kz_ad_ofz" class-type="buh_reestr_kz_ad_ofz" />
      <dimension name="pr_str" time-type="string" />
    </dimension-package>
    <dimension-package name="34397" timestamp="29.05.2017 19:04:50" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\34397\qube.xml">
      <dimension class-type="vr_rep_34397_col" name="kod_rep_34397_col" />
    </dimension-package>
    <dimension-package name="41050" timestamp="13.01.2020 15:46:56" file="sql.builder.templates\sql.builder\projects\ipr\reports\projects\41050\isv_ad_everyday.xml">
      <dimension class-type="isv_ad_everyday" name="kod_isv_ad_evd" />
      <dimension class-type="isv_slice_of_tdc_all" name="kod_isv_slice_of_tdc_all" />
      <dimension class-type="vdwh_isv_titul_res" name="kod_isv_titul_res" />
      <dimension class-type="isv_slice_of_ad_all" name="ipr_slice_of_is_ad_all" />
      <dimension name="ipr_kod_ispolnit_tit" class-type="is_spr_direct_tit" />
      <dimension name="evd_otch_list" time-type="number" />
      <dimension name="evd_dt_contract" time-type="day" />
      <dimension name="evd_otch_list_3" time-type="number" />
      <dimension name="evd_fl_build" time-type="number" />
      <dimension name="evd_fl_build_real" time-type="number" />
      <dimension name="evd_pr_exist_pd" time-type="number" />
      <dimension name="evd_pr_hoz_sposob" time-type="number" />
      <dimension name="evd_pr_mixed" time-type="number" />
      <dimension name="evd_otch_2_1_1" time-type="number" />
      <dimension name="evd_otch_2_1_2" time-type="number" />
      <dimension name="evd_otch_2_1_3" time-type="number" />
      <dimension name="evd_pr_ofz_vkl" time-type="number" />
      <dimension name="evd_pr_vip" time-type="number" />
      <dimension name="evd_pr_ostatok" time-type="number" />
      <dimension name="evd_year_srok" time-type="number" />
      <dimension class-type="is_spr_direct_res" name="evd_kodres" />
      <dimension name="evd_podr_name_titul" time-type="string" />
      <dimension name="evd_kod_filial_tit" comment="для аб договора филиал из связанных титулов. если титулов нет - филиал аб" class-type="is_spr_direct_ad_filial_tit" />
      <dimension class-type="is_ad_all_slice" name="id_slice" />
      <dimension class-type="is_ad_all" name="kod_is_ad_all" />
      <dimension name="evd_kod_list7" time-type="number" />
      <dimension name="evd_name_mo" time-type="string" />
      <dimension name="evd_name_sp" time-type="string" />
      <dimension name="evd_name_np" time-type="string" />
      <dimension name="evd_name_podr" time-type="string" />
      <dimension name="evd_fl_branch" time-type="number" />
      <dimension name="evd_kod_predpr" time-type="string" />
      <dimension name="vks_prikaz_pl_dat" time-type="day" />
      <dimension name="evd_c_zayav_num_z_id" class-type="c_zayav_num_z_id" exclude="1" />
      <dimension name="kod_isv_ad_evd_vs1" class-type="isv_ad_everyday_vs1" />
    </dimension-package>
  </dimension-packages>
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>