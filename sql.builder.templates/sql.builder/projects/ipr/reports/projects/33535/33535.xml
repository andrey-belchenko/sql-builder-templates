<?xml version="1.0" encoding="utf-8"?>
<root>
  <parts>
    <part id="33535-f1-params" timestamp="18.04.2017 12:36:40">
      <param name="id_slice" type="number" />
    </part>
    <part id="33535-f1-withparams" timestamp="18.04.2017 12:36:59">
      <useparam name="id_slice" />
    </part>
    <part id="33535-f4-params" timestamp="18.04.2017 12:36:40">
      <param name="id_slice" type="number" />
      <param name="kod_ispolnit" type="number" />
    </part>
    <part id="33535-f4-withparams" timestamp="18.04.2017 12:36:59">
      <useparam name="id_slice" />
      <useparam name="kod_ispolnit" />
    </part>
    <part id="33535-f1-grsets" timestamp="24.05.2017 17:02:09">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]ls15" title="до 15 кВт">
        <where>
          <call function="and">
            <call function="le">
              <column column="sum_load" table="this" />
              <const>15</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]ls15_fiz" title="до 15 кВт физ. лица">
          <where>
            <call function="and">
              <call function="=0">
                <column column="ur_lico" table="this" />
              </call>
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]15to150" title="свыше 15 и до 150 кВт">
        <where>
          <call function="and">
            <call function="gt">
              <column column="sum_load" table="this" />
              <const>15</const>
            </call>
            <call function="le">
              <column column="sum_load" table="this" />
              <const>150</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]15to150_dc" title="свыше 15 и до 150 кВт с льготами">
          <where>
            <call function="=1">
              <column table="this" column="fl_discount" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
          <where>
            <call function="=1">
              <column table="this" column="pr_cnt_mes" />
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]150to670" title="свыше 150 кВт и менее 670 кВт">
        <where>
          <call function="and">
            <call function="gt">
              <column column="sum_load" table="this" />
              <const>150</const>
            </call>
            <call function="lt">
              <column column="sum_load" table="this" />
              <const>670</const>
            </call>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]gt670" title="не менее 670 кВт">
        <where>
          <call function="and">
            <call function="ge">
              <column column="sum_load" table="this" />
              <const>670</const>
            </call>
          </call>
        </where>
      </grset>
      <grset title="объекты по производству электрической энергии" as="[:pfx]gen">
        <where>
          <call function="and">
            <call function="=1">
              <column column="pr_gen" table="this" />
            </call>
          </call>
        </where>
      </grset>
      <grset title="временное технологическое присоединение" as="[:pfx]vrem">
        <where>
          <call function="and">
            <call function="=1">
              <column column="vrem_tp" table="this" />
            </call>
          </call>
        </where>
      </grset>
    </part>
    <part id="33535-f2-grsets" timestamp="27.12.2017 16:34:28">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]ls15" title="до 15 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>12</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ls15_fiz" title="до 15 кВт физ. лица">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const>13</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150" title="свыше 15 и до 150 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>14</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150_lg" title="свыше 15 и до 150 кВт с льготой">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const comment="Победря сказала данных нет. Выводим нули">15</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
        <where>
          <call function="=">
            <column column="str1" table="this" />
            <const>16</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]150to670" title="свыше 150 кВт и менее 670 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>17</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]gt670" title="не менее 670 кВт">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>18</const>
          </call>
        </where>
      </grset>
      <grset title="объекты по производству электрической энергии" as="[:pfx]gen">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>19</const>
          </call>
        </where>
      </grset>
      <grset title="временное технологическое присоединение" as="[:pfx]vrem">
        <where>
          <call function="=">
            <column column="str" table="this" />
            <const>21</const>
          </call>
        </where>
      </grset>
      <grset title="некоммерческая организация" as="[:pfx]nonpr">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>24</const>
          </call>
        </where>
      </grset>
      <grset title="Объекты МРСК/РСК Группы Россети" as="[:pfx]mrsk" comment="Победря сказала данных нет. Выводим нули">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>25</const>
          </call>
        </where>
      </grset>
      <grset title="Объекты ТСО" as="[:pfx]tso" comment="Победря сказала данных нет. Выводим нули">
        <where>
          <call function="=">
            <column column="str2" table="this" />
            <const>26</const>
          </call>
        </where>
      </grset>
    </part>
  </parts>
  <queries>
    <query name="33535-f1-data" timestamp="24.05.2017 19:12:23">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <expressions>
        <call function="if" as="tarif_st1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>0.4</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg2" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st2" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>0.4</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg3" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st3" group="sum">
          <call function="and">
            <call function="between">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>1</const>
              <const>20</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg2" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
        <call function="if" as="tarif_st4" group="sum">
          <call function="and">
            <call function="between">
              <column table="kod_ad_otch_f1" column="vol" />
              <const>1</const>
              <const>20</const>
            </call>
            <call function="=">
              <column table="kod_ad_otch_f1" column="kateg3" />
              <const>1</const>
            </call>
          </call>
          <column table="kod_ad_otch_f1" column="tarif_st" />
        </call>
      </expressions>
      <select>
        <column table="kod_gor_obl" column="kod_gor_obl" />
        <column table="kod_gor_obl" column="name" title="Субъект" />
        <column table="kod_ad_otch_f1" column="sum_load" />
        <column table="kod_ad_otch_f1" column="ur_lico" />
        <column table="kod_ad_otch_f1" column="fl_discount" />
        <column table="kod_ad_otch_f1" column="pr_cnt_mes" />
        <column table="kod_ad_otch_f1" column="pr_gen" />
        <column table="kod_ad_otch_f1" column="vrem_tp" />
        <fact column="tarif_st1" group="sum" nvl="0" />
        <fact column="tarif_st2" group="sum" nvl="0" />
        <fact column="tarif_st3" group="sum" nvl="0" />
        <fact column="tarif_st4" group="sum" nvl="0" />
        <fact column="isv_ad_otch_f1_sredn_vir" as="sredn_vir" title="Средняя выручка" group="sum" />
        <fact column="isv_ad_otch_f1_sredn_opl" as="sredn_opl" title="Средняя выручка" group="sum" />
      </select>
      <from>
        <qube>
          <link name="kod_dop_contract" exclude="1" />
          <link name="kod_ad_otch_f1" all-rows="1">
            <link name="id_slice" exclude="1" />
          </link>
          <link name="kod_gor_obl" />
          <where exclude="1">
            <call function="or" exclude="1">
              <call function="and">
                <call function="!=">
                  <useparam name="id_slice" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
              <call function="=">
                <column table="id_slice" column="pr_srez" />
                <const>0</const>
              </call>
            </call>
            <call function="and">
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Гор/Обл">
          <group exclude="1">
            <sourcelink table="kod_gor_obl" />
          </group>
          <grset as="ls15" title="до 15 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="le">
                  <column column="sum_load" table="this" />
                  <const>15</const>
                </call>
              </call>
            </where>
            <grset as="ls15_fiz" title="до 15 кВт физ. лица">
              <where>
                <call function="and">
                  <call function="=0">
                    <column column="ur_lico" table="this" />
                  </call>
                </call>
              </where>
            </grset>
          </grset>
          <grset as="15to150" title="свыше 15 и до 150 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="gt">
                  <column column="sum_load" table="this" />
                  <const>15</const>
                </call>
                <call function="le">
                  <column column="sum_load" table="this" />
                  <const>150</const>
                </call>
              </call>
            </where>
            <grset as="15to150_dc" title="свыше 15 и до 150 кВт с льготами">
              <where>
                <call function="=1">
                  <column table="this" column="fl_discount" />
                </call>
              </where>
            </grset>
            <grset as="15to150_ra" title="свыше 15 и до 150 кВт с рассрочкой">
              <where>
                <call function="=1">
                  <column table="this" column="pr_cnt_mes" />
                </call>
              </where>
            </grset>
          </grset>
          <grset as="150to670" title="свыше 150 кВт и менее 670 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="gt">
                  <column column="sum_load" table="this" />
                  <const>150</const>
                </call>
                <call function="lt">
                  <column column="sum_load" table="this" />
                  <const>670</const>
                </call>
              </call>
            </where>
          </grset>
          <grset as="gt670" title="не менее 670 кВт" exclude="1">
            <where>
              <call function="and">
                <call function="ge">
                  <column column="sum_load" table="this" />
                  <const>670</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="объекты по производству электрической энергии" as="gen" exclude="1">
            <where>
              <call function="and">
                <call function="=1">
                  <column column="pr_gen" table="this" />
                </call>
              </call>
            </where>
          </grset>
          <grset title="временное технологическое присоединение" as="vrem" exclude="1">
            <where>
              <call function="and">
                <call function="=1">
                  <column column="vrem_tp" table="this" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="o" title="Обл">
            <where>
              <call function="=">
                <column table="this" column="kod_gor_obl" />
                <const>0</const>
              </call>
            </where>
            <usepart part="33535-f1-grsets">
              <const>'o_'</const>
            </usepart>
          </grset>
          <grset as="g" title="Гор">
            <where>
              <call function="=">
                <column table="this" column="kod_gor_obl" />
                <const>1</const>
              </call>
            </where>
            <usepart part="33535-f1-grsets">
              <const>'g_'</const>
            </usepart>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="33535-f2-data" timestamp="13.02.2018 10:36:45">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_gor_obl" column="kod_gor_obl" />
        <column table="kod_gor_obl" column="name" as="name_gor_obl" />
        <column table="kod_ad_otch_f2" column="filial" group="max" exclude="1" />
        <column table="kod_ad_otch_f2" column="str" group="max" />
        <column table="kod_ad_otch_f2" column="str1" group="max" />
        <column table="kod_ad_otch_f2" column="str2" group="max" />
        <column table="kod_ad_otch_f2" column="col_2" as="col_2" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_3" as="col_3" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_4" as="col_4" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_5" as="col_5" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_6" as="col_6" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_7" as="col_7" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_8" as="col_8" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_9" as="col_9" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_10" as="col_10" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_11" as="col_11" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_12" as="col_12" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_13" as="col_13" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_14" as="col_14" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_15" as="col_15" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_16" as="col_16" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_17" as="col_17" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_18" as="col_18" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_19" as="col_19" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_20" as="col_20" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_21" as="col_21" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_22" as="col_22" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_23" as="col_23" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_24" as="col_24" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_25" as="col_25" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_26" as="col_26" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_27" as="col_27" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_28" as="col_28" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_29" as="col_29" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_30" as="col_30" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_31" as="col_31" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_32" as="col_32" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_33" as="col_33" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_34_cnt" as="col_34" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_35" as="col_35" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_36" as="col_36" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_37" as="col_37" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_38" as="col_38" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_39" as="col_39" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_40" as="col_40" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_41" as="col_41" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_42" as="col_42" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_43" as="col_43" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_44" as="col_44" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_45" as="col_45" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_46" as="col_46" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_47" as="col_47" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_48" as="col_48" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_49" as="col_49" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_50" as="col_50" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_51" as="col_51" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_52" as="col_52" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_53" as="col_53" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_54" as="col_54" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_55" as="col_55" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_56" as="col_56" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_57" as="col_57" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_58" as="col_58" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_59" as="col_59" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_60" as="col_60" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_61" as="col_61" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_62" as="col_62" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_63" as="col_63" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_64" as="col_64" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_65" as="col_65" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_66" as="col_66" group="sum" nvl="0" />
        <column table="kod_ad_otch_f2" column="col_67" as="col_67" group="sum" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f2" all-rows="1" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_gor_obl" />
        </qube>
      </from>
      <grouping>
        <grset as="all">
          <usepart part="33535-f2-grsets">
            <const>'all_'</const>
          </usepart>
        </grset>
        <grset as="dep" order="filial" exclude="1">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="33535-f2-grsets">
            <const>'dep_'</const>
          </usepart>
        </grset>
        <grset as="dep" order="kod_gor_obl desc">
          <group>
            <sourcelink table="kod_gor_obl" />
          </group>
          <usepart part="33535-f2-grsets">
            <const>'dep_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="33535-f4-data" timestamp="25.05.2017 15:56:42" order="name_fil, num_ouco">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f4" column="isv_ad_otch_f4_id" key="1" />
        <column table="kod_ad_otch_f4" column="name_fil" />
        <column table="kod_ad_otch_f4" column="name_all" />
        <column table="kod_ad_otch_f4" column="supply" />
        <column table="kod_ad_otch_f4" column="lp_addr" />
        <column table="kod_ad_otch_f4" column="date_coming" />
        <column table="kod_ad_otch_f4" column="num_ouco" />
        <column table="kod_ad_otch_f4" column="dt_contract" />
        <column table="kod_ad_otch_f4" column="load123_kvt" />
        <column table="kod_ad_otch_f4" column="voltage" />
        <column table="kod_ad_otch_f4" column="kateg" />
        <column table="kod_ad_otch_f4" column="sum_dog" />
        <column table="kod_ad_otch_f4" column="opl_d" />
        <column table="kod_ad_otch_f4" column="col_14" />
        <column table="kod_ad_otch_f4" column="col_15" />
        <column table="kod_ad_otch_f4" column="srok_uslug" />
        <column table="kod_ad_otch_f4" column="year_plan" />
        <column table="kod_ad_otch_f4" column="col_18" />
        <column table="kod_ad_otch_f4" column="col_19" />
        <column table="kod_ad_otch_f4" column="col_20" />
        <column table="kod_ad_otch_f4" column="col_21" />
        <column table="kod_ad_otch_f4" column="proc_isp_pir" />
        <column table="kod_ad_otch_f4" column="proc_isp_smr" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f4" all-rows="1" />
          <link name="ipr_kod_ispolnit" only-for-cond="1" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="33535-gor_obl">
      <select>
        <column table="a" column="kod_gor_obl" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="33535-gor_obl" as="a" view="1" />
      </from>
    </query>
    <query name="33535-f1-title" timestamp="02.06.2017 16:49:27">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <call function="date to char" as="sdate_form">
          <column table="a" column="dat_copy" />
        </call>
        <call function="date to char" as="sdate_year_begin">
          <call function="year begin time">
            <call function="year">
              <column table="a" column="dat_copy" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="33535-f6-data" timestamp="25.05.2017 16:53:56">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_ad_otch_f6" column="name_fil" as="col_2" group="max" />
        <column table="kod_ad_otch_f6" column="num_req" as="col_3" group="max" />
        <column table="kod_ad_otch_f6" column="supply" as="col_4" group="max" />
        <column table="kod_ad_otch_f6" column="date_coming" as="col_5" group="max" />
        <column table="kod_ad_otch_f6" column="col_6" as="col_6" group="max" />
        <column table="kod_ad_otch_f6" column="num_ouco" as="col_7" group="max" />
        <column table="kod_ad_otch_f6" column="dt_contract" as="col_8" group="max" />
        <column table="kod_ad_otch_f6" column="load123_kvt" as="col_9" group="max" />
        <column table="kod_ad_otch_f6" column="voltage" as="col_10" group="max" />
        <fact column="isv_ad_otch_f6_sum_dog" as="col_11" group="max" mp="-6" />
        <fact column="isv_ad_otch_f6_opl_d" as="col_12" group="max" mp="-6" />
        <column table="kod_ad_otch_f6" column="col_13" as="col_13" group="max" />
        <column table="kod_ad_otch_f6" column="col_14" as="col_14" group="max" />
        <column table="kod_ad_otch_f6" column="srok_uslug" as="col_15" group="max" />
        <column table="kod_ad_otch_f6" column="year_plan" as="col_16" group="max" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f6" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_dop_contract" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ad_otch_f6" column="kod_filial" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="itog" title="Итог" />
        <grset as="detail" title="Детализация" order="col_2, col_11">
          <group>
            <sourcelink table="kod_dop_contract" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="33535-f7-data" timestamp="25.05.2017 16:30:34">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f7" column="isv_ad_otch_f7_id" exclude="1" />
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_dop_contract" column="kod_dop_contract" />
        <column table="kod_ad_otch_f7" column="name_fil" as="col_2" group="max" />
        <column table="kod_ad_otch_f7" column="name_all" as="col_3" group="max" />
        <column table="kod_ad_otch_f7" column="supply" as="col_4" group="max" />
        <column table="kod_ad_otch_f7" column="load123_kvt" as="col_6" group="max" />
        <column table="kod_ad_otch_f7" column="voltage" as="col_7" group="max" />
        <column table="kod_ad_otch_f7" column="date_coming" as="col_9" group="max" />
        <column table="kod_ad_otch_f7" column="col_10" as="col_10" group="max" />
        <column table="kod_ad_otch_f7" column="num_ouco" as="col_11" group="max" />
        <column table="kod_ad_otch_f7" column="dt_contract" as="col_12" group="max" />
        <fact column="isv_ad_otch_f7_sum_dog" as="col_13" group="max" />
        <column table="kod_ad_otch_f7" column="sum_dog" as="col_13" exclude="1" group="max" />
        <fact column="isv_ad_otch_f7_opl_d" as="col_14" group="max" />
        <column table="kod_ad_otch_f7" column="opl_d" as="col_14" exclude="1" group="max" />
        <column table="kod_ad_otch_f7" column="col_15" as="col_15" group="max" />
        <column table="kod_ad_otch_f7" column="col_16" as="col_16" group="max" />
        <column table="kod_ad_otch_f7" column="srok_uslug" as="col_17" group="max" />
        <column table="kod_ad_otch_f7" column="year_plan" as="col_18" group="max" />
        <column table="kod_ad_otch_f7" column="col_19" as="col_19" group="max" />
        <column table="kod_ad_otch_f7" column="col_20" as="col_20" group="max" />
        <column table="kod_ad_otch_f7" column="col_21" as="col_21" group="max" />
        <column table="kod_ad_otch_f7" column="col_22" as="col_22" group="max" />
        <column table="kod_ad_otch_f7" column="proc_isp_pir" as="col_23" group="max" />
        <column table="kod_ad_otch_f7" column="proc_isp_smr" as="col_24" group="max" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f7" />
          <link name="ipr_kod_ispolnit" />
          <link name="kod_dop_contract" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ad_otch_f7" column="kod_filial" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="itog" title="Итог" />
        <grset as="detail" title="Детализация" order="col_2, col_11">
          <group>
            <sourcelink table="kod_dop_contract" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="33535-f8-data" timestamp="30.05.2017 10:50:36">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <select>
        <column table="kod_ad_otch_f8" column="sum_load" group="sum" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_15" group="sum" if="15" nvl="0">
          <if>
            <call function="le">
              <column table="kod_ad_otch_f8" column="sum_load" />
              <const>15</const>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_15" group="sum" if="15" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_150" group="sum" if="150" nvl="0">
          <if>
            <call function="and">
              <call function="gt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>15</const>
              </call>
              <call function="le">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>150</const>
              </call>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_150" group="sum" if="150" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_670" group="sum" if="670" nvl="0">
          <if>
            <call function="and">
              <call function="gt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>150</const>
              </call>
              <call function="lt">
                <column table="kod_ad_otch_f8" column="sum_load" />
                <const>670</const>
              </call>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_670" group="sum" if="670" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_4" as="col_4_999" group="sum" if="999" nvl="0">
          <if>
            <call function="ge">
              <column table="kod_ad_otch_f8" column="sum_load" />
              <const>670</const>
            </call>
          </if>
        </column>
        <column table="kod_ad_otch_f8" column="col_5" as="col_5_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_6" as="col_6_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_7" as="col_7_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_8" as="col_8_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_9" as="col_9_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_10" as="col_10_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_11" as="col_11_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_12" as="col_12_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_13" as="col_13_999" group="sum" if="999" nvl="0" />
        <column table="kod_ad_otch_f8" column="col_14" as="col_14_999" group="sum" if="999" nvl="0" />
        <column table="okved2" column="val" as="okved2" />
      </select>
      <from>
        <qube>
          <link name="kod_ad_otch_f8" all-rows="1" />
          <link name="okved2" />
          <where>
            <call function="and">
              <call function="true" />
            </call>
            <call function="le" exclude="1">
              <call function="rownum" />
              <const>100</const>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Итог" />
        <grset as="de" title="Детализация" order="case when okved2 like 'Прочее%' then 'ЯЯЯЯ' else okved2 end">
          <group>
            <sourcelink table="okved2" />
          </group>
        </grset>
      </grouping>
    </query>
  </queries>
  <reports>
    <report name="33535-f1" title="Форма 1" nogrid="1" timestamp="31.05.2017 17:16:09" folder="forms_tp" form="33535-f1">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f1.xlsx" title="Форма 1" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f1-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f2" title="Форма 2" nogrid="1" timestamp="27.12.2017 15:40:26" folder="forms_tp" form="33535-f1">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <print-templates>
        <excel>
          <template name="33535-f2.xlsx" title="Форма 2" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f2-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f4" title="Форма 4" nogrid="1" timestamp="31.05.2017 17:16:04" folder="forms_tp" form="33535-f4">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f4.xlsx" title="Форма 4" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f4-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f6" title="Форма 6" nogrid="1" timestamp="31.05.2017 17:15:54" folder="forms_tp" datareader="1" form="33535-f4">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f6.xlsx" title="Форма 6" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f6-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f7" title="Форма 7" nogrid="1" timestamp="31.05.2017 17:15:45" folder="forms_tp" datareader="1" form="33535-f4">
      <params>
        <usepart part="33535-f4-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f7.xlsx" title="Форма 7" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
        <query name="33535-f7-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f4-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="33535-f8" title="Форма 8" nogrid="1" timestamp="02.06.2017 16:15:25" folder="forms_tp" datareader="1" form="33535-f1">
      <params>
        <usepart part="33535-f1-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="33535-f8.xlsx" title="Форма 8" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-f1-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
        <query name="33535-f8-data" as="a" main="1" title="Данные">
          <withparams>
            <usepart part="33535-f1-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <views>
    <view name="33535-gor_obl">
      select 0 as kod_gor_obl, 'Ленинградская область' as name from dual
      union all
      select 1, 'Санкт-Петербург' from dual
    </view>
  </views>
  <dimension-packages>
    <dimension-package name="33535" timestamp="27.12.2017 15:14:17">
      <dimension name="kod_gor_obl" class-type="33535-gor_obl" />
      <dimension name="kod_ad_otch_f1" class-type="isv_ad_otch_f1" />
      <dimension name="kod_ad_otch_f2" class-type="isv_ad_otch_f2_new" />
      <dimension name="kod_ad_otch_f4" class-type="isv_ad_otch_f4" />
      <dimension name="kod_ad_otch_f6" class-type="isv_ad_otch_f6" />
      <dimension name="kod_ad_otch_f7" class-type="isv_ad_otch_f7" />
      <dimension name="kod_ad_otch_f8" class-type="isv_ad_otch_f8" />
      <dimension name="okved2" time-type="string" />
      <dimension name="buh_reestr_kz_ad_ofz" class-type="buh_reestr_kz_ad_ofz" />
      <dimension name="pr_str" time-type="string" />
    </dimension-package>
  </dimension-packages>
  <forms>
    <form name="33535-f1" timestamp="25.05.2017 12:55:13" with-behavior="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="kido_id_slice" />
      </content>
    </form>
    <form name="33535-f4" timestamp="25.05.2017 12:55:13" with-behavior="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_direct_no_rights" name="kod_ispolnit" />
        <usefield field="kido_id_slice" />
      </content>
    </form>
  </forms>
</root>