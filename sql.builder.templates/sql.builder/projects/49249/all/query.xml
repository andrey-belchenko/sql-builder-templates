<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="49249-q1" timestamp="17.03.2021 14:28:56" title="Условия поиска точек Приложение 15" is-report="1" visible="0">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <fieldgroup title="Основные">
          <usefield name="kod_outeris" title="Инф. система" type="number" field="asuse_kod_outeris" />
          <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number">
            <defaultquery>
              <query name="43375-ym-val" />
            </defaultquery>
          </usefield>
          <usefield name="kod_es" title="Отделения (филиалы) ЭСК" type="number" field="asuse_kod_org_sbyt" />
          <usefield title="Зона филиала СК" field="asuse_kod_seti" name="fil_tu" editable="1" />
          <usefield field="asuse_kod_elter_org_tu_prava" name="res_tu" title="Зона района ЭС" />
          <usefield field="asuse_tafil_el_active" name="tarif" title="Тариф" />
          <usefield type="number" field="asuse_kod_calclev" title="Уровень расчёта" name="kod_calclev" />
          <usefield field="cmn_list_yesno" name="pr_po" column-default="1" column-visible="1" editable="1" title="Входит в полезный отпуск">
            <defaultquery>
              <query name="yn_default" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Договор" expanded="0">
          <usefield name="kodp" field="asuse_kodp_kod_res" title="Абонент" />
          <usefield field="cmn_string" name="ndog" title="№ договора" />
          <usefield field="asuse_prizn_activ_dog" title="Статус договора" name="kod_activ_dog" />
          <usefield field="asuse_kod_dog_kodp_res" title="Договор" name="kod_dog" />
          <usefield title="Объект" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
          <usefield type="number" name="kod_vdog" field="asuse_kod_vdog" title="Вид договора" />
          <usefield type="number" name="tep_el" field="asuse_tep_el" title="Вид услуг" visible="0">
            <defaultquery>
              <query name="kk_tep_el_act" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Схема сети" expanded="0">
          <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="1" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="eobj_id_eo" title="Оборудование ЦП" clear-on-list-change="1" />
          <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" name="eobj_id_eo_tp" title="Энергообъект" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Оборудование ЭО" clear-on-list-change="1">
            <listquery>
              <query name="hv_eobject_eq_tp">
                <withparams exclude="1">
                  <useparam name="kod_adr_m" />
                </withparams>
              </query>
            </listquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Точка учёта" expanded="0">
          <usefield title="Номер счётчика" field="cmn_string" name="serial_num" />
          <usefield title="Наименование точки" field="cmn_string" name="num_point" />
          <usefield type="string" field="asuse_tpoint" title="Тип точки" name="tpoint" />
          <usefield type="number" field="asuse_kod_v" title="Напряжение в точке" name="point_kv" />
          <usefield type="string" field="asuse_energy" name="energy" title="Вид энергии" />
          <usefield type="string" field="asuse_abbr_directen" name="directen" title="Направление энергии" />
        </fieldgroup>
        <fieldgroup title="Дополнительные" expanded="0">
          <usefield type="number" field="asuse_kod_f46" title="Форма 46" name="kod_f46" />
          <usefield type="number" field="asuse_vid_t_2" title="Вид начисления" name="vid_t" />
          <usefield type="string" field="asuse_voltage_abbr" title="Уровень напряжения" name="voltage" />
          <usefield type="number" field="asuse_price_category" title="Ценовая категория" name="price_category" />
          <usefield type="string" field="asuse_edizm_point" title="Вид энергии:ед.изм." name="unit" />
        </fieldgroup>
      </content>
      <select>
        <column table="a" column="kod_point" key="1" />
        <column table="a" column="name_fsk" />
        <column table="a" column="name_es" />
        <column table="a" column="kod_es" />
        <column table="a" column="name_rsk" />
        <column table="a" column="kod_outeris" />
        <column table="a" column="tpoint_abbr" />
        <column table="a" column="r_pwrlev" />
        <column table="a" column="price_category" />
        <column table="a" column="kind_en" />
        <column table="a" column="direct_en" />
        <column table="a" column="unit" />
      </select>
      <from>
        <query name="ar_point" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1">
            <column table="a" column="ym" />
            <useparam name="ym" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_outeris" />
            <useparam name="kod_outeris" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_es" />
            <useparam name="kod_es" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_fsk" />
            <useparam name="fil_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_rsk" />
            <useparam name="res_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="tarif" />
            <useparam name="tarif" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_calclev" />
            <useparam name="kod_calclev" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_numobj" />
            <useparam name="kod_numobj" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_vdog" />
            <useparam name="kod_vdog" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="dog_num" />
            <useparam name="ndog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp" />
            <useparam name="kodp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodeo" />
            <useparam name="eobj_id_eo" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodfider" />
            <useparam name="eobj_id" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodeo" />
            <useparam name="eobj_id_eo_tp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodfider" />
            <useparam name="eobj_id_tp" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="cnt_num" />
            <useparam name="serial_num" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="pname" />
            <useparam name="num_point" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="tpoint_abbr" />
            <useparam name="tpoint" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kind_en" />
            <useparam name="energy" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="direct_en" />
            <useparam name="directen" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="point_kod_v" />
            <useparam name="point_kv" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_f46" />
            <useparam name="kod_f46" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="vid_t" />
            <useparam name="vid_t" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="r_pwrlev" />
            <useparam name="voltage" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="price_category" />
            <useparam name="price_category" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="unit" />
            <useparam name="unit" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="is_powersupply" />
            <useparam name="pr_po" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_calclev_q" timestamp="09.09.2018 14:48:44">
      <select>
        <column table="a" column="kod" key="1" type="number" />
        <column table="a" column="name" title="Наименование" type="string" />
      </select>
      <from>
        <table name="hv_calclev" as="a" view="1" />
      </from>
    </query>
    <query name="hv_price_category" title="Ценовые категории" timestamp="09.09.2018 15:31:57">
      <select>
        <column table="a" column="kod" key="1" type="number" />
        <column table="a" column="name" title="Наименование" type="string" />
      </select>
      <from>
        <table name="hv_price_category" as="a" view="1" />
      </from>
    </query>
    <query name="hk_voltage_abbr" title="Уровень напряжения по аббревиатуре" timestamp="28.09.2018 12:25:29" order="abbr">
      <select>
        <column table="hk_voltage_fact" column="abbr" title="Аббревиатура" />
        <column table="hk_voltage_fact" column="name" title="Наименование" />
      </select>
      <from>
        <query name="hk_voltage_fact" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="hk_voltage_fact" column="pr_active" />
            <const>0</const>
          </call>
          <call function="gt">
            <column table="hk_voltage_fact" column="voltage" />
            <const>0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="sk_edizm_point" title="Список единиц измерения в точках хранилища" timestamp="09.09.2018 21:32:22">
      <select>
        <column table="a" column="name" />
      </select>
      <from>
        <query name="sk_edizm_list" as="a" />
      </from>
      <where>
        <call function="or">
          <call table="a" column="edizm" function="=">
            <column table="a" column="edizm" />
            <const>4</const>
          </call>
          <call table="a" column="edizm" function="=">
            <column table="a" column="edizm" />
            <const>3</const>
          </call>
        </call>
      </where>
    </query>
    <query name="ks_tarif_el" title="Электрические активные тарифы" timestamp="12.09.2018 15:05:24">
      <select>
        <column table="a" column="tarif" key="1" type="number" />
        <column table="a" column="npp" title="Код" />
        <column table="a" column="sname" title="Наименование" />
        <column table="a" column="name" title="Полное наименование" />
        <column table="a" column="tarif_parent" type="number" title="Старший тариф" />
      </select>
      <from>
        <table name="ks_tarif" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="tep_el" />
            <const>1</const>
          </call>
          <call function="in">
            <column table="a" column="pr_active" />
            <const>(0,2)</const>
          </call>
        </call>
      </where>
    </query>
    <query name="kk_tep_el_act" title="Услуги кроме &quot;услуги&quot; и &quot;потери&quot;" timestamp="08.10.2018 20:07:03">
      <select>
        <column table="a" column="tep_el" type="number" key="1" />
        <column table="a" column="name" type="string" title="Наименование" />
        <column table="a" column="sname" type="string" title="Вид энергии" />
        <column table="a" column="abbr" type="string" title="Аббревиатура" />
      </select>
      <from>
        <table name="kk_tep_el" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=">
            <column table="a" column="tep_el" />
            <const>7</const>
          </call>
          <call function="!=">
            <column table="a" column="tep_el" />
            <const>-7</const>
          </call>
        </call>
      </where>
    </query>
    <query name="kv_tarif_el" title="Электрические тарифы" timestamp="09.10.2018 16:30:07">
      <select>
        <column table="a" column="tarif" key="1" type="number" />
        <column table="a" column="npp" type="number" title="Код тарифа" />
        <column table="a" column="tarif_name" type="string" title="Наименование тарифа" />
        <column table="a" column="tarif_parent" type="number" title="Родительский тариф" />
      </select>
      <from>
        <table name="kv_tarif_el" as="a" view="1" />
      </from>
    </query>
    <query name="yn_default" title="Значение по умолчанию для списка да\нет" timestamp="26.01.2023 12:01:55">
      <select>
        <column table="a" column="kod" type="number" key="1" />
        <column table="a" column="name" type="string" title="Выбор" />
      </select>
      <from>
        <query name="yn" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod" />
          <const>1</const>
        </call>
      </where>
    </query>
    <query name="49249-q2" title="Условия поиска точек в Б+" is-report="1" visible="0" timestamp="18.03.2024 01:16:56">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <fieldgroup title="Основные">
          <usefield name="kod_outeris" title="Инф. система" type="number" field="asuse_kod_outeris" />
          <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number">
            <defaultquery>
              <query name="43375-ym-val" />
            </defaultquery>
          </usefield>
          <usefield name="kod_es" title="Отделения (филиалы) ЭСК" type="number" field="asuse_kod_org_sbyt" />
          <usefield title="Зона филиала СК" field="asuse_kod_seti" name="fil_tu" editable="1" />
          <usefield field="asuse_kod_elter_org_tu_prava" name="res_tu" title="Зона района ЭС" />
        </fieldgroup>
        <fieldgroup title="Договор" expanded="0">
          <usefield name="kodp" field="asuse_kodp_kod_res" title="Абонент" />
          <usefield field="cmn_string" name="ndog" title="№ договора" />
          <usefield field="asuse_prizn_activ_dog" title="Статус договора" name="kod_activ_dog" />
          <usefield field="asuse_kod_dog_kodp_res" title="Договор" name="kod_dog" />
          <usefield title="Объект" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
          <usefield field="asuse_kod_point" name="kod_rpoint" title="КТУ" editable="kod_dog" />
          <usefield type="number" name="kod_vdog" field="asuse_kod_vdog" title="Вид договора" />
          <usefield type="number" name="tep_el" field="asuse_tep_el" title="Вид услуг" visible="0">
            <defaultquery>
              <query name="kk_tep_el_act" />
            </defaultquery>
          </usefield>
        </fieldgroup>
        <fieldgroup title="Схема сети">
          <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="1" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="eobj_id_eo" title="Оборудование ЦП" />
          <usefield field="asuse_kod_eosrc_all(kodp_res)" column-visible="1" editable="1" name="eobj_id_eo_tp" title="Энергообъект" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Оборудование ЭО">
            <listquery>
              <query name="hv_eobject_eq_tp">
                <withparams exclude="1">
                  <useparam name="kod_adr_m" />
                </withparams>
              </query>
            </listquery>
          </usefield>
          <usefield field="asuse_kod_balter_org" column-visible="1" name="place_bal_id" editable="1" title="Балансовая принадлежность" />
        </fieldgroup>
        <fieldgroup title="Точка учёта">
          <usefield title="Номер счётчика" field="cmn_string" name="serial_num" />
          <usefield title="Номер из списка" field="asuse_search_pu" name="serial_num_list" />
          <usefield title="Наименование точки" field="cmn_string" name="num_point" />
          <usefield type="string" field="asuse_tpoint" title="Тип точки" name="tpoint" />
          <usefield type="number" field="asuse_kod_pwrcompany" title="Группа потребителей по сети" name="kod_pwrcompany" />
          <usefield type="number" field="asuse_kod_v_nv" title="Напряжение" name="point_kv" />
          <usefield type="string" field="asuse_energy" name="energy" title="Вид энергии" />
          <usefield type="string" field="asuse_abbr_directen" name="directen" title="Направление энергии" />
          <usefield field="asuse_consumers_network" column-visible="1" editable="1" title="Граница с сетями" name="kod_net" />
          <usefield field="asuse_kod_org_sech" column-visible="1" editable="1" title="Получатель" name="kodp2" />
        </fieldgroup>
        <fieldgroup title="Дополнительные" expanded="0">
          <usefield type="number" field="asuse_kod_f46" title="Форма 46" name="kod_f46" />
          <usefield type="number" field="asuse_vid_t_2" title="Вид начисления" name="vid_t" />
          <usefield type="string" field="asuse_voltage_abbr" title="Уровень напряжения" name="voltage" />
          <usefield type="number" field="asuse_price_category" title="Ценовая категория" name="price_category" />
          <usefield type="string" field="asuse_edizm_point" title="Вид энергии:ед.изм." name="unit" />
          <usefield field="asuse_tafil_el_active" name="tarif" title="Тариф" />
          <usefield type="number" field="asuse_kod_calclev" title="Уровень расчёта" name="kod_calclev" />
          <usefield field="cmn_list_yesno" name="pr_po" column-default="1" column-visible="1" editable="1" title="Входит в полезный отпуск">
            <defaultquery>
              <query name="yn_default" />
            </defaultquery>
          </usefield>
        </fieldgroup>
      </content>
      <select>
        <column table="a" column="kod_point" key="1" />
        <column table="a" column="name_fsk" />
        <column table="a" column="name_es" />
        <column table="a" column="kod_es" />
        <column table="a" column="name_rsk" />
        <column table="a" column="kod_outeris" />
        <column table="a" column="tpoint_abbr" />
        <column table="a" column="r_pwrlev" />
        <column table="a" column="price_category" />
        <column table="a" column="kind_en" />
        <column table="a" column="direct_en" />
        <column table="a" column="unit" />
      </select>
      <from>
        <query name="ar_point" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1">
            <column table="a" column="ym" />
            <useparam name="ym" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_outeris" />
            <useparam name="kod_outeris" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_es" />
            <useparam name="kod_es" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_fsk" />
            <useparam name="fil_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_rsk" />
            <useparam name="res_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="tarif" />
            <useparam name="tarif" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_calclev" />
            <useparam name="kod_calclev" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_numobj" />
            <useparam name="kod_numobj" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_rpoint" />
            <useparam name="kod_rpoint" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_vdog" />
            <useparam name="kod_vdog" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="dog_num" />
            <useparam name="ndog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp" />
            <useparam name="kodp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp" />
            <useparam name="kodp2" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodeo" />
            <useparam name="eobj_id_eo" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodfider" />
            <useparam name="eobj_id" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodeo" />
            <useparam name="eobj_id_eo_tp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodfider" />
            <useparam name="eobj_id_tp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="cnt_num" />
            <useparam name="serial_num_list" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="cnt_num" />
            <useparam name="serial_num" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="pname" />
            <useparam name="num_point" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="tpoint_abbr" />
            <useparam name="tpoint" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_pwrcompany" />
            <useparam name="kod_pwrcompany" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kind_en" />
            <useparam name="energy" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="direct_en" />
            <useparam name="directen" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="pwr_lev" />
            <useparam name="point_kv" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_f46" />
            <useparam name="kod_f46" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="vid_t" />
            <useparam name="vid_t" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="r_pwrlev" />
            <useparam name="voltage" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="price_category" />
            <useparam name="price_category" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="unit" />
            <useparam name="unit" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="is_powersupply" />
            <useparam name="pr_po" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_net" />
            <useparam name="kod_net" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_bal_id" />
            <useparam name="place_bal_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="hk_v_nv" timestamp="12.06.2019 02:22:52">
      <select>
        <column table="a" column="kod_v" type="number" comment="первичный ключ" exclude="1" />
        <column table="a" column="voltage" type="number" title="" />
        <column table="a" column="nv" type="number" title="" comment="напряжение (в цифрах)" key="1" />
        <column table="a" column="sv" type="string" title="Напряжение (кВ)" comment="напряжение ( текстом)" agg="list" />
        <column table="a" column="u_m" type="string" title="" />
        <column table="a" column="d_m" type="date" title="" />
        <column table="a" column="pr_t" type="number" title="" comment="признак &quot;типовое значение напряжения&quot; 1 - да, 0 - нет" />
      </select>
      <from>
        <table name="hk_v" as="a" />
      </from>
    </query>
    <query name="hv_eosrc_all(kod_res)" title="Список энергообъектов по РЭС" timestamp="19.06.2019 16:56:27">
      <params>
        <param type="array" name="res_tu" />
        <param type="array" name="fil_tu" />
        <param type="array" name="bal_id_eo" />
        <param name="eobj_id" type="array" />
        <param name="eobj_id_eo" type="array" />
      </params>
      <select>
        <column table="a" column="seobj_id" key="1" type="number" />
        <column table="a" column="seobj_name" title="Наименование" type="string" />
        <column table="a" column="kindname" title="Тип" type="string" />
        <column table="a" column="balter_name" title="Балансовая принадлежность" type="string" />
        <column table="a" column="elter_name" title="Эксплуатационная ответственность" type="string" />
        <column table="a" column="seti" title="Сети" type="string" />
      </select>
      <from>
        <table name="hv_eosrc_all_res" as="a" view="1" />
      </from>
    </query>
    <query name="49249-q3" title="Условия поиска для энергообъекта" is-report="1" timestamp="05.06.2022 05:06:41">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <usefield field="asuse_kod_eosrc_all" column-visible="1" editable="1" name="eobj_id_eo_tp" title="Энергообъект" type="number" />
        <usefield field="asuse_kod_eobject_oneeq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Оборудование ЭО" type="number">
          <listquery>
            <query name="hv_eobject_eq_tp" />
          </listquery>
        </usefield>
      </content>
      <select />
      <from />
    </query>
    <query name="hv_eosrc_all_con" title="Список энергообъектов для сопоставления в Б+" timestamp="02.12.2021 10:01:56">
      <params />
      <select>
        <column table="a" column="seobj_id" key="1" type="number" />
        <column table="a" column="seobj_name" title="Наименование" type="string" />
        <column table="a" column="kindname" title="Тип" type="string" />
        <column table="a" column="balter_name" title="Балансовая принадлежность" type="string" />
        <column table="a" column="elter_name" title="Эксплуатационная ответственность" type="string" />
        <column table="a" column="seti" title="Сети" type="string" />
      </select>
      <from>
        <table name="hv_eosrc_all" as="a" view="1" />
      </from>
    </query>
    <query name="hv_point(kod_dog, kod_obj)" title="Список ТУ договора" timestamp="27.02.2023 11:06:34">
      <params>
        <param name="kod_dog" type="array" />
        <param name="kod_numobj" type="array" />
      </params>
      <select>
        <column table="a" column="kod_point" key="1" type="number" />
        <column table="a" column="nomer" type="string" title="Номер" />
        <column table="a" column="obj" type="string" title="Объект" />
        <column table="a" column="ndog" type="string" title="Договор" />
        <column table="a" column="name" type="string" title="Наименование" />
        <column table="a" column="mesto" type="string" title="Место установки" />
        <column table="a" column="dat_s" type="string" title="Дата создания" />
        <column table="a" column="dat_po" type="string" title="Дата закрытия" />
      </select>
      <from>
        <query name="hv_point_search" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="a" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_numobj" />
            <useparam name="kod_numobj" />
          </call>
        </call>
      </where>
    </query>
    <query name="49249-q4" title="Условия поиска точек в ИТ Договоров услуг" is-report="1" visible="0" timestamp="25.10.2023 11:54:32">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <fieldgroup title="Основные">
          <usefield name="kod_outeris" title="Инф. система" type="number" field="asuse_kod_outeris" />
          <usefield title="Отчётный период" field="asuse_ym_othr" name="ym" type="number">
            <defaultquery>
              <query name="43375-ym-val" />
            </defaultquery>
          </usefield>
          <usefield name="kod_es" type="number" field="asuse_kod_org_sbyt" title="Энергосбытовая компания" />
        </fieldgroup>
        <fieldgroup title="Договор" expanded="0">
          <usefield name="kodp" field="asuse_kodp_kod_res" title="Абонент" />
          <usefield field="asuse_kod_dog_kodp_res" title="Договор" name="kod_dog" />
          <usefield title="Объект" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
        </fieldgroup>
        <fieldgroup title="Точка учёта" expanded="0">
          <usefield title="Номер счётчика" field="cmn_string" name="serial_num" />
          <usefield title="Зона филиала СК" name="fil_tu" field="asuse_kod_seti" />
          <usefield title="Зона района ЭС" name="res_tu" field="asuse_kod_elter_org_tu_prava" />
          <usefield title="Граница с сетями" name="kod_net" field="asuse_consumers_network" />
          <usefield type="number" field="asuse_kod_v_nv" title="Напряжение на границе" name="point_kv" />
          <usefield title="Группа потребителей по сети" name="kod_pwrcompany" field="asuse_kod_pwrcompany" />
          <usefield title="Расчётный уровень напряжения" name="voltage" type="string" field="asuse_voltage_abbr_1" />
          <usefield type="string" field="asuse_energy" name="energy" title="Вид энергии" />
          <usefield type="string" field="asuse_abbr_directen" name="directen" title="Направление энергии" />
          <usefield title="Ценовая категория" name="price_category" type="number" field="asuse_price_category" />
        </fieldgroup>
        <fieldgroup title="Схема сети" expanded="0">
          <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="1" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="eobj_id_eo" title="Оборудование ЦП" clear-on-list-change="1" />
          <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" name="eobj_id_eo_tp" title="Энергообъект" />
          <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Оборудование ЭО" clear-on-list-change="1">
            <listquery>
              <query name="hv_eobject_eq_tp">
                <withparams exclude="1">
                  <useparam name="kod_adr_m" />
                </withparams>
              </query>
            </listquery>
          </usefield>
        </fieldgroup>
      </content>
      <select>
        <column table="a" column="kod_point" key="1" />
        <column table="a" column="name_fsk" />
        <column table="a" column="name_es" />
        <column table="a" column="kod_es" />
        <column table="a" column="name_rsk" />
        <column table="a" column="kod_outeris" />
        <column table="a" column="tpoint_abbr" />
        <column table="a" column="r_pwrlev" />
        <column table="a" column="price_category" />
        <column table="a" column="kind_en" />
        <column table="a" column="direct_en" />
        <column table="a" column="unit" />
      </select>
      <from>
        <query name="ar_point" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1">
            <column table="a" column="ym" />
            <useparam name="ym" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_outeris" />
            <useparam name="kod_outeris" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_es" />
            <useparam name="kod_es" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_fsk" />
            <useparam name="fil_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_rsk" />
            <useparam name="res_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_numobj" />
            <useparam name="kod_numobj" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp" />
            <useparam name="kodp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodeo" />
            <useparam name="eobj_id_eo" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="src_kodfider" />
            <useparam name="eobj_id" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodeo" />
            <useparam name="eobj_id_eo_tp" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="place_kodfider" />
            <useparam name="eobj_id_tp" />
          </call>
          <call function="like" optional="1">
            <column table="a" column="cnt_num" />
            <useparam name="serial_num" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kind_en" />
            <useparam name="energy" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="direct_en" />
            <useparam name="directen" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="pwr_lev" />
            <useparam name="point_kv" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="r_pwrlev" />
            <useparam name="voltage" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="price_category" />
            <useparam name="price_category" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_net" />
            <useparam name="kod_net" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kod_pwrcompany" />
            <useparam name="kod_pwrcompany" />
          </call>
          <call function="=">
            <column table="a" column="kod_calclev" />
            <const type="number">1</const>
          </call>
          <call function="=">
            <column table="a" column="status" />
            <const type="number">0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="hk_voltage_abbr_1" title="Уровень напряжения по аббревиатуре" order="abbr" timestamp="25.10.2023 11:55:04">
      <select>
        <column table="hk_voltage_fact" column="abbr" title="Аббревиатура" />
        <column table="hk_voltage_fact" column="name" title="Наименование" />
      </select>
      <from>
        <query name="hk_voltage_fact" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="hk_voltage_fact" column="pr_active" />
            <const>0</const>
          </call>
          <call function="gt">
            <column table="hk_voltage_fact" column="voltage" />
            <const>0</const>
          </call>
          <call function="=">
            <column table="hk_voltage_fact" column="pr_fict" />
            <const type="number">0</const>
          </call>
        </call>
      </where>
    </query>
  </queries>
  <fields>
    <field id="asuse_kod_outeris" title="Список систем- источников ТУ" timestamp="09.09.2018 00:54:11" controlType="UIList" type="number">
      <listquery>
        <query name="ak_outeris" as="a" />
      </listquery>
    </field>
    <field id="asuse_kod_f46" title="Форма 46" controlType="UIList" type="number" timestamp="09.09.2018 01:35:15">
      <listquery>
        <query name="ks_46" />
      </listquery>
    </field>
    <field id="asuse_vid_t_2" title="Вид начисления ( список)" controlType="UIList" type="number" timestamp="09.09.2018 01:41:26">
      <listquery>
        <query name="sk_nachisl" as="a" />
      </listquery>
    </field>
    <field id="asuse_tpoint" title="Тип точки учёта" controlType="UIList" type="string" timestamp="09.09.2018 15:16:45">
      <listquery>
        <query name="hk_tpoint" />
      </listquery>
    </field>
    <field id="asuse_kod_calclev" title="Уровень расчёта" controlType="UIList" type="number" timestamp="09.09.2018 14:51:21">
      <listquery>
        <query name="hv_calclev_q" />
      </listquery>
    </field>
    <field id="asuse_price_category" timestamp="09.09.2018 15:35:00" controlType="UIList" type="number">
      <listquery>
        <query name="hv_price_category" />
      </listquery>
    </field>
    <field id="asuse_energy" title="Виды энергии" controlType="UIList" type="string" timestamp="09.09.2018 15:47:05">
      <listquery>
        <query name="hk_energy" />
      </listquery>
    </field>
    <field id="asuse_abbr_directen" controlType="UIList" type="string" timestamp="09.09.2018 15:52:23" title="Направление энергии (Аббревиатура)">
      <listquery>
        <query name="hk_directen" />
      </listquery>
    </field>
    <field id="asuse_voltage_abbr" title="Уровень напряжения ( аббревиатура)" type="string" controlType="UIList" timestamp="09.09.2018 16:02:32">
      <listquery>
        <query name="hk_voltage_abbr" />
      </listquery>
    </field>
    <field id="asuse_edizm_point" title="Список ед. измерения в точках" timestamp="09.09.2018 21:36:26" type="string" controlType="UIList">
      <listquery>
        <query name="sk_edizm_point" />
      </listquery>
    </field>
    <field id="asuse_tarif_el" title="Эл. тарифы" controlType="UIList" type="number" timestamp="12.09.2018 15:07:56" parent-field-name="tarif_parent">
      <listquery>
        <query name="ks_tarif_el" />
      </listquery>
    </field>
    <field id="asuse_tafil_el_active" title="Эл. тарифы активные" controlType="UIList" type="number" timestamp="09.10.2018 16:25:38" parent-field-name="tarif_parent">
      <listquery>
        <query name="kv_tarif_el" />
      </listquery>
    </field>
    <field id="asuse_kod_v_nv" title="Фактическое напряжение ( по значению)" type="number" controlType="UIList" show-nulls="1" timestamp="12.06.2019 02:47:17">
      <listquery>
        <query name="hk_v_nv" />
      </listquery>
    </field>
    <field id="asuse_kod_eosrc_all(kodp_res)" title="Поле для отображения  энергообъектов по РЭС" controlType="UIList" type="number" timestamp="19.06.2019 17:00:32">
      <listquery>
        <query name="hv_eosrc_all(kod_res)" />
      </listquery>
    </field>
    <field id="asuse_search_pu" title="Выбор номера прибора" controlType="UIList" type="string" timestamp="28.09.2021 01:33:04">
      <listquery>
        <query name="hv_search_balance_pu" />
      </listquery>
    </field>
    <field id="asuse_kod_pwrcompany" type="number" controlType="UIList" title="Группа потребителей по сети" name="kodp" timestamp="29.09.2021 17:00:11">
      <listquery>
        <query name="hv_org_pwrcompany" />
      </listquery>
    </field>
    <field id="asuse_kod_eosrc_all" title="Поле для отображения  энергообъектов " type="number" controlType="UICombo" timestamp="02.12.2021 10:08:13">
      <listquery>
        <query name="hv_eosrc_all_con" />
      </listquery>
    </field>
    <field id="asuse_kod_eobject_oneeq" name="Список оборудования(одиночный выбор)" controlType="UICombo" type="number" timestamp="02.12.2021 10:16:02">
      <listquery>
        <query name="hv_eobject_eq" />
      </listquery>
    </field>
    <field id="asuse_kod_point" type="number" title="Список точек учёта по договору(объекту)" controlType="UIList" timestamp="24.11.2022 11:27:32">
      <listquery>
        <query name="hv_point(kod_dog, kod_obj)" />
      </listquery>
    </field>
    <field id="asuse_consumers_network" title="Граница с сетями" controlType="UIList" type="number" timestamp="24.04.2023 13:12:51">
      <listquery>
        <query name="hv_borders_network" />
      </listquery>
    </field>
    <field id="asuse_voltage_abbr_1" title="Уровень напряжения ( аббревиатура)" type="string" controlType="UIList" timestamp="25.10.2023 11:52:06">
      <listquery>
        <query name="hk_voltage_abbr_1" />
      </listquery>
    </field>
  </fields>
  <views>
    <view name="hv_calclev">
      SELECT 1 as kod,
      'по точке' as name
      FROM dual
      UNION ALL
      SELECT 2 as kod,
      'по объекту' as name
      FROM dual
      UNION ALL
      SELECT 3 as kod,
      'по инт.точке' as name
      FROM dual
    </view>
    <view name="hv_price_category">
      SELECT 0 as kod,'0' as name FROM dual
      UNION ALL
      SELECT 1 as kod,'1' as name FROM dual
      UNION ALL
      SELECT 2 as kod,'2' as name FROM dual
      UNION ALL 
      SELECT 3 as kod,'3' as name FROM dual
       UNION ALL
      SELECT 4 as kod,'4' as name FROM dual
      UNION ALL 
      SELECT 5 as kod,'5' as name FROM dual
       UNION ALL 
      SELECT 6 as kod,'6' as name FROM dual
    </view>
    <view name="kv_tarif_el">
      WITH TARIFS_TABLE AS
(SELECT t.npp, t.tarif, LEVEL AS LEVELS,
                  CASE 
                  WHEN t.TARIF_PARENT IS NULL AND t.TIP_TARIF_SOST IS NOT NULL THEN
                  t.TIP_TARIF_SOST -1000000
                  WHEN t.TARIF_PARENT IS NULL AND t.TIP_TARIF_SOST IS NULL THEN
                  -1000000
                  ELSE t.TARIF_PARENT
                  END TARIF_PARENT,
                  t.npp || '  ' || t.sname as TARIF_NAME,
                t.PR_ACTIVE,
                t.tip_tarif_sost, t.tep_el
             FROM ks_tarif t WHERE 1=1
                    AND t.tep_el = 1                    
                    AND t.pr_active IN (2, 0)
                    
                     AND kg_tarif.is_active_cached(t.tarif) = 1
       CONNECT BY PRIOR t.tarif = t.tarif_parent
       START WITH     t.tarif_parent IS NULL
ORDER SIBLINGS BY t.npp) 
 
, SOST_TABLE AS
 (SELECT CASE WHEN t.SOST IS NULL AND 
(SELECT COUNT(a.tip_tarif_sost) from kk_tarif_sost a where a.tep_el IS NOT NULL and a.tep_el = t.tep_el and a.sost IS NULL) = 1 THEN
  -1000000
  ELSE 
  t.tip_tarif_sost -1000000 
  END  TARIF,  
  0 AS LEVELS, null as TARIF_PARENT,
  t.name as TARIF_NAME, t.pr_active, t.SOST as tip_tarif_sost, t.tep_el
  FROM kk_tarif_sost t
  where 1 = 1 
AND t.tep_el = 1
AND ((t.sost IS NULL AND (select COUNT(a.TARIF) from TARIFS_TABLE a WHERE a.TIP_TARIF_SOST IS NULL) &gt; 0)
OR (t.tip_tarif_sost in (select DISTINCT a.TIP_TARIF_SOST from TARIFS_TABLE a)))
AND t.pr_active IN (2, 0)
ORDER BY t.name)

SELECT  s.tarif as npp, 
        s.* FROM SOST_TABLE s
union all
SELECT * FROM  TARIFS_TABLE m WHERE 1 = 1
AND m.tip_tarif_sost IS NULL
OR m.tip_tarif_sost IN (SELECT a.tip_tarif_sost FROM SOST_TABLE a)
    </view>
    <view name="hv_eosrc_all_res">

      select s.eobj_id as seobj_id,
      max(s.dnum) as seobj_name,
      max(sk.sname) as kindname,
      max(s.kod_srckind) as kod_srckind,
      max(eo.bal_id) as bal_id,
      max(eo.expl_id) as expl_id,
      max(b.name) as balter_name,
      max(e.name) as elter_name,
      max(st.sname) as seti
      from hr_eosrc s
      inner join
      hr_eobject eo on eo.eobj_id= s.eobj_id
      inner join
      hk_srckind sk on sk.kod_srckind = s.kod_srckind
      inner join
      kr_org b on b.kodp = eo.bal_id
      inner join
      kr_org e on e.kodp = eo.expl_id
      left join
      hr_eosrc_elnet el on el.eobj_id = s.eobj_id
      left join
      hv_seti  st on st.kod = el.kodp
      left join
      hr_eobject eq on eq.parent_id = eo.eobj_id
      left join
      hv_eobject_senter_nut sn on sn.eobj_id = eq.eobj_id
      left join
      ( select eobj_id, kod_point from hr_point_har h where h.dat_po is null and h.pr_active !=1) h on h.eobj_id  = eq.eobj_id
      left join
      hr_point p on p.kod_point = h.kod_point
      where eo.deleted =0 
      {and p.kodp_rsk in :res_tu } {and st.kod in :fil_tu } {and eo.bal_id in :bal_id_eo }
      {and p.kodp_fsk in :fil_tu } {and sn.id_senter_nut in :eobj_id_eo }
      {and sn.id_fider_nut in :eobj_id }
      group by s.eobj_id
    </view>
    <view name="hv_eosrc_all">

      select a.seobj_id as seobj_id, 
       a.seobj_name as seobj_name,
       a.kindname as kindname,         
       a.balter_name as balter_name, 
       a.elter_name as elter_name, 
       a.seti as seti
       from hv_eosrc_search  a

   </view>
  </views>
</root>