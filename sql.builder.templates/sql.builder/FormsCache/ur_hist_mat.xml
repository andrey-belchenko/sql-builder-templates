<?xml version="1.0" encoding="utf-8"?>
<root>
  <form name="ur_hist_mat" title="[:ur_hist_mat.nump] дело [:ur_mat.num_delo]" show-toolbar="1" form-size="932;732" security-id="asuse_ur_hist_mat" with-behavior="0" timestamp="28.12.2023 14:55:57" file="sql.builder.templates\sql.builder\projects\asuse2\forms\Арбитраж\ur_hist_mat.xml" elid="271" ord="271" leaf="0" lvl="2" pelid="">
    <field table="f10" name="val" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="31378379" />
    <field table="ur_hist_mat" name="route_visible" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="27928355">
      <call function="if" as="route_visible" parname="route_visible" type="number" column-visible="0" table="kod_mat" id="54884923">
        <call function="=" id="6230421">
          <call function="user_rights_kod_menu" id="60445587">
            <const id="59385911">189006</const>
          </call>
          <const id="49499549">2</const>
        </call>
        <const id="61776895">1</const>
        <const id="52949968">0</const>
      </call>
    </field>
    <field id="23219771" controlType="UIText" type="string" elid="389" ord="389" leaf="1" lvl="2" pelid="" name="ret_errmsg" title="ret_errmsg" checked="1" show-checkbox="0" width-perc="50" visible="0" />
    <field id="22688319" controlType="UINumber" edit-mask="d" type="number" elid="393" ord="393" leaf="1" lvl="2" pelid="" name="ret_status" title="ret_status" checked="1" show-checkbox="0" width-perc="50" visible="0" />
    <field table="ur_hist_mat" name="kod_mat" title="Материалы переданные в суд" controlType="UICombo" rows-limit="100" id="61630234" />
    <field table="ur_hist_mat" name="decision" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="45569157" />
    <field table="ur_hist_mat" name="not_vvod" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="27160033" />
    <field table="ur_hist_mat" name="kodp" title="Абонент" controlType="UICombo" rows-limit="100" id="56865125" />
    <field table="ur_hist_mat" name="nump" title="Код абонента" controlType="UIText" rows-limit="100" id="15039893" />
    <fieldgroup title="Иск" id="65229730">
      <field table="ur_mat" name="num_delo" title="Номер дела" controlType="UIText" rows-limit="100" width-perc="50" id="35585737" />
      <field table="ur_mat" name="dat_prin" title="Дата принятия документов в суде" controlType="UIDate" rows-limit="100" width-perc="50" id="35238054" />
    </fieldgroup>
    <fieldgroup title="Суд/судебный участок" visible="f10" id="28070746">
      <field table="ur_mat" name="kod_sud" title="Суд" controlType="UICombo" rows-limit="100" id="34623674" />
      <field table="ur_hist_mat" name="kod_zased" title="Судья" controlType="UICombo" rows-limit="100" width-perc="50" id="17156462">
        <listquery id="24805735">
          <query name="us_zased_org" id="21993517">
            <withparams id="16875636">
              <useparam name="p_kod_sdp" id="39306143" />
              <useparam name="kod_sud" id="2850818" />
            </withparams>
          </query>
        </listquery>
      </field>
      <field table="ur_hist_mat" name="phone" title="Телефон" controlType="UIText" rows-limit="100" width-perc="50" id="39635558" />
      <field table="ur_hist_mat" name="kod_sud" title="Участок" controlType="UICombo" rows-limit="100" id="2679548" />
    </fieldgroup>
    <fieldgroup title="Этап рассмотрения" id="65301090">
      <field table="ur_hist_mat" name="kod_sdp" title="" controlType="UICombo" rows-limit="100" id="11354564" />
      <field table="ur_hist_mat" name="dat_rassm" title="Дата суд. разб." controlType="UIDate" rows-limit="100" width-perc="50" id="18262115" />
      <field table="ur_hist_mat" name="dat_post" title="Дата прин. суд. акта" controlType="UIDate" rows-limit="100" width-perc="50" id="27109685" />
      <field table="ur_hist_mat" name="result_kod_post" title="Судебный акт" controlType="UICombo" rows-limit="100" width-perc="50" id="49656154">
        <listquery id="21931808">
          <query name="us_post_list" id="5478627">
            <withparams id="14031625">
              <useparam name="folder_kod_sdp" id="31919872" />
            </withparams>
          </query>
        </listquery>
      </field>
      <field table="ur_hist_mat" name="kod_result" title="Результат рассмотрения" controlType="UICombo" rows-limit="0" width-perc="50" id="21535187" />
      <field table="ur_hist_mat" name="dat_srok" title="Срок обжалования решения" controlType="UIDate" rows-limit="100" width-perc="50" id="27254829" />
      <field table="ur_hist_mat" name="dat_entry" title="Дата вст. реш. в зак. силу" controlType="UIDate" rows-limit="100" width-perc="50" id="54710623" />
      <field table="ur_hist_mat" name="dat_send_il" title="Дата направления ИЛ в филиал" controlType="UIDate" rows-limit="100" width-perc="50" id="2842984" />
      <field table="ur_hist_mat" name="prim" title="Примечание" controlType="UITextEx" rows-limit="100" id="67096148" />
      <field table="ur_hist_mat" name="kod_scan" title="Файл" controlType="UIFile" rows-limit="100" id="31391683" />
    </fieldgroup>
    <fieldgroup noborder="1" visible="decision" visible-invert="1" id="40127928">
      <uicommand action-type="custom" title="Счет на гос. пошлину" visible="kod_sf_gp" id="5848071">
        <useaction action-type="dynamic-form" call="sr_facvip_ur" modal="1" id="37820996">
          <useparam name="kod_mat" id="38405754" />
          <useparam name="kod_sf_gp" id="22239088" />
        </useaction>
        <useaction action-type="refresh-table" object="dp_gp" id="58355770" />
      </uicommand>
      <uicommand action-type="custom" title="Создать счет на гос. пошлину" visible="kod_sf_gp" visible-invert="1" id="17217795">
        <useaction action-type="dynamic-form" call="create_ur_sf" modal="1" id="17064060">
          <useparam name="kod_mat" id="41512350" />
          <useparam name="gp_otv" id="52670906" />
          <const id="40094602">9</const>
          <const id="44639137">49</const>
        </useaction>
        <useaction action-type="refresh-table" object="dp_gp" id="31979988" />
      </uicommand>
    </fieldgroup>
    <fieldgroup title="Сумма присужденная" visible="decision" id="8025123">
      <fieldgroup width-perc="50" noborder="1" id="65272901">
        <field table="ur_mat" name="ur_dp_priz_all" title="Всего" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="50" id="46405436" />
        <field table="ur_mat" name="ur_dp_priz_osn" title="Осн. реал." controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="50" id="27457109" />
        <uicommand action-type="custom" title="Ввод сумм по документам" id="18958433">
          <useaction object="ur_mat" name="form_ur_dogplat_doc_view_prizn" modal="1" width-perc="100" id="8201245">
            <useparam name="p_kod_sdp" id="18936333" />
            <useparam name="kodp" id="64101560" />
            <useparam name="dat_post" id="41939504" />
          </useaction>
          <useaction action-type="refresh-table" object="dp_peni" id="32012830" />
        </uicommand>
      </fieldgroup>
      <fieldgroup width-perc="25" noborder="1" id="60805281">
        <field table="ur_mat" name="ur_dp_priz_peni" title="Проценты (пени)" controlType="UIText" edit-mask="N2" rows-limit="100" id="36911691" />
        <field table="ur_hist_mat" name="peni" title="Проценты (пени)" controlType="UIText" edit-mask="N2" rows-limit="100" id="1746544" />
        <field table="dp_peni" name="kod_sf_peni" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="7095990" />
        <uicommand action-type="custom" title="Создать счет на проценты (пени)" side="Right" visible="kod_sf_peni" visible-invert="1" id="8130320">
          <useaction action-type="dynamic-form" call="create_ur_sf" modal="1" id="48357590">
            <useparam name="kod_mat" id="32453039" />
            <useparam name="peni_hand" id="42289497" />
            <const id="26750863">7</const>
            <const id="8509637">-44</const>
          </useaction>
          <useaction action-type="refresh-table" object="dp_peni" id="12815452" />
        </uicommand>
        <uicommand action-type="custom" title="Счет на проценты (пени)" side="Right" visible="kod_sf_peni" id="44305328">
          <useaction action-type="dynamic-form" call="sr_facvip_ur" modal="1" id="42326131">
            <useparam name="kod_mat" id="28253828" />
            <useparam name="kod_sf_peni" id="21057885" />
          </useaction>
          <useaction action-type="refresh-table" object="dp_peni" id="28692459" />
        </uicommand>
        <field table="ur_mat" name="ur_dp_sum_peni" title="Пени 1" controlType="UIText" edit-mask="N2" rows-limit="100" id="66481014" />
        <field table="ur_mat" name="ur_dp_priz_vld" title="Валидация (наличие признанных сумм по решению)" controlType="UIText" rows-limit="100" id="48310478" />
      </fieldgroup>
      <fieldgroup width-perc="25" noborder="1" visible="f10" visible-invert="1" id="44468591">
        <field table="ur_mat" name="ur_dp_priz_shtr" title="Штраф" controlType="UIText" edit-mask="N2" rows-limit="100" id="1454442" />
        <field table="ur_hist_mat" name="Штраф" title="Штраф" controlType="UIText" edit-mask="N2" rows-limit="100" id="58997275" />
        <field table="dp_shtraf" name="kod_sf_shtraf" title="" controlType="UIText" edit-mask="N2" rows-limit="100" id="31560303" />
        <uicommand action-type="custom" title="Счет на штраф" visible="kod_sf_shtraf" side="Right" id="8725059">
          <useaction action-type="dynamic-form" call="sr_facvip_ur" modal="1" id="15054221">
            <useparam name="kod_mat" id="2083846" />
            <useparam name="kod_sf_shtraf" id="43335011" />
          </useaction>
          <useaction action-type="refresh-table" object="dp_shtraf" id="59676257" />
        </uicommand>
        <uicommand action-type="custom" title="Создать счет на штраф" visible="kod_sf_shtraf" visible-invert="1" side="Right" id="19832104">
          <useaction action-type="dynamic-form" call="create_ur_sf" modal="1" id="39713337">
            <useparam name="kod_mat" id="59774963" />
            <useparam name="shtraf" id="13956469" />
            <const id="1495358">4</const>
            <const id="12145153">154</const>
          </useaction>
          <useaction action-type="refresh-table" object="dp_shtraf" id="24432085" />
        </uicommand>
      </fieldgroup>
    </fieldgroup>
    <fieldgroup title="Госпошлина" visible="decision" is-layout-block="1" id="32515940">
      <field table="ur_mat" name="sum_gp" title="Оплачено при подаче" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="22678366" />
      <field table="ur_hist_mat" name="gp_otv" title="Ответчика" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="17219519">
        <buttons id="7300384">
          <uicommand title="Рассчет госпошлины по признанной сумме" object="ur_hist_mat" name="clu_calc_gp" width-perc="50" type="Redo" id="51248064" />
          <uicommand object="ur_hist_mat" title="Добавить остаток" name="clu_calc_gp_otv" type="Plus" side="Right" id="31792867" />
        </buttons>
      </field>
      <field table="dp_gp" name="kod_sf_gp" title="" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="51376039" />
      <uicommand action-type="custom" title="Счет на гос. пошлину" visible="kod_sf_gp" width-perc="33" id="41040658">
        <useaction action-type="dynamic-form" call="sr_facvip_ur" modal="1" id="34202144">
          <useparam name="kod_mat" id="31237268" />
          <useparam name="kod_sf_gp" id="44962497" />
        </useaction>
        <useaction action-type="refresh-table" object="dp_gp" id="774352" />
      </uicommand>
      <uicommand action-type="custom" title="Создать счет на гос. пошлину" visible="kod_sf_gp" visible-invert="1" width-perc="33" id="53407363">
        <useaction action-type="dynamic-form" call="create_ur_sf" modal="1" id="65001608">
          <useparam name="kod_mat" id="27671252" />
          <useparam name="gp_otv" id="57290239" />
          <const id="16483805">9</const>
          <const id="1226445">49</const>
        </useaction>
        <useaction action-type="refresh-table" object="dp_gp" id="22533170" />
      </uicommand>
      <field table="ur_hist_mat" name="gp_all" title="Всего по решению" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="12017973" />
      <field table="ur_mat" name="ur_hist_mat_gp_vld" title="Гос. пошлина, всего" controlType="UIText" rows-limit="100" id="10399090" />
      <field table="ur_hist_mat" name="gp_es" title="Истца" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="63520274">
        <buttons id="62340873">
          <uicommand object="ur_hist_mat" title="Добавить остаток" name="clu_calc_gp_es" type="Plus" side="Right" id="53090647" />
        </buttons>
      </field>
      <field table="ur_hist_mat" name="gp_ret" title="Возврат из бюджета" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="15731966">
        <buttons id="28692851">
          <uicommand object="ur_hist_mat" title="Добавить остаток" name="clu_calc_gp_ret" type="Plus" side="Right" visible="1" id="33462704" />
        </buttons>
      </field>
      <fieldgroup title="Фактическая оплата" visible="f10" id="33534837">
        <field table="ur_mat" name="gp_opl1" title="От ответчика" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="44326112">
          <buttons id="18622793">
            <uicommand action-type="dynamic-form" call="ur_folders_g_plat" modal="1" width-perc="3" visible="1" title="Просмотр и привязка платежей" id="35805112">
              <const type="number" id="61340070">1</const>
              <useparam name="kod_mat" id="29798282" />
            </uicommand>
          </buttons>
        </field>
        <field table="ur_mat" name="gp_opl2" title="Из бюджета" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="33" id="47483970">
          <buttons id="46216112">
            <uicommand action-type="dynamic-form" call="ur_folders_g_plat" modal="1" title="Просмотр и привязка платежей" width-perc="3" visible="1" id="27462306">
              <const type="number" id="37159752">2</const>
              <useparam name="kod_mat" id="23309846" />
            </uicommand>
          </buttons>
        </field>
      </fieldgroup>
    </fieldgroup>
    <fieldgroup title="Ввод сумм вручную" expanded="0" visible="decision" id="25436383">
      <fieldgroup noborder="1" width-perc="33" id="26399586">
        <label id="45623224" />
        <label title="Судебные издержки" id="2111776" />
        <label title="Расх. за введ. огр. реж. энергопотр." id="44815279" />
      </fieldgroup>
      <fieldgroup noborder="1" width-perc="33" id="60279339">
        <label title="Начислено" id="57000818" />
        <field table="ur_hist_mat" name="sud_izd" title=" " controlType="UIText" edit-mask="N2" rows-limit="100" text-visible="0" id="1144505" />
        <field table="ur_hist_mat" name="ogr" title=" " controlType="UIText" edit-mask="N2" rows-limit="100" text-visible="0" id="60799298" />
      </fieldgroup>
      <fieldgroup noborder="1" width-perc="33" id="63790180">
        <label title="Оплачено" id="40688394" />
        <field table="ur_hist_mat" name="opl_sud_izd" title=" " controlType="UIText" edit-mask="N2" rows-limit="100" text-visible="0" id="9001267" />
        <field table="ur_hist_mat" name="opl_ogr" title=" " controlType="UIText" edit-mask="N2" rows-limit="100" text-visible="0" id="51626534" />
      </fieldgroup>
    </fieldgroup>
    <fieldgroup title="Астрент" visible="decision" id="60294611">
      <field table="ur_mat" name="astrent_exists" title="Есть астрент" controlType="UICheck" rows-limit="100" width-perc="50" id="5951067" />
      <field table="ur_hist_mat" name="proc_calc" title="Рассчитывать астрент" controlType="UICheck" rows-limit="100" width-perc="50" id="6440199" />
      <field table="ur_hist_mat" name="kod_vid_proc" title="Вид процентной ставки" controlType="UICombo" rows-limit="100" width-perc="50" id="13243364" />
      <field table="ur_hist_mat" name="proc_const" title="%" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="50" id="41051950" />
      <field table="ur_mat" name="fin_ul_nach_astr" title="Начислено астрент" controlType="UIText" edit-mask="N2" rows-limit="100" width-perc="50" id="19869658" />
      <field table="ur_mat" name="fin_ul_astr_exst" title="Есть астрент (по начислениям)" controlType="UICheck" rows-limit="100" width-perc="50" id="43490421" />
    </fieldgroup>
    <toolbar id="47247953">
      <uicommand button-type="form-save-and-close" name="form-save-and-close" control-name="ButtonSaveAndClose" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="372" ord="372" leaf="1" lvl="2" pelid="" title="" id="41497788" />
      <uicommand button-type="form-save" name="form-save" control-name="ButtonSave" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="371" ord="371" leaf="1" lvl="2" pelid="" title="" id="51899130" />
      <uicommand button-type="custom-commit" editable="ur_hist_mat_has_changes" action-type="save" visible="route_visible" visible-invert="1" name="custom-commit" icon="Commit_24" title="Сохранить" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="378" ord="378" leaf="1" lvl="2" pelid="" id="66299334" />
      <uicommand button-type="custom-commit" action-type="custom" visible="route_visible" title="Сохранить (с маршрутом)" editable="ur_hist_mat_has_changes" name="custom-commit" icon="Commit_24" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="378" ord="378" leaf="1" lvl="2" pelid="" id="60953494">
        <useaction action-type="save" id="24203826" />
        <useaction name="arbitrage_route_on_save" id="53547932">
          <useparam name="kod_mat" id="7734371" />
          <const id="7268529">'umat'</const>
          <useparam name="ret_status" id="49687745" />
          <useparam name="ret_errmsg" id="16204798" />
        </useaction>
        <useaction name="arbitrage_show_errmsg" id="59395495">
          <useparam name="ret_status" id="19468141" />
          <useparam name="ret_errmsg" id="25178564" />
        </useaction>
      </uicommand>
      <uicommand button-type="custom-save-and-close" action-type="save-and-close" visible="route_visible" visible-invert="1" name="custom-save-and-close" icon="CommitAndClose_24" title="Сохранить и закрыть" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="380" ord="380" leaf="1" lvl="2" pelid="" id="9309727" />
      <uicommand button-type="custom-save-and-close" action-type="custom" visible="route_visible" title="Сохранить и закрыть(с маршрутом)" name="custom-save-and-close" icon="CommitAndClose_24" file="sql.builder.templates\sql.builder\projects\common\main.xml" elid="380" ord="380" leaf="1" lvl="2" pelid="" id="30014185">
        <useaction action-type="save" id="23653504" />
        <useaction name="arbitrage_route_on_save" id="21089103">
          <useparam name="kod_mat" id="45676189" />
          <const id="4918913">'umat'</const>
          <useparam name="ret_status" id="59375797" />
          <useparam name="ret_errmsg" id="59909541" />
        </useaction>
        <useaction name="arbitrage_show_errmsg" id="61433571">
          <useparam name="ret_status" id="43980684" />
          <useparam name="ret_errmsg" id="49274913" />
        </useaction>
        <useaction action-type="close" id="34753839" />
      </uicommand>
    </toolbar>
  </form>
  <params>
    <param name="kod_hist_mat" type="number" />
    <param name="p_kod" type="number" />
    <param name="p_kod_sdp" type="number" />
  </params>
  <dataset>
    <params>
      <param name="kod_hist_mat" type="number" />
      <param name="p_kod" type="number" />
      <param name="p_kod_sdp" type="number" />
    </params>
    <fields>
      <field type="string" name="ret_errmsg" parname="ret_errmsg" title="ret_errmsg" ClientVisible="0" />
      <field type="number" name="ret_status" parname="ret_status" title="ret_status" ClientVisible="0" />
      <field type="string" name="is_form_valid" parname="is_form_valid" />
      <field type="string" name="is_form_valid_not" parname="is_form_valid_not" />
      <field type="string" name="ur_hist_mat_has_changes" parname="ur_hist_mat_has_changes" />
      <field type="string" name="ur_mat_has_changes" parname="ur_mat_has_changes" />
      <field type="string" name="dp_gp_has_changes" parname="dp_gp_has_changes" />
      <field type="string" name="dp_peni_has_changes" parname="dp_peni_has_changes" />
      <field type="string" name="dp_shtraf_has_changes" parname="dp_shtraf_has_changes" />
      <field type="string" name="f10_has_changes" parname="f10_has_changes" />
    </fields>
    <table name="ur_hist_mat" auto-refresh="1" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" new-rows-vis-for-other-tbls="1" update-target="ur_hist_mat" key="kod_hist_mat" is-ms-upd="1" is-top="1" key-dimension="kod_hist_mat">
      <select-text>
--
select  case  when (( (select nvl(max(kod_rights),0) from rr_usermenu where PUSER = USER and kod_menu = 189006 ) )  = 2)  then 1 else 0 end  as route_visible, /*number*/
ur_hist_mat.kod_mat as kod_mat, /*number*/
ur_hist_mat.decision as decision, /*number*/
kod_folders.not_vvod as not_vvod, /*number*/
kod_folders.kodp as kodp, /*number*/
kodp.nump as nump, /*Код абонента*//*string*/
ur_hist_mat.kod_zased as kod_zased, /*number*/
kod_zased.phone as phone, /*Телефон*//*string*/
kod_zased.kod_sud as kod_sud, /*Участок*//*number*/
kod_folders.kod_sdp as kod_sdp, /*number*/
ur_hist_mat.dat_rassm as dat_rassm, /*Дата суд. разб.*//*date*/
ur_hist_mat.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
ur_hist_mat.result_kod_post as result_kod_post, /*number*/
ur_hist_mat.kod_result as kod_result, /*number*/
ur_hist_mat.dat_srok as dat_srok, /*Срок обжалования решения*//*date*/
ur_hist_mat.dat_entry as dat_entry, /*Дата вст. реш. в зак. силу*//*date*/
ur_hist_mat.dat_send_il as dat_send_il, /*Дата направления ИЛ в филиал*//*date*/
ur_hist_mat.prim as prim, /*Примечание*//*string*/
ur_hist_mat.kod_scan as kod_scan, /*number*/
ur_hist_mat.peni as peni, /*Проценты (пени)*//*number*/
ur_hist_mat.shtraf as Штраф, /*Штраф*//*number*/
ur_hist_mat.gp_otv as gp_otv, /*Ответчика*//*number*/
ur_hist_mat.gp_all as gp_all, /*Всего по решению*//*number*/
ur_hist_mat.gp_es as gp_es, /*Истца*//*number*/
ur_hist_mat.gp_ret as gp_ret, /*Возврат из бюджета*//*number*/
ur_hist_mat.sud_izd as sud_izd, /* *//*number*/
ur_hist_mat.ogr as ogr, /* *//*number*/
ur_hist_mat.opl_sud_izd as opl_sud_izd, /* *//*number*/
ur_hist_mat.opl_ogr as opl_ogr, /* *//*number*/
ur_hist_mat.proc_calc as proc_calc, /*Рассчитывать астрент*//*number*/
ur_hist_mat.kod_vid_proc as kod_vid_proc, /*number*/
ur_hist_mat.proc_const as proc_const, /*%*//*number*/
kod_mat_x_n.name as kod_mat_x_n, /*Материалы переданные в суд*//*string*/
kodp_x_n.sp_col_name as kodp_x_n, /*Абонент*//*string*/
kod_zased_x_n.fio as kod_zased_x_n, /*Судья*//*string*/
kod_sud_x_n.name as kod_sud_x_n, /*Участок*//*string*/
kod_sdp_x_n.name as kod_sdp_x_n, /*Юридический документ*//*string*/
result_kod_post_x_n.name as result_kod_post_x_n, /*Судебный акт*//*string*/
kod_result_x_n.name as kod_result_x_n, /*Результат рассмотрения*//*string*/
kod_scan_x_n.file_name as kod_scan_x_n, /*Файл*//*string*/
kod_vid_proc_x_n.name as kod_vid_proc_x_n, /*Вид процентной ставки*//*string*/
qube.kod_result_vld1 as kod_result_vld, /*string*/
ur_hist_mat.decision2 as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
ur_hist_mat.dat_entry_vld as dat_entry_vld, /*Дата вступления, валидация*//*string*/
ur_hist_mat.is_post_astr_proc_and_calc as is_post_astr_proc_and_calc, /*string*/
ur_hist_mat.proc_const_new_val as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
ur_hist_mat.is_new as is_new, /*number*/
ur_hist_mat.is_not_new as is_not_new, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from ur_hist_mat
a
--\ur_hist_mat
)
ur_hist_mat
--\ur_hist_mat
where
(ur_hist_mat.kod_hist_mat = :kod_hist_mat )  and (ur_hist_mat.kod_hist_mat is not null ) )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ur_hist_mat
a
--\ur_hist_mat
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ur_mat
a
--\ur_mat
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ur_hist_mat
a
--\ur_hist_mat
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
(ur_hist_mat.kod_hist_mat = :kod_hist_mat )  and (ur_hist_mat.kod_hist_mat is not null )  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ur_hist_mat
a
--\ur_hist_mat
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
kod_result.kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from ur_hist_mat
a
--\ur_hist_mat
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
a.kod_result as kod_result, /*number*/
a.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
a.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
a.gp_es as gp_es, /*Гос. пошлина, взысканная с истца*//*number*/
a.prim as prim, /*Примечание*//*string*/
a.kod_zased as kod_zased, /*number*/
a.gp_otv as gp_otv, /*Гос. пошлина, взысканная с ответчика*//*number*/
a.sud_izd as sud_izd, /*Судебные издержки*//*number*/
a.ogr as ogr, /*Расходы за введение ограничения режима энергопотребления*//*number*/
a.shtraf as shtraf, /**//*number*/
a.peni as peni, /*% за польз. чуж. ден. ср.*//*number*/
a.gp_ret as gp_ret, /*Гос. пошлина, возврат из бюджета*//*number*/
a.opl_ogr as opl_ogr, /*Оплачено: расходы за введение ограничения режима энергопотребления*//*number*/
a.dat_entry as dat_entry, /*Дата вст. реш. в зак. силу*//*date*/
a.dat_srok as dat_srok, /*Срок обжалования решения*//*date*/
a.proc_calc as proc_calc, /*Рассчитывать астрент*//*number*/
a.kod_vid_proc as kod_vid_proc, /*number*/
a.proc_const as proc_const, /*%*//*number*/
a.opl_sud_izd as opl_sud_izd, /*Оплачено: Судебные издержки*//*number*/
a.kod_scan as kod_scan, /*number*/
a.dat_send_il as dat_send_il, /*Дата направления ИЛ в филиал*//*date*/
kod_result.kod_post as result_kod_post, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all, /*Гос. пошлина, всего*//*number*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld, /*Дата вступления, валидация*//*string*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc, /*string*/
kod_result.decision as decision, /*number*/
 case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end  as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
0 as is_new, /*number*/
1 as is_not_new/*number*/

from ur_hist_mat
a
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat on ur_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--sk_vid_proc
select a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
a.name as name/*Наименование*//*string*/

from sk_vid_proc
a
--\sk_vid_proc
)
kod_vid_proc_x_n on ur_hist_mat.kod_vid_proc = kod_vid_proc_x_n.kod_vid_proc--\sk_vid_proc
left outer join
(
--ur_scan_docs
select a.kod_scan as kod_scan, /*number*//*key*/
a.file_name as file_name/**//*string*/

from ur_scan_docs
a
--\ur_scan_docs
)
kod_scan_x_n on ur_hist_mat.kod_scan = kod_scan_x_n.kod_scan--\ur_scan_docs
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.name as name/*Результат рассмотрения*//*string*/

from us_result
a
--\us_result
)
kod_result_x_n on ur_hist_mat.kod_result = kod_result_x_n.kod_result--\us_result
left outer join
(
--us_post
select a.kod_post as kod_post, /*number*//*key*/
a.name as name/*Судебный акт*//*string*/

from us_post
a
--\us_post
)
result_kod_post_x_n on ur_hist_mat.result_kod_post = result_kod_post_x_n.kod_post--\us_post
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.fio as fio/*Судья*//*string*/

from us_zased
a
--\us_zased
)
kod_zased_x_n on ur_hist_mat.kod_zased = kod_zased_x_n.kod_zased--\us_zased
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
kod_doc.abbr || '  ' || a.num_delo || ' от ' || ( to_char( a.dat_doc ,'DD.MM.YYYY') )  as name/*Иск*//*string*/

from ur_mat
a
--\ur_mat
left outer join
(
--us_doc
select a.kod_doc as kod_doc, /*number*//*key*/
a.abbr as abbr/*Аббревиатура*//*string*/

from us_doc
a
--\us_doc
)
kod_doc on a.kod_doc = kod_doc.kod_doc--\us_doc
)
kod_mat_x_n on ur_hist_mat.kod_mat = kod_mat_x_n.kod_mat--\ur_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.phone as phone, /*Телефон*//*string*/
a.kod_sud as kod_sud/*number*/

from us_zased
a
--\us_zased
)
kod_zased on ur_hist_mat.kod_zased = kod_zased.kod_zased--\us_zased
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on kod_zased.kod_sud = kod_sud_x_n.kod_sud--\us_sud
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp, /**//*number*/
a.kod_sdp as kod_sdp, /*number*/
 decode ( a.vvod ,0,1,0)  as not_vvod/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--uk_sdp
select a.kod_sdp as kod_sdp, /*number*//*key*/
a.name as name/*Юридический документ*//*string*/

from uk_sdp
a
--\uk_sdp
)
kod_sdp_x_n on kod_folders.kod_sdp = kod_sdp_x_n.kod_sdp--\uk_sdp
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump || ' ' || a.name as sp_col_name/**//*string*/

from kr_payer
a
--\kr_payer
)
kodp_x_n on kod_folders.kodp = kodp_x_n.kodp--\kr_payer
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump as nump/*Код абонента*//*string*/

from kr_payer
a
--\kr_payer
)
kodp on kod_folders.kodp = kodp.kodp--\kr_payer
--\
</select-text>
      <columns>
        <column name="route_visible" table="kod_mat" type="number" title="" parname="route_visible" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select  case  when (( (select nvl(max(kod_rights),0) from rr_usermenu where PUSER = USER and kod_menu = 189006 ) )  = 2)  then 1 else 0 end  as route_visible, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_mat" table="ur_hist_mat" type="number" title="Материалы переданные в суд" parname="kod_mat" ColumnVisible="0" ClientDefault="p_kod" ColumnMandatory="1" is-updateable="1" is-updateable-ext="1" update-target="kod_mat" temp-col-name="n3">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_folders.not_vvod as not_vvod, /*number*/
kod_folders.kodp as kodp, /*number*/
kodp.nump as nump, /*Код абонента*//*string*/
kod_folders.kod_sdp as kod_sdp, /*number*/
kod_mat_x_n.name as kod_mat_x_n, /*Материалы переданные в суд*//*string*/
kodp_x_n.sp_col_name as kodp_x_n, /*Абонент*//*string*/
kod_sdp_x_n.name as kod_sdp_x_n, /*Юридический документ*//*string*/
qube.kod_result_vld1 as kod_result_vld, /*string*/
 coalesce( ur_hist_mat.proc_const_new_val , ur_hist_mat_mpv_1.proc_const_new_val )  as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
 coalesce( ur_hist_mat.kod_hist_mat , ur_hist_mat_mpv_1.kod_hist_mat )  as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val/*Дата прин. суд. акта*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.dat_post as dat_post  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.d1 as dat_post  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.dat_post as dat_post  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.d1 as dat_post  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
)
ur_hist_mat_mpv_1 on ur_hist_mat_mpv_1.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val/*Дата прин. суд. акта*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.dat_post as dat_post  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.d1 as dat_post  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.dat_post as dat_post  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.d1 as dat_post  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from (select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
)
ur_hist_mat on ( coalesce( ur_hist_mat.kod_hist_mat , ur_hist_mat_mpv_1.kod_hist_mat ) )  = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
kod_doc.abbr || '  ' || a.num_delo || ' от ' || ( to_char( a.dat_doc ,'DD.MM.YYYY') )  as name/*Иск*//*string*/

from ur_mat
a
--\ur_mat
left outer join
(
--us_doc
select a.kod_doc as kod_doc, /*number*//*key*/
a.abbr as abbr/*Аббревиатура*//*string*/

from us_doc
a
--\us_doc
)
kod_doc on a.kod_doc = kod_doc.kod_doc--\us_doc
)
kod_mat_x_n on ( coalesce( ur_hist_mat.kod_mat , ur_hist_mat_mpv_1.kod_mat ) )  = kod_mat_x_n.kod_mat--\ur_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ( coalesce( ur_hist_mat.kod_mat , ur_hist_mat_mpv_1.kod_mat ) )  = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp, /**//*number*/
a.kod_sdp as kod_sdp, /*number*/
 decode ( a.vvod ,0,1,0)  as not_vvod/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--uk_sdp
select a.kod_sdp as kod_sdp, /*number*//*key*/
a.name as name/*Юридический документ*//*string*/

from uk_sdp
a
--\uk_sdp
)
kod_sdp_x_n on kod_folders.kod_sdp = kod_sdp_x_n.kod_sdp--\uk_sdp
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump || ' ' || a.name as sp_col_name/**//*string*/

from kr_payer
a
--\kr_payer
)
kodp_x_n on kod_folders.kodp = kodp_x_n.kodp--\kr_payer
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump as nump/*Код абонента*//*string*/

from kr_payer
a
--\kr_payer
)
kodp on kod_folders.kodp = kodp.kodp--\kr_payer
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
qube.ur_hist_mat_count1 as ur_hist_mat_count, /*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1, /*string*/
sum(qube.ur_hist_mat_count1)  as ur_hist_mat_count1/*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_count1)  as ur_hist_mat_count1, /*number*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1, /*number*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1, /*number*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="not_vvod" table="ur_hist_mat" />
            <dependant name="kodp" table="ur_hist_mat" />
            <dependant name="nump" table="ur_hist_mat" />
            <dependant name="kod_sdp" table="ur_hist_mat" />
            <dependant name="kod_mat_x_n" table="ur_hist_mat" />
            <dependant name="kodp_x_n" table="ur_hist_mat" />
            <dependant name="kod_sdp_x_n" table="ur_hist_mat" />
            <dependant name="kod_result_vld" table="ur_hist_mat" />
            <dependant name="kod_result_vld" table="ur_hist_mat" />
            <dependant name="proc_const_new_val" table="ur_hist_mat" />
            <dependant name="ur_hist_mat_gp_vld" table="ur_mat" />
            <dependant name="ur_hist_mat_count" table="ur_mat" />
          </dependants>
        </column>
        <column name="decision" table="ur_hist_mat" type="number" title="" parname="decision" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.decision as decision, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
kod_result.decision as decision/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="not_vvod" table="kod_folders" type="number" title="" parname="is_not_vvod" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_folders.not_vvod as not_vvod, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
 decode ( a.vvod ,0,1,0)  as not_vvod/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kodp" table="kod_folders" type="number" title="Абонент" parname="kodp" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_folders.kodp as kodp, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="nump" table="kodp" type="string" title="Код абонента" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kodp.nump as nump, /*Код абонента*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump as nump/*Код абонента*//*string*/

from kr_payer
a
--\kr_payer
)
kodp on kod_folders.kodp = kodp.kodp--\kr_payer
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_zased" table="ur_hist_mat" type="number" title="Судья" parname="kod_zased" is-user-editable="1" ClientMandatory="f10" is-updateable="1" is-updateable-ext="1" update-target="kod_zased" temp-col-name="n5">
          <sel-list-compiled>
            <root>
              <query order="pr_active DESC, fio, kod_zased" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_zased.xml" elid="2651" ord="2651" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a" noname="1" path="./a" used="1">
                <order notext="1">
                  <column column="pr_activeDESC">pr_activeDESC</column>
                  <column column="fio">fio</column>
                  <column column="kod_zased">kod_zased</column>
                </order>
                <select>--a
select <column table="a" column="kod_zased" key="1" as="kod_zased" used="1" type="number" sourcetable="./a/a" sourcecolumn="kod_zased" into="n1">a.kod_zased as kod_zased, /*number*//*key*/
</column><column table="a" column="kod_ssp" as="kod_ssp" key="0" used="1" type="number" sourcetable="./a/a" sourcecolumn="kod_ssp" reference="us_ssp" refcol="kod_ssp" into="n2">a.kod_ssp as kod_ssp, /*number*/
</column><column table="a" column="pr_active" as="pr_active" key="0" used="1" type="number" sourcetable="./a/a" sourcecolumn="pr_active" into="n3">a.pr_active as pr_active, /*number*/
</column><column table="a" column="fio" title="Судья" as="fio" key="0" used="1" type="string" sourcetable="./a/a" sourcecolumn="fio" into="s1">a.fio as fio, /*Судья*//*string*/
</column><column table="us_sud" column="name" as="sud_name" title="Судебный участок" key="0" used="1" type="string" sourcetable="./a/us_sud" sourcecolumn="name" into="s2">us_sud.name as sud_name, /*Судебный участок*//*string*/
</column><call function="decode" type="string" as="status" title="Статус" pth="" key="0" used="1" into="s3"><text txtype="func"> decode( </text><column table="a" column="pr_active">a.pr_active</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> , </text><const><text>'Дейст.'</text></const><text txtype="func"> , </text><const><text>0</text></const><text txtype="func"> , </text><const><text>'Увол.'</text></const><text txtype="func"> ) </text> as status/*Статус*//*string*/
</call></select>
                <from>
from <query name="us_zased" as="a" path="./a/a" haskeys="1" used="1">(
<select>--us_zased
select <column table="a" column="kod_zased" type="number" key="1" as="kod_zased" sourcetable="./a/a" sourcecolumn="kod_zased" used="1">a.kod_zased as kod_zased, /*number*//*key*/
</column><column table="a" column="kod_ssp" type="number" as="kod_ssp" reference="us_ssp" refcol="kod_ssp" key="0" sourcetable="./a/a" sourcecolumn="kod_ssp" used="1">a.kod_ssp as kod_ssp, /*number*/
</column><column table="a" column="fio" type="string" title="Судья" as="fio" key="0" sourcetable="./a/a" sourcecolumn="fio" used="1">a.fio as fio, /*Судья*//*string*/
</column><column table="a" column="kod_sud" type="number" as="kod_sud" reference="us_sud" refcol="kod_sud" key="0" sourcetable="./a/a" sourcecolumn="kod_sud" used="1">a.kod_sud as kod_sud, /*number*/
</column><column table="a" column="pr_active" type="number" as="pr_active" key="0" sourcetable="./a/a" sourcecolumn="pr_active" used="1">a.pr_active as pr_active/*number*/
</column></select><from>
from <table name="us_zased" as="a" used="1">us_zased
a
--\us_zased
</table></from>)
a
--\us_zased
</query><query name="us_sud" as="us_sud" join="left outer" path="./a/us_sud" haskeys="1" used="1">left outer join
(
<select>--us_sud
select <column table="a" column="kod_sud" type="number" key="1" as="kod_sud" sourcetable="./a/us_sud" sourcecolumn="kod_sud" used="1">a.kod_sud as kod_sud, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Судебный участок" as="name" key="0" sourcetable="./a/us_sud" sourcecolumn="name" used="1">a.name as name/*Судебный участок*//*string*/
</column></select><from>
from <table name="us_sud" as="a" title="Суд / судебный участок" used="1">us_sud
a
--\us_sud
</table></from><call function="=" type="bool">)
us_sud on <column table="a" column="kod_sud">a.kod_sud</column><text txtype="func"> = </text><column table="us_sud" column="kod_sud">us_sud.kod_sud</column></call>--\us_sud
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<call function="rownum" pth="0" type="number"><text txtype="func"> rownum </text></call><text txtype="func"> &lt;= </text><const><text>:p_rows_limit </text></const>) </call><text txtype="func"> and </text><call function="or" pth="1" type="bool">(<call function="and" pth="" type="bool">(<call function="=" pth="" type="bool">(<const><text>:kod_sdp </text></const><text txtype="func"> = </text><const><text>6</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="a" column="kod_sud">a.kod_sud</column><text txtype="func"> is not null </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="or" pth="1" optional="1" type="bool">(<call function="in" pth="" type="bool">(<column table="a" column="kod_sud">a.kod_sud</column><text txtype="func"> in </text><query as="a" path="./a/a" used="1">(
<select>--
select <column table="s" column="kod_sud" as="kod_sud" fixed="1" key="1" keypath=".kod_sud" used="1" type="number" sourcetable="./a/a/s" sourcecolumn="kod_sud">s.kod_sud as kod_sud/*number*//*key*/
</column></select><from>
from <query name="us_sud" as="s" path="./a/a/s" haskeys="1" used="1">(
<select>--us_sud
select <column table="a" column="kod_sud" type="number" key="1" as="kod_sud" sourcetable="./a/a/s" sourcecolumn="kod_sud" used="1">a.kod_sud as kod_sud, /*number*//*key*/
</column><column table="a" column="kod_parent" type="number" as="kod_parent" reference="us_sud" refcol="kod_sud" key="0" sourcetable="./a/a/s" sourcecolumn="kod_parent" used="1">a.kod_parent as kod_parent/*number*/
</column></select><from>
from <table name="us_sud" as="a" title="Суд / судебный участок" used="1">us_sud
a
--\us_sud
</table></from>)
s
--\us_sud
</query></from><connect>connect by nocycle
<call function="=" pth="" type="bool"><column table="s" column="kod_sud" prior="1">prior s.kod_sud</column><text txtype="func"> = </text><column table="s" column="kod_parent">s.kod_parent</column></call></connect><start>
start with <call function="=" pth="" type="bool"><column table="s" column="kod_sud">s.kod_sud</column><text txtype="func"> = </text><const><text>:kod_sud </text></const></call></start>)
--\
</query>) </call><text txtype="func"> or </text><call function="is null" pth="" type="bool">(<const><text>:kod_sud </text></const><text txtype="func"> is null </text>) </call>) </call><text txtype="func"> } </text>) </call>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="a" column="kod_zased" key="1" as="kod_zased" thissrc="kod_zased">a.kod_zased</column><text txtype="func"> in </text><const><text>:pk_prm </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="kod_zased" key="1" as="kod_zased" thissrc="kod_zased">a.kod_zased</column><text txtype="func"> ) like lower( </text><const><text>:kod_zased_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="kod_ssp" as="kod_ssp" thissrc="kod_ssp">a.kod_ssp</column><text txtype="func"> ) like lower( </text><const><text>:kod_ssp_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="pr_active" as="pr_active" thissrc="pr_active">a.pr_active</column><text txtype="func"> ) like lower( </text><const><text>:pr_active_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="fio" title="Судья" as="fio" thissrc="fio">a.fio</column><text txtype="func"> ) like lower( </text><const><text>:fio_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="us_sud" column="name" as="sud_name" title="Судебный участок" thissrc="sud_name">us_sud.name</column><text txtype="func"> ) like lower( </text><const><text>:sud_name_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text></call></where>
                <order>
order by pr_active DESC, fio, kod_zased</order>--\a
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="a" order="pr_active DESC, fio, kod_zased" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_zased.xml" elid="2651" ord="2651" leaf="0" lvl="2" pelid="" haskeys="1" as="a">
              <queries>
                <query order="pr_active DESC, fio, kod_zased" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_zased.xml" elid="2651" ord="2651" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a">
                  <params>
                    <param name="kod_sdp" type="number" />
                    <param type="number" name="kod_sud" />
                    <param type="number" name="kod_ssp" />
                    <param name="pk_prm" type="array" />
                    <param name="kod_zased_filter" type="string" />
                    <param name="kod_ssp_filter" type="string" />
                    <param name="pr_active_filter" type="string" />
                    <param name="fio_filter" type="string" />
                    <param name="sud_name_filter" type="string" />
                    <param name="p_rows_limit" type="number" />
                  </params>
                  <select>
                    <column table="a" column="kod_zased" key="1" as="kod_zased" />
                    <column table="a" column="kod_ssp" as="kod_ssp" />
                    <column table="a" column="pr_active" as="pr_active" />
                    <column table="a" column="fio" title="Судья" as="fio" />
                    <column table="us_sud" column="name" as="sud_name" title="Судебный участок" />
                    <call function="decode" type="string" as="status" title="Статус">
                      <column table="a" column="pr_active" />
                      <const>1</const>
                      <const>'Дейст.'</const>
                      <const>0</const>
                      <const>'Увол.'</const>
                    </call>
                  </select>
                  <from>
                    <query name="us_zased" as="a">
                      <link name="kod_sud" as="us_sud" table="us_sud" child="us_zased" field="kod_sud" parent="us_sud" back="us_zased" title="Суд / судебный участок" />
                    </query>
                  </from>
                  <where>
                    <call function="and">
                      <call function="le">
                        <call function="rownum" />
                        <useparam name="p_rows_limit" />
                      </call>
                      <call function="or">
                        <call function="and">
                          <call function="=">
                            <useparam name="kod_sdp" />
                            <const>6</const>
                          </call>
                          <call function="is not null">
                            <column table="a" column="kod_sud" />
                          </call>
                          <call function="or" optional="1">
                            <call function="in">
                              <column table="a" column="kod_sud" />
                              <query>
                                <select>
                                  <column table="s" column="kod_sud" as="kod_sud" />
                                </select>
                                <from>
                                  <query name="us_sud" as="s" title="Суд / судебный участок" />
                                </from>
                                <start>
                                  <call function="=">
                                    <column table="s" column="kod_sud" />
                                    <useparam name="kod_sud" />
                                  </call>
                                </start>
                                <connect>
                                  <call function="=">
                                    <column table="s" column="kod_sud" prior="1" />
                                    <column table="s" column="kod_parent" />
                                  </call>
                                </connect>
                              </query>
                            </call>
                            <call function="is null">
                              <useparam name="kod_sud" />
                            </call>
                          </call>
                        </call>
                        <!--добавить условие для ssp-->
                      </call>
                      <call function="in" optional="1">
                        <column table="this" column="kod_zased" />
                        <useparam name="pk_prm" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_zased" />
                        <useparam name="kod_zased_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_ssp" />
                        <useparam name="kod_ssp_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="pr_active" />
                        <useparam name="pr_active_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="fio" />
                        <useparam name="fio_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="sud_name" />
                        <useparam name="sud_name_filter" />
                      </call>
                    </call>
                  </where>
                  <order>
                    <column column="pr_activeDESC" />
                    <column column="fio" />
                    <column column="kod_zased" />
                  </order>
                  <withparams>
                    <useparam name="kod_sdp" />
                    <useparam name="kod_sud" />
                    <useparam name="kod_ssp" />
                    <useparam name="pk_prm" />
                    <useparam name="kod_zased_filter" />
                    <useparam name="kod_ssp_filter" />
                    <useparam name="pr_active_filter" />
                    <useparam name="fio_filter" />
                    <useparam name="sud_name_filter" />
                    <useparam name="p_rows_limit" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="kod_sdp" type="number">
                  <const>:kod_sdp </const>
                </param>
                <param type="number" name="kod_sud">
                  <const>:kod_sud </const>
                </param>
                <param type="number" name="kod_ssp">
                  <const>:kod_ssp </const>
                </param>
                <param name="pk_prm" type="array">
                  <const>:pk_prm </const>
                </param>
                <param name="kod_zased_filter" type="string">
                  <const>:kod_zased_filter </const>
                </param>
                <param name="kod_ssp_filter" type="string">
                  <const>:kod_ssp_filter </const>
                </param>
                <param name="pr_active_filter" type="string">
                  <const>:pr_active_filter </const>
                </param>
                <param name="fio_filter" type="string">
                  <const>:fio_filter </const>
                </param>
                <param name="sud_name_filter" type="string">
                  <const>:sud_name_filter </const>
                </param>
                <param name="p_rows_limit" type="number">
                  <const>:p_rows_limit </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-cl-fact-pars>
            <withparams>
              <useparam name="p_kod_sdp" parname="kod_sdp" />
              <useparam name="kod_sud" parname="kod_sud" />
            </withparams>
          </sel-list-cl-fact-pars>
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_zased.phone as phone, /*Телефон*//*string*/
kod_zased.kod_sud as kod_sud, /*Участок*//*number*/
kod_zased_x_n.fio as kod_zased_x_n, /*Судья*//*string*/
kod_sud_x_n.name as kod_sud_x_n, /*Участок*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_zased as kod_zased/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.fio as fio/*Судья*//*string*/

from us_zased
a
--\us_zased
)
kod_zased_x_n on ur_hist_mat.kod_zased = kod_zased_x_n.kod_zased--\us_zased
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.phone as phone, /*Телефон*//*string*/
a.kod_sud as kod_sud/*number*/

from us_zased
a
--\us_zased
)
kod_zased on ur_hist_mat.kod_zased = kod_zased.kod_zased--\us_zased
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on kod_zased.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="phone" table="ur_hist_mat" />
            <dependant name="kod_sud" table="ur_hist_mat" />
            <dependant name="kod_zased_x_n" table="ur_hist_mat" />
            <dependant name="kod_sud_x_n" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="phone" table="kod_zased" type="string" title="Телефон" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_zased.phone as phone, /*Телефон*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_zased as kod_zased/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.phone as phone/*Телефон*//*string*/

from us_zased
a
--\us_zased
)
kod_zased on ur_hist_mat.kod_zased = kod_zased.kod_zased--\us_zased
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_sud" table="kod_zased" type="number" title="Участок" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_zased.kod_sud as kod_sud, /*Участок*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_zased as kod_zased/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.kod_sud as kod_sud/*number*/

from us_zased
a
--\us_zased
)
kod_zased on ur_hist_mat.kod_zased = kod_zased.kod_zased--\us_zased
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_sdp" table="kod_folders" type="number" title="" parname="folder_kod_sdp" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_folders.kod_sdp as kod_sdp, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="dat_rassm" table="ur_hist_mat" type="date" title="Дата суд. разб." is-user-editable="1" ClientMandatory="f10" is-updateable="1" is-updateable-ext="1" update-target="dat_rassm" temp-col-name="d2" />
        <column name="dat_post" table="ur_hist_mat" type="date" title="Дата прин. суд. акта" parname="dat_post" is-user-editable="1" ColumnMandatory="1" is-updateable="1" is-updateable-ext="1" update-target="dat_post" temp-col-name="d1">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.proc_const_new_val as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val/*Дата прин. суд. акта*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.dat_post as dat_post,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d1 as dat_post,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.dat_post as dat_post,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d1 as dat_post,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="proc_const_new_val" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="result_kod_post" table="ur_hist_mat" type="number" title="Судебный акт" ColumnEditable="1" is-user-editable="1" ColumnMandatory="1" is-updateable-ext="1" is-refreshed="1" update-target="result_kod_post" temp-col-name="n37">
          <sel-list-compiled>
            <root>
              <query class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_post.xml" elid="2640" ord="2640" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a" noname="1" path="./a" used="1">
                <select>--a
select <column table="a" column="kod_post" type="number" as="kod_post" key="1" fixed="1" used="1" sourcetable="./a/a" sourcecolumn="kod_post" into="n1">a.kod_post as kod_post, /*number*//*key*/
</column><column table="a" column="name" as="name" key="0" used="1" type="string" title="Судебный акт" sourcetable="./a/a" sourcecolumn="name" into="s1">a.name as name/*Судебный акт*//*string*/
</column></select>
                <from>
from <query name="us_post" as="a" path="./a/a" haskeys="1" used="1">(
<select>--us_post
select <column table="a" column="kod_post" type="number" as="kod_post" key="1" fixed="1" sourcetable="./a/a" sourcecolumn="kod_post" used="1">a.kod_post as kod_post, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/a" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><column table="a" column="name" type="string" title="Судебный акт" vid="1" as="name" key="0" sourcetable="./a/a" sourcecolumn="name" used="1">a.name as name/*Судебный акт*//*string*/
</column></select><from>
from <table name="us_post" as="a" title="Судебный акт" used="1">us_post
a
--\us_post
</table></from>)
a
--\us_post
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<call function="rownum" pth="0" type="number"><text txtype="func"> rownum </text></call><text txtype="func"> &lt;= </text><const><text>:p_rows_limit </text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="=" pth="" optional="1" type="bool">(<column table="a" column="kod_sdp">a.kod_sdp</column><text txtype="func"> = </text><const><text>:kod_sdp </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="a" column="kod_post" type="number" as="kod_post" key="1" fixed="1" thissrc="kod_post">a.kod_post</column><text txtype="func"> in </text><const><text>:pk_prm </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="kod_post" type="number" as="kod_post" key="1" fixed="1" thissrc="kod_post">a.kod_post</column><text txtype="func"> ) like lower( </text><const><text>:kod_post_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="name" as="name" key="0" thissrc="name">a.name</column><text txtype="func"> ) like lower( </text><const><text>:name_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text></call></where>--\a
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="a" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_post.xml" elid="2640" ord="2640" leaf="0" lvl="2" pelid="" haskeys="1" as="a">
              <queries>
                <query class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_post.xml" elid="2640" ord="2640" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a">
                  <params>
                    <param name="kod_sdp" type="number" />
                    <param name="pk_prm" type="array" />
                    <param name="kod_post_filter" type="string" />
                    <param name="name_filter" type="string" />
                    <param name="p_rows_limit" type="number" />
                  </params>
                  <select>
                    <column table="a" column="kod_post" type="number" as="kod_post" key="1" fixed="1" />
                    <column table="a" column="name" as="name" key="0" />
                  </select>
                  <from>
                    <query name="us_post" as="a" title="Судебный акт" />
                  </from>
                  <where>
                    <call function="and">
                      <call function="le">
                        <call function="rownum" />
                        <useparam name="p_rows_limit" />
                      </call>
                      <call function="and">
                        <call function="true" />
                        <call function="=" optional="1">
                          <column table="a" column="kod_sdp" />
                          <useparam name="kod_sdp" />
                        </call>
                      </call>
                      <call function="in" optional="1">
                        <column table="this" column="kod_post" />
                        <useparam name="pk_prm" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_post" />
                        <useparam name="kod_post_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="name" />
                        <useparam name="name_filter" />
                      </call>
                    </call>
                  </where>
                  <withparams>
                    <useparam name="kod_sdp" />
                    <useparam name="pk_prm" />
                    <useparam name="kod_post_filter" />
                    <useparam name="name_filter" />
                    <useparam name="p_rows_limit" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="kod_sdp" type="number">
                  <const>:kod_sdp </const>
                </param>
                <param name="pk_prm" type="array">
                  <const>:pk_prm </const>
                </param>
                <param name="kod_post_filter" type="string">
                  <const>:kod_post_filter </const>
                </param>
                <param name="name_filter" type="string">
                  <const>:name_filter </const>
                </param>
                <param name="p_rows_limit" type="number">
                  <const>:p_rows_limit </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-cl-fact-pars>
            <withparams>
              <useparam name="folder_kod_sdp" parname="kod_sdp" />
            </withparams>
          </sel-list-cl-fact-pars>
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.result_kod_post as result_kod_post, /*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.result_kod_post as result_kod_post, /*number*/
result_kod_post_x_n.name as result_kod_post_x_n, /*Судебный акт*//*string*/
qube.kod_result_vld1 as kod_result_vld, /*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat on ur_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--us_post
select a.kod_post as kod_post, /*number*//*key*/
a.name as name/*Судебный акт*//*string*/

from us_post
a
--\us_post
)
result_kod_post_x_n on ur_hist_mat.result_kod_post = result_kod_post_x_n.kod_post--\us_post
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="result_kod_post" table="ur_hist_mat" />
            <dependant name="result_kod_post_x_n" table="ur_hist_mat" />
            <dependant name="kod_result_vld" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="kod_result" table="ur_hist_mat" type="number" title="Результат рассмотрения" is-user-editable="1" ColumnMandatory="1" Valid="qube.kod_result_vld" is-updateable="1" is-updateable-ext="1" update-target="kod_result" temp-col-name="n1">
          <sel-list-compiled>
            <root>
              <query name="us_result_list" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_result.xml" haskeys="1" noname="1" path="." used="1">
                <select>--us_result_list
select <column table="a" column="kod_result" as="kod_result" key="1" fixed="1" used="1" type="number" sourcetable="./a" sourcecolumn="kod_result" into="n1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="name" title="Результат рассмотрения" as="name" key="0" used="1" type="string" sourcetable="./a" sourcecolumn="name" into="s1">a.name as name/*Результат рассмотрения*//*string*/
</column></select>
                <from>
from <query name="us_result" as="a" path="./a" haskeys="1" used="1">(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./a" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="kod_post" type="number" as="kod_post" reference="us_post" refcol="kod_post" key="0" sourcetable="./a" sourcecolumn="kod_post" used="1">a.kod_post as kod_post, /*number*/
</column><column table="a" column="name" type="string" title="Результат рассмотрения" vid="1" as="name" key="0" sourcetable="./a" sourcecolumn="name" used="1">a.name as name/*Результат рассмотрения*//*string*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from>)
a
--\us_result
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="=" pth="" optional="1" type="bool">(<column table="a" column="kod_post">a.kod_post</column><text txtype="func"> = </text><const><text>:kod_post </text></const>) </call><text txtype="func"> } </text></call></where>--\us_result_list
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="us_result_list" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_result.xml" elid="2646" ord="2646" leaf="0" lvl="2" pelid="" haskeys="1">
              <queries>
                <query name="us_result_list" as="a">
                  <withparams>
                    <useparam name="kod_post" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="kod_post" type="number" column="result_kod_post">
                  <const>:kod_post </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-pars>
            <params>
              <param name="kod_post" type="number" column="result_kod_post" />
            </params>
          </sel-list-pars>
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.decision as decision, /*number*/
ur_hist_mat.result_kod_post as result_kod_post, /*number*/
result_kod_post_x_n.name as result_kod_post_x_n, /*Судебный акт*//*string*/
kod_result_x_n.name as kod_result_x_n, /*Результат рассмотрения*//*string*/
qube.kod_result_vld1 as kod_result_vld, /*string*/
ur_hist_mat.decision2 as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
ur_hist_mat.dat_entry_vld as dat_entry_vld, /*Дата вступления, валидация*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_result as kod_result, /*number*/
a.result_kod_post as result_kod_post, /*number*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld, /*Дата вступления, валидация*//*string*/
kod_result.decision as decision, /*number*/
 case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end  as decision2/*С судебным актом решение и признаком окончательного решения*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result,null as result_kod_post,a.dat_srok as dat_srok,a.dat_entry as dat_entry  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result,t.n37 as result_kod_post,t.d8 as dat_srok,t.d7 as dat_entry  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result,null as result_kod_post,a.dat_srok as dat_srok,a.dat_entry as dat_entry  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result,t.n37 as result_kod_post,t.d8 as dat_srok,t.d7 as dat_entry  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat on ur_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.name as name/*Результат рассмотрения*//*string*/

from us_result
a
--\us_result
)
kod_result_x_n on ur_hist_mat.kod_result = kod_result_x_n.kod_result--\us_result
left outer join
(
--us_post
select a.kod_post as kod_post, /*number*//*key*/
a.name as name/*Судебный акт*//*string*/

from us_post
a
--\us_post
)
result_kod_post_x_n on ur_hist_mat.result_kod_post = result_kod_post_x_n.kod_post--\us_post
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="decision" table="ur_hist_mat" />
            <dependant name="result_kod_post" table="ur_hist_mat" />
            <dependant name="result_kod_post_x_n" table="ur_hist_mat" />
            <dependant name="kod_result_x_n" table="ur_hist_mat" />
            <dependant name="kod_result_vld" table="ur_hist_mat" />
            <dependant name="kod_result_vld" table="ur_hist_mat" />
            <dependant name="decision2" table="ur_hist_mat" />
            <dependant name="dat_entry_vld" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="dat_srok" table="ur_hist_mat" type="date" title="Срок обжалования решения" Exists="decision" is-user-editable="1" Mandatory="decision2" is-updateable="1" is-updateable-ext="1" update-target="dat_srok" temp-col-name="d8">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.dat_entry_vld as dat_entry_vld, /*Дата вступления, валидация*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld/*Дата вступления, валидация*//*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="dat_entry_vld" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="dat_entry" table="ur_hist_mat" type="date" title="Дата вст. реш. в зак. силу" is-user-editable="1" Valid="dat_entry_vld" is-updateable="1" is-updateable-ext="1" update-target="dat_entry" temp-col-name="d7">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.dat_entry_vld as dat_entry_vld, /*Дата вступления, валидация*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld/*Дата вступления, валидация*//*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="dat_entry_vld" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="dat_send_il" table="ur_hist_mat" type="date" title="Дата направления ИЛ в филиал" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="dat_send_il" temp-col-name="d10" />
        <column name="prim" table="ur_hist_mat" type="string" title="Примечание" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="prim" temp-col-name="s1" />
        <column name="kod_scan" table="ur_hist_mat" type="number" title="Файл" ColumnEditable="1" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_scan" temp-col-name="n31">
          <sel-list-compiled>
            <root>
              <query title="Файл" spec-table="file" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\ur_scan_docs.xml" elid="3005" ord="3005" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a" noname="1" path="./a" used="1">
                <select>--a
select <column table="a" column="kod_scan" as="kod_scan" title="" key="1" used="1" type="number" sourcetable="./a/a" sourcecolumn="kod_scan" into="n1">a.kod_scan as kod_scan, /**//*number*//*key*/
</column><column table="a" column="file_name" as="file_name" title="" key="0" used="1" type="string" sourcetable="./a/a" sourcecolumn="file_name" into="s1">a.file_name as file_name/**//*string*/
</column></select>
                <from>
from <query name="ur_scan_docs" as="a" path="./a/a" haskeys="1" used="1">(
<select>--ur_scan_docs
select <column table="a" column="kod_scan" type="number" comment="уникальный ключ" as="kod_scan" key="1" fixed="1" sourcetable="./a/a" sourcecolumn="kod_scan" used="1">a.kod_scan as kod_scan, /*number*//*key*/
</column><column table="a" column="file_name" type="string" title="" comment="имя файла" vid="1" spec-column="file-name" as="file_name" key="0" sourcetable="./a/a" sourcecolumn="file_name" used="1">a.file_name as file_name/**//*string*/
</column></select><from>
from <table name="ur_scan_docs" as="a" title="Файл" used="1">ur_scan_docs
a
--\ur_scan_docs
</table></from>)
a
--\ur_scan_docs
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<call function="rownum" pth="0" type="number"><text txtype="func"> rownum </text></call><text txtype="func"> &lt;= </text><const><text>:p_rows_limit </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="a" column="kod_scan" as="kod_scan" title="" key="1" thissrc="kod_scan">a.kod_scan</column><text txtype="func"> in </text><const><text>:pk_prm </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="kod_scan" as="kod_scan" title="" key="1" thissrc="kod_scan">a.kod_scan</column><text txtype="func"> ) like lower( </text><const><text>:kod_scan_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="file_name" as="file_name" title="" thissrc="file_name">a.file_name</column><text txtype="func"> ) like lower( </text><const><text>:file_name_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text></call></where>--\a
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="a" title="Файл" spec-table="file" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\ur_scan_docs.xml" elid="3005" ord="3005" leaf="0" lvl="2" pelid="" haskeys="1" as="a">
              <queries>
                <query title="Файл" spec-table="file" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\ur_scan_docs.xml" elid="3005" ord="3005" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a">
                  <params>
                    <param name="pk_prm" type="array" />
                    <param name="kod_scan_filter" type="string" />
                    <param name="file_name_filter" type="string" />
                    <param name="p_rows_limit" type="number" />
                  </params>
                  <select>
                    <column table="a" column="kod_scan" as="kod_scan" title="" key="1" />
                    <column table="a" column="file_name" as="file_name" title="" />
                  </select>
                  <from>
                    <query name="ur_scan_docs" as="a" title="Файл" />
                  </from>
                  <where>
                    <call function="and">
                      <call function="le">
                        <call function="rownum" />
                        <useparam name="p_rows_limit" />
                      </call>
                      <call function="in" optional="1">
                        <column table="this" column="kod_scan" />
                        <useparam name="pk_prm" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_scan" />
                        <useparam name="kod_scan_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="file_name" />
                        <useparam name="file_name_filter" />
                      </call>
                    </call>
                  </where>
                  <withparams>
                    <useparam name="pk_prm" />
                    <useparam name="kod_scan_filter" />
                    <useparam name="file_name_filter" />
                    <useparam name="p_rows_limit" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="pk_prm" type="array">
                  <const>:pk_prm </const>
                </param>
                <param name="kod_scan_filter" type="string">
                  <const>:kod_scan_filter </const>
                </param>
                <param name="file_name_filter" type="string">
                  <const>:file_name_filter </const>
                </param>
                <param name="p_rows_limit" type="number">
                  <const>:p_rows_limit </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-pars>
            <params />
          </sel-list-pars>
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_scan_x_n.file_name as kod_scan_x_n, /*Файл*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_scan as kod_scan/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_scan as kod_scan  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n31 as kod_scan  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_scan as kod_scan  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n31 as kod_scan  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_scan_docs
select a.kod_scan as kod_scan, /*number*//*key*/
a.file_name as file_name/**//*string*/

from ur_scan_docs
a
--\ur_scan_docs
)
kod_scan_x_n on ur_hist_mat.kod_scan = kod_scan_x_n.kod_scan--\ur_scan_docs
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="kod_scan_x_n" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="peni" table="ur_hist_mat" type="number" title="Проценты (пени)" parname="peni_hand" VisibleInvert="1" ClientVisible="kod_sf_peni" is-user-editable="1" ClientNewVal="priz_peni" is-updateable="1" is-updateable-ext="1" update-target="peni" temp-col-name="n23" />
        <column name="Штраф" table="ur_hist_mat" type="number" title="Штраф" parname="shtraf" VisibleInvert="1" ClientVisible="kod_sf_shtraf" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="shtraf" temp-col-name="n22" />
        <column name="gp_otv" table="ur_hist_mat" type="number" title="Ответчика" parname="gp_otv" Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="gp_otv" temp-col-name="n6">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.gp_all as gp_all, /*Всего по решению*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1/*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="gp_all" table="ur_hist_mat" />
            <dependant name="ur_hist_mat_gp_vld" table="ur_mat" />
          </dependants>
        </column>
        <column name="gp_all" table="ur_hist_mat" type="number" title="Всего по решению" ClientExists="decision" is-user-editable="1" ClientValid="gp_vld" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.gp_all as gp_all, /*Всего по решению*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="gp_es" table="ur_hist_mat" type="number" title="Истца" Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="gp_es" temp-col-name="n4">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.gp_all as gp_all, /*Всего по решению*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1/*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="gp_all" table="ur_hist_mat" />
            <dependant name="ur_hist_mat_gp_vld" table="ur_mat" />
          </dependants>
        </column>
        <column name="gp_ret" table="ur_hist_mat" type="number" title="Возврат из бюджета" Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="gp_ret" temp-col-name="n25">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.gp_all as gp_all, /*Всего по решению*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1/*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="gp_all" table="ur_hist_mat" />
            <dependant name="ur_hist_mat_gp_vld" table="ur_mat" />
          </dependants>
        </column>
        <column name="sud_izd" table="ur_hist_mat" type="number" title=" " Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="sud_izd" temp-col-name="n10" />
        <column name="ogr" table="ur_hist_mat" type="number" title=" " is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="ogr" temp-col-name="n19" />
        <column name="opl_sud_izd" table="ur_hist_mat" type="number" title=" " Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="opl_sud_izd" temp-col-name="n30" />
        <column name="opl_ogr" table="ur_hist_mat" type="number" title=" " is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="opl_ogr" temp-col-name="n26" />
        <column name="proc_calc" table="ur_hist_mat" type="number" title="Рассчитывать астрент" Exists="decision" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="proc_calc" temp-col-name="n27">
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.is_post_astr_proc_and_calc as is_post_astr_proc_and_calc, /*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc/*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="is_post_astr_proc_and_calc" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="kod_vid_proc" table="ur_hist_mat" type="number" title="Вид процентной ставки" Exists="proc_calc" is-user-editable="1" Mandatory="proc_calc" is-updateable="1" is-updateable-ext="1" update-target="kod_vid_proc" temp-col-name="n28">
          <sel-list-compiled>
            <root>
              <query class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\sk_vid_proc.xml" elid="2893" ord="2893" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a" noname="1" path="./a" used="1">
                <select>--a
select <column table="a" column="kod_vid_proc" as="kod_vid_proc" title="" key="1" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_vid_proc" into="n1">a.kod_vid_proc as kod_vid_proc, /**//*number*//*key*/
</column><column table="a" column="name" as="name" title="Наименование" key="0" used="1" type="string" sourcetable="./a/a/a" sourcecolumn="name" into="s1">a.name as name/*Наименование*//*string*/
</column></select>
                <from>
from <query name="sk_vid_proc_list_ur_mat" as="a" path="./a/a" haskeys="1" used="1">(
<select>--sk_vid_proc_list_ur_mat
select <column table="a" column="kod_vid_proc" type="number" as="kod_vid_proc" key="1" fixed="1" used="1" sourcetable="./a/a/a" sourcecolumn="kod_vid_proc">a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Наименование" as="name" key="0" used="1" sourcetable="./a/a/a" sourcecolumn="name">a.name as name/*Наименование*//*string*/
</column></select><from>
from <query name="sk_vid_proc" as="a" path="./a/a/a" haskeys="1" used="1">(
<select>--sk_vid_proc
select <column table="a" column="kod_vid_proc" type="number" as="kod_vid_proc" key="1" fixed="1" used="1" sourcetable="./a/a/a" sourcecolumn="kod_vid_proc">a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Наименование" as="name" key="0" used="1" sourcetable="./a/a/a" sourcecolumn="name">a.name as name, /*Наименование*//*string*/
</column><column table="a" column="hist_mat_use" type="number" title="" comment="1 - доступна для выбора в арбитраже" as="hist_mat_use" key="0" used="1" sourcetable="./a/a/a" sourcecolumn="hist_mat_use">a.hist_mat_use as hist_mat_use/**//*number*/
</column></select><from>
from <table name="sk_vid_proc" as="a" title="Вид процентной ставки" used="1">sk_vid_proc
a
--\sk_vid_proc
</table></from>)
a
--\sk_vid_proc
</query></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="hist_mat_use">a.hist_mat_use</column><text txtype="func"> = </text><const><text>1</text></const></call></where>)
a
--\sk_vid_proc_list_ur_mat
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<call function="rownum" pth="0" type="number"><text txtype="func"> rownum </text></call><text txtype="func"> &lt;= </text><const><text>:p_rows_limit </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="a" column="kod_vid_proc" as="kod_vid_proc" title="" key="1" thissrc="kod_vid_proc">a.kod_vid_proc</column><text txtype="func"> in </text><const><text>:pk_prm </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="kod_vid_proc" as="kod_vid_proc" title="" key="1" thissrc="kod_vid_proc">a.kod_vid_proc</column><text txtype="func"> ) like lower( </text><const><text>:kod_vid_proc_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="a" column="name" as="name" title="Наименование" thissrc="name">a.name</column><text txtype="func"> ) like lower( </text><const><text>:name_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text></call></where>--\a
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="a" class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\sk_vid_proc.xml" elid="2893" ord="2893" leaf="0" lvl="2" pelid="" haskeys="1" as="a">
              <queries>
                <query class="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\original\sk_vid_proc.xml" elid="2893" ord="2893" leaf="0" lvl="2" pelid="" haskeys="1" name="a" as="a">
                  <params>
                    <param name="pk_prm" type="array" />
                    <param name="kod_vid_proc_filter" type="string" />
                    <param name="name_filter" type="string" />
                    <param name="p_rows_limit" type="number" />
                  </params>
                  <select>
                    <column table="a" column="kod_vid_proc" as="kod_vid_proc" title="" key="1" />
                    <column table="a" column="name" as="name" title="Наименование" />
                  </select>
                  <from>
                    <query name="sk_vid_proc_list_ur_mat" as="a" />
                  </from>
                  <where>
                    <call function="and">
                      <call function="le">
                        <call function="rownum" />
                        <useparam name="p_rows_limit" />
                      </call>
                      <call function="in" optional="1">
                        <column table="this" column="kod_vid_proc" />
                        <useparam name="pk_prm" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_vid_proc" />
                        <useparam name="kod_vid_proc_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="name" />
                        <useparam name="name_filter" />
                      </call>
                    </call>
                  </where>
                  <withparams>
                    <useparam name="pk_prm" />
                    <useparam name="kod_vid_proc_filter" />
                    <useparam name="name_filter" />
                    <useparam name="p_rows_limit" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="pk_prm" type="array">
                  <const>:pk_prm </const>
                </param>
                <param name="kod_vid_proc_filter" type="string">
                  <const>:kod_vid_proc_filter </const>
                </param>
                <param name="name_filter" type="string">
                  <const>:name_filter </const>
                </param>
                <param name="p_rows_limit" type="number">
                  <const>:p_rows_limit </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-pars>
            <params />
          </sel-list-pars>
          <dep-refresh-cmd>
            <root table="ur_hist_mat">
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_vid_proc_x_n.name as kod_vid_proc_x_n, /*Вид процентной ставки*//*string*/
ur_hist_mat.is_post_astr_proc_and_calc as is_post_astr_proc_and_calc, /*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_vid_proc as kod_vid_proc, /*number*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc/*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--sk_vid_proc
select a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
a.name as name/*Наименование*//*string*/

from sk_vid_proc
a
--\sk_vid_proc
)
kod_vid_proc_x_n on ur_hist_mat.kod_vid_proc = kod_vid_proc_x_n.kod_vid_proc--\sk_vid_proc
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="kod_vid_proc_x_n" table="ur_hist_mat" />
            <dependant name="is_post_astr_proc_and_calc" table="ur_hist_mat" />
          </dependants>
        </column>
        <column name="proc_const" table="ur_hist_mat" type="number" title="%" Exists="is_post_astr_proc_and_calc" is-user-editable="1" Default="proc_const_new_val" Mandatory="is_post_astr_proc_and_calc" is-updateable="1" is-updateable-ext="1" update-target="proc_const" temp-col-name="n29" />
        <column name="kod_mat_x_n" table="ur_hist_mat.kod_mat" type="string" title="Материалы переданные в суд" text-source-for="kod_mat" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_mat_x_n.name as kod_mat_x_n, /*Материалы переданные в суд*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
kod_doc.abbr || '  ' || a.num_delo || ' от ' || ( to_char( a.dat_doc ,'DD.MM.YYYY') )  as name/*Иск*//*string*/

from ur_mat
a
--\ur_mat
left outer join
(
--us_doc
select a.kod_doc as kod_doc, /*number*//*key*/
a.abbr as abbr/*Аббревиатура*//*string*/

from us_doc
a
--\us_doc
)
kod_doc on a.kod_doc = kod_doc.kod_doc--\us_doc
)
kod_mat_x_n on ur_hist_mat.kod_mat = kod_mat_x_n.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kodp_x_n" table="kod_folders.kodp" type="string" title="Абонент" text-source-for="kodp" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kodp_x_n.sp_col_name as kodp_x_n, /*Абонент*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump || ' ' || a.name as sp_col_name/**//*string*/

from kr_payer
a
--\kr_payer
)
kodp_x_n on kod_folders.kodp = kodp_x_n.kodp--\kr_payer
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_zased_x_n" table="ur_hist_mat.kod_zased" type="string" title="Судья" text-source-for="kod_zased" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_zased_x_n.fio as kod_zased_x_n, /*Судья*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_zased as kod_zased/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.fio as fio/*Судья*//*string*/

from us_zased
a
--\us_zased
)
kod_zased_x_n on ur_hist_mat.kod_zased = kod_zased_x_n.kod_zased--\us_zased
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_sud_x_n" table="kod_zased.kod_sud" type="string" title="Участок" text-source-for="kod_sud" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_sud_x_n.name as kod_sud_x_n, /*Участок*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_zased as kod_zased/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_zased as kod_zased  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n5 as kod_zased  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.kod_sud as kod_sud/*number*/

from us_zased
a
--\us_zased
)
kod_zased on ur_hist_mat.kod_zased = kod_zased.kod_zased--\us_zased
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on kod_zased.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_sdp_x_n" table="kod_folders.kod_sdp" type="string" title="Договор" text-source-for="kod_sdp" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_sdp_x_n.name as kod_sdp_x_n, /*Юридический документ*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ur_hist_mat.kod_mat = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--uk_sdp
select a.kod_sdp as kod_sdp, /*number*//*key*/
a.name as name/*Юридический документ*//*string*/

from uk_sdp
a
--\uk_sdp
)
kod_sdp_x_n on kod_folders.kod_sdp = kod_sdp_x_n.kod_sdp--\uk_sdp
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="result_kod_post_x_n" table="ur_hist_mat.result_kod_post" type="string" title="Судебный акт" text-source-for="result_kod_post" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select result_kod_post_x_n.name as result_kod_post_x_n, /*Судебный акт*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_post
select a.kod_post as kod_post, /*number*//*key*/
a.name as name/*Судебный акт*//*string*/

from us_post
a
--\us_post
)
result_kod_post_x_n on ur_hist_mat.result_kod_post = result_kod_post_x_n.kod_post--\us_post
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_result_x_n" table="ur_hist_mat.kod_result" type="string" title="Результат рассмотрения" text-source-for="kod_result" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_result_x_n.name as kod_result_x_n, /*Результат рассмотрения*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_result as kod_result/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.name as name/*Результат рассмотрения*//*string*/

from us_result
a
--\us_result
)
kod_result_x_n on ur_hist_mat.kod_result = kod_result_x_n.kod_result--\us_result
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_scan_x_n" table="ur_hist_mat.kod_scan" type="string" title="Файл" text-source-for="kod_scan" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_scan_x_n.file_name as kod_scan_x_n, /*Файл*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_scan as kod_scan/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_scan as kod_scan  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n31 as kod_scan  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_scan as kod_scan  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n31 as kod_scan  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--ur_scan_docs
select a.kod_scan as kod_scan, /*number*//*key*/
a.file_name as file_name/**//*string*/

from ur_scan_docs
a
--\ur_scan_docs
)
kod_scan_x_n on ur_hist_mat.kod_scan = kod_scan_x_n.kod_scan--\ur_scan_docs
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_vid_proc_x_n" table="ur_hist_mat.kod_vid_proc" type="string" title="Вид процентной ставки" text-source-for="kod_vid_proc" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_vid_proc_x_n.name as kod_vid_proc_x_n, /*Вид процентной ставки*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_vid_proc as kod_vid_proc/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
left outer join
(
--sk_vid_proc
select a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
a.name as name/*Наименование*//*string*/

from sk_vid_proc
a
--\sk_vid_proc
)
kod_vid_proc_x_n on ur_hist_mat.kod_vid_proc = kod_vid_proc_x_n.kod_vid_proc--\sk_vid_proc
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_result_vld" table="ur_hist_mat" type="string" title="" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.kod_result_vld1 as kod_result_vld, /*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="decision2" table="ur_hist_mat" type="number" title="С судебным актом решение и признаком окончательного решения" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.decision2 as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end  as decision2/*С судебным актом решение и признаком окончательного решения*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="dat_entry_vld" table="ur_hist_mat" type="string" title="Дата вступления, валидация" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.dat_entry_vld as dat_entry_vld, /*Дата вступления, валидация*//*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld/*Дата вступления, валидация*//*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.dat_srok as dat_srok,a.dat_entry as dat_entry,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d8 as dat_srok,t.d7 as dat_entry,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_post_astr_proc_and_calc" table="ur_hist_mat" type="string" title="Рассчитывать астрент" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.is_post_astr_proc_and_calc as is_post_astr_proc_and_calc, /*string*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc/*string*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_vid_proc as kod_vid_proc,a.proc_calc as proc_calc  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n28 as kod_vid_proc,t.n27 as proc_calc  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="proc_const_new_val" table="ur_hist_mat" type="number" title="Дата прин. суд. акта" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_hist_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_hist_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select ur_hist_mat.proc_const_new_val as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val/*Дата прин. суд. акта*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.dat_post as dat_post,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d1 as dat_post,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.dat_post as dat_post,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.d1 as dat_post,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
)
ur_hist_mat
--\ur_hist_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_new" table="ur_hist_mat" type="number" title="" is-user-editable="1" />
        <column name="is_not_new" table="ur_hist_mat" type="number" title="" is-user-editable="1" />
        <column name="kod_hist_mat" table="ur_hist_mat" type="number" title="" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_hist_mat" temp-col-name="n2" />
      </columns>
      <insert-text>begin 
for r in  
 ( select  
:kod_mat as kod_mat 
,:kod_zased as kod_zased 
,:dat_rassm as dat_rassm 
,:dat_post as dat_post 
,:kod_result as kod_result 
,:dat_srok as dat_srok 
,:dat_entry as dat_entry 
,:dat_send_il as dat_send_il 
,:prim as prim 
,:kod_scan as kod_scan 
,:peni as peni 
,:Штраф as Штраф 
,:gp_otv as gp_otv 
,:gp_es as gp_es 
,:gp_ret as gp_ret 
,:sud_izd as sud_izd 
,:ogr as ogr 
,:opl_sud_izd as opl_sud_izd 
,:opl_ogr as opl_ogr 
,:proc_calc as proc_calc 
,:kod_vid_proc as kod_vid_proc 
,:proc_const as proc_const 
,:kod_hist_mat as kod_hist_mat 
 
from dual ) 
 
loop 
insert into ur_hist_mat 
(kod_mat 
,kod_zased 
,dat_rassm 
,dat_post 
,kod_result 
,dat_srok 
,dat_entry 
,dat_send_il 
,prim 
,kod_scan 
,peni 
,shtraf 
,gp_otv 
,gp_es 
,gp_ret 
,sud_izd 
,ogr 
,opl_sud_izd 
,opl_ogr 
,proc_calc 
,kod_vid_proc 
,proc_const 
,kod_hist_mat 
) 
 values  
(r.kod_mat 
,r.kod_zased 
,r.dat_rassm 
,r.dat_post 
,r.kod_result 
,r.dat_srok 
,r.dat_entry 
,r.dat_send_il 
,r.prim 
,r.kod_scan 
,r.peni 
,r.Штраф 
,r.gp_otv 
,r.gp_es 
,r.gp_ret 
,r.sud_izd 
,r.ogr 
,r.opl_sud_izd 
,r.opl_ogr 
,r.proc_calc 
,r.kod_vid_proc 
,r.proc_const 
,r.kod_hist_mat 
) 
 returning  
kod_hist_mat into :kod_hist_mat; 
end loop; 
end; 
</insert-text>
      <delete-text>delete from ur_hist_mat where kod_hist_mat=:kod_hist_mat</delete-text>
      <update-temp-text>begin 
delete from rr_temp 
where 
skod='ur_hist_mat' 
and 
names=:form_id 
and 
f2=:kod_hist_mat; 
if :row_state_id=1  then 
for r in  
 ( select  
:kod_mat as kod_mat 
,:kod_zased as kod_zased 
,:dat_rassm as dat_rassm 
,:dat_post as dat_post 
,:result_kod_post as result_kod_post 
,:kod_result as kod_result 
,:dat_srok as dat_srok 
,:dat_entry as dat_entry 
,:dat_send_il as dat_send_il 
,:prim as prim 
,:kod_scan as kod_scan 
,:peni as peni 
,:Штраф as Штраф 
,:gp_otv as gp_otv 
,:gp_es as gp_es 
,:gp_ret as gp_ret 
,:sud_izd as sud_izd 
,:ogr as ogr 
,:opl_sud_izd as opl_sud_izd 
,:opl_ogr as opl_ogr 
,:proc_calc as proc_calc 
,:kod_vid_proc as kod_vid_proc 
,:proc_const as proc_const 
,:kod_hist_mat as kod_hist_mat 
 
from dual ) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n3 
,n5 
,d2 
,d1 
,n37 
,n1 
,d8 
,d7 
,d10 
,s1 
,n31 
,n23 
,n22 
,n6 
,n4 
,n25 
,n10 
,n19 
,n30 
,n26 
,n27 
,n28 
,n29 
,n2 
) 
 values  
('ur_hist_mat' 
,:form_id 
,:kod_hist_mat 
,:row_state_id 
,r.kod_mat 
,r.kod_zased 
,r.dat_rassm 
,r.dat_post 
,r.result_kod_post 
,r.kod_result 
,r.dat_srok 
,r.dat_entry 
,r.dat_send_il 
,r.prim 
,r.kod_scan 
,r.peni 
,r.Штраф 
,r.gp_otv 
,r.gp_es 
,r.gp_ret 
,r.sud_izd 
,r.ogr 
,r.opl_sud_izd 
,r.opl_ogr 
,r.proc_calc 
,r.kod_vid_proc 
,r.proc_const 
,r.kod_hist_mat 
); 
end loop; 
else 
for r in  
 ( select  
:kod_mat as kod_mat 
,:kod_zased as kod_zased 
,:dat_rassm as dat_rassm 
,:dat_post as dat_post 
,:result_kod_post as result_kod_post 
,:kod_result as kod_result 
,:dat_srok as dat_srok 
,:dat_entry as dat_entry 
,:dat_send_il as dat_send_il 
,:prim as prim 
,:kod_scan as kod_scan 
,:peni as peni 
,:Штраф as Штраф 
,:gp_otv as gp_otv 
,:gp_es as gp_es 
,:gp_ret as gp_ret 
,:sud_izd as sud_izd 
,:ogr as ogr 
,:opl_sud_izd as opl_sud_izd 
,:opl_ogr as opl_ogr 
,:proc_calc as proc_calc 
,:kod_vid_proc as kod_vid_proc 
,:proc_const as proc_const 
,:kod_hist_mat as kod_hist_mat 
,a.u_m 
,a.d_m 
,a.ukaz 
,a.kod_stage 
,a.kod_busin 
,a.dat_mor 
,a.kod_hist_mat_new 
,a.astrent 
,a.dat_vz 
,a.proc 
,a.kodp 
,a.opl_peni 
,a.opl_proc 
,a.opl_astrent 
,a.opl_osnreal 
,a.opl_gpotv 
,a.data_prinyat 
,a.snum_z 
,a.fio_court 
,a.osnreal 
,a.manual_sums 
,a.dat_mor_out 
,a.opl_ogr_dat 
,a.opl_sud_izd_dat 
,a.dat_send_zv 
,a.dat_receipt_post 
,a.dat_send_petition_il 
,a.gosposhlina 
,a.dat_um_mor_dolg 
,a.sum_um_mor_dolg 
,a.kod_osn_um_mor_dolg 
,a.comment_um_mor_dolg 
,a.period_zadol_s_vvod 
,a.period_zadol_po_vvod 
 
from ur_hist_mat a  where kod_hist_mat=:kod_hist_mat) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n3 
,n5 
,d2 
,d1 
,n37 
,n1 
,d8 
,d7 
,d10 
,s1 
,n31 
,n23 
,n22 
,n6 
,n4 
,n25 
,n10 
,n19 
,n30 
,n26 
,n27 
,n28 
,n29 
,n2 
,s2 
,d3 
,s3 
,n7 
,n8 
,d4 
,n9 
,n11 
,d5 
,n12 
,n13 
,n14 
,n15 
,n16 
,n17 
,n18 
,d6 
,s4 
,s5 
,n21 
,n24 
,d9 
,d11 
,d12 
,d13 
,d14 
,d15 
,n32 
,d16 
,n33 
,n34 
,s6 
,n35 
,n36 
) 
 values  
('ur_hist_mat' 
,:form_id 
,:kod_hist_mat 
,:row_state_id 
,r.kod_mat 
,r.kod_zased 
,r.dat_rassm 
,r.dat_post 
,r.result_kod_post 
,r.kod_result 
,r.dat_srok 
,r.dat_entry 
,r.dat_send_il 
,r.prim 
,r.kod_scan 
,r.peni 
,r.Штраф 
,r.gp_otv 
,r.gp_es 
,r.gp_ret 
,r.sud_izd 
,r.ogr 
,r.opl_sud_izd 
,r.opl_ogr 
,r.proc_calc 
,r.kod_vid_proc 
,r.proc_const 
,r.kod_hist_mat 
,r.u_m 
,r.d_m 
,r.ukaz 
,r.kod_stage 
,r.kod_busin 
,r.dat_mor 
,r.kod_hist_mat_new 
,r.astrent 
,r.dat_vz 
,r.proc 
,r.kodp 
,r.opl_peni 
,r.opl_proc 
,r.opl_astrent 
,r.opl_osnreal 
,r.opl_gpotv 
,r.data_prinyat 
,r.snum_z 
,r.fio_court 
,r.osnreal 
,r.manual_sums 
,r.dat_mor_out 
,r.opl_ogr_dat 
,r.opl_sud_izd_dat 
,r.dat_send_zv 
,r.dat_receipt_post 
,r.dat_send_petition_il 
,r.gosposhlina 
,r.dat_um_mor_dolg 
,r.sum_um_mor_dolg 
,r.kod_osn_um_mor_dolg 
,r.comment_um_mor_dolg 
,r.period_zadol_s_vvod 
,r.period_zadol_po_vvod 
); 
end loop; 
end if; 
end; 
</update-temp-text>
      <clear-temp-text>delete from rr_temp where skod='ur_hist_mat' and names=:form_id</clear-temp-text>
      <update-text>begin
update ur_hist_mat set  
(kod_mat 
,kod_zased 
,dat_rassm 
,dat_post 
,kod_result 
,dat_srok 
,dat_entry 
,dat_send_il 
,prim 
,kod_scan 
,peni 
,shtraf 
,gp_otv 
,gp_es 
,gp_ret 
,sud_izd 
,ogr 
,opl_sud_izd 
,opl_ogr 
,proc_calc 
,kod_vid_proc 
,proc_const 
,kod_hist_mat 
) 
= 
 ( select  
:kod_mat as kod_mat 
,:kod_zased as kod_zased 
,:dat_rassm as dat_rassm 
,:dat_post as dat_post 
,:kod_result as kod_result 
,:dat_srok as dat_srok 
,:dat_entry as dat_entry 
,:dat_send_il as dat_send_il 
,:prim as prim 
,:kod_scan as kod_scan 
,:peni as peni 
,:Штраф as Штраф 
,:gp_otv as gp_otv 
,:gp_es as gp_es 
,:gp_ret as gp_ret 
,:sud_izd as sud_izd 
,:ogr as ogr 
,:opl_sud_izd as opl_sud_izd 
,:opl_ogr as opl_ogr 
,:proc_calc as proc_calc 
,:kod_vid_proc as kod_vid_proc 
,:proc_const as proc_const 
,:kod_hist_mat as kod_hist_mat 
 
from dual ) 
 
where 
kod_hist_mat=:kod_hist_mat 
;
end;
</update-text>
      <scheme>
        <table name="ur_hist_mat" as="ur_hist_mat">
          <columns>
            <column name="route_visible" type="number" title="" visible="0" />
            <column name="kod_mat" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="decision" type="number" title="" visible="0" />
            <column name="not_vvod" type="number" title="" visible="0" />
            <column name="kodp" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="nump" type="string" title="Код абонента" visible="0" />
            <column name="kod_zased" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="phone" type="string" title="Телефон" />
            <column name="kod_sud" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_sdp" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="dat_rassm" type="date" title="Дата суд. разб." />
            <column name="dat_post" type="date" title="Дата прин. суд. акта" />
            <column name="result_kod_post" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_result" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="dat_srok" type="date" title="Срок обжалования решения" />
            <column name="dat_entry" type="date" title="Дата вст. реш. в зак. силу" />
            <column name="dat_send_il" type="date" title="Дата направления ИЛ в филиал" />
            <column name="prim" type="string" title="Примечание" />
            <column name="kod_scan" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="peni" type="number" title="Проценты (пени)" />
            <column name="Штраф" type="number" title="Штраф" />
            <column name="gp_otv" type="number" title="Ответчика" />
            <column name="gp_all" type="number" title="Всего по решению" />
            <column name="gp_es" type="number" title="Истца" />
            <column name="gp_ret" type="number" title="Возврат из бюджета" />
            <column name="sud_izd" type="number" title=" " />
            <column name="ogr" type="number" title=" " />
            <column name="opl_sud_izd" type="number" title=" " />
            <column name="opl_ogr" type="number" title=" " />
            <column name="proc_calc" type="number" title="Рассчитывать астрент" />
            <column name="kod_vid_proc" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="proc_const" type="number" title="%" />
            <column name="kod_mat_x_n" type="string" title="Материалы переданные в суд" visible="0" />
            <column name="kodp_x_n" type="string" title="Абонент" visible="0" />
            <column name="kod_zased_x_n" type="string" title="Судья" />
            <column name="kod_sud_x_n" type="string" title="Участок" />
            <column name="kod_sdp_x_n" type="string" title="Договор" visible="0" />
            <column name="result_kod_post_x_n" type="string" title="Судебный акт" />
            <column name="kod_result_x_n" type="string" title="Результат рассмотрения" />
            <column name="kod_scan_x_n" type="string" title="Файл" />
            <column name="kod_vid_proc_x_n" type="string" title="Вид процентной ставки" />
            <column name="kod_result_vld" type="string" invisible-in-column-chooser="1" visible="0" />
            <column name="decision2" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="dat_entry_vld" type="string" invisible-in-column-chooser="1" visible="0" />
            <column name="is_post_astr_proc_and_calc" type="string" invisible-in-column-chooser="1" visible="0" />
            <column name="proc_const_new_val" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_not_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_hist_mat" type="number" invisible-in-column-chooser="1" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
      <single-row-refresh-cmd>
        <root>
          <params>
            <param name="kod_hist_mat_prm" type="number" column="" />
            <param name="form_id" type="number" column="" />
          </params>
          <select>
            <params>
              <param name="kod_hist_mat_prm" type="number" column="" />
              <param name="form_id" type="number" column="" />
            </params>
            <query>
--
select  case  when (( (select nvl(max(kod_rights),0) from rr_usermenu where PUSER = USER and kod_menu = 189006 ) )  = 2)  then 1 else 0 end  as route_visible, /*number*/
 coalesce( ur_hist_mat.kod_mat , ur_hist_mat_mpv_1.kod_mat )  as kod_mat, /*number*/
 coalesce( ur_hist_mat.decision , ur_hist_mat_mpv_1.decision )  as decision, /*number*/
kod_folders.not_vvod as not_vvod, /*number*/
kod_folders.kodp as kodp, /*number*/
kodp.nump as nump, /*Код абонента*//*string*/
 coalesce( ur_hist_mat.kod_zased , ur_hist_mat_mpv_1.kod_zased )  as kod_zased, /*number*/
kod_zased.phone as phone, /*Телефон*//*string*/
kod_zased.kod_sud as kod_sud, /*Участок*//*number*/
kod_folders.kod_sdp as kod_sdp, /*number*/
 coalesce( ur_hist_mat.dat_rassm , ur_hist_mat_mpv_1.dat_rassm )  as dat_rassm, /*Дата суд. разб.*//*date*/
 coalesce( ur_hist_mat.dat_post , ur_hist_mat_mpv_1.dat_post )  as dat_post, /*Дата прин. суд. акта*//*date*/
 coalesce( ur_hist_mat.result_kod_post , ur_hist_mat_mpv_1.result_kod_post )  as result_kod_post, /*number*/
 coalesce( ur_hist_mat.kod_result , ur_hist_mat_mpv_1.kod_result )  as kod_result, /*number*/
 coalesce( ur_hist_mat.dat_srok , ur_hist_mat_mpv_1.dat_srok )  as dat_srok, /*Срок обжалования решения*//*date*/
 coalesce( ur_hist_mat.dat_entry , ur_hist_mat_mpv_1.dat_entry )  as dat_entry, /*Дата вст. реш. в зак. силу*//*date*/
 coalesce( ur_hist_mat.dat_send_il , ur_hist_mat_mpv_1.dat_send_il )  as dat_send_il, /*Дата направления ИЛ в филиал*//*date*/
 coalesce( ur_hist_mat.prim , ur_hist_mat_mpv_1.prim )  as prim, /*Примечание*//*string*/
 coalesce( ur_hist_mat.kod_scan , ur_hist_mat_mpv_1.kod_scan )  as kod_scan, /*number*/
 coalesce( ur_hist_mat.peni , ur_hist_mat_mpv_1.peni )  as peni, /*Проценты (пени)*//*number*/
 coalesce( ur_hist_mat.shtraf , ur_hist_mat_mpv_1.shtraf )  as Штраф, /*Штраф*//*number*/
 coalesce( ur_hist_mat.gp_otv , ur_hist_mat_mpv_1.gp_otv )  as gp_otv, /*Ответчика*//*number*/
 coalesce( ur_hist_mat.gp_all , ur_hist_mat_mpv_1.gp_all )  as gp_all, /*Всего по решению*//*number*/
 coalesce( ur_hist_mat.gp_es , ur_hist_mat_mpv_1.gp_es )  as gp_es, /*Истца*//*number*/
 coalesce( ur_hist_mat.gp_ret , ur_hist_mat_mpv_1.gp_ret )  as gp_ret, /*Возврат из бюджета*//*number*/
 coalesce( ur_hist_mat.sud_izd , ur_hist_mat_mpv_1.sud_izd )  as sud_izd, /* *//*number*/
 coalesce( ur_hist_mat.ogr , ur_hist_mat_mpv_1.ogr )  as ogr, /* *//*number*/
 coalesce( ur_hist_mat.opl_sud_izd , ur_hist_mat_mpv_1.opl_sud_izd )  as opl_sud_izd, /* *//*number*/
 coalesce( ur_hist_mat.opl_ogr , ur_hist_mat_mpv_1.opl_ogr )  as opl_ogr, /* *//*number*/
 coalesce( ur_hist_mat.proc_calc , ur_hist_mat_mpv_1.proc_calc )  as proc_calc, /*Рассчитывать астрент*//*number*/
 coalesce( ur_hist_mat.kod_vid_proc , ur_hist_mat_mpv_1.kod_vid_proc )  as kod_vid_proc, /*number*/
 coalesce( ur_hist_mat.proc_const , ur_hist_mat_mpv_1.proc_const )  as proc_const, /*%*//*number*/
kod_mat_x_n.name as kod_mat_x_n, /*Материалы переданные в суд*//*string*/
kodp_x_n.sp_col_name as kodp_x_n, /*Абонент*//*string*/
kod_zased_x_n.fio as kod_zased_x_n, /*Судья*//*string*/
kod_sud_x_n.name as kod_sud_x_n, /*Участок*//*string*/
kod_sdp_x_n.name as kod_sdp_x_n, /*Юридический документ*//*string*/
result_kod_post_x_n.name as result_kod_post_x_n, /*Судебный акт*//*string*/
kod_result_x_n.name as kod_result_x_n, /*Результат рассмотрения*//*string*/
kod_scan_x_n.file_name as kod_scan_x_n, /*Файл*//*string*/
kod_vid_proc_x_n.name as kod_vid_proc_x_n, /*Вид процентной ставки*//*string*/
qube.kod_result_vld1 as kod_result_vld, /*string*/
 coalesce( ur_hist_mat.decision2 , ur_hist_mat_mpv_1.decision2 )  as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
 coalesce( ur_hist_mat.dat_entry_vld , ur_hist_mat_mpv_1.dat_entry_vld )  as dat_entry_vld, /*Дата вступления, валидация*//*string*/
 coalesce( ur_hist_mat.is_post_astr_proc_and_calc , ur_hist_mat_mpv_1.is_post_astr_proc_and_calc )  as is_post_astr_proc_and_calc, /*string*/
 coalesce( ur_hist_mat.proc_const_new_val , ur_hist_mat_mpv_1.proc_const_new_val )  as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
 coalesce( ur_hist_mat.is_new , ur_hist_mat_mpv_1.is_new )  as is_new, /*number*/
 coalesce( ur_hist_mat.is_not_new , ur_hist_mat_mpv_1.is_not_new )  as is_not_new, /*number*/
 coalesce( ur_hist_mat.kod_hist_mat , ur_hist_mat_mpv_1.kod_hist_mat )  as kod_hist_mat/*number*//*key*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
max( case  when (kod_hist_mat.result_kod_post != kod_hist_mat.result_kod_post_read)  then 'Укажите результат рассмотрения соответствующий судебному акту' when (qube.ur_hist_mat_dec_othr_cnt1 &gt; 1)  then 'Уже есть другое окончательное решение по делу' end )  as kod_result_vld1/*string*/

from (
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select qube.kod_hist_mat as kod_hist_mat, /*number*//*key*/
qube.ur_hist_mat_dec_othr_cnt1 as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select un.kod_hist_mat as kod_hist_mat, /*number*//*key*/
sum(un.ur_hist_mat_dec_othr_cnt1)  as ur_hist_mat_dec_othr_cnt1/*number*/

from (
(
(
--
select ur_hist_mat.kod_hist_mat as kod_hist_mat, /*number*//*key*/
null as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat
--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null )
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
union all
(
--
select dims.kod_hist_mat as kod_hist_mat, /*number*//*key*/
ur_hist_mat_dec_othr.cnt as ur_hist_mat_dec_othr_cnt1/*number*/

from (
--
select ur_hist_mat_dec_othr_a_d.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
ur_hist_mat.kod_hist_mat as kod_hist_mat/*number*//*key*/

from (
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr_a_d
--\ur_hist_mat_dec_othr
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat_a_d1 on ur_hist_mat_dec_othr_a_d.kod_mat = kod_mat_a_d1.kod_mat--\ur_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
)
ur_hist_mat on ur_hist_mat.kod_mat = kod_mat_a_d1.kod_mat--\ur_hist_mat
where
ur_hist_mat.kod_hist_mat is not null  group by
ur_hist_mat_dec_othr_a_d.kod_hist_mat, /*number*//*key*/
ur_hist_mat.kod_hist_mat/*number*//*key*/
)
dims
--\
left outer join
(
--ur_hist_mat_dec_othr
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
where
kod_result.decision = 1)
ur_hist_mat_dec_othr on ur_hist_mat_dec_othr.kod_hist_mat = dims.kod_hist_mat_prm--\ur_hist_mat_dec_othr
)
--\
)
--\
)
un
--\
 group by
un.kod_hist_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.result_kod_post as result_kod_post, /*number*/
kod_result.kod_post as result_kod_post_read/*number*/

from (select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,null as result_kod_post,a.kod_result as kod_result  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n37 as result_kod_post,t.n1 as kod_result  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post/*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
kod_hist_mat on kod_hist_mat.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
 group by
qube.kod_hist_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
a.kod_result as kod_result, /*number*/
a.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
a.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
a.gp_es as gp_es, /*Гос. пошлина, взысканная с истца*//*number*/
a.prim as prim, /*Примечание*//*string*/
a.kod_zased as kod_zased, /*number*/
a.gp_otv as gp_otv, /*Гос. пошлина, взысканная с ответчика*//*number*/
a.sud_izd as sud_izd, /*Судебные издержки*//*number*/
a.ogr as ogr, /*Расходы за введение ограничения режима энергопотребления*//*number*/
a.shtraf as shtraf, /**//*number*/
a.peni as peni, /*% за польз. чуж. ден. ср.*//*number*/
a.gp_ret as gp_ret, /*Гос. пошлина, возврат из бюджета*//*number*/
a.opl_ogr as opl_ogr, /*Оплачено: расходы за введение ограничения режима энергопотребления*//*number*/
a.dat_entry as dat_entry, /*Дата вст. реш. в зак. силу*//*date*/
a.dat_srok as dat_srok, /*Срок обжалования решения*//*date*/
a.proc_calc as proc_calc, /*Рассчитывать астрент*//*number*/
a.kod_vid_proc as kod_vid_proc, /*number*/
a.proc_const as proc_const, /*%*//*number*/
a.opl_sud_izd as opl_sud_izd, /*Оплачено: Судебные издержки*//*number*/
a.kod_scan as kod_scan, /*number*/
a.dat_send_il as dat_send_il, /*Дата направления ИЛ в филиал*//*date*/
a.result_kod_post as result_kod_post, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all, /*Гос. пошлина, всего*//*number*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld, /*Дата вступления, валидация*//*string*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc, /*string*/
kod_result.decision as decision, /*number*/
 case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end  as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result,a.dat_rassm as dat_rassm,a.dat_post as dat_post,a.gp_es as gp_es,a.prim as prim,a.kod_zased as kod_zased,a.gp_otv as gp_otv,a.sud_izd as sud_izd,a.ogr as ogr,a.shtraf as shtraf,a.peni as peni,a.gp_ret as gp_ret,a.opl_ogr as opl_ogr,a.dat_entry as dat_entry,a.dat_srok as dat_srok,a.proc_calc as proc_calc,a.kod_vid_proc as kod_vid_proc,a.proc_const as proc_const,a.opl_sud_izd as opl_sud_izd,a.kod_scan as kod_scan,a.dat_send_il as dat_send_il,null as result_kod_post,0 as is_new,1 as is_not_new  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result,t.d2 as dat_rassm,t.d1 as dat_post,t.n4 as gp_es,t.s1 as prim,t.n5 as kod_zased,t.n6 as gp_otv,t.n10 as sud_izd,t.n19 as ogr,t.n22 as shtraf,t.n23 as peni,t.n25 as gp_ret,t.n26 as opl_ogr,t.d7 as dat_entry,t.d8 as dat_srok,t.n27 as proc_calc,t.n28 as kod_vid_proc,t.n29 as proc_const,t.n30 as opl_sud_izd,t.n31 as kod_scan,t.d10 as dat_send_il,t.n37 as result_kod_post,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result,a.dat_rassm as dat_rassm,a.dat_post as dat_post,a.gp_es as gp_es,a.prim as prim,a.kod_zased as kod_zased,a.gp_otv as gp_otv,a.sud_izd as sud_izd,a.ogr as ogr,a.shtraf as shtraf,a.peni as peni,a.gp_ret as gp_ret,a.opl_ogr as opl_ogr,a.dat_entry as dat_entry,a.dat_srok as dat_srok,a.proc_calc as proc_calc,a.kod_vid_proc as kod_vid_proc,a.proc_const as proc_const,a.opl_sud_izd as opl_sud_izd,a.kod_scan as kod_scan,a.dat_send_il as dat_send_il,null as result_kod_post,0 as is_new,1 as is_not_new  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result,t.d2 as dat_rassm,t.d1 as dat_post,t.n4 as gp_es,t.s1 as prim,t.n5 as kod_zased,t.n6 as gp_otv,t.n10 as sud_izd,t.n19 as ogr,t.n22 as shtraf,t.n23 as peni,t.n25 as gp_ret,t.n26 as opl_ogr,t.d7 as dat_entry,t.d8 as dat_srok,t.n27 as proc_calc,t.n28 as kod_vid_proc,t.n29 as proc_const,t.n30 as opl_sud_izd,t.n31 as kod_scan,t.d10 as dat_send_il,t.n37 as result_kod_post,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat_mpv_1 on ur_hist_mat_mpv_1.kod_hist_mat = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
a.kod_result as kod_result, /*number*/
a.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
a.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
a.gp_es as gp_es, /*Гос. пошлина, взысканная с истца*//*number*/
a.prim as prim, /*Примечание*//*string*/
a.kod_zased as kod_zased, /*number*/
a.gp_otv as gp_otv, /*Гос. пошлина, взысканная с ответчика*//*number*/
a.sud_izd as sud_izd, /*Судебные издержки*//*number*/
a.ogr as ogr, /*Расходы за введение ограничения режима энергопотребления*//*number*/
a.shtraf as shtraf, /**//*number*/
a.peni as peni, /*% за польз. чуж. ден. ср.*//*number*/
a.gp_ret as gp_ret, /*Гос. пошлина, возврат из бюджета*//*number*/
a.opl_ogr as opl_ogr, /*Оплачено: расходы за введение ограничения режима энергопотребления*//*number*/
a.dat_entry as dat_entry, /*Дата вст. реш. в зак. силу*//*date*/
a.dat_srok as dat_srok, /*Срок обжалования решения*//*date*/
a.proc_calc as proc_calc, /*Рассчитывать астрент*//*number*/
a.kod_vid_proc as kod_vid_proc, /*number*/
a.proc_const as proc_const, /*%*//*number*/
a.opl_sud_izd as opl_sud_izd, /*Оплачено: Судебные издержки*//*number*/
a.kod_scan as kod_scan, /*number*/
a.dat_send_il as dat_send_il, /*Дата направления ИЛ в филиал*//*date*/
a.result_kod_post as result_kod_post, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all, /*Гос. пошлина, всего*//*number*/
 case  when ((a.dat_srok &lt; ( trunc( ( sysdate )  ) ) )  and (a.dat_entry is null )  and (( case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end )  = 1) )  then 'Срок обжалования решения прошел, укажите дату вступления в законную силу' when ((a.dat_entry &lt; a.dat_srok) )  then '[err]Указанная дата вступления решения в силу наступает ранее срока на обжалование' end  as dat_entry_vld, /*Дата вступления, валидация*//*string*/
 case  when ((( case  when (a.kod_vid_proc = 2)  then 1 end )  = 1)  and (a.proc_calc = 1) )  then 1 end  as is_post_astr_proc_and_calc, /*string*/
kod_result.decision as decision, /*number*/
 case  when ((( case  when (kod_result.kod_post = 2)  then 1 else 0 end )  = 1)  and (kod_result.decision = 1) )  then 1 else 0 end  as decision2, /*С судебным актом решение и признаком окончательного решения*//*number*/
 sg_peny_helper.get_refin_perc( a.dat_post , kod_folders.kodp )  as proc_const_new_val, /*Дата прин. суд. акта*//*number*/
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result,a.dat_rassm as dat_rassm,a.dat_post as dat_post,a.gp_es as gp_es,a.prim as prim,a.kod_zased as kod_zased,a.gp_otv as gp_otv,a.sud_izd as sud_izd,a.ogr as ogr,a.shtraf as shtraf,a.peni as peni,a.gp_ret as gp_ret,a.opl_ogr as opl_ogr,a.dat_entry as dat_entry,a.dat_srok as dat_srok,a.proc_calc as proc_calc,a.kod_vid_proc as kod_vid_proc,a.proc_const as proc_const,a.opl_sud_izd as opl_sud_izd,a.kod_scan as kod_scan,a.dat_send_il as dat_send_il,null as result_kod_post,0 as is_new,1 as is_not_new  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result,t.d2 as dat_rassm,t.d1 as dat_post,t.n4 as gp_es,t.s1 as prim,t.n5 as kod_zased,t.n6 as gp_otv,t.n10 as sud_izd,t.n19 as ogr,t.n22 as shtraf,t.n23 as peni,t.n25 as gp_ret,t.n26 as opl_ogr,t.d7 as dat_entry,t.d8 as dat_srok,t.n27 as proc_calc,t.n28 as kod_vid_proc,t.n29 as proc_const,t.n30 as opl_sud_izd,t.n31 as kod_scan,t.d10 as dat_send_il,t.n37 as result_kod_post,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.kod_result as kod_result,a.dat_rassm as dat_rassm,a.dat_post as dat_post,a.gp_es as gp_es,a.prim as prim,a.kod_zased as kod_zased,a.gp_otv as gp_otv,a.sud_izd as sud_izd,a.ogr as ogr,a.shtraf as shtraf,a.peni as peni,a.gp_ret as gp_ret,a.opl_ogr as opl_ogr,a.dat_entry as dat_entry,a.dat_srok as dat_srok,a.proc_calc as proc_calc,a.kod_vid_proc as kod_vid_proc,a.proc_const as proc_const,a.opl_sud_izd as opl_sud_izd,a.kod_scan as kod_scan,a.dat_send_il as dat_send_il,null as result_kod_post,0 as is_new,1 as is_not_new  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ) and   a.kod_hist_mat in :kod_hist_mat_prm   union all  select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n1 as kod_result,t.d2 as dat_rassm,t.d1 as dat_post,t.n4 as gp_es,t.s1 as prim,t.n5 as kod_zased,t.n6 as gp_otv,t.n10 as sud_izd,t.n19 as ogr,t.n22 as shtraf,t.n23 as peni,t.n25 as gp_ret,t.n26 as opl_ogr,t.d7 as dat_entry,t.d8 as dat_srok,t.n27 as proc_calc,t.n28 as kod_vid_proc,t.n29 as proc_const,t.n30 as opl_sud_izd,t.n31 as kod_scan,t.d10 as dat_send_il,t.n37 as result_kod_post,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_hist_mat_prm )
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from (select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
)
kod_mat1 on a.kod_mat = kod_mat1.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp/**//*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat1.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.kod_post as kod_post, /*number*/
a.decision as decision/**//*number*/

from us_result
a
--\us_result
)
kod_result on a.kod_result = kod_result.kod_result--\us_result
)
ur_hist_mat on ( coalesce( ur_hist_mat.kod_hist_mat , ur_hist_mat_mpv_1.kod_hist_mat ) )  = qube.kod_hist_mat--\ur_hist_mat
left outer join
(
--sk_vid_proc
select a.kod_vid_proc as kod_vid_proc, /*number*//*key*/
a.name as name/*Наименование*//*string*/

from sk_vid_proc
a
--\sk_vid_proc
)
kod_vid_proc_x_n on ( coalesce( ur_hist_mat.kod_vid_proc , ur_hist_mat_mpv_1.kod_vid_proc ) )  = kod_vid_proc_x_n.kod_vid_proc--\sk_vid_proc
left outer join
(
--ur_scan_docs
select a.kod_scan as kod_scan, /*number*//*key*/
a.file_name as file_name/**//*string*/

from ur_scan_docs
a
--\ur_scan_docs
)
kod_scan_x_n on ( coalesce( ur_hist_mat.kod_scan , ur_hist_mat_mpv_1.kod_scan ) )  = kod_scan_x_n.kod_scan--\ur_scan_docs
left outer join
(
--us_result
select a.kod_result as kod_result, /*number*//*key*/
a.name as name/*Результат рассмотрения*//*string*/

from us_result
a
--\us_result
)
kod_result_x_n on ( coalesce( ur_hist_mat.kod_result , ur_hist_mat_mpv_1.kod_result ) )  = kod_result_x_n.kod_result--\us_result
left outer join
(
--us_post
select a.kod_post as kod_post, /*number*//*key*/
a.name as name/*Судебный акт*//*string*/

from us_post
a
--\us_post
)
result_kod_post_x_n on ( coalesce( ur_hist_mat.result_kod_post , ur_hist_mat_mpv_1.result_kod_post ) )  = result_kod_post_x_n.kod_post--\us_post
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.fio as fio/*Судья*//*string*/

from us_zased
a
--\us_zased
)
kod_zased_x_n on ( coalesce( ur_hist_mat.kod_zased , ur_hist_mat_mpv_1.kod_zased ) )  = kod_zased_x_n.kod_zased--\us_zased
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
kod_doc.abbr || '  ' || a.num_delo || ' от ' || ( to_char( a.dat_doc ,'DD.MM.YYYY') )  as name/*Иск*//*string*/

from ur_mat
a
--\ur_mat
left outer join
(
--us_doc
select a.kod_doc as kod_doc, /*number*//*key*/
a.abbr as abbr/*Аббревиатура*//*string*/

from us_doc
a
--\us_doc
)
kod_doc on a.kod_doc = kod_doc.kod_doc--\us_doc
)
kod_mat_x_n on ( coalesce( ur_hist_mat.kod_mat , ur_hist_mat_mpv_1.kod_mat ) )  = kod_mat_x_n.kod_mat--\ur_mat
left outer join
(
--us_zased
select a.kod_zased as kod_zased, /*number*//*key*/
a.phone as phone, /*Телефон*//*string*/
a.kod_sud as kod_sud/*number*/

from us_zased
a
--\us_zased
)
kod_zased on ( coalesce( ur_hist_mat.kod_zased , ur_hist_mat_mpv_1.kod_zased ) )  = kod_zased.kod_zased--\us_zased
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on kod_zased.kod_sud = kod_sud_x_n.kod_sud--\us_sud
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_folders as kod_folders/*number*/

from ur_mat
a
--\ur_mat
)
kod_mat on ( coalesce( ur_hist_mat.kod_mat , ur_hist_mat_mpv_1.kod_mat ) )  = kod_mat.kod_mat--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kodp as kodp, /**//*number*/
a.kod_sdp as kod_sdp, /*number*/
 decode ( a.vvod ,0,1,0)  as not_vvod/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on kod_mat.kod_folders = kod_folders.kod_folders--\ur_folders
left outer join
(
--uk_sdp
select a.kod_sdp as kod_sdp, /*number*//*key*/
a.name as name/*Юридический документ*//*string*/

from uk_sdp
a
--\uk_sdp
)
kod_sdp_x_n on kod_folders.kod_sdp = kod_sdp_x_n.kod_sdp--\uk_sdp
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump || ' ' || a.name as sp_col_name/**//*string*/

from kr_payer
a
--\kr_payer
)
kodp_x_n on kod_folders.kodp = kodp_x_n.kodp--\kr_payer
left outer join
(
--kr_payer
select a.kodp as kodp, /**//*number*//*key*/
a.nump as nump/*Код абонента*//*string*/

from kr_payer
a
--\kr_payer
)
kodp on kod_folders.kodp = kodp.kodp--\kr_payer
--\
</query>
          </select>
          <procedure>
            <params />
          </procedure>
        </root>
      </single-row-refresh-cmd>
    </table>
    <table name="ur_mat" auto-refresh="" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" new-rows-vis-for-other-tbls="1" update-target="ur_mat" delete-validation="ur_dp_exists_vld" key="kod_mat" is-ms-upd="1" is-top="1" key-dimension="kod_mat">
      <select-text>
--
select ur_mat.num_delo as num_delo, /*Номер дела*//*string*/
ur_mat.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
ur_mat.kod_sud as kod_sud, /*Суд*//*number*/
qube.ur_dp_priz_all1 as ur_dp_priz_all, /*Всего*//*number*/
qube.ur_dp_priz_osn1 as ur_dp_priz_osn, /*Осн. реал.*//*number*/
qube.ur_dp_priz_peni1 as ur_dp_priz_peni, /*Проценты (пени)*//*number*/
qube.ur_dp_sum_peni1 as ur_dp_sum_peni, /*Пени 1*//*number*/
qube.ur_dp_priz_vld1 as ur_dp_priz_vld, /*Валидация (наличие признанных сумм по решению)*//*string*/
qube.ur_dp_priz_shtr1 as ur_dp_priz_shtr, /*Штраф*//*number*/
ur_mat.sum_gp as sum_gp, /*Оплачено при подаче*//*number*/
qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
qube.ur_gp_opl_info_npay_sum_r1 as gp_opl1, /*От ответчика*//*number*/
qube.ur_gp_opl_info_npay_sum_b1 as gp_opl2, /*Из бюджета*//*number*/
ur_mat.astrent_exists as astrent_exists, /*Есть астрент*//*number*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr, /*Начислено астрент*//*number*/
qube.fin_ul_astr_exst1 as fin_ul_astr_exst, /*Есть астрент (по начислениям)*//*number*/
kod_sud_x_n.name as kod_sud_x_n, /*Суд*//*string*/
qube.ur_hist_mat_count1 as ur_hist_mat_count, /*number*/
ur_mat.is_new as is_new, /*number*/
ur_mat.is_not_new as is_not_new, /*number*/
qube.ur_dp_exists_vld1 as ur_dp_exists_vld, /*Валидация (наличие привязанных документов)*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_dp_sum_v1)  as ur_dp_priz_all1, /*Призн. по юр. док. всего*//*number*/
sum( case  when (kod_dogplat.vid_real = 2)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_osn1, /*Призн. по юр. док. осн. реал.*//*number*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_peni1, /*Призн. по юр. док. пени*//*number*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_summa1 end )  as ur_dp_sum_peni1, /*Выст. по юр. док. пени*//*number*/
max( case  when ((qube.ur_dp_has_no_priz1 &gt; 0) )  then 'Должны быть заполнены суммы по решению суда' end )  as ur_dp_priz_vld1, /*Валидация (наличие признанных сумм по решению)*//*string*/
sum( case  when (kod_dogplat.vid_real = 4)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_shtr1, /*Призн. по юр. док. штрафы*//*number*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1, /*string*/
sum(qube.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1, /*От ответчика*//*number*/
sum(qube.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1, /*Из бюджета*//*number*/
sum(qube.fin_ul_nach_astr1)  as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
max( case  when ( nvl( qube.fin_ul_nach_astr1 ,0)!=0 )  then 1 end )  as fin_ul_astr_exst1, /*Есть астрент (по начислениям)*//*number*/
sum(qube.ur_hist_mat_count1)  as ur_hist_mat_count1, /*number*/
max( case  when ( nvl( qube.ur_dogplat_count1 ,0)!=0 )  then 'Есть суммы по документу' end )  as ur_dp_exists_vld1/*Валидация (наличие привязанных документов)*//*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
qube.ur_dogplat_count1 as ur_dogplat_count1, /*number*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1, /*number*/
qube.ur_dp_sum_v2 as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
null as ur_dogplat_count1, /*number*/
null as ur_dp_has_no_priz1, /*number*/
null as ur_dp_sum_v2, /*number*/
null as ur_dp_sum_v1, /*number*/
null as ur_dp_summa1, /*number*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.fin_ul_nach_astr1)  as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
sum(un.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
sum(un.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
sum(un.ur_hist_mat_count1)  as ur_hist_mat_count1, /*number*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from ur_mat
a
--\ur_mat
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ur_mat
a
--\ur_mat
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
(ur_mat.kod_mat = :p_kod )  and (ur_mat.kod_mat is not null )  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select ur_gp_opl_info_a_d.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
ur_gp_opl_info_a_d.npay_sum_b as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
ur_gp_opl_info_a_d.npay_sum_r as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_gp_opl_info
select a.nrn as nrn, /*ID записи из КИСУ Парус*//*number*//*key*/
 case  when ((a.sfinoper = 'Приход')  and (a.svdoc_type = 'Справка') )  then a.npay_sum end  as npay_sum_b, /*Возврат из бюджета*/
 case  when ((a.sfinoper = 'Приход')  and (('СУД_РЕШ' = a.svdoc_type)  or ('П/Т' = a.svdoc_type) ) )  then a.npay_sum end  as npay_sum_r, /*Оплата ответчиком*/
a.kod_mat as kod_mat/*number*/

from ur_gp_opl_info
a
--\ur_gp_opl_info
)
ur_gp_opl_info_a_d
--\ur_gp_opl_info
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ur_mat
a
--\ur_mat
)
ur_mat on ur_gp_opl_info_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
(ur_mat.kod_mat = :p_kod )  and (ur_mat.kod_mat is not null ) )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1, /*number*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ur_hist_mat
a
--\ur_hist_mat
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ur_mat
a
--\ur_mat
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
(ur_mat.kod_mat = :p_kod )  and (ur_mat.kod_mat is not null ) )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from ur_mat
a
--\ur_mat
)
ur_mat
--\ur_mat
where
(ur_mat.kod_mat = :p_kod )  and (ur_mat.kod_mat is not null ) )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
null as fin_ul_nach_astr1, /*number*/
qube.ur_dogplat_count1 as ur_dogplat_count1, /*number*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1, /*number*/
qube.ur_dp_sum_v2 as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dogplat_count1)  as ur_dogplat_count1, /*number*/
max(un.ur_dp_has_no_priz1)  as ur_dp_has_no_priz1, /*number*/
sum(un.ur_dp_sum_v2)  as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
sum(un.ur_dp_summa1)  as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.cnt as ur_dogplat_count1, /*number*/
kod_dogplat.has_no_prizn as ur_dp_has_no_priz1, /*number*/
kod_dogplat.sum_v as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
kod_dogplat.sum_v as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
kod_dogplat.summa as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.summa as summa, /*Выставленно по юр. документу*//*number*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 case  when (a.sum_v is null )  then 1 end  as has_no_prizn/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from ur_mat
a
--\ur_mat
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
(ur_mat.kod_mat = :p_kod )  and (ur_mat.kod_mat is not null ) )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.num_delo as num_delo, /*Номер дела*//*string*/
a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
a.sum_gp as sum_gp, /*Оплачено госпошлины при подаче*//*number*/
a.kod_sud as kod_sud, /*number*/
a.astrent_exists as astrent_exists, /*Есть астрент (ручн. признак)*//*number*/
0 as is_new, /*number*/
1 as is_not_new/*number*/

from ur_mat
a
--\ur_mat
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on ur_mat.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</select-text>
      <columns>
        <column name="num_delo" table="ur_mat" type="string" title="Номер дела" is-user-editable="1" ColumnMandatory="1" is-updateable="1" is-updateable-ext="1" update-target="num_delo" temp-col-name="s1" />
        <column name="dat_prin" table="ur_mat" type="date" title="Дата принятия документов в суде" is-user-editable="1" ColumnMandatory="1" is-updateable="1" is-updateable-ext="1" update-target="dat_prin" temp-col-name="d2" />
        <column name="kod_sud" table="ur_mat" type="number" title="Суд" parname="kod_sud" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_sud" temp-col-name="n10">
          <sel-list-compiled>
            <root>
              <query class="1" title="Суд / судебный участок" order="name, kod_sud" timestamp="13.09.2023 15:45:32" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_sud.xml" haskeys="1" name="a" as="a" noname="1" path="./a" used="1">
                <order notext="1">
                  <column column="name">name</column>
                  <column column="kod_sud">kod_sud</column>
                </order>
                <select>--a
select <column table="us_sud" column="kod_sud" key="1" as="kod_sud" used="1" type="number" sourcetable="./a/us_sud" sourcecolumn="kod_sud" into="n1">us_sud.kod_sud as kod_sud, /*number*//*key*/
</column><column table="us_sud" column="kod_parent" as="kod_parent" key="0" used="1" type="number" sourcetable="./a/us_sud" sourcecolumn="kod_parent" reference="us_sud" refcol="kod_sud" into="n2">us_sud.kod_parent as kod_parent, /*number*/
</column><column table="us_sud" column="name" title="Судебный участок" as="name" key="0" used="1" type="string" sourcetable="./a/us_sud" sourcecolumn="name" into="s1">us_sud.name as name/*Судебный участок*//*string*/
</column></select>
                <from>
from <query name="us_sud" as="us_sud" path="./a/us_sud" haskeys="1" used="1">(
<select>--us_sud
select <column table="a" column="kod_sud" type="number" key="1" as="kod_sud" sourcetable="./a/us_sud" sourcecolumn="kod_sud" used="1">a.kod_sud as kod_sud, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Судебный участок" as="name" key="0" sourcetable="./a/us_sud" sourcecolumn="name" used="1">a.name as name, /*Судебный участок*//*string*/
</column><column table="a" column="kod_parent" type="number" as="kod_parent" reference="us_sud" refcol="kod_sud" key="0" sourcetable="./a/us_sud" sourcecolumn="kod_parent" used="1">a.kod_parent as kod_parent/*number*/
</column></select><from>
from <table name="us_sud" as="a" title="Суд / судебный участок" used="1">us_sud
a
--\us_sud
</table></from>)
us_sud
--\us_sud
</query></from>
                <where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<call function="rownum" pth="0" type="number"><text txtype="func"> rownum </text></call><text txtype="func"> &lt;= </text><const><text>:p_rows_limit </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="us_sud" column="kod_sud" key="1" as="kod_sud" thissrc="kod_sud">us_sud.kod_sud</column><text txtype="func"> in </text><const><text>:pk_prm </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="us_sud" column="kod_sud" key="1" as="kod_sud" thissrc="kod_sud">us_sud.kod_sud</column><text txtype="func"> ) like lower( </text><const><text>:kod_sud_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="us_sud" column="kod_parent" as="kod_parent" thissrc="kod_parent">us_sud.kod_parent</column><text txtype="func"> ) like lower( </text><const><text>:kod_parent_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="like" pth="" optional="1" type="bool">(<text txtype="func"> lower( </text><column table="us_sud" column="name" title="Судебный участок" as="name" thissrc="name">us_sud.name</column><text txtype="func"> ) like lower( </text><const><text>:name_filter </text></const><text txtype="func"> ) </text>) </call><text txtype="func"> } </text></call></where>
                <order>
order by name, kod_sud</order>--\a
</query>
            </root>
          </sel-list-compiled>
          <sel-list-report>
            <report name="a" class="1" title="Суд / судебный участок" order="name, kod_sud" timestamp="13.09.2023 15:45:32" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_sud.xml" haskeys="1" as="a">
              <queries>
                <query class="1" title="Суд / судебный участок" order="name, kod_sud" timestamp="13.09.2023 15:45:32" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\us_sud.xml" haskeys="1" name="a" as="a">
                  <params>
                    <param name="pk_prm" type="array" />
                    <param name="kod_sud_filter" type="string" />
                    <param name="kod_parent_filter" type="string" />
                    <param name="name_filter" type="string" />
                    <param name="p_rows_limit" type="number" />
                  </params>
                  <select>
                    <column table="us_sud" column="kod_sud" key="1" as="kod_sud" />
                    <column table="us_sud" column="kod_parent" as="kod_parent" />
                    <column table="us_sud" column="name" title="Судебный участок" as="name" />
                  </select>
                  <from>
                    <query name="us_sud" as="us_sud" title="Суд / судебный участок" />
                  </from>
                  <where>
                    <call function="and">
                      <call function="le">
                        <call function="rownum" />
                        <useparam name="p_rows_limit" />
                      </call>
                      <call function="in" optional="1">
                        <column table="this" column="kod_sud" />
                        <useparam name="pk_prm" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_sud" />
                        <useparam name="kod_sud_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="kod_parent" />
                        <useparam name="kod_parent_filter" />
                      </call>
                      <call function="like" optional="1">
                        <column table="this" column="name" />
                        <useparam name="name_filter" />
                      </call>
                    </call>
                  </where>
                  <order>
                    <column column="name" />
                    <column column="kod_sud" />
                  </order>
                  <order>
                    <column column="name" />
                    <column column="kod_sud" />
                  </order>
                  <withparams>
                    <useparam name="pk_prm" />
                    <useparam name="kod_sud_filter" />
                    <useparam name="kod_parent_filter" />
                    <useparam name="name_filter" />
                    <useparam name="p_rows_limit" />
                  </withparams>
                </query>
              </queries>
              <params>
                <param name="pk_prm" type="array">
                  <const>:pk_prm </const>
                </param>
                <param name="kod_sud_filter" type="string">
                  <const>:kod_sud_filter </const>
                </param>
                <param name="kod_parent_filter" type="string">
                  <const>:kod_parent_filter </const>
                </param>
                <param name="name_filter" type="string">
                  <const>:name_filter </const>
                </param>
                <param name="p_rows_limit" type="number">
                  <const>:p_rows_limit </const>
                </param>
              </params>
            </report>
          </sel-list-report>
          <sel-list-pars>
            <params />
          </sel-list-pars>
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_sud_x_n.name as kod_sud_x_n, /*Суд*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_sud as kod_sud/*number*/

from (select a.kod_mat as kod_mat,a.kod_sud as kod_sud  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n10 as kod_sud  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.kod_sud as kod_sud  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n10 as kod_sud  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on ur_mat.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="kod_sud_x_n" table="ur_mat" />
          </dependants>
        </column>
        <column name="ur_dp_priz_all" table="ur_mat" type="number" title="Всего" ClientExists="decision" is-user-editable="1" ClientValid="ur_dp_priz_vld" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_priz_all1 as ur_dp_priz_all, /*Всего*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_dp_sum_v1)  as ur_dp_priz_all1/*Призн. по юр. док. всего*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select ur_dogplat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_dogplat_a_d.sum_v as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat/*number*/

from ur_dogplat
a
--\ur_dogplat
)
ur_dogplat_a_d
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_dogplat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_dp_sum_v1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_dp_priz_osn" table="ur_mat" type="number" title="Осн. реал." is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_priz_osn1 as ur_dp_priz_osn, /*Осн. реал.*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum( case  when (kod_dogplat.vid_real = 2)  then qube.ur_dp_sum_v1 end )  as ur_dp_priz_osn1/*Призн. по юр. док. осн. реал.*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.sum_v as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
null as ur_dp_sum_v1/*number*/

from (
--
select un.kod_mat as kod_mat/*number*//*key*/

from (
(
(
--
select ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_dp_priz_peni" table="ur_mat" type="number" title="Проценты (пени)" parname="priz_peni" ClientVisible="kod_sf_peni" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_priz_peni1 as ur_dp_priz_peni, /*Проценты (пени)*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_sum_v1 end )  as ur_dp_priz_peni1/*Призн. по юр. док. пени*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.sum_v as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
null as ur_dp_sum_v1/*number*/

from (
--
select un.kod_mat as kod_mat/*number*//*key*/

from (
(
(
--
select ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_dp_sum_peni" table="ur_mat" type="number" title="Пени 1" parname="peni_doc" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_sum_peni1 as ur_dp_sum_peni, /*Пени 1*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_summa1 end )  as ur_dp_sum_peni1/*Выст. по юр. док. пени*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.ur_dp_summa1 as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
(
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
qube.ur_dp_summa1 as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dp_summa1)  as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.summa as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.summa as summa, /*Выставленно по юр. документу*//*number*/
a.kod_mat as kod_mat/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
null as ur_dp_summa1/*number*/

from (
--
select un.kod_mat as kod_mat/*number*//*key*/

from (
(
(
--
select ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_dp_priz_vld" table="ur_mat" type="string" title="Валидация (наличие признанных сумм по решению)" parname="ur_dp_priz_vld" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_priz_vld1 as ur_dp_priz_vld, /*Валидация (наличие признанных сумм по решению)*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ((qube.ur_dp_has_no_priz1 &gt; 0) )  then 'Должны быть заполнены суммы по решению суда' end )  as ur_dp_priz_vld1/*Валидация (наличие признанных сумм по решению)*//*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1/*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1/*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
max(un.ur_dp_has_no_priz1)  as ur_dp_has_no_priz1/*number*/

from (
(
(
--
select ur_dogplat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_dogplat_a_d.has_no_prizn as ur_dp_has_no_priz1/*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 case  when (a.sum_v is null )  then 1 end  as has_no_prizn/*number*/

from ur_dogplat
a
--\ur_dogplat
)
ur_dogplat_a_d
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_dogplat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_dp_has_no_priz1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_dp_priz_shtr" table="ur_mat" type="number" title="Штраф" parname="priz_shtraf" ClientVisible="kod_sf_shtraf" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_priz_shtr1 as ur_dp_priz_shtr, /*Штраф*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum( case  when (kod_dogplat.vid_real = 4)  then qube.ur_dp_sum_v1 end )  as ur_dp_priz_shtr1/*Призн. по юр. док. штрафы*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.sum_v as ur_dp_sum_v1/*Признано по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
null as ur_dp_sum_v1/*number*/

from (
--
select un.kod_mat as kod_mat/*number*//*key*/

from (
(
(
--
select ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="sum_gp" table="ur_mat" type="number" title="Оплачено при подаче" EditableInvert="1" ClientEditable="f10" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="sum_gp" temp-col-name="n9">
          <dep-refresh-cmd>
            <root table="ur_mat">
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1/*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </dep-refresh-cmd>
          <dependants>
            <dependant name="ur_hist_mat_gp_vld" table="ur_mat" />
          </dependants>
        </column>
        <column name="ur_hist_mat_gp_vld" table="ur_mat" type="string" title="Гос. пошлина, всего" parname="gp_vld" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1/*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="gp_opl1" table="ur_mat" type="number" title="От ответчика" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_gp_opl_info_npay_sum_r1 as gp_opl1, /*От ответчика*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1/*От ответчика*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1/*Оплата ответчиком*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1/*Оплата ответчиком*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1/*Оплата ответчиком*/

from (
(
(
--
select ur_gp_opl_info_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_gp_opl_info_a_d.npay_sum_r as ur_gp_opl_info_npay_sum_r1/*Оплата ответчиком*/

from (
--ur_gp_opl_info
select a.nrn as nrn, /*ID записи из КИСУ Парус*//*number*//*key*/
 case  when ((a.sfinoper = 'Приход')  and (('СУД_РЕШ' = a.svdoc_type)  or ('П/Т' = a.svdoc_type) ) )  then a.npay_sum end  as npay_sum_r, /*Оплата ответчиком*/
a.kod_mat as kod_mat/*number*/

from ur_gp_opl_info
a
--\ur_gp_opl_info
)
ur_gp_opl_info_a_d
--\ur_gp_opl_info
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_gp_opl_info_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_gp_opl_info_npay_sum_r1/**/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="gp_opl2" table="ur_mat" type="number" title="Из бюджета" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_gp_opl_info_npay_sum_b1 as gp_opl2, /*Из бюджета*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1/*Из бюджета*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1/*Возврат из бюджета*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1/*Возврат из бюджета*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1/*Возврат из бюджета*/

from (
(
(
--
select ur_gp_opl_info_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_gp_opl_info_a_d.npay_sum_b as ur_gp_opl_info_npay_sum_b1/*Возврат из бюджета*/

from (
--ur_gp_opl_info
select a.nrn as nrn, /*ID записи из КИСУ Парус*//*number*//*key*/
 case  when ((a.sfinoper = 'Приход')  and (a.svdoc_type = 'Справка') )  then a.npay_sum end  as npay_sum_b, /*Возврат из бюджета*/
a.kod_mat as kod_mat/*number*/

from ur_gp_opl_info
a
--\ur_gp_opl_info
)
ur_gp_opl_info_a_d
--\ur_gp_opl_info
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_gp_opl_info_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_gp_opl_info_npay_sum_b1/**/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="astrent_exists" table="ur_mat" type="number" title="Есть астрент" ExistsInvert="1" ClientExists="fin_ul_astr_exst" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="astrent_exists" temp-col-name="n31" />
        <column name="fin_ul_nach_astr" table="ur_mat" type="number" title="Начислено астрент" ClientVisible="fin_ul_astr_exst" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.fin_ul_nach_astr1 as fin_ul_nach_astr, /*Начислено астрент*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.fin_ul_nach_astr1)  as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.fin_ul_nach_astr1)  as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
(
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from ( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from (select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="fin_ul_astr_exst" table="ur_mat" type="number" title="Есть астрент (по начислениям)" parname="fin_ul_astr_exst" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.fin_ul_astr_exst1 as fin_ul_astr_exst, /*Есть астрент (по начислениям)*//*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.fin_ul_nach_astr1 ,0)!=0 )  then 1 end )  as fin_ul_astr_exst1/*Есть астрент (по начислениям)*//*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.fin_ul_nach_astr1)  as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
(
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from ( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1/*Начислено астрент*//*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from (select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_sud_x_n" table="ur_mat.kod_sud" type="string" title="Суд" text-source-for="kod_sud" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select kod_sud_x_n.name as kod_sud_x_n, /*Суд*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_sud as kod_sud/*number*/

from (select a.kod_mat as kod_mat,a.kod_sud as kod_sud  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n10 as kod_sud  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.kod_sud as kod_sud  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n10 as kod_sud  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on ur_mat.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="ur_hist_mat_count" table="ur_mat" type="number" title="" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_hist_mat_count1 as ur_hist_mat_count, /*number*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_hist_mat_count1)  as ur_hist_mat_count1/*number*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1/*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1/*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_hist_mat_count1)  as ur_hist_mat_count1/*number*/

from (
(
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt/*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt/*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_hist_mat_count1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_new" table="ur_mat" type="number" title="" is-user-editable="1" />
        <column name="is_not_new" table="ur_mat" type="number" title="" is-user-editable="1" />
        <column name="ur_dp_exists_vld" table="ur_mat" type="string" title="Валидация (наличие привязанных документов)" is-user-editable="1" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_mat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_mat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select qube.ur_dp_exists_vld1 as ur_dp_exists_vld, /*Валидация (наличие привязанных документов)*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
max( case  when ( nvl( qube.ur_dogplat_count1 ,0)!=0 )  then 'Есть суммы по документу' end )  as ur_dp_exists_vld1/*Валидация (наличие привязанных документов)*//*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dogplat_count1 as ur_dogplat_count1/*number*/

from (
(
(
--
select qube.kod_mat as kod_mat, /*number*//*key*/
qube.ur_dogplat_count1 as ur_dogplat_count1/*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dogplat_count1)  as ur_dogplat_count1/*number*/

from (
(
(
--
select ur_dogplat_a_d.kod_mat as kod_mat, /*number*//*key*/
ur_dogplat_a_d.cnt as ur_dogplat_count1/*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt/*number*/

from ur_dogplat
a
--\ur_dogplat
)
ur_dogplat_a_d
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_dogplat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as ur_dogplat_count1/*number*/

from (
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="kod_mat" table="ur_mat" type="number" title="" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_mat" temp-col-name="n3" />
      </columns>
      <insert-text>begin 
for r in  
 ( select  
:num_delo as num_delo 
,:dat_prin as dat_prin 
,:kod_sud as kod_sud 
,:sum_gp as sum_gp 
,:astrent_exists as astrent_exists 
,:kod_mat as kod_mat 
 
from dual ) 
 
loop 
insert into ur_mat 
(num_delo 
,dat_prin 
,kod_sud 
,sum_gp 
,astrent_exists 
,kod_mat 
) 
 values  
(r.num_delo 
,r.dat_prin 
,r.kod_sud 
,r.sum_gp 
,r.astrent_exists 
,r.kod_mat 
) 
 returning  
kod_mat into :kod_mat; 
end loop; 
end; 
</insert-text>
      <delete-text>delete from ur_mat where kod_mat=:kod_mat</delete-text>
      <update-temp-text>begin 
delete from rr_temp 
where 
skod='ur_mat' 
and 
names=:form_id 
and 
f2=:kod_mat; 
if :row_state_id=1  then 
for r in  
 ( select  
:num_delo as num_delo 
,:dat_prin as dat_prin 
,:kod_sud as kod_sud 
,:sum_gp as sum_gp 
,:astrent_exists as astrent_exists 
,:kod_mat as kod_mat 
 
from dual ) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,s1 
,d2 
,n10 
,n9 
,n31 
,n3 
) 
 values  
('ur_mat' 
,:form_id 
,:kod_mat 
,:row_state_id 
,r.num_delo 
,r.dat_prin 
,r.kod_sud 
,r.sum_gp 
,r.astrent_exists 
,r.kod_mat 
); 
end loop; 
else 
for r in  
 ( select  
:num_delo as num_delo 
,:dat_prin as dat_prin 
,:kod_sud as kod_sud 
,:sum_gp as sum_gp 
,:astrent_exists as astrent_exists 
,:kod_mat as kod_mat 
,a.kod_folders 
,a.kod_doc 
,a.kod_ssp 
,a.num_reg 
,a.dat_otv 
,a.kod_ret_isk 
,a.u_m 
,a.d_m 
,a.num_otz 
,a.dat_otz 
,a.dat_doc 
,a.fio_otz 
,a.kod_subject 
,a.prichina_otz 
,a.prim 
,a.dat_gp 
,a.num_pp_gp 
,a.kod_parent 
,a.kodp 
,a.ogr 
,a.kod_dispute 
,a.type_claim_template 
,a.kod_delo 
,a.tep_el 
,a.type_potr 
,a.vvod 
,a.kod_emp 
,a.kod_vi 
,a.dep 
,a.dat_finish 
,a.prim_mor_dz 
,a.osnreal 
,a.period_zadol_s_vvod 
,a.period_zadol_po_vvod 
,a.ur_opl_do_resh_vvod 
,a.shtraf 
,a.peni 
,a.otvetch_info 
,a.link_delo 
,a.sum_zach_gp 
,a.num_zach_doc 
,a.dat_zach 
,a.sum_ifns_gp 
,a.num_ifns_doc 
,a.dat_ifns 
,a.kod_scan 
,a.dat_post 
,a.dat_arh 
,a.type_rassm 
,a.dat_post_mat_pio 
,a.num_zap_post_mat 
 
from ur_mat a  where kod_mat=:kod_mat) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,s1 
,d2 
,n10 
,n9 
,n31 
,n3 
,n4 
,n5 
,n6 
,s2 
,d1 
,n7 
,s3 
,d3 
,s4 
,d4 
,d5 
,s5 
,n8 
,s6 
,s7 
,d6 
,s8 
,n11 
,n1 
,n12 
,n13 
,n14 
,n15 
,n16 
,n17 
,n18 
,n19 
,n20 
,n21 
,d7 
,s9 
,n22 
,n23 
,n24 
,n25 
,n26 
,n27 
,s10 
,s11 
,n28 
,s12 
,d8 
,n29 
,s13 
,d9 
,n30 
,d10 
,d11 
,n32 
,d12 
,s14 
) 
 values  
('ur_mat' 
,:form_id 
,:kod_mat 
,:row_state_id 
,r.num_delo 
,r.dat_prin 
,r.kod_sud 
,r.sum_gp 
,r.astrent_exists 
,r.kod_mat 
,r.kod_folders 
,r.kod_doc 
,r.kod_ssp 
,r.num_reg 
,r.dat_otv 
,r.kod_ret_isk 
,r.u_m 
,r.d_m 
,r.num_otz 
,r.dat_otz 
,r.dat_doc 
,r.fio_otz 
,r.kod_subject 
,r.prichina_otz 
,r.prim 
,r.dat_gp 
,r.num_pp_gp 
,r.kod_parent 
,r.kodp 
,r.ogr 
,r.kod_dispute 
,r.type_claim_template 
,r.kod_delo 
,r.tep_el 
,r.type_potr 
,r.vvod 
,r.kod_emp 
,r.kod_vi 
,r.dep 
,r.dat_finish 
,r.prim_mor_dz 
,r.osnreal 
,r.period_zadol_s_vvod 
,r.period_zadol_po_vvod 
,r.ur_opl_do_resh_vvod 
,r.shtraf 
,r.peni 
,r.otvetch_info 
,r.link_delo 
,r.sum_zach_gp 
,r.num_zach_doc 
,r.dat_zach 
,r.sum_ifns_gp 
,r.num_ifns_doc 
,r.dat_ifns 
,r.kod_scan 
,r.dat_post 
,r.dat_arh 
,r.type_rassm 
,r.dat_post_mat_pio 
,r.num_zap_post_mat 
); 
end loop; 
end if; 
end; 
</update-temp-text>
      <clear-temp-text>delete from rr_temp where skod='ur_mat' and names=:form_id</clear-temp-text>
      <update-text>begin
update ur_mat set  
(num_delo 
,dat_prin 
,kod_sud 
,sum_gp 
,astrent_exists 
,kod_mat 
) 
= 
 ( select  
:num_delo as num_delo 
,:dat_prin as dat_prin 
,:kod_sud as kod_sud 
,:sum_gp as sum_gp 
,:astrent_exists as astrent_exists 
,:kod_mat as kod_mat 
 
from dual ) 
 
where 
kod_mat=:kod_mat 
;
end;
</update-text>
      <events>
        <useaction action-type="custom" event-name="object-save">
          <useaction action-type="execute-update" call="ur_mat_upd_num_reg">
            <column table="this" column="kod_mat" />
          </useaction>
          <useaction action-type="execute-update" call="ur_mat_upd_pretenz">
            <column table="this" column="kod_mat" />
          </useaction>
        </useaction>
      </events>
      <scheme>
        <table name="ur_mat" as="ur_mat">
          <columns>
            <column name="num_delo" type="string" title="Номер дела" />
            <column name="dat_prin" type="date" title="Дата принятия документов в суде" />
            <column name="kod_sud" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="ur_dp_priz_all" type="number" title="Всего" />
            <column name="ur_dp_priz_osn" type="number" title="Осн. реал." />
            <column name="ur_dp_priz_peni" type="number" title="Проценты (пени)" />
            <column name="ur_dp_sum_peni" type="number" title="Пени 1" visible="0" />
            <column name="ur_dp_priz_vld" type="string" title="Валидация (наличие признанных сумм по решению)" visible="0" />
            <column name="ur_dp_priz_shtr" type="number" title="Штраф" />
            <column name="sum_gp" type="number" title="Оплачено при подаче" />
            <column name="ur_hist_mat_gp_vld" type="string" title="Гос. пошлина, всего" visible="0" />
            <column name="gp_opl1" type="number" title="От ответчика" />
            <column name="gp_opl2" type="number" title="Из бюджета" />
            <column name="astrent_exists" type="number" title="Есть астрент" />
            <column name="fin_ul_nach_astr" type="number" title="Начислено астрент" />
            <column name="fin_ul_astr_exst" type="number" title="Есть астрент (по начислениям)" visible="0" />
            <column name="kod_sud_x_n" type="string" title="Суд" />
            <column name="ur_hist_mat_count" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_not_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="ur_dp_exists_vld" type="string" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_mat" type="number" invisible-in-column-chooser="1" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
      <single-row-refresh-cmd>
        <root>
          <params>
            <param name="kod_mat_prm" type="number" column="" />
            <param name="form_id" type="number" column="" />
          </params>
          <select>
            <params>
              <param name="kod_mat_prm" type="number" column="" />
              <param name="form_id" type="number" column="" />
            </params>
            <query>
--
select ur_mat.num_delo as num_delo, /*Номер дела*//*string*/
ur_mat.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
ur_mat.kod_sud as kod_sud, /*Суд*//*number*/
qube.ur_dp_priz_all1 as ur_dp_priz_all, /*Всего*//*number*/
qube.ur_dp_priz_osn1 as ur_dp_priz_osn, /*Осн. реал.*//*number*/
qube.ur_dp_priz_peni1 as ur_dp_priz_peni, /*Проценты (пени)*//*number*/
qube.ur_dp_sum_peni1 as ur_dp_sum_peni, /*Пени 1*//*number*/
qube.ur_dp_priz_vld1 as ur_dp_priz_vld, /*Валидация (наличие признанных сумм по решению)*//*string*/
qube.ur_dp_priz_shtr1 as ur_dp_priz_shtr, /*Штраф*//*number*/
ur_mat.sum_gp as sum_gp, /*Оплачено при подаче*//*number*/
qube.ur_hist_mat_gp_vld1 as ur_hist_mat_gp_vld, /*string*/
qube.ur_gp_opl_info_npay_sum_r1 as gp_opl1, /*От ответчика*//*number*/
qube.ur_gp_opl_info_npay_sum_b1 as gp_opl2, /*Из бюджета*//*number*/
ur_mat.astrent_exists as astrent_exists, /*Есть астрент*//*number*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr, /*Начислено астрент*//*number*/
qube.fin_ul_astr_exst1 as fin_ul_astr_exst, /*Есть астрент (по начислениям)*//*number*/
kod_sud_x_n.name as kod_sud_x_n, /*Суд*//*string*/
qube.ur_hist_mat_count1 as ur_hist_mat_count, /*number*/
ur_mat.is_new as is_new, /*number*/
ur_mat.is_not_new as is_not_new, /*number*/
qube.ur_dp_exists_vld1 as ur_dp_exists_vld, /*Валидация (наличие привязанных документов)*//*string*/
ur_mat.kod_mat as kod_mat/*number*//*key*/

from (
--
select qube.kod_mat as kod_mat, /*number*//*key*/
sum(qube.ur_dp_sum_v1)  as ur_dp_priz_all1, /*Призн. по юр. док. всего*//*number*/
sum( case  when (kod_dogplat.vid_real = 2)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_osn1, /*Призн. по юр. док. осн. реал.*//*number*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_peni1, /*Призн. по юр. док. пени*//*number*/
sum( case  when (kod_dogplat.vid_real = 7)  then qube.ur_dp_summa1 end )  as ur_dp_sum_peni1, /*Выст. по юр. док. пени*//*number*/
max( case  when ((qube.ur_dp_has_no_priz1 &gt; 0) )  then 'Должны быть заполнены суммы по решению суда' end )  as ur_dp_priz_vld1, /*Валидация (наличие признанных сумм по решению)*//*string*/
sum( case  when (kod_dogplat.vid_real = 4)  then qube.ur_dp_sum_v2 end )  as ur_dp_priz_shtr1, /*Призн. по юр. док. штрафы*//*number*/
max( case  when ( nvl( qube.ur_hist_mat_gp_all1 ,0)  != nvl( qube.ur_mat_sum_gp1 ,0) )  then 'Сумма гос. пошлины по решению суда не соответствует сумме гос. пошлины оплаченной при подаче' end )  as ur_hist_mat_gp_vld1, /*string*/
sum(qube.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1, /*От ответчика*//*number*/
sum(qube.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1, /*Из бюджета*//*number*/
sum(qube.fin_ul_nach_astr1)  as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
max( case  when ( nvl( qube.fin_ul_nach_astr1 ,0)!=0 )  then 1 end )  as fin_ul_astr_exst1, /*Есть астрент (по начислениям)*//*number*/
sum(qube.ur_hist_mat_count1)  as ur_hist_mat_count1, /*number*/
max( case  when ( nvl( qube.ur_dogplat_count1 ,0)!=0 )  then 'Есть суммы по документу' end )  as ur_dp_exists_vld1/*Валидация (наличие привязанных документов)*//*string*/

from (
--
select qube.kod_mat as kod_mat, /*number*/
qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
qube.ur_dogplat_count1 as ur_dogplat_count1, /*number*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1, /*number*/
qube.ur_dp_sum_v2 as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select null as kod_dogplat, /*key*/
qube.kod_mat as kod_mat, /*number*/
qube.fin_ul_nach_astr1 as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
null as ur_dogplat_count1, /*number*/
null as ur_dp_has_no_priz1, /*number*/
null as ur_dp_sum_v2, /*number*/
null as ur_dp_sum_v1, /*number*/
null as ur_dp_summa1, /*number*/
qube.ur_gp_opl_info_npay_sum_b1 as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
qube.ur_gp_opl_info_npay_sum_r1 as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
qube.ur_hist_mat_count1 as ur_hist_mat_count1, /*number*/
qube.ur_hist_mat_gp_all1 as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
qube.ur_mat_sum_gp1 as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--
select un.kod_mat as kod_mat, /*number*//*key*/
sum(un.fin_ul_nach_astr1)  as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
sum(un.ur_gp_opl_info_npay_sum_b1)  as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
sum(un.ur_gp_opl_info_npay_sum_r1)  as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
sum(un.ur_hist_mat_count1)  as ur_hist_mat_count1, /*number*/
sum(un.ur_hist_mat_gp_all1)  as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
sum(un.ur_mat_sum_gp1)  as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
(
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from ( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n3 as kod_mat,t.n4 as kod_folders  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3 )
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select dims.kod_mat as kod_mat, /*number*//*key*/
sr_facras_astr.nachisl_astr as fin_ul_nach_astr1, /*Начислено астрент*//*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--
select sr_facras_astr_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
kod_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/

from (
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_ras as kod_ras_astr/*number*//*key*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr_a_d
--\sr_facras_astr
left outer join
(
--sr_facvip_astr
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf as kod_sf_astr/*number*//*key*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf_astr_a_d on sr_facras_astr_a_d.kod_sf = kod_sf_astr_a_d.kod_sf--\sr_facvip_astr
left outer join
(
--sr_penni_astr
select  nvl( kod_sf.kod_sf_first , kod_sf.kod_sf )  as kod_sf_astr, /*number*/
a.kod_delo as kod_delo/*number*/

from (
--sr_penni
select a.kod_pen as kod_pen, /*number*//*key*/
a.kod_sf as kod_sf, /*number*/
a.kod_delo as kod_delo/*number*/

from sr_penni
a
--\sr_penni
)
a
--\sr_penni
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.kod_sf_first as kod_sf_first/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
a.kod_delo is not null )
kod_pen_astr_a_d on kod_pen_astr_a_d.kod_sf_astr = kod_sf_astr_a_d.kod_sf--\sr_penni_astr
left outer join
(
--ur_mat_pp
select a.kod_mat as kod_mat, /*number*//*key*/
a.kod_mat as kod_mat_pp/*number*//*key*/

from (select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
a
--\(select a.kod_mat as kod_mat,a.kod_folders as kod_folders  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ))
left outer join
(
--ur_folders
select a.kod_folders as kod_folders, /*number*//*key*/
a.kod_sdp as kod_sdp/*number*/

from ur_folders
a
--\ur_folders
)
kod_folders on a.kod_folders = kod_folders.kod_folders--\ur_folders
where
kod_folders.kod_sdp = 1)
kod_mat_pp_a_d on kod_pen_astr_a_d.kod_delo = kod_mat_pp_a_d.kod_mat--\ur_mat_pp
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_mat_pp_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null  group by
sr_facras_astr_a_d.kod_ras, /*number*//*key*/
kod_mat_pp_a_d.kod_mat/*number*//*key*/
)
dims
--\
left outer join
(
--sr_facras_astr
select a.kod_ras as kod_ras, /*number*//*key*/
a.kod_ras as kod_ras_astr, /*number*//*key*/
a.nachisl as nachisl_astr/*Начислено астрент*//*number*/

from sr_facras
a
--\sr_facras
left outer join
(
--sr_facvip
select a.kod_sf as kod_sf, /*number*//*key*/
a.vid_sf as vid_sf/*number*/

from sr_facvip
a
--\sr_facvip
where
a.vid_sf not in (2 , 9) )
kod_sf on a.kod_sf = kod_sf.kod_sf--\sr_facvip
where
kod_sf.vid_sf not in (2 , 9) )
sr_facras_astr on sr_facras_astr.kod_ras = dims.kod_ras_prm--\sr_facras_astr
)
--\
union all
(
--
select ur_gp_opl_info_a_d.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
ur_gp_opl_info_a_d.npay_sum_b as ur_gp_opl_info_npay_sum_b1, /*Возврат из бюджета*/
ur_gp_opl_info_a_d.npay_sum_r as ur_gp_opl_info_npay_sum_r1, /*Оплата ответчиком*/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_gp_opl_info
select a.nrn as nrn, /*ID записи из КИСУ Парус*//*number*//*key*/
 case  when ((a.sfinoper = 'Приход')  and (a.svdoc_type = 'Справка') )  then a.npay_sum end  as npay_sum_b, /*Возврат из бюджета*/
 case  when ((a.sfinoper = 'Приход')  and (('СУД_РЕШ' = a.svdoc_type)  or ('П/Т' = a.svdoc_type) ) )  then a.npay_sum end  as npay_sum_r, /*Оплата ответчиком*/
a.kod_mat as kod_mat/*number*/

from ur_gp_opl_info
a
--\ur_gp_opl_info
)
ur_gp_opl_info_a_d
--\ur_gp_opl_info
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_gp_opl_info_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1, /*number*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from ( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
a
--\( select t.n2 as kod_hist_mat,t.n3 as kod_mat,t.n25 as gp_ret,t.n6 as gp_otv,t.n4 as gp_es  from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and t.f3!=3 )
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_hist_mat_a_d.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
ur_hist_mat_a_d.cnt as ur_hist_mat_count1, /*number*/
ur_hist_mat_a_d.gp_all as ur_hist_mat_gp_all1, /*Гос. пошлина, всего*//*number*/
null as ur_mat_sum_gp1/*number*/

from (
--ur_hist_mat
select a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 nvl( a.gp_ret ,0)  +nvl( a.gp_otv ,0)  +nvl( a.gp_es ,0)  as gp_all/*Гос. пошлина, всего*//*number*/

from (select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
a
--\(select a.kod_hist_mat as kod_hist_mat,a.kod_mat as kod_mat,a.gp_ret as gp_ret,a.gp_otv as gp_otv,a.gp_es as gp_es  from ur_hist_mat a where not exists (select * from rr_temp t where t.skod ='ur_hist_mat' and t.names=:form_id  and a.kod_hist_mat=t.f2 ))
)
ur_hist_mat_a_d
--\ur_hist_mat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_hist_mat_a_d.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
union all
(
--
select ur_mat.kod_mat as kod_mat, /*number*//*key*/
null as fin_ul_nach_astr1, /*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
ur_mat.sum_gp as ur_mat_sum_gp1/*Оплачено госпошлины при подаче*//*number*/

from (
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.sum_gp as sum_gp/*Оплачено госпошлины при подаче*//*number*/

from (select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.sum_gp as sum_gp  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.n9 as sum_gp  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat
--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
union all
(
--
select qube.kod_dogplat as kod_dogplat, /*number*//*key*/
qube.kod_mat as kod_mat, /*number*/
null as fin_ul_nach_astr1, /*number*/
qube.ur_dogplat_count1 as ur_dogplat_count1, /*number*/
qube.ur_dp_has_no_priz1 as ur_dp_has_no_priz1, /*number*/
qube.ur_dp_sum_v2 as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
null as ur_gp_opl_info_npay_sum_b1, /**/
null as ur_gp_opl_info_npay_sum_r1, /**/
null as ur_hist_mat_count1, /*number*/
null as ur_hist_mat_gp_all1, /*number*/
null as ur_mat_sum_gp1/*number*/

from (
--
select un.kod_dogplat as kod_dogplat, /*number*//*key*/
un.kod_mat as kod_mat, /*number*//*key*/
sum(un.ur_dogplat_count1)  as ur_dogplat_count1, /*number*/
max(un.ur_dp_has_no_priz1)  as ur_dp_has_no_priz1, /*number*/
sum(un.ur_dp_sum_v2)  as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
sum(un.ur_dp_summa1)  as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
(
(
--
select kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
kod_dogplat.kod_mat as kod_mat, /*number*/
kod_dogplat.cnt as ur_dogplat_count1, /*number*/
kod_dogplat.has_no_prizn as ur_dp_has_no_priz1, /*number*/
kod_dogplat.sum_v as ur_dp_sum_v2, /*Признано по юр. документу*//*number*/
kod_dogplat.sum_v as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
kod_dogplat.summa as ur_dp_summa1/*Выставленно по юр. документу*//*number*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.summa as summa, /*Выставленно по юр. документу*//*number*/
a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
a.kod_mat as kod_mat, /*number*/
1 as cnt, /*number*/
 case  when (a.sum_v is null )  then 1 end  as has_no_prizn/*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat
--\ur_dogplat
left outer join
(
--ur_mat
select a.kod_mat as kod_mat/*number*//*key*/

from (select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on kod_dogplat.kod_mat = ur_mat.kod_mat--\ur_mat
where
ur_mat.kod_mat is not null )
--\
)
--\
)
un
--\
 group by
un.kod_dogplat, /*number*//*key*/
un.kod_mat/*number*//*key*/
)
qube
--\
)
--\
)
--\
)
qube
--\
)
qube
--\
left outer join
(
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real/**//*number*/

from ur_dogplat
a
--\ur_dogplat
)
kod_dogplat on kod_dogplat.kod_dogplat = qube.kod_dogplat--\ur_dogplat
 group by
qube.kod_mat/*number*//*key*/
)
qube
--\
left outer join
(
--ur_mat
select a.kod_mat as kod_mat, /*number*//*key*/
a.num_delo as num_delo, /*Номер дела*//*string*/
a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
a.sum_gp as sum_gp, /*Оплачено госпошлины при подаче*//*number*/
a.kod_sud as kod_sud, /*number*/
a.astrent_exists as astrent_exists, /*Есть астрент (ручн. признак)*//*number*/
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_mat as kod_mat,a.num_delo as num_delo,a.dat_prin as dat_prin,a.sum_gp as sum_gp,a.kod_sud as kod_sud,a.astrent_exists as astrent_exists,0 as is_new,1 as is_not_new  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.s1 as num_delo,t.d2 as dat_prin,t.n9 as sum_gp,t.n10 as kod_sud,t.n31 as astrent_exists,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
a
--\(select a.kod_mat as kod_mat,a.num_delo as num_delo,a.dat_prin as dat_prin,a.sum_gp as sum_gp,a.kod_sud as kod_sud,a.astrent_exists as astrent_exists,0 as is_new,1 as is_not_new  from ur_mat a where not exists (select * from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and a.kod_mat=t.f2 ) and   a.kod_mat in :kod_mat_prm   union all  select t.n3 as kod_mat,t.s1 as num_delo,t.d2 as dat_prin,t.n9 as sum_gp,t.n10 as kod_sud,t.n31 as astrent_exists,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='ur_mat' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_mat_prm )
)
ur_mat on ur_mat.kod_mat = qube.kod_mat--\ur_mat
left outer join
(
--us_sud
select a.kod_sud as kod_sud, /*number*//*key*/
a.name as name/*Судебный участок*//*string*/

from us_sud
a
--\us_sud
)
kod_sud_x_n on ur_mat.kod_sud = kod_sud_x_n.kod_sud--\us_sud
--\
</query>
          </select>
          <procedure>
            <params />
          </procedure>
        </root>
      </single-row-refresh-cmd>
    </table>
    <table name="dp_gp" auto-refresh="" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" update-target="ur_dogplat" key="kod_dogplat" is-ms-upd="1" is-top="1" key-dimension="kod_dogplat">
      <select-text>
--
select dp_gp.kod_sf2 as kod_sf_gp, 
dp_gp.is_new as is_new, /*number*/
dp_gp.is_not_new as is_not_new, /*number*/
dp_gp.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real, /**//*number*/
a.prizn_konv as prizn_konv, /**//*number*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
0 as is_new, /*number*/
1 as is_not_new/*number*/

from ur_dogplat
a
--\ur_dogplat
)
dp_gp
--\ur_dogplat
where
(dp_gp.kod_mat = :p_kod )  and (dp_gp.vid_real = 9)  and (dp_gp.prizn_konv = 1) --\
</select-text>
      <columns>
        <column name="kod_sf_gp" table="dp_gp" type="number" title="" parname="kod_sf_gp" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_dogplat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_dogplat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select dp_gp.kod_sf2 as kod_sf_gp, 
dp_gp.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_gp
--\ur_dogplat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_new" table="dp_gp" type="number" title="" is-user-editable="1" />
        <column name="is_not_new" table="dp_gp" type="number" title="" is-user-editable="1" />
        <column name="kod_dogplat" table="dp_gp" type="number" title="" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_dogplat" temp-col-name="n1" />
      </columns>
      <insert-text>begin 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into ur_dogplat 
(kod_dogplat 
) 
 values  
(r.kod_dogplat 
) 
 returning  
kod_dogplat into :kod_dogplat; 
end loop; 
end; 
</insert-text>
      <delete-text>delete from ur_dogplat where kod_dogplat=:kod_dogplat</delete-text>
      <update-temp-text>begin 
delete from rr_temp 
where 
skod='dp_gp' 
and 
names=:form_id 
and 
f2=:kod_dogplat; 
if :row_state_id=1  then 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
) 
 values  
('dp_gp' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
); 
end loop; 
else 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
,a.kod 
,a.kod_deb 
,a.kod_sdp 
,a.dat_form 
,a.u_m 
,a.d_m 
,a.kod_sf 
,a.summa 
,a.vid_real 
,a.sum_v 
,a.kod_izv 
,a.dat_form_v 
,a.kod_dog 
,a.tep_el 
,a.ym 
,a.num_doc 
,a.dat_doc 
,a.dat_bzad 
,a.dat_mor 
,a.dat_priem 
,a.prizn_konv 
,a.kodp 
,a.kod_sogl 
,a.kod_pretenz 
,a.kod_mat 
,a.kod_inkasso 
,a.kod_kazn 
,a.kod_stage_bk 
,a.kod_likvid 
,a.kod_dead 
,a.kod_folders 
,a.kod_sf_dp 
,a.kod_deb_sf 
 
from ur_dogplat a  where kod_dogplat=:kod_dogplat) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
,n2 
,n8 
,n3 
,d1 
,s1 
,d2 
,n4 
,n7 
,n6 
,n9 
,n10 
,d3 
,n11 
,n12 
,n5 
,n13 
,d4 
,d5 
,d6 
,d7 
,n14 
,n15 
,n16 
,n17 
,n18 
,n19 
,n20 
,n21 
,n22 
,n23 
,n24 
,n25 
,n26 
) 
 values  
('dp_gp' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
,r.kod 
,r.kod_deb 
,r.kod_sdp 
,r.dat_form 
,r.u_m 
,r.d_m 
,r.kod_sf 
,r.summa 
,r.vid_real 
,r.sum_v 
,r.kod_izv 
,r.dat_form_v 
,r.kod_dog 
,r.tep_el 
,r.ym 
,r.num_doc 
,r.dat_doc 
,r.dat_bzad 
,r.dat_mor 
,r.dat_priem 
,r.prizn_konv 
,r.kodp 
,r.kod_sogl 
,r.kod_pretenz 
,r.kod_mat 
,r.kod_inkasso 
,r.kod_kazn 
,r.kod_stage_bk 
,r.kod_likvid 
,r.kod_dead 
,r.kod_folders 
,r.kod_sf_dp 
,r.kod_deb_sf 
); 
end loop; 
end if; 
end; 
</update-temp-text>
      <clear-temp-text>delete from rr_temp where skod='dp_gp' and names=:form_id</clear-temp-text>
      <update-text>begin
update ur_dogplat set  
(kod_dogplat 
) 
= 
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
where 
kod_dogplat=:kod_dogplat 
;
end;
</update-text>
      <scheme>
        <table name="ur_dogplat" as="dp_gp">
          <columns>
            <column name="kod_sf_gp" type="number" title="" visible="0" />
            <column name="is_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_not_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_dogplat" type="number" invisible-in-column-chooser="1" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
      <single-row-refresh-cmd>
        <root>
          <params>
            <param name="kod_dogplat_prm" type="number" column="" />
            <param name="form_id" type="number" column="" />
          </params>
          <select>
            <params>
              <param name="kod_dogplat_prm" type="number" column="" />
              <param name="form_id" type="number" column="" />
            </params>
            <query>
--
select dp_gp.kod_sf2 as kod_sf_gp, 
dp_gp.is_new as is_new, /*number*/
dp_gp.is_not_new as is_not_new, /*number*/
dp_gp.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_gp' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_gp
--\ur_dogplat
--\
</query>
          </select>
          <procedure>
            <params />
          </procedure>
        </root>
      </single-row-refresh-cmd>
    </table>
    <table name="dp_peni" auto-refresh="" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" update-target="ur_dogplat" key="kod_dogplat" is-ms-upd="1" is-top="1" key-dimension="kod_dogplat">
      <select-text>
--
select dp_peni.kod_sf2 as kod_sf_peni, 
dp_peni.is_new as is_new, /*number*/
dp_peni.is_not_new as is_not_new, /*number*/
dp_peni.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real, /**//*number*/
a.prizn_konv as prizn_konv, /**//*number*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
0 as is_new, /*number*/
1 as is_not_new/*number*/

from ur_dogplat
a
--\ur_dogplat
)
dp_peni
--\ur_dogplat
where
(dp_peni.kod_mat = :p_kod )  and (dp_peni.vid_real = 7)  and (dp_peni.prizn_konv = 1) --\
</select-text>
      <columns>
        <column name="kod_sf_peni" table="dp_peni" type="number" title="" parname="kod_sf_peni" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_dogplat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_dogplat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select dp_peni.kod_sf2 as kod_sf_peni, 
dp_peni.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_peni
--\ur_dogplat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_new" table="dp_peni" type="number" title="" is-user-editable="1" />
        <column name="is_not_new" table="dp_peni" type="number" title="" is-user-editable="1" />
        <column name="kod_dogplat" table="dp_peni" type="number" title="" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_dogplat" temp-col-name="n1" />
      </columns>
      <insert-text>begin 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into ur_dogplat 
(kod_dogplat 
) 
 values  
(r.kod_dogplat 
) 
 returning  
kod_dogplat into :kod_dogplat; 
end loop; 
end; 
</insert-text>
      <delete-text>delete from ur_dogplat where kod_dogplat=:kod_dogplat</delete-text>
      <update-temp-text>begin 
delete from rr_temp 
where 
skod='dp_peni' 
and 
names=:form_id 
and 
f2=:kod_dogplat; 
if :row_state_id=1  then 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
) 
 values  
('dp_peni' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
); 
end loop; 
else 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
,a.kod 
,a.kod_deb 
,a.kod_sdp 
,a.dat_form 
,a.u_m 
,a.d_m 
,a.kod_sf 
,a.summa 
,a.vid_real 
,a.sum_v 
,a.kod_izv 
,a.dat_form_v 
,a.kod_dog 
,a.tep_el 
,a.ym 
,a.num_doc 
,a.dat_doc 
,a.dat_bzad 
,a.dat_mor 
,a.dat_priem 
,a.prizn_konv 
,a.kodp 
,a.kod_sogl 
,a.kod_pretenz 
,a.kod_mat 
,a.kod_inkasso 
,a.kod_kazn 
,a.kod_stage_bk 
,a.kod_likvid 
,a.kod_dead 
,a.kod_folders 
,a.kod_sf_dp 
,a.kod_deb_sf 
 
from ur_dogplat a  where kod_dogplat=:kod_dogplat) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
,n2 
,n8 
,n3 
,d1 
,s1 
,d2 
,n4 
,n7 
,n6 
,n9 
,n10 
,d3 
,n11 
,n12 
,n5 
,n13 
,d4 
,d5 
,d6 
,d7 
,n14 
,n15 
,n16 
,n17 
,n18 
,n19 
,n20 
,n21 
,n22 
,n23 
,n24 
,n25 
,n26 
) 
 values  
('dp_peni' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
,r.kod 
,r.kod_deb 
,r.kod_sdp 
,r.dat_form 
,r.u_m 
,r.d_m 
,r.kod_sf 
,r.summa 
,r.vid_real 
,r.sum_v 
,r.kod_izv 
,r.dat_form_v 
,r.kod_dog 
,r.tep_el 
,r.ym 
,r.num_doc 
,r.dat_doc 
,r.dat_bzad 
,r.dat_mor 
,r.dat_priem 
,r.prizn_konv 
,r.kodp 
,r.kod_sogl 
,r.kod_pretenz 
,r.kod_mat 
,r.kod_inkasso 
,r.kod_kazn 
,r.kod_stage_bk 
,r.kod_likvid 
,r.kod_dead 
,r.kod_folders 
,r.kod_sf_dp 
,r.kod_deb_sf 
); 
end loop; 
end if; 
end; 
</update-temp-text>
      <clear-temp-text>delete from rr_temp where skod='dp_peni' and names=:form_id</clear-temp-text>
      <update-text>begin
update ur_dogplat set  
(kod_dogplat 
) 
= 
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
where 
kod_dogplat=:kod_dogplat 
;
end;
</update-text>
      <scheme>
        <table name="ur_dogplat" as="dp_peni">
          <columns>
            <column name="kod_sf_peni" type="number" title="" visible="0" />
            <column name="is_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_not_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_dogplat" type="number" invisible-in-column-chooser="1" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
      <single-row-refresh-cmd>
        <root>
          <params>
            <param name="kod_dogplat_prm" type="number" column="" />
            <param name="form_id" type="number" column="" />
          </params>
          <select>
            <params>
              <param name="kod_dogplat_prm" type="number" column="" />
              <param name="form_id" type="number" column="" />
            </params>
            <query>
--
select dp_peni.kod_sf2 as kod_sf_peni, 
dp_peni.is_new as is_new, /*number*/
dp_peni.is_not_new as is_not_new, /*number*/
dp_peni.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_peni' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_peni
--\ur_dogplat
--\
</query>
          </select>
          <procedure>
            <params />
          </procedure>
        </root>
      </single-row-refresh-cmd>
    </table>
    <table name="dp_shtraf" auto-refresh="" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" update-target="ur_dogplat" key="kod_dogplat" is-ms-upd="1" is-top="1" key-dimension="kod_dogplat">
      <select-text>
--
select dp_shtraf.kod_sf2 as kod_sf_shtraf, 
dp_shtraf.is_new as is_new, /*number*/
dp_shtraf.is_not_new as is_not_new, /*number*/
dp_shtraf.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
a.vid_real as vid_real, /**//*number*/
a.prizn_konv as prizn_konv, /**//*number*/
a.kod_mat as kod_mat, /*number*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
0 as is_new, /*number*/
1 as is_not_new/*number*/

from ur_dogplat
a
--\ur_dogplat
)
dp_shtraf
--\ur_dogplat
where
(dp_shtraf.kod_mat = :p_kod )  and (dp_shtraf.vid_real = 4)  and (dp_shtraf.prizn_konv = 1) --\
</select-text>
      <columns>
        <column name="kod_sf_shtraf" table="dp_shtraf" type="number" title="" parname="kod_sf_shtraf" ColumnVisible="0" is-refreshed="1">
          <value-refresh-cmd>
            <root>
              <params>
                <param name="kod_dogplat_prm" type="number" column="" />
                <param name="form_id" type="number" column="" />
              </params>
              <select>
                <params>
                  <param name="kod_dogplat_prm" type="number" column="" />
                  <param name="form_id" type="number" column="" />
                </params>
                <query>
--
select dp_shtraf.kod_sf2 as kod_sf_shtraf, 
dp_shtraf.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp  from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_shtraf
--\ur_dogplat
--\
</query>
              </select>
              <procedure>
                <params />
              </procedure>
            </root>
          </value-refresh-cmd>
        </column>
        <column name="is_new" table="dp_shtraf" type="number" title="" is-user-editable="1" />
        <column name="is_not_new" table="dp_shtraf" type="number" title="" is-user-editable="1" />
        <column name="kod_dogplat" table="dp_shtraf" type="number" title="" is-user-editable="1" is-updateable="1" is-updateable-ext="1" update-target="kod_dogplat" temp-col-name="n1" />
      </columns>
      <insert-text>begin 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into ur_dogplat 
(kod_dogplat 
) 
 values  
(r.kod_dogplat 
) 
 returning  
kod_dogplat into :kod_dogplat; 
end loop; 
end; 
</insert-text>
      <delete-text>delete from ur_dogplat where kod_dogplat=:kod_dogplat</delete-text>
      <update-temp-text>begin 
delete from rr_temp 
where 
skod='dp_shtraf' 
and 
names=:form_id 
and 
f2=:kod_dogplat; 
if :row_state_id=1  then 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
) 
 values  
('dp_shtraf' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
); 
end loop; 
else 
for r in  
 ( select  
:kod_dogplat as kod_dogplat 
,a.kod 
,a.kod_deb 
,a.kod_sdp 
,a.dat_form 
,a.u_m 
,a.d_m 
,a.kod_sf 
,a.summa 
,a.vid_real 
,a.sum_v 
,a.kod_izv 
,a.dat_form_v 
,a.kod_dog 
,a.tep_el 
,a.ym 
,a.num_doc 
,a.dat_doc 
,a.dat_bzad 
,a.dat_mor 
,a.dat_priem 
,a.prizn_konv 
,a.kodp 
,a.kod_sogl 
,a.kod_pretenz 
,a.kod_mat 
,a.kod_inkasso 
,a.kod_kazn 
,a.kod_stage_bk 
,a.kod_likvid 
,a.kod_dead 
,a.kod_folders 
,a.kod_sf_dp 
,a.kod_deb_sf 
 
from ur_dogplat a  where kod_dogplat=:kod_dogplat) 
 
loop 
insert into rr_temp 
(skod 
,names 
,f2 
,f3 
,n1 
,n2 
,n8 
,n3 
,d1 
,s1 
,d2 
,n4 
,n7 
,n6 
,n9 
,n10 
,d3 
,n11 
,n12 
,n5 
,n13 
,d4 
,d5 
,d6 
,d7 
,n14 
,n15 
,n16 
,n17 
,n18 
,n19 
,n20 
,n21 
,n22 
,n23 
,n24 
,n25 
,n26 
) 
 values  
('dp_shtraf' 
,:form_id 
,:kod_dogplat 
,:row_state_id 
,r.kod_dogplat 
,r.kod 
,r.kod_deb 
,r.kod_sdp 
,r.dat_form 
,r.u_m 
,r.d_m 
,r.kod_sf 
,r.summa 
,r.vid_real 
,r.sum_v 
,r.kod_izv 
,r.dat_form_v 
,r.kod_dog 
,r.tep_el 
,r.ym 
,r.num_doc 
,r.dat_doc 
,r.dat_bzad 
,r.dat_mor 
,r.dat_priem 
,r.prizn_konv 
,r.kodp 
,r.kod_sogl 
,r.kod_pretenz 
,r.kod_mat 
,r.kod_inkasso 
,r.kod_kazn 
,r.kod_stage_bk 
,r.kod_likvid 
,r.kod_dead 
,r.kod_folders 
,r.kod_sf_dp 
,r.kod_deb_sf 
); 
end loop; 
end if; 
end; 
</update-temp-text>
      <clear-temp-text>delete from rr_temp where skod='dp_shtraf' and names=:form_id</clear-temp-text>
      <update-text>begin
update ur_dogplat set  
(kod_dogplat 
) 
= 
 ( select  
:kod_dogplat as kod_dogplat 
 
from dual ) 
 
where 
kod_dogplat=:kod_dogplat 
;
end;
</update-text>
      <scheme>
        <table name="ur_dogplat" as="dp_shtraf">
          <columns>
            <column name="kod_sf_shtraf" type="number" title="" visible="0" />
            <column name="is_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="is_not_new" type="number" invisible-in-column-chooser="1" visible="0" />
            <column name="kod_dogplat" type="number" invisible-in-column-chooser="1" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
      <single-row-refresh-cmd>
        <root>
          <params>
            <param name="kod_dogplat_prm" type="number" column="" />
            <param name="form_id" type="number" column="" />
          </params>
          <select>
            <params>
              <param name="kod_dogplat_prm" type="number" column="" />
              <param name="form_id" type="number" column="" />
            </params>
            <query>
--
select dp_shtraf.kod_sf2 as kod_sf_shtraf, 
dp_shtraf.is_new as is_new, /*number*/
dp_shtraf.is_not_new as is_not_new, /*number*/
dp_shtraf.kod_dogplat as kod_dogplat/*number*//*key*/

from (
--ur_dogplat
select a.kod_dogplat as kod_dogplat, /*number*//*key*/
 nvl( a.kod_sf , a.kod_sf_dp )  as kod_sf2, 
a.is_new as is_new, /*number*/
a.is_not_new as is_not_new/*number*/

from (select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
a
--\(select a.kod_dogplat as kod_dogplat,a.kod_sf as kod_sf,a.kod_sf_dp as kod_sf_dp,0 as is_new,1 as is_not_new  from ur_dogplat a where not exists (select * from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and a.kod_dogplat=t.f2 ) and   a.kod_dogplat in :kod_dogplat_prm   union all  select t.n1 as kod_dogplat,t.n4 as kod_sf,t.n25 as kod_sf_dp,decode (f3,1,1,0) as is_new,decode (f3,1,0,1) as is_not_new  from rr_temp t where t.skod ='dp_shtraf' and t.names=:form_id  and t.f3!=3  and t.f2 in :kod_dogplat_prm )
)
dp_shtraf
--\ur_dogplat
--\
</query>
          </select>
          <procedure>
            <params />
          </procedure>
        </root>
      </single-row-refresh-cmd>
    </table>
    <table name="f10" auto-refresh="" async="" only-visible-refresh="" only-force-refresh="" ref-column="" multi-select-column="" multi-select-target="" update-target="is_customer10_flag" key="val" is-ms-upd="0" is-top="1">
      <select-text>
--
select f10.val as val/*number*/

from (
--is_customer10_flag
select  case  when (a.customer_id = 10)  then 1 else 0 end  as val/*number*/

from (
--rs_rep_sets
select a.customer_id as customer_id/**//*number*/

from rs_rep_sets
a
--\rs_rep_sets
)
a
--\rs_rep_sets
)
f10
--\is_customer10_flag
--\
</select-text>
      <columns>
        <column name="val" table="f10" type="number" title="" parname="f10" ColumnVisible="0" is-refreshed="1" />
      </columns>
      <scheme>
        <table name="is_customer10_flag" as="f10">
          <columns>
            <column name="val" type="number" title="" visible="0" />
          </columns>
          <viewcolumns />
        </table>
      </scheme>
    </table>
  </dataset>
</root>