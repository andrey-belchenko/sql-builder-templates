<?xml version="1.0" encoding="utf-8"?>
<root timestamp="20.08.2023 15:34:34">
  <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="." noname="1" used="1">
    <select>
      <column table="a" column="kod_sf" as="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./a/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
      <column table="a" column="nach_av_norm_v2" as="nach_av_norm" used="1" key="0" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./a/kod_dog" sourcecolumn="kod_dog" />
      <column table="a" column="nach_osn_norm_v2" as="nach_osn_norm" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
      <column table="a" column="kod_ur_state" as="kod_ur_state" used="1" key="0" type="number" title="Код юр. статуса" agg="max" />
      <column table="a" column="perc" as="perc" used="1" key="0" type="number" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
      <column table="a" column="nach_av_norm_v2" as="nach_av_norm_v2" used="1" key="0" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./a/kod_dog" sourcecolumn="kod_dog" />
      <column table="a" column="nach_osn_norm_v2" comment="Набор выражений с суффиксом v2 заведен для проверки новой версии алгоритма по заявке 67698. Сейчас не используются, алгоритм применен для основных выражений. Оставил этот набор на случай если понадобится организовать аналогичную проверку в будущем" as="nach_osn_norm_v2" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
      <column table="a" column="pfact_opl_used" as="pfact_opl_used" used="1" key="0" />
    </select>
    <from>
      <query name="sr_facvip_norm_av1" as="a" path="./a" used="1">
        <select>
          <column table="kod_sf" column="kod_sf" as="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./a/kod_sf" sourcecolumn="kod_sf" />
          <column table="vid_real" column="vid_real" as="vid_real" reference="sk_vid_real" refcol="vid_real" keypath=".vid_real" used="1" key="1" type="number" sourcetable="./a/vid_real" sourcecolumn="vid_real" />
          <column column="kod_ur_state1" table="qube" as="kod_ur_state" is-fact-use="1" used="1" key="0" type="number" title="Код юр. статуса" agg="max" />
          <call function="over" as="perc" type="number" pth="0" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc">
            <call function="sum" pth="0" type="aggregate">
              <text txtype="func"> sum( </text>
              <column column="sr_facvip_perc_sum1" table="qube" as="sr_facvip_perc_sum1" />
              <text txtype="func"> ) </text>
            </call>
            <text txtype="func"> over( </text>
            <call function="partition by" pth="0" type="partition">
              <text txtype="func"> partition by </text>
              <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
              <text txtype="func"> , </text>
              <column table="qube" column="ym_vozn" as="ym_vozn" />
            </call>
            <text txtype="func"> ) </text>
          </call>
          <call as="pfact_opl_used" type="" function="if" pth="" used="1" key="0">
            <text txtype="func"> case </text>
            <text txtype="func"> when </text>
            <call function="is null" pth="" type="bool">
              <call function="over" as="nach_av_cm" type="number" pth="0">
                <call function="sum" pth="0" type="aggregate">
                  <text txtype="func"> sum( </text>
                  <column column="fin_ul_nachisl_av1" as="nach_av" table="qube" is-fact-use="1" thissrc="nach_av" />
                  <text txtype="func"> ) </text>
                </call>
                <text txtype="func"> over( </text>
                <call function="partition by" pth="0" type="partition">
                  <text txtype="func"> partition by </text>
                  <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                  <text txtype="func"> , </text>
                  <column table="qube" column="ym_vozn" as="ym_vozn" />
                </call>
                <text txtype="func"> ) </text>
              </call>
              <text txtype="func"> is null </text>
            </call>
            <text txtype="func"> then </text>
            <column column="pfact_opl1" as="pfact_opl" table="qube" is-fact-use="1" thissrc="pfact_opl" />
            <text txtype="func"> else </text>
            <const>
              <text>0</text>
            </const>
            <text txtype="func"> end </text>
          </call>
          <call as="nach_av_norm_v2" type="" function="if" pth="" used="1" key="0" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./a/kod_dog" sourcecolumn="kod_dog">
            <text txtype="func"> case </text>
            <text txtype="func"> when </text>
            <call function="is null" pth="" type="bool">
              <call function="over" as="nach_av_cm" type="number" pth="0">
                <call function="sum" pth="0" type="aggregate">
                  <text txtype="func"> sum( </text>
                  <column column="fin_ul_nachisl_av1" as="nach_av" table="qube" is-fact-use="1" thissrc="nach_av" />
                  <text txtype="func"> ) </text>
                </call>
                <text txtype="func"> over( </text>
                <call function="partition by" pth="0" type="partition">
                  <text txtype="func"> partition by </text>
                  <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                  <text txtype="func"> , </text>
                  <column table="qube" column="ym_vozn" as="ym_vozn" />
                </call>
                <text txtype="func"> ) </text>
              </call>
              <text txtype="func"> is null </text>
            </call>
            <text txtype="func"> then </text>
            <column column="pfact_opl1" as="pfact_opl" table="qube" is-fact-use="1" thissrc="pfact_opl" />
            <text txtype="func"> else </text>
            <call function="greatest" as="" type="" pth="">
              <text txtype="func"> greatest( </text>
              <call function="smallest nvl" type="number" pth="">
                <text txtype="func"> least ( </text>
                <text txtype="func"> nvl( </text>
                <call function="if" as="nach_av_for_first_sf" type="number" pth="">
                  <text txtype="func"> case </text>
                  <text txtype="func"> when </text>
                  <call function="and" pth="" type="bool">
                    <call function="=1" pth="1" type="bool">
                      <text txtype="func"> nvl( </text>
                      <call function="row_number" type="number" as="pr_first_sf" pth="">
                        <text txtype="func"> row_number() over( </text>
                        <call function="partition by" pth="0" type="partition">
                          <text txtype="func"> partition by </text>
                          <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                          <text txtype="func"> , </text>
                          <column table="qube" column="ym_vozn" as="ym_vozn" />
                        </call>
                        <call function="order by 2" pth="0" type="order">
                          <text txtype="func"> order by </text>
                          <call function="nulls last" pth="0">
                            <call function="if" type="number" pth="">
                              <text txtype="func"> case </text>
                              <text txtype="func"> when </text>
                              <call function="=" pth="" type="bool">
                                <column table="kod_sf" column="ym" />
                                <text txtype="func"> = </text>
                                <column table="qube" column="ym_vozn" as="ym_vozn" />
                              </call>
                              <text txtype="func"> then </text>
                              <column table="kod_sf" column="kod_sf" as="kod_sf" thissrc="kod_sf" />
                              <text txtype="func"> end </text>
                            </call>
                            <text txtype="func"> nulls last </text>
                          </call>
                        </call>
                        <text txtype="func"> ) </text>
                      </call>
                      <text txtype="func"> ,0)=1 </text>
                    </call>
                    <text txtype="func"> and </text>
                    <call function="=" pth="" type="bool">
                      <column table="kod_sf" column="ym" />
                      <text txtype="func"> = </text>
                      <column table="qube" column="ym_vozn" as="ym_vozn" />
                    </call>
                  </call>
                  <text txtype="func"> then </text>
                  <call function="over" as="nach_av_cm" type="number" pth="0">
                    <call function="sum" pth="0" type="aggregate">
                      <text txtype="func"> sum( </text>
                      <column column="fin_ul_nachisl_av1" as="nach_av" table="qube" is-fact-use="1" thissrc="nach_av" />
                      <text txtype="func"> ) </text>
                    </call>
                    <text txtype="func"> over( </text>
                    <call function="partition by" pth="0" type="partition">
                      <text txtype="func"> partition by </text>
                      <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                      <text txtype="func"> , </text>
                      <column table="qube" column="ym_vozn" as="ym_vozn" />
                    </call>
                    <text txtype="func"> ) </text>
                  </call>
                  <text txtype="func"> end </text>
                </call>
                <text txtype="func"> , 0) </text>
                <text txtype="func"> , nvl( </text>
                <call function="over" as="nach_osn_cm" type="number" pth="0">
                  <call function="sum" pth="0" type="aggregate">
                    <text txtype="func"> sum( </text>
                    <call function="if" as="nach_osn_bez_per" type="number" pth="">
                      <text txtype="func"> case </text>
                      <text txtype="func"> when </text>
                      <call function="=" pth="" type="bool">
                        <column table="kod_sf" column="ym" />
                        <text txtype="func"> = </text>
                        <column table="qube" column="ym_vozn" as="ym_vozn" />
                      </call>
                      <text txtype="func"> then </text>
                      <column column="fin_ul_nachisl_osn_rm1" as="nach_osn" table="qube" is-fact-use="1" thissrc="nach_osn" />
                      <text txtype="func"> end </text>
                    </call>
                    <text txtype="func"> ) </text>
                  </call>
                  <text txtype="func"> over( </text>
                  <call function="partition by" pth="0" type="partition">
                    <text txtype="func"> partition by </text>
                    <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                    <text txtype="func"> , </text>
                    <column table="qube" column="ym_vozn" as="ym_vozn" />
                  </call>
                  <text txtype="func"> ) </text>
                </call>
                <text txtype="func"> , 0) </text>
                <text txtype="func"> ) </text>
              </call>
              <text txtype="func"> , </text>
              <const>
                <text>0</text>
              </const>
              <text txtype="func"> ) </text>
            </call>
            <text txtype="func"> end </text>
          </call>
          <call function="-nvl" as="nach_osn_norm_v2" pth="" type="number" used="1" key="0" title="Начислено" agg="sum" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">
            <text txtype="func"> nvl( </text>
            <column column="fin_ul_nachisl_osn_rm1" as="nach_osn" table="qube" is-fact-use="1" thissrc="nach_osn" />
            <text txtype="func"> ,0) </text>
            <text txtype="func"> -nvl( </text>
            <call as="nach_av_norm_v2" type="" function="if" pth="">
              <text txtype="func"> case </text>
              <text txtype="func"> when </text>
              <call function="is null" pth="" type="bool">
                <call function="over" as="nach_av_cm" type="number" pth="0">
                  <call function="sum" pth="0" type="aggregate">
                    <text txtype="func"> sum( </text>
                    <column column="fin_ul_nachisl_av1" as="nach_av" table="qube" is-fact-use="1" thissrc="nach_av" />
                    <text txtype="func"> ) </text>
                  </call>
                  <text txtype="func"> over( </text>
                  <call function="partition by" pth="0" type="partition">
                    <text txtype="func"> partition by </text>
                    <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                    <text txtype="func"> , </text>
                    <column table="qube" column="ym_vozn" as="ym_vozn" />
                  </call>
                  <text txtype="func"> ) </text>
                </call>
                <text txtype="func"> is null </text>
              </call>
              <text txtype="func"> then </text>
              <column column="pfact_opl1" as="pfact_opl" table="qube" is-fact-use="1" thissrc="pfact_opl" />
              <text txtype="func"> else </text>
              <call function="greatest" as="" type="" pth="">
                <text txtype="func"> greatest( </text>
                <call function="smallest nvl" type="number" pth="">
                  <text txtype="func"> least ( </text>
                  <text txtype="func"> nvl( </text>
                  <call function="if" as="nach_av_for_first_sf" type="number" pth="">
                    <text txtype="func"> case </text>
                    <text txtype="func"> when </text>
                    <call function="and" pth="" type="bool">
                      <call function="=1" pth="1" type="bool">
                        <text txtype="func"> nvl( </text>
                        <call function="row_number" type="number" as="pr_first_sf" pth="">
                          <text txtype="func"> row_number() over( </text>
                          <call function="partition by" pth="0" type="partition">
                            <text txtype="func"> partition by </text>
                            <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                            <text txtype="func"> , </text>
                            <column table="qube" column="ym_vozn" as="ym_vozn" />
                          </call>
                          <call function="order by 2" pth="0" type="order">
                            <text txtype="func"> order by </text>
                            <call function="nulls last" pth="0">
                              <call function="if" type="number" pth="">
                                <text txtype="func"> case </text>
                                <text txtype="func"> when </text>
                                <call function="=" pth="" type="bool">
                                  <column table="kod_sf" column="ym" />
                                  <text txtype="func"> = </text>
                                  <column table="qube" column="ym_vozn" as="ym_vozn" />
                                </call>
                                <text txtype="func"> then </text>
                                <column table="kod_sf" column="kod_sf" as="kod_sf" thissrc="kod_sf" />
                                <text txtype="func"> end </text>
                              </call>
                              <text txtype="func"> nulls last </text>
                            </call>
                          </call>
                          <text txtype="func"> ) </text>
                        </call>
                        <text txtype="func"> ,0)=1 </text>
                      </call>
                      <text txtype="func"> and </text>
                      <call function="=" pth="" type="bool">
                        <column table="kod_sf" column="ym" />
                        <text txtype="func"> = </text>
                        <column table="qube" column="ym_vozn" as="ym_vozn" />
                      </call>
                    </call>
                    <text txtype="func"> then </text>
                    <call function="over" as="nach_av_cm" type="number" pth="0">
                      <call function="sum" pth="0" type="aggregate">
                        <text txtype="func"> sum( </text>
                        <column column="fin_ul_nachisl_av1" as="nach_av" table="qube" is-fact-use="1" thissrc="nach_av" />
                        <text txtype="func"> ) </text>
                      </call>
                      <text txtype="func"> over( </text>
                      <call function="partition by" pth="0" type="partition">
                        <text txtype="func"> partition by </text>
                        <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                        <text txtype="func"> , </text>
                        <column table="qube" column="ym_vozn" as="ym_vozn" />
                      </call>
                      <text txtype="func"> ) </text>
                    </call>
                    <text txtype="func"> end </text>
                  </call>
                  <text txtype="func"> , 0) </text>
                  <text txtype="func"> , nvl( </text>
                  <call function="over" as="nach_osn_cm" type="number" pth="0">
                    <call function="sum" pth="0" type="aggregate">
                      <text txtype="func"> sum( </text>
                      <call function="if" as="nach_osn_bez_per" type="number" pth="">
                        <text txtype="func"> case </text>
                        <text txtype="func"> when </text>
                        <call function="=" pth="" type="bool">
                          <column table="kod_sf" column="ym" />
                          <text txtype="func"> = </text>
                          <column table="qube" column="ym_vozn" as="ym_vozn" />
                        </call>
                        <text txtype="func"> then </text>
                        <column column="fin_ul_nachisl_osn_rm1" as="nach_osn" table="qube" is-fact-use="1" thissrc="nach_osn" />
                        <text txtype="func"> end </text>
                      </call>
                      <text txtype="func"> ) </text>
                    </call>
                    <text txtype="func"> over( </text>
                    <call function="partition by" pth="0" type="partition">
                      <text txtype="func"> partition by </text>
                      <column table="kod_dog" column="kod_dog" as="kod_dog" thissrc="kod_dog" />
                      <text txtype="func"> , </text>
                      <column table="qube" column="ym_vozn" as="ym_vozn" />
                    </call>
                    <text txtype="func"> ) </text>
                  </call>
                  <text txtype="func"> , 0) </text>
                  <text txtype="func"> ) </text>
                </call>
                <text txtype="func"> , </text>
                <const>
                  <text>0</text>
                </const>
                <text txtype="func"> ) </text>
              </call>
              <text txtype="func"> end </text>
            </call>
            <text txtype="func"> ,0) </text>
          </call>
        </select>
        <from>
          <query haskeys="1" as="qube" path="./a/qube" used="1">
            <select>
              <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
              <column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
              <column table="qube" column="vid_real" group="1" as="vid_real" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
              <column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
              <call function="if" type="number" as="fin_ul_nachisl_av1" title="Начислено (аванс)" key="0" group="sum" pth="" used="1" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">
                <text txtype="func"> case </text>
                <text txtype="func"> when </text>
                <call function="in" pth="" type="bool">
                  <column table="vid_real" column="vid_real" />
                  <text txtype="func"> in </text>
                  <call function="array" pth="">
                    <const>
                      <text>0</text>
                    </const>
                  </call>
                </call>
                <text txtype="func"> then </text>
                <column table="qube" column="sr_facras_nachisl1" />
                <text txtype="func"> end </text>
              </call>
              <call function="if" type="number" as="fin_ul_nachisl_osn_rm1" key="0" group="sum" pth="" used="1" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">
                <text txtype="func"> case </text>
                <text txtype="func"> when </text>
                <call function="in" pth="" type="bool">
                  <column table="vid_real" column="vid_real" />
                  <text txtype="func"> in </text>
                  <call function="array" pth="">
                    <const>
                      <text>2</text>
                    </const>
                    <text txtype="func"> , </text>
                    <const>
                      <text>3</text>
                    </const>
                  </call>
                </call>
                <text txtype="func"> then </text>
                <column table="qube" column="sr_facras_nachisl2" />
                <text txtype="func"> end </text>
              </call>
              <call function="greatest_num" as="kod_ur_state1" type="number" title="Код юр. статуса" key="0" group="max" pth="" used="1" agg="max">
                <text txtype="func"> nullif(greatest ( </text>
                <text txtype="func"> nvl( </text>
                <column table="qube" column="kod_ur_state_51" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> , nvl( </text>
                <column table="qube" column="kod_ur_state_61" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> , nvl( </text>
                <column table="qube" column="kod_ur_state_41" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> , nvl( </text>
                <column table="qube" column="kod_ur_state_31" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> , nvl( </text>
                <column table="qube" column="kod_ur_state_21" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> , nvl( </text>
                <column table="qube" column="kod_ur_state_11" />
                <text txtype="func"> , -99999999999999999999999999999999999999) </text>
                <text txtype="func"> ), -99999999999999999999999999999999999999) </text>
              </call>
              <column table="qube" column="sr_facvip_perc_sum1" as="sr_facvip_perc_sum1" group="sum" key="0" used="1" type="number" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
              <call function="if" type="number" as="pfact_opl1" key="0" group="sum" pth="" used="1" title="Оплата начислений" agg="sum">
                <text txtype="func"> case </text>
                <text txtype="func"> when </text>
                <call function="in" pth="" type="bool">
                  <column table="kod_type_opl" column="kod_type_opl" />
                  <text txtype="func"> in </text>
                  <call function="array" pth="">
                    <const>
                      <text>3</text>
                    </const>
                  </call>
                </call>
                <text txtype="func"> then </text>
                <column table="qube" column="sr_opl_opl_sf1" />
                <text txtype="func"> end </text>
              </call>
            </select>
            <from>
              <query as="qube" path="./a/qube/qube" used="1">
                <select>
                  <column table="qube" column="kod_dog" as="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                  <column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                  <column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                  <column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                  <column table="qube" column="kod_type_opl" as="kod_type_opl" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_type_opl" />
                  <column table="qube" column="kod_ur_state_11" as="kod_ur_state_11" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="kod_ur_state_21" as="kod_ur_state_21" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="kod_ur_state_31" as="kod_ur_state_31" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="kod_ur_state_41" as="kod_ur_state_41" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="kod_ur_state_51" as="kod_ur_state_51" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="kod_ur_state_61" as="kod_ur_state_61" used="1" key="0" type="number" agg="max" />
                  <column table="qube" column="sr_facras_nachisl2" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                  <column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                  <column table="qube" column="sr_facvip_perc_sum1" as="sr_facvip_perc_sum1" used="1" key="0" type="number" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
                  <column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" />
                </select>
                <from>
                  <query as="qube" path="./a/qube/qube/qube" used="1">
                    <query path="./a/qube/qube/qube" used="1">
                      <query as="qube" union="1" path="./a/qube/qube/qube/qube" used="1">
                        <select>
                          <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                          <column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                          <const as="kod_type_opl" used="1" key="0">
                            <text>null</text>
                          </const>
                          <column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                          <column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                          <column table="qube" column="kod_ur_state_11" as="kod_ur_state_11" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="kod_ur_state_21" as="kod_ur_state_21" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="kod_ur_state_31" as="kod_ur_state_31" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="kod_ur_state_41" as="kod_ur_state_41" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="kod_ur_state_51" as="kod_ur_state_51" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="kod_ur_state_61" as="kod_ur_state_61" used="1" key="0" type="number" agg="max" />
                          <column table="qube" column="sr_facras_nachisl2" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                          <const type="number" as="sr_facras_nachisl1" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_facvip_perc_sum1" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_opl_opl_sf1" used="1" key="0">
                            <text>null</text>
                          </const>
                        </select>
                        <from>
                          <query as="qube" path="./a/qube/qube/qube/qube/qube" used="1">
                            <select>
                              <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                              <column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                              <column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                              <column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                              <column table="un" column="sr_facras_nachisl2" group="sum" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                              <column table="un" column="kod_ur_state_61" group="max" as="kod_ur_state_61" used="1" key="0" type="number" agg="max" />
                              <column table="un" column="kod_ur_state_21" group="max" as="kod_ur_state_21" used="1" key="0" type="number" agg="max" />
                              <column table="un" column="kod_ur_state_41" group="max" as="kod_ur_state_41" used="1" key="0" type="number" agg="max" />
                              <column table="un" column="kod_ur_state_51" group="max" as="kod_ur_state_51" used="1" key="0" type="number" agg="max" />
                              <column table="un" column="kod_ur_state_31" group="max" as="kod_ur_state_31" used="1" key="0" type="number" agg="max" />
                              <column table="un" column="kod_ur_state_11" group="max" as="kod_ur_state_11" used="1" key="0" type="number" agg="max" />
                            </select>
                            <from>
                              <query as="un" path="./a/qube/qube/qube/qube/qube/un" used="1">
                                <query path="./a/qube/qube/qube/qube/qube/un" used="1">
                                  <query dimension="kod_ras" multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                                      <column table="sr_facras_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                                      <column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <column table="sr_facras_a_d" column="nachisl" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_ras" used="1" />
                                          <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" used="1" />
                                        </select>
                                        <from>
                                          <table name="sr_facras" as="a" dimension="kod_ras" used="1" />
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="kod_sf" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1" />
                                          <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1" />
                                          <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="=" pth="" type="bool">
                                              <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                              <text txtype="func"> = </text>
                                              <const>
                                                <text>0</text>
                                              </const>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                            <text txtype="func"> else </text>
                                            <call function="nvl" pth="">
                                              <text txtype="func"> nvl( </text>
                                              <column table="kod_sf_old_neg" column="ym" />
                                              <text txtype="func"> , </text>
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                              <text txtype="func"> ) </text>
                                            </call>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                          <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                            <select>
                                              <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                              <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_dop" as="st" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_dop" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_rec_info" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" used="1" />
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_old_neg" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="a" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="sr_facras_a_d" column="kod_sf" />
                                          <text txtype="func"> = </text>
                                          <column table="kod_sf" column="kod_sf" />
                                        </call>
                                      </query>
                                      <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/vid_real" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/vid_real" sourcecolumn="vid_real" used="1" />
                                        </select>
                                        <from>
                                          <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="kod_sf" column="vid_real" />
                                          <text txtype="func"> = </text>
                                          <column table="vid_real" column="vid_real" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                    <where>
                                      <call function="in" pth="" type="bool">
                                        <column table="vid_real" column="vid_real" />
                                        <text txtype="func"> in </text>
                                        <call function="array" pth="">
                                          <const>
                                            <text>2</text>
                                          </const>
                                          <text txtype="func"> , </text>
                                          <const>
                                            <text>3</text>
                                          </const>
                                        </call>
                                      </call>
                                    </where>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_hist_mat_ba" column="kod_ur_state" as="kod_ur_state_61" used="1" key="0" type="number" agg="max" />
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_hist_mat_ba_a_d" column="kod_hist_mat" as="kod_hist_mat_prm" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d" sourcecolumn="kod_hist_mat" />
                                          <column table="kod_dogplat_bnk_a_d" column="kod_dog_bnk" as="kod_dog" group="1" used="1" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_bnk_a_d" column="vid_real_bnk" as="vid_real" group="1" used="1" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_hist_mat_ba" dimension="kod_hist_mat_ba" as="ur_hist_mat_ba_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d" sourcecolumn="kod_hist_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_ba" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d" sourcecolumn="kod_hist_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_ba" used="1" />
                                              <query name="ur_mat_ba" as="kod_mat_ba1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1" sourcecolumn="kod_mat" used="1" />
                                                  <column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_ba" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1" sourcecolumn="kod_mat" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1" />
                                                  <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1/kod_folders" haskeys="1" used="1">
                                                    <select>
                                                      <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                      <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_mat_ba1/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                    </select>
                                                    <from>
                                                      <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                    </from>
                                                    <call function="=" type="bool">
                                                      <column table="a" column="kod_folders" />
                                                      <text txtype="func"> = </text>
                                                      <column table="kod_folders" column="kod_folders" />
                                                    </call>
                                                  </query>
                                                </from>
                                                <where>
                                                  <call function="=" pth="" type="bool">
                                                    <column table="kod_folders" column="kod_sdp" />
                                                    <text txtype="func"> = </text>
                                                    <const>
                                                      <text>9</text>
                                                    </const>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_mat" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_mat_ba1" column="kod_mat_ba" />
                                                </call>
                                              </query>
                                              <query name="ur_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_ba_a_d/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="kod_mat_ba1" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>9</text>
                                                </const>
                                              </call>
                                            </where>
                                          </query>
                                          <query name="ur_mat_ba" dimension="kod_mat_ba" as="kod_mat_ba_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_ba" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d" sourcecolumn="kod_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_ba" used="1" />
                                              <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_ba_a_d/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>9</text>
                                                </const>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="ur_hist_mat_ba_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_mat_ba_a_d" column="kod_mat_ba" />
                                            </call>
                                          </query>
                                          <query name="ur_dogplat_bnk" dimension="kod_dogplat_bnk" as="kod_dogplat_bnk_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_dog" is-final-dimension="1" dimension="kod_dog" is-private-dimension="1" as="kod_dog_bnk" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="vid_real" is-final-dimension="1" dimension="vid_real" is-private-dimension="1" as="vid_real_bnk" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_bnk_a_d" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat_bnk" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_bnk_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_mat_ba_a_d" column="kod_mat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf2_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf2_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf2_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf2_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_bnk_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf2_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf2_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_bnk_a_d" column="vid_real_bnk" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_hist_mat_ba" dimension="kod_hist_mat_ba" as="ur_hist_mat_ba" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba" sourcecolumn="kod_hist_mat" used="1" />
                                          <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_ba" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba" sourcecolumn="kod_hist_mat" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_mor" type="date" comment="признать зад-ть мораторной с..." title="Признать задолженность мораторной с" as="dat_mor" key="0" thissrc="dat_mor" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>6</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_ba" used="1" />
                                          <query name="ur_mat_ba" as="kod_mat_ba1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1" sourcecolumn="kod_folders" used="1" />
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_ba" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1" sourcecolumn="kod_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1" />
                                              <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_mat_ba1/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>9</text>
                                                </const>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_mat_ba1" column="kod_mat_ba" />
                                            </call>
                                          </query>
                                          <query name="ur_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_folders" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_folders" sourcecolumn="kod_folders" used="1" />
                                              <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_ba/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_folders" as="a" title="Папка" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_mat_ba1" column="kod_folders" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_folders" column="kod_folders" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="=" pth="" type="bool">
                                            <column table="kod_folders" column="kod_sdp" />
                                            <text txtype="func"> = </text>
                                            <const>
                                              <text>9</text>
                                            </const>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="ur_hist_mat_ba" column="kod_hist_mat" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_hist_mat_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_hist_mat_dec" column="kod_ur_state" as="kod_ur_state_21" used="1" key="0" type="number" agg="max" />
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_hist_mat_dec_a_d" column="kod_hist_mat" as="kod_hist_mat_prm" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d" sourcecolumn="kod_hist_mat" />
                                          <column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_a_d" column="vid_real" as="vid_real" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="ur_hist_mat_dec_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d" sourcecolumn="kod_hist_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d" sourcecolumn="kod_hist_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1" />
                                              <query name="us_result" as="kod_result" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d/kod_result" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d/kod_result" sourcecolumn="kod_result" used="1" />
                                                  <column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_hist_mat_dec_a_d/kod_result" sourcecolumn="decision" used="1" />
                                                </select>
                                                <from>
                                                  <table name="us_result" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_result" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_result" column="kod_result" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_result" column="decision" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>1</text>
                                                </const>
                                              </call>
                                            </where>
                                          </query>
                                          <query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1" />
                                              <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>1</text>
                                                </const>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="ur_hist_mat_dec_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_mat_pp_a_d" column="kod_mat" />
                                            </call>
                                          </query>
                                          <query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" used="1" />
                                              <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_mat_pp_a_d" column="kod_mat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf1_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf1_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="vid_real" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="ur_hist_mat_dec" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1" />
                                          <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_entry" type="date" title="Дата вст. реш. в зак. силу" comment="дата вступления решения в законную силу,  Емцов - поменял условие валидации по 38755" valid="dat_entry_vld" as="dat_entry" key="0" thissrc="dat_entry" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>2</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1" />
                                          <query name="us_result" as="kod_result" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1" />
                                              <column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" sourcecolumn="decision" used="1" />
                                            </select>
                                            <from>
                                              <table name="us_result" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_result" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_result" column="kod_result" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="=" pth="" type="bool">
                                            <column table="kod_result" column="decision" />
                                            <text txtype="func"> = </text>
                                            <const>
                                              <text>1</text>
                                            </const>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="ur_hist_mat_dec" column="kod_hist_mat" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_hist_mat_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_inkasso" column="kod_ur_state" as="kod_ur_state_41" used="1" key="0" type="number" agg="max" />
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_inkasso_a_d" column="kod_inkasso" as="kod_inkasso_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_inkasso" />
                                          <column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_a_d" column="vid_real" as="vid_real" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_inkasso" dimension="kod_inkasso" as="ur_inkasso_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_inkasso" type="number" key-dimension="kod_inkasso" is-fact="1" agg="max" as="kod_inkasso" fact="ur_inkasso_kod_inkasso" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_inkasso" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_inkasso" as="a" dimension="kod_inkasso" used="1" />
                                            </from>
                                          </query>
                                          <query name="ur_dp_inkasso" dimension="kod_dp_inkasso" as="kod_dp_inkasso_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" haskeys="1" used="1">
                                            <select>
                                              <column column="kod_dp_inkasso" table="a" type="number" as="kod_dp_inkasso" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_dp_inkasso" used="1" />
                                              <column table="a" column="kod_inkasso" type="number" as="kod_inkasso" reference="ur_inkasso" refcol="kod_inkasso" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_inkasso" used="1" />
                                              <column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_dogplat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dp_inkasso" as="a" table-code="1885" dimension="kod_dp_inkasso" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_inkasso_a_d" column="kod_inkasso" />
                                              <text txtype="func"> = </text>
                                              <column table="ur_inkasso_a_d" column="kod_inkasso" />
                                            </call>
                                          </query>
                                          <query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" used="1" />
                                              <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_inkasso_a_d" column="kod_dogplat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_dogplat_a_d" column="kod_dogplat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf1_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf1_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="vid_real" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_inkasso" dimension="kod_inkasso" as="ur_inkasso" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_inkasso" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_inkasso" type="number" key-dimension="kod_inkasso" is-fact="1" agg="max" as="kod_inkasso" fact="ur_inkasso_kod_inkasso" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="kod_inkasso" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_doc" type="date" title="Дата документа на инкассо" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc" key="0" thissrc="dat_doc" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>4</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_inkasso" as="a" dimension="kod_inkasso" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="ur_inkasso" column="kod_inkasso" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_inkasso_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_kazn" column="kod_ur_state" as="kod_ur_state_51" used="1" key="0" type="number" agg="max" />
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_kazn_a_d" column="kod_kazn" as="kod_kazn_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_kazn" />
                                          <column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_a_d" column="vid_real" as="vid_real" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_kazn" dimension="kod_kazn" as="ur_kazn_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_kazn" type="number" key-dimension="kod_kazn" is-fact="1" agg="max" as="kod_kazn" fact="ur_kazn_kod_kazn" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_kazn" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_kazn" as="a" dimension="kod_kazn" used="1" />
                                            </from>
                                          </query>
                                          <query name="ur_dp_kazn" dimension="kod_dp_kazn" as="kod_dp_kazn_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" haskeys="1" used="1">
                                            <select>
                                              <column column="kod_dp_kazn" table="a" type="number" as="kod_dp_kazn" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_dp_kazn" used="1" />
                                              <column table="a" column="kod_kazn" type="number" as="kod_kazn" reference="ur_kazn" refcol="kod_kazn" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_kazn" used="1" />
                                              <column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_dogplat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dp_kazn" as="a" table-code="1886" dimension="kod_dp_kazn" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_kazn_a_d" column="kod_kazn" />
                                              <text txtype="func"> = </text>
                                              <column table="ur_kazn_a_d" column="kod_kazn" />
                                            </call>
                                          </query>
                                          <query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" used="1" />
                                              <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_kazn_a_d" column="kod_dogplat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_dogplat_a_d" column="kod_dogplat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf1_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf1_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="vid_real" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_kazn" dimension="kod_kazn" as="ur_kazn" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_kazn" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_kazn" type="number" key-dimension="kod_kazn" is-fact="1" agg="max" as="kod_kazn" fact="ur_kazn_kod_kazn" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="kod_kazn" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_doc" type="date" title="Дата документа в казначействе" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc" key="0" thissrc="dat_doc" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>5</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_kazn" as="a" dimension="kod_kazn" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="ur_kazn" column="kod_kazn" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_kazn_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_mat_isp" column="kod_ur_state" as="kod_ur_state_31" used="1" key="0" type="number" agg="max" />
                                      <const type="number" as="kod_ur_state_11" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_mat_isp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat" />
                                          <column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_a_d" column="vid_real" as="vid_real" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_mat_isp" dimension="kod_mat_isp" as="ur_mat_isp_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_isp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_isp" used="1" />
                                              <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>2</text>
                                                </const>
                                              </call>
                                            </where>
                                          </query>
                                          <query name="ur_dp_isp" dimension="kod_dp_isp" as="kod_dp_isp_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" haskeys="1" used="1">
                                            <select>
                                              <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_dp_isp" used="1" />
                                              <column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_dogplat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dp_isp" as="a" table-code="1836" dimension="kod_dp_isp" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_isp_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="ur_mat_isp_a_d" column="kod_mat" />
                                            </call>
                                          </query>
                                          <query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" used="1" />
                                              <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dp_isp_a_d" column="kod_dogplat" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_dogplat_a_d" column="kod_dogplat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf1_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf1_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="vid_real" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_mat_isp" dimension="kod_mat_isp" as="ur_mat_isp" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="kod_mat" used="1" />
                                          <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_isp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="kod_mat" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" thissrc="dat_doc" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>3</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_isp" used="1" />
                                          <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" sourcecolumn="kod_folders" used="1" />
                                              <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_folders" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_folders" column="kod_folders" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="=" pth="" type="bool">
                                            <column table="kod_folders" column="kod_sdp" />
                                            <text txtype="func"> = </text>
                                            <const>
                                              <text>2</text>
                                            </const>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="ur_mat_isp" column="kod_mat" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_mat_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                  <query multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                      <column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                      <column table="dims" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_61" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_21" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_41" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_51" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <const type="number" as="kod_ur_state_31" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="ur_mat_pp" column="kod_ur_state" as="kod_ur_state_11" used="1" key="0" type="number" agg="max" />
                                    </select>
                                    <from>
                                      <query as="dims" path="./a/qube/qube/qube/qube/qube/un/un/dims" used="1">
                                        <select>
                                          <column table="ur_mat_pp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat" />
                                          <column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" />
                                          <column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" />
                                          <column table="kod_dogplat_a_d" column="vid_real" as="vid_real" group="1" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                          <column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <query name="ur_mat_pp" dimension="kod_mat_pp" as="ur_mat_pp_a_d" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1" />
                                              <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1" />
                                                  <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                                </select>
                                                <from>
                                                  <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_folders" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_folders" column="kod_folders" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="=" pth="" type="bool">
                                                <column table="kod_folders" column="kod_sdp" />
                                                <text txtype="func"> = </text>
                                                <const>
                                                  <text>1</text>
                                                </const>
                                              </call>
                                            </where>
                                          </query>
                                          <query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1" />
                                              <column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="vid_real" used="1" />
                                              <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1" />
                                              <column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1" />
                                              <column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_mat" />
                                              <text txtype="func"> = </text>
                                              <column table="ur_mat_pp_a_d" column="kod_mat" />
                                            </call>
                                          </query>
                                          <query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1" />
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_all_deb_sf" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="kod_deb_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_deb_sf1_a_d1" column="kod_deb_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_deb_sf1_a_d1" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/dims/vid_real" sourcecolumn="vid_real" used="1" />
                                            </select>
                                            <from>
                                              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="kod_dogplat_a_d" column="vid_real" />
                                              <text txtype="func"> = </text>
                                              <column table="vid_real" column="vid_real" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="vid_real" column="vid_real" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="ur_mat_pp" dimension="kod_mat_pp" as="ur_mat_pp" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp" sourcecolumn="kod_mat" used="1" />
                                          <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp" sourcecolumn="kod_mat" used="1" />
                                          <call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="is not null" pth="" type="bool">
                                              <column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" thissrc="dat_doc" />
                                              <text txtype="func"> is not null </text>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <const>
                                              <text>1</text>
                                            </const>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1" />
                                          <query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" sourcecolumn="kod_folders" used="1" />
                                              <column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" sourcecolumn="kod_sdp" used="1" />
                                            </select>
                                            <from>
                                              <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_folders" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_folders" column="kod_folders" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="=" pth="" type="bool">
                                            <column table="kod_folders" column="kod_sdp" />
                                            <text txtype="func"> = </text>
                                            <const>
                                              <text>1</text>
                                            </const>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="ur_mat_pp" column="kod_mat" />
                                          <text txtype="func"> = </text>
                                          <column table="dims" column="kod_mat_prm" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                  </query>
                                </query>
                              </query>
                            </from>
                          </query>
                        </from>
                      </query>
                      <query as="qube" union="1" path="./a/qube/qube/qube/qube" used="1">
                        <select>
                          <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="kod_dog" />
                          <const as="kod_sf" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const as="kod_type_opl" used="1" key="0">
                            <text>null</text>
                          </const>
                          <column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                          <column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="ym" />
                          <const type="number" as="kod_ur_state_11" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_21" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_31" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_41" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_51" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_61" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                            <text>null</text>
                          </const>
                          <column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                          <column table="qube" column="sr_facvip_perc_sum1" as="sr_facvip_perc_sum1" used="1" key="0" type="number" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
                          <const type="number" as="sr_opl_opl_sf1" used="1" key="0">
                            <text>null</text>
                          </const>
                        </select>
                        <from>
                          <query as="qube" path="./a/qube/qube/qube/qube/qube" used="1">
                            <select>
                              <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="kod_dog" />
                              <column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                              <column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="ym" />
                              <column table="un" column="sr_facras_nachisl1" group="sum" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                              <column table="un" column="sr_facvip_perc_sum1" group="sum" as="sr_facvip_perc_sum1" used="1" key="0" type="number" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
                            </select>
                            <from>
                              <query as="un" path="./a/qube/qube/qube/qube/qube/un" used="1">
                                <query path="./a/qube/qube/qube/qube/qube/un" used="1">
                                  <query dimension="kod_ras" multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="kod_sf_a_d" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="kod_dog" />
                                      <column table="kod_sf_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="kod_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="ym" />
                                      <column table="sr_facras_a_d" column="nachisl" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" />
                                      <const type="number" as="sr_facvip_perc_sum1" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                    </select>
                                    <from>
                                      <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_ras" used="1" />
                                          <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" used="1" />
                                        </select>
                                        <from>
                                          <table name="sr_facras" as="a" dimension="kod_ras" used="1" />
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1" />
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="kod_sf" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="sr_facvip" dimension="kod_sf" as="kod_sf_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="kod_dog" used="1" />
                                          <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d" sourcecolumn="vid_real" used="1" />
                                          <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="ym">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="=" pth="" type="bool">
                                              <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                              <text txtype="func"> = </text>
                                              <const>
                                                <text>0</text>
                                              </const>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                            <text txtype="func"> else </text>
                                            <call function="nvl" pth="">
                                              <text txtype="func"> nvl( </text>
                                              <column table="kod_sf_old_neg" column="ym" />
                                              <text txtype="func"> , </text>
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                              <text txtype="func"> ) </text>
                                            </call>
                                            <text txtype="func"> end </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                          <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                            <select>
                                              <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                              <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_dop" sourcecolumn="rym" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_dop" as="st" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_dop" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_rec_info" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_rec_info" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf_a_d/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" used="1" />
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_old_neg" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="a" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="sr_facras_a_d" column="kod_sf" />
                                          <text txtype="func"> = </text>
                                          <column table="kod_sf_a_d" column="kod_sf" />
                                        </call>
                                      </query>
                                      <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/vid_real" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/vid_real" sourcecolumn="vid_real" used="1" />
                                        </select>
                                        <from>
                                          <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="kod_sf_a_d" column="vid_real" />
                                          <text txtype="func"> = </text>
                                          <column table="vid_real" column="vid_real" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>0</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                    <where>
                                      <call function="in" pth="" type="bool">
                                        <column table="vid_real" column="vid_real" />
                                        <text txtype="func"> in </text>
                                        <call function="array" pth="">
                                          <const>
                                            <text>0</text>
                                          </const>
                                        </call>
                                      </call>
                                    </where>
                                  </query>
                                  <query dimension="kod_sf" multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="sr_facvip_a_d" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" sourcecolumn="kod_dog" />
                                      <column table="sr_facvip_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="sr_facvip_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_old_neg" sourcecolumn="ym" />
                                      <const type="number" as="sr_facras_nachisl1" used="1" key="0">
                                        <text>null</text>
                                      </const>
                                      <column table="sr_facvip_a_d" column="perc" as="sr_facvip_perc_sum1" used="1" key="0" type="number" agg="sum" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" />
                                    </select>
                                    <from>
                                      <query name="sr_facvip" dimension="kod_sf" as="sr_facvip_a_d" path="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" sourcecolumn="kod_dog" used="1" />
                                          <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d" sourcecolumn="vid_real" used="1" />
                                          <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_old_neg" sourcecolumn="ym">
                                            <text txtype="func"> case </text>
                                            <text txtype="func"> when </text>
                                            <call function="=" pth="" type="bool">
                                              <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                              <text txtype="func"> = </text>
                                              <const>
                                                <text>0</text>
                                              </const>
                                            </call>
                                            <text txtype="func"> then </text>
                                            <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                            <text txtype="func"> else </text>
                                            <call function="nvl" pth="">
                                              <text txtype="func"> nvl( </text>
                                              <column table="kod_sf_old_neg" column="ym" />
                                              <text txtype="func"> , </text>
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                              <text txtype="func"> ) </text>
                                            </call>
                                            <text txtype="func"> end </text>
                                          </call>
                                          <call function="nvl" agg="sum" as="perc" key="0" pth="" used="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc">
                                            <text txtype="func"> nvl( </text>
                                            <column table="kod_sf_dop" column="perc" />
                                            <text txtype="func"> , </text>
                                            <column table="a" column="proc" />
                                            <text txtype="func"> ) </text>
                                          </call>
                                        </select>
                                        <from>
                                          <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                          <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                            <select>
                                              <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                              <column table="st" column="perc" as="perc" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="perc" used="1" />
                                              <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_dop" sourcecolumn="rym" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_dop" as="st" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_dop" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_rec_info" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                            </select>
                                            <from>
                                              <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                            </from>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_rec_info" column="kod_sf" />
                                            </call>
                                          </query>
                                          <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_old_neg" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_facvip_a_d/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" used="1" />
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf_old_neg" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="a" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/vid_real" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/vid_real" sourcecolumn="vid_real" used="1" />
                                        </select>
                                        <from>
                                          <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="sr_facvip_a_d" column="vid_real" />
                                          <text txtype="func"> = </text>
                                          <column table="vid_real" column="vid_real" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>0</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                    <where>
                                      <call function="in" pth="" type="bool">
                                        <column table="vid_real" column="vid_real" />
                                        <text txtype="func"> in </text>
                                        <call function="array" pth="">
                                          <const>
                                            <text>0</text>
                                          </const>
                                        </call>
                                      </call>
                                    </where>
                                  </query>
                                </query>
                              </query>
                            </from>
                          </query>
                        </from>
                      </query>
                      <query as="qube" union="1" path="./a/qube/qube/qube/qube" used="1">
                        <select>
                          <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                          <column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                          <column table="qube" column="kod_type_opl" as="kod_type_opl" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_type_opl" />
                          <column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                          <column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                          <const type="number" as="kod_ur_state_11" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_21" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_31" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_41" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_51" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="kod_ur_state_61" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_facras_nachisl2" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_facras_nachisl1" used="1" key="0">
                            <text>null</text>
                          </const>
                          <const type="number" as="sr_facvip_perc_sum1" used="1" key="0">
                            <text>null</text>
                          </const>
                          <column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" />
                        </select>
                        <from>
                          <query as="qube" path="./a/qube/qube/qube/qube/qube" used="1">
                            <select>
                              <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                              <column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                              <column table="un" column="kod_type_opl" group="1" as="kod_type_opl" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_type_opl" />
                              <column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                              <column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                              <column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" />
                            </select>
                            <from>
                              <query as="un" path="./a/qube/qube/qube/qube/qube/un" used="1">
                                <query path="./a/qube/qube/qube/qube/qube/un" used="1">
                                  <query dimension="kod_opl_sf" multiplicate-point="1" as="un" union="1" path="./a/qube/qube/qube/qube/qube/un/un" used="1">
                                    <select>
                                      <column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" />
                                      <column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" />
                                      <column table="kod_opl_a_d" column="kod_type_opl" as="kod_type_opl" used="1" key="0" type="number" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_type_opl" />
                                      <column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" />
                                      <column table="sr_opl_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                      <column table="sr_opl_sf_a_d" column="opl_sf" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" />
                                    </select>
                                    <from>
                                      <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1" />
                                          <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1" />
                                          <call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1">
                                            <text txtype="func"> nvl( </text>
                                            <column table="a" column="opl" />
                                            <text txtype="func"> ,0) </text>
                                            <text txtype="func"> +nvl( </text>
                                            <column table="a" column="opls" />
                                            <text txtype="func"> ,0) </text>
                                          </call>
                                          <column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" />
                                        </select>
                                        <from>
                                          <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1" />
                                          <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" haskeys="1" used="1">
                                            <select>
                                              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1" />
                                              <call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">
                                                <text txtype="func"> case </text>
                                                <text txtype="func"> when </text>
                                                <call function="=" pth="" type="bool">
                                                  <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real" />
                                                  <text txtype="func"> = </text>
                                                  <const>
                                                    <text>0</text>
                                                  </const>
                                                </call>
                                                <text txtype="func"> then </text>
                                                <column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym" />
                                                <text txtype="func"> else </text>
                                                <call function="nvl" pth="">
                                                  <text txtype="func"> nvl( </text>
                                                  <column table="kod_sf_old_neg" column="ym" />
                                                  <text txtype="func"> , </text>
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym" />
                                                  <text txtype="func"> ) </text>
                                                </call>
                                                <text txtype="func"> end </text>
                                              </call>
                                            </select>
                                            <from>
                                              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                              <query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">
                                                <select>
                                                  <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1" />
                                                  <column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_dop" as="st" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_dop" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1" />
                                                </select>
                                                <from>
                                                  <table name="vv_sr_facvip_rec_info_m" as="a" used="1" />
                                                </from>
                                                <call function="=" type="bool">
                                                  <column table="a" column="kod_sf" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_rec_info" column="kod_sf" />
                                                </call>
                                              </query>
                                              <query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">
                                                <select>
                                                  <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1" />
                                                  <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1" />
                                                </select>
                                                <from>
                                                  <table name="sr_facvip" as="a" used="1" />
                                                </from>
                                                <where>
                                                  <call function="not in" pth="" type="bool">
                                                    <column table="a" column="vid_sf" />
                                                    <text txtype="func"> not in </text>
                                                    <call function="array" pth="">
                                                      <const>
                                                        <text>2</text>
                                                      </const>
                                                      <text txtype="func"> , </text>
                                                      <const>
                                                        <text>9</text>
                                                      </const>
                                                    </call>
                                                  </call>
                                                </where>
                                                <call function="=" type="bool">
                                                  <column table="kod_sf_rec_info" column="kod_sf_old_neg" />
                                                  <text txtype="func"> = </text>
                                                  <column table="kod_sf_old_neg" column="kod_sf" />
                                                </call>
                                              </query>
                                            </from>
                                            <where>
                                              <call function="not in" pth="" type="bool">
                                                <column table="a" column="vid_sf" />
                                                <text txtype="func"> not in </text>
                                                <call function="array" pth="">
                                                  <const>
                                                    <text>2</text>
                                                  </const>
                                                  <text txtype="func"> , </text>
                                                  <const>
                                                    <text>9</text>
                                                  </const>
                                                </call>
                                              </call>
                                            </where>
                                            <call function="=" type="bool">
                                              <column table="a" column="kod_sf" />
                                              <text txtype="func"> = </text>
                                              <column table="kod_sf" column="kod_sf" />
                                            </call>
                                          </query>
                                        </from>
                                        <where>
                                          <call function="in" pth="" type="bool">
                                            <column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl" />
                                            <text txtype="func"> in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>0</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>3</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>4</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                      </query>
                                      <query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1" />
                                          <column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1" />
                                          <column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1" />
                                        </select>
                                        <from>
                                          <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
                                        </from>
                                        <where>
                                          <call function="not in" pth="" type="bool">
                                            <column table="a" column="vid_sf" />
                                            <text txtype="func"> not in </text>
                                            <call function="array" pth="">
                                              <const>
                                                <text>2</text>
                                              </const>
                                              <text txtype="func"> , </text>
                                              <const>
                                                <text>9</text>
                                              </const>
                                            </call>
                                          </call>
                                        </where>
                                        <call function="=" type="bool">
                                          <column table="sr_opl_sf_a_d" column="kod_sf" />
                                          <text txtype="func"> = </text>
                                          <column table="kod_sf" column="kod_sf" />
                                        </call>
                                      </query>
                                      <query name="sk_vid_real" dimension="vid_real" as="vid_real" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/vid_real" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/vid_real" sourcecolumn="vid_real" used="1" />
                                        </select>
                                        <from>
                                          <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="kod_sf" column="vid_real" />
                                          <text txtype="func"> = </text>
                                          <column table="vid_real" column="vid_real" />
                                        </call>
                                      </query>
                                      <query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" haskeys="1" used="1">
                                        <select>
                                          <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_opl" used="1" />
                                          <column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" sourcetable="./a/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_type_opl" used="1" />
                                        </select>
                                        <from>
                                          <table name="sr_opl" as="a" dimension="kod_opl" used="1" />
                                        </from>
                                        <call function="=" type="bool">
                                          <column table="sr_opl_sf_a_d" column="kod_opl" />
                                          <text txtype="func"> = </text>
                                          <column table="kod_opl_a_d" column="kod_opl" />
                                        </call>
                                      </query>
                                      <qubecontent>
                                        <where>
                                          <call function="in" condsource="sr_facvip_norm_av1">
                                            <column table="vid_real" column="vid_real" />
                                            <call function="array">
                                              <const>2</const>
                                              <const>3</const>
                                            </call>
                                          </call>
                                        </where>
                                      </qubecontent>
                                    </from>
                                    <where>
                                      <call function="in" pth="" type="bool">
                                        <column table="vid_real" column="vid_real" />
                                        <text txtype="func"> in </text>
                                        <call function="array" pth="">
                                          <const>
                                            <text>2</text>
                                          </const>
                                          <text txtype="func"> , </text>
                                          <const>
                                            <text>3</text>
                                          </const>
                                        </call>
                                      </call>
                                    </where>
                                  </query>
                                </query>
                              </query>
                            </from>
                          </query>
                        </from>
                      </query>
                    </query>
                  </query>
                </from>
              </query>
              <query name="sk_type_opl" dimension="kod_type_opl" link-mp-point="1" as="kod_type_opl" join="left outer" path="./a/qube/kod_type_opl" haskeys="1" used="1">
                <select>
                  <column table="a" column="kod_type_opl" type="number" key-dimension="kod_type_opl" as="kod_type_opl" key="1" fixed="1" sourcetable="./a/qube/kod_type_opl" sourcecolumn="kod_type_opl" used="1" />
                </select>
                <from>
                  <table name="sk_type_opl" as="a" title="Тип оплаты" dimension="kod_type_opl" used="1" />
                </from>
                <call function="=" type="bool">
                  <column table="kod_type_opl" column="kod_type_opl" />
                  <text txtype="func"> = </text>
                  <column table="qube" column="kod_type_opl" />
                </call>
              </query>
              <query name="sk_vid_real" dimension="vid_real" link-mp-point="1" as="vid_real" join="left outer" path="./a/qube/vid_real" haskeys="1" used="1">
                <select>
                  <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/qube/vid_real" sourcecolumn="vid_real" used="1" />
                </select>
                <from>
                  <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
                </from>
                <call function="=" type="bool">
                  <column table="vid_real" column="vid_real" />
                  <text txtype="func"> = </text>
                  <column table="qube" column="vid_real" />
                </call>
              </query>
            </from>
          </query>
          <query name="sk_vid_real" dimension="vid_real" link-mp-point="1" as="vid_real" join="left outer" path="./a/vid_real" haskeys="1" used="1">
            <select>
              <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./a/vid_real" sourcecolumn="vid_real" used="1" />
            </select>
            <from>
              <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1" />
            </from>
            <call function="=" type="bool">
              <column table="vid_real" column="vid_real" />
              <text txtype="func"> = </text>
              <column table="qube" column="vid_real" />
            </call>
          </query>
          <query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./a/kod_sf" haskeys="1" used="1">
            <select>
              <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./a/kod_sf" sourcecolumn="kod_sf" used="1" />
              <column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./a/kod_sf" sourcecolumn="ym" used="1" />
            </select>
            <from>
              <table name="sr_facvip" as="a" dimension="kod_sf" used="1" />
            </from>
            <where>
              <call function="not in" pth="" type="bool">
                <column table="a" column="vid_sf" />
                <text txtype="func"> not in </text>
                <call function="array" pth="">
                  <const>
                    <text>2</text>
                  </const>
                  <text txtype="func"> , </text>
                  <const>
                    <text>9</text>
                  </const>
                </call>
              </call>
            </where>
            <call function="=" type="bool">
              <column table="kod_sf" column="kod_sf" />
              <text txtype="func"> = </text>
              <column table="qube" column="kod_sf" />
            </call>
          </query>
          <query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./a/kod_dog" haskeys="1" used="1">
            <select>
              <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./a/kod_dog" sourcecolumn="kod_dog" used="1" />
            </select>
            <from>
              <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1" />
            </from>
            <call function="=" type="bool">
              <column table="kod_dog" column="kod_dog" />
              <text txtype="func"> = </text>
              <column table="qube" column="kod_dog" />
            </call>
          </query>
        </from>
      </query>
    </from>
    <where>
      <call function="in" pth="" type="bool">
        <column table="a" column="vid_real" />
        <text txtype="func"> in </text>
        <call function="array" pth="">
          <const>
            <text>2</text>
          </const>
          <text txtype="func"> , </text>
          <const>
            <text>3</text>
          </const>
        </call>
      </call>
    </where>
  </query>
</root>