<?xml version="1.0" encoding="utf-8"?>
<root timestamp="13.10.2024 20:01:54">
  <query name="36703-abon" use-repository="1" timestamp="15.05.2024 14:51:04" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1" materialize="1" noname="1" path="." used="1">
delete from rr_temp where skod = '36703-abon';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kodp
s1, --nump
s2, --name
s3, --inn
s4, --kpp
s5, --fio_ruk
s6, --tel_ruk
s7, --fio_buh
s8, --tel_buh
s9, --name_edo
s10, --bk_st_name
s11, --ur_addr
s12--real_addr
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kodp" /><column column="s1" info="nump" /><column column="s2" info="name" /><column column="s3" info="inn" /><column column="s4" info="kpp" /><column column="s5" info="fio_ruk" /><column column="s6" info="tel_ruk" /><column column="s7" info="fio_buh" /><column column="s8" info="tel_buh" /><column column="s9" info="name_edo" /><column column="s10" info="bk_st_name" /><column column="s11" info="ur_addr" /><column column="s12" info="real_addr" />--36703-abon
</insert><select>--36703-abon
select '36703-abon' as skod,
'36703-abon|#'||mtr.kodp as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1">kodp.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="nump" group="max" as="nump" key="0" used="1" type="string" title="Код абонента" sourcetable="./kodp" sourcecolumn="nump" into="s1">max(kodp.nump)  as nump, /*Код абонента*//*string*/
</column><column table="kodp" column="name" group="max" as="name" key="0" used="1" type="string" title="Наименование абонента" agg="list" sourcetable="./kodp" sourcecolumn="name" into="s2">max(kodp.name)  as name, /*Наименование абонента*//*string*/
</column><column table="kodp" column="inn" group="max" as="inn" key="0" used="1" type="string" title="ИНН" sourcetable="./kodp" sourcecolumn="inn" into="s3">max(kodp.inn)  as inn, /*ИНН*//*string*/
</column><column table="kodp" column="kpp" group="max" as="kpp" key="0" used="1" type="string" title="КПП" sourcetable="./kodp" sourcecolumn="kpp" into="s4">max(kodp.kpp)  as kpp, /*КПП*//*string*/
</column><column table="kr_emp_ruk_kod_emp" column="fio" as="fio_ruk" group="max" key="0" used="1" type="string" title="ФИО" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="fio" into="s5">max(kr_emp_ruk_kod_emp.fio)  as fio_ruk, /*ФИО*//*string*/
</column><column table="kr_emp_ruk_kod_emp" column="tel" as="tel_ruk" group="max" key="0" used="1" type="string" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="tel" into="s6">max(kr_emp_ruk_kod_emp.tel)  as tel_ruk, /*string*/
</column><column table="kr_emp_buh_kod_emp" column="fio" as="fio_buh" group="max" key="0" used="1" type="string" title="ФИО" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="fio" into="s7">max(kr_emp_buh_kod_emp.fio)  as fio_buh, /*ФИО*//*string*/
</column><column table="kr_emp_buh_kod_emp" column="tel" as="tel_buh" group="max" key="0" used="1" type="string" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="tel" into="s8">max(kr_emp_buh_kod_emp.tel)  as tel_buh, /*string*/
</column><column table="kod_edo" column="name_edo" group="max" as="name_edo" key="0" used="1" type="string" sourcetable="./kod_edo" sourcecolumn="name_edo" into="s9">max(kod_edo.name_edo)  as name_edo, /*string*/
</column><call as="bk_st_name" function="()" type="string" key="0" group="max" pth="" used="1" title="Код статуса по справочнику СЮЛСТ/СИПСТ" sourcetable="./udo" sourcecolumn="pr_active" into="s10">max(<call function="case" title="Банкрот" type="string" pth="">(<text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="=" pth="" type="bool">(<column table="udo" column="pr_active">udo.pr_active</column><text txtype="func"> = </text><const type="number"><text>0</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kodp" column="ac_egr_status">kodp.ac_egr_status</column><text txtype="func"> = </text><column table="udo" column="sulst">udo.sulst</column>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="udo" column="type_sulst">udo.type_sulst</column><text txtype="func"> = </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="is null" pth="" type="bool">(<column table="kodp" column="kpp">kodp.kpp</column><text txtype="func"> is null </text>) </call><text txtype="func"> then </text><const type="string"><text>'ИП'</text></const><text txtype="func"> else </text><const type="string"><text>'ЮЛ'</text></const><text txtype="func"> end </text>) </call>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="case" pth="">(<text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'A'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_a">udo.cat_a</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'B'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_b">udo.cat_b</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'C'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_c">udo.cat_c</column></call><text txtype="func"> end </text>) </call><text txtype="func"> = </text><const type="number"><text>1</text></const>) </call>) </call><text txtype="func"> then </text><column table="udo" column="shortname" type="string">udo.shortname</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>:p_cat_rep </text></const><text txtype="func"> = </text><const table="udo" column="sulst" type="string"><text>'-'</text></const>) </call><text txtype="func"> then </text><column table="kodp" column="ac_egr_status_name" type="string">kodp.ac_egr_status_name</column></call><text txtype="func"> end </text>) </call>)  as bk_st_name, /*Код статуса по справочнику СЮЛСТ/СИПСТ*//*string*/
</call><column group="max" table="kod_d_ur" column="kf_adress_o" title="Юридический адрес" as="ur_addr" key="0" used="1" type="string" sourcetable="./kod_d_ur" sourcecolumn="kf_adress_o" into="s11">max(kod_d_ur.kf_adress_o)  as ur_addr, /*Юридический адрес*//*string*/
</column><column group="max" table="kod_d" column="kf_adress_o" title="Адрес фактический" as="real_addr" key="0" used="1" type="string" sourcetable="./kod_d" sourcecolumn="kf_adress_o" into="s12">max(kod_d.kf_adress_o)  as real_addr/*Адрес фактический*//*string*/
</column></select><from>
from <query as="qube" path="./qube" used="1">(
<select>--
select <column table="qube" column="kodp" group="1" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">qube.kodp as kodp, /*number*//*key*/
</column><column table="qube" column="kr_emp_buh_kod_emp1" as="kr_emp_buh_kod_emp1" group="max" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp">max(qube.kr_emp_buh_kod_emp1)  as kr_emp_buh_kod_emp1, /*number*/
</column><column table="qube" column="kr_emp_ruk_kod_emp1" as="kr_emp_ruk_kod_emp1" group="max" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp">max(qube.kr_emp_ruk_kod_emp1)  as kr_emp_ruk_kod_emp1/*number*/
</column></select><from>
from <query as="qube" path="./qube/qube" used="1">(
<select>--
select <column table="qube" column="kodp" as="kodp" used="1" key="1" keypath=".kodp" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">qube.kodp as kodp, /*number*//*key*/
</column><column table="qube" column="kr_emp_buh_kod_emp1" as="kr_emp_buh_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp">qube.kr_emp_buh_kod_emp1 as kr_emp_buh_kod_emp1, /*number*/
</column><column table="qube" column="kr_emp_ruk_kod_emp1" as="kr_emp_ruk_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp">qube.kr_emp_ruk_kod_emp1 as kr_emp_ruk_kod_emp1/*number*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube" used="1">(
<query path="./qube/qube/qube" used="1">(
<query as="qube" union="1" path="./qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kodp" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">qube.kodp as kodp, /*number*//*key*/
</column><column table="qube" column="kr_emp_buh_kod_emp1" as="kr_emp_buh_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp">qube.kr_emp_buh_kod_emp1 as kr_emp_buh_kod_emp1, /*number*/
</column><column table="qube" column="kr_emp_ruk_kod_emp1" as="kr_emp_ruk_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp">qube.kr_emp_ruk_kod_emp1 as kr_emp_ruk_kod_emp1/*number*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kodp" group="1" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">un.kodp as kodp, /*number*//*key*/
</column><column table="un" column="kr_emp_buh_kod_emp1" group="max" as="kr_emp_buh_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp">max(un.kr_emp_buh_kod_emp1)  as kr_emp_buh_kod_emp1, /*number*/
</column><column table="un" column="kr_emp_ruk_kod_emp1" group="max" as="kr_emp_ruk_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp">max(un.kr_emp_ruk_kod_emp1)  as kr_emp_ruk_kod_emp1/*number*/
</column></select><from>
from <query as="un" path="./qube/qube/qube/qube/qube/un" used="1">(
<query path="./qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kodp" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">dims.kodp as kodp, /*number*//*key*/
</column><column table="kr_employee_buh" column="kod_emp_buh" as="kr_emp_buh_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp">kr_employee_buh.kod_emp_buh as kr_emp_buh_kod_emp1, /*number*/
</column><const type="number" as="kr_emp_ruk_kod_emp1" used="1" key="0"><text>null</text> as kr_emp_ruk_kod_emp1/*number*/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="kr_employee_buh_a_d" column="kod_emp" as="kod_emp_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_buh_a_d" sourcecolumn="kod_emp">kr_employee_buh_a_d.kod_emp as kod_emp_prm, /*number*//*key*/
</column><column table="kod_emp_a_d" column="kodp" as="kodp" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">kod_emp_a_d.kodp as kodp/*number*//*key*/
</column></select><from>
from <query name="kr_employee_buh" dimension="kod_emp_buh" as="kr_employee_buh_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_buh_a_d" haskeys="1" used="1">(
<select>--kr_employee_buh
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_buh_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp_buh" key="1" fixed="1" thissrc="kod_emp" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_buh_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp_buh/*number*//*key*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp_buh" used="1">kr_employee
a
--\kr_employee
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_dolzhfun" type="number" comment="код должностной функции" as="kod_dolzhfun" reference="kk_dolzhfun" refcol="kod_dolzhfun" key="0" thissrc="kod_dolzhfun">a.kod_dolzhfun</column><text txtype="func"> = </text><const><text>1</text></const></call></where>)
kr_employee_buh_a_d
--\kr_employee_buh
</query><query name="kr_employee" dimension="kod_emp" as="kod_emp_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" haskeys="1" used="1">left outer join
(
<select>--kr_employee
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (организации)" as="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp" used="1">kr_employee
a
--\kr_employee
</table></from><call function="=" type="bool">)
kod_emp_a_d on <column table="kr_employee_buh_a_d" column="kod_emp">kr_employee_buh_a_d.kod_emp</column><text txtype="func"> = </text><column table="kod_emp_a_d" column="kod_emp">kod_emp_a_d.kod_emp</column></call>--\kr_employee
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_emp_a_d" column="kodp">kod_emp_a_d.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where><group> group by
<column table="kr_employee_buh_a_d" column="kod_emp" as="kod_emp_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_buh_a_d" sourcecolumn="kod_emp">kr_employee_buh_a_d.kod_emp, /*number*//*key*/
</column><column table="kod_emp_a_d" column="kodp" as="kodp" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">kod_emp_a_d.kodp/*number*//*key*/
</column></group>)
dims
--\
</query><query name="kr_employee_buh" dimension="kod_emp_buh" as="kr_employee_buh" join="left outer" path="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" haskeys="1" used="1">left outer join
(
<select>--kr_employee_buh
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp_buh" key="1" fixed="1" thissrc="kod_emp" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_buh" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp_buh/*number*//*key*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp_buh" used="1">kr_employee
a
--\kr_employee
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_dolzhfun" type="number" comment="код должностной функции" as="kod_dolzhfun" reference="kk_dolzhfun" refcol="kod_dolzhfun" key="0" thissrc="kod_dolzhfun">a.kod_dolzhfun</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kr_employee_buh on <column table="kr_employee_buh" column="kod_emp">kr_employee_buh.kod_emp</column><text txtype="func"> = </text><column table="dims" column="kod_emp_prm">dims.kod_emp_prm</column></call>--\kr_employee_buh
</query><qubecontent><where>where
<call function="and" condsource="36703-abon"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kodp" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">dims.kodp as kodp, /*number*//*key*/
</column><const type="number" as="kr_emp_buh_kod_emp1" used="1" key="0"><text>null</text> as kr_emp_buh_kod_emp1, /*number*/
</const><column table="kr_employee_ruk" column="kod_emp_ruk" as="kr_emp_ruk_kod_emp1" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp">kr_employee_ruk.kod_emp_ruk as kr_emp_ruk_kod_emp1/*number*/
</column></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="kr_employee_ruk_a_d" column="kod_emp" as="kod_emp_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_ruk_a_d" sourcecolumn="kod_emp">kr_employee_ruk_a_d.kod_emp as kod_emp_prm, /*number*//*key*/
</column><column table="kod_emp_a_d" column="kodp" as="kodp" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">kod_emp_a_d.kodp as kodp/*number*//*key*/
</column></select><from>
from <query name="kr_employee_ruk" dimension="kod_emp_ruk" as="kr_employee_ruk_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_ruk_a_d" haskeys="1" used="1">(
<select>--kr_employee_ruk
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_ruk_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp_ruk" key="1" fixed="1" thissrc="kod_emp" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_ruk_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp_ruk/*number*//*key*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp_ruk" used="1">kr_employee
a
--\kr_employee
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_dolzhfun" type="number" comment="код должностной функции" as="kod_dolzhfun" reference="kk_dolzhfun" refcol="kod_dolzhfun" key="0" thissrc="kod_dolzhfun">a.kod_dolzhfun</column><text txtype="func"> = </text><const><text>14</text></const></call></where>)
kr_employee_ruk_a_d
--\kr_employee_ruk
</query><query name="kr_employee" dimension="kod_emp" as="kod_emp_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" haskeys="1" used="1">left outer join
(
<select>--kr_employee
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (организации)" as="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp" used="1">kr_employee
a
--\kr_employee
</table></from><call function="=" type="bool">)
kod_emp_a_d on <column table="kr_employee_ruk_a_d" column="kod_emp">kr_employee_ruk_a_d.kod_emp</column><text txtype="func"> = </text><column table="kod_emp_a_d" column="kod_emp">kod_emp_a_d.kod_emp</column></call>--\kr_employee
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_emp_a_d" column="kodp">kod_emp_a_d.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where><group> group by
<column table="kr_employee_ruk_a_d" column="kod_emp" as="kod_emp_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kr_employee_ruk_a_d" sourcecolumn="kod_emp">kr_employee_ruk_a_d.kod_emp, /*number*//*key*/
</column><column table="kod_emp_a_d" column="kodp" as="kodp" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">kod_emp_a_d.kodp/*number*//*key*/
</column></group>)
dims
--\
</query><query name="kr_employee_ruk" dimension="kod_emp_ruk" as="kr_employee_ruk" join="left outer" path="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" haskeys="1" used="1">left outer join
(
<select>--kr_employee_ruk
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp_ruk" key="1" fixed="1" thissrc="kod_emp" sourcetable="./qube/qube/qube/qube/qube/un/un/kr_employee_ruk" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp_ruk/*number*//*key*/
</column></select><from>
from <table name="kr_employee" as="a" dimension="kod_emp_ruk" used="1">kr_employee
a
--\kr_employee
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_dolzhfun" type="number" comment="код должностной функции" as="kod_dolzhfun" reference="kk_dolzhfun" refcol="kod_dolzhfun" key="0" thissrc="kod_dolzhfun">a.kod_dolzhfun</column><text txtype="func"> = </text><const><text>14</text></const></call></where><call function="=" type="bool">)
kr_employee_ruk on <column table="kr_employee_ruk" column="kod_emp">kr_employee_ruk.kod_emp</column><text txtype="func"> = </text><column table="dims" column="kod_emp_prm">dims.kod_emp_prm</column></call>--\kr_employee_ruk
</query><qubecontent><where>where
<call function="and" condsource="36703-abon"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kodp" as="kodp" used="1" key="1" type="number" agg="max" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp">dims.kodp as kodp, /*number*//*key*/
</column><const type="number" as="kr_emp_buh_kod_emp1" used="1" key="0"><text>null</text> as kr_emp_buh_kod_emp1, /*number*/
</const><const type="number" as="kr_emp_ruk_kod_emp1" used="1" key="0"><text>null</text> as kr_emp_ruk_kod_emp1/*number*/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="kodp" column="kodp" as="kodp" group="1" used="1" key="1" type="number" agg="max" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp">kodp.kodp as kodp/*number*//*key*/
</column></select><from>
from <query name="kr_payer" dimension="kodp" as="kodp" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from>)
kodp
--\kr_payer
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where><group> group by
<column table="kodp" column="kodp" as="kodp" group="1" used="1" key="1" type="number" agg="max" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp">kodp.kodp/*number*//*key*/
</column></group>)
dims
--\
</query><qubecontent><where>where
<call function="and" condsource="36703-abon"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kodp" group="1" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">un.kodp/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kodp" group="1" as="kodp" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_emp_a_d" sourcecolumn="kodp">qube.kodp/*number*//*key*/
</column></group>)
qube
--\
</query><query name="kr_payer" dimension="kodp" link-mp-point="1" as="kodp" join="left outer" path="./kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="nump" type="string" title="Код абонента" comment="номер абонента" vid="1" is-name="1" as="nump" key="0" sourcetable="./kodp" sourcecolumn="nump" used="1">a.nump as nump, /*Код абонента*//*string*/
</column><column table="a" column="name" type="string" title="Наименование абонента" comment="наименование" vid="1" is-name="1" is-fact="1" agg="list" as="name" fact="kr_payer_name" key="0" sourcetable="./kodp" sourcecolumn="name" used="1">a.name as name, /*Наименование абонента*//*string*/
</column><column table="a" column="inn" type="string" title="ИНН" comment="инн" as="inn" key="0" sourcetable="./kodp" sourcecolumn="inn" used="1">a.inn as inn, /*ИНН*//*string*/
</column><column table="a" column="kod_d" type="number" comment="код дома адреса физического" as="kod_d" reference="k_house" refcol="kodd" key="0" sourcetable="./kodp" sourcecolumn="kod_d" used="1">a.kod_d as kod_d, /*number*/
</column><column table="a" column="kod_d_ur" type="number" comment="код дома адреса юридического" as="kod_d_ur" reference="k_house" refcol="kodd" key="0" sourcetable="./kodp" sourcecolumn="kod_d_ur" used="1">a.kod_d_ur as kod_d_ur, /*number*/
</column><column table="a" column="kpp" type="string" title="КПП" comment="кпп" as="kpp" key="0" sourcetable="./kodp" sourcecolumn="kpp" used="1">a.kpp as kpp, /*КПП*//*string*/
</column><column table="a" column="ac_egr_status" type="string" title="Код статуса по справочнику СЮЛСТ/СИПСТ" as="ac_egr_status" key="0" sourcetable="./kodp" sourcecolumn="ac_egr_status" used="1">a.ac_egr_status as ac_egr_status, /*Код статуса по справочнику СЮЛСТ/СИПСТ*//*string*/
</column><column table="a" column="ac_egr_status_name" type="string" title="чнику СЮЛСТ/СИПСТ" as="ac_egr_status_name" key="0" sourcetable="./kodp" sourcecolumn="ac_egr_status_name" used="1">a.ac_egr_status_name as ac_egr_status_name/*чнику СЮЛСТ/СИПСТ*//*string*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> = </text><column table="qube" column="kodp">qube.kodp</column></call>--\kr_payer
</query><query name="kk_sulst" as="udo" join="left outer" path="./udo" haskeys="1" used="1">left outer join
(
<select>--kk_sulst
select <column table="a" column="kod_sulst" type="number" column-mandatory="1" comment="Ун.код в справочнике" as="kod_sulst" key="1" fixed="1" sourcetable="./udo" sourcecolumn="kod_sulst" used="1">a.kod_sulst as kod_sulst, /*number*//*key*/
</column><column table="a" column="sulst" type="string" data-size="10" title="" comment="Код по спр-ку СЮЛСТ/СИПСТ, СЮЛПД" as="sulst" key="0" sourcetable="./udo" sourcecolumn="sulst" used="1">a.sulst as sulst, /**//*string*/
</column><column table="a" column="type_sulst" type="string" data-size="20" column-mandatory="1" title="" comment="тип спр-ка (СЮЛСТ/СИПСТ, СЮЛПД)" as="type_sulst" key="0" sourcetable="./udo" sourcecolumn="type_sulst" used="1">a.type_sulst as type_sulst, /**//*string*/
</column><column table="a" column="pr_active" type="number" column-mandatory="1" title="" comment="признак актуальности использования в отчете: 0 или 1" as="pr_active" key="0" sourcetable="./udo" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="shortname" type="string" data-size="200" title="" comment="Краткое наименование" as="shortname" key="0" sourcetable="./udo" sourcecolumn="shortname" used="1">a.shortname as shortname, /**//*string*/
</column><column table="a" column="cat_a" type="number" title="" comment="Категория отчёта A" as="cat_a" key="0" sourcetable="./udo" sourcecolumn="cat_a" used="1">a.cat_a as cat_a, /**//*number*/
</column><column table="a" column="cat_b" type="number" title="" comment="Категория отчёта B" as="cat_b" key="0" sourcetable="./udo" sourcecolumn="cat_b" used="1">a.cat_b as cat_b, /**//*number*/
</column><column table="a" column="cat_c" type="number" title="" comment="Категория отчёта C" as="cat_c" key="0" sourcetable="./udo" sourcecolumn="cat_c" used="1">a.cat_c as cat_c/**//*number*/
</column></select><from>
from <table name="kk_sulst" as="a" used="1">kk_sulst
a
--\kk_sulst
</table></from><call function="=" type="bool">)
udo on <column table="kodp" column="ac_egr_status">kodp.ac_egr_status</column><text txtype="func"> = </text><column table="udo" column="sulst">udo.sulst</column></call>--\kk_sulst
</query><query name="k_house" as="kod_d" join="left outer" path="./kod_d" haskeys="1" used="1">left outer join
(
<select>--k_house
select <column table="a" column="kodd" type="number" title="" as="kodd" key="1" fixed="1" sourcetable="./kod_d" sourcecolumn="kodd" used="1">a.kodd as kodd, /**//*number*//*key*/
</column><column table="a" column="kf_adress_o" type="string" title="Адрес" comment="вспомогательное поле. хранит резальтат работы функции nk_adress.kf_address(n_r =&gt; 0,n_kod =&gt; код дома). актуальность значений поддерживается тригерами на таблицах adr_m, k_strits, k_house" is-name="1" as="kf_adress_o" key="0" sourcetable="./kod_d" sourcecolumn="kf_adress_o" used="1">a.kf_adress_o as kf_adress_o/*Адрес*//*string*/
</column></select><from>
from <table name="k_house" as="a" used="1">k_house
a
--\k_house
</table></from><call function="=" type="bool">)
kod_d on <column table="kodp" column="kod_d">kodp.kod_d</column><text txtype="func"> = </text><column table="kod_d" column="kodd">kod_d.kodd</column></call>--\k_house
</query><query name="k_house" as="kod_d_ur" join="left outer" path="./kod_d_ur" haskeys="1" used="1">left outer join
(
<select>--k_house
select <column table="a" column="kodd" type="number" title="" as="kodd" key="1" fixed="1" sourcetable="./kod_d_ur" sourcecolumn="kodd" used="1">a.kodd as kodd, /**//*number*//*key*/
</column><column table="a" column="kf_adress_o" type="string" title="Адрес" comment="вспомогательное поле. хранит резальтат работы функции nk_adress.kf_address(n_r =&gt; 0,n_kod =&gt; код дома). актуальность значений поддерживается тригерами на таблицах adr_m, k_strits, k_house" is-name="1" as="kf_adress_o" key="0" sourcetable="./kod_d_ur" sourcecolumn="kf_adress_o" used="1">a.kf_adress_o as kf_adress_o/*Адрес*//*string*/
</column></select><from>
from <table name="k_house" as="a" used="1">k_house
a
--\k_house
</table></from><call function="=" type="bool">)
kod_d_ur on <column table="kodp" column="kod_d_ur">kodp.kod_d_ur</column><text txtype="func"> = </text><column table="kod_d_ur" column="kodd">kod_d_ur.kodd</column></call>--\k_house
</query><query name="kr_org" as="kodp1" join="left outer" path="./kodp1" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./kodp1" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp1 on <column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> = </text><column table="kodp1" column="kodp">kodp1.kodp</column></call>--\kr_org
</query><query name="kr_org_edo" as="kr_org_edo" join="left outer" path="./kr_org_edo" haskeys="1" used="1">left outer join
(
<select>--kr_org_edo
select <column table="a" column="kodp" type="number" title="" as="kodp" key="0" sourcetable="./kr_org_edo" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="kod_edo" type="number" comment="код оператора электронного документооборота (оэдо)" as="kod_edo" reference="kk_edo" refcol="kod_edo" key="0" sourcetable="./kr_org_edo" sourcecolumn="kod_edo" used="1">a.kod_edo as kod_edo/*number*/
</column></select><from>
from <table name="kr_org_edo" as="a" used="1">kr_org_edo
a
--\kr_org_edo
</table></from><call function="=" type="bool">)
kr_org_edo on <column table="kr_org_edo" column="kodp">kr_org_edo.kodp</column><text txtype="func"> = </text><column table="kodp1" column="kodp">kodp1.kodp</column></call>--\kr_org_edo
</query><query name="kk_edo" as="kod_edo" join="left outer" path="./kod_edo" haskeys="1" used="1">left outer join
(
<select>--kk_edo
select <column table="a" column="kod_edo" type="number" comment="код оператора электронного документооборота (оэдо)" as="kod_edo" key="1" fixed="1" sourcetable="./kod_edo" sourcecolumn="kod_edo" used="1">a.kod_edo as kod_edo, /*number*//*key*/
</column><column table="a" column="name_edo" type="string" title="" comment="наименование организации (оэдо)" as="name_edo" key="0" sourcetable="./kod_edo" sourcecolumn="name_edo" used="1">a.name_edo as name_edo/**//*string*/
</column></select><from>
from <table name="kk_edo" as="a" used="1">kk_edo
a
--\kk_edo
</table></from><call function="=" type="bool">)
kod_edo on <column table="kr_org_edo" column="kod_edo">kr_org_edo.kod_edo</column><text txtype="func"> = </text><column table="kod_edo" column="kod_edo">kod_edo.kod_edo</column></call>--\kk_edo
</query><query name="kr_employee" as="kr_emp_buh_kod_emp" join="left outer" path="./kr_emp_buh_kod_emp" haskeys="1" used="1">left outer join
(
<select>--kr_employee
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="fio" type="string" title="ФИО" comment="фио" vid="1" as="fio" key="0" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="fio" used="1">a.fio as fio, /*ФИО*//*string*/
</column><column table="a" column="tel" type="string" title="" comment="телефон" as="tel" key="0" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="tel" used="1">a.tel as tel/**//*string*/
</column></select><from>
from <table name="kr_employee" as="a" used="1">kr_employee
a
--\kr_employee
</table></from><call function="=" type="bool">)
kr_emp_buh_kod_emp on <column table="kr_emp_buh_kod_emp" column="kod_emp">kr_emp_buh_kod_emp.kod_emp</column><text txtype="func"> = </text><column column="kr_emp_buh_kod_emp1" table="qube" as="kr_emp_buh_kod_emp1">qube.kr_emp_buh_kod_emp1</column></call>--\kr_employee
</query><query name="kr_employee" as="kr_emp_ruk_kod_emp" join="left outer" path="./kr_emp_ruk_kod_emp" haskeys="1" used="1">left outer join
(
<select>--kr_employee
select <column table="a" column="kod_emp" type="number" comment="код сотрудника" as="kod_emp" key="1" fixed="1" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="kod_emp" used="1">a.kod_emp as kod_emp, /*number*//*key*/
</column><column table="a" column="fio" type="string" title="ФИО" comment="фио" vid="1" as="fio" key="0" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="fio" used="1">a.fio as fio, /*ФИО*//*string*/
</column><column table="a" column="tel" type="string" title="" comment="телефон" as="tel" key="0" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="tel" used="1">a.tel as tel/**//*string*/
</column></select><from>
from <table name="kr_employee" as="a" used="1">kr_employee
a
--\kr_employee
</table></from><call function="=" type="bool">)
kr_emp_ruk_kod_emp on <column table="kr_emp_ruk_kod_emp" column="kod_emp">kr_emp_ruk_kod_emp.kod_emp</column><text txtype="func"> = </text><column column="kr_emp_ruk_kod_emp1" table="qube" as="kr_emp_ruk_kod_emp1">qube.kr_emp_ruk_kod_emp1</column></call>--\kr_employee
</query></from><group> group by
<column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1">kodp.kodp/*number*//*key*/
</column></group>) mtr
;
--\36703-abon
</query>
  <query name="36703-dog" noname="1" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-dog';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_dog
n2, --kodp
s1, --name
s2, --ndog
s3, --name_bzad
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_dog" /><column column="n2" info="kodp" /><column column="s1" info="name" /><column column="s2" info="ndog" /><column column="s3" info="name_bzad" /><column column="sparentid" info="sparentid" />--36703-dog
</insert><select>--36703-dog
select '36703-dog' as skod,
'36703-dog|#'||mtr.kod_dog as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="dog" column="kod_dog" as="kod_dog" used="1" key="1" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog/kod_dog" sourcecolumn="kod_dog" into="n1">dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dog" column="kodp" as="kodp" used="1" key="0" type="number" sourcetable="./dog/kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n2">dog.kodp as kodp, /*number*/
</column><column table="dog" column="name" as="name" used="1" key="0" type="string" title="Договор" agg="stragg_dist" into="s1">dog.name as name, /*Договор*//*string*/
</column><column table="dog" column="ndog" as="ndog" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./dog/kod_dog" sourcecolumn="ndog" into="s2">dog.ndog as ndog, /*Номер договора*//*string*/
</column><column table="dog" column="name_bzad" as="name_bzad" used="1" key="0" type="string" title="Наименование" into="s3">dog.name_bzad as name_bzad, /*Наименование*//*string*/
</column><column table="abon" column="sid" as="sparentid" used="1" key="0" into="sparentid">abon.sid as sparentid
</column></select><from>
from <query name="36703-dog" as="dog" path="./dog" used="1">(
<select>--36703-dog
select <column table="kod_dog" column="kod_dog" as="kod_dog" used="1" key="1" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dog" column="kodp" as="kodp" used="1" key="0" type="number" sourcetable="./dog/kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp">kod_dog.kodp as kodp, /*number*/
</column><column table="kod_dog" column="name" as="name" used="1" key="0" type="string" title="Договор" agg="stragg_dist">kod_dog.name as name, /*Договор*//*string*/
</column><column table="kod_dog" column="ndog" as="ndog" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./dog/kod_dog" sourcecolumn="ndog">kod_dog.ndog as ndog, /*Номер договора*//*string*/
</column><column table="kod_bzad" column="name" as="name_bzad" used="1" key="0" type="string" title="Наименование">kod_bzad.name as name_bzad/*Наименование*//*string*/
</column></select><from>
from <query haskeys="1" as="qube" path="./dog/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <query as="qube" path="./dog/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <query as="qube" path="./dog/qube/qube/qube" used="1">(
<query path="./dog/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./dog/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <query as="qube" path="./dog/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">un.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <query as="un" path="./dog/qube/qube/qube/qube/qube/un" used="1">(
<query path="./dog/qube/qube/qube/qube/qube/un" used="1">(
<query dimension="kod_dog" multiplicate-point="1" as="un" union="1" path="./dog/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="kod_dog" column="kod_dog" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <query name="kr_dogovor" dimension="kod_dog" as="kod_dog" path="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from>)
kod_dog
--\kr_dogovor
</query><qubecontent><where>where
<call function="and" condsource="36703-dog"><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">un.kod_dog/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./dog/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kod_dog/*number*//*key*/
</column></group>)
qube
--\
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./dog/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./dog/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./dog/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="ndog" type="string" title="Номер договора" comment="номер договора" fact="kr_dog_ndog" agg="stragg_dist" vid="1" as="ndog" key="0" sourcetable="./dog/kod_dog" sourcecolumn="ndog" used="1">a.ndog as ndog, /*Номер договора*//*string*/
</column><column table="a" column="kod_bzad" type="number" as="kod_bzad" reference="ss_zadol_day" refcol="kod_bzad" key="0" sourcetable="./dog/kod_dog" sourcecolumn="kod_bzad" used="1">a.kod_bzad as kod_bzad, /*number*/
</column><call function="||" as="name" title="Договор" agg="stragg_dist" key="0" pth="" type="string" used="1"><column table="a" column="ndog">a.ndog</column><text txtype="func"> || </text><const><text>' от '</text></const><text txtype="func"> || </text><call function="date to char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="a" column="dat_dog">a.dat_dog</column><text txtype="func"> ,'DD.MM.YYYY') </text>) </call> as name/*Договор*//*string*/
</call></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="ss_zadol_day" as="kod_bzad" join="left outer" path="./dog/kod_bzad" haskeys="1" used="1">left outer join
(
<select>--ss_zadol_day
select <column table="a" column="kod_bzad" type="number" as="kod_bzad" key="1" fixed="1" sourcetable="./dog/kod_bzad" sourcecolumn="kod_bzad" used="1">a.kod_bzad as kod_bzad, /*number*//*key*/
</column><call function="||" as="name" key="0" pth="" type="string" used="1" title="Наименование"><column table="day_type" column="text_before_day">day_type.text_before_day</column><text txtype="func"> || </text><column table="a" column="days_bzad" type="number" title="" as="days_bzad" key="0" thissrc="days_bzad">a.days_bzad</column><text txtype="func"> || </text><column table="day_type" column="text_after_day">day_type.text_after_day</column> as name/*Наименование*//*string*/
</call></select><from>
from <table name="ss_zadol_day" as="a" used="1">ss_zadol_day
a
--\ss_zadol_day
</table><query name="kk_type_zadol" as="day_type" join="left outer" path="./dog/kod_bzad/day_type" haskeys="1" used="1">left outer join
(
<select>--kk_type_zadol
select <column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" used="1" sourcetable="./dog/kod_bzad/day_type" sourcecolumn="day_type">a.day_type as day_type, /**//*number*//*key*/
</column><call as="text_before_day" function="case" key="0" pth="" used="1" type="number"><text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>1</text></const>) </call>) </call><text txtype="func"> then </text><const><text>'до '</text></const></call><text txtype="func"> end </text> as text_before_day, /*number*/
</call><call as="text_after_day" function="case" key="0" pth="" used="1" type="number" title="Наименование"><text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> = </text><const><text>2</text></const>) </call><text txtype="func"> then </text><const><text>' числа текущего месяца'</text></const></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> then </text><const><text>' числа следующего месяца'</text></const></call><call function="else" pth="0" type="else"><text txtype="func"> else </text><column table="a" column="name" type="string" title="Наименование" as="name" key="0" thissrc="name">a.name</column></call><text txtype="func"> end </text> as text_after_day/*Наименование*//*number*/
</call></select><from>
from <table name="kk_type_zadol" as="a" used="1">kk_type_zadol
a
--\kk_type_zadol
</table></from><call function="=" type="bool">)
day_type on <column table="a" column="day_type">a.day_type</column><text txtype="func"> = </text><column table="day_type" column="day_type">day_type.day_type</column></call>--\kk_type_zadol
</query></from><call function="=" type="bool">)
kod_bzad on <column table="kod_dog" column="kod_bzad">kod_dog.kod_bzad</column><text txtype="func"> = </text><column table="kod_bzad" column="kod_bzad">kod_bzad.kod_bzad</column></call>--\ss_zadol_day
</query></from>)
dog
--\36703-dog
</query><query name="36703-abon" use-repository="1" timestamp="15.05.2024 14:51:04" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1" materialize="2" noname="1" path="./abon" as="abon" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kodp
from rr_temp where skod = '36703-abon'
<select notext="1">--36703-abon
select <column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1" used="1">kodp.kodp as kodp/*number*//*key*/
</column></select><from notext="1">
from <table name="qube" as="qube">qube
qube
--\qube
</table><table name="kodp" as="kodp" used="1">kodp
kodp
--\kodp
</table><table name="udo" as="udo">udo
udo
--\udo
</table><table name="kod_d" as="kod_d">kod_d
kod_d
--\kod_d
</table><table name="kod_d_ur" as="kod_d_ur">kod_d_ur
kod_d_ur
--\kod_d_ur
</table><table name="kodp1" as="kodp1">kodp1
kodp1
--\kodp1
</table><table name="kr_org_edo" as="kr_org_edo">kr_org_edo
kr_org_edo
--\kr_org_edo
</table><table name="kod_edo" as="kod_edo">kod_edo
kod_edo
--\kod_edo
</table><table name="kr_emp_buh_kod_emp" as="kr_emp_buh_kod_emp">kr_emp_buh_kod_emp
kr_emp_buh_kod_emp
--\kr_emp_buh_kod_emp
</table><table name="kr_emp_ruk_kod_emp" as="kr_emp_ruk_kod_emp">kr_emp_ruk_kod_emp
kr_emp_ruk_kod_emp
--\kr_emp_ruk_kod_emp
</table></from><group notext="1"> group by
<column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1" used="1">kodp.kodp/*number*//*key*/
</column></group><call function="=" type="bool">)
abon on <column table="abon" column="kodp">abon.kodp</column><text txtype="func"> = </text><column table="dog" column="kodp">dog.kodp</column></call>--\36703-abon
</query></from>) mtr
;
--\36703-dog
</query>
  <query name="qube_graf_in" class="1" use-repository="1" materialize="1" timestamp="29.06.2023 14:34:54" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\ur_graf.xml" path="." noname="1" used="1">
delete from rr_temp where skod = 'qube_graf_in';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_graf
n2, --kod_sf
n3, --kod_dep
n4, --kod_group_cust
n5, --kod_group_cust_parent
n6, --vid_real
n7, --kodp
n8, --kod_dog
n9, --ym_vozn
d1, --dat_vozn_norm
n10, --ob
n11, --ob_v2
d2--dat
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_graf" /><column column="n2" info="kod_sf" /><column column="n3" info="kod_dep" /><column column="n4" info="kod_group_cust" /><column column="n5" info="kod_group_cust_parent" /><column column="n6" info="vid_real" /><column column="n7" info="kodp" /><column column="n8" info="kod_dog" /><column column="n9" info="ym_vozn" /><column column="d1" info="dat_vozn_norm" /><column column="n10" info="ob" /><column column="n11" info="ob_v2" /><column column="d2" info="dat" />--qube_graf_in
</insert><select>--qube_graf_in
select 'qube_graf_in' as skod,
'qube_graf_in|#'||mtr.kod_graf||'#'||mtr.kod_sf||'#'||mtr.kod_dep||'#'||mtr.kod_group_cust||'#'||mtr.kod_group_cust_parent||'#'||mtr.kod_dog||'#'||mtr.ym_vozn||'#'||mtr.dat_vozn_norm as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="kod_graf" column="kod_graf" is-private-dimension="kod_graf" is-final-dimension="kod_graf" dimension="kod_graf" as="kod_graf" keypath=".kod_graf" used="1" key="1" type="number" agg="max" sourcetable="./kod_graf" sourcecolumn="kod_graf" into="n1">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" is-private-dimension="kod_sf" is-final-dimension="kod_sf" dimension="kod_sf" as="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" into="n2">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_dep" column="kodp" is-private-dimension="kod_dep" is-final-dimension="kod_dep" dimension="kod_dep" as="kod_dep" reference="kr_dep" refcol="kodp" keypath=".kodp" used="1" key="1" type="number" sourcetable="./kod_dep" sourcecolumn="kodp" into="n3">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_group_cust" column="kod_group_cust" is-private-dimension="kod_group_cust" is-final-dimension="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" keypath=".kod_group_cust" used="1" key="1" type="number" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" into="n4">kod_group_cust.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_group_cust_parent" column="kod_group_cust" is-private-dimension="kod_group_cust_parent" is-final-dimension="kod_group_cust_parent" dimension="kod_group_cust_parent" as="kod_group_cust_parent" reference="ks_group_cust_parent_list" refcol="kod_group_cust" keypath=".kod_group_cust" used="1" key="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" into="n5">kod_group_cust_parent.kod_group_cust as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_sf" column="vid_real" is-private-dimension="vid_real" is-final-dimension="vid_real" dimension="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" into="n6">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_dog" column="kodp" is-private-dimension="kodp" is-final-dimension="kodp" dimension="kodp" as="kodp" used="1" key="0" type="number" sourcetable="./kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n7">kod_dog.kodp as kodp, /*number*/
</column><column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" into="n8">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" into="n9">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" keypath=".dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" into="d1">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column column="fin_ul_ob_os_av_norm1" as="ob" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_in_ob" table="qube" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm" into="n10">qube.fin_ul_ob_os_av_norm1 as ob, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column column="fin_ul_ob_os_av_norm_v21" as="ob_v2" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_in_ob_v2" table="qube" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2" into="n11">qube.fin_ul_ob_os_av_norm_v21 as ob_v2, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><call function="latest" as="dat" pth="" type="date" used="1" key="0" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc" into="d2"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="qube" column="dat" as="dat">qube.dat</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="kod_graf" column="doc_date">kod_graf.doc_date</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat/*Дата документа начисления*//*date*/
</call></select><from>
from <query haskeys="1" as="qube" path="./qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_dep" group="1" as="kod_dep" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*//*key*/
</column><column table="qube" column="kod_group_cust" group="1" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="qube" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" group="1" as="dat_vozn_norm" key="1" fixed="1" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="qube" column="dat" group="1" as="dat" key="1" fixed="1" used="1" type="date" title="Дата документа начисления">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><call function="-nvl" as="fin_ul_ob_os_av_norm1" title="Оборот деб. осн. и ав. (долг)" key="0" group="sum" pth="" type="number" used="1" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sum(<text txtype="func"> nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facvip_norm_av_av_nach1">qube.sr_facvip_norm_av_av_nach1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_facvip_norm_av_osn_nach1">qube.sr_facvip_norm_av_osn_nach1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_norm_av_av_opl1">qube.sr_opl_norm_av_av_opl1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_norm_av_osn_opl1">qube.sr_opl_norm_av_osn_opl1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>)  as fin_ul_ob_os_av_norm1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</call><call function="-nvl" as="fin_ul_ob_os_av_norm_v21" title="Оборот деб. осн. и ав. (долг)" key="0" group="sum" pth="" type="number" used="1" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sum(<text txtype="func"> nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facvip_norm_av_av_nach_v21">qube.sr_facvip_norm_av_av_nach_v21</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_facvip_norm_av_osn_nach_v21">qube.sr_facvip_norm_av_osn_nach_v21</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_norm_av_av_opl_v21">qube.sr_opl_norm_av_av_opl_v21</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_norm_av_osn_opl_v21">qube.sr_opl_norm_av_osn_opl_v21</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>)  as fin_ul_ob_os_av_norm_v21/*Оборот деб. осн. и ав. (долг)*//*number*/
</call></select><from>
from <query as="qube" path="./qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*/
</column><column table="qube" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*/
</column><column table="qube" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="qube" column="dat" as="dat" keypath=".dat" used="1" key="1" type="date" title="Дата документа начисления">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach_v21" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">qube.sr_facvip_norm_av_av_nach_v21 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach_v21" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">qube.sr_facvip_norm_av_osn_nach_v21 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl_v21" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">qube.sr_opl_norm_av_av_opl_v21 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl_v21" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">qube.sr_opl_norm_av_osn_opl_v21 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube" used="1">(
<query path="./qube/qube/qube" used="1">(
<query as="qube" union="1" path="./qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="qube" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*/
</column><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*/
</column><column table="qube" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach_v21" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">qube.sr_facvip_norm_av_av_nach_v21 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach_v21" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">qube.sr_facvip_norm_av_osn_nach_v21 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl_v21" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">qube.sr_opl_norm_av_av_opl_v21 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl_v21" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">qube.sr_opl_norm_av_osn_opl_v21 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления">un.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="dat_vozn_norm" group="1" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="un" column="kod_dep" group="1" as="kod_dep" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">un.kod_dep as kod_dep, /*number*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf as kod_graf, /*number*//*key*/
</column><column table="un" column="kod_group_cust" group="1" as="kod_group_cust" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">un.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="un" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">un.kod_group_cust_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="un" column="sr_facvip_norm_av_av_nach1" group="sum" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sum(un.sr_facvip_norm_av_av_nach1)  as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="un" column="sr_facvip_norm_av_av_nach_v21" group="sum" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sum(un.sr_facvip_norm_av_av_nach_v21)  as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="un" column="sr_facvip_norm_av_osn_nach1" group="sum" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">sum(un.sr_facvip_norm_av_osn_nach1)  as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="un" column="sr_facvip_norm_av_osn_nach_v21" group="sum" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">sum(un.sr_facvip_norm_av_osn_nach_v21)  as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_norm_av_av_opl1" group="sum" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">sum(un.sr_opl_norm_av_av_opl1)  as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_norm_av_av_opl_v21" group="sum" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">sum(un.sr_opl_norm_av_av_opl_v21)  as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_norm_av_osn_opl1" group="sum" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">sum(un.sr_opl_norm_av_osn_opl1)  as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="un" column="sr_opl_norm_av_osn_opl_v21" group="sum" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">sum(un.sr_opl_norm_av_osn_opl_v21)  as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="un" path="./qube/qube/qube/qube/qube/un" used="1">(
<query path="./qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления">dims.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="sr_facvip_norm_av_av" column="nach_av_norm" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sr_facvip_norm_av_av.nach_av_norm as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="sr_facvip_norm_av_av" column="nach_av_norm_v2" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sr_facvip_norm_av_av.nach_av_norm_v2 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf as kod_sf_prm, /*number*//*key*/
</column><column table="kod_sf" column="dat_rep" as="dat" group="1" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_av_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_facvip_norm_av_av" dimension="kod_sf_norm_av_av" as="sr_facvip_norm_av_av_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_av
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" key="0" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf" key="1" as="kod_sf" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_facvip_norm_av_av_a_d
--\sr_facvip_norm_av_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_av_a_d" column="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep" used="1">a.dep as dep, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_rep" as="dat" group="1" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep, /*Дата документа начисления*//*date*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_av_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facvip_norm_av_av" dimension="kod_sf_norm_av_av" as="sr_facvip_norm_av_av" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_norm_av_av
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_av_norm" fact="sr_facvip_norm_av_av_nach" agg="sum" as="nach_av_norm" key="0" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">a.nach_av_norm as nach_av_norm, /*Отчетный период начисления*/
</column><column table="a" column="nach_av_norm_v2" fact="sr_facvip_norm_av_av_nach_v2" agg="sum" as="nach_av_norm_v2" key="0" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">a.nach_av_norm_v2 as nach_av_norm_v2/*Отчетный период начисления*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_av_norm" as="nach_av_norm" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm" used="1" key="0">st.nach_av_norm as nach_av_norm, /*Отчетный период начисления*/
</column><column table="st" column="nach_av_norm_v2" as="nach_av_norm_v2" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2" used="1" key="0">st.nach_av_norm_v2 as nach_av_norm_v2/*Отчетный период начисления*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from><call function="=" type="bool">)
sr_facvip_norm_av_av on <column table="sr_facvip_norm_av_av" column="kod_sf">sr_facvip_norm_av_av.kod_sf</column><text txtype="func"> = </text><column table="dims" column="kod_sf_prm">dims.kod_sf_prm</column></call>--\sr_facvip_norm_av_av
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_in"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="le">(<column table="dat" column="val">dat.val</column><call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления">dims.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><column table="sr_facvip_norm_av_osn" column="nach_osn_norm" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">sr_facvip_norm_av_osn.nach_osn_norm as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="sr_facvip_norm_av_osn" column="nach_osn_norm_v2" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">sr_facvip_norm_av_osn.nach_osn_norm_v2 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf as kod_sf_prm, /*number*//*key*/
</column><column table="kod_sf" column="dat_rep" as="dat" group="1" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_osn_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_facvip_norm_av_osn" dimension="kod_sf_norm_av_osn" as="sr_facvip_norm_av_osn_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_osn
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" key="0" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf" key="1" as="kod_sf" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_facvip_norm_av_osn_a_d
--\sr_facvip_norm_av_osn
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_osn_a_d" column="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep" used="1">a.dep as dep, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_rep" as="dat" group="1" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep, /*Дата документа начисления*//*date*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_osn_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facvip_norm_av_osn" dimension="kod_sf_norm_av_osn" as="sr_facvip_norm_av_osn" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_norm_av_osn
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_osn_norm" fact="sr_facvip_norm_av_osn_nach" agg="sum" as="nach_osn_norm" key="0" used="1" type="number" title="Начислено" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">a.nach_osn_norm as nach_osn_norm, /*Начислено*//*number*/
</column><column table="a" column="nach_osn_norm_v2" fact="sr_facvip_norm_av_osn_nach_v2" agg="sum" as="nach_osn_norm_v2" key="0" used="1" type="number" title="Начислено" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">a.nach_osn_norm_v2 as nach_osn_norm_v2/*Начислено*//*number*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_osn_norm" as="nach_osn_norm" title="Начислено" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm" used="1" key="0">st.nach_osn_norm as nach_osn_norm, /*Начислено*//*number*/
</column><column table="st" column="nach_osn_norm_v2" as="nach_osn_norm_v2" title="Начислено" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2" used="1" key="0">st.nach_osn_norm_v2 as nach_osn_norm_v2/*Начислено*//*number*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from><call function="=" type="bool">)
sr_facvip_norm_av_osn on <column table="sr_facvip_norm_av_osn" column="kod_sf">sr_facvip_norm_av_osn.kod_sf</column><text txtype="func"> = </text><column table="dims" column="kod_sf_prm">dims.kod_sf_prm</column></call>--\sr_facvip_norm_av_osn
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_in"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="le">(<column table="dat" column="val">dat.val</column><call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">dims.dat as dat, /*date*//*key*/
</column><column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><column table="sr_opl_norm_av_av" column="opl" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">sr_opl_norm_av_av.opl as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="sr_opl_norm_av_av" column="opl_v2" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">sr_opl_norm_av_av.opl_v2 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_norm_av_av_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_av_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat" as="dat" group="1" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="sr_opl_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_av_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_opl_norm_av_av" dimension="kod_opl_norm_av_av" as="sr_opl_norm_av_av_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d" used="1">(
<select>--sr_opl_norm_av_av
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query><query name="sr_opl_sf" dimension="1" as="kod_opl" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="1" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl on <column table="a" column="kod_opl" as="kod_opl" key="0" thissrc="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl" column="kod_sf">kod_opl.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_opl_norm_av_av_a_d
--\sr_opl_norm_av_av
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_av_a_d" column="kod_opl">sr_opl_norm_av_av_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" as="kod_dog1_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="dep" used="1">a.dep as dep/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog1_a_d1 on <column table="kod_opl_a_d" column="kod_dog">kod_opl_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog1_a_d1" column="kod_dog">kod_dog1_a_d1.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog1_a_d1" column="kodp">kod_dog1_a_d1.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dep" dimension="kod_dep" as="kod_dep" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dog1_a_d1" column="dep">kod_dog1_a_d1.dep</column><text txtype="func"> = </text><column table="kod_dep" column="kodp">kod_dep.kodp</column></call>--\kr_dep
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_opl_norm_av_av_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_av_a_d.kod_opl, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat" as="dat" group="1" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat, /*date*//*key*/
</column><column table="sr_opl_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_av_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_norm_av_av" dimension="kod_opl_norm_av_av" as="sr_opl_norm_av_av" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av" used="1">left outer join
(
<select>--sr_opl_norm_av_av
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_av" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_av_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">a.opl_av as opl, /*Оплата начислений*//*number*/
</column><column table="a" column="opl_av_v2" agg="sum" as="opl_v2" is-fact="1" fact="sr_opl_norm_av_av_opl_v2" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">a.opl_av_v2 as opl_v2/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_av" as="opl_av" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av" used="1" key="0">st.opl_av as opl_av, /*Оплата начислений*//*number*/
</column><column table="st" column="opl_av_v2" as="opl_av_v2" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2" used="1" key="0">st.opl_av_v2 as opl_av_v2/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from><call function="=" type="bool">)
sr_opl_norm_av_av on <column table="sr_opl_norm_av_av" column="kod_opl">sr_opl_norm_av_av.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_norm_av_av
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_in"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="le">(<column table="dat" column="val">dat.val</column><call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">dims.dat as dat, /*date*//*key*/
</column><column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><column table="sr_opl_norm_av_osn" column="opl" as="sr_opl_norm_av_osn_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">sr_opl_norm_av_osn.opl as sr_opl_norm_av_osn_opl1, /*Оплата начислений*//*number*/
</column><column table="sr_opl_norm_av_osn" column="opl_v2" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">sr_opl_norm_av_osn.opl_v2 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*//*number*/
</column></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_norm_av_osn_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat" as="dat" group="1" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="sr_opl_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_osn_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_opl_norm_av_osn" dimension="kod_opl_norm_av_osn" as="sr_opl_norm_av_osn_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d" used="1">(
<select>--sr_opl_norm_av_osn
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query><query name="sr_opl_sf" dimension="1" as="kod_opl" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="1" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl on <column table="a" column="kod_opl" as="kod_opl" key="0" thissrc="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl" column="kod_sf">kod_opl.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_opl_norm_av_osn_a_d
--\sr_opl_norm_av_osn
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_osn_a_d" column="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" as="kod_dog1_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="dep" used="1">a.dep as dep/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog1_a_d1 on <column table="kod_opl_a_d" column="kod_dog">kod_opl_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog1_a_d1" column="kod_dog">kod_dog1_a_d1.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog1_a_d1" column="kodp">kod_dog1_a_d1.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dep" dimension="kod_dep" as="kod_dep" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dog1_a_d1" column="dep">kod_dog1_a_d1.dep</column><text txtype="func"> = </text><column table="kod_dep" column="kodp">kod_dep.kodp</column></call>--\kr_dep
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_opl_norm_av_osn_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat" as="dat" group="1" used="1" key="1" type="date" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat, /*date*//*key*/
</column><column table="sr_opl_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_osn_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_norm_av_osn" dimension="kod_opl_norm_av_osn" as="sr_opl_norm_av_osn" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn" used="1">left outer join
(
<select>--sr_opl_norm_av_osn
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_osn" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_osn_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">a.opl_osn as opl, /*Оплата начислений*//*number*/
</column><column table="a" column="opl_osn_v2" agg="sum" as="opl_v2" is-fact="1" fact="sr_opl_norm_av_osn_opl_v2" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">a.opl_osn_v2 as opl_v2/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_osn" as="opl_osn" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn" used="1" key="0">st.opl_osn as opl_osn, /*Оплата начислений*//*number*/
</column><column table="st" column="opl_osn_v2" as="opl_osn_v2" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2" used="1" key="0">st.opl_osn_v2 as opl_osn_v2/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from><call function="=" type="bool">)
sr_opl_norm_av_osn on <column table="sr_opl_norm_av_osn" column="kod_opl">sr_opl_norm_av_osn.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_norm_av_osn
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_in"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="le">(<column table="dat" column="val">dat.val</column><call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления">un.dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="dat_vozn_norm" group="1" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="un" column="kod_dep" group="1" as="kod_dep" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">un.kod_dep, /*number*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf, /*number*//*key*/
</column><column table="un" column="kod_group_cust" group="1" as="kod_group_cust" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">un.kod_group_cust, /*number*//*key*/
</column><column table="un" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">un.kod_group_cust_parent, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">un.kod_sf, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_dep" group="1" as="kod_dep" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep, /*number*//*key*/
</column><column table="qube" column="kod_group_cust" group="1" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust, /*number*//*key*/
</column><column table="qube" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" group="1" as="dat_vozn_norm" key="1" fixed="1" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="qube" column="dat" group="1" as="dat" key="1" fixed="1" used="1" type="date" title="Дата документа начисления">qube.dat/*Дата документа начисления*//*date*//*key*/
</column></group>)
qube
--\
</query><query name="ks_group_cust_parent_list" dimension="kod_group_cust_parent" link-mp-point="1" as="kod_group_cust_parent" join="left outer" path="./kod_group_cust_parent" order="n_num_cust" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="n_num_cust">n_num_cust</column></order><select>--ks_group_cust_parent_list
select <column table="a" column="kod_group_cust" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="num_cust" as="n_num_cust" key="0" used="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="num_cust">a.num_cust as n_num_cust/*number*/
</column></select><from>
from <query name="ks_group_cust" as="a" path="./kod_group_cust_parent/a" haskeys="1" used="1">(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="num_cust" type="number" title="" as="num_cust" key="0" sourcetable="./kod_group_cust_parent/a" sourcecolumn="num_cust" used="1">a.num_cust as num_cust, /**//*number*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from>)
a
--\ks_group_cust
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is null" pth="" type="bool">(<column table="a" column="kod_gr_parent">a.kod_gr_parent</column><text txtype="func"> is null </text>) </call></call></where><call function="=" type="bool">)
kod_group_cust_parent on <column table="kod_group_cust_parent" column="kod_group_cust">kod_group_cust_parent.kod_group_cust</column><text txtype="func"> = </text><column table="qube" column="kod_group_cust_parent">qube.kod_group_cust_parent</column></call>--\ks_group_cust_parent_list
</query><query name="ks_group_cust" dimension="kod_group_cust" link-mp-point="1" as="kod_group_cust" join="left outer" path="./kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*//*key*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" dimension="kod_group_cust" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column><text txtype="func"> = </text><column table="qube" column="kod_group_cust">qube.kod_group_cust</column></call>--\ks_group_cust
</query><query name="kr_dep" dimension="kod_dep" link-mp-point="1" as="kod_dep" join="left outer" path="./kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dep" column="kodp">kod_dep.kodp</column><text txtype="func"> = </text><column table="qube" column="kod_dep">qube.kod_dep</column></call>--\kr_dep
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query><query name="ur_graf" dimension="kod_graf" link-mp-point="1" as="kod_graf" join="left outer" path="./kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><call function="coalesce" as="doc_date" type="date" title="Дата документа" key="0" pth="" used="1" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc"><text txtype="func"> coalesce( </text><column table="kod_sogl" column="dat_doc">kod_sogl.dat_doc</column><text txtype="func"> , </text><column table="kod_hist_mat2" column="dat_post">kod_hist_mat2.dat_post</column><text txtype="func"> , </text><column table="kod_isp" column="dat_doc">kod_isp.dat_doc</column><text txtype="func"> ) </text> as doc_date/*Дата документа*//*date*/
</call></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table><query name="ur_hist_mat" as="kod_hist_mat2" join="left outer" path="./kod_graf/kod_hist_mat2" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./kod_graf/kod_hist_mat2" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="dat_post" type="date" title="Дата прин. суд. акта" column-mandatory="1" comment="Дата принятия судебного акта" as="dat_post" key="0" sourcetable="./kod_graf/kod_hist_mat2" sourcecolumn="dat_post" used="1">a.dat_post as dat_post/*Дата прин. суд. акта*//*date*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat2 on <column table="a" column="kod_hist_mat">a.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat2" column="kod_hist_mat">kod_hist_mat2.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_sogl" as="kod_sogl" join="left outer" path="./kod_graf/kod_sogl" haskeys="1" used="1">left outer join
(
<select>--ur_sogl
select <column table="a" column="kod_sogl" type="number" key-dimension="kod_sogl" as="kod_sogl" key="1" fixed="1" sourcetable="./kod_graf/kod_sogl" sourcecolumn="kod_sogl" used="1">a.kod_sogl as kod_sogl, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата доп. документа" column-mandatory="1" column-default="today" as="dat_doc" key="0" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата доп. документа*//*date*/
</column></select><from>
from <table name="ur_sogl" as="a" title="Доп. документ (арбитраж)" used="1">ur_sogl
a
--\ur_sogl
</table></from><call function="=" type="bool">)
kod_sogl on <column table="a" column="kod_sogl">a.kod_sogl</column><text txtype="func"> = </text><column table="kod_sogl" column="kod_sogl">kod_sogl.kod_sogl</column></call>--\ur_sogl
</query><query name="ur_isp" as="kod_isp" join="left outer" path="./kod_graf/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./kod_graf/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата выдачи исп. листа" fact="ur_isp_dat_doc" agg="max" dimension="dat_ur" as="dat_doc" key="0" sourcetable="./kod_graf/kod_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата выдачи исп. листа*//*date*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="a" column="kod_isp">a.kod_isp</column><text txtype="func"> = </text><column table="kod_isp" column="kod_isp">kod_isp.kod_isp</column></call>--\ur_isp
</query></from><call function="=" type="bool">)
kod_graf on <column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> = </text><column table="qube" column="kod_graf">qube.kod_graf</column></call>--\ur_graf
</query></from>) mtr
;
--\qube_graf_in
</query>
  <query name="qube_graf_out" class="1" use-repository="1" materialize="1" timestamp="29.06.2023 14:36:14" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\ur_graf.xml" path="." noname="1" used="1">
delete from rr_temp where skod = 'qube_graf_out';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_graf
n2, --kod_sf
n3, --kod_dep
n4, --kod_group_cust
n5, --kod_group_cust_parent
n6, --kod_dog
n7, --kodp
n8, --vid_real
n9, --ym_vozn
d1, --dat_vozn_norm
n10, --ob
n11, --ob_v2
d2--dat_finish
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_graf" /><column column="n2" info="kod_sf" /><column column="n3" info="kod_dep" /><column column="n4" info="kod_group_cust" /><column column="n5" info="kod_group_cust_parent" /><column column="n6" info="kod_dog" /><column column="n7" info="kodp" /><column column="n8" info="vid_real" /><column column="n9" info="ym_vozn" /><column column="d1" info="dat_vozn_norm" /><column column="n10" info="ob" /><column column="n11" info="ob_v2" /><column column="d2" info="dat_finish" />--qube_graf_out
</insert><select>--qube_graf_out
select 'qube_graf_out' as skod,
'qube_graf_out|#'||mtr.kod_graf||'#'||mtr.kod_sf||'#'||mtr.kod_dep||'#'||mtr.kod_group_cust||'#'||mtr.kod_group_cust_parent||'#'||mtr.kod_dog||'#'||mtr.ym_vozn||'#'||mtr.dat_vozn_norm as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="kod_graf" column="kod_graf" as="kod_graf" keypath=".kod_graf" used="1" key="1" type="number" agg="max" sourcetable="./kod_graf" sourcecolumn="kod_graf" into="n1">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" is-private-dimension="kod_sf" is-final-dimension="kod_sf" dimension="kod_sf" as="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" into="n2">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_dep" column="kodp" is-private-dimension="kod_dep" is-final-dimension="kod_dep" dimension="kod_dep" as="kod_dep" reference="kr_dep" refcol="kodp" keypath=".kodp" used="1" key="1" type="number" sourcetable="./kod_dep" sourcecolumn="kodp" into="n3">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_group_cust" column="kod_group_cust" is-private-dimension="kod_group_cust" is-final-dimension="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" keypath=".kod_group_cust" used="1" key="1" type="number" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" into="n4">kod_group_cust.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_group_cust_parent" column="kod_group_cust" is-private-dimension="kod_group_cust_parent" is-final-dimension="kod_group_cust_parent" dimension="kod_group_cust_parent" as="kod_group_cust_parent" reference="ks_group_cust_parent_list" refcol="kod_group_cust" keypath=".kod_group_cust" used="1" key="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" into="n5">kod_group_cust_parent.kod_group_cust as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" into="n6">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dog" column="kodp" is-private-dimension="kodp" is-final-dimension="kodp" dimension="kodp" as="kodp" used="1" key="0" type="number" sourcetable="./kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n7">kod_dog.kodp as kodp, /*number*/
</column><column table="kod_sf" column="vid_real" is-private-dimension="vid_real" is-final-dimension="vid_real" dimension="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" into="n8">kod_sf.vid_real as vid_real, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" into="n9">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" keypath=".dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" into="d1">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column column="fin_ul_ob_os_av_norm1" as="ob" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_out_ob" table="qube" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm" into="n10">qube.fin_ul_ob_os_av_norm1 as ob, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column column="fin_ul_ob_os_av_norm_v21" as="ob_v2" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_out_ob_v2" table="qube" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2" into="n11">qube.fin_ul_ob_os_av_norm_v21 as ob_v2, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="kod_graf" column="dat_finish" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" as="dat_finish" used="1" key="0" type="date" title="Дата окончания действия графика" sourcetable="./kod_graf" sourcecolumn="dat_finish" into="d2">kod_graf.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <query haskeys="1" as="qube" path="./qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_dep" group="1" as="kod_dep" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*//*key*/
</column><column table="qube" column="kod_group_cust" group="1" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="qube" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" group="1" as="dat_vozn_norm" key="1" fixed="1" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><call function="-nvl" as="fin_ul_ob_os_av_norm1" title="Оборот деб. осн. и ав. (долг)" key="0" group="sum" pth="" type="number" used="1" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sum(<text txtype="func"> nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facvip_norm_av_av_nach1">qube.sr_facvip_norm_av_av_nach1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_facvip_norm_av_osn_nach1">qube.sr_facvip_norm_av_osn_nach1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_norm_av_av_opl1">qube.sr_opl_norm_av_av_opl1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_norm_av_osn_opl1">qube.sr_opl_norm_av_osn_opl1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>)  as fin_ul_ob_os_av_norm1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</call><call function="-nvl" as="fin_ul_ob_os_av_norm_v21" title="Оборот деб. осн. и ав. (долг)" key="0" group="sum" pth="" type="number" used="1" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sum(<text txtype="func"> nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facvip_norm_av_av_nach_v21">qube.sr_facvip_norm_av_av_nach_v21</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_facvip_norm_av_osn_nach_v21">qube.sr_facvip_norm_av_osn_nach_v21</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_norm_av_av_opl_v21">qube.sr_opl_norm_av_av_opl_v21</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_norm_av_osn_opl_v21">qube.sr_opl_norm_av_osn_opl_v21</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>)  as fin_ul_ob_os_av_norm_v21/*Оборот деб. осн. и ав. (долг)*//*number*/
</call></select><from>
from <query as="qube" path="./qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*/
</column><column table="qube" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*/
</column><column table="qube" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" keypath=".dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach_v21" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">qube.sr_facvip_norm_av_av_nach_v21 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach_v21" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">qube.sr_facvip_norm_av_osn_nach_v21 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl_v21" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">qube.sr_opl_norm_av_av_opl_v21 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl_v21" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">qube.sr_opl_norm_av_osn_opl_v21 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube" used="1">(
<query path="./qube/qube/qube" used="1">(
<query as="qube" union="1" path="./qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="qube" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep as kod_dep, /*number*/
</column><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust as kod_group_cust, /*number*/
</column><column table="qube" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach_v21" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">qube.sr_facvip_norm_av_av_nach_v21 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach_v21" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">qube.sr_facvip_norm_av_osn_nach_v21 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl_v21" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">qube.sr_opl_norm_av_av_opl_v21 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl_v21" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">qube.sr_opl_norm_av_osn_opl_v21 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="qube" path="./qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat_vozn_norm" group="1" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="un" column="kod_dep" group="1" as="kod_dep" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">un.kod_dep as kod_dep, /*number*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf as kod_graf, /*number*//*key*/
</column><column table="un" column="kod_group_cust" group="1" as="kod_group_cust" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">un.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="un" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">un.kod_group_cust_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="un" column="sr_facvip_norm_av_av_nach1" group="sum" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sum(un.sr_facvip_norm_av_av_nach1)  as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="un" column="sr_facvip_norm_av_av_nach_v21" group="sum" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sum(un.sr_facvip_norm_av_av_nach_v21)  as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><column table="un" column="sr_facvip_norm_av_osn_nach1" group="sum" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">sum(un.sr_facvip_norm_av_osn_nach1)  as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="un" column="sr_facvip_norm_av_osn_nach_v21" group="sum" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">sum(un.sr_facvip_norm_av_osn_nach_v21)  as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_norm_av_av_opl1" group="sum" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">sum(un.sr_opl_norm_av_av_opl1)  as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_norm_av_av_opl_v21" group="sum" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">sum(un.sr_opl_norm_av_av_opl_v21)  as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_norm_av_osn_opl1" group="sum" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">sum(un.sr_opl_norm_av_osn_opl1)  as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="un" column="sr_opl_norm_av_osn_opl_v21" group="sum" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">sum(un.sr_opl_norm_av_osn_opl_v21)  as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*/
</column></select><from>
from <query as="un" path="./qube/qube/qube/qube/qube/un" used="1">(
<query path="./qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="sr_facvip_norm_av_av" column="nach_av_norm" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">sr_facvip_norm_av_av.nach_av_norm as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="sr_facvip_norm_av_av" column="nach_av_norm_v2" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">sr_facvip_norm_av_av.nach_av_norm_v2 as sr_facvip_norm_av_av_nach_v21, /*Отчетный период начисления*/
</column><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf as kod_sf_prm, /*number*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_av_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_facvip_norm_av_av" dimension="kod_sf_norm_av_av" as="sr_facvip_norm_av_av_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_av
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" key="0" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf" key="1" as="kod_sf" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_facvip_norm_av_av_a_d
--\sr_facvip_norm_av_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_av_a_d" column="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep" used="1">a.dep as dep, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt;= </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf, /*number*//*key*/
</column><column table="sr_facvip_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_av_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facvip_norm_av_av" dimension="kod_sf_norm_av_av" as="sr_facvip_norm_av_av" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_norm_av_av
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_av_norm" fact="sr_facvip_norm_av_av_nach" agg="sum" as="nach_av_norm" key="0" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm">a.nach_av_norm as nach_av_norm, /*Отчетный период начисления*/
</column><column table="a" column="nach_av_norm_v2" fact="sr_facvip_norm_av_av_nach_v2" agg="sum" as="nach_av_norm_v2" key="0" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2">a.nach_av_norm_v2 as nach_av_norm_v2/*Отчетный период начисления*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_av_norm" as="nach_av_norm" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm" used="1" key="0">st.nach_av_norm as nach_av_norm, /*Отчетный период начисления*/
</column><column table="st" column="nach_av_norm_v2" as="nach_av_norm_v2" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av/a" sourcecolumn="nach_av_norm_v2" used="1" key="0">st.nach_av_norm_v2 as nach_av_norm_v2/*Отчетный период начисления*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from><call function="=" type="bool">)
sr_facvip_norm_av_av on <column table="sr_facvip_norm_av_av" column="kod_sf">sr_facvip_norm_av_av.kod_sf</column><text txtype="func"> = </text><column table="dims" column="kod_sf_prm">dims.kod_sf_prm</column></call>--\sr_facvip_norm_av_av
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_out"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="is not null">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="le">(<column table="dat" column="val">dat.val</column><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><column table="sr_facvip_norm_av_osn" column="nach_osn_norm" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">sr_facvip_norm_av_osn.nach_osn_norm as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="sr_facvip_norm_av_osn" column="nach_osn_norm_v2" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">sr_facvip_norm_av_osn.nach_osn_norm_v2 as sr_facvip_norm_av_osn_nach_v21, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf as kod_sf_prm, /*number*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_osn_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_facvip_norm_av_osn" dimension="kod_sf_norm_av_osn" as="sr_facvip_norm_av_osn_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_osn
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" key="0" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf" key="1" as="kod_sf" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_facvip_norm_av_osn_a_d
--\sr_facvip_norm_av_osn
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_osn_a_d" column="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep" used="1">a.dep as dep, /**//*number*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt;= </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf, /*number*//*key*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_facvip_norm_av_osn_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dog" column="dep" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">kod_dog.dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facvip_norm_av_osn" dimension="kod_sf_norm_av_osn" as="sr_facvip_norm_av_osn" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_norm_av_osn
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_osn_norm" fact="sr_facvip_norm_av_osn_nach" agg="sum" as="nach_osn_norm" key="0" used="1" type="number" title="Начислено" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm">a.nach_osn_norm as nach_osn_norm, /*Начислено*//*number*/
</column><column table="a" column="nach_osn_norm_v2" fact="sr_facvip_norm_av_osn_nach_v2" agg="sum" as="nach_osn_norm_v2" key="0" used="1" type="number" title="Начислено" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2">a.nach_osn_norm_v2 as nach_osn_norm_v2/*Начислено*//*number*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_osn_norm" as="nach_osn_norm" title="Начислено" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm" used="1" key="0">st.nach_osn_norm as nach_osn_norm, /*Начислено*//*number*/
</column><column table="st" column="nach_osn_norm_v2" as="nach_osn_norm_v2" title="Начислено" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn/a" sourcecolumn="nach_osn_norm_v2" used="1" key="0">st.nach_osn_norm_v2 as nach_osn_norm_v2/*Начислено*//*number*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from><call function="=" type="bool">)
sr_facvip_norm_av_osn on <column table="sr_facvip_norm_av_osn" column="kod_sf">sr_facvip_norm_av_osn.kod_sf</column><text txtype="func"> = </text><column table="dims" column="kod_sf_prm">dims.kod_sf_prm</column></call>--\sr_facvip_norm_av_osn
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_out"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="is not null">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="le">(<column table="dat" column="val">dat.val</column><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><column table="sr_opl_norm_av_av" column="opl" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">sr_opl_norm_av_av.opl as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="sr_opl_norm_av_av" column="opl_v2" as="sr_opl_norm_av_av_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">sr_opl_norm_av_av.opl_v2 as sr_opl_norm_av_av_opl_v21, /*Оплата начислений*//*number*/
</column><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl_v21/**/
</const></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_norm_av_av_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_av_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="sr_opl_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_av_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_opl_norm_av_av" dimension="kod_opl_norm_av_av" as="sr_opl_norm_av_av_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d" used="1">(
<select>--sr_opl_norm_av_av
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query><query name="sr_opl_sf" dimension="1" as="kod_opl" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_opl" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="1" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl on <column table="a" column="kod_opl" as="kod_opl" key="0" thissrc="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl" column="kod_sf">kod_opl.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_opl_norm_av_av_a_d
--\sr_opl_norm_av_av
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_av_a_d" column="kod_opl">sr_opl_norm_av_av_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" as="kod_dog1_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="dep" used="1">a.dep as dep/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog1_a_d1 on <column table="kod_opl_a_d" column="kod_dog">kod_opl_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog1_a_d1" column="kod_dog">kod_dog1_a_d1.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog1_a_d1" column="kodp">kod_dog1_a_d1.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dep" dimension="kod_dep" as="kod_dep" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dog1_a_d1" column="dep">kod_dog1_a_d1.dep</column><text txtype="func"> = </text><column table="kod_dep" column="kodp">kod_dep.kodp</column></call>--\kr_dep
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_opl_norm_av_av_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_av_a_d.kod_opl, /*number*//*key*/
</column><column table="sr_opl_norm_av_av_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_av_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_norm_av_av" dimension="kod_opl_norm_av_av" as="sr_opl_norm_av_av" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av" used="1">left outer join
(
<select>--sr_opl_norm_av_av
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_av" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_av_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av">a.opl_av as opl, /*Оплата начислений*//*number*/
</column><column table="a" column="opl_av_v2" agg="sum" as="opl_v2" is-fact="1" fact="sr_opl_norm_av_av_opl_v2" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2">a.opl_av_v2 as opl_v2/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_av" as="opl_av" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av" used="1" key="0">st.opl_av as opl_av, /*Оплата начислений*//*number*/
</column><column table="st" column="opl_av_v2" as="opl_av_v2" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av/a" sourcecolumn="opl_av_v2" used="1" key="0">st.opl_av_v2 as opl_av_v2/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from><call function="=" type="bool">)
sr_opl_norm_av_av on <column table="sr_opl_norm_av_av" column="kod_opl">sr_opl_norm_av_av.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_norm_av_av
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_out"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="is not null">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="le">(<column table="dat" column="val">dat.val</column><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat_vozn_norm" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="dims" column="kod_dep" as="kod_dep" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">dims.kod_dep as kod_dep, /*number*/
</column><column table="dims" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="dims" column="kod_group_cust" as="kod_group_cust" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">dims.kod_group_cust as kod_group_cust, /*number*/
</column><column table="dims" column="kod_group_cust_parent" as="kod_group_cust_parent" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">dims.kod_group_cust_parent as kod_group_cust_parent, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="dims" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">dims.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="" as="sr_facvip_norm_av_av_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach_v21, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_facvip_norm_av_osn_nach_v21" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach_v21, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl_v21" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl_v21, /*number*/
</const><column table="sr_opl_norm_av_osn" column="opl" as="sr_opl_norm_av_osn_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">sr_opl_norm_av_osn.opl as sr_opl_norm_av_osn_opl1, /*Оплата начислений*//*number*/
</column><column table="sr_opl_norm_av_osn" column="opl_v2" as="sr_opl_norm_av_osn_opl_v21" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">sr_opl_norm_av_osn.opl_v2 as sr_opl_norm_av_osn_opl_v21/*Оплата начислений*//*number*/
</column></select><from>
from <query as="dims" path="./qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_norm_av_osn_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="sr_opl_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_osn_a_d.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp as kod_dep, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent as kod_group_cust_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></select><from>
from <query name="sr_opl_norm_av_osn" dimension="kod_opl_norm_av_osn" as="sr_opl_norm_av_osn_a_d" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d" used="1">(
<select>--sr_opl_norm_av_osn
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="kod_sf" column="dat_vozn_otch" dimension="dat_vozn_norm" as="dat_vozn_norm" used="1" key="0" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.dat_vozn_otch as dat_vozn_norm/*Отчетный период начисления*//*date*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query><query name="sr_opl_sf" dimension="1" as="kod_opl" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_opl" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="1" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl on <column table="a" column="kod_opl" as="kod_opl" key="0" thissrc="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="add_months" type="date" as="dat_vozn_otch" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> add_months( </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text> as dat_vozn_otch/*Отчетный период начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl" column="kod_sf">kod_opl.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from>)
sr_opl_norm_av_osn_a_d
--\sr_opl_norm_av_osn
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_osn_a_d" column="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust" column="kod_gr_parent" dimension="kod_group_cust_parent" as="kod_gr_parent" key="0" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_group_cust.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table><query name="kr_dogovor_dop" as="kod_dog_dop" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor_dop
select <column table="a" column="kod_dog" type="number" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_group_cust" type="number" comment="код группы потребителей ээ" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_dog_dop" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*/
</column></select><from>
from <table name="kr_dogovor_dop" as="a" used="1">kr_dogovor_dop
a
--\kr_dogovor_dop
</table></from><call function="=" type="bool">)
kod_dog_dop on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog_dop" column="kod_dog">kod_dog_dop.kod_dog</column></call>--\kr_dogovor_dop
</query><query name="ks_group_cust" as="kod_group_cust" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_dog_dop" column="kod_group_cust">kod_dog_dop.kod_group_cust</column><text txtype="func"> = </text><column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column></call>--\ks_group_cust
</query></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" as="kod_dog1_a_d1" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog1_a_d1" sourcecolumn="dep" used="1">a.dep as dep/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog1_a_d1 on <column table="kod_opl_a_d" column="kod_dog">kod_opl_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog1_a_d1" column="kod_dog">kod_dog1_a_d1.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" dimension="kodp" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" dimension="kodp" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog1_a_d1" column="kodp">kod_dog1_a_d1.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_dep" dimension="kod_dep" as="kod_dep" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dog1_a_d1" column="dep">kod_dog1_a_d1.dep</column><text txtype="func"> = </text><column table="kod_dep" column="kodp">kod_dep.kodp</column></call>--\kr_dep
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="sr_opl_norm_av_osn_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl, /*number*//*key*/
</column><column table="sr_opl_norm_av_osn_a_d" column="dat_vozn_norm" as="dat_vozn_norm" group="1" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_opl_norm_av_osn_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_norm_av_osn_a_d.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="kod_dep" column="kodp" as="kod_dep" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dep" sourcecolumn="kodp">kod_dep.kodp, /*number*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_group_cust" as="kod_group_cust" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">kod_dog.kod_group_cust, /*number*//*key*/
</column><column table="kod_dog" column="kod_gr_parent" as="kod_group_cust_parent" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">kod_dog.kod_gr_parent, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf, /*number*//*key*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" group="1" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_norm_av_osn" dimension="kod_opl_norm_av_osn" as="sr_opl_norm_av_osn" join="left outer" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn" used="1">left outer join
(
<select>--sr_opl_norm_av_osn
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_osn" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_osn_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn">a.opl_osn as opl, /*Оплата начислений*//*number*/
</column><column table="a" column="opl_osn_v2" agg="sum" as="opl_v2" is-fact="1" fact="sr_opl_norm_av_osn_opl_v2" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2">a.opl_osn_v2 as opl_v2/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_osn" as="opl_osn" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn" used="1" key="0">st.opl_osn as opl_osn, /*Оплата начислений*//*number*/
</column><column table="st" column="opl_osn_v2" as="opl_osn_v2" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn/a" sourcecolumn="opl_osn_v2" used="1" key="0">st.opl_osn_v2 as opl_osn_v2/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from><call function="=" type="bool">)
sr_opl_norm_av_osn on <column table="sr_opl_norm_av_osn" column="kod_opl">sr_opl_norm_av_osn.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_norm_av_osn
</query><qubecontent><where>where
<call function="and" condsource="qube_graf_out"><call function="is not null">(<column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column>) </call><call function="in">(<column table="kod_sf" column="vid_real">kod_sf.vid_real</column><call function="array">(<const>2</const>) </call>) </call><call function="is not null">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="le">(<column table="dat" column="val">dat.val</column><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat_vozn_norm" group="1" as="dat_vozn_norm" used="1" key="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.dat_vozn_norm, /*Отчетный период начисления*//*date*//*key*/
</column><column table="un" column="kod_dep" group="1" as="kod_dep" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">un.kod_dep, /*number*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf, /*number*//*key*/
</column><column table="un" column="kod_group_cust" group="1" as="kod_group_cust" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">un.kod_group_cust, /*number*//*key*/
</column><column table="un" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">un.kod_group_cust_parent, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">un.kod_sf, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">qube.kod_sf, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_dep" group="1" as="kod_dep" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="dep">qube.kod_dep, /*number*//*key*/
</column><column table="qube" column="kod_group_cust" group="1" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_group_cust">qube.kod_group_cust, /*number*//*key*/
</column><column table="qube" column="kod_group_cust_parent" group="1" as="kod_group_cust_parent" key="1" fixed="1" used="1" type="number" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_dog/kod_group_cust" sourcecolumn="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust">qube.kod_group_cust_parent, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="dat_vozn_norm" group="1" as="dat_vozn_norm" key="1" fixed="1" used="1" type="date" title="Отчетный период начисления" format="F2" sourcetable="./qube/qube/qube/qube/qube/un/un/dims/sr_facvip_norm_av_av_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.dat_vozn_norm/*Отчетный период начисления*//*date*//*key*/
</column></group>)
qube
--\
</query><query name="ks_group_cust_parent_list" dimension="kod_group_cust_parent" link-mp-point="1" as="kod_group_cust_parent" join="left outer" path="./kod_group_cust_parent" order="n_num_cust" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="n_num_cust">n_num_cust</column></order><select>--ks_group_cust_parent_list
select <column table="a" column="kod_group_cust" as="kod_group_cust" key="1" fixed="1" used="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="num_cust" as="n_num_cust" key="0" used="1" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="num_cust">a.num_cust as n_num_cust/*number*/
</column></select><from>
from <query name="ks_group_cust" as="a" path="./kod_group_cust_parent/a" haskeys="1" used="1">(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust, /*number*//*key*/
</column><column table="a" column="num_cust" type="number" title="" as="num_cust" key="0" sourcetable="./kod_group_cust_parent/a" sourcecolumn="num_cust" used="1">a.num_cust as num_cust, /**//*number*/
</column><column table="a" column="kod_gr_parent" type="number" as="kod_gr_parent" reference="ks_group_cust" refcol="kod_group_cust" key="0" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_gr_parent" used="1">a.kod_gr_parent as kod_gr_parent/*number*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" used="1">kv_group_cust
a
--\kv_group_cust
</table></from>)
a
--\ks_group_cust
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is null" pth="" type="bool">(<column table="a" column="kod_gr_parent">a.kod_gr_parent</column><text txtype="func"> is null </text>) </call></call></where><call function="=" type="bool">)
kod_group_cust_parent on <column table="kod_group_cust_parent" column="kod_group_cust">kod_group_cust_parent.kod_group_cust</column><text txtype="func"> = </text><column table="qube" column="kod_group_cust_parent">qube.kod_group_cust_parent</column></call>--\ks_group_cust_parent_list
</query><query name="ks_group_cust" dimension="kod_group_cust" link-mp-point="1" as="kod_group_cust" join="left outer" path="./kod_group_cust" haskeys="1" used="1">left outer join
(
<select>--ks_group_cust
select <column table="a" column="kod_group_cust" type="number" as="kod_group_cust" key="1" fixed="1" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" used="1">a.kod_group_cust as kod_group_cust/*number*//*key*/
</column></select><from>
from <table name="kv_group_cust" as="a" comment="вместо ks_group_cust 37369(6)" dimension="kod_group_cust" used="1">kv_group_cust
a
--\kv_group_cust
</table></from><call function="=" type="bool">)
kod_group_cust on <column table="kod_group_cust" column="kod_group_cust">kod_group_cust.kod_group_cust</column><text txtype="func"> = </text><column table="qube" column="kod_group_cust">qube.kod_group_cust</column></call>--\ks_group_cust
</query><query name="kr_dep" dimension="kod_dep" link-mp-point="1" as="kod_dep" join="left outer" path="./kod_dep" order="name" haskeys="1" used="1">left outer join
(
<order notext="1"><column column="name">name</column></order><select>--kr_dep
select <column table="a" column="kodp" type="number" as="kodp" key="1" fixed="1" sourcetable="./kod_dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="name" title="Отделение" as="name" key="0" used="1" type="string" sourcetable="./kod_dep/kodp" sourcecolumn="name">kodp.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_dep" as="a" view="1" dimension="kod_dep" used="1"><text>(
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE kod_ecls = 4
      AND kod_separator = 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    )</text>a
--\kr_dep
</table><query name="kr_org" as="kodp" join="left outer" path="./kod_dep/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./kod_dep/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./kod_dep/kodp" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
kodp on <column table="a" column="kodp">a.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_org
</query></from><call function="=" type="bool">)
kod_dep on <column table="kod_dep" column="kodp">kod_dep.kodp</column><text txtype="func"> = </text><column table="qube" column="kod_dep">qube.kod_dep</column></call>--\kr_dep
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query><query name="ur_graf" dimension="kod_graf" link-mp-point="1" as="kod_graf" join="left outer" path="./kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> = </text><column table="qube" column="kod_graf">qube.kod_graf</column></call>--\ur_graf
</query></from>) mtr
;
--\qube_graf_out
</query>
  <query name="sr_opl_recalc_tree_info" timestamp="21.02.2018 19:35:47" class="1" intrval="FREQ=DAILY; INTERVAL=1" materialize="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_opl_recalc_tree_info.xml" haskeys="1" path="." noname="1" used="1">
delete from rr_temp where skod = 'sr_opl_recalc_tree_info';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_opl_root
n2--kod_opl
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_opl_root" /><column column="n2" info="kod_opl" />--sr_opl_recalc_tree_info
</insert><select>--sr_opl_recalc_tree_info
select 'sr_opl_recalc_tree_info' as skod,
'sr_opl_recalc_tree_info|#'||mtr.kod_opl as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="a" column="kod_opl_root" index="1" as="kod_opl_root" key="0" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_opl" into="n1">a.kod_opl_root as kod_opl_root, /*number*/
</column><column table="a" column="kod_opl" index="1" as="kod_opl" key="1" fixed="1" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_opl" into="n2">a.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <query name="sr_opl_recalc_tree_info_pre2" as="a" path="./a" haskeys="1" used="1">(
<select>--sr_opl_recalc_tree_info_pre2
select <call function="connect_by_root" as="kod_opl_root" key="0" pth="" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_opl"><text txtype="func"> connect_by_root </text><column table="a" column="kod_opl">a.kod_opl</column> as kod_opl_root, /*number*/
</call><column table="a" column="kod_opl" as="kod_opl" key="1" fixed="1" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <query name="sr_opl_recalc_tree_info_pre1" as="a" path="./a/a" haskeys="1" used="1">(
<select>--sr_opl_recalc_tree_info_pre1
select <column table="a" column="kod_opl" as="kod_opl" key="1" fixed="1" used="1" type="number" sourcetable="./a/a/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="kod_opl_par_rec" column="kod_opl" as="kod_opl_par_rec" key="0" used="1" type="number" sourcetable="./a/a/kod_opl_par_rec" sourcecolumn="kod_opl">kod_opl_par_rec.kod_opl as kod_opl_par_rec/*number*/
</column></select><from>
from <query name="sr_opl" as="a" path="./a/a/a" haskeys="1" used="1">(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./a/a/a" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" sourcetable="./a/a/a" sourcecolumn="kod_type_opl" used="1">a.kod_type_opl as kod_type_opl/*number*/
</column></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table></from>)
a
--\sr_opl
</query><query name="sr_recalc_opl" as="sr_recalc_opl" join="left outer" path="./a/a/sr_recalc_opl" haskeys="1" used="1">left outer join
(
<select>--sr_recalc_opl
select <column table="a" column="kod_recalc" type="number" as="kod_recalc" key="1" fixed="1" sourcetable="./a/a/sr_recalc_opl" sourcecolumn="kod_recalc" used="1">a.kod_recalc as kod_recalc, /*number*//*key*/
</column><column table="a" column="kod_opl" type="number" as="kod_opl" reference="sr_opl" refcol="kod_opl" key="0" sourcetable="./a/a/sr_recalc_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl/*number*/
</column></select><from>
from <table name="sr_recalc_opl" as="a" used="1">sr_recalc_opl
a
--\sr_recalc_opl
</table></from><call function="=" type="bool">)
sr_recalc_opl on <column table="a" column="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="sr_recalc_opl" column="kod_opl">sr_recalc_opl.kod_opl</column></call>--\sr_recalc_opl
</query><query name="sr_recalc" as="kod_recalc" join="left outer" path="./a/a/kod_recalc" haskeys="1" used="1">left outer join
(
<select>--sr_recalc
select <column table="a" column="kod_recalc" type="number" as="kod_recalc" key="1" fixed="1" sourcetable="./a/a/kod_recalc" sourcecolumn="kod_recalc" used="1">a.kod_recalc as kod_recalc, /*number*//*key*/
</column><column table="a" column="kod_opl" type="number" as="kod_opl" reference="sr_opl" refcol="kod_opl" key="0" sourcetable="./a/a/kod_recalc" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl/*number*/
</column></select><from>
from <table name="sr_recalc" as="a" used="1">sr_recalc
a
--\sr_recalc
</table></from><call function="=" type="bool">)
kod_recalc on <column table="sr_recalc_opl" column="kod_recalc">sr_recalc_opl.kod_recalc</column><text txtype="func"> = </text><column table="kod_recalc" column="kod_recalc">kod_recalc.kod_recalc</column></call>--\sr_recalc
</query><query name="sr_opl" as="kod_opl_par_rec" join="left outer" path="./a/a/kod_opl_par_rec" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./a/a/kod_opl_par_rec" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_par_rec on <column table="kod_recalc" column="kod_opl">kod_recalc.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_par_rec" column="kod_opl">kod_opl_par_rec.kod_opl</column></call>--\sr_opl
</query></from><where>where
<call function="and" pth="" type="bool"><call function="in" pth="" type="bool">(<column table="a" column="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call>) </call></call></where>)
a
--\sr_opl_recalc_tree_info_pre1
</query></from><connect>connect by nocycle
<call function="=" pth="" type="bool"><column table="a" column="kod_opl" prior="1">prior a.kod_opl</column><text txtype="func"> = </text><column table="a" column="kod_opl_par_rec">a.kod_opl_par_rec</column></call></connect><start>
start with <call function="is null" pth="" type="bool"><column table="a" column="kod_opl_par_rec">a.kod_opl_par_rec</column><text txtype="func"> is null </text></call></start>)
a
--\sr_opl_recalc_tree_info_pre2
</query></from><where>where
<call function="!=" pth="" type="bool"><column table="a" column="kod_opl_root">a.kod_opl_root</column><text txtype="func"> != </text><column table="a" column="kod_opl">a.kod_opl</column></call></where>) mtr
;
--\sr_opl_recalc_tree_info
</query>
  <query name="36703-fin-dat" noname="1" order="kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-fin-dat';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
s1, --grsetname
n1, --kod_dog
s2, --ndog
s3, --name
s4, --nump
n2, --ym_vozn
n3, --kod_sf
d1, --dat_bzad
n4, --ym
s5, --name_podpis
s6, --name_plat
n5, --nach
n6, --opl_nach
n7, --opl
n8, --dolg
n9, --dolg_check
n10, --dolg_pros
n11, --dolg_kred_os
n12, --dolg_kred_av
n13, --dolg_kred
n14, --pr_dog
n15, --visitog
n16, --visitog_deb
n17, --visitog_osn_av
n18, --visitog_osn
n19, --visdet_osn
n20, --visdet_av
n21, --visdet_othr
n22, --gr_rn
s7, --growid
s8, --parent_growid
n23, --groupingid
s9, --grsetid
s10, --origgrsetid
s11, --parent_grsetid
n24, --par_groupingid
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="s1" info="grsetname" /><column column="n1" info="kod_dog" /><column column="s2" info="ndog" /><column column="s3" info="name" /><column column="s4" info="nump" /><column column="n2" info="ym_vozn" /><column column="n3" info="kod_sf" /><column column="d1" info="dat_bzad" /><column column="n4" info="ym" /><column column="s5" info="name_podpis" /><column column="s6" info="name_plat" /><column column="n5" info="nach" /><column column="n6" info="opl_nach" /><column column="n7" info="opl" /><column column="n8" info="dolg" /><column column="n9" info="dolg_check" /><column column="n10" info="dolg_pros" /><column column="n11" info="dolg_kred_os" /><column column="n12" info="dolg_kred_av" /><column column="n13" info="dolg_kred" /><column column="n14" info="pr_dog" /><column column="n15" info="visitog" /><column column="n16" info="visitog_deb" /><column column="n17" info="visitog_osn_av" /><column column="n18" info="visitog_osn" /><column column="n19" info="visdet_osn" /><column column="n20" info="visdet_av" /><column column="n21" info="visdet_othr" /><column column="n22" info="gr_rn" /><column column="s7" info="growid" /><column column="s8" info="parent_growid" /><column column="n23" info="groupingid" /><column column="s9" info="grsetid" /><column column="s10" info="origgrsetid" /><column column="s11" info="parent_grsetid" /><column column="n24" info="par_groupingid" /><column column="sparentid" info="sparentid" />--36703-fin-dat
</insert><with>with
<query hint="materialize" as="mat1" path="./fin/p1/grsets_query/grpd" used="1">mat1 as
(
<select>--
select /*+ materialize*/
<column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grpd" column="ndog" as="ndog" master="kod_dog" c-master="kod_dog" removeable="1" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog">grpd.ndog as ndog, /*Номер договора*//*string*/
</column><column table="grpd" column="name" as="name" master="kod_dog" c-master="kod_dog" removeable="1" used="1" key="0" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name">grpd.name as name, /*Отделение*//*string*/
</column><column table="grpd" column="nump" as="nump" master="kod_dog" c-master="kod_dog" removeable="1" used="1" key="0" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump">grpd.nump as nump, /*Код абонента*//*string*/
</column><column table="grpd" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">grpd.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="grpd" column="kod_sf" as="kod_sf" c-master-key="kod_sf" removeable="1" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">grpd.kod_sf as kod_sf, /*number*//*key*/
</column><column table="grpd" column="dat_bzad" as="dat_bzad" removeable="1" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad">grpd.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="grpd" column="ym" as="ym" master="kod_sf" c-master="kod_sf" removeable="1" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym">grpd.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="grpd" column="name_podpis" as="name_podpis" removeable="1" used="1" key="0" type="string">grpd.name_podpis as name_podpis, /*string*/
</column><column table="grpd" column="name_plat" as="name_plat" type="string" title="Наименование платежа" used="1" key="0" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real">grpd.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="grpd" column="nach" as="nach" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(grpd.nach,0)  as nach, /*Начислено*//*number*/
</column><column table="grpd" column="opl_nach" as="opl_nach" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">nvl(grpd.opl_nach,0)  as opl_nach, /*Оплата начислений*//*number*/
</column><column table="grpd" column="opl" as="opl" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">nvl(grpd.opl,0)  as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="grpd" column="dolg" as="dolg" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(grpd.dolg,0)  as dolg, /*Оборот*//*number*/
</column><column table="grpd" column="dolg_check" as="dolg_check" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(grpd.dolg_check,0)  as dolg_check, /*Оборот*//*number*/
</column><column table="grpd" column="dolg_pros" as="dolg_pros" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">nvl(grpd.dolg_pros,0)  as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="grpd" column="dolg_kred_os" as="dolg_kred_os" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">nvl(grpd.dolg_kred_os,0)  as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grpd" column="dolg_kred_av" as="dolg_kred_av" removeable="1" nvl="0" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum">nvl(grpd.dolg_kred_av,0)  as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="grpd" column="dolg_kred" as="dolg_kred" type="number" nvl="0" used="1" key="0" title="Кредиторская задолженность  по осн. реал" agg="sum">nvl(grpd.dolg_kred,0)  as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grpd" column="pr_dog" as="pr_dog" title=" " removeable="1" is-fact-use="1" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">grpd.pr_dog as pr_dog, /* *//*number*/
</column><call function="if" as="visitog" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>1</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="!=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="grpd" column="dolg_check" as="dolg_check" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="dolg_check">nvl(grpd.dolg_check,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column table="grpd" column="dolg_kred" as="dolg_kred" type="number" key="0" nvl="0" thissrc="dolg_kred">nvl(grpd.dolg_kred,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column table="grpd" column="opl" as="opl" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="opl">nvl(grpd.opl,0) </column><text txtype="func"> ,0)!=0 </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visitog, /*number*/
</call><call function="if" as="visitog_deb" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>2</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="!=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="grpd" column="dolg_check" as="dolg_check" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="dolg_check">nvl(grpd.dolg_check,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column table="grpd" column="opl" as="opl" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="opl">nvl(grpd.opl,0) </column><text txtype="func"> ,0)!=0 </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visitog_deb, /*number*/
</call><call function="if" as="visitog_osn_av" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>3</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="!=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="grpd" column="dolg_check" as="dolg_check" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="dolg_check">nvl(grpd.dolg_check,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column table="grpd" column="opl" as="opl" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="opl">nvl(grpd.opl,0) </column><text txtype="func"> ,0)!=0 </text>) </call><text txtype="func"> and </text><call function="or" pth="1" type="bool">(<call function="in" pth="" type="bool">(<column table="grpd" column="vid_real" as="vid_real" removeable="1" key="0" thissrc="vid_real">grpd.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>0</text></const>) </call>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="grpd" column="pr_dog" as="pr_dog" title=" " removeable="1" key="0" is-fact-use="1" thissrc="pr_dog">grpd.pr_dog</column><text txtype="func"> is not null </text>) </call>) </call>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visitog_osn_av, /*number*/
</call><call function="if" as="visitog_osn" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>4</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="or" pth="1" type="bool">(<call function="in" pth="" type="bool">(<column table="grpd" column="vid_real" as="vid_real" removeable="1" key="0" thissrc="vid_real">grpd.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="grpd" column="pr_dog" as="pr_dog" title=" " removeable="1" key="0" is-fact-use="1" thissrc="pr_dog">grpd.pr_dog</column><text txtype="func"> is not null </text>) </call>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visitog_osn, /*number*/
</call><call function="if" as="visdet_osn" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>5</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="!=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="grpd" column="dolg_check" as="dolg_check" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="dolg_check">nvl(grpd.dolg_check,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column table="grpd" column="nach" as="nach" removeable="1" key="0" nvl="0" is-fact-use="1" thissrc="nach">nvl(grpd.nach,0) </column><text txtype="func"> ,0)!=0 </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="grpd" column="vid_real" as="vid_real" removeable="1" key="0" thissrc="vid_real">grpd.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const>) </call>) </call>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visdet_osn, /*number*/
</call><call function="if" as="visdet_av" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>6</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="grpd" column="vid_real" as="vid_real" removeable="1" key="0" thissrc="vid_real">grpd.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const>) </call>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visdet_av, /*number*/
</call><call function="if" as="visdet_othr" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>7</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="grpd" column="vid_real" as="vid_real" removeable="1" key="0" thissrc="vid_real">grpd.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>7</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visdet_othr/*number*/
</call></select><from>
from <query as="grpd" path="./fin/p1/grsets_query/grpd/grpd" used="1">(
<select>--
select <column table="kod_dog_fin" column="kod_dog" as="kod_dog" removeable="1" c-master-key="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog">kod_dog_fin.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dog_fin" column="ndog" as="ndog" removeable="1" master="kod_dog" c-master="kod_dog" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog">kod_dog_fin.ndog as ndog, /*Номер договора*//*string*/
</column><column table="dep" column="name" as="name" removeable="1" master="kod_dog" c-master="kod_dog" used="1" key="0" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name">dep.name as name, /*Отделение*//*string*/
</column><column table="kodp" column="nump" as="nump" removeable="1" master="kod_dog" c-master="kod_dog" used="1" key="0" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump">kodp.nump as nump, /*Код абонента*//*string*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="kod_sf" column="kod_sf" as="kod_sf" removeable="1" c-master-key="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><column table="vid_real" column="vid_real" as="vid_real" removeable="1" reference="sk_vid_real" refcol="vid_real" keypath=".vid_real" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real">vid_real.vid_real as vid_real, /*number*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_bzad" removeable="1" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="kod_sf" column="ym" as="ym" removeable="1" master="kod_sf" c-master="kod_sf" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym">kod_sf.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="kod_sf_ret_inf" column="name_podpis" as="name_podpis" removeable="1" used="1" key="0" type="string">kod_sf_ret_inf.name_podpis as name_podpis, /*string*/
</column><call function="case" as="name_plat" type="string" title="Наименование платежа" pth="" used="1" key="0" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real"><text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real" as="vid_real" removeable="1" thissrc="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const>) </call>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const><text>'Итоговый расчет за '</text></const><text txtype="func"> || </text><call function="lower" pth="" type="string">(<text txtype="func"> lower( </text><call function="mes-name" pth="" type="string">(<text txtype="func"> decode ( </text><call function="mes" pth="" type="number">(<text txtype="func"> mod( </text><column table="qube" column="ym_vozn" as="ym_vozn">qube.ym_vozn</column><text txtype="func"> , 1)*100 </text>) </call><text txtype="func"> ,1,'Январь',2,'Февраль',3,'Март',4,'Апрель',5,'Май',6,'Июнь',7,'Июль',8,'Август',9,'Сентябрь',10,'Октябрь',11,'Ноябрь',12,'Декабрь') </text>) </call><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="trunc" pth="" type="number">(<text txtype="func"> trunc( </text><column table="qube" column="ym_vozn" as="ym_vozn">qube.ym_vozn</column><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' г.'</text></const>) </call></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real" as="vid_real" removeable="1" thissrc="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const><text>'Аванс '</text></const><text txtype="func"> || </text><column table="kod_sf_dop" column="perc">kod_sf_dop.perc</column><text txtype="func"> || </text><const><text>'% за '</text></const><text txtype="func"> || </text><call function="lower" pth="" type="string">(<text txtype="func"> lower( </text><call function="mes-name" pth="" type="string">(<text txtype="func"> decode ( </text><call function="mes" pth="" type="number">(<text txtype="func"> mod( </text><column table="kod_sf" column="rym">kod_sf.rym</column><text txtype="func"> , 1)*100 </text>) </call><text txtype="func"> ,1,'Январь',2,'Февраль',3,'Март',4,'Апрель',5,'Май',6,'Июнь',7,'Июль',8,'Август',9,'Сентябрь',10,'Октябрь',11,'Ноябрь',12,'Декабрь') </text>) </call><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="trunc" pth="" type="number">(<text txtype="func"> trunc( </text><column table="kod_sf" column="rym">kod_sf.rym</column><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' г.'</text></const>) </call></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real" as="vid_real" removeable="1" thissrc="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>9</text></const>) </call>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const><text>'Гос. пошлина '</text></const><text txtype="func"> || </text><call function="if" type="string" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<call function="coalesce" type="string" as="num_delo" pth="">(<text txtype="func"> coalesce( </text><column column="iv_sf_astr_info_num_delo1" table="qube" as="iv_sf_astr_info_num_delo1">qube.iv_sf_astr_info_num_delo1</column><text txtype="func"> , </text><column column="iv_sf_ur_prizn_info_num_delo1" table="qube" as="iv_sf_ur_prizn_info_num_delo1">qube.iv_sf_ur_prizn_info_num_delo1</column><text txtype="func"> ) </text>) </call><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const><text>'по делу № '</text></const><text txtype="func"> || </text><call function="coalesce" type="string" as="num_delo" pth="">(<text txtype="func"> coalesce( </text><column column="iv_sf_astr_info_num_delo1" table="qube" as="iv_sf_astr_info_num_delo1">qube.iv_sf_astr_info_num_delo1</column><text txtype="func"> , </text><column column="iv_sf_ur_prizn_info_num_delo1" table="qube" as="iv_sf_ur_prizn_info_num_delo1">qube.iv_sf_ur_prizn_info_num_delo1</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> end </text>) </call>) </call></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real" as="vid_real" removeable="1" thissrc="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>7</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<call function="coalesce" type="string" as="num_delo" pth="">(<text txtype="func"> coalesce( </text><column column="iv_sf_astr_info_num_delo1" table="qube" as="iv_sf_astr_info_num_delo1">qube.iv_sf_astr_info_num_delo1</column><text txtype="func"> , </text><column column="iv_sf_ur_prizn_info_num_delo1" table="qube" as="iv_sf_ur_prizn_info_num_delo1">qube.iv_sf_ur_prizn_info_num_delo1</column><text txtype="func"> ) </text>) </call><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const><text>'Проценты по делу № '</text></const><text txtype="func"> || </text><call function="coalesce" type="string" as="num_delo" pth="">(<text txtype="func"> coalesce( </text><column column="iv_sf_astr_info_num_delo1" table="qube" as="iv_sf_astr_info_num_delo1">qube.iv_sf_astr_info_num_delo1</column><text txtype="func"> , </text><column column="iv_sf_ur_prizn_info_num_delo1" table="qube" as="iv_sf_ur_prizn_info_num_delo1">qube.iv_sf_ur_prizn_info_num_delo1</column><text txtype="func"> ) </text>) </call>) </call></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real" as="vid_real" removeable="1" thissrc="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>7</text></const>) </call>) </call><text txtype="func"> and </text><call function="is null" pth="" type="bool">(<call function="coalesce" type="string" as="num_delo" pth="">(<text txtype="func"> coalesce( </text><column column="iv_sf_astr_info_num_delo1" table="qube" as="iv_sf_astr_info_num_delo1">qube.iv_sf_astr_info_num_delo1</column><text txtype="func"> , </text><column column="iv_sf_ur_prizn_info_num_delo1" table="qube" as="iv_sf_ur_prizn_info_num_delo1">qube.iv_sf_ur_prizn_info_num_delo1</column><text txtype="func"> ) </text>) </call><text txtype="func"> is null </text>) </call>) </call><text txtype="func"> then </text><const><text>'Проценты за пользование чужими денежными средствами'</text></const></call><text txtype="func"> end </text> as name_plat, /*Наименование платежа*//*string*/
</call><column column="nach_all1" table="qube" nvl="0" as="nach" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(qube.nach_all1,0)  as nach, /*Начислено*//*number*/
</column><column column="opl_nach_all1" table="qube" nvl="0" as="opl_nach" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">nvl(qube.opl_nach_all1,0)  as opl_nach, /*Оплата начислений*//*number*/
</column><column column="opl_in_month1" table="qube" as="opl" nvl="0" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">nvl(qube.opl_in_month1,0)  as opl, /*Оплата (поступление на счет)*//*number*/
</column><column column="dolg1" as="dolg" table="qube" nvl="0" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(qube.dolg1,0)  as dolg, /*Оборот*//*number*/
</column><column column="dolg_not_av1" as="dolg_check" table="qube" nvl="0" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">nvl(qube.dolg_not_av1,0)  as dolg_check, /*Оборот*//*number*/
</column><column column="dolg_pros_dat1" table="qube" nvl="0" as="dolg_pros" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">nvl(qube.dolg_pros_dat1,0)  as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column column="dolg_kred_os1" table="qube" nvl="0" as="dolg_kred_os" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">nvl(qube.dolg_kred_os1,0)  as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column column="dolg_kred_av1" table="qube" nvl="0" as="dolg_kred_av" is-fact-use="1" removeable="1" used="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum">nvl(qube.dolg_kred_av1,0)  as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><call function="+nvl" as="dolg_kred" nvl="0" pth="" type="number" used="1" key="0" title="Кредиторская задолженность  по осн. реал" agg="sum">nvl(<text txtype="func"> nvl( </text><column column="dolg_kred_os1" table="qube" as="dolg_kred_os1">qube.dolg_kred_os1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column column="dolg_kred_av1" table="qube" as="dolg_kred_av1">qube.dolg_kred_av1</column><text txtype="func"> ,0) </text>,0)  as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</call><column column="kr_dogovor_kod_dog1" title=" " as="pr_dog" is-fact-use="1" removeable="1" table="qube" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kr_dogovor_kod_dog1 as pr_dog/* *//*number*/
</column></select><from>
from <query haskeys="1" as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="vid_real" group="1" as="vid_real" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube.vid_real as vid_real, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="qube" column="iv_sf_astr_info_num_delo1" as="iv_sf_astr_info_num_delo1" group="max" key="0" used="1" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">max(qube.iv_sf_astr_info_num_delo1)  as iv_sf_astr_info_num_delo1, /*Номер дела*//*string*/
</column><column table="qube" column="iv_sf_ur_prizn_info_num_delo1" as="iv_sf_ur_prizn_info_num_delo1" group="max" key="0" used="1" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">max(qube.iv_sf_ur_prizn_info_num_delo1)  as iv_sf_ur_prizn_info_num_delo1, /*Номер дела*//*string*/
</column><call as="nach_all1" function="if" type="number" key="0" group="sum" pth="" used="1" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call>) </call><text txtype="func"> then </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> end </text>)  as nach_all1, /*Начислено*//*number*/
</call><call as="opl_nach_all1" function="if" type="number" key="0" group="sum" pth="" used="1" title="Оплата начислений" agg="sum">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call>) </call><text txtype="func"> then </text><column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column><text txtype="func"> end </text>)  as opl_nach_all1, /*Оплата начислений*//*number*/
</call><call as="opl_in_month1" function="if" type="number" key="0" group="sum" pth="" used="1" title="Оплата (поступление на счет)" agg="sum">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="ge" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &gt;= </text><call function="ym begin time" pth="" type="date">(<text txtype="func"> (to_date(to_char( </text><call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> *10000+01),'YYYYMMDD')) </text>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><column table="qube" column="sr_opl_opl_bnk1">qube.sr_opl_opl_bnk1</column><text txtype="func"> end </text>)  as opl_in_month1, /*Оплата (поступление на счет)*//*number*/
</call><call function="if" as="dolg1" type="number" key="0" group="sum" pth="" used="1" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> ,0)=0 </text>) </call><text txtype="func"> then </text><call function="if" as="dolg_pros_av" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat_dolg">qube.dat_dolg</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf" column="dat_ezad">kod_sf.dat_ezad</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &gt; </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> ,0)=0 </text>) </call>) </call><text txtype="func"> then </text><call function="-nvl" as="fin_ul_ob" title="Оборот" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl2">qube.sr_facras_nachisl2</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf2">qube.sr_opl_opl_sf2</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> else </text><call function="if" as="dolg_not_av" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> ,0)=0 </text>) </call><text txtype="func"> then </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="kod_sf" column="rym">kod_sf.rym</column><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> else </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> end </text>) </call><text txtype="func"> &gt; </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><call function="-nvl" as="fin_ul_ob" title="Оборот" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> end </text>)  as dolg1, /*Оборот*//*number*/
</call><call function="if" as="dolg_not_av1" type="number" key="0" group="sum" pth="" used="1" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="kod_sf" column="vid_real">kod_sf.vid_real</column><text txtype="func"> ,0)=0 </text>) </call><text txtype="func"> then </text><call function="ym end time" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="kod_sf" column="rym">kod_sf.rym</column><text txtype="func"> *100,'YYYYMM'))+(1-1/24/60/60) </text>) </call><text txtype="func"> else </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> end </text>) </call><text txtype="func"> &gt; </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><call function="-nvl" as="fin_ul_ob" title="Оборот" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>)  as dolg_not_av1, /*Оборот*//*number*/
</call><call function="()" as="dolg_pros_dat1" type="number" key="0" group="sum" pth="" used="1" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">sum(<call function="-nvl" as="z23df_1" type="number" title="Сверхнормативная задолженность" pth="">(<text txtype="func"> nvl( </text><call function="if" as="fin_ul_sverh_dolg_deb_pre_dat" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="lt" pth="" type="bool">(<column table="qube" column="dat_dolg">qube.dat_dolg</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call><text txtype="func"> then </text><call function="-nvl" pth="" type="number">(<text txtype="func"> nvl( </text><call function="-nvl" as="fin_ul_ob_os_av_norm" title="Оборот деб. осн. и ав. (долг)" pth="" type="number">(<text txtype="func"> nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_facvip_norm_av_av_nach1">qube.sr_facvip_norm_av_av_nach1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_facvip_norm_av_osn_nach1">qube.sr_facvip_norm_av_osn_nach1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="+nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_norm_av_av_opl1">qube.sr_opl_norm_av_av_opl1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_norm_av_osn_opl1">qube.sr_opl_norm_av_osn_opl1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>) </call><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="if" as="fin_ul_gaf_dolg_in_out_dt" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="lt" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call><text txtype="func"> then </text><call function="-nvl" as="fin_ul_gaf_dolg_in_out" type="number" pth="">(<text txtype="func"> nvl( </text><column table="qube" column="qube_graf_in_ob1">qube.qube_graf_in_ob1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="qube_graf_out_ob1">qube.qube_graf_out_ob1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> ,0) </text>) </call>)  as dolg_pros_dat1, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</call><call function="if" as="dolg_kred_os1" type="number" key="0" group="sum" pth="" used="1" title="Кредиторская задолженность  по осн. реал" agg="sum">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><call function="if" type="number" as="fin_ul_ob_kr_not_av" title="Кредиторская задолженность  по осн. реал" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="not in" pth="" type="bool">(<column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="+nvl" as="fin_ul_ob_kr" title="Кредиторская задолженность" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_opl_kred1">qube.sr_opl_opl_kred1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_opl_stor1">qube.sr_opl_opl_stor1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> end </text>)  as dolg_kred_os1, /*Кредиторская задолженность  по осн. реал*//*number*/
</call><call function="if" as="dolg_kred_av1" type="number" key="0" group="sum" pth="" used="1" title="Кредиторская задолженность  по  авансам" agg="sum">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat">qube.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf" column="dat_ezad">kod_sf.dat_ezad</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><call function="if" type="number" as="fin_ul_ob_kr_av" title="Кредиторская задолженность  по  авансам" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="+nvl" as="fin_ul_ob_kr" title="Кредиторская задолженность" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_opl_kred1">qube.sr_opl_opl_kred1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="qube" column="sr_opl_opl_stor1">qube.sr_opl_opl_stor1</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> end </text>)  as dolg_kred_av1, /*Кредиторская задолженность  по  авансам*//*number*/
</call><column table="qube" column="kr_dogovor_kod_dog1" title=" " is-fact-use="1" as="kr_dogovor_kod_dog1" group="max" key="0" used="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">max(qube.kr_dogovor_kod_dog1)  as kr_dogovor_kod_dog1/* *//*number*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube.vid_real as vid_real, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="dat" as="dat" keypath=".dat" used="1" key="1" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="qube" column="dat_dolg" as="dat_dolg" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="qube" column="iv_sf_astr_info_num_delo1" as="iv_sf_astr_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube.iv_sf_astr_info_num_delo1 as iv_sf_astr_info_num_delo1, /*Номер дела*//*string*/
</column><column table="qube" column="iv_sf_ur_prizn_info_num_delo1" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">qube.iv_sf_ur_prizn_info_num_delo1 as iv_sf_ur_prizn_info_num_delo1, /*Номер дела*//*string*/
</column><column table="qube" column="kr_dogovor_kod_dog1" as="kr_dogovor_kod_dog1" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kr_dogovor_kod_dog1 as kr_dogovor_kod_dog1, /*number*/
</column><column table="qube" column="qube_graf_in_ob1" as="qube_graf_in_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube.qube_graf_in_ob1 as qube_graf_in_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="qube" column="qube_graf_out_ob1" as="qube_graf_out_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube.qube_graf_out_ob1 as qube_graf_out_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="qube" column="sr_facras_nachisl2" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">qube.sr_facras_nachisl2 as sr_facras_nachisl2, /*Начислено*//*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="qube" column="sr_opl_opl_bnk1" as="sr_opl_opl_bnk1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">qube.sr_opl_opl_bnk1 as sr_opl_opl_bnk1, /*Оплата (поступление на счет)*//*number*/
</column><column table="qube" column="sr_opl_opl_kred1" as="sr_opl_opl_kred1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">qube.sr_opl_opl_kred1 as sr_opl_opl_kred1, /*Оплата (кредит)*//*number*/
</column><column table="qube" column="sr_opl_opl_sf2" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf2 as sr_opl_opl_sf2, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_opl_stor1" as="sr_opl_opl_stor1" used="1" key="0" type="number" title="Оплата (сторно)" agg="sum">qube.sr_opl_opl_stor1 as sr_opl_opl_stor1/*Оплата (сторно)*//*number*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><const as="dat_dolg" used="1" key="0"><text>null</text> as dat_dolg, 
</const><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube.vid_real as vid_real, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="iv_sf_astr_info_num_delo1" as="iv_sf_astr_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube.iv_sf_astr_info_num_delo1 as iv_sf_astr_info_num_delo1, /*Номер дела*//*string*/
</column><column table="qube" column="iv_sf_ur_prizn_info_num_delo1" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">qube.iv_sf_ur_prizn_info_num_delo1 as iv_sf_ur_prizn_info_num_delo1, /*Номер дела*//*string*/
</column><const type="number" as="kr_dogovor_kod_dog1" used="1" key="0"><text>null</text> as kr_dogovor_kod_dog1, /*number*/
</const><column table="qube" column="qube_graf_in_ob1" as="qube_graf_in_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube.qube_graf_in_ob1 as qube_graf_in_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="qube" column="qube_graf_out_ob1" as="qube_graf_out_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube.qube_graf_out_ob1 as qube_graf_out_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><column table="qube" column="sr_opl_opl_bnk1" as="sr_opl_opl_bnk1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">qube.sr_opl_opl_bnk1 as sr_opl_opl_bnk1, /*Оплата (поступление на счет)*//*number*/
</column><column table="qube" column="sr_opl_opl_kred1" as="sr_opl_opl_kred1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">qube.sr_opl_opl_kred1 as sr_opl_opl_kred1, /*Оплата (кредит)*//*number*/
</column><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2, /*number*/
</const><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_opl_stor1" as="sr_opl_opl_stor1" used="1" key="0" type="number" title="Оплата (сторно)" agg="sum">qube.sr_opl_opl_stor1 as sr_opl_opl_stor1/*Оплата (сторно)*//*number*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc">un.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">un.vid_real as vid_real, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">un.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="un" column="qube_graf_in_ob1" group="sum" as="qube_graf_in_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">sum(un.qube_graf_in_ob1)  as qube_graf_in_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="un" column="qube_graf_out_ob1" group="sum" as="qube_graf_out_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">sum(un.qube_graf_out_ob1)  as qube_graf_out_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="un" column="iv_sf_astr_info_num_delo1" group="max" as="iv_sf_astr_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">max(un.iv_sf_astr_info_num_delo1)  as iv_sf_astr_info_num_delo1, /*Номер дела*//*string*/
</column><column table="un" column="iv_sf_ur_prizn_info_num_delo1" group="max" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">max(un.iv_sf_ur_prizn_info_num_delo1)  as iv_sf_ur_prizn_info_num_delo1, /*Номер дела*//*string*/
</column><column table="un" column="sr_facras_nachisl1" group="sum" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(un.sr_facras_nachisl1)  as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_opl_bnk1" group="sum" as="sr_opl_opl_bnk1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">sum(un.sr_opl_opl_bnk1)  as sr_opl_opl_bnk1, /*Оплата (поступление на счет)*//*number*/
</column><column table="un" column="sr_opl_opl_kred1" group="sum" as="sr_opl_opl_kred1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">sum(un.sr_opl_opl_kred1)  as sr_opl_opl_kred1, /*Оплата (кредит)*//*number*/
</column><column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf1)  as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_opl_stor1" group="sum" as="sr_opl_opl_stor1" used="1" key="0" type="number" title="Оплата (сторно)" agg="sum">sum(un.sr_opl_opl_stor1)  as sr_opl_opl_stor1/*Оплата (сторно)*//*number*/
</column></select><from>
from <query as="un" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="qube_graf_in_a_d" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc">qube_graf_in_a_d.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="qube_graf_in_a_d" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube_graf_in_a_d.kod_dog as kod_dog, /*number*/
</column><column table="qube_graf_in_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube_graf_in_a_d.kod_sf as kod_sf, /*number*/
</column><column table="qube_graf_in_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube_graf_in_a_d.vid_real as vid_real, /*number*/
</column><column table="qube_graf_in_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube_graf_in_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube_graf_in_a_d" column="ob" as="qube_graf_in_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube_graf_in_a_d.ob as qube_graf_in_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="qube_graf_in" class="1" use-repository="1" materialize="1" timestamp="29.06.2023 14:34:54" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\ur_graf.xml" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" noname="1" as="qube_graf_in_a_d" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_graf,
n2 as kod_sf,
n3 as kod_dep,
n4 as kod_group_cust,
n5 as kod_group_cust_parent,
n6 as vid_real,
n7 as kodp,
n8 as kod_dog,
n9 as ym_vozn,
d1 as dat_vozn_norm,
n10 as ob,
n11 as ob_v2,
d2 as dat
from rr_temp where skod = 'qube_graf_in'
<select notext="1">--qube_graf_in
select <column table="kod_graf" column="kod_graf" is-private-dimension="kod_graf" is-final-dimension="kod_graf" dimension="kod_graf" as="kod_graf" keypath=".kod_graf" type="number" agg="max" sourcetable="./kod_graf" sourcecolumn="kod_graf" into="n1" used="1" key="1">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" is-private-dimension="kod_sf" is-final-dimension="kod_sf" dimension="kod_sf" as="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" into="n2" used="1" key="0">kod_sf.kod_sf as kod_sf, /*number*/
</column><column table="kod_dep" column="kodp" is-private-dimension="kod_dep" is-final-dimension="kod_dep" dimension="kod_dep" as="kod_dep" reference="kr_dep" refcol="kodp" keypath=".kodp" type="number" sourcetable="./kod_dep" sourcecolumn="kodp" into="n3" used="1" key="0">kod_dep.kodp as kod_dep, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" is-private-dimension="kod_group_cust" is-final-dimension="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" keypath=".kod_group_cust" type="number" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" into="n4" used="1" key="0">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust_parent" column="kod_group_cust" is-private-dimension="kod_group_cust_parent" is-final-dimension="kod_group_cust_parent" dimension="kod_group_cust_parent" as="kod_group_cust_parent" reference="ks_group_cust_parent_list" refcol="kod_group_cust" keypath=".kod_group_cust" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" into="n5" used="1" key="0">kod_group_cust_parent.kod_group_cust as kod_group_cust_parent, /*number*/
</column><column table="kod_sf" column="vid_real" is-private-dimension="vid_real" is-final-dimension="vid_real" dimension="vid_real" as="vid_real" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" into="n6" used="1" key="0">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_dog" column="kodp" is-private-dimension="kodp" is-final-dimension="kodp" dimension="kodp" as="kodp" type="number" sourcetable="./kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n7" used="1" key="0">kod_dog.kodp as kodp, /*number*/
</column><column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" into="n8" used="1" key="0">kod_dog.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn" into="n9" used="1" key="0">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" keypath=".dat_vozn_norm" type="date" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="dat_vozn_norm" into="d1" used="1" key="0">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column column="fin_ul_ob_os_av_norm1" as="ob" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_in_ob" table="qube" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm1" into="n10" used="1" key="0">qube.fin_ul_ob_os_av_norm1 as ob, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column column="fin_ul_ob_os_av_norm_v21" as="ob_v2" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_in_ob_v2" table="qube" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="fin_ul_ob_os_av_norm_v21" into="n11" used="1" key="0">qube.fin_ul_ob_os_av_norm_v21 as ob_v2, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><call function="latest" as="dat" pth="" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc" into="d2" used="1" key="0"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="qube" column="dat" as="dat">qube.dat</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="kod_graf" column="doc_date">kod_graf.doc_date</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat/*Дата документа начисления*//*date*/
</call></select><from notext="1">
from <table name="qube" as="qube" used="1">qube
qube
--\qube
</table><table name="kod_group_cust_parent" as="kod_group_cust_parent" used="1">kod_group_cust_parent
kod_group_cust_parent
--\kod_group_cust_parent
</table><table name="kod_group_cust" as="kod_group_cust" used="1">kod_group_cust
kod_group_cust
--\kod_group_cust
</table><table name="kod_dep" as="kod_dep" used="1">kod_dep
kod_dep
--\kod_dep
</table><table name="kod_dog" as="kod_dog" used="1">kod_dog
kod_dog
--\kod_dog
</table><table name="kod_sf" as="kod_sf" used="1">kod_sf
kod_sf
--\kod_sf
</table><table name="kod_graf" as="kod_graf" used="1">kod_graf
kod_graf
--\kod_graf
</table></from>)
qube_graf_in_a_d
--\qube_graf_in
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="qube_graf_in_a_d" column="kod_dog">qube_graf_in_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="qube_graf_in_a_d" column="dat">qube_graf_in_a_d.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="qube_graf_out_a_d" column="dat_finish" as="dat" used="1" key="1" type="date" title="Дата окончания действия графика" sourcetable="./kod_graf" sourcecolumn="dat_finish">qube_graf_out_a_d.dat_finish as dat, /*Дата окончания действия графика*//*date*//*key*/
</column><column table="qube_graf_out_a_d" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube_graf_out_a_d.kod_dog as kod_dog, /*number*/
</column><column table="qube_graf_out_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube_graf_out_a_d.kod_sf as kod_sf, /*number*/
</column><column table="qube_graf_out_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube_graf_out_a_d.vid_real as vid_real, /*number*/
</column><column table="qube_graf_out_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="ym_vozn">qube_graf_out_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><column table="qube_graf_out_a_d" column="ob" as="qube_graf_out_ob1" used="1" key="0" type="number" title="Оборот деб. осн. и ав. (долг)" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm1">qube_graf_out_a_d.ob as qube_graf_out_ob1, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="qube_graf_out" class="1" use-repository="1" materialize="1" timestamp="29.06.2023 14:36:14" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\ur_graf.xml" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" noname="1" as="qube_graf_out_a_d" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_graf,
n2 as kod_sf,
n3 as kod_dep,
n4 as kod_group_cust,
n5 as kod_group_cust_parent,
n6 as kod_dog,
n7 as kodp,
n8 as vid_real,
n9 as ym_vozn,
d1 as dat_vozn_norm,
n10 as ob,
n11 as ob_v2,
d2 as dat_finish
from rr_temp where skod = 'qube_graf_out'
<select notext="1">--qube_graf_out
select <column table="kod_graf" column="kod_graf" as="kod_graf" keypath=".kod_graf" type="number" agg="max" sourcetable="./kod_graf" sourcecolumn="kod_graf" into="n1" used="1" key="1">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" is-private-dimension="kod_sf" is-final-dimension="kod_sf" dimension="kod_sf" as="kod_sf" reference="sr_facvip" refcol="kod_sf" keypath=".kod_sf" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" into="n2" used="1" key="0">kod_sf.kod_sf as kod_sf, /*number*/
</column><column table="kod_dep" column="kodp" is-private-dimension="kod_dep" is-final-dimension="kod_dep" dimension="kod_dep" as="kod_dep" reference="kr_dep" refcol="kodp" keypath=".kodp" type="number" sourcetable="./kod_dep" sourcecolumn="kodp" into="n3" used="1" key="0">kod_dep.kodp as kod_dep, /*number*/
</column><column table="kod_group_cust" column="kod_group_cust" is-private-dimension="kod_group_cust" is-final-dimension="kod_group_cust" dimension="kod_group_cust" as="kod_group_cust" reference="ks_group_cust" refcol="kod_group_cust" keypath=".kod_group_cust" type="number" sourcetable="./kod_group_cust" sourcecolumn="kod_group_cust" into="n4" used="1" key="0">kod_group_cust.kod_group_cust as kod_group_cust, /*number*/
</column><column table="kod_group_cust_parent" column="kod_group_cust" is-private-dimension="kod_group_cust_parent" is-final-dimension="kod_group_cust_parent" dimension="kod_group_cust_parent" as="kod_group_cust_parent" reference="ks_group_cust_parent_list" refcol="kod_group_cust" keypath=".kod_group_cust" type="number" sourcetable="./kod_group_cust_parent/a" sourcecolumn="kod_group_cust" into="n5" used="1" key="0">kod_group_cust_parent.kod_group_cust as kod_group_cust_parent, /*number*/
</column><column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" into="n6" used="1" key="0">kod_dog.kod_dog as kod_dog, /*number*/
</column><column table="kod_dog" column="kodp" is-private-dimension="kodp" is-final-dimension="kodp" dimension="kodp" as="kodp" type="number" sourcetable="./kod_dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n7" used="1" key="0">kod_dog.kodp as kodp, /*number*/
</column><column table="kod_sf" column="vid_real" is-private-dimension="vid_real" is-final-dimension="vid_real" dimension="vid_real" as="vid_real" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real" into="n8" used="1" key="0">kod_sf.vid_real as vid_real, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" keypath=".ym_vozn" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="ym_vozn" into="n9" used="1" key="0">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="qube" column="dat_vozn_norm" as="dat_vozn_norm" keypath=".dat_vozn_norm" type="date" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="dat_vozn_norm" into="d1" used="1" key="0">qube.dat_vozn_norm as dat_vozn_norm, /*Отчетный период начисления*//*date*/
</column><column column="fin_ul_ob_os_av_norm1" as="ob" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_out_ob" table="qube" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm1" into="n10" used="1" key="0">qube.fin_ul_ob_os_av_norm1 as ob, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column column="fin_ul_ob_os_av_norm_v21" as="ob_v2" is-fact="1" agg="sum" is-fact-use="1" fact="qube_graf_out_ob_v2" table="qube" type="number" title="Оборот деб. осн. и ав. (долг)" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_out_a_d" sourcecolumn="fin_ul_ob_os_av_norm_v21" into="n11" used="1" key="0">qube.fin_ul_ob_os_av_norm_v21 as ob_v2, /*Оборот деб. осн. и ав. (долг)*//*number*/
</column><column table="kod_graf" column="dat_finish" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" as="dat_finish" type="date" title="Дата окончания действия графика" sourcetable="./kod_graf" sourcecolumn="dat_finish" into="d2" used="1" key="0">kod_graf.dat_finish as dat_finish/*Дата окончания действия графика*//*date*/
</column></select><from notext="1">
from <table name="qube" as="qube" used="1">qube
qube
--\qube
</table><table name="kod_group_cust_parent" as="kod_group_cust_parent" used="1">kod_group_cust_parent
kod_group_cust_parent
--\kod_group_cust_parent
</table><table name="kod_group_cust" as="kod_group_cust" used="1">kod_group_cust
kod_group_cust
--\kod_group_cust
</table><table name="kod_dep" as="kod_dep" used="1">kod_dep
kod_dep
--\kod_dep
</table><table name="kod_dog" as="kod_dog" used="1">kod_dog
kod_dog
--\kod_dog
</table><table name="kod_sf" as="kod_sf" used="1">kod_sf
kod_sf
--\kod_sf
</table><table name="kod_graf" as="kod_graf" used="1">kod_graf
kod_graf
--\kod_graf
</table></from>)
qube_graf_out_a_d
--\qube_graf_out
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="qube_graf_out_a_d" column="kod_dog">qube_graf_out_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="qube_graf_out_a_d" column="dat_finish">qube_graf_out_a_d.dat_finish</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="qube_sf_ur_astr_info_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/kod_sf" sourcecolumn="kod_sf">qube_sf_ur_astr_info_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><column table="qube_sf_ur_astr_info_a_d" column="ur_mat_num_delo" as="iv_sf_astr_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube_sf_ur_astr_info_a_d.ur_mat_num_delo as iv_sf_astr_info_num_delo1, /*Номер дела*//*string*/
</column><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="qube_sf_ur_astr_info" as="qube_sf_ur_astr_info_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d" used="1">(
<select>--qube_sf_ur_astr_info
select <column table="kod_sf" column="kod_sf" dimension="kod_sf" as="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><column column="ur_mat_num_delo1" fact="iv_sf_astr_info_num_delo" agg="max" as="ur_mat_num_delo" is-fact-use="1" table="qube" used="1" key="0" type="string" title="Номер дела" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube.ur_mat_num_delo1 as ur_mat_num_delo/*Номер дела*//*string*/
</column></select><from>
from <query haskeys="1" as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf_astr" group="1" as="kod_sf_astr" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf_astr as kod_sf_astr, /*number*//*key*/
</column><column table="qube" column="ur_mat_num_delo1" agg="max" is-fact-use="1" as="ur_mat_num_delo1" group="stragg" key="0" used="1" type="string" title="Номер дела" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">stragg(qube.ur_mat_num_delo1)  as ur_mat_num_delo1/*Номер дела*//*string*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf_astr" as="kod_sf_astr" keypath=".kod_sf_astr" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf_astr as kod_sf_astr, /*number*//*key*/
</column><column table="qube" column="ur_mat_num_delo1" as="ur_mat_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube.ur_mat_num_delo1 as ur_mat_num_delo1/*Номер дела*//*string*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf_astr" as="kod_sf_astr" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf_astr as kod_sf_astr, /*number*//*key*/
</column><column table="qube" column="ur_mat_num_delo1" as="ur_mat_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">qube.ur_mat_num_delo1 as ur_mat_num_delo1/*Номер дела*//*string*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_sf_astr" group="1" as="kod_sf_astr" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">un.kod_sf_astr as kod_sf_astr, /*number*//*key*/
</column><column table="un" column="ur_mat_num_delo1" group="stragg" as="ur_mat_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">stragg(un.ur_mat_num_delo1)  as ur_mat_num_delo1/*Номер дела*//*string*/
</column></select><from>
from <query as="un" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_sf_astr" as="kod_sf_astr" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">dims.kod_sf_astr as kod_sf_astr, /*number*//*key*/
</column><column table="ur_mat" column="num_delo" as="ur_mat_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo">ur_mat.num_delo as ur_mat_num_delo1/*Номер дела*//*string*/
</column></select><from>
from <query as="dims" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_mat_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/ur_mat_a_d" sourcecolumn="kod_mat">ur_mat_a_d.kod_mat as kod_mat_prm, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" as="kod_sf_astr" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf_astr/*number*//*key*/
</column></select><from>
from <query name="ur_mat" dimension="kod_mat" as="ur_mat_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/ur_mat_a_d" haskeys="1" used="1">(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/ur_mat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from>)
ur_mat_a_d
--\ur_mat
</query><query name="sr_penni_astr" as="sr_penni_astr1_a_d1" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1" haskeys="1" used="1">left outer join
(
<select>--sr_penni_astr
select <call function="nvl" as="kod_sf_astr" pth="" key="0" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/kod_sf" sourcecolumn="kod_sf_first" reference="sr_facvip" refcol="kod_sf"><text txtype="func"> nvl( </text><column table="kod_sf" column="kod_sf_first">kod_sf.kod_sf_first</column><text txtype="func"> , </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> ) </text> as kod_sf_astr, /*number*/
</call><column table="a" column="kod_delo" as="kod_delo" key="0" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/a" sourcecolumn="kod_delo" reference="ur_mat" refcol="kod_mat">a.kod_delo as kod_delo/*number*/
</column></select><from>
from <query name="sr_penni" as="a" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/a" haskeys="1" used="1">(
<select>--sr_penni
select <column table="a" column="kod_pen" type="number" as="kod_pen" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/a" sourcecolumn="kod_pen" used="1">a.kod_pen as kod_pen, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" comment="счета фактур" as="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/a" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="kod_delo" type="number" comment="код дела ur_mat.kod_mat, по которому отбираются документы для расчета пени в режиме арбитраж" as="kod_delo" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/a" sourcecolumn="kod_delo" used="1">a.kod_delo as kod_delo/*number*/
</column></select><from>
from <table name="sr_penni" as="a" used="1">sr_penni
a
--\sr_penni
</table></from>)
a
--\sr_penni
</query><query name="sr_facvip" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_first" type="number" comment="при перерасчете самый исходный kod_sf" as="kod_sf_first" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/sr_penni_astr1_a_d1/kod_sf" sourcecolumn="kod_sf_first" used="1">a.kod_sf_first as kod_sf_first/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="is not null" pth="" type="bool"><column table="a" column="kod_delo">a.kod_delo</column><text txtype="func"> is not null </text></call></where><call function="=" type="bool">)
sr_penni_astr1_a_d1 on <column table="sr_penni_astr1_a_d1" column="kod_delo">sr_penni_astr1_a_d1.kod_delo</column><text txtype="func"> = </text><column table="ur_mat_a_d" column="kod_mat">ur_mat_a_d.kod_mat</column></call>--\sr_penni_astr
</query><query name="sr_facvip_astr" dimension="kod_sf_astr" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_astr
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf_astr" key="1" fixed="1" thissrc="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf_astr/*number*//*key*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf_astr" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_penni_astr1_a_d1" column="kod_sf_astr">sr_penni_astr1_a_d1.kod_sf_astr</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip_astr
</query><query name="kr_dogovor" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="ur_mat_a_d" column="kod_mat">ur_mat_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="ur_mat_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/ur_mat_a_d" sourcecolumn="kod_mat">ur_mat_a_d.kod_mat, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" as="kod_sf_astr" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo/*Номер дела*//*string*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> = </text><column table="dims" column="kod_mat_prm">dims.kod_mat_prm</column></call>--\ur_mat
</query><qubecontent><where>where
<call function="and" condsource="qube_sf_ur_astr_info"><call function="and">(<call function="is not null">(<column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column>) </call><call function="is not null">(<column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_sf_astr" group="1" as="kod_sf_astr" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">un.kod_sf_astr/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_sf_astr" group="1" as="kod_sf_astr" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf_astr/*number*//*key*/
</column></group>)
qube
--\
</query><query name="sr_facvip_astr" dimension="kod_sf_astr" link-mp-point="1" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip_astr
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf_astr" key="1" fixed="1" thissrc="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_astr_info_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf_astr/*number*//*key*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf_astr" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf_astr">qube.kod_sf_astr</column></call>--\sr_facvip_astr
</query></from>)
qube_sf_ur_astr_info_a_d
--\qube_sf_ur_astr_info
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="qube_sf_ur_astr_info_a_d" column="kod_sf">qube_sf_ur_astr_info_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="qube_sf_ur_prizn_info_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_sf" sourcecolumn="kod_sf">qube_sf_ur_prizn_info_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><column table="qube_sf_ur_prizn_info_a_d" column="num_delo" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0" type="string" title="Номер дела" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">qube_sf_ur_prizn_info_a_d.num_delo as iv_sf_ur_prizn_info_num_delo1, /*Номер дела*//*string*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="qube_sf_ur_prizn_info" as="qube_sf_ur_prizn_info_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d" used="1">(
<select>--qube_sf_ur_prizn_info
select <column table="kod_sf" column="kod_sf" dimension="kod_sf" as="kod_sf" used="1" key="1" keypath=".kod_sf" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><column table="kod_mat_pp" column="num_delo" fact="iv_sf_ur_prizn_info_num_delo" agg="max" as="num_delo" used="1" key="0" type="string" title="Номер дела" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo">kod_mat_pp.num_delo as num_delo/*Номер дела*//*string*/
</column></select><from>
from <query haskeys="1" as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube" used="1">(
<select>--
select <column table="qube" column="kod_mat_pp" group="1" as="kod_mat_pp" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">qube.kod_mat_pp as kod_mat_pp, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_mat_pp" as="kod_mat_pp" used="1" key="1" keypath=".kod_mat_pp" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">qube.kod_mat_pp as kod_mat_pp, /*number*//*key*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf as kod_sf/*number*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_mat_pp" as="kod_mat_pp" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">qube.kod_mat_pp as kod_mat_pp, /*number*//*key*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf as kod_sf/*number*/
</column></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_mat_pp" group="1" as="kod_mat_pp" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">un.kod_mat_pp as kod_mat_pp, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">un.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <query as="un" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_mat_pp" as="kod_mat_pp" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">dims.kod_mat_pp as kod_mat_pp, /*number*//*key*/
</column><column table="dims" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">dims.kod_sf as kod_sf/*number*/
</column></select><from>
from <query as="dims" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="kod_hist_mat_dec" column="kod_mat" as="kod_mat_pp" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">kod_hist_mat_dec.kod_mat as kod_mat_pp, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where>)
kod_hist_mat_dec
--\ur_hist_mat_dec
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp" column="kod_mat">kod_mat_pp.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp" column="kod_mat">kod_mat_pp.kod_mat</column></call>--\ur_dogplat
</query><query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
kod_deb_sf1_a_d1 on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="kod_deb_sf1_a_d1" column="kod_deb_sf">kod_deb_sf1_a_d1.kod_deb_sf</column></call>--\vv_all_deb_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_deb_sf1_a_d1" column="kod_sf">kod_deb_sf1_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_mat_pp" column="kod_mat">kod_mat_pp.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call></call></where><group> group by
<column table="kod_hist_mat_dec" column="kod_mat" as="kod_mat_pp" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">kod_hist_mat_dec.kod_mat, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf/*number*//*key*/
</column></group>)
dims
--\
</query><qubecontent><where>where
<call function="and" condsource="qube_sf_ur_prizn_info"><call function="and">(<call function="is not null">(<column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column>) </call><call function="is not null">(<column table="kod_mat_pp" column="kod_mat">kod_mat_pp.kod_mat</column>) </call><call function="is not null">(<column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column>) </call>) </call><call function="and" condsource="grpd">(<call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_mat_pp" group="1" as="kod_mat_pp" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">un.kod_mat_pp, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">un.kod_sf/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_mat_pp" group="1" as="kod_mat_pp" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">qube.kod_mat_pp, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf">qube.kod_sf/*number*//*key*/
</column></group>)
qube
--\
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query><query name="ur_mat_pp" dimension="kod_mat_pp" link-mp-point="1" as="kod_mat_pp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_sf_ur_prizn_info_a_d/kod_mat_pp/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp on <column table="kod_mat_pp" column="kod_mat">kod_mat_pp.kod_mat</column><text txtype="func"> = </text><column table="qube" column="kod_mat_pp">qube.kod_mat_pp</column></call>--\ur_mat_pp
</query></from>)
qube_sf_ur_prizn_info_a_d
--\qube_sf_ur_prizn_info
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="qube_sf_ur_prizn_info_a_d" column="kod_sf">qube_sf_ur_prizn_info_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_ras" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><column table="sr_facras_a_d" column="nachisl" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sr_facras_a_d.nachisl as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" haskeys="1" used="1">(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" used="1">a.nachisl as nachisl/*Начислено*//*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where>)
sr_facras_a_d
--\sr_facras
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facras_a_d" column="kod_sf">sr_facras_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_opl_a_d" column="dat_oper" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="dat_uch">kod_opl_a_d.dat_oper as dat, /*date*//*key*/
</column><column table="kod_opl_a_d" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">kod_opl_a_d.kod_dog as kod_dog, /*number*/
</column><column table="kod_opl_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_opl_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_opl_a_d.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="sr_opl_bnk_a_d" column="opl_bnk" as="sr_opl_opl_bnk1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">sr_opl_bnk_a_d.opl_bnk as sr_opl_opl_bnk1, /*Оплата (поступление на счет)*//*number*/
</column><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="sr_opl_bnk" as="sr_opl_bnk_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_bnk_a_d" haskeys="1" used="1">(
<select>--sr_opl_bnk
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_bnk_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_bnk" agg="sum" title="Оплата (поступление на счет)" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_bnk/*Оплата (поступление на счет)*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call></call></where>)
sr_opl_bnk_a_d
--\sr_opl_bnk
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" title="" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /**//*number*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat_oper" key="0" thissrc="dat_uch" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat_oper/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="sr_opl_bnk_a_d" column="kod_opl">sr_opl_bnk_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_opl_a_d" column="kod_dog">kod_opl_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_a_d" column="kod_sf">kod_opl_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_opl_a_d" column="dat_oper">kod_opl_a_d.dat_oper</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_kred" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_opl_a_d" column="dat_oper" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="dat_uch">kod_opl_a_d.dat_oper as dat, /*date*//*key*/
</column><column table="sr_opl_kred_a_d" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">sr_opl_kred_a_d.kod_dog as kod_dog, /*number*/
</column><column table="sr_opl_kred_a_d" column="kod_sf_kred" as="kod_sf" used="1" key="0" type="number" reference="sr_facvip" refcol="kod_sf">sr_opl_kred_a_d.kod_sf_kred as kod_sf, /*number*/
</column><column table="kod_opl_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_opl_a_d.vid_real as vid_real, /*number*/
</column><column table="sr_opl_kred_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Период оплаты" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/kod_opl_root" sourcecolumn="ym">sr_opl_kred_a_d.ym_vozn as ym_vozn, /*Период оплаты*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><column table="sr_opl_kred_a_d" column="opl_kred" as="sr_opl_opl_kred1" used="1" key="0" title="Оплата (кредит)" agg="sum">sr_opl_kred_a_d.opl_kred as sr_opl_opl_kred1, /*Оплата (кредит)*/
</column><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="sr_opl_kred" dimension="kod_opl_kred" as="sr_opl_kred_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d" haskeys="1" used="1">(
<select>--sr_opl_kred
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><call function="if" as="opl_kred" agg="sum" title="Оплата (кредит)" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="a" column="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call>) </call><text txtype="func"> then </text><column table="a" column="opl">a.opl</column><text txtype="func"> end </text> as opl_kred, /*Оплата (кредит)*/
</call><call function="nvl" type="number" as="ym_vozn" key="0" pth="" thissrc="ym_root" used="1" title="Период оплаты" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/kod_opl_root" sourcecolumn="ym"><text txtype="func"> nvl( </text><column table="kod_opl_root" column="ym">kod_opl_root.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Период оплаты" dimension="ym" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text> as ym_vozn, /*Период оплаты*//*number*/
</call><call function="if" type="number" as="kod_sf_kred" key="0" pth="" used="1" reference="sr_facvip" refcol="kod_sf"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> end </text> as kod_sf_kred/*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_kred" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_opl_recalc_tree_info" timestamp="21.02.2018 19:35:47" class="1" intrval="FREQ=DAILY; INTERVAL=1" materialize="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_opl_recalc_tree_info.xml" haskeys="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/sr_opl_recalc_tree_info1" noname="1" as="sr_opl_recalc_tree_info1" join="left outer" used="1">left outer join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_opl_root,
n2 as kod_opl
from rr_temp where skod = 'sr_opl_recalc_tree_info'
<select notext="1">--sr_opl_recalc_tree_info
select <column table="a" column="kod_opl_root" index="1" as="kod_opl_root" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/sr_opl_recalc_tree_info1" sourcecolumn="kod_opl_root" into="n1" used="1">a.kod_opl_root as kod_opl_root, /*number*/
</column><column table="a" column="kod_opl" index="1" as="kod_opl" key="1" fixed="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/sr_opl_recalc_tree_info1" sourcecolumn="kod_opl" into="n2" used="1">a.kod_opl as kod_opl/*number*//*key*/
</column></select><from notext="1">
from <table name="a" as="a" used="1">a
a
--\a
</table></from><call function="=" type="bool">)
sr_opl_recalc_tree_info1 on <column table="a" column="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="sr_opl_recalc_tree_info1" column="kod_opl">sr_opl_recalc_tree_info1.kod_opl</column></call>--\sr_opl_recalc_tree_info
</query><query name="sr_opl" as="kod_opl_root" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/kod_opl_root" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/kod_opl_root" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Период оплаты" dimension="ym" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_a_d/kod_opl_root" sourcecolumn="ym" used="1">a.ym as ym/*Период оплаты*//*number*/
</column></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_root on <column table="sr_opl_recalc_tree_info1" column="kod_opl_root">sr_opl_recalc_tree_info1.kod_opl_root</column><text txtype="func"> = </text><column table="kod_opl_root" column="kod_opl">kod_opl_root.kod_opl</column></call>--\sr_opl
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call></call></where>)
sr_opl_kred_a_d
--\sr_opl_kred
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="sr_opl_kred_a_d" column="kod_dog">sr_opl_kred_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" title="" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /**//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat_oper" key="0" thissrc="dat_uch" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat_oper/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="sr_opl_kred_a_d" column="kod_opl">sr_opl_kred_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_opl_a_d" column="dat_oper">kod_opl_a_d.dat_oper</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_sf" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="sr_opl_sf_a_d" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="dat_uch">sr_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="sr_opl_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_sf_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><column table="sr_opl_sf_a_d" column="opl_sf" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sr_opl_sf_a_d.opl_sf as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf, /*Оплата начислений*//*number*/
</call><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="sr_opl_sf_a_d" column="dat">sr_opl_sf_a_d.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_stor" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="sr_opl_stor_a_d" column="dat_oper1" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d" sourcecolumn="dat_uch">sr_opl_stor_a_d.dat_oper1 as dat, /*date*//*key*/
</column><column table="kod_opl_kred_a_d" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_kred_a_d" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">kod_opl_kred_a_d.kod_dog as kod_dog, /*number*/
</column><column table="sr_opl_stor_a_d" column="kod_sf_kred" as="kod_sf" used="1" key="0" type="number" reference="sr_facvip" refcol="kod_sf">sr_opl_stor_a_d.kod_sf_kred as kod_sf, /*number*/
</column><column table="kod_opl_a_d" column="vid_real" as="vid_real" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_opl_a_d.vid_real as vid_real, /*number*/
</column><column table="sr_opl_stor_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Период оплаты" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" sourcecolumn="ym">sr_opl_stor_a_d.ym_vozn as ym_vozn, /*Период оплаты*//*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><column table="sr_opl_stor_a_d" column="opl_stor" as="sr_opl_opl_stor1" used="1" key="0" type="number" title="Оплата (сторно)" agg="sum">sr_opl_stor_a_d.opl_stor as sr_opl_opl_stor1/*Оплата (сторно)*//*number*/
</column></select><from>
from <query name="sr_opl_stor" dimension="kod_opl_stor" as="sr_opl_stor_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d" haskeys="1" used="1">(
<select>--sr_opl_stor
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_parent" type="number" as="kod_parent" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d" sourcecolumn="kod_parent" used="1">a.kod_parent as kod_parent, /*number*/
</column><call function="+nvl" as="opl_stor" agg="sum" title="Оплата (сторно)" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_stor, /*Оплата (сторно)*//*number*/
</call><column table="a" column="dat_uch" type="date" title="" as="dat_oper1" key="0" thissrc="dat_oper" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat_oper1, /**//*date*/
</column><column table="kod_opl_kred" column="ym_root" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Период оплаты" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" sourcecolumn="ym">kod_opl_kred.ym_root as ym_vozn, /*Период оплаты*//*number*/
</column><column table="kod_opl_kred" column="kod_sf_kred" dimension="kod_sf" is-final-dimension="1" is-private-dimension="1" as="kod_sf_kred" key="0" used="1" type="number" reference="sr_facvip" refcol="kod_sf">kod_opl_kred.kod_sf_kred as kod_sf_kred/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_stor" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_opl_kred" as="kod_opl_kred" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred" haskeys="1" used="1">left outer join
(
<select>--sr_opl_kred
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="nvl" type="number" as="ym_root" key="0" pth="" used="1" title="Период оплаты" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" sourcecolumn="ym"><text txtype="func"> nvl( </text><column table="kod_opl_root" column="ym">kod_opl_root.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Период оплаты" dimension="ym" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text> as ym_root, /*Период оплаты*//*number*/
</call><call function="if" type="number" as="kod_sf_kred" key="0" pth="" used="1" reference="sr_facvip" refcol="kod_sf"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" thissrc="kod_sf">a.kod_sf</column><text txtype="func"> end </text> as kod_sf_kred/*number*/
</call></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_opl_recalc_tree_info" timestamp="21.02.2018 19:35:47" class="1" intrval="FREQ=DAILY; INTERVAL=1" materialize="1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_opl_recalc_tree_info.xml" haskeys="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/sr_opl_recalc_tree_info1" noname="1" as="sr_opl_recalc_tree_info1" join="left outer" used="1">left outer join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_opl_root,
n2 as kod_opl
from rr_temp where skod = 'sr_opl_recalc_tree_info'
<select notext="1">--sr_opl_recalc_tree_info
select <column table="a" column="kod_opl_root" index="1" as="kod_opl_root" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/sr_opl_recalc_tree_info1" sourcecolumn="kod_opl_root" into="n1" used="1">a.kod_opl_root as kod_opl_root, /*number*/
</column><column table="a" column="kod_opl" index="1" as="kod_opl" key="1" fixed="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/sr_opl_recalc_tree_info1" sourcecolumn="kod_opl" into="n2" used="1">a.kod_opl as kod_opl/*number*//*key*/
</column></select><from notext="1">
from <table name="a" as="a" used="1">a
a
--\a
</table></from><call function="=" type="bool">)
sr_opl_recalc_tree_info1 on <column table="a" column="kod_opl">a.kod_opl</column><text txtype="func"> = </text><column table="sr_opl_recalc_tree_info1" column="kod_opl">sr_opl_recalc_tree_info1.kod_opl</column></call>--\sr_opl_recalc_tree_info
</query><query name="sr_opl" as="kod_opl_root" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Период оплаты" dimension="ym" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_stor_a_d/kod_opl_kred/kod_opl_root" sourcecolumn="ym" used="1">a.ym as ym/*Период оплаты*//*number*/
</column></select><from>
from <table name="sr_opl" as="a" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_root on <column table="sr_opl_recalc_tree_info1" column="kod_opl_root">sr_opl_recalc_tree_info1.kod_opl_root</column><text txtype="func"> = </text><column table="kod_opl_root" column="kod_opl">kod_opl_root.kod_opl</column></call>--\sr_opl
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_kred on <column table="a" column="kod_parent">a.kod_parent</column><text txtype="func"> = </text><column table="kod_opl_kred" column="kod_opl">kod_opl_kred.kod_opl</column></call>--\sr_opl_kred
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>5</text></const><text txtype="func"> , </text><const><text>6</text></const>) </call></call></where>)
sr_opl_stor_a_d
--\sr_opl_stor
</query><query name="sr_opl_kred" dimension="kod_opl_kred" as="kod_opl_kred_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_kred_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_kred
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_kred_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_kred_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_kred" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_kred_a_d on <column table="sr_opl_stor_a_d" column="kod_parent">sr_opl_stor_a_d.kod_parent</column><text txtype="func"> = </text><column table="kod_opl_kred_a_d" column="kod_opl">kod_opl_kred_a_d.kod_opl</column></call>--\sr_opl_kred
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_opl_kred_a_d" column="kod_dog">kod_opl_kred_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" title="" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_a_d" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/**//*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl_a_d on <column table="kod_opl_kred_a_d" column="kod_opl">kod_opl_kred_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_a_d" column="kod_opl">kod_opl_a_d.kod_opl</column></call>--\sr_opl
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="sr_opl_stor_a_d" column="dat_oper1">sr_opl_stor_a_d.dat_oper1</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления" agg="max" sourcetable="./kod_graf/kod_sogl" sourcecolumn="dat_doc">un.dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf, /*number*//*key*/
</column><column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">un.vid_real, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">un.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query><query as="qube" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">union all
(
<select>--
select <const as="dat" used="1" key="1"><text>null</text> as dat, /*key*/
</const><const as="dat_dolg" used="1" key="0"><text>null</text> as dat_dolg, 
</const><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><const as="kod_sf" used="1" key="0"><text>null</text> as kod_sf, 
</const><const as="vid_real" used="1" key="0"><text>null</text> as vid_real, 
</const><const as="ym_vozn" used="1" key="0"><text>null</text> as ym_vozn, 
</const><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><column table="qube" column="kr_dogovor_kod_dog1" as="kr_dogovor_kod_dog1" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">qube.kr_dogovor_kod_dog1 as kr_dogovor_kod_dog1, /*number*/
</column><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kr_dogovor_kod_dog1" group="max" as="kr_dogovor_kod_dog1" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">max(un.kr_dogovor_kod_dog1)  as kr_dogovor_kod_dog1/*number*/
</column></select><from>
from <query as="un" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query dimension="kod_dog" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="kod_dog" column="kod_dog" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" as="kr_dogovor_kod_dog1" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kr_dogovor_kod_dog1/*number*/
</column></select><from>
from <query name="kr_dogovor" dimension="kod_dog" as="kod_dog" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from>)
kod_dog
--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">un.kod_dog/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query><query as="qube" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">union all
(
<select>--
select <column table="qube" column="dat" as="dat" used="1" key="1" type="date" title="Дата документа начисления">qube.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="qube" column="dat_dolg" as="dat_dolg" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="qube" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube.vid_real as vid_real, /*number*/
</column><column table="qube" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">qube.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="string" as="iv_sf_astr_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_astr_info_num_delo1, /*string*/
</const><const type="string" as="iv_sf_ur_prizn_info_num_delo1" used="1" key="0"><text>null</text> as iv_sf_ur_prizn_info_num_delo1, /*string*/
</const><const type="number" as="kr_dogovor_kod_dog1" used="1" key="0"><text>null</text> as kr_dogovor_kod_dog1, /*number*/
</const><const type="number" as="qube_graf_in_ob1" used="1" key="0"><text>null</text> as qube_graf_in_ob1, /*number*/
</const><const type="number" as="qube_graf_out_ob1" used="1" key="0"><text>null</text> as qube_graf_out_ob1, /*number*/
</const><column table="qube" column="sr_facras_nachisl2" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">qube.sr_facras_nachisl2 as sr_facras_nachisl2, /*Начислено*//*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="qube" column="sr_facvip_norm_av_av_nach1" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm">qube.sr_facvip_norm_av_av_nach1 as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="qube" column="sr_facvip_norm_av_osn_nach1" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm">qube.sr_facvip_norm_av_osn_nach1 as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_norm_av_av_opl1" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av">qube.sr_opl_norm_av_av_opl1 as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_norm_av_osn_opl1" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn">qube.sr_opl_norm_av_osn_opl1 as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><const type="number" as="sr_opl_opl_bnk1" used="1" key="0"><text>null</text> as sr_opl_opl_bnk1, /*number*/
</const><const type="number" as="sr_opl_opl_kred1" used="1" key="0"><text>null</text> as sr_opl_opl_kred1, /*number*/
</const><column table="qube" column="sr_opl_opl_sf2" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf2 as sr_opl_opl_sf2, /*Оплата начислений*//*number*/
</column><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_stor1" used="1" key="0"><text>null</text> as sr_opl_opl_stor1/*number*/
</const></select><from>
from <query as="qube" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления">un.dat as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="dat_dolg" group="1" as="dat_dolg" used="1" key="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">un.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">un.vid_real as vid_real, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="un" column="sr_facras_nachisl2" group="sum" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(un.sr_facras_nachisl2)  as sr_facras_nachisl2, /*Начислено*//*number*/
</column><column table="un" column="sr_facvip_norm_av_av_nach1" group="sum" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm">sum(un.sr_facvip_norm_av_av_nach1)  as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><column table="un" column="sr_facvip_norm_av_osn_nach1" group="sum" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm">sum(un.sr_facvip_norm_av_osn_nach1)  as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_norm_av_av_opl1" group="sum" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av">sum(un.sr_opl_norm_av_av_opl1)  as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_norm_av_osn_opl1" group="sum" as="sr_opl_norm_av_osn_opl1" used="1" key="0" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn">sum(un.sr_opl_norm_av_osn_opl1)  as sr_opl_norm_av_osn_opl1, /*Оплата начислений*/
</column><column table="un" column="sr_opl_opl_sf2" group="sum" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf2)  as sr_opl_opl_sf2/*Оплата начислений*//*number*/
</column></select><from>
from <query as="un" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query dimension="kod_ras" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_dolg" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="sr_facras_a_d" column="nachisl" as="sr_facras_nachisl2" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sr_facras_a_d.nachisl as sr_facras_nachisl2, /*Начислено*//*number*/
</column><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2/*number*/
</const></select><from>
from <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" haskeys="1" used="1">(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" used="1">a.nachisl as nachisl/*Начислено*//*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where>)
sr_facras_a_d
--\sr_facras
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facras_a_d" column="kod_sf">sr_facras_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_sf_norm_av_av" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_dolg" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_facvip_norm_av_av_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><column table="sr_facvip_norm_av_av_a_d" column="nach_av_norm" as="sr_facvip_norm_av_av_nach1" used="1" key="0" title="Отчетный период начисления" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm">sr_facvip_norm_av_av_a_d.nach_av_norm as sr_facvip_norm_av_av_nach1, /*Отчетный период начисления*/
</column><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2/*number*/
</const></select><from>
from <query name="sr_facvip_norm_av_av" dimension="kod_sf_norm_av_av" as="sr_facvip_norm_av_av_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_av
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_av_norm" fact="sr_facvip_norm_av_av_nach" agg="sum" as="nach_av_norm" key="0" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm">a.nach_av_norm as nach_av_norm/*Отчетный период начисления*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_av_norm" as="nach_av_norm" title="Отчетный период начисления" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_av_a_d/a" sourcecolumn="nach_av_norm" used="1" key="0">st.nach_av_norm as nach_av_norm/*Отчетный период начисления*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from>)
sr_facvip_norm_av_av_a_d
--\sr_facvip_norm_av_av
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_av_a_d" column="kod_sf">sr_facvip_norm_av_av_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_sf_norm_av_osn" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_sf" column="dat_rep" as="dat" used="1" key="1" type="date" title="Дата документа начисления">kod_sf.dat_rep as dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_dolg" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_facvip_norm_av_osn_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_sf" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><column table="sr_facvip_norm_av_osn_a_d" column="nach_osn_norm" as="sr_facvip_norm_av_osn_nach1" used="1" key="0" type="number" title="Начислено" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm">sr_facvip_norm_av_osn_a_d.nach_osn_norm as sr_facvip_norm_av_osn_nach1, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2/*number*/
</const></select><from>
from <query name="sr_facvip_norm_av_osn" dimension="kod_sf_norm_av_osn" as="sr_facvip_norm_av_osn_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d" haskeys="1" used="1">(
<select>--sr_facvip_norm_av_osn
select <column table="a" column="kod_sf" key="1" as="kod_sf" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="nach_osn_norm" fact="sr_facvip_norm_av_osn_nach" agg="sum" as="nach_osn_norm" key="0" used="1" type="number" title="Начислено" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm">a.nach_osn_norm as nach_osn_norm/*Начислено*//*number*/
</column></select><from>
from <query name="sr_facvip_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=HOURLY; INTERVAL=1" class="1" timestamp="20.08.2023 15:32:49" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip_norm.xml" elid="2428" ord="2428" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_facvip_norm_av
select <column table="st" column="kod_sf" as="kod_sf" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="kod_sf" used="1" key="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="nach_osn_norm" as="nach_osn_norm" title="Начислено" agg="sum" format="F2" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facvip_norm_av_osn_a_d/a" sourcecolumn="nach_osn_norm" used="1" key="0">st.nach_osn_norm as nach_osn_norm/*Начислено*//*number*/
</column></select><from>
from <table name="vv_sr_facvip_norm_av" as="st" used="1">vv_sr_facvip_norm_av
st
--\vv_sr_facvip_norm_av
</table></from>)
a
--\sr_facvip_norm_av
</query></from>)
sr_facvip_norm_av_osn_a_d
--\sr_facvip_norm_av_osn
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep, /*Дата документа начисления*//*date*/
</call><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facvip_norm_av_osn_a_d" column="kod_sf">sr_facvip_norm_av_osn_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_sf" column="dat_rep">kod_sf.dat_rep</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_norm_av_av" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_opl_sf_a_d" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat_oper_dolg" as="dat_dolg" used="1" key="0" type="date" title="Дата операции оплаты задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_opl_sf_a_d.dat_oper_dolg as dat_dolg, /*Дата операции оплаты задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><column table="sr_opl_norm_av_av_a_d" column="opl" as="sr_opl_norm_av_av_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av">sr_opl_norm_av_av_a_d.opl as sr_opl_norm_av_av_opl1, /*Оплата начислений*//*number*/
</column><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2/*number*/
</const></select><from>
from <query name="sr_opl_norm_av_av" dimension="kod_opl_norm_av_av" as="sr_opl_norm_av_av_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d" used="1">(
<select>--sr_opl_norm_av_av
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_av" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_av_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av">a.opl_av as opl/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_av" as="opl_av" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_av_a_d/a" sourcecolumn="opl_av" used="1" key="0">st.opl_av as opl_av/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from>)
sr_opl_norm_av_av_a_d
--\sr_opl_norm_av_av
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><call function="latest" as="dat_oper_dolg" type="date" title="Дата операции оплаты задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="kod_sf" column="dat_bzad">kod_sf.dat_bzad</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="a" column="dat_uch" type="date" title="" as="dat_uch" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_uch">a.dat_uch</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat_oper_dolg, /*Дата операции оплаты задолженности*//*date*/
</call><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_av_a_d" column="kod_opl">sr_opl_norm_av_av_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_norm_av_osn" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="kod_opl_sf_a_d" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="dat_uch">kod_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="kod_opl_sf_a_d" column="dat_oper_dolg" as="dat_dolg" used="1" key="0" type="date" title="Дата операции оплаты задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_opl_sf_a_d.dat_oper_dolg as dat_dolg, /*Дата операции оплаты задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="kod_opl_sf_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">kod_opl_sf_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="kod_opl_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_opl_sf_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><column table="sr_opl_norm_av_osn_a_d" column="opl" as="sr_opl_norm_av_osn_opl1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn">sr_opl_norm_av_osn_a_d.opl as sr_opl_norm_av_osn_opl1, /*Оплата начислений*//*number*/
</column><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2/*number*/
</const></select><from>
from <query name="sr_opl_norm_av_osn" dimension="kod_opl_norm_av_osn" as="sr_opl_norm_av_osn_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d" used="1">(
<select>--sr_opl_norm_av_osn
select <column table="a" column="kod_opl" as="kod_opl" used="1" key="1" keypath=".kod_opl" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="opl_osn" agg="sum" as="opl" is-fact="1" fact="sr_opl_norm_av_osn_opl" used="1" key="0" type="number" title="Оплата начислений" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn">a.opl_osn as opl/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_norm_av" comment="Уменьшение начислений авансов чтобы они не превышали осн реал. для сверхнорм" use-repository="1" intrval="FREQ=DAILY; INTERVAL=1" timestamp="20.08.2023 15:34:01" file="sql.builder.templates\sql.builder\projects\asuse2\reports\33654.xml" elid="1026" ord="1026" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" noname="1" as="a" used="1">(
<select>--sr_opl_norm_av
select <column table="st" column="kod_opl" as="kod_opl" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="kod_opl" used="1" key="1">st.kod_opl as kod_opl, /*number*//*key*/
</column><column table="st" column="opl_osn" as="opl_osn" title="Оплата начислений" agg="sum" format="F2" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_norm_av_osn_a_d/a" sourcecolumn="opl_osn" used="1" key="0">st.opl_osn as opl_osn/*Оплата начислений*//*number*/
</column></select><from>
from <table name="vv_sr_opl_norm_av" as="st" used="1">vv_sr_opl_norm_av
st
--\vv_sr_opl_norm_av
</table></from>)
a
--\sr_opl_norm_av
</query></from>)
sr_opl_norm_av_osn_a_d
--\sr_opl_norm_av_osn
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="kod_opl_sf_a_d" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><call function="latest" as="dat_oper_dolg" type="date" title="Дата операции оплаты задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="kod_sf" column="dat_bzad">kod_sf.dat_bzad</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="a" column="dat_uch" type="date" title="" as="dat_uch" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_uch">a.dat_uch</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat_oper_dolg, /*Дата операции оплаты задолженности*//*date*/
</call><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
kod_opl_sf_a_d on <column table="sr_opl_norm_av_osn_a_d" column="kod_opl">sr_opl_norm_av_osn_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl_sf_a_d" column="kod_opl">kod_opl_sf_a_d.kod_opl</column></call>--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_opl_sf_a_d" column="kod_sf">kod_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_opl_sf_a_d" column="dat">kod_opl_sf_a_d.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query><query dimension="kod_opl_sf" multiplicate-point="1" as="un" union="1" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="sr_opl_sf_a_d" column="dat" as="dat" used="1" key="1" type="date" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="dat_uch">sr_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="sr_opl_sf_a_d" column="dat_oper_dolg" as="dat_dolg" used="1" key="0" type="date" title="Дата операции оплаты задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">sr_opl_sf_a_d.dat_oper_dolg as dat_dolg, /*Дата операции оплаты задолженности*//*date*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf as kod_sf, /*number*/
</column><column table="kod_sf" column="vid_real" as="vid_real" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">kod_sf.vid_real as vid_real, /*number*/
</column><column table="sr_opl_sf_a_d" column="ym_vozn" as="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">sr_opl_sf_a_d.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><const type="number" as="sr_facras_nachisl2" used="1" key="0"><text>null</text> as sr_facras_nachisl2, /*number*/
</const><const type="" as="sr_facvip_norm_av_av_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_av_nach1, /**/
</const><const type="number" as="sr_facvip_norm_av_osn_nach1" used="1" key="0"><text>null</text> as sr_facvip_norm_av_osn_nach1, /*number*/
</const><const type="number" as="sr_opl_norm_av_av_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_av_opl1, /*number*/
</const><const type="" as="sr_opl_norm_av_osn_opl1" used="1" key="0"><text>null</text> as sr_opl_norm_av_osn_opl1, /**/
</const><column table="sr_opl_sf_a_d" column="opl_sf" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sr_opl_sf_a_d.opl_sf as sr_opl_opl_sf2/*Оплата начислений*//*number*/
</column></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf, /*Оплата начислений*//*number*/
</call><column table="kod_sf" column="ym_vozn" dimension="ym_vozn" as="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym">kod_sf.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><call function="latest" as="dat_oper_dolg" type="date" title="Дата операции оплаты задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="kod_sf" column="dat_bzad">kod_sf.dat_bzad</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="a" column="dat_uch" type="date" title="" as="dat_uch" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_uch">a.dat_uch</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat_oper_dolg, /*Дата операции оплаты задолженности*//*date*/
</call><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><call function="if" type="number" as="ym_vozn" key="0" pth="" used="1" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" thissrc="rym">kod_sf_dop.rym</column><text txtype="func"> else </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf_old_neg" column="ym">kod_sf_old_neg.ym</column><text txtype="func"> , </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> ) </text>) </call><text txtype="func"> end </text> as ym_vozn/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query><query name="vv_sr_facvip_rec_info_m" as="kod_sf_rec_info" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_rec_info_m
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_sf_old_neg" type="number" as="kod_sf_old_neg" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_rec_info" sourcecolumn="kod_sf_old_neg" used="1">a.kod_sf_old_neg as kod_sf_old_neg/*number*/
</column></select><from>
from <table name="vv_sr_facvip_rec_info_m" as="a" used="1">vv_sr_facvip_rec_info_m
a
--\vv_sr_facvip_rec_info_m
</table></from><call function="=" type="bool">)
kod_sf_rec_info on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_rec_info" column="kod_sf">kod_sf_rec_info.kod_sf</column></call>--\vv_sr_facvip_rec_info_m
</query><query name="sr_facvip" as="kod_sf_old_neg" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf_a_d/kod_sf/kod_sf_old_neg" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_old_neg on <column table="kod_sf_rec_info" column="kod_sf_old_neg">kod_sf_rec_info.kod_sf_old_neg</column><text txtype="func"> = </text><column table="kod_sf_old_neg" column="kod_sf">kod_sf_old_neg.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="true">() </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><const>:kod_dog </const>) </call><call function="and" dont-push="1">(<call function="lt">(<column table="dat" column="val">dat.val</column><const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="sr_opl_sf_a_d" column="dat">sr_opl_sf_a_d.dat</column><text txtype="func"> &lt; </text><const><text>:dat </text></const>) </call>) </call></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat" group="1" as="dat" used="1" key="1" type="date" title="Дата документа начисления">un.dat, /*Дата документа начисления*//*date*//*key*/
</column><column table="un" column="dat_dolg" group="1" as="dat_dolg" used="1" key="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">un.dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf, /*number*//*key*/
</column><column table="un" column="vid_real" group="1" as="vid_real" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">un.vid_real, /*number*//*key*/
</column><column table="un" column="ym_vozn" group="1" as="ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_sf_old_neg" sourcecolumn="ym">un.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query><query name="sk_vid_real" dimension="vid_real" link-mp-point="1" as="vid_real" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/vid_real" haskeys="1" used="1">left outer join
(
<select>--sk_vid_real
select <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/vid_real" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/**//*number*//*key*/
</column></select><from>
from <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1">sk_vid_real
a
--\sk_vid_real
</table></from><call function="=" type="bool">)
vid_real on <column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> = </text><column table="qube" column="vid_real">qube.vid_real</column></call>--\sk_vid_real
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf" sourcecolumn="vid_real" used="1">a.vid_real as vid_real, /*number*/
</column><column table="a" column="dat_ezad" type="date" as="dat_ezad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf" sourcecolumn="dat_ezad" used="1">a.dat_ezad as dat_ezad, /*date*/
</column><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf/kod_sf_dop" sourcecolumn="rym">kod_sf_dop.rym as rym/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query></from><group> group by
<column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf, /*number*//*key*/
</column><column table="qube" column="vid_real" group="1" as="vid_real" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./kod_sf" sourcecolumn="vid_real" reference="sk_vid_real" refcol="vid_real">qube.vid_real, /*number*//*key*/
</column><column table="qube" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">qube.ym_vozn/*Отчетный период начисления*//*number*//*key*/
</column></group>)
qube
--\
</query><query name="sk_vid_real" dimension="vid_real" link-mp-point="1" as="vid_real" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/vid_real" haskeys="1" used="1">left outer join
(
<select>--sk_vid_real
select <column table="a" column="vid_real" type="number" title="" as="vid_real" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real" used="1">a.vid_real as vid_real/**//*number*//*key*/
</column></select><from>
from <table name="sk_vid_real" as="a" title="Вид реализации" dimension="vid_real" used="1">sk_vid_real
a
--\sk_vid_real
</table></from><call function="=" type="bool">)
vid_real on <column table="vid_real" column="vid_real">vid_real.vid_real</column><text txtype="func"> = </text><column table="qube" column="vid_real">qube.vid_real</column></call>--\sk_vid_real
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym" used="1">a.ym as ym, /*Отчетный период начисления*//*number*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</call><column table="kod_sf_dop" column="rym" dgroup="min" dimension="ym_vozn2" as="rym" key="0" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_sf_dop" sourcecolumn="rym">kod_sf_dop.rym as rym/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="rym" as="rym" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_sf_dop" sourcecolumn="rym" used="1">st.rym as rym/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query><query name="vv_sr_facvip_ret_inf" as="kod_sf_ret_inf" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kod_sf_ret_inf" haskeys="1" used="1">left outer join
(
<select>--vv_sr_facvip_ret_inf
select <column table="a" column="kod_sf" type="number" as="kod_sf" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf_ret_inf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="decode" type="string" as="name_podpis" key="0" pth="" used="1"><text txtype="func"> decode( </text><column table="a" column="pr_podpis" type="number" title="" as="pr_podpis" key="0" thissrc="pr_podpis">a.pr_podpis</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> , </text><const><text>'подписано'</text></const><text txtype="func"> , </text><const><text>'не подписано'</text></const><text txtype="func"> ) </text> as name_podpis/*string*/
</call></select><from>
from <table name="vv_sr_facvip_ret_inf" as="a" used="1">vv_sr_facvip_ret_inf
a
--\vv_sr_facvip_ret_inf
</table></from><call function="=" type="bool">)
kod_sf_ret_inf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_ret_inf" column="kod_sf">kod_sf_ret_inf.kod_sf</column></call>--\vv_sr_facvip_ret_inf
</query><query name="sr_facvip_dop" timestamp="27.12.2018 19:41:14" class="1" intrval="FREQ=DAILY; INTERVAL=1" file="sql.builder.templates\sql.builder\projects\asuse2_scheme\scheme\extension\sr_facvip.xml" elid="2072" ord="2072" leaf="0" lvl="2" pelid="" path="./fin/p1/grsets_query/grpd/grpd/kod_sf_dop" noname="1" haskeys="1" as="kod_sf_dop" join="left outer" used="1">left outer join
(
<select>--sr_facvip_dop
select <column table="st" column="kod_sf" as="kod_sf" type="number" key="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf_dop" sourcecolumn="kod_sf" used="1">st.kod_sf as kod_sf, /*number*//*key*/
</column><column table="st" column="perc" as="perc" type="number" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf_dop" sourcecolumn="perc" used="1">st.perc as perc/*number*/
</column></select><from>
from <table name="vv_sr_facvip_dop" as="st" used="1">vv_sr_facvip_dop
st
--\vv_sr_facvip_dop
</table></from><call function="=" type="bool">)
kod_sf_dop on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_dop" column="kod_sf">kod_sf_dop.kod_sf</column></call>--\sr_facvip_dop
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kod_dog_fin" type="number" is-final-dimension="kod_dog_fin" dimension="kod_dog_fin" as="kod_dog_fin" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog_fin" used="1">a.kod_dog_fin as kod_dog_fin/*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_dogovor" as="kod_dog_fin" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*/
</column><column table="a" column="ndog" type="string" title="Номер договора" comment="номер договора" fact="kr_dog_ndog" agg="stragg_dist" vid="1" as="ndog" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog" used="1">a.ndog as ndog, /*Номер договора*//*string*/
</column><column table="a" column="dep" type="number" title="" vid="1" as="dep" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="dep" used="1">a.dep as dep/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog_fin on <column table="kod_dog" column="kod_dog_fin">kod_dog.kod_dog_fin</column><text txtype="func"> = </text><column table="kod_dog_fin" column="kod_dog">kod_dog_fin.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="nump" type="string" title="Код абонента" comment="номер абонента" vid="1" is-name="1" as="nump" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump" used="1">a.nump as nump/*Код абонента*//*string*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog_fin" column="kodp">kod_dog_fin.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="kr_org" as="dep" join="left outer" path="./fin/p1/grsets_query/grpd/grpd/dep" haskeys="1" used="1">left outer join
(
<select>--kr_org
select <column table="a" column="kodp" type="number" title="" as="kodp" key="1" fixed="1" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Отделение" as="name" key="0" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name" used="1">a.name as name/*Отделение*//*string*/
</column></select><from>
from <table name="kr_org" as="a" used="1">kr_org
a
--\kr_org
</table></from><call function="=" type="bool">)
dep on <column table="kod_dog_fin" column="dep">kod_dog_fin.dep</column><text txtype="func"> = </text><column table="dep" column="kodp">dep.kodp</column></call>--\kr_org
</query></from><where>where
<call function="!=0" pth="" type="bool"><text txtype="func"> nvl( </text><column column="dolg_not_av1" as="dolg_check" table="qube" nvl="0" is-fact-use="1" removeable="1" thissrc="dolg_check">nvl(qube.dolg_not_av1,0) </column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><call function="+nvl" as="dolg_kred" nvl="0" pth="" type="number">(nvl(<text txtype="func"> nvl( </text><column column="dolg_kred_os1" table="qube" as="dolg_kred_os1">qube.dolg_kred_os1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column column="dolg_kred_av1" table="qube" as="dolg_kred_av1">qube.dolg_kred_av1</column><text txtype="func"> ,0) </text>,0) ) </call><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column column="kr_dogovor_kod_dog1" title=" " as="pr_dog" is-fact-use="1" removeable="1" thissrc="pr_dog" table="qube">qube.kr_dogovor_kod_dog1</column><text txtype="func"> ,0)!=0 </text><text txtype="func"> or nvl( </text><column column="opl_in_month1" table="qube" as="opl" nvl="0" is-fact-use="1" removeable="1" thissrc="opl">nvl(qube.opl_in_month1,0) </column><text txtype="func"> ,0)!=0 </text></call></where>)
grpd
--\
</query></from>)
--\
</query></with><select>--36703-fin-dat
select '36703-fin-dat' as skod,
'36703-fin-dat|#'||mtr.growid as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="fin" column="grsetname" as="grsetname" type="string" used="1" key="0" into="s1">fin.grsetname as grsetname, /*string*/
</column><column table="fin" column="kod_dog" as="kod_dog" c-master-key="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog" into="n1">fin.kod_dog as kod_dog, /*number*/
</column><column table="fin" column="ndog" as="ndog" c-master="kod_dog" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog" into="s2">fin.ndog as ndog, /*Номер договора*//*string*/
</column><column table="fin" column="name" as="name" c-master="kod_dog" used="1" key="0" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name" into="s3">fin.name as name, /*Отделение*//*string*/
</column><column table="fin" column="nump" as="nump" c-master="kod_dog" used="1" key="0" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump" into="s4">fin.nump as nump, /*Код абонента*//*string*/
</column><column table="fin" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn" into="n2">fin.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="kod_sf" as="kod_sf" c-master-key="kod_sf" used="1" key="0" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" into="n3">fin.kod_sf as kod_sf, /*number*/
</column><column table="fin" column="dat_bzad" as="dat_bzad" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad" into="d1">fin.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="fin" column="ym" as="ym" c-master="kod_sf" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym" into="n4">fin.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="name_podpis" as="name_podpis" used="1" key="0" type="string" into="s5">fin.name_podpis as name_podpis, /*string*/
</column><column table="fin" column="name_plat" as="name_plat" used="1" key="0" type="string" title="Наименование платежа" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real" into="s6">fin.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="fin" column="nach" as="nach" is-fact-use="1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" into="n5">fin.nach as nach, /*Начислено*//*number*/
</column><column table="fin" column="opl_nach" as="opl_nach" is-fact-use="1" used="1" key="0" type="number" title="Оплата начислений" agg="sum" into="n6">fin.opl_nach as opl_nach, /*Оплата начислений*//*number*/
</column><column table="fin" column="opl" as="opl" is-fact-use="1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum" into="n7">fin.opl as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="fin" column="dolg" as="dolg" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" into="n8">fin.dolg as dolg, /*Оборот*//*number*/
</column><column table="fin" column="dolg_check" as="dolg_check" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl" into="n9">fin.dolg_check as dolg_check, /*Оборот*//*number*/
</column><column table="fin" column="dolg_pros" as="dolg_pros" is-fact-use="1" used="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad" into="n10">fin.dolg_pros as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="fin" column="dolg_kred_os" as="dolg_kred_os" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" into="n11">fin.dolg_kred_os as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="dolg_kred_av" as="dolg_kred_av" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum" into="n12">fin.dolg_kred_av as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="fin" column="dolg_kred" as="dolg_kred" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" into="n13">fin.dolg_kred as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="pr_dog" as="pr_dog" is-fact-use="1" used="1" key="0" type="number" title=" " agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" into="n14">fin.pr_dog as pr_dog, /* *//*number*/
</column><column table="fin" column="visitog" as="visitog" used="1" key="0" type="number" into="n15">fin.visitog as visitog, /*number*/
</column><column table="fin" column="visitog_deb" as="visitog_deb" used="1" key="0" type="number" into="n16">fin.visitog_deb as visitog_deb, /*number*/
</column><column table="fin" column="visitog_osn_av" as="visitog_osn_av" used="1" key="0" type="number" into="n17">fin.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="fin" column="visitog_osn" as="visitog_osn" used="1" key="0" type="number" into="n18">fin.visitog_osn as visitog_osn, /*number*/
</column><column table="fin" column="visdet_osn" as="visdet_osn" used="1" key="0" type="number" into="n19">fin.visdet_osn as visdet_osn, /*number*/
</column><column table="fin" column="visdet_av" as="visdet_av" used="1" key="0" type="number" into="n20">fin.visdet_av as visdet_av, /*number*/
</column><column table="fin" column="visdet_othr" as="visdet_othr" used="1" key="0" type="number" into="n21">fin.visdet_othr as visdet_othr, /*number*/
</column><column table="fin" column="gr_rn" as="gr_rn" type="number" used="1" key="0" into="n22">fin.gr_rn as gr_rn, /*number*/
</column><column table="fin" column="growid" as="growid" type="string" title="" keypath=".growid" used="1" key="1" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" into="s7">fin.growid as growid, /**//*string*//*key*/
</column><column table="fin" column="parent_growid" as="parent_growid" type="string" title="" used="1" key="0" agg="max" format="F2" c-master-key="kod_dog" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog" reference="sr_facvip" refcol="kod_sf" into="s8">fin.parent_growid as parent_growid, /**//*string*/
</column><column table="fin" column="groupingid" as="groupingid" used="1" key="0" type="number" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" into="n23">fin.groupingid as groupingid, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="grsetid" as="grsetid" type="string" title="" used="1" key="0" into="s9">fin.grsetid as grsetid, /**//*string*/
</column><column table="fin" column="origgrsetid" as="origgrsetid" type="string" title="" used="1" key="0" into="s10">fin.origgrsetid as origgrsetid, /**//*string*/
</column><column table="fin" column="parent_grsetid" as="parent_grsetid" type="string" title="" used="1" key="0" into="s11">fin.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="fin" column="par_groupingid" as="par_groupingid" type="number" title="" used="1" key="0" into="n24">fin.par_groupingid as par_groupingid, /**//*number*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-fin-dat" as="fin" path="./fin" order="kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first" haskeys="1" used="1">(
<select>--36703-fin-dat
select <call function="decode" as="grsetname" type="string" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'31'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'71'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'593'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'862'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> ) </text> as grsetname, /*string*/
</call><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog">p1.kod_dog as kod_dog, /*number*/
</column><column table="p1" column="ndog" as="ndog" c-master="kod_dog" key="0" used="1" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog">p1.ndog as ndog, /*Номер договора*//*string*/
</column><column table="p1" column="name" as="name" c-master="kod_dog" key="0" used="1" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name">p1.name as name, /*Отделение*//*string*/
</column><column table="p1" column="nump" as="nump" c-master="kod_dog" key="0" used="1" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump">p1.nump as nump, /*Код абонента*//*string*/
</column><column table="p1" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">p1.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="p1" column="kod_sf" as="kod_sf" c-master-key="kod_sf" key="0" used="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">p1.kod_sf as kod_sf, /*number*/
</column><column table="p1" column="dat_bzad" as="dat_bzad" key="0" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad">p1.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="p1" column="ym" as="ym" c-master="kod_sf" key="0" used="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym">p1.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="p1" column="name_podpis" as="name_podpis" key="0" used="1" type="string">p1.name_podpis as name_podpis, /*string*/
</column><column table="p1" column="name_plat" as="name_plat" key="0" used="1" type="string" title="Наименование платежа" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real">p1.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="p1" column="nach" as="nach" is-fact-use="1" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">p1.nach as nach, /*Начислено*//*number*/
</column><column table="p1" column="opl_nach" as="opl_nach" is-fact-use="1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">p1.opl_nach as opl_nach, /*Оплата начислений*//*number*/
</column><column table="p1" column="opl" as="opl" is-fact-use="1" key="0" used="1" type="number" title="Оплата (поступление на счет)" agg="sum">p1.opl as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="p1" column="dolg" as="dolg" is-fact-use="1" key="0" used="1" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">p1.dolg as dolg, /*Оборот*//*number*/
</column><column table="p1" column="dolg_check" as="dolg_check" is-fact-use="1" key="0" used="1" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">p1.dolg_check as dolg_check, /*Оборот*//*number*/
</column><column table="p1" column="dolg_pros" as="dolg_pros" is-fact-use="1" key="0" used="1" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">p1.dolg_pros as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="p1" column="dolg_kred_os" as="dolg_kred_os" is-fact-use="1" key="0" used="1" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">p1.dolg_kred_os as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="p1" column="dolg_kred_av" as="dolg_kred_av" is-fact-use="1" key="0" used="1" type="number" title="Кредиторская задолженность  по  авансам" agg="sum">p1.dolg_kred_av as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="p1" column="dolg_kred" as="dolg_kred" key="0" used="1" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">p1.dolg_kred as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="p1" column="pr_dog" as="pr_dog" is-fact-use="1" key="0" used="1" type="number" title=" " agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">p1.pr_dog as pr_dog, /* *//*number*/
</column><column table="p1" column="visitog" as="visitog" key="0" used="1" type="number">p1.visitog as visitog, /*number*/
</column><column table="p1" column="visitog_deb" as="visitog_deb" key="0" used="1" type="number">p1.visitog_deb as visitog_deb, /*number*/
</column><column table="p1" column="visitog_osn_av" as="visitog_osn_av" key="0" used="1" type="number">p1.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="p1" column="visitog_osn" as="visitog_osn" key="0" used="1" type="number">p1.visitog_osn as visitog_osn, /*number*/
</column><column table="p1" column="visdet_osn" as="visdet_osn" key="0" used="1" type="number">p1.visdet_osn as visdet_osn, /*number*/
</column><column table="p1" column="visdet_av" as="visdet_av" key="0" used="1" type="number">p1.visdet_av as visdet_av, /*number*/
</column><column table="p1" column="visdet_othr" as="visdet_othr" key="0" used="1" type="number">p1.visdet_othr as visdet_othr, /*number*/
</column><call function="row_number" as="gr_rn" pth="" type="number" key="0" used="1"><text txtype="func"> row_number() over( </text><call function="order by simple" pth="0" type="order"><text txtype="func"> order by </text><const><text>null</text></const></call><text txtype="func"> ) </text> as gr_rn, /*number*/
</call><call function="||" as="growid" type="string" key="1" title="" pth="" used="1" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf"><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_deb" as="visitog_deb" thissrc="visitog_deb">p1.visitog_deb</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_osn" as="visitog_osn" thissrc="visitog_osn">p1.visitog_osn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>4</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_osn" as="visdet_osn" thissrc="visdet_osn">p1.visdet_osn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>8</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_osn_av" as="visitog_osn_av" thissrc="visitog_osn_av">p1.visitog_osn_av</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>16</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_av" as="visdet_av" thissrc="visdet_av">p1.visdet_av</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>32</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog" as="visitog" thissrc="visitog">p1.visitog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>64</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_othr" as="visdet_othr" thissrc="visdet_othr">p1.visdet_othr</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>128</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>256</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" thissrc="ym_vozn">p1.ym_vozn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>512</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_sf" as="kod_sf" c-master-key="kod_sf" thissrc="kod_sf">p1.kod_sf</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const> as growid, /**//*string*//*key*/
</call><call function="if" as="parent_growid" type="string" title="" pth="" key="0" used="1" agg="max" format="F2" c-master-key="kod_dog" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog" reference="sr_facvip" refcol="kod_sf"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is null" pth="" type="bool">(<column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> is null </text>) </call><text txtype="func"> then </text><const><text>null</text></const><text txtype="func"> else </text><call function="||" pth="" type="string">(<const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_deb" as="visitog_deb" thissrc="visitog_deb">p1.visitog_deb</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_osn" as="visitog_osn" thissrc="visitog_osn">p1.visitog_osn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>4</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_osn" as="visdet_osn" thissrc="visdet_osn">p1.visdet_osn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>8</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog_osn_av" as="visitog_osn_av" thissrc="visitog_osn_av">p1.visitog_osn_av</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>16</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_av" as="visdet_av" thissrc="visdet_av">p1.visdet_av</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>32</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visitog" as="visitog" thissrc="visitog">p1.visitog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>64</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visdet_othr" as="visdet_othr" thissrc="visdet_othr">p1.visdet_othr</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>128</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>256</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" thissrc="ym_vozn">p1.ym_vozn</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>512</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_sf" as="kod_sf" c-master-key="kod_sf" thissrc="kod_sf">p1.kod_sf</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const>) </call><text txtype="func"> end </text> as parent_growid, /**//*string*/
</call><column table="p1" column="groupingid" as="groupingid" key="0" used="1" type="number" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">p1.groupingid as groupingid, /*Отчетный период начисления*//*number*/
</column><call function="decode" as="grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'31'</text></const><text txtype="func"> , </text><const><text>'det_othr'</text></const><text txtype="func"> , </text><const><text>'71'</text></const><text txtype="func"> , </text><const><text>'det_av'</text></const><text txtype="func"> , </text><const><text>'593'</text></const><text txtype="func"> , </text><const><text>'det_osn'</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>'itog_osn'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'itog_osn_av'</text></const><text txtype="func"> , </text><const><text>'862'</text></const><text txtype="func"> , </text><const><text>'itog_deb'</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> , </text><const><text>'itog'</text></const><text txtype="func"> ) </text> as grsetid, /**//*string*/
</call><call function="decode" as="origgrsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'31'</text></const><text txtype="func"> , </text><const><text>'det_othr'</text></const><text txtype="func"> , </text><const><text>'71'</text></const><text txtype="func"> , </text><const><text>'det_av'</text></const><text txtype="func"> , </text><const><text>'593'</text></const><text txtype="func"> , </text><const><text>'det_osn'</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>'itog_osn'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'itog_osn_av'</text></const><text txtype="func"> , </text><const><text>'862'</text></const><text txtype="func"> , </text><const><text>'itog_deb'</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> , </text><const><text>'itog'</text></const><text txtype="func"> ) </text> as origgrsetid, /**//*string*/
</call><call function="decode" as="parent_grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'31'</text></const><text txtype="func"> , </text><const><text>'itog'</text></const><text txtype="func"> , </text><const><text>'71'</text></const><text txtype="func"> , </text><const><text>'itog_osn_av'</text></const><text txtype="func"> , </text><const><text>'593'</text></const><text txtype="func"> , </text><const><text>'itog_osn'</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>'itog_osn_av'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'itog'</text></const><text txtype="func"> , </text><const><text>'862'</text></const><text txtype="func"> , </text><const><text>'itog'</text></const><text txtype="func"> ) </text> as parent_grsetid, /**//*string*/
</call><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1">p1.par_groupingid as par_groupingid/**//*number*/
</column></select><from>
from <query as="p1" path="./fin/p1" used="1">(
<select>--
select <column table="grsets_query" column="kod_dog" as="kod_dog" c-master-key="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog">grsets_query.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grsets_query" column="ndog" as="ndog" c-master="kod_dog" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog">grsets_query.ndog as ndog, /*Номер договора*//*string*/
</column><column table="grsets_query" column="name" as="name" c-master="kod_dog" used="1" key="0" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name">grsets_query.name as name, /*Отделение*//*string*/
</column><column table="grsets_query" column="nump" as="nump" c-master="kod_dog" used="1" key="0" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump">grsets_query.nump as nump, /*Код абонента*//*string*/
</column><column table="grsets_query" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">grsets_query.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="grsets_query" column="kod_sf" as="kod_sf" c-master-key="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">grsets_query.kod_sf as kod_sf, /*number*//*key*/
</column><column table="grsets_query" column="dat_bzad" as="dat_bzad" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad">grsets_query.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="grsets_query" column="ym" as="ym" c-master="kod_sf" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym">grsets_query.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="grsets_query" column="name_podpis" as="name_podpis" used="1" key="0" type="string">grsets_query.name_podpis as name_podpis, /*string*/
</column><column table="grsets_query" column="name_plat" as="name_plat" used="1" key="0" type="string" title="Наименование платежа" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real">grsets_query.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="grsets_query" column="nach" as="nach" is-fact-use="1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">grsets_query.nach as nach, /*Начислено*//*number*/
</column><column table="grsets_query" column="opl_nach" as="opl_nach" is-fact-use="1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">grsets_query.opl_nach as opl_nach, /*Оплата начислений*//*number*/
</column><column table="grsets_query" column="opl" as="opl" is-fact-use="1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">grsets_query.opl as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="grsets_query" column="dolg" as="dolg" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">grsets_query.dolg as dolg, /*Оборот*//*number*/
</column><column table="grsets_query" column="dolg_check" as="dolg_check" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">grsets_query.dolg_check as dolg_check, /*Оборот*//*number*/
</column><column table="grsets_query" column="dolg_pros" as="dolg_pros" is-fact-use="1" used="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">grsets_query.dolg_pros as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="grsets_query" column="dolg_kred_os" as="dolg_kred_os" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">grsets_query.dolg_kred_os as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grsets_query" column="dolg_kred_av" as="dolg_kred_av" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum">grsets_query.dolg_kred_av as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="grsets_query" column="dolg_kred" as="dolg_kred" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">grsets_query.dolg_kred as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grsets_query" column="pr_dog" as="pr_dog" is-fact-use="1" used="1" key="0" type="number" title=" " agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">grsets_query.pr_dog as pr_dog, /* *//*number*/
</column><column table="grsets_query" column="visitog" as="visitog" used="1" key="0" type="number">grsets_query.visitog as visitog, /*number*/
</column><column table="grsets_query" column="visitog_deb" as="visitog_deb" used="1" key="0" type="number">grsets_query.visitog_deb as visitog_deb, /*number*/
</column><column table="grsets_query" column="visitog_osn_av" as="visitog_osn_av" used="1" key="0" type="number">grsets_query.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="grsets_query" column="visitog_osn" as="visitog_osn" used="1" key="0" type="number">grsets_query.visitog_osn as visitog_osn, /*number*/
</column><column table="grsets_query" column="visdet_osn" as="visdet_osn" used="1" key="0" type="number">grsets_query.visdet_osn as visdet_osn, /*number*/
</column><column table="grsets_query" column="visdet_av" as="visdet_av" used="1" key="0" type="number">grsets_query.visdet_av as visdet_av, /*number*/
</column><column table="grsets_query" column="visdet_othr" as="visdet_othr" used="1" key="0" type="number">grsets_query.visdet_othr as visdet_othr, /*number*/
</column><column table="grsets_query" column="groupingid" as="groupingid" used="1" key="0" type="number" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">grsets_query.groupingid as groupingid, /*Отчетный период начисления*//*number*/
</column><call function="decode" as="par_groupingid" type="number" title="" pth="" used="1" key="0"><text txtype="func"> decode( </text><column table="grsets_query" column="groupingid" as="groupingid" thissrc="groupingid">grsets_query.groupingid</column><text txtype="func"> , </text><const><text>'31'</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> , </text><const><text>'71'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'593'</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>'853'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'855'</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> , </text><const><text>'862'</text></const><text txtype="func"> , </text><const><text>'863'</text></const><text txtype="func"> ) </text> as par_groupingid/**//*number*/
</call></select><from>
from <query as="grsets_query" path="./fin/p1/grsets_query" used="1">(
<select>--
select <column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><call function="if" as="ndog" c-master="kod_dog" pth="" used="1" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_dog_fin" sourcecolumn="ndog"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1">grpd.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="ndog" group="max" c-master="kod_dog" removeable="1">max(grpd.ndog) </column><text txtype="func"> end </text> as ndog, /*Номер договора*//*string*/
</call><call function="if" as="name" c-master="kod_dog" pth="" used="1" key="0" type="string" title="Отделение" sourcetable="./fin/p1/grsets_query/grpd/grpd/dep" sourcecolumn="name"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1">grpd.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="name" group="max" c-master="kod_dog" removeable="1">max(grpd.name) </column><text txtype="func"> end </text> as name, /*Отделение*//*string*/
</call><call function="if" as="nump" c-master="kod_dog" pth="" used="1" key="0" type="string" title="Код абонента" sourcetable="./fin/p1/grsets_query/grpd/grpd/kodp" sourcecolumn="nump"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1">grpd.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="nump" group="max" c-master="kod_dog" removeable="1">max(grpd.nump) </column><text txtype="func"> end </text> as nump, /*Код абонента*//*string*/
</call><column table="grpd" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" removeable="1" keypath=".ym_vozn" used="1" key="1" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/qube_graf_in_a_d" sourcecolumn="ym_vozn">grpd.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*//*key*/
</column><column table="grpd" column="kod_sf" as="kod_sf" c-master-key="kod_sf" removeable="1" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">grpd.kod_sf as kod_sf, /*number*//*key*/
</column><column table="grpd" column="dat_bzad" as="dat_bzad" group="max" removeable="1" used="1" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf/kod_deb" sourcecolumn="dat_bzad">max(grpd.dat_bzad)  as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><call function="if" as="ym" c-master="kod_sf" pth="" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_sf" as="kod_sf" c-master-key="kod_sf" removeable="1">grpd.kod_sf</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="ym" group="max" c-master="kod_sf" removeable="1">max(grpd.ym) </column><text txtype="func"> end </text> as ym, /*Отчетный период начисления*//*number*/
</call><column table="grpd" column="name_podpis" as="name_podpis" group="max" removeable="1" used="1" key="0" type="string">max(grpd.name_podpis)  as name_podpis, /*string*/
</column><column table="grpd" column="name_plat" as="name_plat" group="max" removeable="1" used="1" key="0" type="string" title="Наименование платежа" agg="max" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/vid_real" sourcecolumn="vid_real">max(grpd.name_plat)  as name_plat, /*Наименование платежа*//*string*/
</column><column table="grpd" column="nach" as="nach" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(grpd.nach)  as nach, /*Начислено*//*number*/
</column><column table="grpd" column="opl_nach" as="opl_nach" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(grpd.opl_nach)  as opl_nach, /*Оплата начислений*//*number*/
</column><column table="grpd" column="opl" as="opl" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum">sum(grpd.opl)  as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="grpd" column="dolg" as="dolg" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(grpd.dolg)  as dolg, /*Оборот*//*number*/
</column><column table="grpd" column="dolg_check" as="dolg_check" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras_a_d" sourcecolumn="nachisl">sum(grpd.dolg_check)  as dolg_check, /*Оборот*//*number*/
</column><column table="grpd" column="dolg_pros" as="dolg_pros" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_sf/kod_deb" sourcecolumn="dat_bzad">sum(grpd.dolg_pros)  as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="grpd" column="dolg_kred_os" as="dolg_kred_os" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">sum(grpd.dolg_kred_os)  as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grpd" column="dolg_kred_av" as="dolg_kred_av" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum">sum(grpd.dolg_kred_av)  as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="grpd" column="dolg_kred" as="dolg_kred" group="sum" removeable="1" used="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum">sum(grpd.dolg_kred)  as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="grpd" column="pr_dog" as="pr_dog" group="max" removeable="1" is-fact-use="1" used="1" key="0" type="number" title=" " agg="max" sourcetable="./fin/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog">max(grpd.pr_dog)  as pr_dog, /* *//*number*/
</column><column table="grpd" column="visitog" as="visitog" used="1" key="0" type="number">grpd.visitog as visitog, /*number*/
</column><column table="grpd" column="visitog_deb" as="visitog_deb" used="1" key="0" type="number">grpd.visitog_deb as visitog_deb, /*number*/
</column><column table="grpd" column="visitog_osn_av" as="visitog_osn_av" used="1" key="0" type="number">grpd.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="grpd" column="visitog_osn" as="visitog_osn" used="1" key="0" type="number">grpd.visitog_osn as visitog_osn, /*number*/
</column><column table="grpd" column="visdet_osn" as="visdet_osn" used="1" key="0" type="number">grpd.visdet_osn as visdet_osn, /*number*/
</column><column table="grpd" column="visdet_av" as="visdet_av" used="1" key="0" type="number">grpd.visdet_av as visdet_av, /*number*/
</column><column table="grpd" column="visdet_othr" as="visdet_othr" used="1" key="0" type="number">grpd.visdet_othr as visdet_othr, /*number*/
</column><call function="grouping_id" as="groupingid" pth="" type="number" used="1" key="0" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin/p1/grsets_query/grpd/grpd/kod_sf" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf"><text txtype="func"> grouping_id( </text><column table="grpd" column="kod_sf">grpd.kod_sf</column><text txtype="func"> , </text><column table="grpd" column="ym_vozn">grpd.ym_vozn</column><text txtype="func"> , </text><column table="grpd" column="kod_dog">grpd.kod_dog</column><text txtype="func"> , </text><column table="grpd" column="visdet_othr">grpd.visdet_othr</column><text txtype="func"> , </text><column table="grpd" column="visitog">grpd.visitog</column><text txtype="func"> , </text><column table="grpd" column="visdet_av">grpd.visdet_av</column><text txtype="func"> , </text><column table="grpd" column="visitog_osn_av">grpd.visitog_osn_av</column><text txtype="func"> , </text><column table="grpd" column="visdet_osn">grpd.visdet_osn</column><text txtype="func"> , </text><column table="grpd" column="visitog_osn">grpd.visitog_osn</column><text txtype="func"> , </text><column table="grpd" column="visitog_deb">grpd.visitog_deb</column><text txtype="func"> ) </text> as groupingid/*Отчетный период начисления*//*number*/
</call></select><from>
from <table name="mat1" as="grpd">mat1
grpd
--\mat1
</table></from><group gset="first">group by grouping sets ((
<column table="grpd" column="kod_sf" as="kod_sf" c-master-key="kod_sf" removeable="1" used="1">grpd.kod_sf, 
</column><column table="grpd" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" removeable="1" used="1">grpd.ym_vozn, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visdet_othr" used="1">grpd.visdet_othr, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="3">(
<column table="grpd" column="kod_sf" as="kod_sf" c-master-key="kod_sf" removeable="1" used="1">grpd.kod_sf, 
</column><column table="grpd" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" removeable="1" used="1">grpd.ym_vozn, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visdet_av" used="1">grpd.visdet_av, 
</column><column table="grpd" column="visitog_osn_av" used="1">grpd.visitog_osn_av, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="4">(
<column table="grpd" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" removeable="1" used="1">grpd.ym_vozn, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visdet_osn" used="1">grpd.visdet_osn, 
</column><column table="grpd" column="visitog_osn" used="1">grpd.visitog_osn, 
</column><column table="grpd" column="visitog_osn_av" used="1">grpd.visitog_osn_av, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="5">(
<column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visitog_osn" used="1">grpd.visitog_osn, 
</column><column table="grpd" column="visitog_osn_av" used="1">grpd.visitog_osn_av, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="6">(
<column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visitog_osn_av" used="1">grpd.visitog_osn_av, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="7">(
<column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visitog_deb" used="1">grpd.visitog_deb, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>),
</group><group gset="last">(
<column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visitog" used="1">grpd.visitog
</column>))
</group><having>having
<call function="and" pth="" type="bool"><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visitog">grpd.visitog</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visitog_deb">grpd.visitog_deb</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visitog_osn_av">grpd.visitog_osn_av</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visitog_osn">grpd.visitog_osn</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visdet_osn">grpd.visdet_osn</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visdet_av">grpd.visdet_av</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visdet_othr">grpd.visdet_othr</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call></call></having>)
grsets_query
--\
</query></from>)
p1
--\
</query></from><order>
order by kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first</order>)
fin
--\36703-fin-dat
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="fin" column="kod_dog">fin.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first</order>) mtr
;
--\36703-fin-dat
</query>
  <query name="36703-avans-info" noname="1" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-avans-info';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_vist_day
n2, --kod_dog
s1, --name
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_vist_day" /><column column="n2" info="kod_dog" /><column column="s1" info="name" /><column column="sparentid" info="sparentid" />--36703-avans-info
</insert><select>--36703-avans-info
select '36703-avans-info' as skod,
'36703-avans-info|#'||mtr.kod_vist_day as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="av_info" column="kod_vist_day" as="kod_vist_day" fixed="1" used="1" key="1" keypath=".kod_vist_day" type="number" sourcetable="./av_info/a" sourcecolumn="kod_vist_day" into="n1">av_info.kod_vist_day as kod_vist_day, /*number*//*key*/
</column><column table="av_info" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./av_info/kod_dog" sourcecolumn="kod_dog" into="n2">av_info.kod_dog as kod_dog, /*number*/
</column><column table="av_info" column="name" as="name" type="string" used="1" key="0" title="Наименование" sourcetable="./av_info/a" sourcecolumn="perc" into="s1">av_info.name as name, /*Наименование*//*string*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-avans-info" as="av_info" path="./av_info" haskeys="1" used="1">(
<select>--36703-avans-info
select <column table="a" column="kod_vist_day" as="kod_vist_day" key="1" fixed="1" used="1" type="number" sourcetable="./av_info/a" sourcecolumn="kod_vist_day">a.kod_vist_day as kod_vist_day, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./av_info/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*/
</column><call function="||" as="name" key="0" pth="" type="string" used="1" title="Наименование" sourcetable="./av_info/a" sourcecolumn="perc"><column table="kod_bzad" column="name" as="name_bzad">kod_bzad.name</column><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><column table="a" column="perc">a.perc</column><text txtype="func"> || </text><const><text>'% '</text></const><text txtype="func"> || </text><call function="lower" pth="" type="string">(<text txtype="func"> lower( </text><column table="vid_avans" column="name">vid_avans.name</column><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><column table="a" column="period">a.period</column> as name/*Наименование*//*string*/
</call></select><from>
from <query name="kr_vist_day" as="a" path="./av_info/a" haskeys="1" used="1">(
<select>--kr_vist_day
select <column table="a" column="kod_vist_day" type="number" as="kod_vist_day" key="1" fixed="1" sourcetable="./av_info/a" sourcecolumn="kod_vist_day" used="1">a.kod_vist_day as kod_vist_day, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./av_info/a" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="perc" type="number" title="" comment=" % или абс.величина" as="perc" key="0" sourcetable="./av_info/a" sourcecolumn="perc" used="1">a.perc as perc, /**//*number*/
</column><column table="a" column="vid_avans" type="number" title="" comment="код выставляемого промежут.платежа или аванса" as="vid_avans" reference="sk_vid_avans" refcol="vid_avans" key="0" sourcetable="./av_info/a" sourcecolumn="vid_avans" used="1">a.vid_avans as vid_avans, /**//*number*/
</column><column table="a" column="period" type="string" title="" as="period" key="0" sourcetable="./av_info/a" sourcecolumn="period" used="1">a.period as period, /**//*string*/
</column><column table="a" column="kod_bzad" type="number" as="kod_bzad" reference="ss_zadol_day" refcol="kod_bzad" key="0" sourcetable="./av_info/a" sourcecolumn="kod_bzad" used="1">a.kod_bzad as kod_bzad/*number*/
</column></select><from>
from <table name="kr_vist_day" as="a" used="1">kr_vist_day
a
--\kr_vist_day
</table></from>)
a
--\kr_vist_day
</query><query name="kr_dogovor" as="kod_dog" join="left outer" path="./av_info/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./av_info/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./av_info/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="sk_vid_avans" as="vid_avans" join="left outer" path="./av_info/vid_avans" haskeys="1" used="1">left outer join
(
<select>--sk_vid_avans
select <column table="a" column="vid_avans" type="number" title="" comment="код аванса" as="vid_avans" key="1" fixed="1" sourcetable="./av_info/vid_avans" sourcecolumn="vid_avans" used="1">a.vid_avans as vid_avans, /**//*number*//*key*/
</column><column table="a" column="name" type="string" title="Наименование" comment="наимен.промеж.платежа или аванса" as="name" key="0" sourcetable="./av_info/vid_avans" sourcecolumn="name" used="1">a.name as name/*Наименование*//*string*/
</column></select><from>
from <table name="sk_vid_avans" as="a" used="1">sk_vid_avans
a
--\sk_vid_avans
</table></from><call function="=" type="bool">)
vid_avans on <column table="a" column="vid_avans">a.vid_avans</column><text txtype="func"> = </text><column table="vid_avans" column="vid_avans">vid_avans.vid_avans</column></call>--\sk_vid_avans
</query><query name="ss_zadol_day" as="kod_bzad" join="left outer" path="./av_info/kod_bzad" haskeys="1" used="1">left outer join
(
<select>--ss_zadol_day
select <column table="a" column="kod_bzad" type="number" as="kod_bzad" key="1" fixed="1" sourcetable="./av_info/kod_bzad" sourcecolumn="kod_bzad" used="1">a.kod_bzad as kod_bzad, /*number*//*key*/
</column><call function="||" as="name" key="0" pth="" type="string" used="1" title="Наименование"><column table="day_type" column="text_before_day">day_type.text_before_day</column><text txtype="func"> || </text><column table="a" column="days_bzad" type="number" title="" as="days_bzad" key="0" thissrc="days_bzad">a.days_bzad</column><text txtype="func"> || </text><column table="day_type" column="text_after_day">day_type.text_after_day</column> as name/*Наименование*//*string*/
</call></select><from>
from <table name="ss_zadol_day" as="a" used="1">ss_zadol_day
a
--\ss_zadol_day
</table><query name="kk_type_zadol" as="day_type" join="left outer" path="./av_info/kod_bzad/day_type" haskeys="1" used="1">left outer join
(
<select>--kk_type_zadol
select <column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" used="1" sourcetable="./av_info/kod_bzad/day_type" sourcecolumn="day_type">a.day_type as day_type, /**//*number*//*key*/
</column><call as="text_before_day" function="case" key="0" pth="" used="1" type="number"><text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="in" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>1</text></const>) </call>) </call><text txtype="func"> then </text><const><text>'до '</text></const></call><text txtype="func"> end </text> as text_before_day, /*number*/
</call><call as="text_after_day" function="case" key="0" pth="" used="1" type="number" title="Наименование"><text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> = </text><const><text>2</text></const>) </call><text txtype="func"> then </text><const><text>' числа текущего месяца'</text></const></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<column table="a" column="day_type" type="number" title="" comment="способ указания дней задолженности" as="day_type" key="1" fixed="1" thissrc="day_type">a.day_type</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> then </text><const><text>' числа следующего месяца'</text></const></call><call function="else" pth="0" type="else"><text txtype="func"> else </text><column table="a" column="name" type="string" title="Наименование" as="name" key="0" thissrc="name">a.name</column></call><text txtype="func"> end </text> as text_after_day/*Наименование*//*number*/
</call></select><from>
from <table name="kk_type_zadol" as="a" used="1">kk_type_zadol
a
--\kk_type_zadol
</table></from><call function="=" type="bool">)
day_type on <column table="a" column="day_type">a.day_type</column><text txtype="func"> = </text><column table="day_type" column="day_type">day_type.day_type</column></call>--\kk_type_zadol
</query></from><call function="=" type="bool">)
kod_bzad on <column table="a" column="kod_bzad">a.kod_bzad</column><text txtype="func"> = </text><column table="kod_bzad" column="kod_bzad">kod_bzad.kod_bzad</column></call>--\ss_zadol_day
</query></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where>)
av_info
--\36703-avans-info
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="av_info" column="kod_dog">av_info.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from>) mtr
;
--\36703-avans-info
</query>
  <query name="36703-dog-lim" noname="1" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-dog-lim';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_dog
s1, --nump
n2, --limit
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_dog" /><column column="s1" info="nump" /><column column="n2" info="limit" /><column column="sparentid" info="sparentid" />--36703-dog-lim
</insert><select>--36703-dog-lim
select '36703-dog-lim' as skod,
'36703-dog-lim|#'||mtr.kod_dog as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="lim" column="kod_dog" as="kod_dog" key="1" keypath=".kod_dog" used="1" type="number" agg="max" sourcetable="./lim/kod_dog" sourcecolumn="kod_dog" into="n1">lim.kod_dog as kod_dog, /*number*//*key*/
</column><column table="lim" column="nump" as="nump" key="0" used="1" type="string" title="Код абонента" sourcetable="./lim/kodp" sourcecolumn="nump" into="s1">lim.nump as nump, /*Код абонента*//*string*/
</column><column table="lim" column="limit" as="limit" is-fact-use="1" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring" into="n2">lim.limit as limit, /*number*/
</column><column table="dog" column="sid" as="sparentid" key="0" used="1" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-dog-lim" as="lim" path="./lim" used="1">(
<select>--36703-dog-lim
select <column table="kod_dog" column="kod_dog" as="kod_dog" key="1" keypath=".kod_dog" used="1" type="number" agg="max" sourcetable="./lim/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kodp" column="nump" as="nump" key="0" used="1" type="string" title="Код абонента" sourcetable="./lim/kodp" sourcecolumn="nump">kodp.nump as nump, /*Код абонента*//*string*/
</column><column column="dr_dogval_lim_y_bring1" as="limit" is-fact-use="1" table="qube" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">qube.dr_dogval_lim_y_bring1 as limit/*number*/
</column></select><from>
from <query haskeys="1" as="qube" path="./lim/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="dr_dogval_lim_y_bring1" is-fact-use="1" as="dr_dogval_lim_y_bring1" group="sum" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">sum(qube.dr_dogval_lim_y_bring1)  as dr_dogval_lim_y_bring1/*number*/
</column></select><from>
from <query as="qube" path="./lim/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" keypath=".kod_dog" key="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="dr_dogval_lim_y_bring1" as="dr_dogval_lim_y_bring1" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">qube.dr_dogval_lim_y_bring1 as dr_dogval_lim_y_bring1/*number*/
</column></select><from>
from <query as="qube" path="./lim/qube/qube/qube" used="1">(
<query path="./lim/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./lim/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" key="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="dr_dogval_lim_y_bring1" as="dr_dogval_lim_y_bring1" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">qube.dr_dogval_lim_y_bring1 as dr_dogval_lim_y_bring1/*number*/
</column></select><from>
from <query as="qube" path="./lim/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="dr_dogval_lim_y_bring1" group="sum" as="dr_dogval_lim_y_bring1" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">sum(un.dr_dogval_lim_y_bring1)  as dr_dogval_lim_y_bring1/*number*/
</column></select><from>
from <query as="un" path="./lim/qube/qube/qube/qube/qube/un" used="1">(
<query path="./lim/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./lim/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="kod_dogval_limit" column="kod_dog" as="kod_dog" key="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">kod_dogval_limit.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dr_dogval_limit_a_d" column="y_bring" as="dr_dogval_lim_y_bring1" key="0" used="1" type="number" agg="sum" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring">dr_dogval_limit_a_d.y_bring as dr_dogval_lim_y_bring1/*number*/
</column></select><from>
from <query name="dr_dogval_limit" as="dr_dogval_limit_a_d" path="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" haskeys="1" used="1">(
<select>--dr_dogval_limit
select <column table="a" column="kod_dogval_limit" type="number" as="kod_dogval_limit" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="kod_dogval_limit" used="1">a.kod_dogval_limit as kod_dogval_limit, /*number*/
</column><column table="a" column="y_bring" type="number" title="" fact="dr_dogval_lim_y_bring" agg="sum" as="y_bring" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d" sourcecolumn="y_bring" used="1">a.y_bring as y_bring, /**//*number*/
</column><call function="num to ym" as="ym" pth="" type="number" key="0" used="1" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/kod_dogval_limit" sourcecolumn="n_year"><column table="kod_dogval_limit" column="n_year">kod_dogval_limit.n_year</column><text txtype="func"> + </text><column table="id_period" column="month">id_period.month</column><text txtype="func"> /100 </text> as ym/*number*/
</call></select><from>
from <table name="dr_dogval_limit" as="a" used="1">dr_dogval_limit
a
--\dr_dogval_limit
</table><query name="ds_period" as="id_period" join="left outer" path="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/id_period" haskeys="1" used="1">left outer join
(
<select>--ds_period
select <column table="a" column="id_period" type="number" title="" as="id_period" key="1" fixed="1" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/id_period" sourcecolumn="id_period" used="1">a.id_period as id_period, /**//*number*//*key*/
</column><column table="a" column="month" type="number" title="" comment="месяц" as="month" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/id_period" sourcecolumn="month" used="1">a.month as month/**//*number*/
</column></select><from>
from <table name="ds_period" as="a" used="1">ds_period
a
--\ds_period
</table></from><call function="=" type="bool">)
id_period on <column table="a" column="id_period">a.id_period</column><text txtype="func"> = </text><column table="id_period" column="id_period">id_period.id_period</column></call>--\ds_period
</query><query name="dr_dogval_limit_tree" dimension="1" as="kod_dogval_limit" join="left outer" path="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/kod_dogval_limit" haskeys="1" used="1">left outer join
(
<select>--dr_dogval_limit_tree
select <column table="a" column="kod_dogval_limit" type="number" as="kod_dogval_limit" key="1" fixed="1" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/kod_dogval_limit" sourcecolumn="kod_dogval_limit" used="1">a.kod_dogval_limit as kod_dogval_limit, /*number*//*key*/
</column><column table="a" column="n_year" type="number" title="" as="n_year" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/dr_dogval_limit_a_d/kod_dogval_limit" sourcecolumn="n_year" used="1">a.n_year as n_year/**//*number*/
</column></select><from>
from <table name="dr_dogval_limit_tree" as="a" dimension="1" used="1">dr_dogval_limit_tree
a
--\dr_dogval_limit_tree
</table></from><call function="=" type="bool">)
kod_dogval_limit on <column table="a" column="kod_dogval_limit">a.kod_dogval_limit</column><text txtype="func"> = </text><column table="kod_dogval_limit" column="kod_dogval_limit">kod_dogval_limit.kod_dogval_limit</column></call>--\dr_dogval_limit_tree
</query></from>)
dr_dogval_limit_a_d
--\dr_dogval_limit
</query><query name="dr_dogval_limit_tree" dimension="kod_dogval_limit" as="kod_dogval_limit" join="left outer" path="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" haskeys="1" used="1">left outer join
(
<select>--dr_dogval_limit_tree
select <column table="a" column="kod_dogval_limit" type="number" as="kod_dogval_limit" key="1" fixed="1" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dogval_limit" used="1">a.kod_dogval_limit as kod_dogval_limit, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="n_year" type="number" title="" as="n_year" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="n_year" used="1">a.n_year as n_year/**//*number*/
</column></select><from>
from <table name="dr_dogval_limit_tree" as="a" dimension="kod_dogval_limit" used="1">dr_dogval_limit_tree
a
--\dr_dogval_limit_tree
</table></from><call function="=" type="bool">)
kod_dogval_limit on <column table="dr_dogval_limit_a_d" column="kod_dogval_limit">dr_dogval_limit_a_d.kod_dogval_limit</column><text txtype="func"> = </text><column table="kod_dogval_limit" column="kod_dogval_limit">kod_dogval_limit.kod_dogval_limit</column></call>--\dr_dogval_limit_tree
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./lim/qube/qube/qube/qube/qube/un/un/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogval_limit" column="kod_dog">kod_dogval_limit.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><qubecontent><where>where
<call function="and" condsource="36703-dog-lim"><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="=">(<column table="kod_dogval_limit" column="n_year">kod_dogval_limit.n_year</column><call function="year">(<const>:dat </const>) </call>) </call><call function="le">(<column table="ym" column="val">ym.val</column><call function="date to ym">(<const>:dat </const>) </call>) </call></call></where></qubecontent></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_dogval_limit" column="n_year">kod_dogval_limit.n_year</column><text txtype="func"> = </text><call function="year" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYY')) </text>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="dr_dogval_limit_a_d" column="ym">dr_dogval_limit_a_d.ym</column><text txtype="func"> &lt;= </text><call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYYMM'))/100 </text>) </call>) </call></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./lim/qube/qube/qube/qube/qube/un/un/kod_dogval_limit" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog/*number*//*key*/
</column></group>)
qube
--\
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./lim/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./lim/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./lim/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./lim/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./lim/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="nump" type="string" title="Код абонента" comment="номер абонента" vid="1" is-name="1" as="nump" key="0" sourcetable="./lim/kodp" sourcecolumn="nump" used="1">a.nump as nump/*Код абонента*//*string*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query></from>)
lim
--\36703-dog-lim
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" key="1" used="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="lim" column="kod_dog">lim.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from>) mtr
;
--\36703-dog-lim
</query>
  <query name="36703-obj" noname="1" order="num_obj_par,num_obj nulls first" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-obj';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_numobj
n2, --kod_dog
n3, --num_obj_par
n4, --num_obj
s1, --name
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_numobj" /><column column="n2" info="kod_dog" /><column column="n3" info="num_obj_par" /><column column="n4" info="num_obj" /><column column="s1" info="name" /><column column="sparentid" info="sparentid" />--36703-obj
</insert><order notext="1"><column column="num_obj_par">num_obj_par</column><column column="num_objnullsfirst">num_objnullsfirst</column></order><select>--36703-obj
select '36703-obj' as skod,
'36703-obj|#'||mtr.kod_numobj as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="obj" column="kod_numobj" as="kod_numobj" fixed="1" used="1" key="1" keypath=".kod_numobj" type="number" agg="max" sourcetable="./obj/a" sourcecolumn="kod_numobj" into="n1">obj.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="obj" column="kod_dog" as="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./obj/kod_dog" sourcecolumn="kod_dog" into="n2">obj.kod_dog as kod_dog, /*number*/
</column><column table="obj" column="num_obj_par" as="num_obj_par" type="number" used="1" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj/kod_parent_sa" sourcecolumn="num_obj" into="n3">obj.num_obj_par as num_obj_par, /*Номер объекта договора*//*number*/
</column><column table="obj" column="num_obj" as="num_obj" type="number" used="1" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj/a" sourcecolumn="num_obj" into="n4">obj.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="obj" column="name" as="name" type="string" used="1" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj/kod_parent_sa" sourcecolumn="num_obj" reference="k_house" refcol="kodd" into="s1">obj.name as name, /*Номер объекта договора*//*string*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-obj" as="obj" path="./obj" order="num_obj_par,num_obj nulls first" haskeys="1" used="1">(
<order notext="1"><column column="num_obj_par">num_obj_par</column><column column="num_objnullsfirst">num_objnullsfirst</column></order><select>--36703-obj
select <column table="a" column="kod_numobj" as="kod_numobj" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./obj/a" sourcecolumn="kod_numobj">a.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./obj/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*/
</column><call function="nvl" type="number" as="num_obj_par" key="0" pth="" used="1" title="Номер объекта договора" agg="list" sourcetable="./obj/kod_parent_sa" sourcecolumn="num_obj"><text txtype="func"> nvl( </text><column table="kod_parent_sa" column="num_obj">kod_parent_sa.num_obj</column><text txtype="func"> , </text><column table="a" column="num_obj">a.num_obj</column><text txtype="func"> ) </text> as num_obj_par, /*Номер объекта договора*//*number*/
</call><call function="decode" type="number" as="num_obj" key="0" pth="" used="1" title="Номер объекта договора" agg="list" sourcetable="./obj/a" sourcecolumn="num_obj"><text txtype="func"> decode( </text><column table="kod_parent_sa" column="num_obj">kod_parent_sa.num_obj</column><text txtype="func"> , </text><const><text>null</text></const><text txtype="func"> , </text><const><text>-1</text></const><text txtype="func"> , </text><column table="a" column="num_obj">a.num_obj</column><text txtype="func"> ) </text> as num_obj, /*Номер объекта договора*//*number*/
</call><call function="||" as="name" key="0" pth="" type="string" used="1" title="Номер объекта договора" agg="list" sourcetable="./obj/kod_parent_sa" sourcecolumn="num_obj" reference="k_house" refcol="kodd"><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="kod_parent_sa" column="num_obj">kod_parent_sa.num_obj</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<column table="kod_parent_sa" column="num_obj">kod_parent_sa.num_obj</column><text txtype="func"> || </text><const><text>'.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><column table="a" column="num_obj">a.num_obj</column><text txtype="func"> || </text><const><text>'.  '</text></const><text txtype="func"> || </text><call function="nk_adress.kf_address" pth="" type="string">(<text txtype="func"> nk_adress.kf_address( </text><const><text>2</text></const><text txtype="func"> , </text><column table="kod_obj" column="kodd">kod_obj.kodd</column><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><column table="a" column="name">a.name</column> as name/*Номер объекта договора*//*string*/
</call></select><from>
from <query name="kr_numobj" as="a" path="./obj/a" haskeys="1" used="1">(
<select>--kr_numobj
select <column table="a" column="kod_numobj" type="number" comment="код объекта в договоре" key-dimension="kod_numobj" fact="kr_numobj_kod_numobj" agg="max" as="kod_numobj" key="1" fixed="1" sourcetable="./obj/a" sourcecolumn="kod_numobj" used="1">a.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="a" column="kod_obj" type="number" as="kod_obj" reference="kr_object" refcol="kod_obj" key="0" sourcetable="./obj/a" sourcecolumn="kod_obj" used="1">a.kod_obj as kod_obj, /*number*/
</column><column table="a" column="pr_active" type="number" title="" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./obj/a" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./obj/a" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_parent_sa" type="number" comment="код объекта договора которому принадлежит субабонет (если он not null, значит объект договора - субабонент )" as="kod_parent_sa" reference="kr_numobj" refcol="kod_numobj" key="0" sourcetable="./obj/a" sourcecolumn="kod_parent_sa" used="1">a.kod_parent_sa as kod_parent_sa, /*number*/
</column><column table="a" column="num_obj" type="number" title="Номер объекта договора" comment="номер объекта в списке объектов договора" is-fact="1" agg="list" as="num_obj" fact="kr_numobj_num_obj" key="0" sourcetable="./obj/a" sourcecolumn="num_obj" used="1">a.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="a" column="name" type="string" title="Наименование объекта договора" comment="наименование объекта в текущем договоре" as="name" key="0" sourcetable="./obj/a" sourcecolumn="name" used="1">a.name as name/*Наименование объекта договора*//*string*/
</column></select><from>
from <table name="kr_numobj" as="a" used="1">kr_numobj
a
--\kr_numobj
</table></from>)
a
--\kr_numobj
</query><query name="kr_numobj" as="kod_parent_sa" join="left outer" path="./obj/kod_parent_sa" haskeys="1" used="1">left outer join
(
<select>--kr_numobj
select <column table="a" column="kod_numobj" type="number" comment="код объекта в договоре" key-dimension="kod_numobj" fact="kr_numobj_kod_numobj" agg="max" as="kod_numobj" key="1" fixed="1" sourcetable="./obj/kod_parent_sa" sourcecolumn="kod_numobj" used="1">a.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="a" column="num_obj" type="number" title="Номер объекта договора" comment="номер объекта в списке объектов договора" is-fact="1" agg="list" as="num_obj" fact="kr_numobj_num_obj" key="0" sourcetable="./obj/kod_parent_sa" sourcecolumn="num_obj" used="1">a.num_obj as num_obj/*Номер объекта договора*//*number*/
</column></select><from>
from <table name="kr_numobj" as="a" used="1">kr_numobj
a
--\kr_numobj
</table></from><call function="=" type="bool">)
kod_parent_sa on <column table="a" column="kod_parent_sa">a.kod_parent_sa</column><text txtype="func"> = </text><column table="kod_parent_sa" column="kod_numobj">kod_parent_sa.kod_numobj</column></call>--\kr_numobj
</query><query name="kr_object" as="kod_obj" join="left outer" path="./obj/kod_obj" haskeys="1" used="1">left outer join
(
<select>--kr_object
select <column table="a" column="kod_obj" type="number" comment="код потребителя" key-dimension="kod_obj" as="kod_obj" key="1" fixed="1" sourcetable="./obj/kod_obj" sourcecolumn="kod_obj" used="1">a.kod_obj as kod_obj, /*number*//*key*/
</column><column table="a" column="kodd" type="number" title="" as="kodd" reference="k_house" refcol="kodd" key="0" sourcetable="./obj/kod_obj" sourcecolumn="kodd" used="1">a.kodd as kodd/**//*number*/
</column></select><from>
from <table name="kr_object" as="a" used="1">kr_object
a
--\kr_object
</table></from><call function="=" type="bool">)
kod_obj on <column table="a" column="kod_obj">a.kod_obj</column><text txtype="func"> = </text><column table="kod_obj" column="kod_obj">kod_obj.kod_obj</column></call>--\kr_object
</query><query name="kr_dogovor" as="kod_dog" join="left outer" path="./obj/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./obj/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./obj/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="a" column="kod_dog">a.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="pr_active">a.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call></call></where><order>
order by num_obj_par,num_obj nulls first</order>)
obj
--\36703-obj
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="obj" column="kod_dog">obj.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by num_obj_par,num_obj nulls first</order>) mtr
;
--\36703-obj
</query>
  <query name="36703-isk" noname="1" order="kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-isk';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
s1, --grsetname
n1, --kod_mat
n2, --kod_dog
n3, --kod_hist_mat_desc
n4, --kod_isp
s2, --num_delo
n5, --vist
s3, --period
s4, --resh_res
d1, --dat_rassm
d2, --dat_post
s5, --prim
s6, --name_st
s7, --num_il
d3, --dat_v_il
d4, --dat_v_silu_il
n6, --prizn_il
d5, --dat_na_isp_il
n7, --tek_dolg
n8, --visisk
n9, --visresh
n10, --visil
n11, --gr_rn
s8, --growid
s9, --parent_growid
n12, --groupingid
s10, --grsetid
s11, --origgrsetid
s12, --parent_grsetid
n13, --par_groupingid
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="s1" info="grsetname" /><column column="n1" info="kod_mat" /><column column="n2" info="kod_dog" /><column column="n3" info="kod_hist_mat_desc" /><column column="n4" info="kod_isp" /><column column="s2" info="num_delo" /><column column="n5" info="vist" /><column column="s3" info="period" /><column column="s4" info="resh_res" /><column column="d1" info="dat_rassm" /><column column="d2" info="dat_post" /><column column="s5" info="prim" /><column column="s6" info="name_st" /><column column="s7" info="num_il" /><column column="d3" info="dat_v_il" /><column column="d4" info="dat_v_silu_il" /><column column="n6" info="prizn_il" /><column column="d5" info="dat_na_isp_il" /><column column="n7" info="tek_dolg" /><column column="n8" info="visisk" /><column column="n9" info="visresh" /><column column="n10" info="visil" /><column column="n11" info="gr_rn" /><column column="s8" info="growid" /><column column="s9" info="parent_growid" /><column column="n12" info="groupingid" /><column column="s10" info="grsetid" /><column column="s11" info="origgrsetid" /><column column="s12" info="parent_grsetid" /><column column="n13" info="par_groupingid" /><column column="sparentid" info="sparentid" />--36703-isk
</insert><with>with
<query hint="materialize" as="mat2" path="./isk/p1/grsets_query/grpd" used="1">mat2 as
(
<select>--
select /*+ materialize*/
<column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1" keypath=".kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat">grpd.kod_mat as kod_mat, /*number*//*key*/
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1" keypath=".kod_hist_mat_desc" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">grpd.kod_hist_mat_desc as kod_hist_mat_desc, /*number*//*key*/
</column><column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1" keypath=".kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp">grpd.kod_isp as kod_isp, /*number*//*key*/
</column><column table="grpd" column="num_delo" as="num_delo" master="kod_mat" c-master="kod_mat" removeable="1" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo">grpd.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="grpd" column="vist" as="vist" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">grpd.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="grpd" column="period" as="period" type="string" used="1" key="0" title="Отчетный период" agg="stragg" format="F2">grpd.period as period, /*Отчетный период*//*string*/
</column><column table="grpd" column="resh_res" as="resh_res" type="string" c-master="kod_hist_mat_desc" used="1" key="0" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name">grpd.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="grpd" column="dat_rassm" as="dat_rassm" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" removeable="1" used="1" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm">grpd.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="grpd" column="dat_post" as="dat_post" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" removeable="1" used="1" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post">grpd.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="grpd" column="prim" as="prim" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" removeable="1" used="1" key="0" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim">grpd.prim as prim, /*Примечание*//*string*/
</column><column table="grpd" column="name_st" as="name_st" removeable="1" used="1" key="0" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name">grpd.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="grpd" column="num_il" as="num_il" master="kod_isp" c-master="kod_isp" removeable="1" used="1" key="0" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg">grpd.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="grpd" column="dat_v_il" as="dat_v_il" master="kod_isp" c-master="kod_isp" removeable="1" used="1" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc">grpd.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="grpd" column="dat_v_silu_il" as="dat_v_silu_il" master="kod_isp" c-master="kod_isp" removeable="1" used="1" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function">grpd.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="grpd" column="prizn_il" as="prizn_il" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">grpd.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="grpd" column="dat_na_isp_il" as="dat_na_isp_il" removeable="1" is-fact-use="1" used="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">grpd.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="grpd" column="tek_dolg" as="tek_dolg" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">grpd.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><call function="if" as="visisk" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>1</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="!=0" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="grpd" column="tek_dolg" as="tek_dolg" removeable="1" key="0" is-fact-use="1" thissrc="tek_dolg">grpd.tek_dolg</column><text txtype="func"> ,0)!=0 </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visisk, /*number*/
</call><call function="if" as="visresh" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>2</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1" key="0" thissrc="kod_hist_mat_desc">grpd.kod_hist_mat_desc</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visresh, /*number*/
</call><call function="if" as="visil" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="is not null" pth="" type="bool">(<const><text>3</text></const><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1" key="0" thissrc="kod_isp">grpd.kod_isp</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> else </text><const><text>0</text></const><text txtype="func"> end </text> as visil/*number*/
</call></select><from>
from <query as="grpd" path="./isk/p1/grsets_query/grpd/grpd" used="1">(
<select>--
select <column table="ur_mat" column="kod_mat" as="kod_mat" removeable="1" c-master-key="kod_mat" keypath=".kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat">ur_mat.kod_mat as kod_mat, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" as="kod_dog" removeable="1" c-master-key="kod_dog" reference="kr_dogovor" refcol="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat_desc" as="kod_hist_mat_desc" removeable="1" c-master-key="kod_hist_mat_desc" keypath=".kod_hist_mat_desc" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat_desc as kod_hist_mat_desc, /*number*//*key*/
</column><column table="ur_isp" column="kod_isp" as="kod_isp" removeable="1" c-master-key="kod_isp" keypath=".kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp">ur_isp.kod_isp as kod_isp, /*number*//*key*/
</column><column table="ur_mat" column="num_delo" as="num_delo" removeable="1" master="kod_mat" c-master="kod_mat" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo">ur_mat.num_delo as num_delo, /*Номер дела*//*string*/
</column><column column="ur_dp_summa1" as="vist" is-fact-use="1" removeable="1" table="qube" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">qube.ur_dp_summa1 as vist, /*Выставленно по юр. документу*//*number*/
</column><call function="vg_period.ym_enum_str_to_date_ranges_str" as="period" pth="" type="string" used="1" key="0" title="Отчетный период" agg="stragg" format="F2"><text txtype="func"> vg_period.ym_enum_str_to_date_ranges_str( </text><column column="ur_dogplat_ym_all1" table="qube" as="ur_dogplat_ym_all1">qube.ur_dogplat_ym_all1</column><text txtype="func"> ) </text> as period, /*Отчетный период*//*string*/
</call><call function="||" as="resh_res" c-master="kod_hist_mat_desc" pth="" type="string" used="1" key="0" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name"><column table="kod_result" column="name" as="result">kod_result.name</column><text txtype="func"> || </text><const><text>''</text></const> as resh_res, /*Результат рассмотрения*//*string*/
</call><column table="kod_hist_mat_dec" column="dat_rassm" as="dat_rassm" removeable="1" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm">kod_hist_mat_dec.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="kod_hist_mat_dec" column="dat_post" as="dat_post" removeable="1" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post">kod_hist_mat_dec.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="kod_hist_mat_dec" column="prim" as="prim" removeable="1" master="kod_hist_mat_desc" c-master="kod_hist_mat_desc" used="1" key="0" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim">kod_hist_mat_dec.prim as prim, /*Примечание*//*string*/
</column><column table="kod_ur_state_pp" column="name" as="name_st" removeable="1" used="1" key="0" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name">kod_ur_state_pp.name as name_st, /*Юр. статус*//*string*/
</column><column table="ur_isp" column="num_reg" as="num_il" removeable="1" master="kod_isp" c-master="kod_isp" used="1" key="0" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg">ur_isp.num_reg as num_il, /*Номер исп. листа*//*string*/
</column><column table="ur_isp" column="dat_doc" as="dat_v_il" removeable="1" master="kod_isp" c-master="kod_isp" used="1" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc">ur_isp.dat_doc as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="ur_isp" column="dat_function" as="dat_v_silu_il" removeable="1" master="kod_isp" c-master="kod_isp" used="1" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function">ur_isp.dat_function as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column column="dolg_on_il1" as="prizn_il" is-fact-use="1" removeable="1" table="qube" used="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">qube.dolg_on_il1 as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column column="ur_isp_pr_min_date1" as="dat_na_isp_il" is-fact-use="1" removeable="1" table="qube" used="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">qube.ur_isp_pr_min_date1 as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column column="fin_ul_ob1" as="tek_dolg" is-fact-use="1" removeable="1" table="qube" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.fin_ul_ob1 as tek_dolg/*Оборот*//*number*/
</column></select><from>
from <query haskeys="1" as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube" used="1">(
<select>--
select <column table="qube" column="kod_mat" group="1" as="kod_mat" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">qube.kod_mat as kod_mat, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec as kod_hist_mat_dec, /*number*//*key*/
</column><column table="qube" column="ur_dp_summa1" is-fact-use="1" as="ur_dp_summa1" group="sum" key="0" used="1" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">sum(qube.ur_dp_summa1)  as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
</column><column table="qube" column="ur_dogplat_ym_all1" as="ur_dogplat_ym_all1" group="stragg" key="0" used="1" type="string" title="Отчетный период" agg="stragg" format="F2">stragg(qube.ur_dogplat_ym_all1)  as ur_dogplat_ym_all1, /*Отчетный период*//*string*/
</column><call function="if" as="dolg_on_il1" title="Задолженность на дату выдачи исп. листа" type="number" key="0" group="sum" pth="" used="1" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> then </text><call function="-nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="ur_dp_sum_v1">qube.ur_dp_sum_v1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><call function="if" as="ur_opl_do_il" title="Оплата по. реш. суда до выдачи исп. листа" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<column table="kod_opl" column="dat_uch">kod_opl.dat_uch</column><text txtype="func"> &lt; </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_isp" column="dat_doc">kod_isp.dat_doc</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call>) </call><text txtype="func"> then </text><call function="+nvl" as="ur_opl_posl_resh" pth="" type="number">(<text txtype="func"> nvl( </text><column table="qube" column="sr_opl_kred_ur1">qube.sr_opl_kred_ur1</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><call function="if" as="ur_opl_deb_posl_resh" title="Оплата после вынес. реш. суда" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="ge" pth="" type="bool">(<column table="kod_opl" column="dat_uch">kod_opl.dat_uch</column><text txtype="func"> &gt;= </text><column table="kod_hist_mat_dec" column="dat_post">kod_hist_mat_dec.dat_post</column>) </call><text txtype="func"> then </text><call function="if" as="ur_opl" title="Оплата по юр. документу" type="number" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="or" pth="1" type="bool">(<call function="=1" pth="1" type="bool">(<text txtype="func"> nvl( </text><column table="kod_dogplat" column="prizn_konv" title="вроде как признак счета сформированного в арбитраже">kod_dogplat.prizn_konv</column><text txtype="func"> ,0)=1 </text>) </call><text txtype="func"> or </text><call function="gt" pth="" type="bool">(<column table="kod_opl" column="dat_uch">kod_opl.dat_uch</column><text txtype="func"> &gt; </text><call function="earliest" pth="" type="date">(<text txtype="func"> nullif(least ( </text><text txtype="func"> nvl( </text><column table="kod_dogplat" column="dat_form">kod_dogplat.dat_form</column><text txtype="func"> , to_date('01.01.9999','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="kod_hist_mat_dec" column="dat_post">kod_hist_mat_dec.dat_post</column><text txtype="func"> , to_date('01.01.9999','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.9999','DD.MM.YYYY')) </text>) </call>) </call>) </call><text txtype="func"> then </text><call function="()" as="fin_ul_fl_opl" pth="">(<column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column>) </call><text txtype="func"> end </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> ,0) </text>) </call><text txtype="func"> end </text>)  as dolg_on_il1, /*Задолженность на дату выдачи исп. листа*//*number*/
</call><call function="earliest" as="ur_isp_pr_min_date1" title="Дата выставления на исполнение" key="0" group="min" pth="" type="date" used="1" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">min(<text txtype="func"> nullif(least ( </text><text txtype="func"> nvl( </text><column table="qube" column="ur_kazn_dat_doc_min1">qube.ur_kazn_dat_doc_min1</column><text txtype="func"> , to_date('01.01.9999','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="qube" column="ur_ink_dat_doc_min1">qube.ur_ink_dat_doc_min1</column><text txtype="func"> , to_date('01.01.9999','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="qube" column="ur_ssp_dat_doc_min1">qube.ur_ssp_dat_doc_min1</column><text txtype="func"> , to_date('01.01.9999','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.9999','DD.MM.YYYY')) </text>)  as ur_isp_pr_min_date1, /*Дата выставления на исполнение*//*date*/
</call><call function="-nvl" as="fin_ul_ob1" title="Оборот" key="0" group="sum" pth="" type="number" used="1" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf2">qube.sr_opl_opl_sf2</column><text txtype="func"> ,0) </text>)  as fin_ul_ob1, /*Оборот*//*number*/
</call><call function="greatest_num" as="kod_ur_state_pp1" type="number" title="Код юр. статуса" key="0" group="max" pth="" used="1" agg="max">max(<text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="qube" column="kod_ur_state_51">qube.kod_ur_state_51</column><text txtype="func"> , -99999999999999999999999999999999999999) </text><text txtype="func"> , nvl( </text><column table="qube" column="kod_ur_state_41">qube.kod_ur_state_41</column><text txtype="func"> , -99999999999999999999999999999999999999) </text><text txtype="func"> , nvl( </text><column table="qube" column="kod_ur_state_31">qube.kod_ur_state_31</column><text txtype="func"> , -99999999999999999999999999999999999999) </text><text txtype="func"> , nvl( </text><column table="qube" column="kod_ur_state_21">qube.kod_ur_state_21</column><text txtype="func"> , -99999999999999999999999999999999999999) </text><text txtype="func"> , nvl( </text><column table="qube" column="kod_ur_state_11">qube.kod_ur_state_11</column><text txtype="func"> , -99999999999999999999999999999999999999) </text><text txtype="func"> ), -99999999999999999999999999999999999999) </text>)  as kod_ur_state_pp1/*Код юр. статуса*//*number*/
</call></select><from>
from <query as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">qube.kod_mat as kod_mat, /*number*/
</column><column table="qube" column="kod_dog" as="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="qube" column="kod_isp" as="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">qube.kod_isp as kod_isp, /*number*/
</column><column table="qube" column="kod_opl" as="kod_opl" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">qube.kod_opl as kod_opl, /*number*/
</column><column table="qube" column="kod_dogplat" as="kod_dogplat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">qube.kod_dogplat as kod_dogplat, /*number*/
</column><column table="qube" column="kod_ur_state_11" as="kod_ur_state_11" used="1" key="0" type="number" agg="max">qube.kod_ur_state_11 as kod_ur_state_11, /*number*/
</column><column table="qube" column="kod_ur_state_21" as="kod_ur_state_21" used="1" key="0" type="number" agg="max">qube.kod_ur_state_21 as kod_ur_state_21, /*number*/
</column><column table="qube" column="kod_ur_state_31" as="kod_ur_state_31" used="1" key="0" type="number" agg="max">qube.kod_ur_state_31 as kod_ur_state_31, /*number*/
</column><column table="qube" column="kod_ur_state_41" as="kod_ur_state_41" used="1" key="0" type="number" agg="max">qube.kod_ur_state_41 as kod_ur_state_41, /*number*/
</column><column table="qube" column="kod_ur_state_51" as="kod_ur_state_51" used="1" key="0" type="number" agg="max">qube.kod_ur_state_51 as kod_ur_state_51, /*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_kred_ur1" as="sr_opl_kred_ur1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">qube.sr_opl_kred_ur1 as sr_opl_kred_ur1, /*Оплата (кредит)*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_opl_sf2" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf2 as sr_opl_opl_sf2, /*Оплата начислений*//*number*/
</column><column table="qube" column="ur_dogplat_ym_all1" as="ur_dogplat_ym_all1" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">qube.ur_dogplat_ym_all1 as ur_dogplat_ym_all1, /*Отчетный период*//*string*/
</column><column table="qube" column="ur_dp_sum_v1" as="ur_dp_sum_v1" used="1" key="0" type="number" title="Признано по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
</column><column table="qube" column="ur_dp_summa1" as="ur_dp_summa1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
</column><column table="qube" column="ur_ink_dat_doc_min1" as="ur_ink_dat_doc_min1" used="1" key="0" type="date" title="Дата документа на инкассо" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="dat_doc">qube.ur_ink_dat_doc_min1 as ur_ink_dat_doc_min1, /*Дата документа на инкассо*//*date*/
</column><column table="qube" column="ur_kazn_dat_doc_min1" as="ur_kazn_dat_doc_min1" used="1" key="0" type="date" title="Дата документа в казначействе" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">qube.ur_kazn_dat_doc_min1 as ur_kazn_dat_doc_min1, /*Дата документа в казначействе*//*date*/
</column><column table="qube" column="ur_ssp_dat_doc_min1" as="ur_ssp_dat_doc_min1" used="1" key="0" type="date" title="Дата подачи в суд" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="dat_doc">qube.ur_ssp_dat_doc_min1 as ur_ssp_dat_doc_min1/*Дата подачи в суд*//*date*/
</column></select><from>
from <query as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube" used="1">(
<query path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><const as="kod_dogplat" used="1" key="0"><text>null</text> as kod_dogplat, 
</const><column table="qube" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><const as="kod_isp" used="1" key="0"><text>null</text> as kod_isp, 
</const><column table="qube" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">qube.kod_mat as kod_mat, /*number*/
</column><const as="kod_opl" used="1" key="0"><text>null</text> as kod_opl, 
</const><column table="qube" column="kod_ur_state_11" as="kod_ur_state_11" used="1" key="0" type="number" agg="max">qube.kod_ur_state_11 as kod_ur_state_11, /*number*/
</column><column table="qube" column="kod_ur_state_21" as="kod_ur_state_21" used="1" key="0" type="number" agg="max">qube.kod_ur_state_21 as kod_ur_state_21, /*number*/
</column><column table="qube" column="kod_ur_state_31" as="kod_ur_state_31" used="1" key="0" type="number" agg="max">qube.kod_ur_state_31 as kod_ur_state_31, /*number*/
</column><column table="qube" column="kod_ur_state_41" as="kod_ur_state_41" used="1" key="0" type="number" agg="max">qube.kod_ur_state_41 as kod_ur_state_41, /*number*/
</column><column table="qube" column="kod_ur_state_51" as="kod_ur_state_51" used="1" key="0" type="number" agg="max">qube.kod_ur_state_51 as kod_ur_state_51, /*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_kred_ur1" used="1" key="0"><text>null</text> as sr_opl_kred_ur1, /*number*/
</const><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2, /*number*/
</const><column table="qube" column="ur_dogplat_ym_all1" as="ur_dogplat_ym_all1" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">qube.ur_dogplat_ym_all1 as ur_dogplat_ym_all1, /*Отчетный период*//*string*/
</column><column table="qube" column="ur_dp_sum_v1" as="ur_dp_sum_v1" used="1" key="0" type="number" title="Признано по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">qube.ur_dp_sum_v1 as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
</column><column table="qube" column="ur_dp_summa1" as="ur_dp_summa1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">qube.ur_dp_summa1 as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
</column><column table="qube" column="ur_ink_dat_doc_min1" as="ur_ink_dat_doc_min1" used="1" key="0" type="date" title="Дата документа на инкассо" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="dat_doc">qube.ur_ink_dat_doc_min1 as ur_ink_dat_doc_min1, /*Дата документа на инкассо*//*date*/
</column><column table="qube" column="ur_kazn_dat_doc_min1" as="ur_kazn_dat_doc_min1" used="1" key="0" type="date" title="Дата документа в казначействе" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">qube.ur_kazn_dat_doc_min1 as ur_kazn_dat_doc_min1, /*Дата документа в казначействе*//*date*/
</column><column table="qube" column="ur_ssp_dat_doc_min1" as="ur_ssp_dat_doc_min1" used="1" key="0" type="date" title="Дата подачи в суд" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="dat_doc">qube.ur_ssp_dat_doc_min1 as ur_ssp_dat_doc_min1/*Дата подачи в суд*//*date*/
</column></select><from>
from <query as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec as kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">un.kod_mat as kod_mat, /*number*//*key*/
</column><column table="un" column="sr_facras_nachisl1" group="sum" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(un.sr_facras_nachisl1)  as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="un" column="ur_dogplat_ym_all1" group="stragg" as="ur_dogplat_ym_all1" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">stragg(un.ur_dogplat_ym_all1)  as ur_dogplat_ym_all1, /*Отчетный период*//*string*/
</column><column table="un" column="ur_dp_sum_v1" group="sum" as="ur_dp_sum_v1" used="1" key="0" type="number" title="Признано по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">sum(un.ur_dp_sum_v1)  as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
</column><column table="un" column="ur_dp_summa1" group="sum" as="ur_dp_summa1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">sum(un.ur_dp_summa1)  as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
</column><column table="un" column="kod_ur_state_21" group="max" as="kod_ur_state_21" used="1" key="0" type="number" agg="max">max(un.kod_ur_state_21)  as kod_ur_state_21, /*number*/
</column><column table="un" column="kod_ur_state_41" group="max" as="kod_ur_state_41" used="1" key="0" type="number" agg="max">max(un.kod_ur_state_41)  as kod_ur_state_41, /*number*/
</column><column table="un" column="ur_ink_dat_doc_min1" group="min" as="ur_ink_dat_doc_min1" used="1" key="0" type="date" title="Дата документа на инкассо" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="dat_doc">min(un.ur_ink_dat_doc_min1)  as ur_ink_dat_doc_min1, /*Дата документа на инкассо*//*date*/
</column><column table="un" column="kod_ur_state_51" group="max" as="kod_ur_state_51" used="1" key="0" type="number" agg="max">max(un.kod_ur_state_51)  as kod_ur_state_51, /*number*/
</column><column table="un" column="ur_kazn_dat_doc_min1" group="min" as="ur_kazn_dat_doc_min1" used="1" key="0" type="date" title="Дата документа в казначействе" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">min(un.ur_kazn_dat_doc_min1)  as ur_kazn_dat_doc_min1, /*Дата документа в казначействе*//*date*/
</column><column table="un" column="kod_ur_state_31" group="max" as="kod_ur_state_31" used="1" key="0" type="number" agg="max">max(un.kod_ur_state_31)  as kod_ur_state_31, /*number*/
</column><column table="un" column="ur_ssp_dat_doc_min1" group="min" as="ur_ssp_dat_doc_min1" used="1" key="0" type="date" title="Дата подачи в суд" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="dat_doc">min(un.ur_ssp_dat_doc_min1)  as ur_ssp_dat_doc_min1, /*Дата подачи в суд*//*date*/
</column><column table="un" column="kod_ur_state_11" group="max" as="kod_ur_state_11" used="1" key="0" type="number" agg="max">max(un.kod_ur_state_11)  as kod_ur_state_11/*number*/
</column></select><from>
from <query as="un" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><column table="sr_facras" column="nachisl" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sr_facras.nachisl as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" haskeys="1" used="1">(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where>)
sr_facras_a_d
--\sr_facras
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_a_d on <column table="sr_facras_a_d" column="kod_sf">sr_facras_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_mat" as="kod_mat1_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
kod_mat1_a_d1 on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp_a_d on <column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf_a_d" column="kod_dog">kod_sf_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras, /*number*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facras" dimension="kod_ras" as="sr_facras" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" haskeys="1" used="1">left outer join
(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl" used="1">a.nachisl as nachisl/*Начислено*//*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
sr_facras on <column table="sr_facras" column="kod_ras">sr_facras.kod_ras</column><text txtype="func"> = </text><column table="dims" column="kod_ras_prm">dims.kod_ras_prm</column></call>--\sr_facras
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="ur_dogplat" column="ym_all" as="ur_dogplat_ym_all1" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">ur_dogplat.ym_all as ur_dogplat_ym_all1, /*Отчетный период*//*string*/
</column><column table="ur_dogplat" column="sum_v" as="ur_dp_sum_v1" used="1" key="0" type="number" title="Признано по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">ur_dogplat.sum_v as ur_dp_sum_v1, /*Признано по юр. документу*//*number*/
</column><column table="ur_dogplat" column="summa" as="ur_dp_summa1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">ur_dogplat.summa as ur_dp_summa1, /*Выставленно по юр. документу*//*number*/
</column><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_dogplat_a_d" column="kod_dogplat" as="kod_dogplat_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dogplat">ur_dogplat_a_d.kod_dogplat as kod_dogplat_prm, /*number*//*key*/
</column><column table="ur_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dog">ur_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="ur_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_mat">ur_dogplat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_dogplat" dimension="kod_dogplat" as="ur_dogplat_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" haskeys="1" used="1">(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from>)
ur_dogplat_a_d
--\ur_dogplat
</query><query name="ur_mat" as="kod_mat1_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
kod_mat1_a_d1 on <column table="ur_dogplat_a_d" column="kod_mat">ur_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp_a_d on <column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="ur_dogplat_a_d" column="kod_dog">ur_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="ur_dogplat_a_d" column="kod_mat">ur_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="ur_dogplat_a_d" column="kod_dogplat" as="kod_dogplat_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dogplat">ur_dogplat_a_d.kod_dogplat, /*number*//*key*/
</column><column table="ur_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_dog">ur_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat, /*number*//*key*/
</column><column table="ur_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_dogplat_a_d" sourcecolumn="kod_mat">ur_dogplat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_dogplat" dimension="kod_dogplat" as="ur_dogplat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="summa" type="number" fact="ur_dp_summa" title="Выставленно по юр. документу" agg="sum" column-mandatory="1" editable="is_doc" editable-invert="1" as="summa" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa" used="1">a.summa as summa, /*Выставленно по юр. документу*//*number*/
</column><column table="a" column="sum_v" type="number" fact="ur_dp_sum_v" title="Признано по юр. документу" agg="sum" as="sum_v" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v" used="1">a.sum_v as sum_v, /*Признано по юр. документу*//*number*/
</column><call function="if" as="ym_all" agg="stragg" type="string" format="F2" key="0" pth="" used="1" title="Отчетный период"><text txtype="func"> case </text><text txtype="func"> when </text><call function="not in" pth="" type="bool">(<column table="a" column="vid_real" type="number" title="" column-mandatory="1" editable="is_doc" editable-invert="1" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>7</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call>) </call><text txtype="func"> then </text><column table="a" column="ym" type="number" comment="отчетный период" title="Отчетный период" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> end </text> as ym_all/*Отчетный период*//*string*/
</call></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
ur_dogplat on <column table="ur_dogplat" column="kod_dogplat">ur_dogplat.kod_dogplat</column><text txtype="func"> = </text><column table="dims" column="kod_dogplat_prm">dims.kod_dogplat_prm</column></call>--\ur_dogplat
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><column table="ur_hist_mat_dec" column="kod_ur_state" as="kod_ur_state_21" used="1" key="0" type="number" agg="max">ur_hist_mat_dec.kod_ur_state as kod_ur_state_21, /*number*/
</column><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_prm" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_prm, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">kod_hist_mat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where>)
kod_hist_mat_dec
--\ur_hist_mat_dec
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp_a_d on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_dogplat
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_hist_mat" dimension="kod_hist_mat" as="kod_hist_mat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat_a_d on <column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat_a_d" column="kod_hist_mat">kod_hist_mat_a_d.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_hist_mat_a_d" column="kod_mat">kod_hist_mat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_a_d" sourcecolumn="kod_mat" reference="ur_mat" refcol="kod_mat">kod_hist_mat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="ur_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc, /*number*//*key*/
</column><call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="a" column="dat_entry" type="date" title="Дата вст. реш. в зак. силу" comment="дата вступления решения в законную силу,  Емцов - поменял условие валидации по 38755" valid="dat_entry_vld" as="dat_entry" key="0" thissrc="dat_entry">a.dat_entry</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><const><text>2</text></const><text txtype="func"> end </text> as kod_ur_state/*number*/
</call></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
ur_hist_mat_dec on <column table="ur_hist_mat_dec" column="kod_hist_mat">ur_hist_mat_dec.kod_hist_mat</column><text txtype="func"> = </text><column table="dims" column="kod_hist_mat_prm">dims.kod_hist_mat_prm</column></call>--\ur_hist_mat_dec
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><column table="ur_inkasso" column="kod_ur_state" as="kod_ur_state_41" used="1" key="0" type="number" agg="max">ur_inkasso.kod_ur_state as kod_ur_state_41, /*number*/
</column><column table="ur_inkasso" column="dat_doc_min" as="ur_ink_dat_doc_min1" used="1" key="0" type="date" title="Дата документа на инкассо" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="dat_doc">ur_inkasso.dat_doc_min as ur_ink_dat_doc_min1, /*Дата документа на инкассо*//*date*/
</column><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_inkasso_a_d" column="kod_inkasso" as="kod_inkasso_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_inkasso">ur_inkasso_a_d.kod_inkasso as kod_inkasso_prm, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_inkasso" dimension="kod_inkasso" as="ur_inkasso_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" haskeys="1" used="1">(
<select>--ur_inkasso
select <column table="a" column="kod_inkasso" type="number" key-dimension="kod_inkasso" is-fact="1" agg="max" as="kod_inkasso" fact="ur_inkasso_kod_inkasso" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_inkasso" used="1">a.kod_inkasso as kod_inkasso, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders/*number*/
</column></select><from>
from <table name="ur_inkasso" as="a" dimension="kod_inkasso" used="1">ur_inkasso
a
--\ur_inkasso
</table></from>)
ur_inkasso_a_d
--\ur_inkasso
</query><query name="ur_dp_inkasso" dimension="kod_dp_inkasso" as="kod_dp_inkasso_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_inkasso
select <column column="kod_dp_inkasso" table="a" type="number" as="kod_dp_inkasso" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_dp_inkasso" used="1">a.kod_dp_inkasso as kod_dp_inkasso, /*number*//*key*/
</column><column table="a" column="kod_inkasso" type="number" as="kod_inkasso" reference="ur_inkasso" refcol="kod_inkasso" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_inkasso" used="1">a.kod_inkasso as kod_inkasso, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_inkasso_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_inkasso" as="a" table-code="1885" dimension="kod_dp_inkasso" used="1">ur_dp_inkasso
a
--\ur_dp_inkasso
</table></from><call function="=" type="bool">)
kod_dp_inkasso_a_d on <column table="kod_dp_inkasso_a_d" column="kod_inkasso">kod_dp_inkasso_a_d.kod_inkasso</column><text txtype="func"> = </text><column table="ur_inkasso_a_d" column="kod_inkasso">ur_inkasso_a_d.kod_inkasso</column></call>--\ur_dp_inkasso
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dp_inkasso_a_d" column="kod_dogplat">kod_dp_inkasso_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dogplat
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="ur_folders_isp" dimension="kod_folders_isp" as="kod_folders_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_folders_isp
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_isp" type="number" valid="qube.ur_fld_isp_kod_isp_vld" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders_isp" key="1" fixed="1" thissrc="kod_folders" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders_isp/*number*//*key*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders_isp" used="1">ur_folders
a
--\ur_folders
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" thissrc="kod_sdp">a.kod_sdp</column><text txtype="func"> = </text><const><text>2</text></const></call></where><call function="=" type="bool">)
kod_folders_isp_a_d on <column table="ur_inkasso_a_d" column="kod_folders">ur_inkasso_a_d.kod_folders</column><text txtype="func"> = </text><column table="kod_folders_isp_a_d" column="kod_folders">kod_folders_isp_a_d.kod_folders</column></call>--\ur_folders_isp
</query><query name="ur_isp" dimension="kod_isp" as="kod_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp_a_d on <column table="kod_folders_isp_a_d" column="kod_isp">kod_folders_isp_a_d.kod_isp</column><text txtype="func"> = </text><column table="kod_isp_a_d" column="kod_isp">kod_isp_a_d.kod_isp</column></call>--\ur_isp
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="ur_inkasso_a_d" column="kod_inkasso" as="kod_inkasso_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_inkasso_a_d" sourcecolumn="kod_inkasso">ur_inkasso_a_d.kod_inkasso, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_inkasso" dimension="kod_inkasso" as="ur_inkasso" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" haskeys="1" used="1">left outer join
(
<select>--ur_inkasso
select <column table="a" column="kod_inkasso" type="number" key-dimension="kod_inkasso" is-fact="1" agg="max" as="kod_inkasso" fact="ur_inkasso_kod_inkasso" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="kod_inkasso" used="1">a.kod_inkasso as kod_inkasso, /*number*//*key*/
</column><call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="a" column="dat_doc" type="date" title="Дата документа на инкассо" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc" key="0" thissrc="dat_doc">a.dat_doc</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><const><text>4</text></const><text txtype="func"> end </text> as kod_ur_state, /*number*/
</call><column table="a" column="dat_doc" type="date" title="Дата документа на инкассо" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc_min" key="0" thissrc="dat_doc" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_inkasso" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc_min/*Дата документа на инкассо*//*date*/
</column></select><from>
from <table name="ur_inkasso" as="a" dimension="kod_inkasso" used="1">ur_inkasso
a
--\ur_inkasso
</table></from><call function="=" type="bool">)
ur_inkasso on <column table="ur_inkasso" column="kod_inkasso">ur_inkasso.kod_inkasso</column><text txtype="func"> = </text><column table="dims" column="kod_inkasso_prm">dims.kod_inkasso_prm</column></call>--\ur_inkasso
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><column table="ur_kazn" column="kod_ur_state" as="kod_ur_state_51" used="1" key="0" type="number" agg="max">ur_kazn.kod_ur_state as kod_ur_state_51, /*number*/
</column><column table="ur_kazn" column="dat_doc_min" as="ur_kazn_dat_doc_min1" used="1" key="0" type="date" title="Дата документа в казначействе" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">ur_kazn.dat_doc_min as ur_kazn_dat_doc_min1, /*Дата документа в казначействе*//*date*/
</column><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_kazn_a_d" column="kod_kazn" as="kod_kazn_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_kazn">ur_kazn_a_d.kod_kazn as kod_kazn_prm, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_kazn" dimension="kod_kazn" as="ur_kazn_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" haskeys="1" used="1">(
<select>--ur_kazn
select <column table="a" column="kod_kazn" type="number" key-dimension="kod_kazn" is-fact="1" agg="max" as="kod_kazn" fact="ur_kazn_kod_kazn" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_kazn" used="1">a.kod_kazn as kod_kazn, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders/*number*/
</column></select><from>
from <table name="ur_kazn" as="a" dimension="kod_kazn" used="1">ur_kazn
a
--\ur_kazn
</table></from>)
ur_kazn_a_d
--\ur_kazn
</query><query name="ur_dp_kazn" dimension="kod_dp_kazn" as="kod_dp_kazn_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_kazn
select <column column="kod_dp_kazn" table="a" type="number" as="kod_dp_kazn" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_dp_kazn" used="1">a.kod_dp_kazn as kod_dp_kazn, /*number*//*key*/
</column><column table="a" column="kod_kazn" type="number" as="kod_kazn" reference="ur_kazn" refcol="kod_kazn" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_kazn" used="1">a.kod_kazn as kod_kazn, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_kazn_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_kazn" as="a" table-code="1886" dimension="kod_dp_kazn" used="1">ur_dp_kazn
a
--\ur_dp_kazn
</table></from><call function="=" type="bool">)
kod_dp_kazn_a_d on <column table="kod_dp_kazn_a_d" column="kod_kazn">kod_dp_kazn_a_d.kod_kazn</column><text txtype="func"> = </text><column table="ur_kazn_a_d" column="kod_kazn">ur_kazn_a_d.kod_kazn</column></call>--\ur_dp_kazn
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dp_kazn_a_d" column="kod_dogplat">kod_dp_kazn_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dogplat
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="ur_folders_isp" dimension="kod_folders_isp" as="kod_folders_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_folders_isp
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_isp" type="number" valid="qube.ur_fld_isp_kod_isp_vld" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders_isp" key="1" fixed="1" thissrc="kod_folders" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders_isp/*number*//*key*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders_isp" used="1">ur_folders
a
--\ur_folders
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" thissrc="kod_sdp">a.kod_sdp</column><text txtype="func"> = </text><const><text>2</text></const></call></where><call function="=" type="bool">)
kod_folders_isp_a_d on <column table="ur_kazn_a_d" column="kod_folders">ur_kazn_a_d.kod_folders</column><text txtype="func"> = </text><column table="kod_folders_isp_a_d" column="kod_folders">kod_folders_isp_a_d.kod_folders</column></call>--\ur_folders_isp
</query><query name="ur_isp" dimension="kod_isp" as="kod_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp_a_d on <column table="kod_folders_isp_a_d" column="kod_isp">kod_folders_isp_a_d.kod_isp</column><text txtype="func"> = </text><column table="kod_isp_a_d" column="kod_isp">kod_isp_a_d.kod_isp</column></call>--\ur_isp
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="ur_kazn_a_d" column="kod_kazn" as="kod_kazn_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_kazn_a_d" sourcecolumn="kod_kazn">ur_kazn_a_d.kod_kazn, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_kazn" dimension="kod_kazn" as="ur_kazn" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" haskeys="1" used="1">left outer join
(
<select>--ur_kazn
select <column table="a" column="kod_kazn" type="number" key-dimension="kod_kazn" is-fact="1" agg="max" as="kod_kazn" fact="ur_kazn_kod_kazn" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="kod_kazn" used="1">a.kod_kazn as kod_kazn, /*number*//*key*/
</column><call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="a" column="dat_doc" type="date" title="Дата документа в казначействе" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc" key="0" thissrc="dat_doc">a.dat_doc</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><const><text>5</text></const><text txtype="func"> end </text> as kod_ur_state, /*number*/
</call><column table="a" column="dat_doc" type="date" title="Дата документа в казначействе" dimension="dat_ur" column-mandatory="1" column-default="today" as="dat_doc_min" key="0" thissrc="dat_doc" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc_min/*Дата документа в казначействе*//*date*/
</column></select><from>
from <table name="ur_kazn" as="a" dimension="kod_kazn" used="1">ur_kazn
a
--\ur_kazn
</table></from><call function="=" type="bool">)
ur_kazn on <column table="ur_kazn" column="kod_kazn">ur_kazn.kod_kazn</column><text txtype="func"> = </text><column table="dims" column="kod_kazn_prm">dims.kod_kazn_prm</column></call>--\ur_kazn
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><column table="ur_mat_isp" column="kod_ur_state" as="kod_ur_state_31" used="1" key="0" type="number" agg="max">ur_mat_isp.kod_ur_state as kod_ur_state_31, /*number*/
</column><column table="ur_mat_isp" column="dat_doc_min" as="ur_ssp_dat_doc_min1" used="1" key="0" type="date" title="Дата подачи в суд" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="dat_doc">ur_mat_isp.dat_doc_min as ur_ssp_dat_doc_min1, /*Дата подачи в суд*//*date*/
</column><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11/*number*/
</const></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_mat_isp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat">ur_mat_isp_a_d.kod_mat as kod_mat_prm, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_mat_isp" dimension="kod_mat_isp" as="ur_mat_isp_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" haskeys="1" used="1">(
<select>--ur_mat_isp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_isp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_isp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_isp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>2</text></const></call></where>)
ur_mat_isp_a_d
--\ur_mat_isp
</query><query name="ur_dp_isp" dimension="kod_dp_isp" as="kod_dp_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_isp
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dp_isp_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_isp" as="a" table-code="1836" dimension="kod_dp_isp" used="1">ur_dp_isp
a
--\ur_dp_isp
</table></from><call function="=" type="bool">)
kod_dp_isp_a_d on <column table="kod_dp_isp_a_d" column="kod_mat">kod_dp_isp_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat_isp_a_d" column="kod_mat">ur_mat_isp_a_d.kod_mat</column></call>--\ur_dp_isp
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dp_isp_a_d" column="kod_dogplat">kod_dp_isp_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dogplat
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="ur_folders_isp" dimension="kod_folders_isp" as="kod_folders_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_folders_isp
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_isp" type="number" valid="qube.ur_fld_isp_kod_isp_vld" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders_isp" key="1" fixed="1" thissrc="kod_folders" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders_isp_a_d" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders_isp/*number*//*key*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders_isp" used="1">ur_folders
a
--\ur_folders
</table></from><where>where
<call function="=" pth="" type="bool"><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" thissrc="kod_sdp">a.kod_sdp</column><text txtype="func"> = </text><const><text>2</text></const></call></where><call function="=" type="bool">)
kod_folders_isp_a_d on <column table="ur_mat_isp_a_d" column="kod_folders">ur_mat_isp_a_d.kod_folders</column><text txtype="func"> = </text><column table="kod_folders_isp_a_d" column="kod_folders_isp">kod_folders_isp_a_d.kod_folders_isp</column></call>--\ur_folders_isp
</query><query name="ur_isp" dimension="kod_isp" as="kod_isp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp_a_d on <column table="kod_folders_isp_a_d" column="kod_isp">kod_folders_isp_a_d.kod_isp</column><text txtype="func"> = </text><column table="kod_isp_a_d" column="kod_isp">kod_isp_a_d.kod_isp</column></call>--\ur_isp
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="ur_mat_isp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_isp_a_d" sourcecolumn="kod_mat">ur_mat_isp_a_d.kod_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_isp_a_d" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp_a_d" sourcecolumn="kod_hist_mat">kod_isp_a_d.kod_hist_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">kod_dogplat_a_d.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_mat_isp" dimension="kod_mat_isp" as="ur_mat_isp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" haskeys="1" used="1">left outer join
(
<select>--ur_mat_isp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_isp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_isp, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc_min" key="0" thissrc="dat_doc" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc_min, /*Дата подачи в суд*//*date*/
</column><call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" thissrc="dat_doc">a.dat_doc</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><const><text>3</text></const><text txtype="func"> end </text> as kod_ur_state/*number*/
</call></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_isp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_isp/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>2</text></const></call></where><call function="=" type="bool">)
ur_mat_isp on <column table="ur_mat_isp" column="kod_mat">ur_mat_isp.kod_mat</column><text txtype="func"> = </text><column table="dims" column="kod_mat_prm">dims.kod_mat_prm</column></call>--\ur_mat_isp
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1, /*date*/
</const><column table="ur_mat_pp" column="kod_ur_state" as="kod_ur_state_11" used="1" key="0" type="number" agg="max">ur_mat_pp.kod_ur_state as kod_ur_state_11/*number*/
</column></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_mat_pp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat">ur_mat_pp_a_d.kod_mat as kod_mat_prm, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="ur_mat_pp_a_d" column="kod_mat" as="kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat">ur_mat_pp_a_d.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <query name="ur_mat_pp" dimension="kod_mat_pp" as="ur_mat_pp_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" haskeys="1" used="1">(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where>)
ur_mat_pp_a_d
--\ur_mat_pp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="ur_mat_pp_a_d" column="kod_mat">ur_mat_pp_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_mat">kod_dogplat_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat_pp_a_d" column="kod_mat">ur_mat_pp_a_d.kod_mat</column></call>--\ur_dogplat
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="ur_mat_pp_a_d" column="kod_mat">ur_mat_pp_a_d.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="ur_mat_pp_a_d" column="kod_mat" as="kod_mat_prm" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat_pp_a_d" sourcecolumn="kod_mat">ur_mat_pp_a_d.kod_mat, /*number*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="ur_mat_pp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp, /*number*//*key*/
</column><call function="if" type="number" as="kod_ur_state" agg="max" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is not null" pth="" type="bool">(<column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" thissrc="dat_doc">a.dat_doc</column><text txtype="func"> is not null </text>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> end </text> as kod_ur_state/*number*/
</call></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_mat_pp/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
ur_mat_pp on <column table="ur_mat_pp" column="kod_mat">ur_mat_pp.kod_mat</column><text txtype="func"> = </text><column table="dims" column="kod_mat_prm">dims.kod_mat_prm</column></call>--\ur_mat_pp
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">un.kod_mat/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query><query as="qube" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">union all
(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><const as="kod_dogplat" used="1" key="0"><text>null</text> as kod_dogplat, 
</const><column table="qube" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="qube" column="kod_isp" as="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">qube.kod_isp as kod_isp, /*number*/
</column><column table="qube" column="kod_mat" as="kod_mat" used="1" key="0" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">qube.kod_mat as kod_mat, /*number*/
</column><column table="qube" column="kod_opl" as="kod_opl" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">qube.kod_opl as kod_opl, /*number*/
</column><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="qube" column="sr_opl_kred_ur1" as="sr_opl_kred_ur1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">qube.sr_opl_kred_ur1 as sr_opl_kred_ur1, /*Оплата (кредит)*//*number*/
</column><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><const type="number" as="sr_opl_opl_sf2" used="1" key="0"><text>null</text> as sr_opl_opl_sf2, /*number*/
</const><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1/*date*/
</const></select><from>
from <query as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec as kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_isp" group="1" as="kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">un.kod_isp as kod_isp, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">un.kod_mat as kod_mat, /*number*//*key*/
</column><column table="un" column="kod_opl" group="1" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">un.kod_opl as kod_opl, /*number*//*key*/
</column><column table="un" column="sr_opl_kred_ur1" group="sum" as="sr_opl_kred_ur1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">sum(un.sr_opl_kred_ur1)  as sr_opl_kred_ur1/*Оплата (кредит)*//*number*/
</column></select><from>
from <query as="un" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_isp" as="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">dims.kod_isp as kod_isp, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><column table="dims" column="kod_opl" as="kod_opl" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">dims.kod_opl as kod_opl, /*number*/
</column><column table="sr_opl_kred_ur" column="opl_kred_ur" as="sr_opl_kred_ur1" used="1" key="0" type="number" title="Оплата (кредит)" agg="sum">sr_opl_kred_ur.opl_kred_ur as sr_opl_kred_ur1/*Оплата (кредит)*//*number*/
</column></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_kred_ur_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">sr_opl_kred_ur_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="kod_opl" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">kod_opl.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_isp" column="kod_isp" as="kod_isp" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">kod_isp.kod_isp as kod_isp, /*number*//*key*/
</column><column table="ur_mat" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">ur_mat.kod_mat as kod_mat, /*number*//*key*/
</column><column table="sr_opl_kred_ur_a_d" column="kod_opl" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">sr_opl_kred_ur_a_d.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <query name="sr_opl_kred_ur" dimension="kod_opl_kred_ur" as="sr_opl_kred_ur_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" haskeys="1" used="1">(
<select>--sr_opl_kred_ur
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_link" type="number" as="kod_link" reference="sr_opl_bank" refcol="kod_link" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_link" used="1">a.kod_link as kod_link/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_kred_ur" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_opl_bank" dimension="1" as="kod_link" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d/kod_link" haskeys="1" used="1">left outer join
(
<select>--sr_opl_bank
select <column table="a" column="kod_link" type="number" as="kod_link" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d/kod_link" sourcecolumn="kod_link" used="1">a.kod_link as kod_link, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" comment="связь с иском (переплаты по гп, владивосток)" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d/kod_link" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="sr_opl_bank" as="a" dimension="1" used="1">sr_opl_bank
a
--\sr_opl_bank
</table></from><call function="=" type="bool">)
kod_link on <column table="a" column="kod_link">a.kod_link</column><text txtype="func"> = </text><column table="kod_link" column="kod_link">kod_link.kod_link</column></call>--\sr_opl_bank
</query></from><where>where
<call function="and" pth="" type="bool"><call function="in" pth="" type="bool">(<column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>5</text></const><text txtype="func"> , </text><const><text>6</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_link" column="kod_mat">kod_link.kod_mat</column><text txtype="func"> is not null </text>) </call></call></where>)
sr_opl_kred_ur_a_d
--\sr_opl_kred_ur
</query><query name="sr_opl_bank" as="kod_link1_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_link1_a_d1" haskeys="1" used="1">left outer join
(
<select>--sr_opl_bank
select <column table="a" column="kod_link" type="number" as="kod_link" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_link1_a_d1" sourcecolumn="kod_link" used="1">a.kod_link as kod_link, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" comment="связь с иском (переплаты по гп, владивосток)" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_link1_a_d1" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="sr_opl_bank" as="a" used="1">sr_opl_bank
a
--\sr_opl_bank
</table></from><call function="=" type="bool">)
kod_link1_a_d1 on <column table="sr_opl_kred_ur_a_d" column="kod_link">sr_opl_kred_ur_a_d.kod_link</column><text txtype="func"> = </text><column table="kod_link1_a_d1" column="kod_link">kod_link1_a_d1.kod_link</column></call>--\sr_opl_bank
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp_a_d on <column table="kod_link1_a_d1" column="kod_mat">kod_link1_a_d1.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query><query name="ur_isp" dimension="kod_isp" as="kod_isp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="kod_isp" column="kod_hist_mat">kod_isp.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column></call>--\ur_isp
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_link1_a_d1" column="kod_mat">kod_link1_a_d1.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl on <column table="sr_opl_kred_ur_a_d" column="kod_opl">sr_opl_kred_ur_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column></call>--\sr_opl
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_opl" column="kod_dog">kod_opl.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="sr_opl_kred_ur_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">sr_opl_kred_ur_a_d.kod_opl, /*number*//*key*/
</column><column table="kod_opl" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">kod_opl.kod_dog, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat, /*number*//*key*/
</column><column table="kod_isp" column="kod_isp" as="kod_isp" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">kod_isp.kod_isp, /*number*//*key*/
</column><column table="ur_mat" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">ur_mat.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_kred_ur" dimension="kod_opl_kred_ur" as="sr_opl_kred_ur" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_ur" haskeys="1" used="1">left outer join
(
<select>--sr_opl_kred_ur
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_ur" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_kred_ur" agg="sum" title="Оплата (кредит)" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_kred_ur/*Оплата (кредит)*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_kred_ur" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_opl_bank" dimension="1" as="kod_link" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_ur/kod_link" haskeys="1" used="1">left outer join
(
<select>--sr_opl_bank
select <column table="a" column="kod_link" type="number" as="kod_link" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_ur/kod_link" sourcecolumn="kod_link" used="1">a.kod_link as kod_link, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" comment="связь с иском (переплаты по гп, владивосток)" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_kred_ur/kod_link" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="sr_opl_bank" as="a" dimension="1" used="1">sr_opl_bank
a
--\sr_opl_bank
</table></from><call function="=" type="bool">)
kod_link on <column table="a" column="kod_link">a.kod_link</column><text txtype="func"> = </text><column table="kod_link" column="kod_link">kod_link.kod_link</column></call>--\sr_opl_bank
</query></from><where>where
<call function="and" pth="" type="bool"><call function="in" pth="" type="bool">(<column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>5</text></const><text txtype="func"> , </text><const><text>6</text></const>) </call>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_link" column="kod_mat">kod_link.kod_mat</column><text txtype="func"> is not null </text>) </call></call></where><call function="=" type="bool">)
sr_opl_kred_ur on <column table="sr_opl_kred_ur" column="kod_opl">sr_opl_kred_ur.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_kred_ur
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_isp" group="1" as="kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">un.kod_isp, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat">un.kod_mat, /*number*//*key*/
</column><column table="un" column="kod_opl" group="1" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_kred_ur_a_d" sourcecolumn="kod_opl">un.kod_opl/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query><query as="qube" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube" used="1">union all
(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_dogplat" as="kod_dogplat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">qube.kod_dogplat as kod_dogplat, /*number*/
</column><column table="qube" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="qube" column="kod_isp" as="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">qube.kod_isp as kod_isp, /*number*/
</column><column table="qube" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">qube.kod_mat as kod_mat, /*number*/
</column><column table="qube" column="kod_opl" as="kod_opl" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">qube.kod_opl as kod_opl, /*number*/
</column><const type="number" as="kod_ur_state_11" used="1" key="0"><text>null</text> as kod_ur_state_11, /*number*/
</const><const type="number" as="kod_ur_state_21" used="1" key="0"><text>null</text> as kod_ur_state_21, /*number*/
</const><const type="number" as="kod_ur_state_31" used="1" key="0"><text>null</text> as kod_ur_state_31, /*number*/
</const><const type="number" as="kod_ur_state_41" used="1" key="0"><text>null</text> as kod_ur_state_41, /*number*/
</const><const type="number" as="kod_ur_state_51" used="1" key="0"><text>null</text> as kod_ur_state_51, /*number*/
</const><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><const type="number" as="sr_opl_kred_ur1" used="1" key="0"><text>null</text> as sr_opl_kred_ur1, /*number*/
</const><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="sr_opl_opl_sf2" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf2 as sr_opl_opl_sf2, /*Оплата начислений*//*number*/
</column><const type="string" as="ur_dogplat_ym_all1" used="1" key="0"><text>null</text> as ur_dogplat_ym_all1, /*string*/
</const><const type="number" as="ur_dp_sum_v1" used="1" key="0"><text>null</text> as ur_dp_sum_v1, /*number*/
</const><const type="number" as="ur_dp_summa1" used="1" key="0"><text>null</text> as ur_dp_summa1, /*number*/
</const><const type="date" as="ur_ink_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ink_dat_doc_min1, /*date*/
</const><const type="date" as="ur_kazn_dat_doc_min1" used="1" key="0"><text>null</text> as ur_kazn_dat_doc_min1, /*date*/
</const><const type="date" as="ur_ssp_dat_doc_min1" used="1" key="0"><text>null</text> as ur_ssp_dat_doc_min1/*date*/
</const></select><from>
from <query as="qube" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_dogplat" group="1" as="kod_dogplat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">un.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec as kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_isp" group="1" as="kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">un.kod_isp as kod_isp, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">un.kod_mat as kod_mat, /*number*//*key*/
</column><column table="un" column="kod_opl" group="1" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">un.kod_opl as kod_opl, /*number*//*key*/
</column><column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf1)  as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="un" column="sr_opl_opl_sf2" group="sum" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf2)  as sr_opl_opl_sf2/*Оплата начислений*//*number*/
</column></select><from>
from <query as="un" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_dog" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dims" column="kod_dogplat" as="kod_dogplat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">dims.kod_dogplat as kod_dogplat, /*number*/
</column><column table="dims" column="kod_hist_mat_dec" as="kod_hist_mat_dec" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">dims.kod_hist_mat_dec as kod_hist_mat_dec, /*number*/
</column><column table="dims" column="kod_isp" as="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">dims.kod_isp as kod_isp, /*number*/
</column><column table="dims" column="kod_mat" as="kod_mat" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">dims.kod_mat as kod_mat, /*number*/
</column><column table="dims" column="kod_opl" as="kod_opl" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">dims.kod_opl as kod_opl, /*number*/
</column><column table="sr_opl_sf" column="opl_sf" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sr_opl_sf.opl_sf as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="sr_opl_sf" column="opl_sf" as="sr_opl_opl_sf2" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sr_opl_sf.opl_sf as sr_opl_opl_sf2/*Оплата начислений*//*number*/
</column></select><from>
from <query as="dims" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dogplat" column="kod_dogplat" as="kod_dogplat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">kod_dogplat.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat as kod_hist_mat_dec, /*number*//*key*/
</column><column table="kod_isp" column="kod_isp" as="kod_isp" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">kod_isp.kod_isp as kod_isp, /*number*//*key*/
</column><column table="kod_dogplat" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">kod_dogplat.kod_mat as kod_mat, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl as kod_opl/*number*//*key*/
</column></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_a_d on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" as="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat on <column table="kod_dogplat" column="kod_deb_sf">kod_dogplat.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_mat" as="kod_mat1_a_d1" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat1_a_d1" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
kod_mat1_a_d1 on <column table="kod_dogplat" column="kod_mat">kod_dogplat.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat
</query><query name="ur_mat_pp" dimension="kod_mat_pp" as="kod_mat_pp_a_d" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_mat_pp
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat_pp" key="1" fixed="1" thissrc="kod_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat_pp/*number*//*key*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat_pp" used="1">ur_mat
a
--\ur_mat
</table><query name="ur_folders" dimension="kod_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_mat_pp_a_d/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp/*number*/
</column></select><from>
from <table name="ur_folders" as="a" title="Папка" dimension="kod_folders" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="a" column="kod_folders">a.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_mat_pp_a_d on <column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column><text txtype="func"> = </text><column table="kod_mat1_a_d1" column="kod_mat">kod_mat1_a_d1.kod_mat</column></call>--\ur_mat_pp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_mat">kod_hist_mat_dec.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_pp_a_d" column="kod_mat">kod_mat_pp_a_d.kod_mat</column></call>--\ur_hist_mat_dec
</query><query name="ur_isp" dimension="kod_isp" as="kod_isp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="kod_isp" column="kod_hist_mat">kod_isp.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column></call>--\ur_isp
</query><query name="ur_mat" dimension="kod_mat" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="kod_folders" type="number" as="kod_folders" reference="ur_folders" refcol="kod_folders" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="a" column="dat_prin" type="date" title="Дата принятия документов в суде" mandatory="qube.ur_hist_mat_count" as="dat_prin" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_prin" used="1">a.dat_prin as dat_prin, /*Дата принятия документов в суде*//*date*/
</column><column table="a" column="dat_doc" type="date" title="Дата подачи в суд" mandatory="dat_otz" fact="ur_mat_dat_doc_max" agg="max" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/ur_mat" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата подачи в суд*//*date*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="kod_dogplat" column="kod_mat">kod_dogplat.kod_mat</column><text txtype="func"> = </text><column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column></call>--\ur_mat
</query><query name="ur_folders" as="kod_folders" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" haskeys="1" used="1">left outer join
(
<select>--ur_folders
select <column table="a" column="kod_folders" type="number" fact="count_ur_folders" agg="count" as="kod_folders" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_folders" used="1">a.kod_folders as kod_folders, /*number*//*key*/
</column><column table="a" column="kod_vi" type="number" as="kod_vi" reference="uk_vi" refcol="kod_vi" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_vi" used="1">a.kod_vi as kod_vi, /*number*/
</column><column table="a" column="kod_sdp" type="number" as="kod_sdp" reference="uk_sdp" refcol="kod_sdp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_folders" sourcecolumn="kod_sdp" used="1">a.kod_sdp as kod_sdp, /*number*/
</column><call function="true if null" as="is_active" title="Статус папки" key="0" pth="" type="number" used="1"><text txtype="func"> decode ( </text><column table="a" column="dat_finish" type="date" title="Дата сброса папки в архив" comment="дата сброса папки в архив" visible="is_not_new" as="dat_finish" key="0" thissrc="dat_finish">a.dat_finish</column><text txtype="func"> ,null,1,0) </text> as is_active/*Статус папки*//*number*/
</call></select><from>
from <table name="ur_folders" as="a" title="Папка" used="1">ur_folders
a
--\ur_folders
</table></from><call function="=" type="bool">)
kod_folders on <column table="ur_mat" column="kod_folders">ur_mat.kod_folders</column><text txtype="func"> = </text><column table="kod_folders" column="kod_folders">kod_folders.kod_folders</column></call>--\ur_folders
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" comment="состояние договора&#xA;0 - действующий&#xA;1- удаленный&#xA;2-новый" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf_a_d" column="kod_dog">kod_sf_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query></from><where>where
<call function="and" pth="" type="bool"><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column><text txtype="func"> is not null </text>) </call><text txtype="func"> and </text><call function="is not null" pth="" type="bool">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column><text txtype="func"> is not null </text>) </call></call></where><group> group by
<column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl, /*number*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_dogplat" column="kod_dogplat" as="kod_dogplat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">kod_dogplat.kod_dogplat, /*number*//*key*/
</column><column table="kod_hist_mat_dec" column="kod_hist_mat" as="kod_hist_mat_dec" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat, /*number*//*key*/
</column><column table="kod_isp" column="kod_isp" as="kod_isp" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">kod_isp.kod_isp, /*number*//*key*/
</column><column table="kod_dogplat" column="kod_mat" as="kod_mat" group="1" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">kod_dogplat.kod_mat/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_opl_sf" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf/*Оплата начислений*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
sr_opl_sf on <column table="sr_opl_sf" column="kod_opl">sr_opl_sf.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_sf
</query><qubecontent><where>where
<call function="and" condsource="grpd"><call function="is not null">(<column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column>) </call><call function="is not null">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column>) </call><call function="=">(<column table="kod_folders" column="kod_sdp">kod_folders.kod_sdp</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="kod_vi">kod_folders.kod_vi</column><const>1</const>) </call><call function="=">(<column table="kod_folders" column="is_active">kod_folders.is_active</column><const>1</const>) </call><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="!=">(<column table="kod_dog" column="pr_active">kod_dog.pr_active</column><const>1</const>) </call><call function="is not null">(<column table="ur_mat" column="num_delo">ur_mat.num_delo</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_prin">ur_mat.dat_prin</column>) </call><call function="is not null">(<column table="ur_mat" column="dat_doc">ur_mat.dat_doc</column>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_dog" group="1" as="kod_dog" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_dogplat" group="1" as="kod_dogplat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_dogplat">un.kod_dogplat, /*number*//*key*/
</column><column table="un" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">un.kod_hist_mat_dec, /*number*//*key*/
</column><column table="un" column="kod_isp" group="1" as="kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_isp" sourcecolumn="kod_isp">un.kod_isp, /*number*//*key*/
</column><column table="un" column="kod_mat" group="1" as="kod_mat" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat" sourcecolumn="kod_mat">un.kod_mat, /*number*//*key*/
</column><column table="un" column="kod_opl" group="1" as="kod_opl" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">un.kod_opl/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query><query name="ur_dogplat" dimension="kod_dogplat" link-mp-point="1" as="kod_dogplat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/kod_dogplat" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_dogplat" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="dat_form" type="date" title="Дата расч. задолж." editable="is_doc" editable-invert="1" as="dat_form" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_dogplat" sourcecolumn="dat_form" used="1">a.dat_form as dat_form, /*Дата расч. задолж.*//*date*/
</column><column table="a" column="prizn_konv" type="number" title="" comment="Бельченко: не знаю для чего создавалась будет признаком автоматического счета" is-fact="1" agg="max" as="prizn_konv" fact="ur_dogplat_prizn_konv" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_dogplat" sourcecolumn="prizn_konv" used="1">a.prizn_konv as prizn_konv/**//*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat on <column table="kod_dogplat" column="kod_dogplat">kod_dogplat.kod_dogplat</column><text txtype="func"> = </text><column table="qube" column="kod_dogplat">qube.kod_dogplat</column></call>--\ur_dogplat
</query><query name="sr_opl" dimension="kod_opl" link-mp-point="1" as="kod_opl" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat_uch" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_opl" sourcecolumn="dat_uch" used="1">a.dat_uch as dat_uch/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="=" type="bool">)
kod_opl on <column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column><text txtype="func"> = </text><column table="qube" column="kod_opl">qube.kod_opl</column></call>--\sr_opl
</query><query name="ur_isp" dimension="kod_isp" link-mp-point="1" as="kod_isp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата выдачи исп. листа" fact="ur_isp_dat_doc" agg="max" dimension="dat_ur" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата выдачи исп. листа*//*date*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" dimension="kod_isp" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="kod_isp" column="kod_isp">kod_isp.kod_isp</column><text txtype="func"> = </text><column table="qube" column="kod_isp">qube.kod_isp</column></call>--\ur_isp
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" link-mp-point="1" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="dat_post" type="date" title="Дата прин. суд. акта" column-mandatory="1" comment="Дата принятия судебного акта" as="dat_post" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec" sourcecolumn="dat_post" used="1">a.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column><text txtype="func"> = </text><column table="qube" column="kod_hist_mat_dec">qube.kod_hist_mat_dec</column></call>--\ur_hist_mat_dec
</query></from><group> group by
<column table="qube" column="kod_mat" group="1" as="kod_mat" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_mat">qube.kod_mat, /*number*//*key*/
</column><column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_hist_mat_dec" group="1" as="kod_hist_mat_dec" key="1" fixed="1" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/dims/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">qube.kod_hist_mat_dec/*number*//*key*/
</column></group>)
qube
--\
</query><query name="ur_hist_mat_dec" dimension="kod_hist_mat_dec" link-mp-point="1" as="kod_hist_mat_dec" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat_dec
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_result" type="number" valid="qube.kod_result_vld" rows-limit="0" column-mandatory="1" as="kod_result" reference="us_result" refcol="kod_result" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*/
</column><column table="a" column="dat_rassm" type="date" title="Дата/время суд. разб." controlType="UIDate" column-mandatory="1" comment="Дата и время судебного разбирательства" as="dat_rassm" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm" used="1">a.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="a" column="dat_post" type="date" title="Дата прин. суд. акта" column-mandatory="1" comment="Дата принятия судебного акта" as="dat_post" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post" used="1">a.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="a" column="prim" type="string" title="Примечание" controlType="UITextEx" data-size="200" as="prim" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim" used="1">a.prim as prim, /*Примечание*//*string*/
</column><column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat_desc" key="1" fixed="1" thissrc="kod_hist_mat" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat_desc/*number*//*key*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" dimension="kod_hist_mat_dec" used="1">ur_hist_mat
a
--\ur_hist_mat
</table><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="decision" type="number" title="" comment="1- является окончательным решением" as="decision" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec/kod_result" sourcecolumn="decision" used="1">a.decision as decision/**//*number*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="a" column="kod_result">a.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query></from><where>where
<call function="=" pth="" type="bool"><column table="kod_result" column="decision">kod_result.decision</column><text txtype="func"> = </text><const><text>1</text></const></call></where><call function="=" type="bool">)
kod_hist_mat_dec on <column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column><text txtype="func"> = </text><column table="qube" column="kod_hist_mat_dec">qube.kod_hist_mat_dec</column></call>--\ur_hist_mat_dec
</query><query name="us_result" as="kod_result" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/kod_result" haskeys="1" used="1">left outer join
(
<select>--us_result
select <column table="a" column="kod_result" type="number" as="kod_result" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="kod_result" used="1">a.kod_result as kod_result, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Результат рассмотрения" vid="1" as="name" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name" used="1">a.name as name/*Результат рассмотрения*//*string*/
</column></select><from>
from <table name="us_result" as="a" used="1">us_result
a
--\us_result
</table></from><call function="=" type="bool">)
kod_result on <column table="kod_hist_mat_dec" column="kod_result">kod_hist_mat_dec.kod_result</column><text txtype="func"> = </text><column table="kod_result" column="kod_result">kod_result.kod_result</column></call>--\us_result
</query><query name="ur_isp" as="ur_isp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/ur_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="num_reg" type="string" title="Номер исп. листа" column-mandatory="1" as="num_reg" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg" used="1">a.num_reg as num_reg, /*Номер исп. листа*//*string*/
</column><column table="a" column="dat_doc" type="date" title="Дата выдачи исп. листа" fact="ur_isp_dat_doc" agg="max" dimension="dat_ur" as="dat_doc" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc, /*Дата выдачи исп. листа*//*date*/
</column><column table="a" column="dat_function" type="date" title="Дата вступления в силу акта" comment="дата начала срока действия исп.листа" column-mandatory="1" as="dat_function" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function" used="1">a.dat_function as dat_function, /*Дата вступления в силу акта*//*date*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
ur_isp on <column table="ur_isp" column="kod_hist_mat">ur_isp.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat_dec" column="kod_hist_mat">kod_hist_mat_dec.kod_hist_mat</column></call>--\ur_isp
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="ur_mat" dimension="kod_mat" link-mp-point="1" as="ur_mat" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/ur_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo/*Номер дела*//*string*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" dimension="kod_mat" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
ur_mat on <column table="ur_mat" column="kod_mat">ur_mat.kod_mat</column><text txtype="func"> = </text><column table="qube" column="kod_mat">qube.kod_mat</column></call>--\ur_mat
</query><query name="ur_state" as="kod_ur_state_pp" join="left outer" path="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" haskeys="1" used="1">left outer join
(
<select>--ur_state
select <column table="a" column="kod_ur_state" type="number" key-dimension="kod_ur_sate" as="kod_ur_state" key="1" fixed="1" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="kod_ur_state" used="1">a.kod_ur_state as kod_ur_state, /*number*//*key*/
</column><column table="a" column="name" type="string" title="Юр. статус" vid="1" as="name" key="0" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name" used="1">a.name as name/*Юр. статус*//*string*/
</column></select><from>
from <table name="ur_sate" view="1" as="a" used="1"><text>(
      select 6  as kod_ur_state , 'Мораторная задолженность' as name from dual
      union select 5 , 'На исполнительном производстве(казн.)' from dual
      union select 4 , 'На исполнительном производстве(инк.)' from dual
      union select 3 , 'На исполнительном производстве(ССП)' from dual
      union select 2 , 'Взысканная задолженность' from dual
      union select 1 , 'Исковая задолженность' from dual
    )</text>a
--\ur_sate
</table></from><call function="=" type="bool">)
kod_ur_state_pp on <column table="kod_ur_state_pp" column="kod_ur_state">kod_ur_state_pp.kod_ur_state</column><text txtype="func"> = </text><column column="kod_ur_state_pp1" table="qube" as="kod_ur_state_pp1">qube.kod_ur_state_pp1</column></call>--\ur_state
</query></from>)
grpd
--\
</query></from>)
--\
</query></with><select>--36703-isk
select '36703-isk' as skod,
'36703-isk|#'||mtr.growid as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="isk" column="grsetname" as="grsetname" type="string" used="1" key="0" into="s1">isk.grsetname as grsetname, /*string*/
</column><column table="isk" column="kod_mat" as="kod_mat" c-master-key="kod_mat" used="1" key="0" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat" into="n1">isk.kod_mat as kod_mat, /*number*/
</column><column table="isk" column="kod_dog" as="kod_dog" c-master-key="kod_dog" used="1" key="0" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2">isk.kod_dog as kod_dog, /*number*/
</column><column table="isk" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat" into="n3">isk.kod_hist_mat_desc as kod_hist_mat_desc, /*number*/
</column><column table="isk" column="kod_isp" as="kod_isp" c-master-key="kod_isp" used="1" key="0" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" into="n4">isk.kod_isp as kod_isp, /*number*/
</column><column table="isk" column="num_delo" as="num_delo" c-master="kod_mat" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo" into="s2">isk.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="isk" column="vist" as="vist" is-fact-use="1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa" into="n5">isk.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="isk" column="period" as="period" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2" into="s3">isk.period as period, /*Отчетный период*//*string*/
</column><column table="isk" column="resh_res" as="resh_res" c-master="kod_hist_mat_desc" used="1" key="0" type="string" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name" into="s4">isk.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="isk" column="dat_rassm" as="dat_rassm" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm" into="d1">isk.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="isk" column="dat_post" as="dat_post" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post" into="d2">isk.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="isk" column="prim" as="prim" c-master="kod_hist_mat_desc" used="1" key="0" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim" into="s5">isk.prim as prim, /*Примечание*//*string*/
</column><column table="isk" column="name_st" as="name_st" used="1" key="0" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name" into="s6">isk.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="isk" column="num_il" as="num_il" c-master="kod_isp" used="1" key="0" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg" into="s7">isk.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="isk" column="dat_v_il" as="dat_v_il" c-master="kod_isp" used="1" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc" into="d3">isk.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="isk" column="dat_v_silu_il" as="dat_v_silu_il" c-master="kod_isp" used="1" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function" into="d4">isk.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="isk" column="prizn_il" as="prizn_il" is-fact-use="1" used="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v" into="n6">isk.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="isk" column="dat_na_isp_il" as="dat_na_isp_il" is-fact-use="1" used="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc" into="d5">isk.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="isk" column="tek_dolg" as="tek_dolg" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl" into="n7">isk.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><column table="isk" column="visisk" as="visisk" used="1" key="0" type="number" into="n8">isk.visisk as visisk, /*number*/
</column><column table="isk" column="visresh" as="visresh" used="1" key="0" type="number" into="n9">isk.visresh as visresh, /*number*/
</column><column table="isk" column="visil" as="visil" used="1" key="0" type="number" into="n10">isk.visil as visil, /*number*/
</column><column table="isk" column="gr_rn" as="gr_rn" type="number" used="1" key="0" into="n11">isk.gr_rn as gr_rn, /*number*/
</column><column table="isk" column="growid" as="growid" type="string" title="" keypath=".growid" used="1" key="1" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog" into="s8">isk.growid as growid, /**//*string*//*key*/
</column><column table="isk" column="parent_growid" as="parent_growid" type="string" title="" used="1" key="0" agg="max" c-master-key="kod_dog" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="s9">isk.parent_growid as parent_growid, /**//*string*/
</column><column table="isk" column="groupingid" as="groupingid" used="1" key="0" type="number" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog" into="n12">isk.groupingid as groupingid, /*number*/
</column><column table="isk" column="grsetid" as="grsetid" type="string" title="" used="1" key="0" into="s10">isk.grsetid as grsetid, /**//*string*/
</column><column table="isk" column="origgrsetid" as="origgrsetid" type="string" title="" used="1" key="0" into="s11">isk.origgrsetid as origgrsetid, /**//*string*/
</column><column table="isk" column="parent_grsetid" as="parent_grsetid" type="string" title="" used="1" key="0" into="s12">isk.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="isk" column="par_groupingid" as="par_groupingid" type="number" title="" used="1" key="0" into="n13">isk.par_groupingid as par_groupingid, /**//*number*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-isk" as="isk" path="./isk" order="kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first" haskeys="1" used="1">(
<select>--36703-isk
select <call function="decode" as="grsetname" type="string" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'102'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> ) </text> as grsetname, /*string*/
</call><column table="p1" column="kod_mat" as="kod_mat" c-master-key="kod_mat" key="0" used="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat">p1.kod_mat as kod_mat, /*number*/
</column><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">p1.kod_dog as kod_dog, /*number*/
</column><column table="p1" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" key="0" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">p1.kod_hist_mat_desc as kod_hist_mat_desc, /*number*/
</column><column table="p1" column="kod_isp" as="kod_isp" c-master-key="kod_isp" key="0" used="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp">p1.kod_isp as kod_isp, /*number*/
</column><column table="p1" column="num_delo" as="num_delo" c-master="kod_mat" key="0" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo">p1.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="p1" column="vist" as="vist" is-fact-use="1" key="0" used="1" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">p1.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="p1" column="period" as="period" key="0" used="1" type="string" title="Отчетный период" agg="stragg" format="F2">p1.period as period, /*Отчетный период*//*string*/
</column><column table="p1" column="resh_res" as="resh_res" c-master="kod_hist_mat_desc" key="0" used="1" type="string" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name">p1.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="p1" column="dat_rassm" as="dat_rassm" c-master="kod_hist_mat_desc" key="0" used="1" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm">p1.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="p1" column="dat_post" as="dat_post" c-master="kod_hist_mat_desc" key="0" used="1" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post">p1.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="p1" column="prim" as="prim" c-master="kod_hist_mat_desc" key="0" used="1" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim">p1.prim as prim, /*Примечание*//*string*/
</column><column table="p1" column="name_st" as="name_st" key="0" used="1" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name">p1.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="p1" column="num_il" as="num_il" c-master="kod_isp" key="0" used="1" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg">p1.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="p1" column="dat_v_il" as="dat_v_il" c-master="kod_isp" key="0" used="1" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc">p1.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="p1" column="dat_v_silu_il" as="dat_v_silu_il" c-master="kod_isp" key="0" used="1" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function">p1.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="p1" column="prizn_il" as="prizn_il" is-fact-use="1" key="0" used="1" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">p1.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="p1" column="dat_na_isp_il" as="dat_na_isp_il" is-fact-use="1" key="0" used="1" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">p1.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="p1" column="tek_dolg" as="tek_dolg" is-fact-use="1" key="0" used="1" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">p1.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><column table="p1" column="visisk" as="visisk" key="0" used="1" type="number">p1.visisk as visisk, /*number*/
</column><column table="p1" column="visresh" as="visresh" key="0" used="1" type="number">p1.visresh as visresh, /*number*/
</column><column table="p1" column="visil" as="visil" key="0" used="1" type="number">p1.visil as visil, /*number*/
</column><call function="row_number" as="gr_rn" pth="" type="number" key="0" used="1"><text txtype="func"> row_number() over( </text><call function="order by simple" pth="0" type="order"><text txtype="func"> order by </text><const><text>null</text></const></call><text txtype="func"> ) </text> as gr_rn, /*number*/
</call><call function="||" as="growid" type="string" key="1" title="" pth="" used="1" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog"><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visisk" as="visisk" thissrc="visisk">p1.visisk</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visresh" as="visresh" thissrc="visresh">p1.visresh</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>4</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visil" as="visil" thissrc="visil">p1.visil</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>8</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>16</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_mat" as="kod_mat" c-master-key="kod_mat" thissrc="kod_mat">p1.kod_mat</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>32</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" thissrc="kod_hist_mat_desc">p1.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>64</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_isp" as="kod_isp" c-master-key="kod_isp" thissrc="kod_isp">p1.kod_isp</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const> as growid, /**//*string*//*key*/
</call><call function="if" as="parent_growid" type="string" title="" pth="" key="0" used="1" agg="max" c-master-key="kod_dog" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is null" pth="" type="bool">(<column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> is null </text>) </call><text txtype="func"> then </text><const><text>null</text></const><text txtype="func"> else </text><call function="||" pth="" type="string">(<const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visisk" as="visisk" thissrc="visisk">p1.visisk</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visresh" as="visresh" thissrc="visresh">p1.visresh</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>4</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="visil" as="visil" thissrc="visil">p1.visil</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>8</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" c-master-key="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>16</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_mat" as="kod_mat" c-master-key="kod_mat" thissrc="kod_mat">p1.kod_mat</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>32</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" thissrc="kod_hist_mat_desc">p1.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>64</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_isp" as="kod_isp" c-master-key="kod_isp" thissrc="kod_isp">p1.kod_isp</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const>) </call><text txtype="func"> end </text> as parent_growid, /**//*string*/
</call><column table="p1" column="groupingid" as="groupingid" key="0" used="1" type="number" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog">p1.groupingid as groupingid, /*number*/
</column><call function="decode" as="grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'il'</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>'resh'</text></const><text txtype="func"> , </text><const><text>'102'</text></const><text txtype="func"> , </text><const><text>'isk'</text></const><text txtype="func"> ) </text> as grsetid, /**//*string*/
</call><call function="decode" as="origgrsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'il'</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>'resh'</text></const><text txtype="func"> , </text><const><text>'102'</text></const><text txtype="func"> , </text><const><text>'isk'</text></const><text txtype="func"> ) </text> as origgrsetid, /**//*string*/
</call><call function="decode" as="parent_grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'resh'</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>'isk'</text></const><text txtype="func"> ) </text> as parent_grsetid, /**//*string*/
</call><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1">p1.par_groupingid as par_groupingid/**//*number*/
</column></select><from>
from <query as="p1" path="./isk/p1" used="1">(
<select>--
select <column table="grsets_query" column="kod_mat" as="kod_mat" c-master-key="kod_mat" keypath=".kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat">grsets_query.kod_mat as kod_mat, /*number*//*key*/
</column><column table="grsets_query" column="kod_dog" as="kod_dog" c-master-key="kod_dog" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grsets_query.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grsets_query" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" keypath=".kod_hist_mat_desc" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">grsets_query.kod_hist_mat_desc as kod_hist_mat_desc, /*number*//*key*/
</column><column table="grsets_query" column="kod_isp" as="kod_isp" c-master-key="kod_isp" keypath=".kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp">grsets_query.kod_isp as kod_isp, /*number*//*key*/
</column><column table="grsets_query" column="num_delo" as="num_delo" c-master="kod_mat" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo">grsets_query.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="grsets_query" column="vist" as="vist" is-fact-use="1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">grsets_query.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="grsets_query" column="period" as="period" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">grsets_query.period as period, /*Отчетный период*//*string*/
</column><column table="grsets_query" column="resh_res" as="resh_res" c-master="kod_hist_mat_desc" used="1" key="0" type="string" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name">grsets_query.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="grsets_query" column="dat_rassm" as="dat_rassm" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm">grsets_query.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="grsets_query" column="dat_post" as="dat_post" c-master="kod_hist_mat_desc" used="1" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post">grsets_query.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="grsets_query" column="prim" as="prim" c-master="kod_hist_mat_desc" used="1" key="0" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim">grsets_query.prim as prim, /*Примечание*//*string*/
</column><column table="grsets_query" column="name_st" as="name_st" used="1" key="0" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name">grsets_query.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="grsets_query" column="num_il" as="num_il" c-master="kod_isp" used="1" key="0" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg">grsets_query.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="grsets_query" column="dat_v_il" as="dat_v_il" c-master="kod_isp" used="1" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc">grsets_query.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="grsets_query" column="dat_v_silu_il" as="dat_v_silu_il" c-master="kod_isp" used="1" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function">grsets_query.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="grsets_query" column="prizn_il" as="prizn_il" is-fact-use="1" used="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">grsets_query.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="grsets_query" column="dat_na_isp_il" as="dat_na_isp_il" is-fact-use="1" used="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">grsets_query.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="grsets_query" column="tek_dolg" as="tek_dolg" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">grsets_query.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><column table="grsets_query" column="visisk" as="visisk" used="1" key="0" type="number">grsets_query.visisk as visisk, /*number*/
</column><column table="grsets_query" column="visresh" as="visresh" used="1" key="0" type="number">grsets_query.visresh as visresh, /*number*/
</column><column table="grsets_query" column="visil" as="visil" used="1" key="0" type="number">grsets_query.visil as visil, /*number*/
</column><column table="grsets_query" column="groupingid" as="groupingid" used="1" key="0" type="number" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog">grsets_query.groupingid as groupingid, /*number*/
</column><call function="decode" as="par_groupingid" type="number" title="" pth="" used="1" key="0"><text txtype="func"> decode( </text><column table="grsets_query" column="groupingid" as="groupingid" thissrc="groupingid">grsets_query.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>'68'</text></const><text txtype="func"> , </text><const><text>'102'</text></const><text txtype="func"> ) </text> as par_groupingid/**//*number*/
</call></select><from>
from <query as="grsets_query" path="./isk/p1/grsets_query" used="1">(
<select>--
select <column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1" keypath=".kod_mat" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="kod_mat">grpd.kod_mat as kod_mat, /*number*//*key*/
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" keypath=".kod_dog" used="1" key="1" type="number" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1" keypath=".kod_hist_mat_desc" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="kod_hist_mat">grpd.kod_hist_mat_desc as kod_hist_mat_desc, /*number*//*key*/
</column><column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1" keypath=".kod_isp" used="1" key="1" type="number" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp">grpd.kod_isp as kod_isp, /*number*//*key*/
</column><call function="if" as="num_delo" c-master="kod_mat" pth="" used="1" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_mat" sourcecolumn="num_delo"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1">grpd.kod_mat</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="num_delo" group="max" c-master="kod_mat" removeable="1">max(grpd.num_delo) </column><text txtype="func"> end </text> as num_delo, /*Номер дела*//*string*/
</call><column table="grpd" column="vist" as="vist" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="summa">sum(grpd.vist)  as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="grpd" column="period" as="period" group="max" removeable="1" used="1" key="0" type="string" title="Отчетный период" agg="stragg" format="F2">max(grpd.period)  as period, /*Отчетный период*//*string*/
</column><call function="if" as="resh_res" c-master="kod_hist_mat_desc" pth="" used="1" key="0" type="string" title="Результат рассмотрения" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_result" sourcecolumn="name"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1">grpd.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="resh_res" group="max" c-master="kod_hist_mat_desc" removeable="1">max(grpd.resh_res) </column><text txtype="func"> end </text> as resh_res, /*Результат рассмотрения*//*string*/
</call><call function="if" as="dat_rassm" c-master="kod_hist_mat_desc" pth="" used="1" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_rassm"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1">grpd.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="dat_rassm" group="max" c-master="kod_hist_mat_desc" removeable="1">max(grpd.dat_rassm) </column><text txtype="func"> end </text> as dat_rassm, /*Дата/время суд. разб.*//*date*/
</call><call function="if" as="dat_post" c-master="kod_hist_mat_desc" pth="" used="1" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="dat_post"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1">grpd.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="dat_post" group="max" c-master="kod_hist_mat_desc" removeable="1">max(grpd.dat_post) </column><text txtype="func"> end </text> as dat_post, /*Дата прин. суд. акта*//*date*/
</call><call function="if" as="prim" c-master="kod_hist_mat_desc" pth="" used="1" key="0" type="string" title="Примечание" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_hist_mat_dec" sourcecolumn="prim"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1">grpd.kod_hist_mat_desc</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="prim" group="max" c-master="kod_hist_mat_desc" removeable="1">max(grpd.prim) </column><text txtype="func"> end </text> as prim, /*Примечание*//*string*/
</call><column table="grpd" column="name_st" as="name_st" group="max" removeable="1" used="1" key="0" type="string" title="Юр. статус" sourcetable="./isk/p1/grsets_query/grpd/grpd/kod_ur_state_pp" sourcecolumn="name">max(grpd.name_st)  as name_st, /*Юр. статус*//*string*/
</column><call function="if" as="num_il" c-master="kod_isp" pth="" used="1" key="0" type="string" title="Номер исп. листа" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="num_reg"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1">grpd.kod_isp</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="num_il" group="max" c-master="kod_isp" removeable="1">max(grpd.num_il) </column><text txtype="func"> end </text> as num_il, /*Номер исп. листа*//*string*/
</call><call function="if" as="dat_v_il" c-master="kod_isp" pth="" used="1" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_doc"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1">grpd.kod_isp</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="dat_v_il" group="max" c-master="kod_isp" removeable="1">max(grpd.dat_v_il) </column><text txtype="func"> end </text> as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</call><call function="if" as="dat_v_silu_il" c-master="kod_isp" pth="" used="1" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="dat_function"><text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<call function="grouping" pth="">(<text txtype="func"> grouping( </text><column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1">grpd.kod_isp</column><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>0</text></const>) </call><text txtype="func"> then </text><column table="grpd" column="dat_v_silu_il" group="max" c-master="kod_isp" removeable="1">max(grpd.dat_v_silu_il) </column><text txtype="func"> end </text> as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</call><column table="grpd" column="prizn_il" as="prizn_il" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_dogplat" sourcecolumn="sum_v">sum(grpd.prizn_il)  as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="grpd" column="dat_na_isp_il" as="dat_na_isp_il" group="min" removeable="1" is-fact-use="1" used="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/ur_kazn" sourcecolumn="dat_doc">min(grpd.dat_na_isp_il)  as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="grpd" column="tek_dolg" as="tek_dolg" group="sum" removeable="1" is-fact-use="1" used="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk/p1/grsets_query/grpd/grpd/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(grpd.tek_dolg)  as tek_dolg, /*Оборот*//*number*/
</column><column table="grpd" column="visisk" as="visisk" used="1" key="0" type="number">grpd.visisk as visisk, /*number*/
</column><column table="grpd" column="visresh" as="visresh" used="1" key="0" type="number">grpd.visresh as visresh, /*number*/
</column><column table="grpd" column="visil" as="visil" used="1" key="0" type="number">grpd.visil as visil, /*number*/
</column><call function="grouping_id" as="groupingid" pth="" type="number" used="1" key="0" agg="max" c-master-key="kod_isp" sourcetable="./isk/p1/grsets_query/grpd/grpd/ur_isp" sourcecolumn="kod_isp" reference="kr_dogovor" refcol="kod_dog"><text txtype="func"> grouping_id( </text><column table="grpd" column="kod_isp">grpd.kod_isp</column><text txtype="func"> , </text><column table="grpd" column="kod_hist_mat_desc">grpd.kod_hist_mat_desc</column><text txtype="func"> , </text><column table="grpd" column="kod_mat">grpd.kod_mat</column><text txtype="func"> , </text><column table="grpd" column="kod_dog">grpd.kod_dog</column><text txtype="func"> , </text><column table="grpd" column="visil">grpd.visil</column><text txtype="func"> , </text><column table="grpd" column="visresh">grpd.visresh</column><text txtype="func"> , </text><column table="grpd" column="visisk">grpd.visisk</column><text txtype="func"> ) </text> as groupingid/*number*/
</call></select><from>
from <table name="mat2" as="grpd">mat2
grpd
--\mat2
</table></from><group gset="first">group by grouping sets ((
<column table="grpd" column="kod_isp" as="kod_isp" c-master-key="kod_isp" removeable="1" used="1">grpd.kod_isp, 
</column><column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1" used="1">grpd.kod_hist_mat_desc, 
</column><column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1" used="1">grpd.kod_mat, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visil" used="1">grpd.visil, 
</column><column table="grpd" column="visresh" used="1">grpd.visresh, 
</column><column table="grpd" column="visisk" used="1">grpd.visisk
</column>),
</group><group gset="3">(
<column table="grpd" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" removeable="1" used="1">grpd.kod_hist_mat_desc, 
</column><column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1" used="1">grpd.kod_mat, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visresh" used="1">grpd.visresh, 
</column><column table="grpd" column="visisk" used="1">grpd.visisk
</column>),
</group><group gset="last">(
<column table="grpd" column="kod_mat" as="kod_mat" c-master-key="kod_mat" removeable="1" used="1">grpd.kod_mat, 
</column><column table="grpd" column="kod_dog" as="kod_dog" c-master-key="kod_dog" removeable="1" used="1">grpd.kod_dog, 
</column><column table="grpd" column="visisk" used="1">grpd.visisk
</column>))
</group><having>having
<call function="and" pth="" type="bool"><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visisk">grpd.visisk</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visresh">grpd.visresh</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><column table="grpd" column="visil">grpd.visil</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> = </text><const><text>1</text></const>) </call></call></having>)
grsets_query
--\
</query></from>)
p1
--\
</query></from><order>
order by kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first</order>)
isk
--\36703-isk
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="isk" column="kod_dog">isk.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first</order>) mtr
;
--\36703-isk
</query>
  <query name="36703-uved" noname="1" order="dat" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-uved';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_pred
n2, --kod_dog
s1, --inf
d1, --dat
s2, --sved_isp
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_pred" /><column column="n2" info="kod_dog" /><column column="s1" info="inf" /><column column="d1" info="dat" /><column column="s2" info="sved_isp" /><column column="sparentid" info="sparentid" />--36703-uved
</insert><order notext="1"><column column="dat">dat</column></order><select>--36703-uved
select '36703-uved' as skod,
'36703-uved|#'||mtr.kod_pred as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="uved" column="kod_pred" as="kod_pred" keypath=".kod_pred" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_pred" into="n1">uved.kod_pred as kod_pred, /*number*//*key*/
</column><column table="uved" column="kod_dog" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2">uved.kod_dog as kod_dog, /*number*/
</column><column table="uved" column="inf" as="inf" key="0" used="1" type="string" into="s1">uved.inf as inf, /*string*/
</column><column table="uved" column="dat" as="dat" key="0" used="1" type="date" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_otkl" into="d1">uved.dat as dat, /*date*/
</column><column table="uved" column="sved_isp" as="sved_isp" key="0" used="1" type="string" sourcetable="./uved/a/kod_pred" sourcecolumn="sved_isp" into="s2">uved.sved_isp as sved_isp, /*string*/
</column><column table="dog" column="sid" as="sparentid" key="0" used="1" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-uved" as="uved" path="./uved" order="dat" haskeys="1" used="1">(
<order notext="1"><column column="dat">dat</column></order><select>--36703-uved
select <column table="a" column="kod_pred" group="max" key="1" as="kod_pred" used="1" type="number" agg="max" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_pred">max(a.kod_pred)  as kod_pred, /*number*//*key*/
</column><column table="a" column="kod_dog" group="1" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="inf" group="1" as="inf" key="0" used="1" type="string">a.inf as inf, /*string*/
</column><column table="a" column="dat" group="max" as="dat" key="0" used="1" type="date" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_otkl">max(a.dat)  as dat, /*date*/
</column><column table="a" column="sved_isp" group="max" as="sved_isp" key="0" used="1" type="string" sourcetable="./uved/a/kod_pred" sourcecolumn="sved_isp">max(a.sved_isp)  as sved_isp/*string*/
</column></select><from>
from <query name="36703-uved-pre" as="a" path="./uved/a" haskeys="1" used="1">(
<select>--36703-uved-pre
select <column table="kod_pred" column="kod_pred" group="1" as="kod_pred" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred as kod_pred, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" reference="kr_dogovor" refcol="kod_dog" used="1" type="number" agg="max" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" reference="sr_facvip" refcol="kod_sf" used="1" type="number" sourcetable="./uved/a/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf as kod_sf, /*number*//*key*/
</column><call function="decode" as="inf" type="string" key="0" group="max" pth="" used="1">max(<text txtype="func"> decode( </text><column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><text txtype="func"> , </text><const><text>9</text></const><text txtype="func"> , </text><const><text>'Направлено предупреждение о задолженности'</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>'Намечен на ограничение'</text></const><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> , </text><const><text>'Намечен на отключение'</text></const><text txtype="func"> ) </text>)  as inf, /*string*/
</call><call function="decode" as="dat" type="date" key="0" group="max" pth="" used="1" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_otkl">max(<text txtype="func"> decode( </text><column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><text txtype="func"> , </text><const><text>9</text></const><text txtype="func"> , </text><column table="kod_pred" column="dat_tlg">kod_pred.dat_tlg</column><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><column table="kod_pred" column="dat_otkl">kod_pred.dat_otkl</column><text txtype="func"> , </text><const><text>1</text></const><text txtype="func"> , </text><column table="kod_pred" column="dat_otkl">kod_pred.dat_otkl</column><text txtype="func"> ) </text>)  as dat, /*date*/
</call><column table="kod_pred" column="sved_isp" group="max" as="sved_isp" key="0" used="1" type="string" sourcetable="./uved/a/kod_pred" sourcecolumn="sved_isp">max(kod_pred.sved_isp)  as sved_isp/*string*/
</column></select><from>
from <query as="qube" path="./uved/a/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_pred" group="1" as="kod_pred" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">qube.kod_pred as kod_pred, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="dat_dolg" group="1" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><call function="-nvl" as="fin_ul_ob1" title="Оборот" group="sum" pth="" type="number" key="0" used="1" agg="sum" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column><text txtype="func"> ,0) </text>)  as fin_ul_ob1/*Оборот*//*number*/
</call></select><from>
from <query as="qube" path="./uved/a/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_pred" as="kod_pred" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">qube.kod_pred as kod_pred, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="dat_dolg" as="dat_dolg" keypath=".dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="qube" path="./uved/a/qube/qube/qube" used="1">(
<query path="./uved/a/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./uved/a/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="dat_dolg" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="qube" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_pred" as="kod_pred" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">qube.kod_pred as kod_pred, /*number*/
</column><column table="qube" column="kod_sf" as="kod_sf" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="qube" path="./uved/a/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat_dolg" group="1" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">un.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_pred" group="1" as="kod_pred" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">un.kod_pred as kod_pred, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="sr_facras_nachisl1" group="sum" as="sr_facras_nachisl1" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(un.sr_facras_nachisl1)  as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf1)  as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="un" path="./uved/a/qube/qube/qube/qube/qube/un" used="1">(
<query path="./uved/a/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./uved/a/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="dat_dolg" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">dims.dat_dolg as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="dims" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_pred" as="kod_pred" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">dims.kod_pred as kod_pred, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><column table="sr_facras" column="nachisl" as="sr_facras_nachisl1" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sr_facras.nachisl as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_opl_sf1" key="0" used="1"><text>null</text> as sr_opl_opl_sf1/*number*/
</const></select><from>
from <query as="dims" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_dolg" group="1" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad as dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_pred" column="kod_pred" as="kod_pred" group="1" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred as kod_pred, /*number*//*key*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" haskeys="1" used="1">(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where>)
sr_facras_a_d
--\sr_facras
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_facras_a_d" column="kod_sf">sr_facras_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_predabon" dimension="kod_pred" as="kod_pred" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" haskeys="1" used="1">left outer join
(
<select>--kr_predabon
select <column table="a" column="kod_pred" type="number" comment="код предупредит телефонограммы" is-fact="1" agg="max" as="kod_pred" fact="kr_predabon_kod_pred" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred" used="1">a.kod_pred as kod_pred, /*number*//*key*/
</column><column table="a" column="pr_arx" type="number" title="" comment="признак архивной тф: 1-архивная" as="pr_arx" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="pr_arx" used="1">a.pr_arx as pr_arx, /**//*number*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="dat_ras" type="date" title="" comment="дата расчета задолженности" dimension="dat" as="dat_ras" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="dat_ras" used="1">a.dat_ras as dat_ras, /**//*date*/
</column><column table="a" column="kod_otkloper" type="number" comment="код операции (ограничение или отключение)" as="kod_otkloper" reference="kk_otkloper" refcol="kod_otkloper" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_otkloper" used="1">a.kod_otkloper as kod_otkloper/*number*/
</column></select><from>
from <table name="kr_predabon" as="a" dimension="kod_pred" used="1">kr_predabon
a
--\kr_predabon
</table></from><call function="=" type="bool">)
kod_pred on <column table="kod_pred" column="kod_dog">kod_pred.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_predabon
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="or" pth="1" type="bool">(<call function="!=" pth="" type="bool">(<column table="kod_pred" column="pr_arx">kod_pred.pr_arx</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> or </text><call function="gt" pth="" type="bool">(<column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column><text txtype="func"> &gt; </text><call function="date add days" pth="" type="date">(<const><text>:dat </text></const><text txtype="func"> + ( </text><const><text>-200</text></const><text txtype="func"> ) </text>) </call>) </call>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call>) </call></call></where><group> group by
<column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras, /*number*//*key*/
</column><column table="kod_sf" column="dat_bzad" as="dat_dolg" group="1" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">kod_sf.dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_pred" column="kod_pred" as="kod_pred" group="1" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred, /*number*//*key*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facras" dimension="kod_ras" as="sr_facras" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" haskeys="1" used="1">left outer join
(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl" used="1">a.nachisl as nachisl/*Начислено*//*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
sr_facras on <column table="sr_facras" column="kod_ras">sr_facras.kod_ras</column><text txtype="func"> = </text><column table="dims" column="kod_ras_prm">dims.kod_ras_prm</column></call>--\sr_facras
</query><qubecontent><where>where
<call function="and" condsource="36703-uved-pre"><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="or">(<call function="!=">(<column table="kod_pred" column="pr_arx">kod_pred.pr_arx</column><const>1</const>) </call><call function="gt">(<column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column><call function="date add days">(<const>:dat </const><const>-200</const>) </call>) </call>) </call><call function="in">(<column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><call function="array">(<const>1</const><const>2</const><const>9</const>) </call>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./uved/a/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat_dolg" as="dat_dolg" key="1" used="1" type="date" title="Дата операции оплаты задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">dims.dat_dolg as dat_dolg, /*Дата операции оплаты задолженности*//*date*//*key*/
</column><column table="dims" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_pred" as="kod_pred" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">dims.kod_pred as kod_pred, /*number*/
</column><column table="dims" column="kod_sf" as="kod_sf" key="0" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*/
</column><const type="number" as="sr_facras_nachisl1" key="0" used="1"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="sr_opl_sf" column="opl_sf" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">sr_opl_sf.opl_sf as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="dims" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="dat_oper_dolg" as="dat_dolg" group="1" key="1" used="1" type="date" title="Дата операции оплаты задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">sr_opl_sf_a_d.dat_oper_dolg as dat_dolg, /*Дата операции оплаты задолженности*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_pred" column="kod_pred" as="kod_pred" group="1" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred as kod_pred, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><call function="latest" as="dat_oper_dolg" type="date" title="Дата операции оплаты задолженности" key="0" pth="" used="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> nullif(greatest ( </text><text txtype="func"> nvl( </text><column table="kod_sf" column="dat_bzad">kod_sf.dat_bzad</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> , nvl( </text><column table="a" column="dat_uch" type="date" title="" as="dat_uch" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_uch">a.dat_uch</column><text txtype="func"> , to_date('01.01.0001','DD.MM.YYYY')) </text><text txtype="func"> ), to_date('01.01.0001','DD.MM.YYYY')) </text> as dat_oper_dolg/*Дата операции оплаты задолженности*//*date*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><call function="coalesce" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" pth="" used="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad"><text txtype="func"> coalesce( </text><column table="kod_deb" column="dat_bzad">kod_deb.dat_bzad</column><text txtype="func"> , </text><column table="a" column="dat_zadol" type="date" comment="конечная дата расчета пени по авансам (для эх)" as="dat_zadol" key="0" thissrc="dat_zadol">a.dat_zadol</column><text txtype="func"> , </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ) </text> as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table><query name="sr_debet" dimension="kod_deb" as="kod_deb" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" haskeys="1" used="1">left outer join
(
<select>--sr_debet
select <column table="a" column="kod_deb" type="number" key-dimension="kod_deb" as="kod_deb" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="kod_deb" used="1">a.kod_deb as kod_deb, /*number*//*key*/
</column><column table="a" column="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" as="dat_bzad" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad" used="1">a.dat_bzad as dat_bzad/*Дата возникновения обязательства по погашению задолженности*//*date*/
</column></select><from>
from <table name="sr_debet" as="a" dimension="kod_deb" used="1">sr_debet
a
--\sr_debet
</table></from><call function="=" type="bool">)
kod_deb on <column table="a" column="kod_deb">a.kod_deb</column><text txtype="func"> = </text><column table="kod_deb" column="kod_deb">kod_deb.kod_deb</column></call>--\sr_debet
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf" column="kod_dog">kod_sf.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_predabon" dimension="kod_pred" as="kod_pred" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" haskeys="1" used="1">left outer join
(
<select>--kr_predabon
select <column table="a" column="kod_pred" type="number" comment="код предупредит телефонограммы" is-fact="1" agg="max" as="kod_pred" fact="kr_predabon_kod_pred" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred" used="1">a.kod_pred as kod_pred, /*number*//*key*/
</column><column table="a" column="pr_arx" type="number" title="" comment="признак архивной тф: 1-архивная" as="pr_arx" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="pr_arx" used="1">a.pr_arx as pr_arx, /**//*number*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="dat_ras" type="date" title="" comment="дата расчета задолженности" dimension="dat" as="dat_ras" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="dat_ras" used="1">a.dat_ras as dat_ras, /**//*date*/
</column><column table="a" column="kod_otkloper" type="number" comment="код операции (ограничение или отключение)" as="kod_otkloper" reference="kk_otkloper" refcol="kod_otkloper" key="0" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_otkloper" used="1">a.kod_otkloper as kod_otkloper/*number*/
</column></select><from>
from <table name="kr_predabon" as="a" dimension="kod_pred" used="1">kr_predabon
a
--\kr_predabon
</table></from><call function="=" type="bool">)
kod_pred on <column table="kod_pred" column="kod_dog">kod_pred.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_predabon
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="or" pth="1" type="bool">(<call function="!=" pth="" type="bool">(<column table="kod_pred" column="pr_arx">kod_pred.pr_arx</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> or </text><call function="gt" pth="" type="bool">(<column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column><text txtype="func"> &gt; </text><call function="date add days" pth="" type="date">(<const><text>:dat </text></const><text txtype="func"> + ( </text><const><text>-200</text></const><text txtype="func"> ) </text>) </call>) </call>) </call><text txtype="func"> and </text><call function="in" pth="" type="bool">(<column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call>) </call></call></where><group> group by
<column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="dat_oper_dolg" as="dat_dolg" group="1" key="1" used="1" type="date" title="Дата операции оплаты задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d/kod_sf/kod_deb" sourcecolumn="dat_bzad">sr_opl_sf_a_d.dat_oper_dolg, /*Дата операции оплаты задолженности*//*date*//*key*/
</column><column table="kod_sf" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">kod_sf.kod_dog, /*number*//*key*/
</column><column table="kod_pred" column="kod_pred" as="kod_pred" group="1" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf" join="left outer" path="./uved/a/qube/qube/qube/qube/qube/un/un/sr_opl_sf" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/sr_opl_sf" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf/*Оплата начислений*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
sr_opl_sf on <column table="sr_opl_sf" column="kod_opl">sr_opl_sf.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_sf
</query><qubecontent><where>where
<call function="and" condsource="36703-uved-pre"><call function="and">(<call function="true">() </call><call function="in" optional="1">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call>) </call><call function="or">(<call function="!=">(<column table="kod_pred" column="pr_arx">kod_pred.pr_arx</column><const>1</const>) </call><call function="gt">(<column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column><call function="date add days">(<const>:dat </const><const>-200</const>) </call>) </call>) </call><call function="in">(<column table="kod_pred" column="kod_otkloper">kod_pred.kod_otkloper</column><call function="array">(<const>1</const><const>2</const><const>9</const>) </call>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat_dolg" group="1" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">un.dat_dolg, /*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_pred" group="1" as="kod_pred" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">un.kod_pred, /*number*//*key*/
</column><column table="un" column="kod_sf" group="1" as="kod_sf" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf" sourcecolumn="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_pred" group="1" as="kod_pred" key="1" used="1" type="number" agg="max" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_pred" sourcecolumn="kod_pred">qube.kod_pred, /*number*//*key*/
</column><column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" used="1" type="number" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf, /*number*//*key*/
</column><column table="qube" column="dat_dolg" group="1" as="dat_dolg" key="1" used="1" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./uved/a/qube/qube/qube/qube/qube/un/un/dims/kod_sf/kod_deb" sourcecolumn="dat_bzad">qube.dat_dolg/*Дата возникновения обязательства по погашению задолженности*//*date*//*key*/
</column></group>)
qube
--\
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="kod_sf" join="left outer" path="./uved/a/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./uved/a/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="dat_ezad" type="date" as="dat_ezad" key="0" sourcetable="./uved/a/kod_sf" sourcecolumn="dat_ezad" used="1">a.dat_ezad as dat_ezad/*date*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query><query name="kr_predabon" dimension="kod_pred" link-mp-point="1" as="kod_pred" join="left outer" path="./uved/a/kod_pred" haskeys="1" used="1">left outer join
(
<select>--kr_predabon
select <column table="a" column="kod_pred" type="number" comment="код предупредит телефонограммы" is-fact="1" agg="max" as="kod_pred" fact="kr_predabon_kod_pred" key="1" fixed="1" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_pred" used="1">a.kod_pred as kod_pred, /*number*//*key*/
</column><column table="a" column="dat_tlg" type="date" title="" comment="дата телефонограммы" as="dat_tlg" key="0" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_tlg" used="1">a.dat_tlg as dat_tlg, /**//*date*/
</column><column table="a" column="dat_ras" type="date" title="" comment="дата расчета задолженности" dimension="dat" as="dat_ras" key="0" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_ras" used="1">a.dat_ras as dat_ras, /**//*date*/
</column><column table="a" column="dat_otkl" type="date" title="" comment="дата планируемого ограничения (отключения)" as="dat_otkl" key="0" sourcetable="./uved/a/kod_pred" sourcecolumn="dat_otkl" used="1">a.dat_otkl as dat_otkl, /**//*date*/
</column><column table="a" column="kod_otkloper" type="number" comment="код операции (ограничение или отключение)" as="kod_otkloper" reference="kk_otkloper" refcol="kod_otkloper" key="0" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_otkloper" used="1">a.kod_otkloper as kod_otkloper, /*number*/
</column><column table="a" column="sved_isp" type="string" title="" comment="сведения об исполнении казань тепло" as="sved_isp" key="0" sourcetable="./uved/a/kod_pred" sourcecolumn="sved_isp" used="1">a.sved_isp as sved_isp/**//*string*/
</column></select><from>
from <table name="kr_predabon" as="a" dimension="kod_pred" used="1">kr_predabon
a
--\kr_predabon
</table></from><call function="=" type="bool">)
kod_pred on <column table="kod_pred" column="kod_pred">kod_pred.kod_pred</column><text txtype="func"> = </text><column table="qube" column="kod_pred">qube.kod_pred</column></call>--\kr_predabon
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./uved/a/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*//*key*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query></from><having>having
<call function="and" pth="" type="bool"><call function="gt" pth="" type="bool">(<call function="if" as="dolg_uved" type="number" key="0" group="sum" pth="">(sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat_dolg" as="dat_dolg">qube.dat_dolg</column><text txtype="func"> &lt;= </text><column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf" column="dat_ezad">kod_sf.dat_ezad</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &gt; </text><column table="kod_pred" column="dat_ras">kod_pred.dat_ras</column>) </call>) </call><text txtype="func"> then </text><column column="fin_ul_ob1" table="qube" as="fin_ul_ob1">qube.fin_ul_ob1</column><text txtype="func"> end </text>) ) </call><text txtype="func"> &gt; </text><const><text>0</text></const>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="if" as="dolg_tek" type="number" key="0" group="sum" pth="">(sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="le" pth="" type="bool">(<column table="qube" column="dat_dolg" as="dat_dolg">qube.dat_dolg</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> and </text><call function="gt" pth="" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_sf" column="dat_ezad">kod_sf.dat_ezad</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &gt; </text><const><text>:dat </text></const>) </call>) </call><text txtype="func"> then </text><column column="fin_ul_ob1" table="qube" as="fin_ul_ob1">qube.fin_ul_ob1</column><text txtype="func"> end </text>) ) </call><text txtype="func"> &gt; </text><const><text>0</text></const>) </call></call></having><group> group by
<column table="kod_pred" column="kod_pred" group="1" as="kod_pred" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./uved/a/kod_pred" sourcecolumn="kod_pred">kod_pred.kod_pred, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" reference="kr_dogovor" refcol="kod_dog" used="1" type="number" agg="max" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog, /*number*//*key*/
</column><column table="kod_sf" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" reference="sr_facvip" refcol="kod_sf" used="1" type="number" sourcetable="./uved/a/kod_sf" sourcecolumn="kod_sf">kod_sf.kod_sf/*number*//*key*/
</column></group>)
a
--\36703-uved-pre
</query></from><group> group by
<column table="a" column="kod_dog" group="1" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./uved/a/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">a.kod_dog, /*number*/
</column><column table="a" column="inf" group="1" as="inf" key="0" used="1" type="string">a.inf/*string*/
</column></group><order>
order by dat</order>)
uved
--\36703-uved
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" key="1" used="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="uved" column="kod_dog">uved.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by dat</order>) mtr
;
--\36703-uved
</query>
  <query name="36703-teh" noname="1" order="num_obj" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-teh';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_numobj
n2, --num_obj
s1, --name
n3, --kod_dog
d1, --dakt_go
d2, --dakt_gpp
d3, --dakt_gotov
d4, --dpassp_gotov
d5, --d_zayav
d6, --pusk_tep
d7, --otkl_tep
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_numobj" /><column column="n2" info="num_obj" /><column column="s1" info="name" /><column column="n3" info="kod_dog" /><column column="d1" info="dakt_go" /><column column="d2" info="dakt_gpp" /><column column="d3" info="dakt_gotov" /><column column="d4" info="dpassp_gotov" /><column column="d5" info="d_zayav" /><column column="d6" info="pusk_tep" /><column column="d7" info="otkl_tep" /><column column="sparentid" info="sparentid" />--36703-teh
</insert><order notext="1"><column column="num_obj">num_obj</column></order><select>--36703-teh
select '36703-teh' as skod,
'36703-teh|#'||mtr.kod_numobj as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="teh" column="kod_numobj" as="kod_numobj" fixed="1" used="1" key="1" keypath=".kod_numobj" type="number" agg="max" sourcetable="./teh/kod_numobj" sourcecolumn="kod_numobj" into="n1">teh.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="teh" column="num_obj" as="num_obj" used="1" key="0" type="number" title="Номер объекта договора" agg="list" sourcetable="./teh/kod_numobj" sourcecolumn="num_obj" into="n2">teh.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="teh" column="name" as="name" type="string" used="1" key="0" title="Номер объекта договора" agg="list" sourcetable="./teh/kod_numobj" sourcecolumn="num_obj" into="s1">teh.name as name, /*Номер объекта договора*//*string*/
</column><column table="teh" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./teh/kod_numobj" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n3">teh.kod_dog as kod_dog, /*number*/
</column><column table="teh" column="dakt_go" as="dakt_go" used="1" key="0" type="date" sourcetable="./teh/a" sourcecolumn="dakt_go" into="d1">teh.dakt_go as dakt_go, /*date*/
</column><column table="teh" column="dakt_gpp" as="dakt_gpp" used="1" key="0" type="date" sourcetable="./teh/a" sourcecolumn="dakt_gpp" into="d2">teh.dakt_gpp as dakt_gpp, /*date*/
</column><column table="teh" column="dakt_gotov" as="dakt_gotov" used="1" key="0" type="date" sourcetable="./teh/a" sourcecolumn="dakt_gotov" into="d3">teh.dakt_gotov as dakt_gotov, /*date*/
</column><column table="teh" column="dpassp_gotov" as="dpassp_gotov" used="1" key="0" type="date" sourcetable="./teh/a" sourcecolumn="dpassp_gotov" into="d4">teh.dpassp_gotov as dpassp_gotov, /*date*/
</column><column table="teh" column="d_zayav" as="d_zayav" used="1" key="0" type="date" sourcetable="./teh/b" sourcecolumn="d_zayav" into="d5">teh.d_zayav as d_zayav, /*date*/
</column><column table="teh" column="pusk_tep" as="pusk_tep" used="1" key="0" type="date" sourcetable="./teh/b" sourcecolumn="pusk_tep" into="d6">teh.pusk_tep as pusk_tep, /*date*/
</column><column table="teh" column="otkl_tep" as="otkl_tep" used="1" key="0" type="date" sourcetable="./teh/b" sourcecolumn="otkl_tep" into="d7">teh.otkl_tep as otkl_tep, /*date*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-teh" as="teh" path="./teh" order="num_obj" haskeys="1" used="1">(
<order notext="1"><column column="num_obj">num_obj</column></order><select>--36703-teh
select <column table="kod_numobj" column="kod_numobj" group="1" as="kod_numobj" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./teh/kod_numobj" sourcecolumn="kod_numobj">kod_numobj.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="kod_numobj" column="num_obj" group="max" as="num_obj" key="0" used="1" type="number" title="Номер объекта договора" agg="list" sourcetable="./teh/kod_numobj" sourcecolumn="num_obj">max(kod_numobj.num_obj)  as num_obj, /*Номер объекта договора*//*number*/
</column><call function="||" as="name" key="0" group="max" pth="" type="string" used="1" title="Номер объекта договора" agg="list" sourcetable="./teh/kod_numobj" sourcecolumn="num_obj">max(<column table="kod_numobj" column="num_obj">kod_numobj.num_obj</column><text txtype="func"> || </text><const><text>'. '</text></const><text txtype="func"> || </text><column table="kod_numobj" column="name">kod_numobj.name</column>)  as name, /*Номер объекта договора*//*string*/
</call><column table="kod_numobj" column="kod_dog" group="max" as="kod_dog" key="0" used="1" type="number" sourcetable="./teh/kod_numobj" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">max(kod_numobj.kod_dog)  as kod_dog, /*number*/
</column><column table="a" column="dakt_go" group="max" as="dakt_go" key="0" used="1" type="date" sourcetable="./teh/a" sourcecolumn="dakt_go">max(a.dakt_go)  as dakt_go, /*date*/
</column><column table="a" column="dakt_gpp" group="max" as="dakt_gpp" key="0" used="1" type="date" sourcetable="./teh/a" sourcecolumn="dakt_gpp">max(a.dakt_gpp)  as dakt_gpp, /*date*/
</column><column table="a" column="dakt_gotov" group="max" as="dakt_gotov" key="0" used="1" type="date" sourcetable="./teh/a" sourcecolumn="dakt_gotov">max(a.dakt_gotov)  as dakt_gotov, /*date*/
</column><column table="a" column="dpassp_gotov" group="max" as="dpassp_gotov" key="0" used="1" type="date" sourcetable="./teh/a" sourcecolumn="dpassp_gotov">max(a.dpassp_gotov)  as dpassp_gotov, /*date*/
</column><column table="b" column="d_zayav" group="max" as="d_zayav" key="0" used="1" type="date" sourcetable="./teh/b" sourcecolumn="d_zayav">max(b.d_zayav)  as d_zayav, /*date*/
</column><column table="b" column="pusk_tep" group="max" as="pusk_tep" key="0" used="1" type="date" sourcetable="./teh/b" sourcecolumn="pusk_tep">max(b.pusk_tep)  as pusk_tep, /*date*/
</column><column table="b" column="otkl_tep" group="max" as="otkl_tep" key="0" used="1" type="date" sourcetable="./teh/b" sourcecolumn="otkl_tep">max(b.otkl_tep)  as otkl_tep/*date*/
</column></select><from>
from <query name="kr_numobj" as="kod_numobj" path="./teh/kod_numobj" haskeys="1" used="1">(
<select>--kr_numobj
select <column table="a" column="kod_numobj" type="number" comment="код объекта в договоре" key-dimension="kod_numobj" fact="kr_numobj_kod_numobj" agg="max" as="kod_numobj" key="1" fixed="1" sourcetable="./teh/kod_numobj" sourcecolumn="kod_numobj" used="1">a.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="a" column="pr_active" type="number" title="" as="pr_active" reference="kk_active" refcol="pr_active" key="0" sourcetable="./teh/kod_numobj" sourcecolumn="pr_active" used="1">a.pr_active as pr_active, /**//*number*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./teh/kod_numobj" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_parent_sa" type="number" comment="код объекта договора которому принадлежит субабонет (если он not null, значит объект договора - субабонент )" as="kod_parent_sa" reference="kr_numobj" refcol="kod_numobj" key="0" sourcetable="./teh/kod_numobj" sourcecolumn="kod_parent_sa" used="1">a.kod_parent_sa as kod_parent_sa, /*number*/
</column><column table="a" column="num_obj" type="number" title="Номер объекта договора" comment="номер объекта в списке объектов договора" is-fact="1" agg="list" as="num_obj" fact="kr_numobj_num_obj" key="0" sourcetable="./teh/kod_numobj" sourcecolumn="num_obj" used="1">a.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="a" column="name" type="string" title="Наименование объекта договора" comment="наименование объекта в текущем договоре" as="name" key="0" sourcetable="./teh/kod_numobj" sourcecolumn="name" used="1">a.name as name/*Наименование объекта договора*//*string*/
</column></select><from>
from <table name="kr_numobj" as="a" used="1">kr_numobj
a
--\kr_numobj
</table></from>)
kod_numobj
--\kr_numobj
</query><query name="kr_dogovor" as="kod_dog" join="left outer" path="./teh/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./teh/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./teh/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_numobj" column="kod_dog">kod_numobj.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="br_oto_tu" as="b" join="left outer" path="./teh/b" haskeys="1" used="1">left outer join
(
<select>--br_oto_tu
select <column table="a" column="kod_numobj" type="number" comment="FK на kr_numobj" as="kod_numobj" reference="kr_numobj" refcol="kod_numobj" key="0" sourcetable="./teh/b" sourcecolumn="kod_numobj" used="1">a.kod_numobj as kod_numobj, /*number*/
</column><column table="a" column="d_zayav" type="date" title="" comment="Дата поступления заявки на включение" as="d_zayav" key="0" sourcetable="./teh/b" sourcecolumn="d_zayav" used="1">a.d_zayav as d_zayav, /**//*date*/
</column><column table="a" column="pusk_tep" type="date" title="" comment="Фактическая дата включения" as="pusk_tep" key="0" sourcetable="./teh/b" sourcecolumn="pusk_tep" used="1">a.pusk_tep as pusk_tep, /**//*date*/
</column><column table="a" column="otkl_tep" type="date" title="" comment="Фактическая дата отключения" as="otkl_tep" key="0" sourcetable="./teh/b" sourcecolumn="otkl_tep" used="1">a.otkl_tep as otkl_tep/**//*date*/
</column></select><from>
from <table name="br_oto_tu" as="a" used="1">br_oto_tu
a
--\br_oto_tu
</table></from><call function="=" type="bool">)
b on <column table="b" column="kod_numobj">b.kod_numobj</column><text txtype="func"> = </text><column table="kod_numobj" column="kod_numobj">kod_numobj.kod_numobj</column></call>--\br_oto_tu
</query><query name="br_oto_obj" as="a" join="left outer" path="./teh/a" haskeys="1" used="1">left outer join
(
<select>--br_oto_obj
select <column table="a" column="kod_numobj" type="number" as="kod_numobj" reference="kr_numobj" refcol="kod_numobj" key="0" sourcetable="./teh/a" sourcecolumn="kod_numobj" used="1">a.kod_numobj as kod_numobj, /*number*/
</column><column table="a" column="dakt_gotov" type="date" title="" comment="наличие акта готовности(дата)" as="dakt_gotov" key="0" sourcetable="./teh/a" sourcecolumn="dakt_gotov" used="1">a.dakt_gotov as dakt_gotov, /**//*date*/
</column><column table="a" column="dakt_go" type="date" title="" comment="наличие акта гидравлической опрессовки" as="dakt_go" key="0" sourcetable="./teh/a" sourcecolumn="dakt_go" used="1">a.dakt_go as dakt_go, /**//*date*/
</column><column table="a" column="dakt_gpp" type="date" title="" comment="наличие акта гидропневмопромывки" as="dakt_gpp" key="0" sourcetable="./teh/a" sourcecolumn="dakt_gpp" used="1">a.dakt_gpp as dakt_gpp, /**//*date*/
</column><column table="a" column="dpassp_gotov" type="date" title="" as="dpassp_gotov" key="0" sourcetable="./teh/a" sourcecolumn="dpassp_gotov" used="1">a.dpassp_gotov as dpassp_gotov/**//*date*/
</column></select><from>
from <table name="(select * from br_oto_obj oc  union select * from br_oto_obj_arc oa)" as="a" comment="лень" used="1">(select * from br_oto_obj oc  union select * from br_oto_obj_arc oa)
a
--\(select * from br_oto_obj oc  union select * from br_oto_obj_arc oa)
</table></from><call function="=" type="bool">)
a on <column table="a" column="kod_numobj">a.kod_numobj</column><text txtype="func"> = </text><column table="kod_numobj" column="kod_numobj">kod_numobj.kod_numobj</column></call>--\br_oto_obj
</query></from><where>where
<call function="and" pth="" type="bool"><call function="and" pth="" type="bool">(<call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="kod_numobj" column="pr_active">kod_numobj.pr_active</column><text txtype="func"> != </text><const><text>1</text></const>) </call><text txtype="func"> and </text><call function="is null" pth="" type="bool">(<column table="kod_numobj" column="kod_parent_sa">kod_numobj.kod_parent_sa</column><text txtype="func"> is null </text>) </call></call></where><group> group by
<column table="kod_numobj" column="kod_numobj" group="1" as="kod_numobj" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./teh/kod_numobj" sourcecolumn="kod_numobj">kod_numobj.kod_numobj/*number*//*key*/
</column></group><order>
order by num_obj</order>)
teh
--\36703-teh
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="teh" column="kod_dog">teh.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by num_obj</order>) mtr
;
--\36703-teh
</query>
  <query name="q36703_32_grouped_pret" noname="1" materialize="1" path="." used="1">
delete from rr_temp where skod = 'q36703_32_grouped_pret';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
n1, --kod_pret
n2, --kod_dog
s1, --dat_form
n3, --dolg_osn_real
n4, --dolg_gp
n5, --dolg_peni
n6, --dolg_sud_peni
n7, --dolg_astr
n8, --dolg_othr
s2, --dolg_detail_string
s3, --dolg_total
s4, --period_string
n9, --sf_count
n10, --cnt_pret
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="n1" info="kod_pret" /><column column="n2" info="kod_dog" /><column column="s1" info="dat_form" /><column column="n3" info="dolg_osn_real" /><column column="n4" info="dolg_gp" /><column column="n5" info="dolg_peni" /><column column="n6" info="dolg_sud_peni" /><column column="n7" info="dolg_astr" /><column column="n8" info="dolg_othr" /><column column="s2" info="dolg_detail_string" /><column column="s3" info="dolg_total" /><column column="s4" info="period_string" /><column column="n9" info="sf_count" /><column column="n10" info="cnt_pret" /><column column="sparentid" info="sparentid" />--q36703_32_grouped_pret
</insert><select>--q36703_32_grouped_pret
select 'q36703_32_grouped_pret' as skod,
'q36703_32_grouped_pret|#'||mtr.kod_pret as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="pret" column="kod_pret" as="kod_pret" title="Договор" fixed="1" keypath=".kod_pret" used="1" key="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret" into="n1">pret.kod_pret as kod_pret, /*Договор*//*number*//*key*/
</column><column table="pret" column="kod_dog" as="kod_dog" title="Договор" used="1" key="0" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2">pret.kod_dog as kod_dog, /*Договор*//*number*/
</column><column table="pret" column="dat_form" as="dat_form" type="string" used="1" key="0" title="Дата формирования" agg="max" sourcetable="./pret/a/a/p" sourcecolumn="dat_form" into="s1">pret.dat_form as dat_form, /*Дата формирования*//*string*/
</column><column table="pret" column="dolg_osn_real" as="dolg_osn_real" used="1" key="0" type="number" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real" into="n3">pret.dolg_osn_real as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="pret" column="dolg_gp" as="dolg_gp" used="1" key="0" type="number" title="Сальдо_по_госпошлине  " sourcetable="./pret/a/a/ps" sourcecolumn="dolg_gp" into="n4">pret.dolg_gp as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="pret" column="dolg_peni" as="dolg_peni" used="1" key="0" type="number" title="Начисленные_пени" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_peni" into="n5">pret.dolg_peni as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="pret" column="dolg_sud_peni" as="dolg_sud_peni" used="1" key="0" type="number" title="Сальдо_по_взысканным_процентам" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_sud_peni" into="n6">pret.dolg_sud_peni as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="pret" column="dolg_astr" as="dolg_astr" used="1" key="0" type="number" title="Сальдо_по_астренту" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_astr" into="n7">pret.dolg_astr as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="pret" column="dolg_othr" as="dolg_othr" used="1" key="0" type="number" title="Иные виды задолженности" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_othr" into="n8">pret.dolg_othr as dolg_othr, /*Иные виды задолженности*//*number*/
</column><column table="pret" column="dolg_detail_string" as="dolg_detail_string" type="string" used="1" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real" into="s2">pret.dolg_detail_string as dolg_detail_string, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="dolg_total" as="dolg_total" type="string" used="1" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real" into="s3">pret.dolg_total as dolg_total, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="period_string" as="period_string" type="string" used="1" key="0" title="Отчетный период начисления" format="F2" sourcetable="./pret/a/a/s" sourcecolumn="ym" into="s4">pret.period_string as period_string, /*Отчетный период начисления*//*string*/
</column><column table="pret" column="sf_count" as="sf_count" title="Количество с/ф" used="1" key="0" type="number" sourcetable="./pret/a/a/ps" sourcecolumn="kod_pret_dolg_sf" into="n9">pret.sf_count as sf_count, /*Количество с/ф*//*number*/
</column><column table="pret" column="cnt_pret" as="cnt_pret" type="number" used="1" key="0" title="Договор" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret" into="n10">pret.cnt_pret as cnt_pret, /*Договор*//*number*/
</column><column table="dog" column="sid" as="sparentid" used="1" key="0" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="q36703_32_grouped_pret" as="pret" path="./pret" haskeys="1" used="1">(
<select>--q36703_32_grouped_pret
select <column table="a" column="kod_pret" group="1" title="Договор" as="kod_pret" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret">a.kod_pret as kod_pret, /*Договор*//*number*//*key*/
</column><column table="a" column="kod_dog" group="max" title="Договор" as="kod_dog" key="0" used="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">max(a.kod_dog)  as kod_dog, /*Договор*//*number*/
</column><call function="substr" as="dat_form" key="0" pth="" type="string" used="1" title="Дата формирования" agg="max" sourcetable="./pret/a/a/p" sourcecolumn="dat_form"><text txtype="func"> SUBSTR( </text><call function="date to char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="a" column="dat_form" group="1">a.dat_form</column><text txtype="func"> ,'DD.MM.YYYY') </text>) </call><text txtype="func"> , </text><const type="number"><text>1</text></const><text txtype="func"> , </text><const type="number"><text>10</text></const><text txtype="func"> ) </text> as dat_form, /*Дата формирования*//*string*/
</call><column table="a" column="dolg_osn_real" group="sum" as="dolg_osn_real" key="0" used="1" type="number" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real">sum(a.dolg_osn_real)  as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="a" column="dolg_gp" group="sum" as="dolg_gp" key="0" used="1" type="number" title="Сальдо_по_госпошлине  " sourcetable="./pret/a/a/ps" sourcecolumn="dolg_gp">sum(a.dolg_gp)  as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="a" column="dolg_peni" group="sum" as="dolg_peni" key="0" used="1" type="number" title="Начисленные_пени" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_peni">sum(a.dolg_peni)  as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="a" column="dolg_sud_peni" group="sum" as="dolg_sud_peni" key="0" used="1" type="number" title="Сальдо_по_взысканным_процентам" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_sud_peni">sum(a.dolg_sud_peni)  as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="a" column="dolg_astr" group="sum" as="dolg_astr" key="0" used="1" type="number" title="Сальдо_по_астренту" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_astr">sum(a.dolg_astr)  as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="a" column="dolg_othr" group="sum" as="dolg_othr" key="0" used="1" type="number" title="Иные виды задолженности" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_othr">sum(a.dolg_othr)  as dolg_othr, /*Иные виды задолженности*//*number*/
</column><call function="substr" as="dolg_detail_string" key="0" pth="" type="string" used="1" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real"><text txtype="func"> SUBSTR( </text><call function="||" pth="" type="string">(<call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_osn_real" group="sum">sum(a.dolg_osn_real) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', основной долг  '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_osn_real" group="sum">sum(a.dolg_osn_real) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_gp" group="sum">sum(a.dolg_gp) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', госпошлина  '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_gp" group="sum">sum(a.dolg_gp) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_peni" group="sum">sum(a.dolg_peni) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', пени - '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_peni" group="sum">sum(a.dolg_peni) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_sud_peni" group="sum">sum(a.dolg_sud_peni) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', взысканные проценты  '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_sud_peni" group="sum">sum(a.dolg_sud_peni) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_astr" group="sum">sum(a.dolg_astr) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', астрент '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_astr" group="sum">sum(a.dolg_astr) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<column table="a" column="dolg_othr" group="sum">sum(a.dolg_othr) </column><text txtype="func"> &gt; </text><const type="number"><text>0</text></const>) </call><text txtype="func"> then </text><call function="||" pth="" type="string">(<const type="string"><text>', иное  '</text></const><text txtype="func"> || </text><call type="string" function="number_to_currency_string" pth="">(<text txtype="func"> to_char( </text><column table="a" column="dolg_othr" group="sum">sum(a.dolg_othr) </column><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text>) </call><text txtype="func"> || </text><const type="string"><text>' р.'</text></const>) </call><text txtype="func"> end </text>) </call>) </call><text txtype="func"> , </text><const type="number"><text>2</text></const><text txtype="func"> ) </text> as dolg_detail_string, /*Сальдо_по_основной_реализации*//*string*/
</call><call function="number_to_currency_string" as="dolg_total" key="0" pth="" type="string" used="1" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real"><text txtype="func"> to_char( </text><call function="+" pth="" type="number">(<text txtype="func"> nvl( </text><column table="a" column="dolg_osn_real" group="sum">sum(a.dolg_osn_real) </column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="dolg_gp" group="sum">sum(a.dolg_gp) </column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="dolg_peni" group="sum">sum(a.dolg_peni) </column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="dolg_sud_peni" group="sum">sum(a.dolg_sud_peni) </column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="dolg_astr" group="sum">sum(a.dolg_astr) </column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="dolg_othr" group="sum">sum(a.dolg_othr) </column><text txtype="func"> ,0) </text>) </call><text txtype="func"> , 'FM99G999G999G999G999D00', 'NLS_NUMERIC_CHARACTERS = ''. ''' ) </text> as dolg_total, /*Сальдо_по_основной_реализации*//*string*/
</call><call function="vg_period.ym_enum_str_to_date_ranges_str" as="period_string" key="0" pth="" type="string" used="1" title="Отчетный период начисления" format="F2" sourcetable="./pret/a/a/s" sourcecolumn="ym"><text txtype="func"> vg_period.ym_enum_str_to_date_ranges_str( </text><column table="a" column="period_string" group="stragg_dist">stragg_dist(a.period_string) </column><text txtype="func"> ) </text> as period_string, /*Отчетный период начисления*//*string*/
</call><column table="a" column="kod_pret_dolg_sf" group="count" as="sf_count" title="Количество с/ф" key="0" used="1" type="number" sourcetable="./pret/a/a/ps" sourcecolumn="kod_pret_dolg_sf">count(a.kod_pret_dolg_sf)  as sf_count, /*Количество с/ф*//*number*/
</column><call function="over" as="cnt_pret" type="number" key="0" pth="0" used="1" title="Договор" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret"><call function="count" pth="0" type="aggregate"><text txtype="func"> count( </text><column table="a" column="kod_pret" title="Договор" as="kod_pret" key="1" fixed="1" thissrc="kod_pret">a.kod_pret</column><text txtype="func"> ) </text></call><text txtype="func"> over( </text><call function="partition by" pth="0" type="partition"><text txtype="func"> partition by </text><column table="a" column="kod_dog" group="max" title="Договор" as="kod_dog" key="0" thissrc="kod_dog">max(a.kod_dog) </column></call><text txtype="func"> ) </text> as cnt_pret/*Договор*//*number*/
</call></select><from>
from <query name="q36703_32" as="a" path="./pret/a" used="1">(
<select>--q36703_32
select <column table="a" column="kod_pret_dolg_sf" as="kod_pret_dolg_sf" keypath=".kod_pret_dolg_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/ps" sourcecolumn="kod_pret_dolg_sf">a.kod_pret_dolg_sf as kod_pret_dolg_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="period_string" as="period_string" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./pret/a/a/s" sourcecolumn="ym">a.period_string as period_string, /*Отчетный период начисления*//*number*/
</column><column table="a" column="dat_form" as="dat_form" used="1" key="0" type="date" title="Дата формирования" agg="max" sourcetable="./pret/a/a/p" sourcecolumn="dat_form">a.dat_form as dat_form, /*Дата формирования*//*date*/
</column><column table="a" column="kod_pret" as="kod_pret" keypath=".kod_pret" used="1" key="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret">a.kod_pret as kod_pret, /*number*//*key*/
</column><column table="a" column="dolg_osn_real" as="dolg_osn_real" type="number" used="1" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real">a.dolg_osn_real as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="a" column="dolg_gp" as="dolg_gp" type="number" used="1" key="0" title="Сальдо_по_госпошлине  " sourcetable="./pret/a/a/ps" sourcecolumn="dolg_gp">a.dolg_gp as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="a" column="dolg_peni" as="dolg_peni" type="number" used="1" key="0" title="Начисленные_пени" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_peni">a.dolg_peni as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="a" column="dolg_sud_peni" as="dolg_sud_peni" type="number" used="1" key="0" title="Сальдо_по_взысканным_процентам" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_sud_peni">a.dolg_sud_peni as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="a" column="dolg_astr" as="dolg_astr" type="number" used="1" key="0" title="Сальдо_по_астренту" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_astr">a.dolg_astr as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="a" column="dolg_othr" as="dolg_othr" type="number" used="1" key="0" title="Иные виды задолженности" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_othr">a.dolg_othr as dolg_othr, /*Иные виды задолженности*//*number*/
</column><call function="over" as="pr_pret_with_last_and_dolg_sf" type="number" pth="0" used="1" key="0" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret"><call function="max" pth="0" type="aggregate"><text txtype="func"> max( </text><column table="a" column="pr_last_and_dolg" as="pr_last_and_dolg" type="number" key="0" thissrc="pr_last_and_dolg">a.pr_last_and_dolg</column><text txtype="func"> ) </text></call><text txtype="func"> over( </text><call function="partition by" pth="0" type="partition"><text txtype="func"> partition by </text><column table="a" column="kod_pret" as="kod_pret" key="0" thissrc="kod_pret">a.kod_pret</column></call><text txtype="func"> ) </text> as pr_pret_with_last_and_dolg_sf/*number*/
</call></select><from>
from <query name="q36703_32_pre" as="a" path="./pret/a/a" used="1">(
<select>--q36703_32_pre
select <column table="ps" column="kod_pret_dolg_sf" as="kod_pret_dolg_sf" keypath=".kod_pret_dolg_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/ps" sourcecolumn="kod_pret_dolg_sf">ps.kod_pret_dolg_sf as kod_pret_dolg_sf, /*number*//*key*/
</column><column table="p" column="kod_dog" as="kod_dog" used="1" key="0" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">p.kod_dog as kod_dog, /*number*/
</column><call function="if" as="period_string" pth="" used="1" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./pret/a/a/s" sourcecolumn="ym"><text txtype="func"> case </text><text txtype="func"> when </text><call function="!=" pth="" type="bool">(<const type="number"><text>0</text></const><text txtype="func"> != </text><call function="nvl0" pth="" type="number">(<text txtype="func"> nvl( </text><column table="ps" column="dolg_osn_real">ps.dolg_osn_real</column><text txtype="func"> ,0) </text>) </call>) </call><text txtype="func"> then </text><column table="s" column="ym">s.ym</column><text txtype="func"> end </text> as period_string, /*Отчетный период начисления*//*number*/
</call><column table="p" column="dat_form" as="dat_form" used="1" key="0" type="date" title="Дата формирования" agg="max" sourcetable="./pret/a/a/p" sourcecolumn="dat_form">p.dat_form as dat_form, /*Дата формирования*//*date*/
</column><column table="p" column="kod_pret" as="kod_pret" reference="kr_pret" refcol="kod_pret" keypath=".kod_pret" used="1" key="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret">p.kod_pret as kod_pret, /*number*//*key*/
</column><call function="nvl0" as="dolg_osn_real" pth="" type="number" used="1" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real"><text txtype="func"> nvl( </text><column table="ps" column="dolg_osn_real">ps.dolg_osn_real</column><text txtype="func"> ,0) </text> as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</call><call function="nvl0" as="dolg_gp" pth="" type="number" used="1" key="0" title="Сальдо_по_госпошлине  " sourcetable="./pret/a/a/ps" sourcecolumn="dolg_gp"><text txtype="func"> nvl( </text><column table="ps" column="dolg_gp">ps.dolg_gp</column><text txtype="func"> ,0) </text> as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</call><call function="nvl0" as="dolg_peni" pth="" type="number" used="1" key="0" title="Начисленные_пени" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_peni"><text txtype="func"> nvl( </text><column table="ps" column="dolg_peni">ps.dolg_peni</column><text txtype="func"> ,0) </text> as dolg_peni, /*Начисленные_пени*//*number*/
</call><call function="nvl0" as="dolg_sud_peni" pth="" type="number" used="1" key="0" title="Сальдо_по_взысканным_процентам" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_sud_peni"><text txtype="func"> nvl( </text><column table="ps" column="dolg_sud_peni">ps.dolg_sud_peni</column><text txtype="func"> ,0) </text> as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</call><call function="nvl0" as="dolg_astr" pth="" type="number" used="1" key="0" title="Сальдо_по_астренту" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_astr"><text txtype="func"> nvl( </text><column table="ps" column="dolg_astr">ps.dolg_astr</column><text txtype="func"> ,0) </text> as dolg_astr, /*Сальдо_по_астренту*//*number*/
</call><call function="nvl0" as="dolg_othr" pth="" type="number" used="1" key="0" title="Иные виды задолженности" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_othr"><text txtype="func"> nvl( </text><column table="ps" column="dolg_othr">ps.dolg_othr</column><text txtype="func"> ,0) </text> as dolg_othr, /*Иные виды задолженности*//*number*/
</call><call function="if" as="pr_last_and_dolg" type="number" pth="" used="1" key="0"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="gt" pth="" type="bool">(<column column="fin_ul_ob1" as="fin_ul_ob" is-fact-use="1" thissrc="fin_ul_ob" table="qube">qube.fin_ul_ob1</column><text txtype="func"> &gt; </text><const><text>0</text></const>) </call><text txtype="func"> and </text><call function="=1" pth="1" type="bool">(<text txtype="func"> nvl( </text><call function="dense_rank" as="pret_order" pth="" type="number">(<text txtype="func"> dense_rank() over( </text><call function="partition by" pth="0" type="partition"><text txtype="func"> partition by </text><column table="p" column="kod_dog">p.kod_dog</column></call><call function="order by 2" pth="0" type="order"><text txtype="func"> order by </text><call function="desc" pth="0"><column table="p" column="dat_form">p.dat_form</column><text txtype="func"> desc </text></call></call><text txtype="func"> ) </text>) </call><text txtype="func"> ,0)=1 </text>) </call>) </call><text txtype="func"> then </text><const><text>1</text></const><text txtype="func"> end </text> as pr_last_and_dolg/*number*/
</call></select><from>
from <query haskeys="1" as="qube" path="./pret/a/a/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="vr_pret_dolg_sf" group="1" as="vr_pret_dolg_sf" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">qube.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*//*key*/
</column><column table="qube" column="kr_pret" group="1" as="kr_pret" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">qube.kr_pret as kr_pret, /*number*//*key*/
</column><call function="-nvl" as="fin_ul_ob1" title="Оборот" key="0" group="sum" pth="" type="number" used="1" agg="sum" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(<text txtype="func"> nvl( </text><column table="qube" column="sr_facras_nachisl1">qube.sr_facras_nachisl1</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="qube" column="sr_opl_opl_sf1">qube.sr_opl_opl_sf1</column><text txtype="func"> ,0) </text>)  as fin_ul_ob1/*Оборот*//*number*/
</call></select><from>
from <query as="qube" path="./pret/a/a/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf" as="kod_sf" keypath=".kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="vr_pret_dolg_sf" as="vr_pret_dolg_sf" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">qube.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*/
</column><column table="qube" column="kr_pret" as="kr_pret" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">qube.kr_pret as kr_pret, /*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="qube" path="./pret/a/a/qube/qube/qube" used="1">(
<query path="./pret/a/a/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./pret/a/a/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf as kod_sf, /*number*//*key*/
</column><column table="qube" column="kr_pret" as="kr_pret" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">qube.kr_pret as kr_pret, /*number*/
</column><column table="qube" column="vr_pret_dolg_sf" as="vr_pret_dolg_sf" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">qube.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*/
</column><column table="qube" column="sr_facras_nachisl1" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">qube.sr_facras_nachisl1 as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="qube" path="./pret/a/a/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf as kod_sf, /*number*//*key*/
</column><column table="un" column="kr_pret" group="1" as="kr_pret" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">un.kr_pret as kr_pret, /*number*//*key*/
</column><column table="un" column="vr_pret_dolg_sf" group="1" as="vr_pret_dolg_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">un.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*//*key*/
</column><column table="un" column="sr_facras_nachisl1" group="sum" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sum(un.sr_facras_nachisl1)  as sr_facras_nachisl1, /*Начислено*//*number*/
</column><column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf1)  as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="un" path="./pret/a/a/qube/qube/qube/qube/qube/un" used="1">(
<query path="./pret/a/a/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./pret/a/a/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*//*key*/
</column><column table="dims" column="kr_pret" as="kr_pret" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">dims.kr_pret as kr_pret, /*number*/
</column><column table="dims" column="vr_pret_dolg_sf" as="vr_pret_dolg_sf" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">dims.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*/
</column><column table="sr_facras" column="nachisl" as="sr_facras_nachisl1" used="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl">sr_facras.nachisl as sr_facras_nachisl1, /*Начислено*//*number*/
</column><const type="number" as="sr_opl_opl_sf1" used="1" key="0"><text>null</text> as sr_opl_opl_sf1/*number*/
</const></select><from>
from <query as="dims" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras as kod_ras_prm, /*number*//*key*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="p" column="kod_pret" as="kr_pret" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">p.kod_pret as kr_pret, /*number*//*key*/
</column><column table="ps" column="kod_pret_dolg_sf" as="vr_pret_dolg_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">ps.kod_pret_dolg_sf as vr_pret_dolg_sf/*number*//*key*/
</column></select><from>
from <query name="sr_facras" dimension="kod_ras" as="sr_facras_a_d" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" haskeys="1" used="1">(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where>)
sr_facras_a_d
--\sr_facras
</query><query name="sr_facvip" dimension="kod_sf" as="s" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kodp" type="number" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" sourcecolumn="kodp" used="1">a.kodp as kodp, /*number*/
</column><call function="if" as="dat_rep" type="date" key="0" pth="" used="1" title="Дата документа начисления"><text txtype="func"> case </text><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="lt" pth="" type="bool">(<call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> ,'YYYYMM'))/100 </text>) </call><text txtype="func"> &lt; </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column>) </call><text txtype="func"> and </text><call function="!=" pth="" type="bool">(<column table="a" column="vid_real" type="number" fact="sf_vid_real" agg="max" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" thissrc="vid_real">a.vid_real</column><text txtype="func"> != </text><const><text>0</text></const>) </call>) </call><text txtype="func"> then </text><call function="ym end day" pth="" type="date">(<text txtype="func"> LAST_DAY(to_date( </text><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" thissrc="ym">a.ym</column><text txtype="func"> *100,'YYYYMM')) </text>) </call><text txtype="func"> else </text><column table="a" column="dat_sf" type="date" title="Дата документа начисления" as="dat_sf" key="0" thissrc="dat_sf">a.dat_sf</column><text txtype="func"> end </text> as dat_rep/*Дата документа начисления*//*date*/
</call></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
s on <column table="sr_facras_a_d" column="kod_sf">sr_facras_a_d.kod_sf</column><text txtype="func"> = </text><column table="s" column="kod_sf">s.kod_sf</column></call>--\sr_facvip
</query><query name="vr_pret_dolg_sf" dimension="vr_pret_dolg_sf" as="ps" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" haskeys="1" used="1">left outer join
(
<select>--vr_pret_dolg_sf
select <column table="a" column="kod_pret_dolg_sf" type="number" key="1" as="kod_pret_dolg_sf" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf" used="1">a.kod_pret_dolg_sf as kod_pret_dolg_sf, /*number*//*key*/
</column><column table="a" column="kod_pret_dolg_dog" type="number" as="kod_pret_dolg_dog" reference="vr_pret_dolg_dog" refcol="kod_pret_dolg_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog, /*number*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vr_pret_dolg_sf" as="a" dimension="vr_pret_dolg_sf" used="1">vr_pret_dolg_sf
a
--\vr_pret_dolg_sf
</table></from><call function="=" type="bool">)
ps on <column table="ps" column="kod_sf">ps.kod_sf</column><text txtype="func"> = </text><column table="s" column="kod_sf">s.kod_sf</column></call>--\vr_pret_dolg_sf
</query><query name="vr_pret_dolg_dog" dimension="vr_pret_dolg_dog" as="vr_pret_dolg_dog_a_d" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/vr_pret_dolg_dog_a_d" haskeys="1" used="1">left outer join
(
<select>--vr_pret_dolg_dog
select <column table="a" column="kod_pret_dolg_dog" type="number" key="1" as="kod_pret_dolg_dog" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/vr_pret_dolg_dog_a_d" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog/*number*//*key*/
</column></select><from>
from <table name="vr_pret_dolg_dog" as="a" dimension="vr_pret_dolg_dog" used="1">vr_pret_dolg_dog
a
--\vr_pret_dolg_dog
</table></from><call function="=" type="bool">)
vr_pret_dolg_dog_a_d on <column table="ps" column="kod_pret_dolg_dog">ps.kod_pret_dolg_dog</column><text txtype="func"> = </text><column table="vr_pret_dolg_dog_a_d" column="kod_pret_dolg_dog">vr_pret_dolg_dog_a_d.kod_pret_dolg_dog</column></call>--\vr_pret_dolg_dog
</query><query name="kr_pret" dimension="kr_pret" as="p" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" haskeys="1" used="1">left outer join
(
<select>--kr_pret
select <column table="a" column="kod_pret" type="number" comment="код претензии" as="kod_pret" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret" used="1">a.kod_pret as kod_pret, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" vid="1" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="dat_form" type="date" title="Дата формирования" comment="дата формирования претензии" agg="max" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" as="dat_form" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="dat_form" used="1">a.dat_form as dat_form, /*Дата формирования*//*date*/
</column><column table="a" column="kod_pret_dolg_dog" type="number" comment="ссылка на задолженность" as="kod_pret_dolg_dog" reference="vr_pret_dolg_dog" refcol="kod_pret_dolg_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog/*number*/
</column></select><from>
from <table name="kr_pret" as="a" title="Претензия" dimension="kr_pret" used="1">kr_pret
a
--\kr_pret
</table></from><call function="=" type="bool">)
p on <column table="p" column="kod_pret_dolg_dog">p.kod_pret_dolg_dog</column><text txtype="func"> = </text><column table="vr_pret_dolg_dog_a_d" column="kod_pret_dolg_dog">vr_pret_dolg_dog_a_d.kod_pret_dolg_dog</column></call>--\kr_pret
</query></from><where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<column table="s" column="dat_rep">s.dat_rep</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="p" column="kod_dog">p.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="s" column="kodp">s.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="p" column="dat_form">p.dat_form</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call></call></where><group> group by
<column table="sr_facras_a_d" column="kod_ras" as="kod_ras_prm" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_ras">sr_facras_a_d.kod_ras, /*number*//*key*/
</column><column table="sr_facras_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_facras_a_d.kod_sf, /*number*//*key*/
</column><column table="p" column="kod_pret" as="kr_pret" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">p.kod_pret, /*number*//*key*/
</column><column table="ps" column="kod_pret_dolg_sf" as="vr_pret_dolg_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">ps.kod_pret_dolg_sf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_facras" dimension="kod_ras" as="sr_facras" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" haskeys="1" used="1">left outer join
(
<select>--sr_facras
select <column table="a" column="kod_ras" type="number" key-dimension="kod_ras" as="kod_ras" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="kod_ras" used="1">a.kod_ras as kod_ras, /*number*//*key*/
</column><column table="a" column="nachisl" type="number" title="Начислено" fact="sr_facras_nachisl" agg="sum" as="nachisl" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras" sourcecolumn="nachisl" used="1">a.nachisl as nachisl/*Начислено*//*number*/
</column></select><from>
from <table name="sr_facras" as="a" dimension="kod_ras" used="1">sr_facras
a
--\sr_facras
</table><query name="sr_facvip" dimension="kod_sf" as="kod_sf" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="vid_sf" type="number" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_facras/kod_sf" sourcecolumn="vid_sf" used="1">a.vid_sf as vid_sf/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf on <column table="a" column="kod_sf">a.kod_sf</column><text txtype="func"> = </text><column table="kod_sf" column="kod_sf">kod_sf.kod_sf</column></call>--\sr_facvip
</query></from><where>where
<call function="not in" pth="" type="bool"><column table="kod_sf" column="vid_sf">kod_sf.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
sr_facras on <column table="sr_facras" column="kod_ras">sr_facras.kod_ras</column><text txtype="func"> = </text><column table="dims" column="kod_ras_prm">dims.kod_ras_prm</column></call>--\sr_facras
</query><qubecontent><where>where
<call function="and" condsource="q36703_32_pre"><call function="le">(<column table="d" column="val">d.val</column><const>:dat </const>) </call><call function="in" optional="1">(<column table="p" column="kod_dog">p.kod_dog</column><const>:kod_dog </const>) </call><call function="in" optional="1">(<column table="s" column="kodp">s.kodp</column><const>:kodp </const>) </call><call function="le">(<column table="p" column="dat_form">p.dat_form</column><const>:dat </const>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./pret/a/a/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="kod_sf" as="kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">dims.kod_sf as kod_sf, /*number*//*key*/
</column><column table="dims" column="kr_pret" as="kr_pret" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">dims.kr_pret as kr_pret, /*number*/
</column><column table="dims" column="vr_pret_dolg_sf" as="vr_pret_dolg_sf" used="1" key="0" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">dims.vr_pret_dolg_sf as vr_pret_dolg_sf, /*number*/
</column><const type="number" as="sr_facras_nachisl1" used="1" key="0"><text>null</text> as sr_facras_nachisl1, /*number*/
</const><column table="sr_opl_sf" column="opl_sf" as="sr_opl_opl_sf1" used="1" key="0" type="number" title="Оплата начислений" agg="sum">sr_opl_sf.opl_sf as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="dims" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf as kod_sf, /*number*//*key*/
</column><column table="p" column="kod_pret" as="kr_pret" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">p.kod_pret as kr_pret, /*number*//*key*/
</column><column table="ps" column="kod_pret_dolg_sf" as="vr_pret_dolg_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">ps.kod_pret_dolg_sf as vr_pret_dolg_sf/*number*//*key*/
</column></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="s" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kodp" type="number" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/s" sourcecolumn="kodp" used="1">a.kodp as kodp/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
s on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="s" column="kod_sf">s.kod_sf</column></call>--\sr_facvip
</query><query name="vr_pret_dolg_sf" dimension="vr_pret_dolg_sf" as="ps" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" haskeys="1" used="1">left outer join
(
<select>--vr_pret_dolg_sf
select <column table="a" column="kod_pret_dolg_sf" type="number" key="1" as="kod_pret_dolg_sf" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf" used="1">a.kod_pret_dolg_sf as kod_pret_dolg_sf, /*number*//*key*/
</column><column table="a" column="kod_pret_dolg_dog" type="number" as="kod_pret_dolg_dog" reference="vr_pret_dolg_dog" refcol="kod_pret_dolg_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog, /*number*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vr_pret_dolg_sf" as="a" dimension="vr_pret_dolg_sf" used="1">vr_pret_dolg_sf
a
--\vr_pret_dolg_sf
</table></from><call function="=" type="bool">)
ps on <column table="ps" column="kod_sf">ps.kod_sf</column><text txtype="func"> = </text><column table="s" column="kod_sf">s.kod_sf</column></call>--\vr_pret_dolg_sf
</query><query name="vr_pret_dolg_dog" dimension="vr_pret_dolg_dog" as="vr_pret_dolg_dog_a_d" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/vr_pret_dolg_dog_a_d" haskeys="1" used="1">left outer join
(
<select>--vr_pret_dolg_dog
select <column table="a" column="kod_pret_dolg_dog" type="number" key="1" as="kod_pret_dolg_dog" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/vr_pret_dolg_dog_a_d" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog/*number*//*key*/
</column></select><from>
from <table name="vr_pret_dolg_dog" as="a" dimension="vr_pret_dolg_dog" used="1">vr_pret_dolg_dog
a
--\vr_pret_dolg_dog
</table></from><call function="=" type="bool">)
vr_pret_dolg_dog_a_d on <column table="ps" column="kod_pret_dolg_dog">ps.kod_pret_dolg_dog</column><text txtype="func"> = </text><column table="vr_pret_dolg_dog_a_d" column="kod_pret_dolg_dog">vr_pret_dolg_dog_a_d.kod_pret_dolg_dog</column></call>--\vr_pret_dolg_dog
</query><query name="kr_pret" dimension="kr_pret" as="p" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" haskeys="1" used="1">left outer join
(
<select>--kr_pret
select <column table="a" column="kod_pret" type="number" comment="код претензии" as="kod_pret" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret" used="1">a.kod_pret as kod_pret, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" vid="1" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="dat_form" type="date" title="Дата формирования" comment="дата формирования претензии" agg="max" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" as="dat_form" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="dat_form" used="1">a.dat_form as dat_form, /*Дата формирования*//*date*/
</column><column table="a" column="kod_pret_dolg_dog" type="number" comment="ссылка на задолженность" as="kod_pret_dolg_dog" reference="vr_pret_dolg_dog" refcol="kod_pret_dolg_dog" key="0" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret_dolg_dog" used="1">a.kod_pret_dolg_dog as kod_pret_dolg_dog/*number*/
</column></select><from>
from <table name="kr_pret" as="a" title="Претензия" dimension="kr_pret" used="1">kr_pret
a
--\kr_pret
</table></from><call function="=" type="bool">)
p on <column table="p" column="kod_pret_dolg_dog">p.kod_pret_dolg_dog</column><text txtype="func"> = </text><column table="vr_pret_dolg_dog_a_d" column="kod_pret_dolg_dog">vr_pret_dolg_dog_a_d.kod_pret_dolg_dog</column></call>--\kr_pret
</query></from><where>where
<call function="and" pth="" type="bool"><call function="le" pth="" type="bool">(<column table="sr_opl_sf_a_d" column="dat">sr_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="p" column="kod_dog">p.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="s" column="kodp">s.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="p" column="dat_form">p.dat_form</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call></call></where><group> group by
<column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="kod_sf" as="kod_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">sr_opl_sf_a_d.kod_sf, /*number*//*key*/
</column><column table="p" column="kod_pret" as="kr_pret" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">p.kod_pret, /*number*//*key*/
</column><column table="ps" column="kod_pret_dolg_sf" as="vr_pret_dolg_sf" group="1" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">ps.kod_pret_dolg_sf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf" join="left outer" path="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_opl_sf" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/sr_opl_sf" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf/*Оплата начислений*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
sr_opl_sf on <column table="sr_opl_sf" column="kod_opl">sr_opl_sf.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_sf
</query><qubecontent><where>where
<call function="and" condsource="q36703_32_pre"><call function="le">(<column table="d" column="val">d.val</column><const>:dat </const>) </call><call function="in" optional="1">(<column table="p" column="kod_dog">p.kod_dog</column><const>:kod_dog </const>) </call><call function="in" optional="1">(<column table="s" column="kodp">s.kodp</column><const>:kodp </const>) </call><call function="le">(<column table="p" column="dat_form">p.dat_form</column><const>:dat </const>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_sf" group="1" as="kod_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">un.kod_sf, /*number*//*key*/
</column><column table="un" column="kr_pret" group="1" as="kr_pret" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">un.kr_pret, /*number*//*key*/
</column><column table="un" column="vr_pret_dolg_sf" group="1" as="vr_pret_dolg_sf" used="1" key="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">un.vr_pret_dolg_sf/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/sr_facras_a_d" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">qube.kod_sf, /*number*//*key*/
</column><column table="qube" column="vr_pret_dolg_sf" group="1" as="vr_pret_dolg_sf" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/ps" sourcecolumn="kod_pret_dolg_sf">qube.vr_pret_dolg_sf, /*number*//*key*/
</column><column table="qube" column="kr_pret" group="1" as="kr_pret" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/qube/qube/qube/qube/qube/un/un/dims/p" sourcecolumn="kod_pret">qube.kr_pret/*number*//*key*/
</column></group>)
qube
--\
</query><query name="kr_pret" dimension="kr_pret" link-mp-point="1" as="p" join="left outer" path="./pret/a/a/p" haskeys="1" used="1">left outer join
(
<select>--kr_pret
select <column table="a" column="kod_pret" type="number" comment="код претензии" as="kod_pret" key="1" fixed="1" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" used="1">a.kod_pret as kod_pret, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" comment="код договора" vid="1" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" sourcetable="./pret/a/a/p" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="dat_form" type="date" title="Дата формирования" comment="дата формирования претензии" agg="max" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" as="dat_form" key="0" sourcetable="./pret/a/a/p" sourcecolumn="dat_form" used="1">a.dat_form as dat_form/*Дата формирования*//*date*/
</column></select><from>
from <table name="kr_pret" as="a" title="Претензия" dimension="kr_pret" used="1">kr_pret
a
--\kr_pret
</table></from><call function="=" type="bool">)
p on <column table="p" column="kod_pret">p.kod_pret</column><text txtype="func"> = </text><column table="qube" column="kr_pret">qube.kr_pret</column></call>--\kr_pret
</query><query name="vr_pret_dolg_sf" dimension="vr_pret_dolg_sf" link-mp-point="1" as="ps" join="left outer" path="./pret/a/a/ps" haskeys="1" used="1">left outer join
(
<select>--vr_pret_dolg_sf
select <column table="a" column="kod_pret_dolg_sf" type="number" key="1" as="kod_pret_dolg_sf" sourcetable="./pret/a/a/ps" sourcecolumn="kod_pret_dolg_sf" used="1">a.kod_pret_dolg_sf as kod_pret_dolg_sf, /*number*//*key*/
</column><column table="a" column="dolg_osn_real" type="number" title="Сальдо_по_основной_реализации" as="dolg_osn_real" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_osn_real" used="1">a.dolg_osn_real as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="a" column="dolg_gp" type="number" title="Сальдо_по_госпошлине  " as="dolg_gp" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_gp" used="1">a.dolg_gp as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="a" column="dolg_peni" type="number" title="Начисленные_пени" as="dolg_peni" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_peni" used="1">a.dolg_peni as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="a" column="dolg_sud_peni" type="number" title="Сальдо_по_взысканным_процентам" as="dolg_sud_peni" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_sud_peni" used="1">a.dolg_sud_peni as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="a" column="dolg_astr" type="number" title="Сальдо_по_астренту" as="dolg_astr" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_astr" used="1">a.dolg_astr as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="a" column="dolg_othr" type="number" title="Иные виды задолженности" as="dolg_othr" key="0" sourcetable="./pret/a/a/ps" sourcecolumn="dolg_othr" used="1">a.dolg_othr as dolg_othr/*Иные виды задолженности*//*number*/
</column></select><from>
from <table name="vr_pret_dolg_sf" as="a" dimension="vr_pret_dolg_sf" used="1">vr_pret_dolg_sf
a
--\vr_pret_dolg_sf
</table></from><call function="=" type="bool">)
ps on <column table="ps" column="kod_pret_dolg_sf">ps.kod_pret_dolg_sf</column><text txtype="func"> = </text><column table="qube" column="vr_pret_dolg_sf">qube.vr_pret_dolg_sf</column></call>--\vr_pret_dolg_sf
</query><query name="sr_facvip" dimension="kod_sf" link-mp-point="1" as="s" join="left outer" path="./pret/a/a/s" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./pret/a/a/s" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="ym" type="number" title="Отчетный период начисления" dimension="ym" format="F2" as="ym" key="0" sourcetable="./pret/a/a/s" sourcecolumn="ym" used="1">a.ym as ym/*Отчетный период начисления*//*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
s on <column table="s" column="kod_sf">s.kod_sf</column><text txtype="func"> = </text><column table="qube" column="kod_sf">qube.kod_sf</column></call>--\sr_facvip
</query></from>)
a
--\q36703_32_pre
</query></from>)
a
--\q36703_32
</query></from><where>where
<call function="and" pth="" type="bool"><call function="=1" pth="1" type="bool">(<text txtype="func"> nvl( </text><column table="a" column="pr_pret_with_last_and_dolg_sf">a.pr_pret_with_last_and_dolg_sf</column><text txtype="func"> ,0)=1 </text><text txtype="func"> and nvl( </text><const type="number"><text>1</text></const><text txtype="func"> ,0)=1 </text>) </call></call></where><group> group by
<column table="a" column="kod_pret" group="1" title="Договор" as="kod_pret" key="1" fixed="1" used="1" type="number" sourcetable="./pret/a/a/p" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret">a.kod_pret, /*Договор*//*number*//*key*/
</column><column table="a" column="dat_form" group="1">a.dat_form
</column></group>)
pret
--\q36703_32_grouped_pret
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1" key="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="pret" column="kod_dog">pret.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from>) mtr
;
--\q36703_32_grouped_pret
</query>
  <query name="36703-graf_d" noname="1" order="kod_dog nulls first,kod_graf nulls first" materialize="1" path="." used="1">
delete from rr_temp where skod = '36703-graf_d';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
s1, --grsetname
n1, --kod_dog
n2, --kod_graf
n3, --kodp
s2, --nump
n4, --ym_min
n5, --kod_graf_status
s3, --num_delo
n6, --sum_graf
s4, --graf_period
n7, --graf_nach
n8, --graf_opl
n9, --graf_ost
s5, --graf_isp
s6, --status_name
n10, --gr_rn
s7, --growid
s8, --parent_growid
n11, --groupingid
s9, --grsetid
s10, --origgrsetid
s11, --parent_grsetid
n12, --par_groupingid
sparentid--sparentid
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="s1" info="grsetname" /><column column="n1" info="kod_dog" /><column column="n2" info="kod_graf" /><column column="n3" info="kodp" /><column column="s2" info="nump" /><column column="n4" info="ym_min" /><column column="n5" info="kod_graf_status" /><column column="s3" info="num_delo" /><column column="n6" info="sum_graf" /><column column="s4" info="graf_period" /><column column="n7" info="graf_nach" /><column column="n8" info="graf_opl" /><column column="n9" info="graf_ost" /><column column="s5" info="graf_isp" /><column column="s6" info="status_name" /><column column="n10" info="gr_rn" /><column column="s7" info="growid" /><column column="s8" info="parent_growid" /><column column="n11" info="groupingid" /><column column="s9" info="grsetid" /><column column="s10" info="origgrsetid" /><column column="s11" info="parent_grsetid" /><column column="n12" info="par_groupingid" /><column column="sparentid" info="sparentid" />--36703-graf_d
</insert><with>with
<query hint="materialize" as="mat3" path="./graf/p1/grsets_query/grpd" used="1">mat3 as
(
<select>--
select /*+ materialize*/
<column table="grpd" column="kod_dog" as="kod_dog" fixed="1" key="1" keypath=".kod_dog" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grpd" column="kod_graf" as="kod_graf" fixed="1" key="1" keypath=".kod_graf" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">grpd.kod_graf as kod_graf, /*number*//*key*/
</column><column table="grpd" column="kodp" as="kodp" fixed="1" key="1" keypath=".kodp" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">grpd.kodp as kodp, /*number*//*key*/
</column><column table="grpd" column="nump" as="nump" fixed="1" key="1" keypath=".nump" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">grpd.nump as nump, /*Код абонента*//*string*//*key*/
</column><column table="grpd" column="ym_min" as="ym_min" fixed="1" key="1" keypath=".ym_min" used="1" type="number" title="Период оплаты">grpd.ym_min as ym_min, /*Период оплаты*//*number*//*key*/
</column><column table="grpd" column="kod_graf_status" as="kod_graf_status" fixed="1" key="1" keypath=".kod_graf_status" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">grpd.kod_graf_status as kod_graf_status, /*number*//*key*/
</column><column table="grpd" column="num_delo" as="num_delo" fixed="1" key="1" keypath=".num_delo" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo">grpd.num_delo as num_delo, /*Номер дела*//*string*//*key*/
</column><column table="grpd" column="sum_graf" as="sum_graf" fixed="1" key="1" keypath=".sum_graf" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">grpd.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><column table="grpd" column="graf_period" as="graf_period" fixed="1" key="1" keypath=".graf_period" used="1" type="string" title="Период оплаты">grpd.graf_period as graf_period, /*Период оплаты*//*string*//*key*/
</column><column table="grpd" column="graf_nach" as="graf_nach" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">grpd.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="grpd" column="graf_opl" as="graf_opl" key="0" used="1" type="number" title="Оплачено" agg="sum">grpd.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="grpd" column="graf_ost" as="graf_ost" type="number" title="Остаток оплаты" key="0" used="1" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">grpd.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="grpd" column="graf_isp" as="graf_isp" type="string" title="Исполнено/не исполнено" key="0" used="1">grpd.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="grpd" column="status_name" as="status_name" fixed="1" key="1" keypath=".status_name" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">grpd.status_name as status_name/*Статус графика*//*string*//*key*/
</column></select><from>
from <query haskeys="1" as="grpd" path="./graf/p1/grsets_query/grpd/grpd" used="1">(
<select>--
select <column table="g" column="kod_dog" as="kod_dog" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">g.kod_dog as kod_dog, /*number*//*key*/
</column><column table="g" column="kod_graf" as="kod_graf" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">g.kod_graf as kod_graf, /*number*//*key*/
</column><column table="g" column="kodp" as="kodp" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">g.kodp as kodp, /*number*//*key*/
</column><column table="g" column="nump" as="nump" key="1" fixed="1" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">g.nump as nump, /*Код абонента*//*string*//*key*/
</column><column table="g" column="ym_min" as="ym_min" key="1" fixed="1" used="1" type="number" title="Период оплаты">g.ym_min as ym_min, /*Период оплаты*//*number*//*key*/
</column><column table="g" column="kod_graf_status" as="kod_graf_status" key="1" fixed="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">g.kod_graf_status as kod_graf_status, /*number*//*key*/
</column><column table="g" column="num_delo" as="num_delo" key="1" fixed="1" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo">g.num_delo as num_delo, /*Номер дела*//*string*//*key*/
</column><column table="g" column="sum_graf" as="sum_graf" key="1" fixed="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">g.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><column table="g" column="graf_period" as="graf_period" key="1" fixed="1" used="1" type="string" title="Период оплаты">g.graf_period as graf_period, /*Период оплаты*//*string*//*key*/
</column><column table="g" column="graf_nach" as="graf_nach" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">g.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="g" column="graf_opl" as="graf_opl" key="0" used="1" type="number" title="Оплачено" agg="sum">g.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><call function="-nvl" as="graf_ost" title="Остаток оплаты" key="0" pth="" type="number" used="1" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl"><text txtype="func"> nvl( </text><column table="g" column="sum_graf">g.sum_graf</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="g" column="graf_opl">g.graf_opl</column><text txtype="func"> ,0) </text> as graf_ost, /*Остаток оплаты*//*number*/
</call><call function="if" type="string" as="graf_isp" title="Исполнено/не исполнено" key="0" pth="" used="1"><text txtype="func"> case </text><text txtype="func"> when </text><call function="gt" pth="" type="bool">(<call function="-nvl" pth="" type="number">(<text txtype="func"> nvl( </text><column table="g" column="graf_nach">g.graf_nach</column><text txtype="func"> ,0) </text><text txtype="func"> -nvl( </text><column table="g" column="graf_opl">g.graf_opl</column><text txtype="func"> ,0) </text>) </call><text txtype="func"> &gt; </text><const><text>0</text></const>) </call><text txtype="func"> then </text><const><text>'не исполнено'</text></const><text txtype="func"> else </text><const><text>'исполнено'</text></const><text txtype="func"> end </text> as graf_isp, /*Исполнено/не исполнено*//*string*/
</call><column table="g" column="status_name" as="status_name" key="1" fixed="1" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">g.status_name as status_name/*Статус графика*//*string*//*key*/
</column></select><from>
from <query name="36703-graf" as="g" path="./graf/p1/grsets_query/grpd/grpd/g" haskeys="1" used="1">(
<select>--36703-graf
select <column table="kod_graf" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" reference="kr_dogovor" refcol="kod_dog" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog as kod_dog, /*number*//*key*/
</column><column group="1" table="kodp" column="kodp" as="kodp" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">kodp.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="nump" group="1" as="nump" key="1" fixed="1" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">kodp.nump as nump, /*Код абонента*//*string*//*key*/
</column><column column="ym_min" table="kod_graf" group="1" as="ym_min" key="1" fixed="1" used="1" type="number" title="Период оплаты">kod_graf.ym_min as ym_min, /*Период оплаты*//*number*//*key*/
</column><column group="1" table="kod_graf" column="kod_graf_status" as="kod_graf_status" key="1" fixed="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">kod_graf.kod_graf_status as kod_graf_status, /*number*//*key*/
</column><call function="nvl" type="string" as="num_delo" key="1" group="1" pth="" used="1" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo"><text txtype="func"> nvl( </text><column table="kod_mat" column="num_delo">kod_mat.num_delo</column><text txtype="func"> , </text><column table="kod_mat_i" column="num_delo">kod_mat_i.num_delo</column><text txtype="func"> ) </text> as num_delo, /*Номер дела*//*string*//*key*/
</call><column table="kod_graf" column="sum_graf" group="1" as="sum_graf" key="1" fixed="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">kod_graf.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><call function="||-" as="graf_period" key="1" group="1" pth="" type="string" used="1" title="Период оплаты"><call function="ym to char" pth="" type="string">(<text txtype="func"> trim(to_char( </text><column column="ym_min" table="kod_graf">kod_graf.ym_min</column><text txtype="func"> ,'9999.99')) </text>) </call><text txtype="func"> || '-' || </text><call function="ym to char" pth="" type="string">(<text txtype="func"> trim(to_char( </text><column column="ym_max" table="kod_graf">kod_graf.ym_max</column><text txtype="func"> ,'9999.99')) </text>) </call> as graf_period, /*Период оплаты*//*string*//*key*/
</call><call function="if" as="graf_nach" title="Начислено" key="0" group="sum" pth="" used="1" type="number" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="le" pth="" type="bool">(<column table="qube" column="dat" as="dat">qube.dat</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><column column="ur_graf_opl_sum1" as="graf_nach" table="qube">qube.ur_graf_opl_sum1</column><text txtype="func"> end </text>)  as graf_nach, /*Начислено*//*number*/
</call><call function="if" as="graf_opl" title="Оплачено" key="0" group="sum" pth="" used="1" type="number" agg="sum">sum(<text txtype="func"> case </text><text txtype="func"> when </text><call function="le" pth="" type="bool">(<column table="qube" column="dat" as="dat">qube.dat</column><text txtype="func"> &lt;= </text><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><column column="sr_opl_opl_sf1" as="graf_opl" table="qube">qube.sr_opl_opl_sf1</column><text txtype="func"> end </text>)  as graf_opl, /*Оплачено*//*number*/
</call><column table="kod_graf_status" column="name" as="status_name" group="1" key="1" fixed="1" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">kod_graf_status.name as status_name/*Статус графика*//*string*//*key*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="dat" group="1" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">qube.dat as dat, /*date*//*key*/
</column><column table="qube" column="ur_graf_opl_sum1" as="ur_graf_opl_sum1" group="sum" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">sum(qube.ur_graf_opl_sum1)  as ur_graf_opl_sum1, /*Сумма оплаты по графику*//*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" group="sum" key="0" used="1" type="number" title="Оплата начислений" agg="sum">sum(qube.sr_opl_opl_sf1)  as sr_opl_opl_sf1/*Оплата начислений*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_graf" as="kod_graf" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="dat" as="dat" keypath=".dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">qube.dat as dat, /*date*//*key*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="ur_graf_opl_sum1" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">qube.ur_graf_opl_sum1 as ur_graf_opl_sum1/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube" used="1">(
<query path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="dat" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">qube.dat as dat, /*date*//*key*/
</column><column table="qube" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog as kod_dog, /*number*/
</column><column table="qube" column="kod_graf" as="kod_graf" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf as kod_graf, /*number*/
</column><column table="qube" column="sr_opl_opl_sf1" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">qube.sr_opl_opl_sf1 as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="qube" column="ur_graf_opl_sum1" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">qube.ur_graf_opl_sum1 as ur_graf_opl_sum1/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="dat" group="1" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">un.dat as dat, /*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog as kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf as kod_graf, /*number*//*key*/
</column><column table="un" column="sr_opl_opl_sf1" group="sum" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">sum(un.sr_opl_opl_sf1)  as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><column table="un" column="ur_graf_opl_sum1" group="sum" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">sum(un.ur_graf_opl_sum1)  as ur_graf_opl_sum1/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query as="un" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un" used="1">(
<query path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un" used="1">(
<query multiplicate-point="1" as="un" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="dims" column="dat" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">dims.dat as dat, /*date*//*key*/
</column><column table="dims" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><column table="sr_opl_sf" column="opl_sf" as="sr_opl_opl_sf1" key="0" used="1" type="number" title="Оплата начислений" agg="sum">sr_opl_sf.opl_sf as sr_opl_opl_sf1, /*Оплата начислений*//*number*/
</column><const type="number" as="ur_graf_opl_sum1" key="0" used="1"><text>null</text> as ur_graf_opl_sum1/*number*/
</const></select><from>
from <query as="dims" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl as kod_opl_prm, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="dat" as="dat" group="1" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">sr_opl_sf_a_d.dat as dat, /*date*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf as kod_graf/*number*//*key*/
</column></select><from>
from <query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf_a_d" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" haskeys="1" used="1">(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="dat_uch" type="date" title="" as="dat" dimension="dat_dolg_uved_kaz_el" key="0" thissrc="dat_oper" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch" used="1">a.dat_uch as dat/**//*date*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where>)
sr_opl_sf_a_d
--\sr_opl_sf
</query><query name="sr_facvip" dimension="kod_sf" as="kod_sf_a_d" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog/*number*/
</column></select><from>
from <table name="sr_facvip" as="a" dimension="kod_sf" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf_a_d on <column table="sr_opl_sf_a_d" column="kod_sf">sr_opl_sf_a_d.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\sr_facvip
</query><query name="vv_all_deb_sf" as="vv_all_deb_sf_a_d1" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/vv_all_deb_sf_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
vv_all_deb_sf_a_d1 on <column table="vv_all_deb_sf_a_d1" column="kod_sf">vv_all_deb_sf_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf_a_d" column="kod_sf">kod_sf_a_d.kod_sf</column></call>--\vv_all_deb_sf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="vv_all_deb_sf_a_d1" column="kod_deb_sf">vv_all_deb_sf_a_d1.kod_deb_sf</column></call>--\ur_dogplat
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dp_graf
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" mandatory="is_mat" title="Решение" exists="is_mat" as="kod_hist_mat" reference="ur_hist_mat" refcol="kod_hist_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*Решение*//*number*/
</column><column table="a" column="kod_sogl" type="number" mandatory="is_dop" exists="is_dop" as="kod_sogl" reference="ur_sogl" refcol="kod_sogl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_sogl" used="1">a.kod_sogl as kod_sogl, /*number*/
</column><column table="a" column="kod_isp" type="number" mandatory="is_isp" exists="is_isp" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish, /*Дата окончания действия графика*//*date*/
</column><call function="nvl" as="dat_opl_beg_nvl" key="0" pth="" used="1" type="date" title="Начало учета фактической оплаты" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="dat_doc"><text txtype="func"> nvl( </text><column table="a" column="dat_opl_beg" type="date" title="Начало учета фактической оплаты" as="dat_opl_beg" key="0" thissrc="dat_opl_beg">a.dat_opl_beg</column><text txtype="func"> , </text><call function="coalesce" as="doc_date" type="date" title="Дата документа" key="0" pth="" thissrc="doc_date">(<text txtype="func"> coalesce( </text><column table="kod_sogl" column="dat_doc">kod_sogl.dat_doc</column><text txtype="func"> , </text><column table="kod_hist_mat2" column="dat_post">kod_hist_mat2.dat_post</column><text txtype="func"> , </text><column table="kod_isp" column="dat_doc">kod_isp.dat_doc</column><text txtype="func"> ) </text>) </call><text txtype="func"> ) </text> as dat_opl_beg_nvl/*Начало учета фактической оплаты*//*date*/
</call></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table><query name="ur_hist_mat" as="kod_hist_mat2" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="dat_post" type="date" title="Дата прин. суд. акта" column-mandatory="1" comment="Дата принятия судебного акта" as="dat_post" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" sourcecolumn="dat_post" used="1">a.dat_post as dat_post/*Дата прин. суд. акта*//*date*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat2 on <column table="a" column="kod_hist_mat">a.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat2" column="kod_hist_mat">kod_hist_mat2.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_sogl" as="kod_sogl" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" haskeys="1" used="1">left outer join
(
<select>--ur_sogl
select <column table="a" column="kod_sogl" type="number" key-dimension="kod_sogl" as="kod_sogl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="kod_sogl" used="1">a.kod_sogl as kod_sogl, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата доп. документа" column-mandatory="1" column-default="today" as="dat_doc" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата доп. документа*//*date*/
</column></select><from>
from <table name="ur_sogl" as="a" title="Доп. документ (арбитраж)" used="1">ur_sogl
a
--\ur_sogl
</table></from><call function="=" type="bool">)
kod_sogl on <column table="a" column="kod_sogl">a.kod_sogl</column><text txtype="func"> = </text><column table="kod_sogl" column="kod_sogl">kod_sogl.kod_sogl</column></call>--\ur_sogl
</query><query name="ur_isp" as="kod_isp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата выдачи исп. листа" fact="ur_isp_dat_doc" agg="max" dimension="dat_ur" as="dat_doc" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата выдачи исп. листа*//*date*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="a" column="kod_isp">a.kod_isp</column><text txtype="func"> = </text><column table="kod_isp" column="kod_isp">kod_isp.kod_isp</column></call>--\ur_isp
</query></from><call function="=" type="bool">)
kod_graf on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_sf_a_d" column="kod_dog">kod_sf_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="dat_opl" type="date" title="Дата платежного документа" as="dat_opl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="dat_opl" used="1">a.dat_opl as dat_opl, /*Дата платежного документа*//*date*/
</column><column table="a" column="pr_not_in_graf" type="number" title="Не учитывать в ГПЗ" controlType="UICheck" as="pr_not_in_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="pr_not_in_graf" used="1">a.pr_not_in_graf as pr_not_in_graf/*Не учитывать в ГПЗ*//*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="and" type="bool">)
kod_opl on <call function="=" pth="" type="bool">(<column table="sr_opl_sf_a_d" column="kod_opl">sr_opl_sf_a_d.kod_opl</column><text txtype="func"> = </text><column table="kod_opl" column="kod_opl">kod_opl.kod_opl</column>) </call><text txtype="func"> and </text><call function="!=nvl" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="kod_opl" column="pr_not_in_graf">kod_opl.pr_not_in_graf</column><text txtype="func"> ,0) </text><text txtype="func"> != nvl( </text><const type="number"><text>1</text></const><text txtype="func"> ,0) </text>) </call></call>--\sr_opl
</query></from><where>where
<call function="and" pth="" type="bool"><call function="or" pth="1" type="bool">(<call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_hist_mat">kod_graf.kod_hist_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_isp">kod_graf.kod_isp</column><text txtype="func"> is not null </text>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_sogl">kod_graf.kod_sogl</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_graf" column="dat_opl_beg_nvl">kod_graf.dat_opl_beg_nvl</column><text txtype="func"> &lt;= </text><column table="kod_opl" column="dat_opl">kod_opl.dat_opl</column>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="sr_opl_sf_a_d" column="dat">sr_opl_sf_a_d.dat</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="gt" pth="" optional="1" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &gt; </text><const><text>:dat1 </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where><group> group by
<column table="sr_opl_sf_a_d" column="kod_opl" as="kod_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="kod_opl">sr_opl_sf_a_d.kod_opl, /*number*//*key*/
</column><column table="sr_opl_sf_a_d" column="dat" as="dat" group="1" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">sr_opl_sf_a_d.dat, /*date*//*key*/
</column><column table="kod_sf_a_d" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">kod_sf_a_d.kod_dog, /*number*//*key*/
</column><column table="kod_dp_graf_a_d" column="kod_graf" as="kod_graf" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">kod_dp_graf_a_d.kod_graf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="sr_opl_sf" dimension="kod_opl_sf" as="sr_opl_sf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/sr_opl_sf" haskeys="1" used="1">left outer join
(
<select>--sr_opl_sf
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/sr_opl_sf" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><call function="+nvl" as="opl_sf" agg="sum" title="Оплата начислений" key="0" pth="" type="number" thissrc="oplf" used="1"><text txtype="func"> nvl( </text><column table="a" column="opl">a.opl</column><text txtype="func"> ,0) </text><text txtype="func"> +nvl( </text><column table="a" column="opls">a.opls</column><text txtype="func"> ,0) </text> as opl_sf/*Оплата начислений*//*number*/
</call></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl_sf" used="1">sr_opl
a
--\sr_opl
</table></from><where>where
<call function="in" pth="" type="bool"><column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" thissrc="kod_type_opl">a.kod_type_opl</column><text txtype="func"> in </text><call function="array" pth="">(<const><text>0</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const><text txtype="func"> , </text><const><text>4</text></const>) </call></call></where><call function="=" type="bool">)
sr_opl_sf on <column table="sr_opl_sf" column="kod_opl">sr_opl_sf.kod_opl</column><text txtype="func"> = </text><column table="dims" column="kod_opl_prm">dims.kod_opl_prm</column></call>--\sr_opl_sf
</query><qubecontent><where>where
<call function="and" condsource="36703-graf"><call function="or">(<call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_hist_mat">kod_graf.kod_hist_mat</column>) </call><call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_isp">kod_graf.kod_isp</column>) </call><call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_sogl">kod_graf.kod_sogl</column>) </call>) </call><call function="le" dont-push="1">(<column table="kod_graf" column="dat_opl_beg_nvl">kod_graf.dat_opl_beg_nvl</column><column table="kod_opl" column="dat_opl">kod_opl.dat_opl</column>) </call><call function="le" dont-push="1">(<column column="val" table="dat">dat.val</column><const>:dat </const>) </call><call function="gt" dont-push="1" optional="1">(<call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call><const>:dat1 </const>) </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from>)
--\
</query><query multiplicate-point="1" as="un" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="dims" column="dat" as="dat" key="1" used="1" type="date" title="Срок оплаты по графику" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="dat_opl">dims.dat as dat, /*Срок оплаты по графику*//*date*//*key*/
</column><column table="dims" column="kod_dog" as="kod_dog" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">dims.kod_dog as kod_dog, /*number*/
</column><column table="dims" column="kod_graf" as="kod_graf" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">dims.kod_graf as kod_graf, /*number*/
</column><const type="number" as="sr_opl_opl_sf1" key="0" used="1"><text>null</text> as sr_opl_opl_sf1, /*number*/
</const><column table="ur_graf_opl" column="sum_opl" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">ur_graf_opl.sum_opl as ur_graf_opl_sum1/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query as="dims" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims" used="1">(
<select>--
select <column table="ur_graf_opl_a_d" column="kod_graf_opl" as="kod_graf_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf_opl">ur_graf_opl_a_d.kod_graf_opl as kod_graf_opl_prm, /*number*//*key*/
</column><column table="ur_graf_opl_a_d" column="dat_opl" as="dat" group="1" key="1" used="1" type="date" title="Срок оплаты по графику" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="dat_opl">ur_graf_opl_a_d.dat_opl as dat, /*Срок оплаты по графику*//*date*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog as kod_dog, /*number*//*key*/
</column><column table="ur_graf_opl_a_d" column="kod_graf" as="kod_graf" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">ur_graf_opl_a_d.kod_graf as kod_graf/*number*//*key*/
</column></select><from>
from <query name="ur_graf_opl" dimension="kod_graf_opl" as="ur_graf_opl_a_d" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" haskeys="1" used="1">(
<select>--ur_graf_opl
select <column table="a" column="kod_graf_opl" type="number" key-dimension="kod_graf_opl" as="kod_graf_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf_opl" used="1">a.kod_graf_opl as kod_graf_opl, /*number*//*key*/
</column><column table="a" column="dat_opl" type="date" title="Срок оплаты по графику" new-val="dat_opl_new_val" dimension="dat" vid="1" as="dat_opl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="dat_opl" used="1">a.dat_opl as dat_opl, /*Срок оплаты по графику*//*date*/
</column><column table="a" column="kod_graf" type="number" vid="1" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf/*number*/
</column></select><from>
from <table name="ur_graf_opl" as="a" title="График оплат" dimension="kod_graf_opl" used="1">ur_graf_opl
a
--\ur_graf_opl
</table></from>)
ur_graf_opl_a_d
--\ur_graf_opl
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" mandatory="is_mat" title="Решение" exists="is_mat" as="kod_hist_mat" reference="ur_hist_mat" refcol="kod_hist_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*Решение*//*number*/
</column><column table="a" column="kod_sogl" type="number" mandatory="is_dop" exists="is_dop" as="kod_sogl" reference="ur_sogl" refcol="kod_sogl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_sogl" used="1">a.kod_sogl as kod_sogl, /*number*/
</column><column table="a" column="kod_isp" type="number" mandatory="is_isp" exists="is_isp" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish, /*Дата окончания действия графика*//*date*/
</column><call function="nvl" as="dat_opl_beg_nvl" key="0" pth="" used="1" type="date" title="Начало учета фактической оплаты" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="dat_doc"><text txtype="func"> nvl( </text><column table="a" column="dat_opl_beg" type="date" title="Начало учета фактической оплаты" as="dat_opl_beg" key="0" thissrc="dat_opl_beg">a.dat_opl_beg</column><text txtype="func"> , </text><call function="coalesce" as="doc_date" type="date" title="Дата документа" key="0" pth="" thissrc="doc_date">(<text txtype="func"> coalesce( </text><column table="kod_sogl" column="dat_doc">kod_sogl.dat_doc</column><text txtype="func"> , </text><column table="kod_hist_mat2" column="dat_post">kod_hist_mat2.dat_post</column><text txtype="func"> , </text><column table="kod_isp" column="dat_doc">kod_isp.dat_doc</column><text txtype="func"> ) </text>) </call><text txtype="func"> ) </text> as dat_opl_beg_nvl/*Начало учета фактической оплаты*//*date*/
</call></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table><query name="ur_hist_mat" as="kod_hist_mat2" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="dat_post" type="date" title="Дата прин. суд. акта" column-mandatory="1" comment="Дата принятия судебного акта" as="dat_post" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_hist_mat2" sourcecolumn="dat_post" used="1">a.dat_post as dat_post/*Дата прин. суд. акта*//*date*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat2 on <column table="a" column="kod_hist_mat">a.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat2" column="kod_hist_mat">kod_hist_mat2.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_sogl" as="kod_sogl" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" haskeys="1" used="1">left outer join
(
<select>--ur_sogl
select <column table="a" column="kod_sogl" type="number" key-dimension="kod_sogl" as="kod_sogl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="kod_sogl" used="1">a.kod_sogl as kod_sogl, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата доп. документа" column-mandatory="1" column-default="today" as="dat_doc" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_sogl" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата доп. документа*//*date*/
</column></select><from>
from <table name="ur_sogl" as="a" title="Доп. документ (арбитраж)" used="1">ur_sogl
a
--\ur_sogl
</table></from><call function="=" type="bool">)
kod_sogl on <column table="a" column="kod_sogl">a.kod_sogl</column><text txtype="func"> = </text><column table="kod_sogl" column="kod_sogl">kod_sogl.kod_sogl</column></call>--\ur_sogl
</query><query name="ur_isp" as="kod_isp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="dat_doc" type="date" title="Дата выдачи исп. листа" fact="ur_isp_dat_doc" agg="max" dimension="dat_ur" as="dat_doc" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_graf/kod_isp" sourcecolumn="dat_doc" used="1">a.dat_doc as dat_doc/*Дата выдачи исп. листа*//*date*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="a" column="kod_isp">a.kod_isp</column><text txtype="func"> = </text><column table="kod_isp" column="kod_isp">kod_isp.kod_isp</column></call>--\ur_isp
</query></from><call function="=" type="bool">)
kod_graf on <column table="ur_graf_opl_a_d" column="kod_graf">ur_graf_opl_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><query name="ur_dp_graf" dimension="kod_dp_graf" as="kod_dp_graf_a_d" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dp_graf
select <column column="kod_dp_isp" table="a" type="number" as="kod_dp_isp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dp_isp" used="1">a.kod_dp_isp as kod_dp_isp, /*number*//*key*/
</column><column table="a" column="kod_graf" type="number" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><column column="kod_dogplat" table="a" type="number" as="kod_dogplat" reference="ur_dogplat" refcol="kod_dogplat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat/*number*/
</column></select><from>
from <table name="ur_dp_graf" as="a" table-code="1887" dimension="kod_dp_graf" used="1">ur_dp_graf
a
--\ur_dp_graf
</table></from><call function="=" type="bool">)
kod_dp_graf_a_d on <column table="kod_dp_graf_a_d" column="kod_graf">kod_dp_graf_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_dp_graf
</query><query name="ur_dogplat" dimension="kod_dogplat" as="kod_dogplat_a_d" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" haskeys="1" used="1">left outer join
(
<select>--ur_dogplat
select <column table="a" column="kod_dogplat" type="number" key-dimension="kod_dogplat" as="kod_dogplat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dogplat" used="1">a.kod_dogplat as kod_dogplat, /*number*//*key*/
</column><column table="a" column="kod_dog" type="number" as="kod_dog" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*/
</column><column table="a" column="kod_deb_sf" type="number" comment="связь с СФ через VV_ALL_DEB_SF" as="kod_deb_sf" reference="vv_all_deb_sf" refcol="kod_deb_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf/*number*/
</column></select><from>
from <table name="ur_dogplat" as="a" dimension="kod_dogplat" used="1">ur_dogplat
a
--\ur_dogplat
</table></from><call function="=" type="bool">)
kod_dogplat_a_d on <column table="kod_dp_graf_a_d" column="kod_dogplat">kod_dp_graf_a_d.kod_dogplat</column><text txtype="func"> = </text><column table="kod_dogplat_a_d" column="kod_dogplat">kod_dogplat_a_d.kod_dogplat</column></call>--\ur_dogplat
</query><query name="vv_all_deb_sf" as="kod_deb_sf1_a_d1" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" haskeys="1" used="1">left outer join
(
<select>--vv_all_deb_sf
select <column table="a" column="kod_deb_sf" type="number" key="1" as="kod_deb_sf" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_deb_sf" used="1">a.kod_deb_sf as kod_deb_sf, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_deb_sf1_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*/
</column></select><from>
from <table name="vv_all_deb_sf" as="a" used="1">vv_all_deb_sf
a
--\vv_all_deb_sf
</table></from><call function="=" type="bool">)
kod_deb_sf1_a_d1 on <column table="kod_dogplat_a_d" column="kod_deb_sf">kod_dogplat_a_d.kod_deb_sf</column><text txtype="func"> = </text><column table="kod_deb_sf1_a_d1" column="kod_deb_sf">kod_deb_sf1_a_d1.kod_deb_sf</column></call>--\vv_all_deb_sf
</query><query name="sr_facvip" as="kod_sf1_a_d1" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf1_a_d1" haskeys="1" used="1">left outer join
(
<select>--sr_facvip
select <column table="a" column="kod_sf" type="number" key-dimension="kod_sf" as="kod_sf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf1_a_d1" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf/*number*//*key*/
</column></select><from>
from <table name="sr_facvip" as="a" used="1">sr_facvip
a
--\sr_facvip
</table></from><where>where
<call function="not in" pth="" type="bool"><column table="a" column="vid_sf">a.vid_sf</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>2</text></const><text txtype="func"> , </text><const><text>9</text></const>) </call></call></where><call function="=" type="bool">)
kod_sf1_a_d1 on <column table="kod_deb_sf1_a_d1" column="kod_sf">kod_deb_sf1_a_d1.kod_sf</column><text txtype="func"> = </text><column table="kod_sf1_a_d1" column="kod_sf">kod_sf1_a_d1.kod_sf</column></call>--\sr_facvip
</query><query name="sr_opl" dimension="kod_opl" as="kod_opl" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" haskeys="1" used="1">left outer join
(
<select>--sr_opl
select <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_opl" used="1">a.kod_opl as kod_opl, /*number*//*key*/
</column><column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="kod_sf" used="1">a.kod_sf as kod_sf, /*number*/
</column><column table="a" column="dat_opl" type="date" title="Дата платежного документа" as="dat_opl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="dat_opl" used="1">a.dat_opl as dat_opl, /*Дата платежного документа*//*date*/
</column><column table="a" column="pr_not_in_graf" type="number" title="Не учитывать в ГПЗ" controlType="UICheck" as="pr_not_in_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_opl" sourcecolumn="pr_not_in_graf" used="1">a.pr_not_in_graf as pr_not_in_graf/*Не учитывать в ГПЗ*//*number*/
</column></select><from>
from <table name="sr_opl" as="a" dimension="kod_opl" used="1">sr_opl
a
--\sr_opl
</table></from><call function="and" type="bool">)
kod_opl on <call function="=" pth="" type="bool">(<column table="kod_opl" column="kod_sf">kod_opl.kod_sf</column><text txtype="func"> = </text><column table="kod_sf1_a_d1" column="kod_sf">kod_sf1_a_d1.kod_sf</column>) </call><text txtype="func"> and </text><call function="!=nvl" pth="" type="bool">(<text txtype="func"> nvl( </text><column table="kod_opl" column="pr_not_in_graf">kod_opl.pr_not_in_graf</column><text txtype="func"> ,0) </text><text txtype="func"> != nvl( </text><const type="number"><text>1</text></const><text txtype="func"> ,0) </text>) </call></call>--\sr_opl
</query><query name="kr_dogovor" dimension="kod_dog" as="kod_dog" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dogplat_a_d" column="kod_dog">kod_dogplat_a_d.kod_dog</column><text txtype="func"> = </text><column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*//*key*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query></from><where>where
<call function="and" pth="" type="bool"><call function="or" pth="1" type="bool">(<call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_hist_mat">kod_graf.kod_hist_mat</column><text txtype="func"> is not null </text>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_isp">kod_graf.kod_isp</column><text txtype="func"> is not null </text>) </call><text txtype="func"> or </text><call function="is not null" pth="" type="bool">(<column table="kod_graf" column="kod_sogl">kod_graf.kod_sogl</column><text txtype="func"> is not null </text>) </call>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="kod_graf" column="dat_opl_beg_nvl">kod_graf.dat_opl_beg_nvl</column><text txtype="func"> &lt;= </text><column table="kod_opl" column="dat_opl">kod_opl.dat_opl</column>) </call><text txtype="func"> and </text><call function="le" pth="" type="bool">(<column table="ur_graf_opl_a_d" column="dat_opl">ur_graf_opl_a_d.dat_opl</column><text txtype="func"> &lt;= </text><const><text>:dat </text></const>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="gt" pth="" optional="1" type="bool">(<call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><text txtype="func"> , </text><call function="doomsday" pth="0" type="date"><text txtype="func"> DATE'8999-12-31' </text></call><text txtype="func"> ) </text>) </call><text txtype="func"> &gt; </text><const><text>:dat1 </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kodp" column="kodp">kodp.kodp</column><text txtype="func"> in </text><const><text>:kodp </text></const>) </call><text txtype="func"> } </text><text txtype="func"> { </text><text txtype="func"> and </text><call function="in" pth="" optional="1" type="bool">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> in </text><const><text>:kod_dog </text></const>) </call><text txtype="func"> } </text></call></where><group> group by
<column table="ur_graf_opl_a_d" column="kod_graf_opl" as="kod_graf_opl_prm" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf_opl">ur_graf_opl_a_d.kod_graf_opl, /*number*//*key*/
</column><column table="ur_graf_opl_a_d" column="dat_opl" as="dat" group="1" key="1" used="1" type="date" title="Срок оплаты по графику" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="dat_opl">ur_graf_opl_a_d.dat_opl, /*Срок оплаты по графику*//*date*//*key*/
</column><column table="kod_dogplat_a_d" column="kod_dog" as="kod_dog" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dogplat_a_d" sourcecolumn="kod_dog">kod_dogplat_a_d.kod_dog, /*number*//*key*/
</column><column table="ur_graf_opl_a_d" column="kod_graf" as="kod_graf" group="1" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/ur_graf_opl_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">ur_graf_opl_a_d.kod_graf/*number*//*key*/
</column></group>)
dims
--\
</query><query name="ur_graf_opl" dimension="kod_graf_opl" as="ur_graf_opl" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" haskeys="1" used="1">left outer join
(
<select>--ur_graf_opl
select <column table="a" column="kod_graf_opl" type="number" key-dimension="kod_graf_opl" as="kod_graf_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="kod_graf_opl" used="1">a.kod_graf_opl as kod_graf_opl, /*number*//*key*/
</column><column table="a" column="sum_opl" type="number" title="Сумма оплаты по графику" fact="ur_graf_opl_sum" agg="sum" vid="1" as="sum_opl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl" used="1">a.sum_opl as sum_opl/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <table name="ur_graf_opl" as="a" title="График оплат" dimension="kod_graf_opl" used="1">ur_graf_opl
a
--\ur_graf_opl
</table></from><call function="=" type="bool">)
ur_graf_opl on <column table="ur_graf_opl" column="kod_graf_opl">ur_graf_opl.kod_graf_opl</column><text txtype="func"> = </text><column table="dims" column="kod_graf_opl_prm">dims.kod_graf_opl_prm</column></call>--\ur_graf_opl
</query><qubecontent><where>where
<call function="and" condsource="36703-graf"><call function="or">(<call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_hist_mat">kod_graf.kod_hist_mat</column>) </call><call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_isp">kod_graf.kod_isp</column>) </call><call function="is not null" dont-push="1">(<column table="kod_graf" column="kod_sogl">kod_graf.kod_sogl</column>) </call>) </call><call function="le" dont-push="1">(<column table="kod_graf" column="dat_opl_beg_nvl">kod_graf.dat_opl_beg_nvl</column><column table="kod_opl" column="dat_opl">kod_opl.dat_opl</column>) </call><call function="le" dont-push="1">(<column column="val" table="dat">dat.val</column><const>:dat </const>) </call><call function="gt" dont-push="1" optional="1">(<call function="nvl">(<column table="kod_graf" column="dat_finish">kod_graf.dat_finish</column><call function="doomsday">() </call>) </call><const>:dat1 </const>) </call><call function="in" optional="1">(<column table="kodp" column="kodp">kodp.kodp</column><const>:kodp </const>) </call><call function="in" optional="1">(<column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><const>:kod_dog </const>) </call></call></where></qubecontent></from>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="dat" group="1" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">un.dat, /*date*//*key*/
</column><column table="un" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">un.kod_dog, /*number*//*key*/
</column><column table="un" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">un.kod_graf/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_dog" group="1" as="kod_dog" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_sf_a_d" sourcecolumn="kod_dog">qube.kod_dog, /*number*//*key*/
</column><column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/kod_dp_graf_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">qube.kod_graf, /*number*//*key*/
</column><column table="qube" column="dat" group="1" as="dat" key="1" used="1" type="date" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/dims/sr_opl_sf_a_d" sourcecolumn="dat_uch">qube.dat/*date*//*key*/
</column></group>)
qube
--\
</query><query name="ur_graf" dimension="kod_graf" link-mp-point="1" as="kod_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" mandatory="is_mat" title="Решение" exists="is_mat" as="kod_hist_mat" reference="ur_hist_mat" refcol="kod_hist_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*Решение*//*number*/
</column><column table="a" column="kod_isp" type="number" mandatory="is_isp" exists="is_isp" as="kod_isp" reference="ur_isp" refcol="kod_isp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*/
</column><column table="a" column="kod_graf_status" type="number" comment="Статус графика" as="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" used="1">a.kod_graf_status as kod_graf_status, /*number*/
</column><column table="a" column="dat_finish" type="date" title="Дата окончания действия графика" mandatory="dat_finish_val" as="dat_finish" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="dat_finish" used="1">a.dat_finish as dat_finish, /*Дата окончания действия графика*//*date*/
</column><column table="qube_ur_graf" column="ym_min" as="ym_min" key="0" is-fact-use="1" used="1" type="number" title="Период оплаты">qube_ur_graf.ym_min as ym_min, /*Период оплаты*//*number*/
</column><column table="qube_ur_graf" column="ym_max" as="ym_max" key="0" is-fact-use="1" used="1" type="number" title="Период оплаты">qube_ur_graf.ym_max as ym_max, /*Период оплаты*//*number*/
</column><column table="qube_ur_graf" column="sum_graf" as="sum_graf" key="0" is-fact-use="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">qube_ur_graf.sum_graf as sum_graf/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table><query name="qube_ur_graf" as="qube_ur_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf" used="1">left outer join
(
<select>--qube_ur_graf
select <column table="kod_graf" column="kod_graf" as="kod_graf" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/kod_graf" sourcecolumn="kod_graf">kod_graf.kod_graf as kod_graf, /*number*/
</column><column column="ur_graf_opl_ym_min1" as="ym_min" is-fact-use="1" table="qube" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_min1 as ym_min, /*Период оплаты*//*number*/
</column><column column="ur_graf_opl_ym_max1" as="ym_max" is-fact-use="1" table="qube" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_max1 as ym_max, /*Период оплаты*//*number*/
</column><column column="ur_graf_opl_sum1" as="sum_graf" is-fact-use="1" table="qube" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">qube.ur_graf_opl_sum1 as sum_graf/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query haskeys="1" as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="ur_graf_opl_ym_min1" is-fact-use="1" as="ur_graf_opl_ym_min1" group="min" key="0" used="1" type="number" title="Период оплаты">min(qube.ur_graf_opl_ym_min1)  as ur_graf_opl_ym_min1, /*Период оплаты*//*number*/
</column><column table="qube" column="ur_graf_opl_ym_max1" is-fact-use="1" as="ur_graf_opl_ym_max1" group="max" key="0" used="1" type="number" title="Период оплаты">max(qube.ur_graf_opl_ym_max1)  as ur_graf_opl_ym_max1, /*Период оплаты*//*number*/
</column><column table="qube" column="ur_graf_opl_sum1" is-fact-use="1" as="ur_graf_opl_sum1" group="sum" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">sum(qube.ur_graf_opl_sum1)  as ur_graf_opl_sum1/*Сумма оплаты по графику*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" as="kod_graf" key="1" keypath=".kod_graf" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="ur_graf_opl_sum1" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">qube.ur_graf_opl_sum1 as ur_graf_opl_sum1, /*Сумма оплаты по графику*//*number*/
</column><column table="qube" column="ur_graf_opl_ym_max1" as="ur_graf_opl_ym_max1" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_max1 as ur_graf_opl_ym_max1, /*Период оплаты*//*number*/
</column><column table="qube" column="ur_graf_opl_ym_min1" as="ur_graf_opl_ym_min1" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_min1 as ur_graf_opl_ym_min1/*Период оплаты*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube" used="1">(
<query path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube" used="1">(
<query as="qube" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube" used="1">(
<select>--
select <column table="qube" column="kod_graf" as="kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">qube.kod_graf as kod_graf, /*number*//*key*/
</column><column table="qube" column="ur_graf_opl_sum1" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">qube.ur_graf_opl_sum1 as ur_graf_opl_sum1, /*Сумма оплаты по графику*//*number*/
</column><column table="qube" column="ur_graf_opl_ym_max1" as="ur_graf_opl_ym_max1" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_max1 as ur_graf_opl_ym_max1, /*Период оплаты*//*number*/
</column><column table="qube" column="ur_graf_opl_ym_min1" as="ur_graf_opl_ym_min1" key="0" used="1" type="number" title="Период оплаты">qube.ur_graf_opl_ym_min1 as ur_graf_opl_ym_min1/*Период оплаты*//*number*/
</column></select><from>
from <query as="qube" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube" used="1">(
<select>--
select <column table="un" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">un.kod_graf as kod_graf, /*number*//*key*/
</column><column table="un" column="ur_graf_opl_sum1" group="sum" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">sum(un.ur_graf_opl_sum1)  as ur_graf_opl_sum1, /*Сумма оплаты по графику*//*number*/
</column><column table="un" column="ur_graf_opl_ym_max1" group="max" as="ur_graf_opl_ym_max1" key="0" used="1" type="number" title="Период оплаты">max(un.ur_graf_opl_ym_max1)  as ur_graf_opl_ym_max1, /*Период оплаты*//*number*/
</column><column table="un" column="ur_graf_opl_ym_min1" group="min" as="ur_graf_opl_ym_min1" key="0" used="1" type="number" title="Период оплаты">min(un.ur_graf_opl_ym_min1)  as ur_graf_opl_ym_min1/*Период оплаты*//*number*/
</column></select><from>
from <query as="un" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un" used="1">(
<query path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un" used="1">(
<query dimension="kod_graf" multiplicate-point="1" as="un" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un" used="1">(
<select>--
select <column table="kod_graf" column="kod_graf" as="kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">kod_graf.kod_graf as kod_graf, /*number*//*key*/
</column><const type="number" as="ur_graf_opl_sum1" key="0" used="1"><text>null</text> as ur_graf_opl_sum1, /*number*/
</const><const type="number" as="ur_graf_opl_ym_max1" key="0" used="1"><text>null</text> as ur_graf_opl_ym_max1, /*number*/
</const><const type="number" as="ur_graf_opl_ym_min1" key="0" used="1"><text>null</text> as ur_graf_opl_ym_min1/*number*/
</const></select><from>
from <query name="ur_graf" dimension="kod_graf" as="kod_graf" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" haskeys="1" used="1">(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf/*number*//*key*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from>)
kod_graf
--\ur_graf
</query><qubecontent><where>where
<call function="is not null" condsource="qube_ur_graf"><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call></where></qubecontent></from><where>where
<call function="is not null" pth="" type="bool"><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text></call></where>)
--\
</query><query dimension="kod_graf_opl" multiplicate-point="1" as="un" union="1" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un" used="1">union all
(
<select>--
select <column table="ur_graf_opl_a_d" column="kod_graf" as="kod_graf" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="kod_graf" reference="ur_graf" refcol="kod_graf">ur_graf_opl_a_d.kod_graf as kod_graf, /*number*//*key*/
</column><column table="ur_graf_opl_a_d" column="sum_opl" as="ur_graf_opl_sum1" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">ur_graf_opl_a_d.sum_opl as ur_graf_opl_sum1, /*Сумма оплаты по графику*//*number*/
</column><column table="ur_graf_opl_a_d" column="ym_max" as="ur_graf_opl_ym_max1" key="0" used="1" type="number" title="Период оплаты">ur_graf_opl_a_d.ym_max as ur_graf_opl_ym_max1, /*Период оплаты*//*number*/
</column><column table="ur_graf_opl_a_d" column="ym_min" as="ur_graf_opl_ym_min1" key="0" used="1" type="number" title="Период оплаты">ur_graf_opl_a_d.ym_min as ur_graf_opl_ym_min1/*Период оплаты*//*number*/
</column></select><from>
from <query name="ur_graf_opl" dimension="kod_graf_opl" as="ur_graf_opl_a_d" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" haskeys="1" used="1">(
<select>--ur_graf_opl
select <column table="a" column="kod_graf_opl" type="number" key-dimension="kod_graf_opl" as="kod_graf_opl" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="kod_graf_opl" used="1">a.kod_graf_opl as kod_graf_opl, /*number*//*key*/
</column><column table="a" column="sum_opl" type="number" title="Сумма оплаты по графику" fact="ur_graf_opl_sum" agg="sum" vid="1" as="sum_opl" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl" used="1">a.sum_opl as sum_opl, /*Сумма оплаты по графику*//*number*/
</column><column table="a" column="kod_graf" type="number" vid="1" as="kod_graf" reference="ur_graf" refcol="kod_graf" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf, /*number*/
</column><call function="date to ym" title="Период оплаты" as="ym_max" key="0" pth="" type="number" thissrc="ym" column-editable="1" used="1"><text txtype="func"> to_number(to_char( </text><column table="a" column="dat_opl">a.dat_opl</column><text txtype="func"> ,'YYYYMM'))/100 </text> as ym_max, /*Период оплаты*//*number*/
</call><call function="date to ym" title="Период оплаты" as="ym_min" key="0" pth="" type="number" thissrc="ym" column-editable="1" used="1"><text txtype="func"> to_number(to_char( </text><column table="a" column="dat_opl">a.dat_opl</column><text txtype="func"> ,'YYYYMM'))/100 </text> as ym_min/*Период оплаты*//*number*/
</call></select><from>
from <table name="ur_graf_opl" as="a" title="График оплат" dimension="kod_graf_opl" used="1">ur_graf_opl
a
--\ur_graf_opl
</table></from>)
ur_graf_opl_a_d
--\ur_graf_opl
</query><query name="ur_graf" dimension="kod_graf" as="kod_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf/*number*//*key*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="ur_graf_opl_a_d" column="kod_graf">ur_graf_opl_a_d.kod_graf</column><text txtype="func"> = </text><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call>--\ur_graf
</query><qubecontent><where>where
<call function="is not null" condsource="qube_ur_graf"><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column></call></where></qubecontent></from><where>where
<call function="is not null" pth="" type="bool"><column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> is not null </text></call></where>)
--\
</query>)
--\
</query>)
un
--\
</query></from><group> group by
<column table="un" column="kod_graf" group="1" as="kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">un.kod_graf/*number*//*key*/
</column></group>)
qube
--\
</query></from>)
--\
</query>)
--\
</query>)
qube
--\
</query></from>)
qube
--\
</query></from><group> group by
<column table="qube" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/kod_graf" sourcecolumn="kod_graf">qube.kod_graf/*number*//*key*/
</column></group>)
qube
--\
</query><query name="ur_graf" dimension="kod_graf" link-mp-point="1" as="kod_graf" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/kod_graf" haskeys="1" used="1">left outer join
(
<select>--ur_graf
select <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/kod_graf" sourcecolumn="kod_graf" used="1">a.kod_graf as kod_graf/*number*//*key*/
</column></select><from>
from <table name="ur_graf" as="a" dimension="kod_graf" used="1">ur_graf
a
--\ur_graf
</table></from><call function="=" type="bool">)
kod_graf on <column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> = </text><column table="qube" column="kod_graf">qube.kod_graf</column></call>--\ur_graf
</query></from><call function="=" type="bool">)
qube_ur_graf on <column table="a" column="kod_graf" type="number" key-dimension="kod_graf" is-fact="1" agg="max" as="kod_graf" fact="ur_graf_kod_graf" key="1" fixed="1" thissrc="kod_graf">a.kod_graf</column><text txtype="func"> = </text><column table="qube_ur_graf" column="kod_graf">qube_ur_graf.kod_graf</column></call>--\qube_ur_graf
</query></from><call function="=" type="bool">)
kod_graf on <column table="kod_graf" column="kod_graf">kod_graf.kod_graf</column><text txtype="func"> = </text><column table="qube" column="kod_graf">qube.kod_graf</column></call>--\ur_graf
</query><query name="us_graf_status" as="kod_graf_status" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" haskeys="1" used="1">left outer join
(
<select>--us_graf_status
select <column column="kod_graf_status" table="a" type="number" key="1" as="kod_graf_status" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="kod_graf_status" used="1">a.kod_graf_status as kod_graf_status, /*number*//*key*/
</column><column table="a" column="name" type="string" data-size="100" is-name="1" title="Статус графика" as="name" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name" used="1">a.name as name/*Статус графика*//*string*/
</column></select><from>
from <table name="us_graf_status" as="a" used="1">us_graf_status
a
--\us_graf_status
</table></from><call function="=" type="bool">)
kod_graf_status on <column table="kod_graf" column="kod_graf_status">kod_graf.kod_graf_status</column><text txtype="func"> = </text><column table="kod_graf_status" column="kod_graf_status">kod_graf_status.kod_graf_status</column></call>--\us_graf_status
</query><query name="ur_isp" as="kod_isp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_isp" haskeys="1" used="1">left outer join
(
<select>--ur_isp
select <column table="a" column="kod_isp" type="number" key-dimension="kod_isp" as="kod_isp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_isp" sourcecolumn="kod_isp" used="1">a.kod_isp as kod_isp, /*number*//*key*/
</column><column table="a" column="kod_hist_mat" type="number" valid="qube.isp_kod_hist_mat_vld" column-mandatory="1" as="kod_hist_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_isp" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat/*number*/
</column></select><from>
from <table name="ur_isp" as="a" title="Исполнительный лист" used="1">ur_isp
a
--\ur_isp
</table></from><call function="=" type="bool">)
kod_isp on <column table="kod_graf" column="kod_isp">kod_graf.kod_isp</column><text txtype="func"> = </text><column table="kod_isp" column="kod_isp">kod_isp.kod_isp</column></call>--\ur_isp
</query><query name="ur_hist_mat" as="kod_hist_mat_i" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat_i" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat_i" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat_i" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat_i on <column table="kod_isp" column="kod_hist_mat">kod_isp.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat_i" column="kod_hist_mat">kod_hist_mat_i.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_mat" as="kod_mat_i" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_mat_i" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat_i" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat_i" sourcecolumn="num_delo" used="1">a.num_delo as num_delo/*Номер дела*//*string*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
kod_mat_i on <column table="kod_hist_mat_i" column="kod_mat">kod_hist_mat_i.kod_mat</column><text txtype="func"> = </text><column table="kod_mat_i" column="kod_mat">kod_mat_i.kod_mat</column></call>--\ur_mat
</query><query name="ur_hist_mat" as="kod_hist_mat" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat" haskeys="1" used="1">left outer join
(
<select>--ur_hist_mat
select <column table="a" column="kod_hist_mat" type="number" key-dimension="kod_hist_mat" column-mandatory="1" as="kod_hist_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat" sourcecolumn="kod_hist_mat" used="1">a.kod_hist_mat as kod_hist_mat, /*number*//*key*/
</column><column table="a" column="kod_mat" type="number" column-mandatory="1" as="kod_mat" reference="ur_mat" refcol="kod_mat" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_hist_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat/*number*/
</column></select><from>
from <table name="ur_hist_mat" as="a" title="История рассмотрения" used="1">ur_hist_mat
a
--\ur_hist_mat
</table></from><call function="=" type="bool">)
kod_hist_mat on <column table="kod_graf" column="kod_hist_mat">kod_graf.kod_hist_mat</column><text txtype="func"> = </text><column table="kod_hist_mat" column="kod_hist_mat">kod_hist_mat.kod_hist_mat</column></call>--\ur_hist_mat
</query><query name="ur_mat" as="kod_mat" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" haskeys="1" used="1">left outer join
(
<select>--ur_mat
select <column table="a" column="kod_mat" type="number" key-dimension="kod_mat" fact="ur_mat_kod_mat" agg="max" as="kod_mat" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="kod_mat" used="1">a.kod_mat as kod_mat, /*number*//*key*/
</column><column table="a" column="num_delo" type="string" title="Номер дела" fact="ur_mat_num_delo" agg="stragg" mandatory="qube.ur_hist_mat_count" as="num_delo" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo" used="1">a.num_delo as num_delo/*Номер дела*//*string*/
</column></select><from>
from <table name="ur_mat" as="a" title="Материалы переданные в суд" used="1">ur_mat
a
--\ur_mat
</table></from><call function="=" type="bool">)
kod_mat on <column table="kod_hist_mat" column="kod_mat">kod_hist_mat.kod_mat</column><text txtype="func"> = </text><column table="kod_mat" column="kod_mat">kod_mat.kod_mat</column></call>--\ur_mat
</query><query name="kr_dogovor" dimension="kod_dog" link-mp-point="1" as="kod_dog" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" haskeys="1" used="1">left outer join
(
<select>--kr_dogovor
select <column table="a" column="kod_dog" type="number" key-dimension="kod_dog" fact="kr_dogovor_kod_dog" agg="max" fact-dimension="kod_dog" as="kod_dog" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" used="1">a.kod_dog as kod_dog, /*number*//*key*/
</column><column table="a" column="kodp" type="number" title="" comment="код абонента (для договоров услуг - сторона1 - кому платят )" vid="1" as="kodp" reference="kr_payer" refcol="kodp" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kodp" used="1">a.kodp as kodp/**//*number*/
</column></select><from>
from <table name="kr_dogovor" as="a" title="Договор" dimension="kod_dog" used="1">kr_dogovor
a
--\kr_dogovor
</table></from><call function="=" type="bool">)
kod_dog on <column table="kod_dog" column="kod_dog">kod_dog.kod_dog</column><text txtype="func"> = </text><column table="qube" column="kod_dog">qube.kod_dog</column></call>--\kr_dogovor
</query><query name="kr_payer" as="kodp" join="left outer" path="./graf/p1/grsets_query/grpd/grpd/g/kodp" haskeys="1" used="1">left outer join
(
<select>--kr_payer
select <column table="a" column="kodp" type="number" title="" comment="уник. код абонента" fact="kr_payer_kodp" agg="max" as="kodp" key="1" fixed="1" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp" used="1">a.kodp as kodp, /**//*number*//*key*/
</column><column table="a" column="nump" type="string" title="Код абонента" comment="номер абонента" vid="1" is-name="1" as="nump" key="0" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump" used="1">a.nump as nump/*Код абонента*//*string*/
</column></select><from>
from <table name="kr_payer" as="a" title="Абонент" used="1">kr_payer
a
--\kr_payer
</table></from><call function="=" type="bool">)
kodp on <column table="kod_dog" column="kodp">kod_dog.kodp</column><text txtype="func"> = </text><column table="kodp" column="kodp">kodp.kodp</column></call>--\kr_payer
</query></from><where>where
<call function="le" pth="" type="bool"><call function="nvl" pth="">(<text txtype="func"> nvl( </text><column table="kod_graf" column="ym_min">kod_graf.ym_min</column><text txtype="func"> , </text><const type="number"><text>0</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> &lt;= </text><call function="date to ym" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYYMM'))/100 </text>) </call></call></where><group> group by
<column table="kod_graf" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">kod_graf.kod_graf, /*number*//*key*/
</column><column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" reference="kr_dogovor" refcol="kod_dog" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog">kod_dog.kod_dog, /*number*//*key*/
</column><column group="1" table="kodp" column="kodp" as="kodp" key="1" fixed="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">kodp.kodp, /*number*//*key*/
</column><column table="kodp" column="nump" group="1" as="nump" key="1" fixed="1" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">kodp.nump, /*Код абонента*//*string*//*key*/
</column><column column="ym_min" table="kod_graf" group="1" as="ym_min" key="1" fixed="1" used="1" type="number" title="Период оплаты">kod_graf.ym_min, /*Период оплаты*//*number*//*key*/
</column><column group="1" table="kod_graf" column="kod_graf_status" as="kod_graf_status" key="1" fixed="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">kod_graf.kod_graf_status, /*number*//*key*/
</column><call function="nvl" type="string" as="num_delo" key="1" group="1" pth="" used="1" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo"><text txtype="func"> nvl( </text><column table="kod_mat" column="num_delo">kod_mat.num_delo</column><text txtype="func"> , </text><column table="kod_mat_i" column="num_delo">kod_mat_i.num_delo</column><text txtype="func"> ) </text>, /*Номер дела*//*string*//*key*/
</call><column table="kod_graf" column="sum_graf" group="1" as="sum_graf" key="1" fixed="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">kod_graf.sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><call function="||-" as="graf_period" key="1" group="1" pth="" type="string" used="1" title="Период оплаты"><call function="ym to char" pth="" type="string">(<text txtype="func"> trim(to_char( </text><column column="ym_min" table="kod_graf">kod_graf.ym_min</column><text txtype="func"> ,'9999.99')) </text>) </call><text txtype="func"> || '-' || </text><call function="ym to char" pth="" type="string">(<text txtype="func"> trim(to_char( </text><column column="ym_max" table="kod_graf">kod_graf.ym_max</column><text txtype="func"> ,'9999.99')) </text>) </call>, /*Период оплаты*//*string*//*key*/
</call><column table="kod_graf_status" column="name" as="status_name" group="1" key="1" fixed="1" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">kod_graf_status.name/*Статус графика*//*string*//*key*/
</column></group>)
g
--\36703-graf
</query></from><where>where
<call function="and" pth="" type="bool"><call function="true" pth="" type="bool">(<text txtype="func"> 1=1 </text>) </call><text txtype="func"> { </text><text txtype="func"> and </text><call function="not in" pth="" optional="1" type="bool">(<column table="g" column="kod_graf_status">g.kod_graf_status</column><text txtype="func"> not in </text><call function="array" pth="">(<const><text>1</text></const><text txtype="func"> , </text><const><text>2</text></const><text txtype="func"> , </text><const><text>3</text></const>) </call>) </call><text txtype="func"> } </text></call></where>)
grpd
--\
</query></from>)
--\
</query></with><select>--36703-graf_d
select '36703-graf_d' as skod,
'36703-graf_d|#'||mtr.growid as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <column table="graf" column="grsetname" as="grsetname" type="string" key="0" used="1" into="s1">graf.grsetname as grsetname, /*string*/
</column><column table="graf" column="kod_dog" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n1">graf.kod_dog as kod_dog, /*number*/
</column><column table="graf" column="kod_graf" as="kod_graf" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" into="n2">graf.kod_graf as kod_graf, /*number*/
</column><column table="graf" column="kodp" as="kodp" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp" into="n3">graf.kodp as kodp, /*number*/
</column><column table="graf" column="nump" as="nump" key="0" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump" into="s2">graf.nump as nump, /*Код абонента*//*string*/
</column><column table="graf" column="ym_min" as="ym_min" key="0" used="1" type="number" title="Период оплаты" into="n4">graf.ym_min as ym_min, /*Период оплаты*//*number*/
</column><column table="graf" column="kod_graf_status" as="kod_graf_status" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status" into="n5">graf.kod_graf_status as kod_graf_status, /*number*/
</column><column table="graf" column="num_delo" as="num_delo" key="0" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo" into="s3">graf.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="graf" column="sum_graf" as="sum_graf" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl" into="n6">graf.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*/
</column><column table="graf" column="graf_period" as="graf_period" key="0" used="1" type="string" title="Период оплаты" into="s4">graf.graf_period as graf_period, /*Период оплаты*//*string*/
</column><column table="graf" column="graf_nach" as="graf_nach" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl" into="n7">graf.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="graf" column="graf_opl" as="graf_opl" key="0" used="1" type="number" title="Оплачено" agg="sum" into="n8">graf.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="graf" column="graf_ost" as="graf_ost" key="0" used="1" type="number" title="Остаток оплаты" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl" into="n9">graf.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="graf" column="graf_isp" as="graf_isp" key="0" used="1" type="string" title="Исполнено/не исполнено" into="s5">graf.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="graf" column="status_name" as="status_name" key="0" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name" into="s6">graf.status_name as status_name, /*Статус графика*//*string*/
</column><column table="graf" column="gr_rn" as="gr_rn" type="number" key="0" used="1" into="n10">graf.gr_rn as gr_rn, /*number*/
</column><column table="graf" column="growid" as="growid" type="string" title="" key="1" keypath=".growid" used="1" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog" into="s7">graf.growid as growid, /**//*string*//*key*/
</column><column table="graf" column="parent_growid" as="parent_growid" type="string" title="" key="0" used="1" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="s8">graf.parent_growid as parent_growid, /**//*string*/
</column><column table="graf" column="groupingid" as="groupingid" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog" into="n11">graf.groupingid as groupingid, /*number*/
</column><column table="graf" column="grsetid" as="grsetid" type="string" title="" key="0" used="1" into="s9">graf.grsetid as grsetid, /**//*string*/
</column><column table="graf" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" used="1" into="s10">graf.origgrsetid as origgrsetid, /**//*string*/
</column><column table="graf" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" used="1" into="s11">graf.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="graf" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1" into="n12">graf.par_groupingid as par_groupingid, /**//*number*/
</column><column table="dog" column="sid" as="sparentid" key="0" used="1" into="sparentid">dog.sid as sparentid
</column></select><from>
from <query name="36703-graf_d" as="graf" path="./graf" order="kod_dog nulls first,kod_graf nulls first" haskeys="1" used="1">(
<select>--36703-graf_d
select <call function="decode" as="grsetname" type="string" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> , </text><const><text>'2'</text></const><text txtype="func"> , </text><const><text>''</text></const><text txtype="func"> ) </text> as grsetname, /*string*/
</call><column table="p1" column="kod_dog" as="kod_dog" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">p1.kod_dog as kod_dog, /*number*/
</column><column table="p1" column="kod_graf" as="kod_graf" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">p1.kod_graf as kod_graf, /*number*/
</column><column table="p1" column="kodp" as="kodp" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">p1.kodp as kodp, /*number*/
</column><column table="p1" column="nump" as="nump" key="0" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">p1.nump as nump, /*Код абонента*//*string*/
</column><column table="p1" column="ym_min" as="ym_min" key="0" used="1" type="number" title="Период оплаты">p1.ym_min as ym_min, /*Период оплаты*//*number*/
</column><column table="p1" column="kod_graf_status" as="kod_graf_status" key="0" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">p1.kod_graf_status as kod_graf_status, /*number*/
</column><column table="p1" column="num_delo" as="num_delo" key="0" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo">p1.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="p1" column="sum_graf" as="sum_graf" key="0" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">p1.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*/
</column><column table="p1" column="graf_period" as="graf_period" key="0" used="1" type="string" title="Период оплаты">p1.graf_period as graf_period, /*Период оплаты*//*string*/
</column><column table="p1" column="graf_nach" as="graf_nach" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">p1.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="p1" column="graf_opl" as="graf_opl" key="0" used="1" type="number" title="Оплачено" agg="sum">p1.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="p1" column="graf_ost" as="graf_ost" key="0" used="1" type="number" title="Остаток оплаты" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">p1.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="p1" column="graf_isp" as="graf_isp" key="0" used="1" type="string" title="Исполнено/не исполнено">p1.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="p1" column="status_name" as="status_name" key="0" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">p1.status_name as status_name, /*Статус графика*//*string*/
</column><call function="row_number" as="gr_rn" pth="" type="number" key="0" used="1"><text txtype="func"> row_number() over( </text><call function="order by simple" pth="0" type="order"><text txtype="func"> order by </text><const><text>null</text></const></call><text txtype="func"> ) </text> as gr_rn, /*number*/
</call><call function="||" as="growid" type="string" key="1" title="" pth="" used="1" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog"><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_graf" as="kod_graf" thissrc="kod_graf">p1.kod_graf</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const> as growid, /**//*string*//*key*/
</call><call function="if" as="parent_growid" type="string" title="" pth="" key="0" used="1" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog"><text txtype="func"> case </text><text txtype="func"> when </text><call function="is null" pth="" type="bool">(<column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> is null </text>) </call><text txtype="func"> then </text><const><text>null</text></const><text txtype="func"> else </text><call function="||" pth="" type="string">(<const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>1</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_dog" as="kod_dog" thissrc="kod_dog">p1.kod_dog</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const><text txtype="func"> || </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>0</text></const><text txtype="func"> = </text><call function="bitand" pth="" type="number">(<text txtype="func"> bitand( </text><const><text>2</text></const><text txtype="func"> , </text><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" thissrc="par_groupingid">p1.par_groupingid</column><text txtype="func"> ) </text>) </call>) </call><text txtype="func"> then </text><call function="coalesce" pth="">(<text txtype="func"> coalesce( </text><call function="to_char" pth="" type="string">(<text txtype="func"> to_char( </text><column table="p1" column="kod_graf" as="kod_graf" thissrc="kod_graf">p1.kod_graf</column><text txtype="func"> ) </text>) </call><text txtype="func"> , </text><const><text>' '</text></const><text txtype="func"> ) </text>) </call><text txtype="func"> end </text>) </call><text txtype="func"> || </text><const><text>'#'</text></const>) </call><text txtype="func"> end </text> as parent_growid, /**//*string*/
</call><column table="p1" column="groupingid" as="groupingid" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog">p1.groupingid as groupingid, /*number*/
</column><call function="decode" as="grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'graf'</text></const><text txtype="func"> , </text><const><text>'2'</text></const><text txtype="func"> , </text><const><text>'dog'</text></const><text txtype="func"> ) </text> as grsetid, /**//*string*/
</call><call function="decode" as="origgrsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'graf'</text></const><text txtype="func"> , </text><const><text>'2'</text></const><text txtype="func"> , </text><const><text>'dog'</text></const><text txtype="func"> ) </text> as origgrsetid, /**//*string*/
</call><call function="decode" as="parent_grsetid" type="string" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="p1" column="groupingid" as="groupingid" thissrc="groupingid">p1.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'dog'</text></const><text txtype="func"> ) </text> as parent_grsetid, /**//*string*/
</call><column table="p1" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1">p1.par_groupingid as par_groupingid/**//*number*/
</column></select><from>
from <query as="p1" path="./graf/p1" used="1">(
<select>--
select <column table="grsets_query" column="kod_dog" as="kod_dog" keypath=".kod_dog" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grsets_query.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grsets_query" column="kod_graf" as="kod_graf" keypath=".kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">grsets_query.kod_graf as kod_graf, /*number*//*key*/
</column><column table="grsets_query" column="kodp" as="kodp" keypath=".kodp" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">grsets_query.kodp as kodp, /*number*//*key*/
</column><column table="grsets_query" column="nump" as="nump" keypath=".nump" key="1" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">grsets_query.nump as nump, /*Код абонента*//*string*//*key*/
</column><column table="grsets_query" column="ym_min" as="ym_min" keypath=".ym_min" key="1" used="1" type="number" title="Период оплаты">grsets_query.ym_min as ym_min, /*Период оплаты*//*number*//*key*/
</column><column table="grsets_query" column="kod_graf_status" as="kod_graf_status" keypath=".kod_graf_status" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">grsets_query.kod_graf_status as kod_graf_status, /*number*//*key*/
</column><column table="grsets_query" column="num_delo" as="num_delo" keypath=".num_delo" key="1" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo">grsets_query.num_delo as num_delo, /*Номер дела*//*string*//*key*/
</column><column table="grsets_query" column="sum_graf" as="sum_graf" keypath=".sum_graf" key="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">grsets_query.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><column table="grsets_query" column="graf_period" as="graf_period" keypath=".graf_period" key="1" used="1" type="string" title="Период оплаты">grsets_query.graf_period as graf_period, /*Период оплаты*//*string*//*key*/
</column><column table="grsets_query" column="graf_nach" as="graf_nach" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">grsets_query.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="grsets_query" column="graf_opl" as="graf_opl" key="0" used="1" type="number" title="Оплачено" agg="sum">grsets_query.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="grsets_query" column="graf_ost" as="graf_ost" key="0" used="1" type="number" title="Остаток оплаты" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">grsets_query.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="grsets_query" column="graf_isp" as="graf_isp" key="0" used="1" type="string" title="Исполнено/не исполнено">grsets_query.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="grsets_query" column="status_name" as="status_name" keypath=".status_name" key="1" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">grsets_query.status_name as status_name, /*Статус графика*//*string*//*key*/
</column><column table="grsets_query" column="groupingid" as="groupingid" key="0" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog">grsets_query.groupingid as groupingid, /*number*/
</column><call function="decode" as="par_groupingid" type="number" title="" pth="" key="0" used="1"><text txtype="func"> decode( </text><column table="grsets_query" column="groupingid" as="groupingid" thissrc="groupingid">grsets_query.groupingid</column><text txtype="func"> , </text><const><text>'0'</text></const><text txtype="func"> , </text><const><text>'2'</text></const><text txtype="func"> ) </text> as par_groupingid/**//*number*/
</call></select><from>
from <query as="grsets_query" path="./graf/p1/grsets_query" used="1">(
<select>--
select <column table="grpd" column="kod_dog" as="kod_dog" keypath=".kod_dog" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_dog" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">grpd.kod_dog as kod_dog, /*number*//*key*/
</column><column table="grpd" column="kod_graf" as="kod_graf" keypath=".kod_graf" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf">grpd.kod_graf as kod_graf, /*number*//*key*/
</column><column table="grpd" column="kodp" as="kodp" group="max" keypath=".kodp" key="1" used="1" type="number" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="kodp">max(grpd.kodp)  as kodp, /*number*//*key*/
</column><column table="grpd" column="nump" as="nump" group="max" keypath=".nump" key="1" used="1" type="string" title="Код абонента" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kodp" sourcecolumn="nump">max(grpd.nump)  as nump, /*Код абонента*//*string*//*key*/
</column><column table="grpd" column="ym_min" as="ym_min" group="max" keypath=".ym_min" key="1" used="1" type="number" title="Период оплаты">max(grpd.ym_min)  as ym_min, /*Период оплаты*//*number*//*key*/
</column><column table="grpd" column="kod_graf_status" as="kod_graf_status" group="max" keypath=".kod_graf_status" key="1" used="1" type="number" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">max(grpd.kod_graf_status)  as kod_graf_status, /*number*//*key*/
</column><column table="grpd" column="num_delo" as="num_delo" group="max" keypath=".num_delo" key="1" used="1" type="string" title="Номер дела" agg="stragg" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_mat" sourcecolumn="num_delo">max(grpd.num_delo)  as num_delo, /*Номер дела*//*string*//*key*/
</column><column table="grpd" column="sum_graf" as="sum_graf" group="max" keypath=".sum_graf" key="1" used="1" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">max(grpd.sum_graf)  as sum_graf, /*Сумма оплаты по графику*//*number*//*key*/
</column><column table="grpd" column="graf_period" as="graf_period" group="max" keypath=".graf_period" key="1" used="1" type="string" title="Период оплаты">max(grpd.graf_period)  as graf_period, /*Период оплаты*//*string*//*key*/
</column><column table="grpd" column="graf_nach" as="graf_nach" group="max" key="0" used="1" type="number" title="Начислено" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/qube/qube/qube/qube/qube/un/un/ur_graf_opl" sourcecolumn="sum_opl">max(grpd.graf_nach)  as graf_nach, /*Начислено*//*number*/
</column><column table="grpd" column="graf_opl" as="graf_opl" group="max" key="0" used="1" type="number" title="Оплачено" agg="sum">max(grpd.graf_opl)  as graf_opl, /*Оплачено*//*number*/
</column><column table="grpd" column="graf_ost" as="graf_ost" group="max" key="0" used="1" type="number" title="Остаток оплаты" agg="sum" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf/qube_ur_graf/qube/qube/qube/qube/qube/un/un/ur_graf_opl_a_d" sourcecolumn="sum_opl">max(grpd.graf_ost)  as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="grpd" column="graf_isp" as="graf_isp" group="max" key="0" used="1" type="string" title="Исполнено/не исполнено">max(grpd.graf_isp)  as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="grpd" column="status_name" as="status_name" group="max" keypath=".status_name" key="1" used="1" type="string" title="Статус графика" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf_status" sourcecolumn="name">max(grpd.status_name)  as status_name, /*Статус графика*//*string*//*key*/
</column><call function="grouping_id" as="groupingid" pth="" type="number" key="0" used="1" agg="max" sourcetable="./graf/p1/grsets_query/grpd/grpd/g/kod_graf" sourcecolumn="kod_graf" reference="kr_dogovor" refcol="kod_dog"><text txtype="func"> grouping_id( </text><column table="grpd" column="kod_graf">grpd.kod_graf</column><text txtype="func"> , </text><column table="grpd" column="kod_dog">grpd.kod_dog</column><text txtype="func"> ) </text> as groupingid/*number*/
</call></select><from>
from <table name="mat3" as="grpd">mat3
grpd
--\mat3
</table></from><group gset="first">group by grouping sets ((
<column table="grpd" column="kod_graf" as="kod_graf" used="1">grpd.kod_graf, 
</column><column table="grpd" column="kod_dog" as="kod_dog" used="1">grpd.kod_dog
</column>),
</group><group gset="last">(
<column table="grpd" column="kod_dog" as="kod_dog" used="1">grpd.kod_dog
</column>))
</group>)
grsets_query
--\
</query></from>)
p1
--\
</query></from><order>
order by kod_dog nulls first,kod_graf nulls first</order>)
graf
--\36703-graf_d
</query><query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" join="inner" used="1">inner join
(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" key="1" used="1">dog.kod_dog as kod_dog/*number*//*key*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from><call function="=" type="bool">)
dog on <column table="graf" column="kod_dog">graf.kod_dog</column><text txtype="func"> = </text><column table="dog" column="kod_dog">dog.kod_dog</column></call>--\36703-dog
</query></from><order>
order by kod_dog nulls first,kod_graf nulls first</order>) mtr
;
--\36703-graf_d
</query>
  <query name="36703-info-dat" timestamp="21.11.2016 19:03:10" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" materialize="1" noname="1" path="." used="1">
delete from rr_temp where skod = '36703-info-dat';
insert into rr_temp
(
skod, --skod
sid, --sid
rn, --rn
s1, --ssdate
s2--sdate
)
<insert into="rr_temp"><column column="skod" info="skod" /><column column="sid" info="sid" /><column column="rn" info="rn" /><column column="s1" info="ssdate" /><column column="s2" info="sdate" />--36703-info-dat
</insert><select>--36703-info-dat
select '36703-info-dat' as skod,
'36703-info-dat|' as sid,
row_number() over (order by 1) as rn,
mtr.*
from
(
select <call function="||" as="ssdate" title="Дата" key="0" pth="" type="string" used="1" into="s1"><call function="day" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'DD')) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="lower" pth="" type="string">(<text txtype="func"> lower( </text><call function="mes-name-rp" pth="" type="string">(<text txtype="func"> decode ( </text><call function="month" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'MM')) </text>) </call><text txtype="func"> ,1,'Января',2,'Февраля',3,'Марта',4,'Апреля',5,'Мая',6,'Июня',7,'Июля',8,'Августа',9,'Сентября',10,'Октября',11,'Ноября',12,'Декабря') </text>) </call><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="year" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYY')) </text>) </call><text txtype="func"> || </text><const><text>' г.'</text></const> as ssdate, /*Дата*//*string*/
</call><call function="date to char" as="sdate" title="Дата" key="0" pth="" type="string" used="1" into="s2"><text txtype="func"> to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'DD.MM.YYYY') </text> as sdate/*Дата*//*string*/
</call></select><from>
from <query name="dual" as="dual" path="./dual" haskeys="1" used="1">(
<select>--dual
select <column table="dual" column="dummy" type="string" as="dummy" key="1" fixed="1" used="1" sourcetable="./dual" sourcecolumn="dummy">dual.dummy as dummy/*string*//*key*/
</column></select><from>
from <table name="dual" as="dual" fixed="1" used="1">dual
dual
--\dual
</table></from>)
dual
--\dual
</query></from>) mtr
;
--\36703-info-dat
</query>
  <query name="36703-abon" noname="1" path="." used="1">
    <select>--36703-abon
select <column table="abon" column="sid" as="sid" key="0" used="1">abon.sid as sid, 
</column><column table="abon" column="sparentid" as="sparentid" key="0" used="1">abon.sparentid as sparentid, 
</column><column table="abon" column="kodp" as="kodp" type="number" agg="max" key="1" fixed="1" used="1" sourcetable="./kodp" sourcecolumn="kodp">abon.kodp as kodp, /*number*//*key*/
</column><column table="abon" column="nump" as="nump" type="string" title="Код абонента" key="0" used="1" sourcetable="./kodp" sourcecolumn="nump">abon.nump as nump, /*Код абонента*//*string*/
</column><column table="abon" column="name" as="name" type="string" title="Наименование абонента" agg="list" key="0" used="1" sourcetable="./kodp" sourcecolumn="name">abon.name as name, /*Наименование абонента*//*string*/
</column><column table="abon" column="inn" as="inn" type="string" title="ИНН" key="0" used="1" sourcetable="./kodp" sourcecolumn="inn">abon.inn as inn, /*ИНН*//*string*/
</column><column table="abon" column="kpp" as="kpp" type="string" title="КПП" key="0" used="1" sourcetable="./kodp" sourcecolumn="kpp">abon.kpp as kpp, /*КПП*//*string*/
</column><column table="abon" column="fio_ruk" as="fio_ruk" type="string" title="ФИО" key="0" used="1" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="fio">abon.fio_ruk as fio_ruk, /*ФИО*//*string*/
</column><column table="abon" column="tel_ruk" as="tel_ruk" type="string" key="0" used="1" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="tel">abon.tel_ruk as tel_ruk, /*string*/
</column><column table="abon" column="fio_buh" as="fio_buh" type="string" title="ФИО" key="0" used="1" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="fio">abon.fio_buh as fio_buh, /*ФИО*//*string*/
</column><column table="abon" column="tel_buh" as="tel_buh" type="string" key="0" used="1" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="tel">abon.tel_buh as tel_buh, /*string*/
</column><column table="abon" column="name_edo" as="name_edo" type="string" key="0" used="1" sourcetable="./kod_edo" sourcecolumn="name_edo">abon.name_edo as name_edo, /*string*/
</column><column table="abon" column="bk_st_name" as="bk_st_name" type="string" title="Код статуса по справочнику СЮЛСТ/СИПСТ" key="0" used="1" sourcetable="./udo" sourcecolumn="pr_active">abon.bk_st_name as bk_st_name, /*Код статуса по справочнику СЮЛСТ/СИПСТ*//*string*/
</column><column table="abon" column="ur_addr" as="ur_addr" type="string" title="Юридический адрес" key="0" used="1" sourcetable="./kod_d_ur" sourcecolumn="kf_adress_o">abon.ur_addr as ur_addr, /*Юридический адрес*//*string*/
</column><column table="abon" column="real_addr" as="real_addr" type="string" title="Адрес фактический" key="0" used="1" sourcetable="./kod_d" sourcecolumn="kf_adress_o">abon.real_addr as real_addr/*Адрес фактический*//*string*/
</column></select>
    <from>
from <query name="36703-abon" use-repository="1" timestamp="15.05.2024 14:51:04" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1" materialize="2" noname="1" path="./abon" as="abon" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kodp,
s1 as nump,
s2 as name,
s3 as inn,
s4 as kpp,
s5 as fio_ruk,
s6 as tel_ruk,
s7 as fio_buh,
s8 as tel_buh,
s9 as name_edo,
s10 as bk_st_name,
s11 as ur_addr,
s12 as real_addr
from rr_temp where skod = '36703-abon'
<select notext="1">--36703-abon
select <column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1" used="1">kodp.kodp as kodp, /*number*//*key*/
</column><column table="kodp" column="nump" group="max" as="nump" key="0" type="string" title="Код абонента" sourcetable="./kodp" sourcecolumn="nump" into="s1" used="1">max(kodp.nump)  as nump, /*Код абонента*//*string*/
</column><column table="kodp" column="name" group="max" as="name" key="0" type="string" title="Наименование абонента" agg="list" sourcetable="./kodp" sourcecolumn="name" into="s2" used="1">max(kodp.name)  as name, /*Наименование абонента*//*string*/
</column><column table="kodp" column="inn" group="max" as="inn" key="0" type="string" title="ИНН" sourcetable="./kodp" sourcecolumn="inn" into="s3" used="1">max(kodp.inn)  as inn, /*ИНН*//*string*/
</column><column table="kodp" column="kpp" group="max" as="kpp" key="0" type="string" title="КПП" sourcetable="./kodp" sourcecolumn="kpp" into="s4" used="1">max(kodp.kpp)  as kpp, /*КПП*//*string*/
</column><column table="kr_emp_ruk_kod_emp" column="fio" as="fio_ruk" group="max" key="0" type="string" title="ФИО" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="fio" into="s5" used="1">max(kr_emp_ruk_kod_emp.fio)  as fio_ruk, /*ФИО*//*string*/
</column><column table="kr_emp_ruk_kod_emp" column="tel" as="tel_ruk" group="max" key="0" type="string" sourcetable="./kr_emp_ruk_kod_emp" sourcecolumn="tel" into="s6" used="1">max(kr_emp_ruk_kod_emp.tel)  as tel_ruk, /*string*/
</column><column table="kr_emp_buh_kod_emp" column="fio" as="fio_buh" group="max" key="0" type="string" title="ФИО" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="fio" into="s7" used="1">max(kr_emp_buh_kod_emp.fio)  as fio_buh, /*ФИО*//*string*/
</column><column table="kr_emp_buh_kod_emp" column="tel" as="tel_buh" group="max" key="0" type="string" sourcetable="./kr_emp_buh_kod_emp" sourcecolumn="tel" into="s8" used="1">max(kr_emp_buh_kod_emp.tel)  as tel_buh, /*string*/
</column><column table="kod_edo" column="name_edo" group="max" as="name_edo" key="0" type="string" sourcetable="./kod_edo" sourcecolumn="name_edo" into="s9" used="1">max(kod_edo.name_edo)  as name_edo, /*string*/
</column><call as="bk_st_name" function="()" type="string" key="0" group="max" pth="" title="Код статуса по справочнику СЮЛСТ/СИПСТ" sourcetable="./udo" sourcecolumn="pr_active" into="s10" used="1">max(<call function="case" title="Банкрот" type="string" pth="">(<text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="and" pth="" type="bool">(<call function="=" pth="" type="bool">(<column table="udo" column="pr_active">udo.pr_active</column><text txtype="func"> = </text><const type="number"><text>0</text></const>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="kodp" column="ac_egr_status">kodp.ac_egr_status</column><text txtype="func"> = </text><column table="udo" column="sulst">udo.sulst</column>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<column table="udo" column="type_sulst">udo.type_sulst</column><text txtype="func"> = </text><call function="if" pth="">(<text txtype="func"> case </text><text txtype="func"> when </text><call function="is null" pth="" type="bool">(<column table="kodp" column="kpp">kodp.kpp</column><text txtype="func"> is null </text>) </call><text txtype="func"> then </text><const type="string"><text>'ИП'</text></const><text txtype="func"> else </text><const type="string"><text>'ЮЛ'</text></const><text txtype="func"> end </text>) </call>) </call><text txtype="func"> and </text><call function="=" pth="" type="bool">(<call function="case" pth="">(<text txtype="func"> case </text><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'A'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_a">udo.cat_a</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'B'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_b">udo.cat_b</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const type="string"><text>'C'</text></const><text txtype="func"> = </text><const><text>:p_cat_rep </text></const>) </call><text txtype="func"> then </text><column table="udo" column="cat_c">udo.cat_c</column></call><text txtype="func"> end </text>) </call><text txtype="func"> = </text><const type="number"><text>1</text></const>) </call>) </call><text txtype="func"> then </text><column table="udo" column="shortname" type="string">udo.shortname</column></call><call function="when" pth="0" type="when"><text txtype="func"> when </text><call function="=" pth="" type="bool">(<const><text>:p_cat_rep </text></const><text txtype="func"> = </text><const table="udo" column="sulst" type="string"><text>'-'</text></const>) </call><text txtype="func"> then </text><column table="kodp" column="ac_egr_status_name" type="string">kodp.ac_egr_status_name</column></call><text txtype="func"> end </text>) </call>)  as bk_st_name, /*Код статуса по справочнику СЮЛСТ/СИПСТ*//*string*/
</call><column group="max" table="kod_d_ur" column="kf_adress_o" title="Юридический адрес" as="ur_addr" key="0" type="string" sourcetable="./kod_d_ur" sourcecolumn="kf_adress_o" into="s11" used="1">max(kod_d_ur.kf_adress_o)  as ur_addr, /*Юридический адрес*//*string*/
</column><column group="max" table="kod_d" column="kf_adress_o" title="Адрес фактический" as="real_addr" key="0" type="string" sourcetable="./kod_d" sourcecolumn="kf_adress_o" into="s12" used="1">max(kod_d.kf_adress_o)  as real_addr/*Адрес фактический*//*string*/
</column></select><from notext="1">
from <table name="qube" as="qube">qube
qube
--\qube
</table><table name="kodp" as="kodp" used="1">kodp
kodp
--\kodp
</table><table name="udo" as="udo" used="1">udo
udo
--\udo
</table><table name="kod_d" as="kod_d" used="1">kod_d
kod_d
--\kod_d
</table><table name="kod_d_ur" as="kod_d_ur" used="1">kod_d_ur
kod_d_ur
--\kod_d_ur
</table><table name="kodp1" as="kodp1">kodp1
kodp1
--\kodp1
</table><table name="kr_org_edo" as="kr_org_edo">kr_org_edo
kr_org_edo
--\kr_org_edo
</table><table name="kod_edo" as="kod_edo" used="1">kod_edo
kod_edo
--\kod_edo
</table><table name="kr_emp_buh_kod_emp" as="kr_emp_buh_kod_emp" used="1">kr_emp_buh_kod_emp
kr_emp_buh_kod_emp
--\kr_emp_buh_kod_emp
</table><table name="kr_emp_ruk_kod_emp" as="kr_emp_ruk_kod_emp" used="1">kr_emp_ruk_kod_emp
kr_emp_ruk_kod_emp
--\kr_emp_ruk_kod_emp
</table></from><group notext="1"> group by
<column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" type="number" agg="max" sourcetable="./kodp" sourcecolumn="kodp" into="n1" used="1">kodp.kodp/*number*//*key*/
</column></group>)
abon
--\36703-abon
</query></from>--\36703-abon
</query>
  <query name="36703-dog" noname="1" path="." used="1">
    <select>--36703-dog
select <column table="dog" column="sid" as="sid" key="0" used="1">dog.sid as sid, 
</column><column table="dog" column="sparentid" as="sparentid" key="0" used="1">dog.sparentid as sparentid, 
</column><column table="dog" column="kod_dog" as="kod_dog" type="number" agg="max" key="1" used="1" sourcetable="./dog" sourcecolumn="kod_dog">dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dog" column="kodp" as="kodp" type="number" key="0" used="1" sourcetable="./dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp">dog.kodp as kodp, /*number*/
</column><column table="dog" column="name" as="name" type="string" title="Договор" agg="stragg_dist" key="0" used="1" sourcetable="./dog" sourcecolumn="name">dog.name as name, /*Договор*//*string*/
</column><column table="dog" column="ndog" as="ndog" type="string" title="Номер договора" agg="stragg_dist" key="0" used="1" sourcetable="./dog" sourcecolumn="ndog">dog.ndog as ndog, /*Номер договора*//*string*/
</column><column table="dog" column="name_bzad" as="name_bzad" type="string" title="Наименование" key="0" used="1" sourcetable="./dog" sourcecolumn="name_bzad">dog.name_bzad as name_bzad/*Наименование*//*string*/
</column></select>
    <from>
from <query name="36703-dog" noname="1" materialize="2" path="./dog" as="dog" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog,
n2 as kodp,
s1 as name,
s2 as ndog,
s3 as name_bzad
from rr_temp where skod = '36703-dog'
<select notext="1">--36703-dog
select <column table="dog" column="kod_dog" as="kod_dog" key="1" keypath=".kod_dog" type="number" agg="max" sourcetable="./dog" sourcecolumn="kod_dog" into="n1" used="1">dog.kod_dog as kod_dog, /*number*//*key*/
</column><column table="dog" column="kodp" as="kodp" key="0" type="number" sourcetable="./dog" sourcecolumn="kodp" reference="kr_payer" refcol="kodp" into="n2" used="1">dog.kodp as kodp, /*number*/
</column><column table="dog" column="name" as="name" key="0" type="string" title="Договор" agg="stragg_dist" into="s1" used="1" sourcetable="./dog" sourcecolumn="name">dog.name as name, /*Договор*//*string*/
</column><column table="dog" column="ndog" as="ndog" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./dog" sourcecolumn="ndog" into="s2" used="1">dog.ndog as ndog, /*Номер договора*//*string*/
</column><column table="dog" column="name_bzad" as="name_bzad" key="0" type="string" title="Наименование" into="s3" used="1" sourcetable="./dog" sourcecolumn="name_bzad">dog.name_bzad as name_bzad/*Наименование*//*string*/
</column></select><from notext="1">
from <table name="dog" as="dog" used="1">dog
dog
--\dog
</table><table name="abon" as="abon">abon
abon
--\abon
</table></from>)
dog
--\36703-dog
</query></from>--\36703-dog
</query>
  <query name="36703-fin-dat" noname="1" path="." used="1">
    <select>--36703-fin-dat
select <column table="fin" column="sid" as="sid" key="0" used="1">fin.sid as sid, 
</column><column table="fin" column="sparentid" as="sparentid" key="0" used="1">fin.sparentid as sparentid, 
</column><column table="fin" column="grsetname" as="grsetname" type="string" key="0" used="1" sourcetable="./fin" sourcecolumn="grsetname">fin.grsetname as grsetname, /*string*/
</column><column table="fin" column="kod_dog" as="kod_dog" type="number" agg="max" c-master-key="kod_dog" key="0" used="1" sourcetable="./fin" sourcecolumn="kod_dog">fin.kod_dog as kod_dog, /*number*/
</column><column table="fin" column="ndog" as="ndog" type="string" title="Номер договора" agg="stragg_dist" c-master="kod_dog" key="0" used="1" sourcetable="./fin" sourcecolumn="ndog">fin.ndog as ndog, /*Номер договора*//*string*/
</column><column table="fin" column="name" as="name" type="string" title="Отделение" c-master="kod_dog" key="0" used="1" sourcetable="./fin" sourcecolumn="name">fin.name as name, /*Отделение*//*string*/
</column><column table="fin" column="nump" as="nump" type="string" title="Код абонента" c-master="kod_dog" key="0" used="1" sourcetable="./fin" sourcecolumn="nump">fin.nump as nump, /*Код абонента*//*string*/
</column><column table="fin" column="ym_vozn" as="ym_vozn" type="number" title="Отчетный период начисления" format="F2" c-master-key="ym_vozn" key="0" used="1" sourcetable="./fin" sourcecolumn="ym_vozn">fin.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="kod_sf" as="kod_sf" type="number" c-master-key="kod_sf" key="0" used="1" sourcetable="./fin" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf">fin.kod_sf as kod_sf, /*number*/
</column><column table="fin" column="dat_bzad" as="dat_bzad" type="date" title="Дата возникновения обязательства по погашению задолженности" key="0" used="1" sourcetable="./fin" sourcecolumn="dat_bzad">fin.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="fin" column="ym" as="ym" type="number" title="Отчетный период начисления" format="F2" c-master="kod_sf" key="0" used="1" sourcetable="./fin" sourcecolumn="ym">fin.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="name_podpis" as="name_podpis" type="string" key="0" used="1" sourcetable="./fin" sourcecolumn="name_podpis">fin.name_podpis as name_podpis, /*string*/
</column><column table="fin" column="name_plat" as="name_plat" type="string" title="Наименование платежа" agg="max" format="F2" key="0" used="1" sourcetable="./fin" sourcecolumn="name_plat">fin.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="fin" column="nach" as="nach" type="number" title="Начислено" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="nach">fin.nach as nach, /*Начислено*//*number*/
</column><column table="fin" column="opl_nach" as="opl_nach" type="number" title="Оплата начислений" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="opl_nach">fin.opl_nach as opl_nach, /*Оплата начислений*//*number*/
</column><column table="fin" column="opl" as="opl" type="number" title="Оплата (поступление на счет)" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="opl">fin.opl as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="fin" column="dolg" as="dolg" type="number" title="Оборот" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="dolg">fin.dolg as dolg, /*Оборот*//*number*/
</column><column table="fin" column="dolg_check" as="dolg_check" type="number" title="Оборот" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="dolg_check">fin.dolg_check as dolg_check, /*Оборот*//*number*/
</column><column table="fin" column="dolg_pros" as="dolg_pros" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="dolg_pros">fin.dolg_pros as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="fin" column="dolg_kred_os" as="dolg_kred_os" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="dolg_kred_os">fin.dolg_kred_os as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="dolg_kred_av" as="dolg_kred_av" type="number" title="Кредиторская задолженность  по  авансам" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="dolg_kred_av">fin.dolg_kred_av as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="fin" column="dolg_kred" as="dolg_kred" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" key="0" used="1" sourcetable="./fin" sourcecolumn="dolg_kred">fin.dolg_kred as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="pr_dog" as="pr_dog" type="number" title=" " agg="max" key="0" is-fact-use="1" used="1" sourcetable="./fin" sourcecolumn="pr_dog">fin.pr_dog as pr_dog, /* *//*number*/
</column><column table="fin" column="visitog" as="visitog" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visitog">fin.visitog as visitog, /*number*/
</column><column table="fin" column="visitog_deb" as="visitog_deb" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visitog_deb">fin.visitog_deb as visitog_deb, /*number*/
</column><column table="fin" column="visitog_osn_av" as="visitog_osn_av" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visitog_osn_av">fin.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="fin" column="visitog_osn" as="visitog_osn" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visitog_osn">fin.visitog_osn as visitog_osn, /*number*/
</column><column table="fin" column="visdet_osn" as="visdet_osn" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visdet_osn">fin.visdet_osn as visdet_osn, /*number*/
</column><column table="fin" column="visdet_av" as="visdet_av" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visdet_av">fin.visdet_av as visdet_av, /*number*/
</column><column table="fin" column="visdet_othr" as="visdet_othr" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="visdet_othr">fin.visdet_othr as visdet_othr, /*number*/
</column><column table="fin" column="gr_rn" as="gr_rn" type="number" key="0" used="1" sourcetable="./fin" sourcecolumn="gr_rn">fin.gr_rn as gr_rn, /*number*/
</column><column table="fin" column="growid" as="growid" type="string" title="" agg="max" format="F2" c-master-key="kod_sf" key="1" used="1" sourcetable="./fin" sourcecolumn="growid" reference="sr_facvip" refcol="kod_sf">fin.growid as growid, /**//*string*//*key*/
</column><column table="fin" column="parent_growid" as="parent_growid" type="string" title="" agg="max" format="F2" c-master-key="kod_dog" key="0" used="1" sourcetable="./fin" sourcecolumn="parent_growid" reference="sr_facvip" refcol="kod_sf">fin.parent_growid as parent_growid, /**//*string*/
</column><column table="fin" column="groupingid" as="groupingid" type="number" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" key="0" used="1" sourcetable="./fin" sourcecolumn="groupingid" reference="sr_facvip" refcol="kod_sf">fin.groupingid as groupingid, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="grsetid" as="grsetid" type="string" title="" key="0" used="1" sourcetable="./fin" sourcecolumn="grsetid">fin.grsetid as grsetid, /**//*string*/
</column><column table="fin" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" used="1" sourcetable="./fin" sourcecolumn="origgrsetid">fin.origgrsetid as origgrsetid, /**//*string*/
</column><column table="fin" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" used="1" sourcetable="./fin" sourcecolumn="parent_grsetid">fin.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="fin" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1" sourcetable="./fin" sourcecolumn="par_groupingid">fin.par_groupingid as par_groupingid/**//*number*/
</column></select>
    <from>
from <query name="36703-fin-dat" noname="1" order="kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first" materialize="2" path="./fin" as="fin" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
s1 as grsetname,
n1 as kod_dog,
s2 as ndog,
s3 as name,
s4 as nump,
n2 as ym_vozn,
n3 as kod_sf,
d1 as dat_bzad,
n4 as ym,
s5 as name_podpis,
s6 as name_plat,
n5 as nach,
n6 as opl_nach,
n7 as opl,
n8 as dolg,
n9 as dolg_check,
n10 as dolg_pros,
n11 as dolg_kred_os,
n12 as dolg_kred_av,
n13 as dolg_kred,
n14 as pr_dog,
n15 as visitog,
n16 as visitog_deb,
n17 as visitog_osn_av,
n18 as visitog_osn,
n19 as visdet_osn,
n20 as visdet_av,
n21 as visdet_othr,
n22 as gr_rn,
s7 as growid,
s8 as parent_growid,
n23 as groupingid,
s9 as grsetid,
s10 as origgrsetid,
s11 as parent_grsetid,
n24 as par_groupingid
from rr_temp where skod = '36703-fin-dat'
<select notext="1">--36703-fin-dat
select <column table="fin" column="grsetname" as="grsetname" type="string" key="0" into="s1" used="1" sourcetable="./fin" sourcecolumn="grsetname">fin.grsetname as grsetname, /*string*/
</column><column table="fin" column="kod_dog" as="kod_dog" c-master-key="kod_dog" key="0" type="number" agg="max" sourcetable="./fin" sourcecolumn="kod_dog" into="n1" used="1">fin.kod_dog as kod_dog, /*number*/
</column><column table="fin" column="ndog" as="ndog" c-master="kod_dog" key="0" type="string" title="Номер договора" agg="stragg_dist" sourcetable="./fin" sourcecolumn="ndog" into="s2" used="1">fin.ndog as ndog, /*Номер договора*//*string*/
</column><column table="fin" column="name" as="name" c-master="kod_dog" key="0" type="string" title="Отделение" sourcetable="./fin" sourcecolumn="name" into="s3" used="1">fin.name as name, /*Отделение*//*string*/
</column><column table="fin" column="nump" as="nump" c-master="kod_dog" key="0" type="string" title="Код абонента" sourcetable="./fin" sourcecolumn="nump" into="s4" used="1">fin.nump as nump, /*Код абонента*//*string*/
</column><column table="fin" column="ym_vozn" as="ym_vozn" c-master-key="ym_vozn" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin" sourcecolumn="ym_vozn" into="n2" used="1">fin.ym_vozn as ym_vozn, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="kod_sf" as="kod_sf" c-master-key="kod_sf" key="0" type="number" sourcetable="./fin" sourcecolumn="kod_sf" reference="sr_facvip" refcol="kod_sf" into="n3" used="1">fin.kod_sf as kod_sf, /*number*/
</column><column table="fin" column="dat_bzad" as="dat_bzad" key="0" type="date" title="Дата возникновения обязательства по погашению задолженности" sourcetable="./fin" sourcecolumn="dat_bzad" into="d1" used="1">fin.dat_bzad as dat_bzad, /*Дата возникновения обязательства по погашению задолженности*//*date*/
</column><column table="fin" column="ym" as="ym" c-master="kod_sf" key="0" type="number" title="Отчетный период начисления" format="F2" sourcetable="./fin" sourcecolumn="ym" into="n4" used="1">fin.ym as ym, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="name_podpis" as="name_podpis" key="0" type="string" into="s5" used="1" sourcetable="./fin" sourcecolumn="name_podpis">fin.name_podpis as name_podpis, /*string*/
</column><column table="fin" column="name_plat" as="name_plat" key="0" type="string" title="Наименование платежа" agg="max" format="F2" sourcetable="./fin" sourcecolumn="name_plat" into="s6" used="1">fin.name_plat as name_plat, /*Наименование платежа*//*string*/
</column><column table="fin" column="nach" as="nach" is-fact-use="1" key="0" type="number" title="Начислено" agg="sum" sourcetable="./fin" sourcecolumn="nach" into="n5" used="1">fin.nach as nach, /*Начислено*//*number*/
</column><column table="fin" column="opl_nach" as="opl_nach" is-fact-use="1" key="0" type="number" title="Оплата начислений" agg="sum" into="n6" used="1" sourcetable="./fin" sourcecolumn="opl_nach">fin.opl_nach as opl_nach, /*Оплата начислений*//*number*/
</column><column table="fin" column="opl" as="opl" is-fact-use="1" key="0" type="number" title="Оплата (поступление на счет)" agg="sum" into="n7" used="1" sourcetable="./fin" sourcecolumn="opl">fin.opl as opl, /*Оплата (поступление на счет)*//*number*/
</column><column table="fin" column="dolg" as="dolg" is-fact-use="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin" sourcecolumn="dolg" into="n8" used="1">fin.dolg as dolg, /*Оборот*//*number*/
</column><column table="fin" column="dolg_check" as="dolg_check" is-fact-use="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./fin" sourcecolumn="dolg_check" into="n9" used="1">fin.dolg_check as dolg_check, /*Оборот*//*number*/
</column><column table="fin" column="dolg_pros" as="dolg_pros" is-fact-use="1" key="0" type="number" title="Дата возникновения обязательства по погашению задолженности" agg="sum" format="F2" sourcetable="./fin" sourcecolumn="dolg_pros" into="n10" used="1">fin.dolg_pros as dolg_pros, /*Дата возникновения обязательства по погашению задолженности*//*number*/
</column><column table="fin" column="dolg_kred_os" as="dolg_kred_os" is-fact-use="1" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" into="n11" used="1" sourcetable="./fin" sourcecolumn="dolg_kred_os">fin.dolg_kred_os as dolg_kred_os, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="dolg_kred_av" as="dolg_kred_av" is-fact-use="1" key="0" type="number" title="Кредиторская задолженность  по  авансам" agg="sum" into="n12" used="1" sourcetable="./fin" sourcecolumn="dolg_kred_av">fin.dolg_kred_av as dolg_kred_av, /*Кредиторская задолженность  по  авансам*//*number*/
</column><column table="fin" column="dolg_kred" as="dolg_kred" key="0" type="number" title="Кредиторская задолженность  по осн. реал" agg="sum" into="n13" used="1" sourcetable="./fin" sourcecolumn="dolg_kred">fin.dolg_kred as dolg_kred, /*Кредиторская задолженность  по осн. реал*//*number*/
</column><column table="fin" column="pr_dog" as="pr_dog" is-fact-use="1" key="0" type="number" title=" " agg="max" sourcetable="./fin" sourcecolumn="pr_dog" into="n14" used="1">fin.pr_dog as pr_dog, /* *//*number*/
</column><column table="fin" column="visitog" as="visitog" key="0" type="number" into="n15" used="1" sourcetable="./fin" sourcecolumn="visitog">fin.visitog as visitog, /*number*/
</column><column table="fin" column="visitog_deb" as="visitog_deb" key="0" type="number" into="n16" used="1" sourcetable="./fin" sourcecolumn="visitog_deb">fin.visitog_deb as visitog_deb, /*number*/
</column><column table="fin" column="visitog_osn_av" as="visitog_osn_av" key="0" type="number" into="n17" used="1" sourcetable="./fin" sourcecolumn="visitog_osn_av">fin.visitog_osn_av as visitog_osn_av, /*number*/
</column><column table="fin" column="visitog_osn" as="visitog_osn" key="0" type="number" into="n18" used="1" sourcetable="./fin" sourcecolumn="visitog_osn">fin.visitog_osn as visitog_osn, /*number*/
</column><column table="fin" column="visdet_osn" as="visdet_osn" key="0" type="number" into="n19" used="1" sourcetable="./fin" sourcecolumn="visdet_osn">fin.visdet_osn as visdet_osn, /*number*/
</column><column table="fin" column="visdet_av" as="visdet_av" key="0" type="number" into="n20" used="1" sourcetable="./fin" sourcecolumn="visdet_av">fin.visdet_av as visdet_av, /*number*/
</column><column table="fin" column="visdet_othr" as="visdet_othr" key="0" type="number" into="n21" used="1" sourcetable="./fin" sourcecolumn="visdet_othr">fin.visdet_othr as visdet_othr, /*number*/
</column><column table="fin" column="gr_rn" as="gr_rn" type="number" key="0" into="n22" used="1" sourcetable="./fin" sourcecolumn="gr_rn">fin.gr_rn as gr_rn, /*number*/
</column><column table="fin" column="growid" as="growid" type="string" title="" keypath=".growid" key="1" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin" sourcecolumn="growid" reference="sr_facvip" refcol="kod_sf" into="s7" used="1">fin.growid as growid, /**//*string*//*key*/
</column><column table="fin" column="parent_growid" as="parent_growid" type="string" title="" key="0" agg="max" format="F2" c-master-key="kod_dog" sourcetable="./fin" sourcecolumn="parent_growid" reference="sr_facvip" refcol="kod_sf" into="s8" used="1">fin.parent_growid as parent_growid, /**//*string*/
</column><column table="fin" column="groupingid" as="groupingid" key="0" type="number" title="Отчетный период начисления" agg="max" format="F2" c-master-key="kod_sf" sourcetable="./fin" sourcecolumn="groupingid" reference="sr_facvip" refcol="kod_sf" into="n23" used="1">fin.groupingid as groupingid, /*Отчетный период начисления*//*number*/
</column><column table="fin" column="grsetid" as="grsetid" type="string" title="" key="0" into="s9" used="1" sourcetable="./fin" sourcecolumn="grsetid">fin.grsetid as grsetid, /**//*string*/
</column><column table="fin" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" into="s10" used="1" sourcetable="./fin" sourcecolumn="origgrsetid">fin.origgrsetid as origgrsetid, /**//*string*/
</column><column table="fin" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" into="s11" used="1" sourcetable="./fin" sourcecolumn="parent_grsetid">fin.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="fin" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" into="n24" used="1" sourcetable="./fin" sourcecolumn="par_groupingid">fin.par_groupingid as par_groupingid/**//*number*/
</column></select><from notext="1">
from <table name="fin" as="fin" used="1">fin
fin
--\fin
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by kod_dog nulls first,kod_sf nulls first,ym_vozn nulls first,kod_sf nulls first,ym_vozn nulls first,ym_vozn nulls first</order>)
fin
--\36703-fin-dat
</query></from>--\36703-fin-dat
</query>
  <query name="36703-avans-info" noname="1" path="." used="1">
    <select>--36703-avans-info
select <column table="av_info" column="sid" as="sid" key="0" used="1">av_info.sid as sid, 
</column><column table="av_info" column="sparentid" as="sparentid" key="0" used="1">av_info.sparentid as sparentid, 
</column><column table="av_info" column="kod_vist_day" as="kod_vist_day" type="number" key="1" fixed="1" used="1" sourcetable="./av_info" sourcecolumn="kod_vist_day">av_info.kod_vist_day as kod_vist_day, /*number*//*key*/
</column><column table="av_info" column="kod_dog" as="kod_dog" type="number" agg="max" key="0" used="1" sourcetable="./av_info" sourcecolumn="kod_dog">av_info.kod_dog as kod_dog, /*number*/
</column><column table="av_info" column="name" as="name" type="string" title="Наименование" key="0" used="1" sourcetable="./av_info" sourcecolumn="name">av_info.name as name/*Наименование*//*string*/
</column></select>
    <from>
from <query name="36703-avans-info" noname="1" materialize="2" path="./av_info" as="av_info" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_vist_day,
n2 as kod_dog,
s1 as name
from rr_temp where skod = '36703-avans-info'
<select notext="1">--36703-avans-info
select <column table="av_info" column="kod_vist_day" as="kod_vist_day" fixed="1" key="1" keypath=".kod_vist_day" type="number" sourcetable="./av_info" sourcecolumn="kod_vist_day" into="n1" used="1">av_info.kod_vist_day as kod_vist_day, /*number*//*key*/
</column><column table="av_info" column="kod_dog" as="kod_dog" key="0" type="number" agg="max" sourcetable="./av_info" sourcecolumn="kod_dog" into="n2" used="1">av_info.kod_dog as kod_dog, /*number*/
</column><column table="av_info" column="name" as="name" type="string" key="0" title="Наименование" sourcetable="./av_info" sourcecolumn="name" into="s1" used="1">av_info.name as name/*Наименование*//*string*/
</column></select><from notext="1">
from <table name="av_info" as="av_info" used="1">av_info
av_info
--\av_info
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from>)
av_info
--\36703-avans-info
</query></from>--\36703-avans-info
</query>
  <query name="36703-dog-lim" noname="1" path="." used="1">
    <select>--36703-dog-lim
select <column table="lim" column="sid" as="sid" key="0" used="1">lim.sid as sid, 
</column><column table="lim" column="sparentid" as="sparentid" key="0" used="1">lim.sparentid as sparentid, 
</column><column table="lim" column="kod_dog" as="kod_dog" type="number" agg="max" key="1" used="1" sourcetable="./lim" sourcecolumn="kod_dog">lim.kod_dog as kod_dog, /*number*//*key*/
</column><column table="lim" column="nump" as="nump" type="string" title="Код абонента" key="0" used="1" sourcetable="./lim" sourcecolumn="nump">lim.nump as nump, /*Код абонента*//*string*/
</column><column table="lim" column="limit" as="limit" type="number" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./lim" sourcecolumn="limit">lim.limit as limit/*number*/
</column></select>
    <from>
from <query name="36703-dog-lim" noname="1" materialize="2" path="./lim" as="lim" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_dog,
s1 as nump,
n2 as limit
from rr_temp where skod = '36703-dog-lim'
<select notext="1">--36703-dog-lim
select <column table="lim" column="kod_dog" as="kod_dog" key="1" keypath=".kod_dog" type="number" agg="max" sourcetable="./lim" sourcecolumn="kod_dog" into="n1" used="1">lim.kod_dog as kod_dog, /*number*//*key*/
</column><column table="lim" column="nump" as="nump" key="0" type="string" title="Код абонента" sourcetable="./lim" sourcecolumn="nump" into="s1" used="1">lim.nump as nump, /*Код абонента*//*string*/
</column><column table="lim" column="limit" as="limit" is-fact-use="1" key="0" type="number" agg="sum" sourcetable="./lim" sourcecolumn="limit" into="n2" used="1">lim.limit as limit/*number*/
</column></select><from notext="1">
from <table name="lim" as="lim" used="1">lim
lim
--\lim
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from>)
lim
--\36703-dog-lim
</query></from>--\36703-dog-lim
</query>
  <query name="36703-obj" noname="1" path="." used="1">
    <order notext="1">
      <column column="num_obj_par">num_obj_par</column>
      <column column="num_objnullsfirst">num_objnullsfirst</column>
    </order>
    <select>--36703-obj
select <column table="obj" column="sid" as="sid" key="0" used="1">obj.sid as sid, 
</column><column table="obj" column="sparentid" as="sparentid" key="0" used="1">obj.sparentid as sparentid, 
</column><column table="obj" column="kod_numobj" as="kod_numobj" type="number" agg="max" key="1" fixed="1" used="1" sourcetable="./obj" sourcecolumn="kod_numobj">obj.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="obj" column="kod_dog" as="kod_dog" type="number" agg="max" key="0" used="1" sourcetable="./obj" sourcecolumn="kod_dog">obj.kod_dog as kod_dog, /*number*/
</column><column table="obj" column="num_obj_par" as="num_obj_par" type="number" title="Номер объекта договора" agg="list" key="0" used="1" sourcetable="./obj" sourcecolumn="num_obj_par">obj.num_obj_par as num_obj_par, /*Номер объекта договора*//*number*/
</column><column table="obj" column="num_obj" as="num_obj" type="number" title="Номер объекта договора" agg="list" key="0" used="1" sourcetable="./obj" sourcecolumn="num_obj">obj.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="obj" column="name" as="name" type="string" title="Номер объекта договора" agg="list" key="0" used="1" sourcetable="./obj" sourcecolumn="name" reference="k_house" refcol="kodd">obj.name as name/*Номер объекта договора*//*string*/
</column></select>
    <from>
from <query name="36703-obj" noname="1" order="num_obj_par,num_obj nulls first" materialize="2" path="./obj" as="obj" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_numobj,
n2 as kod_dog,
n3 as num_obj_par,
n4 as num_obj,
s1 as name
from rr_temp where skod = '36703-obj'
<select notext="1">--36703-obj
select <column table="obj" column="kod_numobj" as="kod_numobj" fixed="1" key="1" keypath=".kod_numobj" type="number" agg="max" sourcetable="./obj" sourcecolumn="kod_numobj" into="n1" used="1">obj.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="obj" column="kod_dog" as="kod_dog" key="0" type="number" agg="max" sourcetable="./obj" sourcecolumn="kod_dog" into="n2" used="1">obj.kod_dog as kod_dog, /*number*/
</column><column table="obj" column="num_obj_par" as="num_obj_par" type="number" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj" sourcecolumn="num_obj_par" into="n3" used="1">obj.num_obj_par as num_obj_par, /*Номер объекта договора*//*number*/
</column><column table="obj" column="num_obj" as="num_obj" type="number" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj" sourcecolumn="num_obj" into="n4" used="1">obj.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="obj" column="name" as="name" type="string" key="0" title="Номер объекта договора" agg="list" sourcetable="./obj" sourcecolumn="name" reference="k_house" refcol="kodd" into="s1" used="1">obj.name as name/*Номер объекта договора*//*string*/
</column></select><from notext="1">
from <table name="obj" as="obj" used="1">obj
obj
--\obj
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by num_obj_par,num_obj nulls first</order>)
obj
--\36703-obj
</query></from>--\36703-obj
</query>
  <query name="36703-isk" noname="1" path="." used="1">
    <select>--36703-isk
select <column table="isk" column="sid" as="sid" key="0" used="1">isk.sid as sid, 
</column><column table="isk" column="sparentid" as="sparentid" key="0" used="1">isk.sparentid as sparentid, 
</column><column table="isk" column="grsetname" as="grsetname" type="string" key="0" used="1" sourcetable="./isk" sourcecolumn="grsetname">isk.grsetname as grsetname, /*string*/
</column><column table="isk" column="kod_mat" as="kod_mat" type="number" agg="max" c-master-key="kod_mat" key="0" used="1" sourcetable="./isk" sourcecolumn="kod_mat">isk.kod_mat as kod_mat, /*number*/
</column><column table="isk" column="kod_dog" as="kod_dog" type="number" agg="max" c-master-key="kod_dog" key="0" used="1" sourcetable="./isk" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">isk.kod_dog as kod_dog, /*number*/
</column><column table="isk" column="kod_hist_mat_desc" as="kod_hist_mat_desc" type="number" c-master-key="kod_hist_mat_desc" key="0" used="1" sourcetable="./isk" sourcecolumn="kod_hist_mat_desc">isk.kod_hist_mat_desc as kod_hist_mat_desc, /*number*/
</column><column table="isk" column="kod_isp" as="kod_isp" type="number" c-master-key="kod_isp" key="0" used="1" sourcetable="./isk" sourcecolumn="kod_isp">isk.kod_isp as kod_isp, /*number*/
</column><column table="isk" column="num_delo" as="num_delo" type="string" title="Номер дела" agg="stragg" c-master="kod_mat" key="0" used="1" sourcetable="./isk" sourcecolumn="num_delo">isk.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="isk" column="vist" as="vist" type="number" title="Выставленно по юр. документу" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./isk" sourcecolumn="vist">isk.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="isk" column="period" as="period" type="string" title="Отчетный период" agg="stragg" format="F2" key="0" used="1" sourcetable="./isk" sourcecolumn="period">isk.period as period, /*Отчетный период*//*string*/
</column><column table="isk" column="resh_res" as="resh_res" type="string" title="Результат рассмотрения" c-master="kod_hist_mat_desc" key="0" used="1" sourcetable="./isk" sourcecolumn="resh_res">isk.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="isk" column="dat_rassm" as="dat_rassm" type="date" title="Дата/время суд. разб." c-master="kod_hist_mat_desc" key="0" used="1" sourcetable="./isk" sourcecolumn="dat_rassm">isk.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="isk" column="dat_post" as="dat_post" type="date" title="Дата прин. суд. акта" c-master="kod_hist_mat_desc" key="0" used="1" sourcetable="./isk" sourcecolumn="dat_post">isk.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="isk" column="prim" as="prim" type="string" title="Примечание" c-master="kod_hist_mat_desc" key="0" used="1" sourcetable="./isk" sourcecolumn="prim">isk.prim as prim, /*Примечание*//*string*/
</column><column table="isk" column="name_st" as="name_st" type="string" title="Юр. статус" key="0" used="1" sourcetable="./isk" sourcecolumn="name_st">isk.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="isk" column="num_il" as="num_il" type="string" title="Номер исп. листа" c-master="kod_isp" key="0" used="1" sourcetable="./isk" sourcecolumn="num_il">isk.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="isk" column="dat_v_il" as="dat_v_il" type="date" title="Дата выдачи исп. листа" agg="max" c-master="kod_isp" key="0" used="1" sourcetable="./isk" sourcecolumn="dat_v_il">isk.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="isk" column="dat_v_silu_il" as="dat_v_silu_il" type="date" title="Дата вступления в силу акта" c-master="kod_isp" key="0" used="1" sourcetable="./isk" sourcecolumn="dat_v_silu_il">isk.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="isk" column="prizn_il" as="prizn_il" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./isk" sourcecolumn="prizn_il">isk.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="isk" column="dat_na_isp_il" as="dat_na_isp_il" type="date" title="Дата выставления на исполнение" agg="max" key="0" is-fact-use="1" used="1" sourcetable="./isk" sourcecolumn="dat_na_isp_il">isk.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="isk" column="tek_dolg" as="tek_dolg" type="number" title="Оборот" agg="sum" key="0" is-fact-use="1" used="1" sourcetable="./isk" sourcecolumn="tek_dolg">isk.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><column table="isk" column="visisk" as="visisk" type="number" key="0" used="1" sourcetable="./isk" sourcecolumn="visisk">isk.visisk as visisk, /*number*/
</column><column table="isk" column="visresh" as="visresh" type="number" key="0" used="1" sourcetable="./isk" sourcecolumn="visresh">isk.visresh as visresh, /*number*/
</column><column table="isk" column="visil" as="visil" type="number" key="0" used="1" sourcetable="./isk" sourcecolumn="visil">isk.visil as visil, /*number*/
</column><column table="isk" column="gr_rn" as="gr_rn" type="number" key="0" used="1" sourcetable="./isk" sourcecolumn="gr_rn">isk.gr_rn as gr_rn, /*number*/
</column><column table="isk" column="growid" as="growid" type="string" title="" agg="max" c-master-key="kod_isp" key="1" used="1" sourcetable="./isk" sourcecolumn="growid" reference="kr_dogovor" refcol="kod_dog">isk.growid as growid, /**//*string*//*key*/
</column><column table="isk" column="parent_growid" as="parent_growid" type="string" title="" agg="max" c-master-key="kod_dog" key="0" used="1" sourcetable="./isk" sourcecolumn="parent_growid" reference="kr_dogovor" refcol="kod_dog">isk.parent_growid as parent_growid, /**//*string*/
</column><column table="isk" column="groupingid" as="groupingid" type="number" agg="max" c-master-key="kod_isp" key="0" used="1" sourcetable="./isk" sourcecolumn="groupingid" reference="kr_dogovor" refcol="kod_dog">isk.groupingid as groupingid, /*number*/
</column><column table="isk" column="grsetid" as="grsetid" type="string" title="" key="0" used="1" sourcetable="./isk" sourcecolumn="grsetid">isk.grsetid as grsetid, /**//*string*/
</column><column table="isk" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" used="1" sourcetable="./isk" sourcecolumn="origgrsetid">isk.origgrsetid as origgrsetid, /**//*string*/
</column><column table="isk" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" used="1" sourcetable="./isk" sourcecolumn="parent_grsetid">isk.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="isk" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1" sourcetable="./isk" sourcecolumn="par_groupingid">isk.par_groupingid as par_groupingid/**//*number*/
</column></select>
    <from>
from <query name="36703-isk" noname="1" order="kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first" materialize="2" path="./isk" as="isk" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
s1 as grsetname,
n1 as kod_mat,
n2 as kod_dog,
n3 as kod_hist_mat_desc,
n4 as kod_isp,
s2 as num_delo,
n5 as vist,
s3 as period,
s4 as resh_res,
d1 as dat_rassm,
d2 as dat_post,
s5 as prim,
s6 as name_st,
s7 as num_il,
d3 as dat_v_il,
d4 as dat_v_silu_il,
n6 as prizn_il,
d5 as dat_na_isp_il,
n7 as tek_dolg,
n8 as visisk,
n9 as visresh,
n10 as visil,
n11 as gr_rn,
s8 as growid,
s9 as parent_growid,
n12 as groupingid,
s10 as grsetid,
s11 as origgrsetid,
s12 as parent_grsetid,
n13 as par_groupingid
from rr_temp where skod = '36703-isk'
<select notext="1">--36703-isk
select <column table="isk" column="grsetname" as="grsetname" type="string" key="0" into="s1" used="1" sourcetable="./isk" sourcecolumn="grsetname">isk.grsetname as grsetname, /*string*/
</column><column table="isk" column="kod_mat" as="kod_mat" c-master-key="kod_mat" key="0" type="number" agg="max" sourcetable="./isk" sourcecolumn="kod_mat" into="n1" used="1">isk.kod_mat as kod_mat, /*number*/
</column><column table="isk" column="kod_dog" as="kod_dog" c-master-key="kod_dog" key="0" type="number" agg="max" sourcetable="./isk" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2" used="1">isk.kod_dog as kod_dog, /*number*/
</column><column table="isk" column="kod_hist_mat_desc" as="kod_hist_mat_desc" c-master-key="kod_hist_mat_desc" key="0" type="number" sourcetable="./isk" sourcecolumn="kod_hist_mat_desc" into="n3" used="1">isk.kod_hist_mat_desc as kod_hist_mat_desc, /*number*/
</column><column table="isk" column="kod_isp" as="kod_isp" c-master-key="kod_isp" key="0" type="number" sourcetable="./isk" sourcecolumn="kod_isp" into="n4" used="1">isk.kod_isp as kod_isp, /*number*/
</column><column table="isk" column="num_delo" as="num_delo" c-master="kod_mat" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./isk" sourcecolumn="num_delo" into="s2" used="1">isk.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="isk" column="vist" as="vist" is-fact-use="1" key="0" type="number" title="Выставленно по юр. документу" agg="sum" sourcetable="./isk" sourcecolumn="vist" into="n5" used="1">isk.vist as vist, /*Выставленно по юр. документу*//*number*/
</column><column table="isk" column="period" as="period" key="0" type="string" title="Отчетный период" agg="stragg" format="F2" into="s3" used="1" sourcetable="./isk" sourcecolumn="period">isk.period as period, /*Отчетный период*//*string*/
</column><column table="isk" column="resh_res" as="resh_res" c-master="kod_hist_mat_desc" key="0" type="string" title="Результат рассмотрения" sourcetable="./isk" sourcecolumn="resh_res" into="s4" used="1">isk.resh_res as resh_res, /*Результат рассмотрения*//*string*/
</column><column table="isk" column="dat_rassm" as="dat_rassm" c-master="kod_hist_mat_desc" key="0" type="date" title="Дата/время суд. разб." sourcetable="./isk" sourcecolumn="dat_rassm" into="d1" used="1">isk.dat_rassm as dat_rassm, /*Дата/время суд. разб.*//*date*/
</column><column table="isk" column="dat_post" as="dat_post" c-master="kod_hist_mat_desc" key="0" type="date" title="Дата прин. суд. акта" sourcetable="./isk" sourcecolumn="dat_post" into="d2" used="1">isk.dat_post as dat_post, /*Дата прин. суд. акта*//*date*/
</column><column table="isk" column="prim" as="prim" c-master="kod_hist_mat_desc" key="0" type="string" title="Примечание" sourcetable="./isk" sourcecolumn="prim" into="s5" used="1">isk.prim as prim, /*Примечание*//*string*/
</column><column table="isk" column="name_st" as="name_st" key="0" type="string" title="Юр. статус" sourcetable="./isk" sourcecolumn="name_st" into="s6" used="1">isk.name_st as name_st, /*Юр. статус*//*string*/
</column><column table="isk" column="num_il" as="num_il" c-master="kod_isp" key="0" type="string" title="Номер исп. листа" sourcetable="./isk" sourcecolumn="num_il" into="s7" used="1">isk.num_il as num_il, /*Номер исп. листа*//*string*/
</column><column table="isk" column="dat_v_il" as="dat_v_il" c-master="kod_isp" key="0" type="date" title="Дата выдачи исп. листа" agg="max" sourcetable="./isk" sourcecolumn="dat_v_il" into="d3" used="1">isk.dat_v_il as dat_v_il, /*Дата выдачи исп. листа*//*date*/
</column><column table="isk" column="dat_v_silu_il" as="dat_v_silu_il" c-master="kod_isp" key="0" type="date" title="Дата вступления в силу акта" sourcetable="./isk" sourcecolumn="dat_v_silu_il" into="d4" used="1">isk.dat_v_silu_il as dat_v_silu_il, /*Дата вступления в силу акта*//*date*/
</column><column table="isk" column="prizn_il" as="prizn_il" is-fact-use="1" key="0" type="number" title="Задолженность на дату выдачи исп. листа" agg="sum" sourcetable="./isk" sourcecolumn="prizn_il" into="n6" used="1">isk.prizn_il as prizn_il, /*Задолженность на дату выдачи исп. листа*//*number*/
</column><column table="isk" column="dat_na_isp_il" as="dat_na_isp_il" is-fact-use="1" key="0" type="date" title="Дата выставления на исполнение" agg="max" sourcetable="./isk" sourcecolumn="dat_na_isp_il" into="d5" used="1">isk.dat_na_isp_il as dat_na_isp_il, /*Дата выставления на исполнение*//*date*/
</column><column table="isk" column="tek_dolg" as="tek_dolg" is-fact-use="1" key="0" type="number" title="Оборот" agg="sum" sourcetable="./isk" sourcecolumn="tek_dolg" into="n7" used="1">isk.tek_dolg as tek_dolg, /*Оборот*//*number*/
</column><column table="isk" column="visisk" as="visisk" key="0" type="number" into="n8" used="1" sourcetable="./isk" sourcecolumn="visisk">isk.visisk as visisk, /*number*/
</column><column table="isk" column="visresh" as="visresh" key="0" type="number" into="n9" used="1" sourcetable="./isk" sourcecolumn="visresh">isk.visresh as visresh, /*number*/
</column><column table="isk" column="visil" as="visil" key="0" type="number" into="n10" used="1" sourcetable="./isk" sourcecolumn="visil">isk.visil as visil, /*number*/
</column><column table="isk" column="gr_rn" as="gr_rn" type="number" key="0" into="n11" used="1" sourcetable="./isk" sourcecolumn="gr_rn">isk.gr_rn as gr_rn, /*number*/
</column><column table="isk" column="growid" as="growid" type="string" title="" keypath=".growid" key="1" agg="max" c-master-key="kod_isp" sourcetable="./isk" sourcecolumn="growid" reference="kr_dogovor" refcol="kod_dog" into="s8" used="1">isk.growid as growid, /**//*string*//*key*/
</column><column table="isk" column="parent_growid" as="parent_growid" type="string" title="" key="0" agg="max" c-master-key="kod_dog" sourcetable="./isk" sourcecolumn="parent_growid" reference="kr_dogovor" refcol="kod_dog" into="s9" used="1">isk.parent_growid as parent_growid, /**//*string*/
</column><column table="isk" column="groupingid" as="groupingid" key="0" type="number" agg="max" c-master-key="kod_isp" sourcetable="./isk" sourcecolumn="groupingid" reference="kr_dogovor" refcol="kod_dog" into="n12" used="1">isk.groupingid as groupingid, /*number*/
</column><column table="isk" column="grsetid" as="grsetid" type="string" title="" key="0" into="s10" used="1" sourcetable="./isk" sourcecolumn="grsetid">isk.grsetid as grsetid, /**//*string*/
</column><column table="isk" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" into="s11" used="1" sourcetable="./isk" sourcecolumn="origgrsetid">isk.origgrsetid as origgrsetid, /**//*string*/
</column><column table="isk" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" into="s12" used="1" sourcetable="./isk" sourcecolumn="parent_grsetid">isk.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="isk" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" into="n13" used="1" sourcetable="./isk" sourcecolumn="par_groupingid">isk.par_groupingid as par_groupingid/**//*number*/
</column></select><from notext="1">
from <table name="isk" as="isk" used="1">isk
isk
--\isk
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by kod_mat nulls first,kod_dog nulls first,kod_hist_mat_desc nulls first,kod_isp nulls first</order>)
isk
--\36703-isk
</query></from>--\36703-isk
</query>
  <query name="36703-uved" noname="1" path="." used="1">
    <order notext="1">
      <column column="dat">dat</column>
    </order>
    <select>--36703-uved
select <column table="uved" column="sid" as="sid" key="0" used="1">uved.sid as sid, 
</column><column table="uved" column="sparentid" as="sparentid" key="0" used="1">uved.sparentid as sparentid, 
</column><column table="uved" column="kod_pred" as="kod_pred" type="number" agg="max" key="1" used="1" sourcetable="./uved" sourcecolumn="kod_pred">uved.kod_pred as kod_pred, /*number*//*key*/
</column><column table="uved" column="kod_dog" as="kod_dog" type="number" agg="max" key="0" used="1" sourcetable="./uved" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">uved.kod_dog as kod_dog, /*number*/
</column><column table="uved" column="inf" as="inf" type="string" key="0" used="1" sourcetable="./uved" sourcecolumn="inf">uved.inf as inf, /*string*/
</column><column table="uved" column="dat" as="dat" type="date" key="0" used="1" sourcetable="./uved" sourcecolumn="dat">uved.dat as dat, /*date*/
</column><column table="uved" column="sved_isp" as="sved_isp" type="string" key="0" used="1" sourcetable="./uved" sourcecolumn="sved_isp">uved.sved_isp as sved_isp/*string*/
</column></select>
    <from>
from <query name="36703-uved" noname="1" order="dat" materialize="2" path="./uved" as="uved" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_pred,
n2 as kod_dog,
s1 as inf,
d1 as dat,
s2 as sved_isp
from rr_temp where skod = '36703-uved'
<select notext="1">--36703-uved
select <column table="uved" column="kod_pred" as="kod_pred" keypath=".kod_pred" key="1" type="number" agg="max" sourcetable="./uved" sourcecolumn="kod_pred" into="n1" used="1">uved.kod_pred as kod_pred, /*number*//*key*/
</column><column table="uved" column="kod_dog" as="kod_dog" key="0" type="number" agg="max" sourcetable="./uved" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2" used="1">uved.kod_dog as kod_dog, /*number*/
</column><column table="uved" column="inf" as="inf" key="0" type="string" into="s1" used="1" sourcetable="./uved" sourcecolumn="inf">uved.inf as inf, /*string*/
</column><column table="uved" column="dat" as="dat" key="0" type="date" sourcetable="./uved" sourcecolumn="dat" into="d1" used="1">uved.dat as dat, /*date*/
</column><column table="uved" column="sved_isp" as="sved_isp" key="0" type="string" sourcetable="./uved" sourcecolumn="sved_isp" into="s2" used="1">uved.sved_isp as sved_isp/*string*/
</column></select><from notext="1">
from <table name="uved" as="uved" used="1">uved
uved
--\uved
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by dat</order>)
uved
--\36703-uved
</query></from>--\36703-uved
</query>
  <query name="36703-teh" noname="1" path="." used="1">
    <order notext="1">
      <column column="num_obj">num_obj</column>
    </order>
    <select>--36703-teh
select <column table="teh" column="sid" as="sid" key="0" used="1">teh.sid as sid, 
</column><column table="teh" column="sparentid" as="sparentid" key="0" used="1">teh.sparentid as sparentid, 
</column><column table="teh" column="kod_numobj" as="kod_numobj" type="number" agg="max" key="1" fixed="1" used="1" sourcetable="./teh" sourcecolumn="kod_numobj">teh.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="teh" column="num_obj" as="num_obj" type="number" title="Номер объекта договора" agg="list" key="0" used="1" sourcetable="./teh" sourcecolumn="num_obj">teh.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="teh" column="name" as="name" type="string" title="Номер объекта договора" agg="list" key="0" used="1" sourcetable="./teh" sourcecolumn="name">teh.name as name, /*Номер объекта договора*//*string*/
</column><column table="teh" column="kod_dog" as="kod_dog" type="number" key="0" used="1" sourcetable="./teh" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">teh.kod_dog as kod_dog, /*number*/
</column><column table="teh" column="dakt_go" as="dakt_go" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="dakt_go">teh.dakt_go as dakt_go, /*date*/
</column><column table="teh" column="dakt_gpp" as="dakt_gpp" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="dakt_gpp">teh.dakt_gpp as dakt_gpp, /*date*/
</column><column table="teh" column="dakt_gotov" as="dakt_gotov" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="dakt_gotov">teh.dakt_gotov as dakt_gotov, /*date*/
</column><column table="teh" column="dpassp_gotov" as="dpassp_gotov" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="dpassp_gotov">teh.dpassp_gotov as dpassp_gotov, /*date*/
</column><column table="teh" column="d_zayav" as="d_zayav" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="d_zayav">teh.d_zayav as d_zayav, /*date*/
</column><column table="teh" column="pusk_tep" as="pusk_tep" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="pusk_tep">teh.pusk_tep as pusk_tep, /*date*/
</column><column table="teh" column="otkl_tep" as="otkl_tep" type="date" key="0" used="1" sourcetable="./teh" sourcecolumn="otkl_tep">teh.otkl_tep as otkl_tep/*date*/
</column></select>
    <from>
from <query name="36703-teh" noname="1" order="num_obj" materialize="2" path="./teh" as="teh" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_numobj,
n2 as num_obj,
s1 as name,
n3 as kod_dog,
d1 as dakt_go,
d2 as dakt_gpp,
d3 as dakt_gotov,
d4 as dpassp_gotov,
d5 as d_zayav,
d6 as pusk_tep,
d7 as otkl_tep
from rr_temp where skod = '36703-teh'
<select notext="1">--36703-teh
select <column table="teh" column="kod_numobj" as="kod_numobj" fixed="1" key="1" keypath=".kod_numobj" type="number" agg="max" sourcetable="./teh" sourcecolumn="kod_numobj" into="n1" used="1">teh.kod_numobj as kod_numobj, /*number*//*key*/
</column><column table="teh" column="num_obj" as="num_obj" key="0" type="number" title="Номер объекта договора" agg="list" sourcetable="./teh" sourcecolumn="num_obj" into="n2" used="1">teh.num_obj as num_obj, /*Номер объекта договора*//*number*/
</column><column table="teh" column="name" as="name" type="string" key="0" title="Номер объекта договора" agg="list" sourcetable="./teh" sourcecolumn="name" into="s1" used="1">teh.name as name, /*Номер объекта договора*//*string*/
</column><column table="teh" column="kod_dog" as="kod_dog" key="0" type="number" sourcetable="./teh" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n3" used="1">teh.kod_dog as kod_dog, /*number*/
</column><column table="teh" column="dakt_go" as="dakt_go" key="0" type="date" sourcetable="./teh" sourcecolumn="dakt_go" into="d1" used="1">teh.dakt_go as dakt_go, /*date*/
</column><column table="teh" column="dakt_gpp" as="dakt_gpp" key="0" type="date" sourcetable="./teh" sourcecolumn="dakt_gpp" into="d2" used="1">teh.dakt_gpp as dakt_gpp, /*date*/
</column><column table="teh" column="dakt_gotov" as="dakt_gotov" key="0" type="date" sourcetable="./teh" sourcecolumn="dakt_gotov" into="d3" used="1">teh.dakt_gotov as dakt_gotov, /*date*/
</column><column table="teh" column="dpassp_gotov" as="dpassp_gotov" key="0" type="date" sourcetable="./teh" sourcecolumn="dpassp_gotov" into="d4" used="1">teh.dpassp_gotov as dpassp_gotov, /*date*/
</column><column table="teh" column="d_zayav" as="d_zayav" key="0" type="date" sourcetable="./teh" sourcecolumn="d_zayav" into="d5" used="1">teh.d_zayav as d_zayav, /*date*/
</column><column table="teh" column="pusk_tep" as="pusk_tep" key="0" type="date" sourcetable="./teh" sourcecolumn="pusk_tep" into="d6" used="1">teh.pusk_tep as pusk_tep, /*date*/
</column><column table="teh" column="otkl_tep" as="otkl_tep" key="0" type="date" sourcetable="./teh" sourcecolumn="otkl_tep" into="d7" used="1">teh.otkl_tep as otkl_tep/*date*/
</column></select><from notext="1">
from <table name="teh" as="teh" used="1">teh
teh
--\teh
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by num_obj</order>)
teh
--\36703-teh
</query></from>--\36703-teh
</query>
  <query name="q36703_32_grouped_pret" noname="1" path="." used="1">
    <select>--q36703_32_grouped_pret
select <column table="pret" column="sid" as="sid" key="0" used="1">pret.sid as sid, 
</column><column table="pret" column="sparentid" as="sparentid" key="0" used="1">pret.sparentid as sparentid, 
</column><column table="pret" column="kod_pret" as="kod_pret" type="number" title="Договор" key="1" fixed="1" used="1" sourcetable="./pret" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret">pret.kod_pret as kod_pret, /*Договор*//*number*//*key*/
</column><column table="pret" column="kod_dog" as="kod_dog" type="number" title="Договор" key="0" used="1" sourcetable="./pret" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">pret.kod_dog as kod_dog, /*Договор*//*number*/
</column><column table="pret" column="dat_form" as="dat_form" type="string" title="Дата формирования" agg="max" key="0" used="1" sourcetable="./pret" sourcecolumn="dat_form">pret.dat_form as dat_form, /*Дата формирования*//*string*/
</column><column table="pret" column="dolg_osn_real" as="dolg_osn_real" type="number" title="Сальдо_по_основной_реализации" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_osn_real">pret.dolg_osn_real as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="pret" column="dolg_gp" as="dolg_gp" type="number" title="Сальдо_по_госпошлине  " key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_gp">pret.dolg_gp as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="pret" column="dolg_peni" as="dolg_peni" type="number" title="Начисленные_пени" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_peni">pret.dolg_peni as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="pret" column="dolg_sud_peni" as="dolg_sud_peni" type="number" title="Сальдо_по_взысканным_процентам" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_sud_peni">pret.dolg_sud_peni as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="pret" column="dolg_astr" as="dolg_astr" type="number" title="Сальдо_по_астренту" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_astr">pret.dolg_astr as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="pret" column="dolg_othr" as="dolg_othr" type="number" title="Иные виды задолженности" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_othr">pret.dolg_othr as dolg_othr, /*Иные виды задолженности*//*number*/
</column><column table="pret" column="dolg_detail_string" as="dolg_detail_string" type="string" title="Сальдо_по_основной_реализации" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_detail_string">pret.dolg_detail_string as dolg_detail_string, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="dolg_total" as="dolg_total" type="string" title="Сальдо_по_основной_реализации" key="0" used="1" sourcetable="./pret" sourcecolumn="dolg_total">pret.dolg_total as dolg_total, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="period_string" as="period_string" type="string" title="Отчетный период начисления" format="F2" key="0" used="1" sourcetable="./pret" sourcecolumn="period_string">pret.period_string as period_string, /*Отчетный период начисления*//*string*/
</column><column table="pret" column="sf_count" as="sf_count" type="number" title="Количество с/ф" key="0" used="1" sourcetable="./pret" sourcecolumn="sf_count">pret.sf_count as sf_count, /*Количество с/ф*//*number*/
</column><column table="pret" column="cnt_pret" as="cnt_pret" type="number" title="Договор" key="0" used="1" sourcetable="./pret" sourcecolumn="cnt_pret" reference="kr_pret" refcol="kod_pret">pret.cnt_pret as cnt_pret/*Договор*//*number*/
</column></select>
    <from>
from <query name="q36703_32_grouped_pret" noname="1" materialize="2" path="./pret" as="pret" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
n1 as kod_pret,
n2 as kod_dog,
s1 as dat_form,
n3 as dolg_osn_real,
n4 as dolg_gp,
n5 as dolg_peni,
n6 as dolg_sud_peni,
n7 as dolg_astr,
n8 as dolg_othr,
s2 as dolg_detail_string,
s3 as dolg_total,
s4 as period_string,
n9 as sf_count,
n10 as cnt_pret
from rr_temp where skod = 'q36703_32_grouped_pret'
<select notext="1">--q36703_32_grouped_pret
select <column table="pret" column="kod_pret" as="kod_pret" title="Договор" fixed="1" keypath=".kod_pret" key="1" type="number" sourcetable="./pret" sourcecolumn="kod_pret" reference="kr_pret" refcol="kod_pret" into="n1" used="1">pret.kod_pret as kod_pret, /*Договор*//*number*//*key*/
</column><column table="pret" column="kod_dog" as="kod_dog" title="Договор" key="0" type="number" sourcetable="./pret" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n2" used="1">pret.kod_dog as kod_dog, /*Договор*//*number*/
</column><column table="pret" column="dat_form" as="dat_form" type="string" key="0" title="Дата формирования" agg="max" sourcetable="./pret" sourcecolumn="dat_form" into="s1" used="1">pret.dat_form as dat_form, /*Дата формирования*//*string*/
</column><column table="pret" column="dolg_osn_real" as="dolg_osn_real" key="0" type="number" title="Сальдо_по_основной_реализации" sourcetable="./pret" sourcecolumn="dolg_osn_real" into="n3" used="1">pret.dolg_osn_real as dolg_osn_real, /*Сальдо_по_основной_реализации*//*number*/
</column><column table="pret" column="dolg_gp" as="dolg_gp" key="0" type="number" title="Сальдо_по_госпошлине  " sourcetable="./pret" sourcecolumn="dolg_gp" into="n4" used="1">pret.dolg_gp as dolg_gp, /*Сальдо_по_госпошлине  *//*number*/
</column><column table="pret" column="dolg_peni" as="dolg_peni" key="0" type="number" title="Начисленные_пени" sourcetable="./pret" sourcecolumn="dolg_peni" into="n5" used="1">pret.dolg_peni as dolg_peni, /*Начисленные_пени*//*number*/
</column><column table="pret" column="dolg_sud_peni" as="dolg_sud_peni" key="0" type="number" title="Сальдо_по_взысканным_процентам" sourcetable="./pret" sourcecolumn="dolg_sud_peni" into="n6" used="1">pret.dolg_sud_peni as dolg_sud_peni, /*Сальдо_по_взысканным_процентам*//*number*/
</column><column table="pret" column="dolg_astr" as="dolg_astr" key="0" type="number" title="Сальдо_по_астренту" sourcetable="./pret" sourcecolumn="dolg_astr" into="n7" used="1">pret.dolg_astr as dolg_astr, /*Сальдо_по_астренту*//*number*/
</column><column table="pret" column="dolg_othr" as="dolg_othr" key="0" type="number" title="Иные виды задолженности" sourcetable="./pret" sourcecolumn="dolg_othr" into="n8" used="1">pret.dolg_othr as dolg_othr, /*Иные виды задолженности*//*number*/
</column><column table="pret" column="dolg_detail_string" as="dolg_detail_string" type="string" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret" sourcecolumn="dolg_detail_string" into="s2" used="1">pret.dolg_detail_string as dolg_detail_string, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="dolg_total" as="dolg_total" type="string" key="0" title="Сальдо_по_основной_реализации" sourcetable="./pret" sourcecolumn="dolg_total" into="s3" used="1">pret.dolg_total as dolg_total, /*Сальдо_по_основной_реализации*//*string*/
</column><column table="pret" column="period_string" as="period_string" type="string" key="0" title="Отчетный период начисления" format="F2" sourcetable="./pret" sourcecolumn="period_string" into="s4" used="1">pret.period_string as period_string, /*Отчетный период начисления*//*string*/
</column><column table="pret" column="sf_count" as="sf_count" title="Количество с/ф" key="0" type="number" sourcetable="./pret" sourcecolumn="sf_count" into="n9" used="1">pret.sf_count as sf_count, /*Количество с/ф*//*number*/
</column><column table="pret" column="cnt_pret" as="cnt_pret" type="number" key="0" title="Договор" sourcetable="./pret" sourcecolumn="cnt_pret" reference="kr_pret" refcol="kod_pret" into="n10" used="1">pret.cnt_pret as cnt_pret/*Договор*//*number*/
</column></select><from notext="1">
from <table name="pret" as="pret" used="1">pret
pret
--\pret
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from>)
pret
--\q36703_32_grouped_pret
</query></from>--\q36703_32_grouped_pret
</query>
  <query name="36703-graf_d" noname="1" path="." used="1">
    <select>--36703-graf_d
select <column table="graf" column="sid" as="sid" key="0" used="1">graf.sid as sid, 
</column><column table="graf" column="sparentid" as="sparentid" key="0" used="1">graf.sparentid as sparentid, 
</column><column table="graf" column="grsetname" as="grsetname" type="string" key="0" used="1" sourcetable="./graf" sourcecolumn="grsetname">graf.grsetname as grsetname, /*string*/
</column><column table="graf" column="kod_dog" as="kod_dog" type="number" agg="max" key="0" used="1" sourcetable="./graf" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog">graf.kod_dog as kod_dog, /*number*/
</column><column table="graf" column="kod_graf" as="kod_graf" type="number" agg="max" key="0" used="1" sourcetable="./graf" sourcecolumn="kod_graf">graf.kod_graf as kod_graf, /*number*/
</column><column table="graf" column="kodp" as="kodp" type="number" agg="max" key="0" used="1" sourcetable="./graf" sourcecolumn="kodp">graf.kodp as kodp, /*number*/
</column><column table="graf" column="nump" as="nump" type="string" title="Код абонента" key="0" used="1" sourcetable="./graf" sourcecolumn="nump">graf.nump as nump, /*Код абонента*//*string*/
</column><column table="graf" column="ym_min" as="ym_min" type="number" title="Период оплаты" key="0" used="1" sourcetable="./graf" sourcecolumn="ym_min">graf.ym_min as ym_min, /*Период оплаты*//*number*/
</column><column table="graf" column="kod_graf_status" as="kod_graf_status" type="number" key="0" used="1" sourcetable="./graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status">graf.kod_graf_status as kod_graf_status, /*number*/
</column><column table="graf" column="num_delo" as="num_delo" type="string" title="Номер дела" agg="stragg" key="0" used="1" sourcetable="./graf" sourcecolumn="num_delo">graf.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="graf" column="sum_graf" as="sum_graf" type="number" title="Сумма оплаты по графику" agg="sum" key="0" used="1" sourcetable="./graf" sourcecolumn="sum_graf">graf.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*/
</column><column table="graf" column="graf_period" as="graf_period" type="string" title="Период оплаты" key="0" used="1" sourcetable="./graf" sourcecolumn="graf_period">graf.graf_period as graf_period, /*Период оплаты*//*string*/
</column><column table="graf" column="graf_nach" as="graf_nach" type="number" title="Начислено" agg="sum" key="0" used="1" sourcetable="./graf" sourcecolumn="graf_nach">graf.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="graf" column="graf_opl" as="graf_opl" type="number" title="Оплачено" agg="sum" key="0" used="1" sourcetable="./graf" sourcecolumn="graf_opl">graf.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="graf" column="graf_ost" as="graf_ost" type="number" title="Остаток оплаты" agg="sum" key="0" used="1" sourcetable="./graf" sourcecolumn="graf_ost">graf.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="graf" column="graf_isp" as="graf_isp" type="string" title="Исполнено/не исполнено" key="0" used="1" sourcetable="./graf" sourcecolumn="graf_isp">graf.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="graf" column="status_name" as="status_name" type="string" title="Статус графика" key="0" used="1" sourcetable="./graf" sourcecolumn="status_name">graf.status_name as status_name, /*Статус графика*//*string*/
</column><column table="graf" column="gr_rn" as="gr_rn" type="number" key="0" used="1" sourcetable="./graf" sourcecolumn="gr_rn">graf.gr_rn as gr_rn, /*number*/
</column><column table="graf" column="growid" as="growid" type="string" title="" agg="max" key="1" used="1" sourcetable="./graf" sourcecolumn="growid" reference="kr_dogovor" refcol="kod_dog">graf.growid as growid, /**//*string*//*key*/
</column><column table="graf" column="parent_growid" as="parent_growid" type="string" title="" agg="max" key="0" used="1" sourcetable="./graf" sourcecolumn="parent_growid" reference="kr_dogovor" refcol="kod_dog">graf.parent_growid as parent_growid, /**//*string*/
</column><column table="graf" column="groupingid" as="groupingid" type="number" agg="max" key="0" used="1" sourcetable="./graf" sourcecolumn="groupingid" reference="kr_dogovor" refcol="kod_dog">graf.groupingid as groupingid, /*number*/
</column><column table="graf" column="grsetid" as="grsetid" type="string" title="" key="0" used="1" sourcetable="./graf" sourcecolumn="grsetid">graf.grsetid as grsetid, /**//*string*/
</column><column table="graf" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" used="1" sourcetable="./graf" sourcecolumn="origgrsetid">graf.origgrsetid as origgrsetid, /**//*string*/
</column><column table="graf" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" used="1" sourcetable="./graf" sourcecolumn="parent_grsetid">graf.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="graf" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" used="1" sourcetable="./graf" sourcecolumn="par_groupingid">graf.par_groupingid as par_groupingid/**//*number*/
</column></select>
    <from>
from <query name="36703-graf_d" noname="1" order="kod_dog nulls first,kod_graf nulls first" materialize="2" path="./graf" as="graf" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
s1 as grsetname,
n1 as kod_dog,
n2 as kod_graf,
n3 as kodp,
s2 as nump,
n4 as ym_min,
n5 as kod_graf_status,
s3 as num_delo,
n6 as sum_graf,
s4 as graf_period,
n7 as graf_nach,
n8 as graf_opl,
n9 as graf_ost,
s5 as graf_isp,
s6 as status_name,
n10 as gr_rn,
s7 as growid,
s8 as parent_growid,
n11 as groupingid,
s9 as grsetid,
s10 as origgrsetid,
s11 as parent_grsetid,
n12 as par_groupingid
from rr_temp where skod = '36703-graf_d'
<select notext="1">--36703-graf_d
select <column table="graf" column="grsetname" as="grsetname" type="string" key="0" into="s1" used="1" sourcetable="./graf" sourcecolumn="grsetname">graf.grsetname as grsetname, /*string*/
</column><column table="graf" column="kod_dog" as="kod_dog" key="0" type="number" agg="max" sourcetable="./graf" sourcecolumn="kod_dog" reference="kr_dogovor" refcol="kod_dog" into="n1" used="1">graf.kod_dog as kod_dog, /*number*/
</column><column table="graf" column="kod_graf" as="kod_graf" key="0" type="number" agg="max" sourcetable="./graf" sourcecolumn="kod_graf" into="n2" used="1">graf.kod_graf as kod_graf, /*number*/
</column><column table="graf" column="kodp" as="kodp" key="0" type="number" agg="max" sourcetable="./graf" sourcecolumn="kodp" into="n3" used="1">graf.kodp as kodp, /*number*/
</column><column table="graf" column="nump" as="nump" key="0" type="string" title="Код абонента" sourcetable="./graf" sourcecolumn="nump" into="s2" used="1">graf.nump as nump, /*Код абонента*//*string*/
</column><column table="graf" column="ym_min" as="ym_min" key="0" type="number" title="Период оплаты" into="n4" used="1" sourcetable="./graf" sourcecolumn="ym_min">graf.ym_min as ym_min, /*Период оплаты*//*number*/
</column><column table="graf" column="kod_graf_status" as="kod_graf_status" key="0" type="number" sourcetable="./graf" sourcecolumn="kod_graf_status" reference="us_graf_status" refcol="kod_graf_status" into="n5" used="1">graf.kod_graf_status as kod_graf_status, /*number*/
</column><column table="graf" column="num_delo" as="num_delo" key="0" type="string" title="Номер дела" agg="stragg" sourcetable="./graf" sourcecolumn="num_delo" into="s3" used="1">graf.num_delo as num_delo, /*Номер дела*//*string*/
</column><column table="graf" column="sum_graf" as="sum_graf" key="0" type="number" title="Сумма оплаты по графику" agg="sum" sourcetable="./graf" sourcecolumn="sum_graf" into="n6" used="1">graf.sum_graf as sum_graf, /*Сумма оплаты по графику*//*number*/
</column><column table="graf" column="graf_period" as="graf_period" key="0" type="string" title="Период оплаты" into="s4" used="1" sourcetable="./graf" sourcecolumn="graf_period">graf.graf_period as graf_period, /*Период оплаты*//*string*/
</column><column table="graf" column="graf_nach" as="graf_nach" key="0" type="number" title="Начислено" agg="sum" sourcetable="./graf" sourcecolumn="graf_nach" into="n7" used="1">graf.graf_nach as graf_nach, /*Начислено*//*number*/
</column><column table="graf" column="graf_opl" as="graf_opl" key="0" type="number" title="Оплачено" agg="sum" into="n8" used="1" sourcetable="./graf" sourcecolumn="graf_opl">graf.graf_opl as graf_opl, /*Оплачено*//*number*/
</column><column table="graf" column="graf_ost" as="graf_ost" key="0" type="number" title="Остаток оплаты" agg="sum" sourcetable="./graf" sourcecolumn="graf_ost" into="n9" used="1">graf.graf_ost as graf_ost, /*Остаток оплаты*//*number*/
</column><column table="graf" column="graf_isp" as="graf_isp" key="0" type="string" title="Исполнено/не исполнено" into="s5" used="1" sourcetable="./graf" sourcecolumn="graf_isp">graf.graf_isp as graf_isp, /*Исполнено/не исполнено*//*string*/
</column><column table="graf" column="status_name" as="status_name" key="0" type="string" title="Статус графика" sourcetable="./graf" sourcecolumn="status_name" into="s6" used="1">graf.status_name as status_name, /*Статус графика*//*string*/
</column><column table="graf" column="gr_rn" as="gr_rn" type="number" key="0" into="n10" used="1" sourcetable="./graf" sourcecolumn="gr_rn">graf.gr_rn as gr_rn, /*number*/
</column><column table="graf" column="growid" as="growid" type="string" title="" key="1" keypath=".growid" agg="max" sourcetable="./graf" sourcecolumn="growid" reference="kr_dogovor" refcol="kod_dog" into="s7" used="1">graf.growid as growid, /**//*string*//*key*/
</column><column table="graf" column="parent_growid" as="parent_growid" type="string" title="" key="0" agg="max" sourcetable="./graf" sourcecolumn="parent_growid" reference="kr_dogovor" refcol="kod_dog" into="s8" used="1">graf.parent_growid as parent_growid, /**//*string*/
</column><column table="graf" column="groupingid" as="groupingid" key="0" type="number" agg="max" sourcetable="./graf" sourcecolumn="groupingid" reference="kr_dogovor" refcol="kod_dog" into="n11" used="1">graf.groupingid as groupingid, /*number*/
</column><column table="graf" column="grsetid" as="grsetid" type="string" title="" key="0" into="s9" used="1" sourcetable="./graf" sourcecolumn="grsetid">graf.grsetid as grsetid, /**//*string*/
</column><column table="graf" column="origgrsetid" as="origgrsetid" type="string" title="" key="0" into="s10" used="1" sourcetable="./graf" sourcecolumn="origgrsetid">graf.origgrsetid as origgrsetid, /**//*string*/
</column><column table="graf" column="parent_grsetid" as="parent_grsetid" type="string" title="" key="0" into="s11" used="1" sourcetable="./graf" sourcecolumn="parent_grsetid">graf.parent_grsetid as parent_grsetid, /**//*string*/
</column><column table="graf" column="par_groupingid" as="par_groupingid" type="number" title="" key="0" into="n12" used="1" sourcetable="./graf" sourcecolumn="par_groupingid">graf.par_groupingid as par_groupingid/**//*number*/
</column></select><from notext="1">
from <table name="graf" as="graf" used="1">graf
graf
--\graf
</table><table name="dog" as="dog">dog
dog
--\dog
</table></from><order notext="1">
order by kod_dog nulls first,kod_graf nulls first</order>)
graf
--\36703-graf_d
</query></from>--\36703-graf_d
</query>
  <query name="36703-info-dat" noname="1" path="." used="1">
    <select>--36703-info-dat
select <column table="info" column="sid" as="sid" key="0" used="1">info.sid as sid, 
</column><column table="info" column="sparentid" as="sparentid" key="0" used="1">info.sparentid as sparentid, 
</column><column table="info" column="ssdate" as="ssdate" type="string" title="Дата" key="0" used="1">info.ssdate as ssdate, /*Дата*//*string*/
</column><column table="info" column="sdate" as="sdate" type="string" title="Дата" key="0" used="1">info.sdate as sdate/*Дата*//*string*/
</column></select>
    <from>
from <query name="36703-info-dat" timestamp="21.11.2016 19:03:10" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" materialize="2" noname="1" path="./info" as="info" used="1">(
select /*+ dynamic_sampling(rr_temp 10)*/
sid,
sparentid,
rn,
s1 as ssdate,
s2 as sdate
from rr_temp where skod = '36703-info-dat'
<select notext="1">--36703-info-dat
select <call function="||" as="ssdate" title="Дата" key="0" pth="" type="string" into="s1" used="1"><call function="day" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'DD')) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="lower" pth="" type="string">(<text txtype="func"> lower( </text><call function="mes-name-rp" pth="" type="string">(<text txtype="func"> decode ( </text><call function="month" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'MM')) </text>) </call><text txtype="func"> ,1,'Января',2,'Февраля',3,'Марта',4,'Апреля',5,'Мая',6,'Июня',7,'Июля',8,'Августа',9,'Сентября',10,'Октября',11,'Ноября',12,'Декабря') </text>) </call><text txtype="func"> ) </text>) </call><text txtype="func"> || </text><const><text>' '</text></const><text txtype="func"> || </text><call function="year" pth="" type="number">(<text txtype="func"> to_number(to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'YYYY')) </text>) </call><text txtype="func"> || </text><const><text>' г.'</text></const> as ssdate, /*Дата*//*string*/
</call><call function="date to char" as="sdate" title="Дата" key="0" pth="" type="string" into="s2" used="1"><text txtype="func"> to_char( </text><const><text>:dat </text></const><text txtype="func"> ,'DD.MM.YYYY') </text> as sdate/*Дата*//*string*/
</call></select><from notext="1">
from <table name="dual" as="dual" used="1">dual
dual
--\dual
</table></from>)
info
--\36703-info-dat
</query></from>--\36703-info-dat
</query>
</root>