<root>
  <queries>
    <query name="oborot" test="1">
      <params>
        <param name="date1">
        </param>
        <param name="date2">
        </param>
        <param name="cols-for-group">
        </param>
        <param name="cols-nachisl">
        </param>
        <param name="cols-opl">
        </param>
      </params>
      <select>
        <usepart part="add-cols">
          <useparam name="cols-for-group" />
          <const>s</const>
        </usepart>
        <usepart part="add-cols">
          <useparam name="cols-nachisl" />
          <const>s</const>
        </usepart>
        <call function="-" as="saldo_beg">
          <call function="-">
            <column table="s" column="nachisl">
            </column>
            <column table="s" column="opl">
            </column>
          </call>
          <call function="-">
            <column table="o" column="nachisl">
            </column>
            <column table="o" column="opl">
            </column>
          </call>
        </call>
        <call function="-" as="saldo_beg_nal">
          <call function="-">
            <column table="s" column="nal">
            </column>
            <column table="s" column="opl_nal">
            </column>
          </call>
          <call function="-">
            <column table="o" column="nal">
            </column>
            <column table="o" column="opl_nal">
            </column>
          </call>
        </call>
        <call function="-" as="saldo_beg_cust">
          <call function="-">
            <column table="s" column="cust">
            </column>
            <column table="s" column="opl_cust">
            </column>
          </call>
          <call function="-">
            <column table="o" column="cust">
            </column>
            <column table="o" column="opl_cust">
            </column>
          </call>
        </call>
        <column table="o" column="nachisl">
        </column>
        <column table="o" column="cust">
        </column>
        <column table="o" column="nal">
        </column>
        <column table="o" column="opl">
        </column>
        <column table="o" column="opl_cust">
        </column>
        <column table="o" column="opl_nal">
        </column>
        <call function="-" as="saldo_end">
          <column table="s" column="nachisl">
          </column>
          <column table="s" column="opl">
          </column>
        </call>
        <call function="-" as="saldo_end_nal">
          <column table="s" column="nal">
          </column>
          <column table="s" column="opl_nal">
          </column>
        </call>
        <call function="-" as="saldo_end_cust">
          <column table="s" column="cust">
          </column>
          <column table="s" column="opl_cust">
          </column>
        </call>
      </select>
      <from>
        <query name="nachisl-opl" as="s">
          <withparams>
            <call function="nativity" />
            <useparam name="date2" />
            <useparam name="cols-for-group" />
            <useparam name="cols-nachisl" />
            <useparam name="cols-opl" />
          </withparams>
        </query>
        <query name="nachisl-opl" as="o" join="left outer">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
            <useparam name="cols-for-group" />
            <group>
            </group>
            <group>
            </group>
          </withparams>
          <usepart part="add-join">
            <useparam name="cols-for-group" />
            <const>s</const>
            <const>o</const>
          </usepart>
        </query>
      </from>
    </query>
    <query name="nachisl-opl">
      <params>
        <param name="date1">
        </param>
        <param name="date2">
        </param>
        <param name="cols-for-group">
        </param>
        <param name="cols-nachisl">
        </param>
        <param name="cols-opl">
        </param>
      </params>
      <select>
        <usepart part="add-cols">
          <useparam name="cols-for-group" />
          <const>n</const>
        </usepart>
        <usepart part="add-cols">
          <useparam name="cols-nachisl" />
          <const>n</const>
        </usepart>
        <usepart part="add-cols">
          <useparam name="cols-opl" />
          <const>o</const>
        </usepart>
        <column table="n" column="nachisl">
        </column>
        <column table="n" column="cust">
        </column>
        <column table="n" column="nal">
        </column>
        <column table="o" column="opl">
        </column>
        <column table="o" column="cust" as="opl_cust">
        </column>
        <column table="o" column="nal" as="opl_nal">
        </column>
      </select>
      <from>
        <query as="n">
          <select>
            <usepart part="add-cols-with-group">
              <useparam name="cols-for-group" />
              <const>n</const>
            </usepart>
            <usepart part="add-cols-with-group">
              <useparam name="cols-nachisl" />
              <const>n</const>
            </usepart>
            <column table="n" column="nachisl" group="sum" />
            <column table="n" column="cust" group="sum" />
            <column table="n" column="nal" group="sum" />
          </select>
          <from>
            <query name="sr_facras" as="n" />
          </from>
          <where>
            <call function="between">
              <call function="ym end time">
                <column table="n" column="ym">
                </column>
              </call>
              <useparam name="date1" />
              <useparam name="date2" />
            </call>
          </where>
        </query>
        <query as="o" join="left outer">
          <select>
            <usepart part="add-cols-with-group">
              <useparam name="cols-for-group" />
              <const>o</const>
            </usepart>
            <usepart part="add-cols-with-group">
              <useparam name="cols-opl" />
              <const>o</const>
            </usepart>
            <column table="o" column="opl" group="sum" />
            <column table="o" column="cust" group="sum" />
            <column table="o" column="nal" group="sum" />
          </select>
          <from>
            <query name="sr_facopl" as="o">
              <withparams>
                <useparam name="date1" />
                <useparam name="date2" />
              </withparams>
            </query>
          </from>
          <where>
            <call function="between">
              <column table="o" column="dat_oper">
              </column>
              <useparam name="date1" />
              <useparam name="date2" />
            </call>
          </where>
          <usepart part="add-join">
            <useparam name="cols-for-group" />
            <const>n</const>
            <const>o</const>
          </usepart>
        </query>
      </from>
    </query>
    <query name="f46_razdel">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <usepart part="table-from-dual" as="a">
          <rows>
            <row>
              <const as="id">'I'</const>
              <const as="name">'Полезный отпуск электроэнергии и мощности, реализуемой по регулируемым тарифам (ценам)'</const>
            </row>
            <row>
              <const as="id">'II'</const>
              <const as="name">'Полезный отпуск электроэнергии и мощности, реализуемой по нерегулируемым ценам'</const>
            </row>
          </rows>
        </usepart>
      </from>
    </query>
    <query name="f46_podrazdel">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <usepart part="table-from-dual" as="a">
          <rows>
            <row>
              <const as="id">'А'</const>
              <const as="name">'по Договору энергоснабжения'</const>
            </row>
            <row>
              <const as="id">'Б'</const>
              <const as="name">'по Договору купли-продажи'</const>
            </row>
            <row>
              <const as="id">'В'</const>
              <const as="name">'населению и приравненным к нему категориям потребителей'</const>
            </row>
          </rows>
        </usepart>
      </from>
    </query>
    <query name="hk_dhh">
      <select>
        <column table="a" column="kod_dhh">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <table name="hk_dhh" as="a">
        </table>
      </from>
    </query>
    <query name="hk_voltage">
      <select>
        <column table="a" column="voltage">
        </column>
        <column table="a" column="abbr">
        </column>
      </select>
      <from>
        <table name="hk_voltage" as="a">
        </table>
      </from>
    </query>
    <query name="hk_voltage_null">
      <select>
        <const>null</const>
        <const>null</const>
      </select>
      <from>
        <table name="dual">
        </table>
      </from>
    </query>
    <query name="hk_voltage+null">
      <union>
        <query name="hk_voltage">
        </query>
        <query name="hk_voltage_null">
        </query>
      </union>
    </query>
    <query name="kk_interval">
      <select>
        <column table="a" column="kodinterval">
        </column>
        <column table="a" column="name">
        </column>
        <column table="a" column="abbr">
        </column>
      </select>
      <from>
        <table name="kk_interval" as="a">
        </table>
      </from>
    </query>
    <query name="kr_calc">
      <select>
        <column table="a" column="podr" type="number">
        </column>
        <column table="a" column="ym" type="number">
        </column>
        <call function="ym to char" as="name" title="Период">
          <column table="a" column="ym">
          </column>
        </call>
      </select>
      <from>
        <table name="kr_calc" as="a">
        </table>
      </from>
    </query>
    <query name="kr_calc_dist" order="1 desc">
      <select>
        <column table="a" column="ym" group="1">
        </column>
        <column table="a" column="name" group="max">
        </column>
      </select>
      <from>
        <query name="kr_calc" as="a">
        </query>
      </from>
    </query>
    <query name="kr_calc_max">
      <select>
        <column table="a" column="ym" group="max">
        </column>
      </select>
      <from>
        <query name="kr_calc_dist" as="a">
        </query>
      </from>
    </query>
    <query name="kr_dogovor">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" type="number">
        </column>
        <column table="a" column="dat_dog" type="date" title="Дата договора">
        </column>
        <column table="a" column="kodp" type="number">
        </column>
        <column table="a" column="ndog" type="string" title="Номер договора">
        </column>
        <call function="||" as="name" title="Договор">
          <const>'№ '</const>
          <column table="a" column="ndog">
          </column>
          <const>' от '</const>
          <call function="date to char">
            <column table="a" column="dat_dog">
            </column>
          </call>
        </call>
        <column table="a" column="kod_ist">
        </column>
        <column table="a" column="tep_el" type="number">
        </column>
        <column table="a" column="dep" type="number">
        </column>
        <column table="a" column="pr_active" type="number">
        </column>
        <column table="a" column="dat_fin" type="date">
        </column>
        <column table="p" column="name" as="dep_name" title="Отделение">
        </column>
        <column table="nos" column="prizn_selo" title="Обл/Гор (Договор)">
        </column>
        <column table="no" column="dat_create" as="obj_dat_create">
        </column>
        <column table="no" column="dat_fin" as="obj_dat_fin">
        </column>
        <column table="pay" column="nump">
        </column>
        <column table="pay" column="inn">
        </column>
        <column table="pay" column="kpp">
        </column>
        <column table="pay" column="name" as="payer_name">
        </column>
        <column table="opl" column="dolg" as="kred_dolg">
        </column>
        <column table="fv" column="dolg">
        </column>
        <column table="fv" column="kod_sf" as="last_dolg_sf">
        </column>
      </select>
      <from>
        <table name="kr_dogovor" as="a">
        </table>
        <query name="kr_org" as="p" join="left outer">
          <call function="=">
            <column table="a" column="dep">
            </column>
            <column table="p" column="kodp">
            </column>
          </call>
        </query>
        <query name="kr_payer" as="pay" join="left outer">
          <call function="=">
            <column table="a" column="kodp">
            </column>
            <column table="pay" column="kodp">
            </column>
          </call>
        </query>
        <query name="kr_dogovor.kr_numobj" as="no" join="left outer">
          <withparams>
            <useparam name="date" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="no" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="kr_dogovor.kr_numobj.prizn_selo" as="nos" join="left outer" materialize="1">
          <withparams>
            <useparam name="date" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="nos" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="kr_dogovor.sr_opl" as="opl" join="left outer">
          <withparams>
            <useparam name="date" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="opl" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="kr_dogovor.sr_facvip" as="fv" join="left outer">
          <withparams>
            <useparam name="date" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="fv" column="kod_dog">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="kr_dogovor.kr_numobj.prizn_selo">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1">
        </column>
        <column table="a" column="prizn_selo" group="max">
        </column>
      </select>
      <from>
        <query name="kr_numobj" as="a">
          <withparams>
            <useparam name="date" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="temp_pr_selo_dog">
      <select>
        <!--<column table="a" column="dep_name"></column>
        <column table="a" column="ndog"></column>
        <column table="a" column="dat_dog"></column>
        <column table="a" column="obj_dat_create"></column>
        <column table="a" column="obj_dat_fin"></column> -->
        <column table="a" column="kod_dog">
        </column>
        <column table="a" column="prizn_selo">
        </column>
      </select>
      <from>
        <query name="kr_dogovor" as="a">
          <withparams>
            <call function="ym begin time">
              <const>2012.01</const>
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_dog">
          </column>
          <const>p_kod_dog</const>
        </call>
      </where>
    </query>
    <query name="kr_numobj">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_numobj" type="number">
        </column>
        <column table="a" column="kod_dog" type="number">
        </column>
        <column table="a" column="dat_create" type="date">
        </column>
        <column table="a" column="dat_fin" type="date">
        </column>
        <column table="a" column="num_obj" type="number" title="Номер объекта">
        </column>
        <call function="nvl" as="tarif_main">
          <column table="p" column="tarif2">
          </column>
          <column table="a" column="tarif">
          </column>
        </call>
        <column table="a" column="tarif">
        </column>
        <column table="p" column="tarif2">
        </column>
        <column table="p" column="tarif16">
        </column>
        <column table="t" column="prizn_selo">
        </column>
        <column table="dog" column="dat_dog">
        </column>
        <column table="dog" column="ndog">
        </column>
      </select>
      <from>
        <table name="kr_numobj" as="a">
        </table>
        <query as="p" join="left outer">
          <select>
            <column table="pl" column="*">
            </column>
          </select>
          <from>
            <query name="kr_plan" as="pl" />
          </from>
          <where>
            <usepart part="between-nvl">
              <call function="date to ym">
                <useparam name="date" />
              </call>
              <column table="pl" column="ym_s">
              </column>
              <column table="pl" column="ym_po">
              </column>
            </usepart>
          </where>
          <call function="=">
            <column table="a" column="kod_numobj">
            </column>
            <column table="p" column="kod_numobj">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t" join="left outer">
          <call function="=">
            <call function="nvl">
              <column table="p" column="tarif2">
              </column>
              <column table="a" column="tarif">
              </column>
            </call>
            <column table="t" column="tarif">
            </column>
          </call>
        </query>
        <query name="kr_dogovor" as="dog" join="left outer">
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="dog" column="kod_dog">
            </column>
          </call>
        </query>
      </from>
      <where>
        <usepart part="between-nvl">
          <useparam name="date" />
          <column table="a" column="dat_create">
          </column>
          <column table="a" column="dat_fin">
          </column>
        </usepart>
      </where>
    </query>
    <query name="kr_dogovor.kr_numobj">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1">
        </column>
        <column table="a" column="prizn_selo" group="max">
        </column>
        <column table="a" column="dat_create" group="max">
        </column>
        <column table="a" column="dat_fin" group="min">
        </column>
      </select>
      <from>
        <query name="kr_numobj" as="a">
          <withparams>
            <useparam name="date" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="temp_pr_selo_obj">
      <select>
        <column table="a" column="kod_numobj">
        </column>
        <column table="a" column="prizn_selo">
        </column>
      </select>
      <from>
        <query name="kr_numobj" as="a">
          <withparams>
            <call function="ym begin time">
              <const>2012.01</const>
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_numobj">
          </column>
          <const>p_kod_numobj</const>
        </call>
      </where>
    </query>
    <query name="kr_org">
      <select>
        <column table="a" column="kodp" type="number">
        </column>
        <column table="a" column="sname">
        </column>
        <column table="a" column="name" type="string" title="Наименование">
        </column>
        <column table="a" column="kod_ecls">
        </column>
        <column table="a" column="kod_separator">
        </column>
        <column table="a" column="kod_parent">
        </column>
      </select>
      <from>
        <table name="kr_org" as="a">
        </table>
      </from>
    </query>
    <query name="kr_org_dep">
      <select>
        <column table="a" column="*">
        </column>
        <column table="b" column="lvl">
        </column>
      </select>
      <from>
        <query name="kr_org" as="a">
        </query>
        <query name="q_kr_org_dep" as="b" join="inner">
          <call function="=">
            <column table="a" column="kodp">
            </column>
            <column table="b" column="kodp">
            </column>
          </call>
        </query>
        <where>
          <call function="=">
            <column table="b" column="kod_separator">
            </column>
            <const>2</const>
          </call>
        </where>
      </from>
    </query>
    <query name="kr_org_dep%tbl" order="name">
      <select>
        <column table="a" column="kodp">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <query name="kr_org_dep" as="a">
        </query>
      </from>
    </query>
    <query name="q_kr_org_dep">
      <select>
        <column table="a" column="kodp">
        </column>
        <column table="a" column="lvl">
        </column>
      </select>
      <from>
        <table name="t_kr_org_dep" as="a" view="1">
        </table>
      </from>
    </query>
    <query name="kr_payer">
      <select>
        <column table="a" column="kodp" type="number">
        </column>
        <column table="a" column="nump" type="string" title="Код абонента">
        </column>
        <column table="a" column="inn" type="string" title="ИНН">
        </column>
        <column table="a" column="kpp" type="string" title="КПП">
        </column>
        <column table="a" column="name" type="string" title="Наименование абонента">
        </column>
      </select>
      <from>
        <table name="kr_payer" as="a">
        </table>
      </from>
    </query>
    <query name="kr_plan">
      <select>
        <column table="a" column="kod_plan">
        </column>
        <column table="a" column="kod_numobj">
        </column>
        <column table="a" column="ym_s">
        </column>
        <column table="a" column="ym_po">
        </column>
        <column table="s2" column="tarif" as="tarif2">
        </column>
        <column table="s2" column="prizn_selo">
        </column>
        <column table="s16" column="tarif" as="tarif16">
        </column>
      </select>
      <from>
        <table name="kr_plan" as="a">
        </table>
        <query name="kr_plan.kr_plan_sost(tip_tarif_sost)" as="s2" join="left outer">
          <withparams>
            <const>2</const>
          </withparams>
          <call function="=">
            <column table="a" column="kod_plan">
            </column>
            <column table="s2" column="kod_plan">
            </column>
          </call>
        </query>
        <query name="kr_plan.kr_plan_sost(tip_tarif_sost)" as="s16" join="left outer">
          <withparams>
            <const>16</const>
          </withparams>
          <call function="=">
            <column table="a" column="kod_plan">
            </column>
            <column table="s16" column="kod_plan">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="kr_plan_sost">
      <select>
        <column table="a" column="kod_plan">
        </column>
        <column table="a" column="tip_tarif_sost">
        </column>
        <column table="a" column="tarif">
        </column>
        <column table="t" column="prizn_selo">
        </column>
      </select>
      <from>
        <table name="kr_plan_sost" as="a">
        </table>
        <query name="ks_tarif" as="t" join="left outer">
          <call function="=">
            <column table="a" column="tarif">
            </column>
            <column table="t" column="tarif">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="kr_plan.kr_plan_sost(tip_tarif_sost)">
      <params>
        <param name="tip_tarif_sost">
        </param>
      </params>
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="kr_plan_sost" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="tip_tarif_sost">
          </column>
          <useparam name="tip_tarif_sost">
          </useparam>
        </call>
      </where>
    </query>
    <query name="ks_46">
      <select>
        <column table="a" column="kod_f46">
        </column>
        <column table="a" column="npp">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <table name="ks_46" as="a">
        </table>
      </from>
    </query>
    <query name="ks_bank">
      <select>
        <column table="a" column="kodb" type="number">
        </column>
        <column table="a" column="name" type="string" title="Наименование банка">
        </column>
      </select>
      <from>
        <table name="ks_bank" as="a">
        </table>
      </from>
    </query>
    <query name="ks_bankpol">
      <select>
        <column table="a" column="kodbpol" type="number">
        </column>
        <column table="b" column="name" as="bank_name">
        </column>
        <column table="a" column="rs" type="string" title="Счет">
        </column>
        <call function="case" as="rs_name" title="Счет получателя" type="string">
          <call function="when">
            <call function="is null">
              <column table="a" column="kodb">
              </column>
            </call>
            <column table="a" column="rs">
            </column>
          </call>
          <call function="else">
            <call function="||">
              <const>'р/с '</const>
              <column table="a" column="rs">
              </column>
            </call>
          </call>
        </call>
        <column table="a" column="pr_active" type="number">
        </column>
      </select>
      <from>
        <table name="ks_bankpol" as="a">
        </table>
        <query name="ks_bank" as="b" join="left outer">
          <call function="=">
            <column table="a" column="kodb">
            </column>
            <column table="b" column="kodb">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="ks_bankpol%sl">
      <select>
        <column table="a" column="kodbpol" type="number">
        </column>
        <column table="a" column="rs_name" type="string">
        </column>
      </select>
      <from>
        <query name="ks_bankpol" as="a">
        </query>
      </from>
    </query>
    <query name="ks_bankpol%tbl">
      <select>
        <column table="a" column="kodbpol">
        </column>
        <column table="a" column="bank_name">
        </column>
        <column table="a" column="rs">
        </column>
      </select>
      <from>
        <query name="ks_bankpol" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="pr_active">
          </column>
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="ks_istfin">
      <select>
        <column table="a" column="kod_ist">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <table name="ks_istfin" as="a">
        </table>
      </from>
    </query>
    <query name="ks_tarif">
      <select>
        <column table="a" column="tarif">
        </column>
        <column table="a" column="tarif_parent">
        </column>
        <column table="a" column="npp">
        </column>
        <column table="a" column="name">
        </column>
        <column table="a" column="prizn_selo" type="number" title="Обл/Гор">
        </column>
        <column table="a" column="voltage">
        </column>
      </select>
      <from>
        <table name="ks_tarif" as="a">
        </table>
      </from>
    </query>
    <query name="nr_account">
      <parts>
        <part id="pr_nasel">
          <call function="case">
            <call function="when">
              <call function="in">
                <column table="a" column="vid_t" />
                <call function="array">
                  <const>25</const>
                  <const>35</const>
                </call>
              </call>
              <const>1</const>
            </call>
            <call function="else">
              <const>0</const>
            </call>
          </call>
        </part>
        <part id="f46_podrazdel">
          <call function="case">
            <call function="when">
              <call function="=">
                <usepart part="pr_nasel" as="pr_nasel" />
                <const>1</const>
              </call>
              <const>'В'</const>
            </call>
            <call function="else">
              <call function="case">
                <call function="when">
                  <call function="=">
                    <column table="ao" column="pr_usl">
                    </column>
                    <const>1</const>
                  </call>
                  <const>'А'</const>
                </call>
                <call function="else">
                  <const>'Б'</const>
                </call>
              </call>
            </call>
          </call>
        </part>
        <part id="f46_razdel">
          <call function="case">
            <call function="when">
              <call function="=">
                <column table="ao" column="pr_free">
                </column>
                <const>0</const>
              </call>
              <const>'I'</const>
            </call>
            <call function="else">
              <const>'II'</const>
            </call>
          </call>
        </part>
        <part id="pr_2rate_name">
          <call function="case">
            <call function="when">
              <call function="=">
                <column table="ao" column="pr_2rate">
                </column>
                <const>1</const>
              </call>
              <const>'Двухставочный/Трехставочный'</const>
            </call>
            <call function="else">
              <const>'Одноставочный'</const>
            </call>
          </call>
        </part>
      </parts>
      <select>
        <column table="a" column="kod_account">
        </column>
        <column table="a" column="kod_dog">
        </column>
        <column table="a" column="kod_numobj">
        </column>
        <column table="a" column="ym">
        </column>
        <column table="a" column="kod_f46">
        </column>
        <column table="a" column="tarif">
        </column>
        <column table="t2" column="tarif" as="tarif2">
        </column>
        <column table="pl" column="tarif16" as="tarif16">
        </column>
        <call function="nvl" as="tarif_osn">
          <column table="t2" column="tarif">
          </column>
          <column table="a" column="tarif">
          </column>
        </call>
        <column table="a" column="cust">
        </column>
        <column table="a" column="nachisl">
        </column>
        <column table="a" column="vid_t">
        </column>
        <column table="a" column="voltage">
        </column>
        <column table="nch" column="edizm">
        </column>
        <column table="d" column="dep" as="podr">
        </column>
        <column table="d" column="kod_ist">
        </column>
        <column table="t" column="prizn_selo">
        </column>
        <call function="ng_account.f_category_account" as="category">
          <column table="a" column="kod_account">
          </column>
        </call>
        <column table="a" column="kod_dhh">
        </column>
        <column table="a" column="kodinterval">
        </column>
        <column table="nal" column="nal">
        </column>
        <column table="ao" column="pr_usl">
        </column>
        <usepart part="pr_nasel" as="pr_nasel" />
        <column table="ao" column="pr_2rate">
        </column>
        <usepart part="pr_2rate_name" as="pr_2rate_name" />
        <usepart part="f46_razdel" as="f46_razdel" />
        <column table="r46" column="name" as="f46_razdel_name">
        </column>
        <usepart part="f46_podrazdel" as="f46_podrazdel" />
        <column table="p46" column="name" as="f46_podrazdel_name">
        </column>
      </select>
      <from>
        <table name="nr_account" as="a">
        </table>
        <query name="kr_dogovor" as="d" join="left outer">
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="d" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="sk_nachisl" as="nch" join="left outer">
          <call function="=">
            <column table="a" column="vid_t">
            </column>
            <column table="n" column="vid_t">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t" join="left outer">
          <call function="=">
            <column table="a" column="tarif">
            </column>
            <column table="t" column="tarif">
            </column>
          </call>
        </query>
        <query name="nr_account.nr_account_nal" as="nal" join="left outer">
          <call function="=">
            <column table="a" column="kod_account">
            </column>
            <column table="nal" column="kod_account">
            </column>
          </call>
        </query>
        <query name="kr_plan" as="pl" join="left outer">
          <call function="=">
            <column table="a" column="kod_plan">
            </column>
            <column table="pl" column="kod_plan">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t2" join="left outer">
          <call function="and">
            <call function="=">
              <column table="pl" column="tarif2">
              </column>
              <column table="t2" column="tarif_parent">
              </column>
            </call>
            <call function="=">
              <column table="a" column="voltage">
              </column>
              <column table="t2" column="voltage">
              </column>
            </call>
          </call>
        </query>
        <query name="nr_account_obj" as="ao" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_numobj">
              </column>
              <column table="ao" column="kod_numobj">
              </column>
            </call>
            <call function="=">
              <column table="a" column="ym">
              </column>
              <column table="ao" column="ym">
              </column>
            </call>
          </call>
        </query>
        <query name="f46_podrazdel" as="p46" join="left outer">
          <call function="=">
            <usepart part="f46_podrazdel" as="f46_podrazdel" />
            <column table="p46" column="id">
            </column>
          </call>
        </query>
        <query name="f46_razdel" as="r46" join="left outer">
          <call function="=">
            <usepart part="f46_razdel" as="f46_razdel" />
            <column table="r46" column="id">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="nr_account.nr_account_nal">
      <select>
        <column table="a" column="kod_account" group="1">
        </column>
        <column table="a" column="nal" group="sum">
        </column>
      </select>
      <from>
        <query name="nr_account_nal" as="a">
        </query>
      </from>
      <group>
        <column table="a" column="kod_account">
        </column>
      </group>
    </query>
    <query name="nr_account_obj">
      <select>
        <column table="a" column="kod_numobj" group="1">
        </column>
        <column table="a" column="ym" group="1">
        </column>
        <call function="case" as="pr_usl">
          <call function="when">
            <call function="is null">
              <column table="a" column="tarif2" group="max">
              </column>
            </call>
            <const>0</const>
          </call>
          <call function="else">
            <const>1</const>
          </call>
        </call>
        <call function="case" as="pr_free" group="max">
          <call function="when">
            <call function="in">
              <column table="a" column="vid_t">
              </column>
              <call function="array">
                <const>77</const>
                <const>78</const>
                <const>79</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="pr_2rate" group="max">
          <call function="when">
            <call function="=">
              <column table="a" column="vid_t">
              </column>
              <const>22</const>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
      </select>
      <from>
        <query name="nr_account" as="a" />
      </from>
    </query>
    <query name="nr_account[vid_t]">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="nr_account" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_t">
            </column>
            <const>:1</const>
          </call>
          <call function="is not null">
            <column table="a" column="nachisl">
            </column>
          </call>
        </call>
      </where>
    </query>
    <query name="nr_account[edizm]">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="nr_account" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="edizm">
          </column>
          <const>:1</const>
        </call>
      </where>
    </query>
    <query name="nr_account[ym]">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="nr_account" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym">
          </column>
          <const>:1</const>
        </call>
      </where>
    </query>
    <query name="nr_account_nal">
      <select>
        <column table="a" column="kod_account">
        </column>
        <column table="a" column="nal">
        </column>
      </select>
      <from>
        <table name="nr_account_nal" as="a">
        </table>
      </from>
    </query>
    <query name="nr_account_priem">
      <select>
        <column table="a" column="kod_account_priem">
        </column>
      </select>
      <from>
        <table name="nr_account_priem" as="a">
        </table>
      </from>
    </query>
    <query name="n_calc">
      <select>
        <column table="a" column="ym" type="number" />
        <call function="ym to char" as="name" title="Период">
          <column table="a" column="ym">
          </column>
        </call>
      </select>
      <from>
        <table name="n_calc" as="a" view="1">
        </table>
      </from>
    </query>
    <query name="n_calc_dist" order="1 desc">
      <select>
        <column table="a" column="ym" group="1">
        </column>
        <column table="a" column="name" group="max">
        </column>
      </select>
      <from>
        <query name="n_calc" as="a">
        </query>
      </from>
    </query>
    <query name="n_calc_max">
      <select>
        <column table="a" column="ym" group="max">
        </column>
      </select>
      <from>
        <query name="n_calc" as="a">
        </query>
      </from>
      <where>
        <call function="ls">
          <column table="a" column="ym">
          </column>
          <call function="date to ym">
            <const>sysdate</const>
          </call>
        </call>
      </where>
    </query>
    <query name="sk_edizm">
      <select>
        <column table="a" column="edizm">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <table name="sk_edizm" as="a">
        </table>
      </from>
    </query>
    <query name="sk_into_kniga">
      <select>
        <column table="a" column="kod" type="number">
        </column>
        <column table="a" column="name" type="string">
        </column>
      </select>
      <from>
        <table name="sk_into_kniga" as="a">
        </table>
      </from>
    </query>
    <query name="sk_nachisl">
      <select>
        <column table="a" column="vid_t">
        </column>
        <column table="a" column="num_t">
        </column>
        <column table="a" column="edizm">
        </column>
        <column table="a" column="name" type="string">
        </column>
        <column table="e" column="name" as="edizm_name">
        </column>
      </select>
      <from>
        <table name="sk_nachisl" as="a">
        </table>
        <query name="sk_edizm" as="e" join="left outer">
          <call function="=">
            <column table="a" column="edizm">
            </column>
            <column table="e" column="edizm">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sk_type_opl">
      <select>
        <column table="a" column="kod_type_opl">
        </column>
        <column table="a" column="name">
        </column>
      </select>
      <from>
        <table name="sk_type_opl" as="a">
        </table>
      </from>
    </query>
    <query name="sr_debet">
      <param name="date">
        <const>sysdate</const>
      </param>
      <select>
        <column table="a" column="kod_deb" type="number">
        </column>
        <column table="a" column="dat_bzad" type="date" title="Дата возникновения задолженности">
        </column>
        <column table="fv" column="dolg" type="number">
        </column>
      </select>
      <from>
        <table name="sr_debet" as="a">
        </table>
        <query name="sr_debet.sr_facvip" as="fv" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
          <call function="=">
            <column table="fv" column="kod_deb">
            </column>
            <column table="a" column="kod_deb">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_debet_state">
      <select>
        <column table="a" column="rowid" as="id" type="string">
        </column>
        <column table="a" column="kod_state" type="number">
        </column>
        <column table="a" column="kod_deb" type="number">
        </column>
        <column table="a" column="dat_ust" type="date">
        </column>
        <call function="date to ym" as="ym">
          <column table="a" column="dat_ust" />
        </call>
        <column table="st" column="fname" as="state_fname">
        </column>
      </select>
      <from>
        <table name="sr_debet_state" as="a">
        </table>
        <query name="ss_state" as="st" join="left outer">
          <call function="=">
            <column table="a" column="kod_state">
            </column>
            <column table="st" column="kod_state">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_debet_state_ym1">
      <select>
        <column table="a" column="kod_deb" group="1" />
        <column table="a" column="ym" group="1" />
        <call function="keep last" as="id">
          <call function="max">
            <column table="a" column="id">
            </column>
          </call>
          <column table="a" column="dat_ust" />
        </call>
      </select>
      <from>
        <query name="sr_debet_state" as="a">
        </query>
      </from>
    </query>
    <query name="sr_debet_state_ym">
      <select>
        <column table="a" column="id" />
        <column table="a" column="ym">
        </column>
        <column table="a" column="kod_deb" type="number">
        </column>
        <column table="ds" column="kod_state">
        </column>
        <column table="ds" column="state_fname">
        </column>
      </select>
      <from>
        <query name="sr_debet_state_ym1" as="a">
        </query>
        <query name="sr_debet_state" as="ds" join="left outer">
          <call function="=">
            <column table="a" column="id">
            </column>
            <column table="ds" column="id">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_facopl">
      <params>
        <param name="date">
          <const>null</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_fopl">
        </column>
        <column table="a" column="kod_ras">
        </column>
        <column table="a" column="kod_opl">
        </column>
        <column table="a" column="opl" type="number" title="Оплачено (руб.)">
        </column>
        <column table="a" column="cust" type="number" title="Оплачено (нат. пок.)">
        </column>
        <column table="b" column="dat_opl">
        </column>
        <column table="b" column="dat_oper">
        </column>
        <column table="b" column="ym">
        </column>
        <column table="r" column="vid_real">
        </column>
        <column table="b" column="kod_dog">
        </column>
        <column table="b" column="prizn_selo_dog">
        </column>
        <column table="b" column="ndog">
        </column>
        <column table="b" column="dog_pr_active">
        </column>
        <column table="b" column="kod_vidopl">
        </column>
        <column table="b" column="dep">
        </column>
        <column table="b" column="dep_name">
        </column>
        <column table="b" column="kodbpol" />
        <column table="b" column="pol_rs">
        </column>
        <column table="b" column="pol_rs_name">
        </column>
        <column table="b" column="sf_ym">
        </column>
        <column table="b" column="date_ym">
        </column>
        <column table="b" column="kod_type_opl">
        </column>
        <column table="b" column="type_opl_name">
        </column>
        <column table="b" column="pfact_prev">
        </column>
        <column table="b" column="pfact_prev_name">
        </column>
        <column table="b" column="into_kniga">
        </column>
        <column table="b" column="into_kniga_name">
        </column>
        <column table="b" column="fk_rym">
        </column>
        <column table="b" column="vid_opl_abbr">
        </column>
        <column table="r" column="vid_t">
        </column>
        <column table="r" column="vid_t_name">
        </column>
        <column table="r" column="num_t">
        </column>
        <column table="r" column="vid_t_teplo">
        </column>
        <column table="r" column="vid_t_teplo_name">
        </column>
        <column table="r" column="vid_t_teplo_gr">
        </column>
        <column table="r" column="vid_t_teplo_gr_name">
        </column>
        <column table="r" column="rym">
        </column>
        <column table="r" column="kod_sf">
        </column>
        <column table="r" column="prizn_selo">
        </column>
        <column table="r" column="nump">
        </column>
        <column table="n" column="nal" title="Оплачено НДС">
        </column>
      </select>
      <from>
        <table name="sr_facopl" as="a">
        </table>
        <query name="sr_facopl.sr_facopl_nal" as="n" join="left outer">
          <call function="=">
            <column table="a" column="kod_fopl">
            </column>
            <column table="n" column="kod_fopl">
            </column>
          </call>
        </query>
        <query name="sr_opl" as="b" join="left outer">
          <call function="=">
            <column table="a" column="kod_opl">
            </column>
            <column table="b" column="kod_opl">
            </column>
          </call>
        </query>
        <query name="sr_facras" as="r" join="left outer">
          <call function="=">
            <column table="a" column="kod_ras">
            </column>
            <column table="r" column="kod_ras">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="ls=">
          <column table="b" column="ym">
          </column>
          <call function="nvl">
            <call function="date to ym">
              <useparam name="date" />
            </call>
            <column table="b" column="ym">
            </column>
          </call>
        </call>
      </where>
    </query>
    <query name="sr_facopl.sr_facopl_nal">
      <select>
        <column table="a" column="kod_fopl" group="1">
        </column>
        <column table="a" column="nal" group="sum">
        </column>
      </select>
      <from>
        <table name="sr_facopl_nal" as="a">
        </table>
      </from>
    </query>
    <query name="sr_facras.sr_facopl">
      <params>
        <param name="date" />
      </params>
      <select>
        <column table="a" column="kod_ras" as="kod_ras" group="1">
        </column>
        <column table="a" column="opl" group="sum">
        </column>
        <column table="a" column="cust" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facopl" as="a">
          <withparams>
            <useparam name="date" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="sr_facras">
      <params>
        <param name="date">
          <call function="doomsday">
          </call>
        </param>
      </params>
      <select>
        <column table="a" column="kod_ras" type="number">
        </column>
        <column table="a" column="rym" title="Начисление за период">
        </column>
        <call function="nvl0" as="nal" title="Начислено НДС">
          <column table="n" column="nal">
          </column>
        </call>
        <column table="v" column="dep">
        </column>
        <column table="v" column="dep_name">
        </column>
        <column table="v" column="kod_dog">
        </column>
        <column table="v" column="dat_sf">
        </column>
        <column table="v" column="dog_pr_active">
        </column>
        <column table="v" column="ndog">
        </column>
        <column table="v" column="kod_sf">
        </column>
        <column table="v" column="tep_el">
        </column>
        <column table="v" column="vid_real">
        </column>
        <column table="v" column="ym">
        </column>
        <column table="v" column="into_kniga">
        </column>
        <column table="v" column="into_kniga_name">
        </column>
        <column table="v" column="fk_rym">
        </column>
        <column table="v" column="prizn_selo_dog">
        </column>
        <column table="v" column="def_state_fname" />
        <column table="v" column="nump">
        </column>
        <column table="a" column="vid_t" type="number">
        </column>
        <column table="nch" column="name" as="vid_t_name">
        </column>
        <column table="nch" column="num_t" title="Код вида начисления">
        </column>
        <column table="nch" column="edizm">
        </column>
        <column table="nch" column="edizm_name">
        </column>
        <column table="a" column="nachisl" type="number" title="Начислено (руб)">
        </column>
        <column table="a" column="kod_numobj" type="number">
        </column>
        <column table="a" column="cust" type="number" title="Начислено (нат. пок.)">
        </column>
        <call function="nvl0" as="opl">
          <column table="o" column="opl">
          </column>
        </call>
        <call function="nvl0" as="opl_cust">
          <column table="o" column="cust">
          </column>
        </call>
        <call function="-" as="dolg">
          <column table="a" column="nachisl">
          </column>
          <call function="nvl0" as="opl">
            <column table="o" column="opl">
            </column>
          </call>
        </call>
        <call function="-" as="dolg_cust">
          <column table="a" column="cust">
          </column>
          <call function="nvl0">
            <column table="o" column="cust">
            </column>
          </call>
        </call>
        <call function="case" as="vid_t_teplo" type="number">
          <!--
        в зависимости от vid_t и отделения
        
          Тепловая энергия 1,2

          Горячее водоснабжение:
          2.1) тепловая энергия на подогрев воды 55

          2.2) холодная вода 54 - казань, нижнекамск, заинск
          2.3) теплоноситель 54 - челны , уруссу
             + теплоноситель 58 - заинск
          по коду отделения

          Теплоноситель:
          3.1) вода (ХОЧ) 11,56
          3.2) пар (ХОВ) 3,57

      102276621	Филиал ОАО "ТАТТЕПЛОСБЫТ" - Казанский
      102276623	Филиал ОАО "ТАТТЕПЛОСБЫТ" - Набережночелнинский
      102276626	Уруссинский участок Филиала ОАО "ТАТТЕПЛОСБЫТ" - Камский
      102276624	Елабужский участок Филиала ОАО "ТАТТЕПЛОСБЫТ" - Набережночелнинский
      102276625	Филиал ОАО "ТАТТЕПЛОСБЫТ" - Камский
      2572294  	Заинский участок Филиала ОАО "ТАТТЕПЛОСБЫТ" - Камский
      
      -->
          <call function="when">
            <call function="in">
              <column table="a" column="vid_t">
              </column>
              <call function="array">
                <const>1</const>
                <const>2</const>
              </call>
            </call>
            <const>1.1</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="vid_t">
              </column>
              <const>55</const>
            </call>
            <const>2.1</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="vid_t">
              </column>
              <const>54</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="in">
                  <column table="v" column="dep">
                  </column>
                  <call function="array">
                    <const>102276621</const>
                    <const>102276625</const>
                    <const>2572294</const>
                  </call>
                </call>
                <const>2.2</const>
              </call>
              <call function="else">
                <const>2.3</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="v" column="dep">
                </column>
                <const>2572294</const>
              </call>
              <call function="=">
                <column table="a" column="vid_t">
                </column>
                <const>58</const>
              </call>
            </call>
            <const>2.3</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="vid_t">
              </column>
              <call function="array">
                <const>11</const>
                <const>56</const>
              </call>
            </call>
            <const>3.1</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="vid_t">
              </column>
              <call function="array">
                <const>3</const>
                <const>57</const>
              </call>
            </call>
            <const>3.2</const>
          </call>
          <call function="else">
            <column table="a" column="vid_t">
            </column>
          </call>
        </call>
        <column table="ao" column="pr_usl">
        </column>
        <usepart part="pr_nasel" as="pr_nasel" />
        <column table="ao" column="pr_2rate">
        </column>
        <usepart part="pr_2rate_name" as="pr_2rate_name" />
        <usepart part="f46_razdel" as="f46_razdel" />
        <column table="r46" column="name" as="f46_razdel_name">
        </column>
        <usepart part="f46_podrazdel" as="f46_podrazdel" />
        <column table="p46" column="name" as="f46_podrazdel_name">
        </column>
        <column table="ao" column="pr_zon">
        </column>
        <column table="ftx" column="voltage">
        </column>
        <column table="ftx" column="voltage_abbr">
        </column>
        <column table="ftx" column="kodinterval">
        </column>
        <column table="ftx" column="interval_abbr">
        </column>
        <column table="ftx" column="interval_name">
        </column>
        <column table="ftx" column="kod_f46">
        </column>
        <column table="ftx" column="f46_npp">
        </column>
        <column table="ftx" column="f46_name">
        </column>
        <column table="t" column="prizn_selo">
        </column>
        <column table="vidtt" column="name" as="vid_t_teplo_name" title="Наименование товара">
        </column>
        <column table="vidtt" column="gr" as="vid_t_teplo_gr">
        </column>
        <column table="vidtt" column="gr_name" as="vid_t_teplo_gr_name" title="Вид товара">
        </column>
      </select>
      <from>
        <table name="sr_facras" as="a">
        </table>
        <query name="sr_facvip" as="v" join="left outer">
          <call function="=">
            <column table="a" column="kod_sf">
            </column>
            <column table="v" column="kod_sf">
            </column>
          </call>
        </query>
        <query name="sr_facras_text" as="ftx" join="left outer">
          <call function="=">
            <column table="a" column="kod_ras">
            </column>
            <column table="ftx" column="kod_ras">
            </column>
          </call>
        </query>
        <query name="nr_account_obj" as="ao" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_numobj">
              </column>
              <column table="ao" column="kod_numobj">
              </column>
            </call>
            <call function="=">
              <column table="v" column="ym">
              </column>
              <column table="ao" column="ym">
              </column>
            </call>
          </call>
        </query>
        <query name="sk_nachisl" as="nch" join="left outer">
          <call function="=">
            <column table="a" column="vid_t">
            </column>
            <column table="nch" column="vid_t">
            </column>
          </call>
        </query>
        <query name="sr_facras.sr_facras_nal" as="n" join="left outer">
          <call function="=">
            <column table="a" column="kod_ras">
            </column>
            <column table="n" column="kod_ras">
            </column>
          </call>
        </query>
        <query name="sr_facras.sr_facopl" as="o" join="left outer">
          <withparams>
            <useparam name="date" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_ras">
            </column>
            <column table="o" column="kod_ras">
            </column>
          </call>
        </query>
        <query name="f46_podrazdel" as="p46" join="left outer">
          <call function="=">
            <usepart part="f46_podrazdel" as="f46_podrazdel" />
            <column table="p46" column="id">
            </column>
          </call>
        </query>
        <query name="f46_razdel" as="r46" join="left outer">
          <call function="=">
            <usepart part="f46_razdel" as="f46_razdel" />
            <column table="r46" column="id">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t" join="left outer">
          <call function="=">
            <column table="a" column="tarif">
            </column>
            <column table="t" column="tarif">
            </column>
          </call>
        </query>
        <query name="v_vid_t_teplo" as="vidtt" join="left outer">
          <call function="=">
            <column table="this" column="vid_t_teplo">
            </column>
            <column table="vidtt" column="id">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="v" column="vid_real">
          </column>
        </call>
      </where>
    </query>
    <query name="sr_facras.sr_facras_nal">
      <select>
        <column table="n" column="kod_ras" as="kod_ras" group="1">
        </column>
        <column table="n" column="nal" group="sum">
        </column>
      </select>
      <from>
        <table name="sr_facras_nal" as="n">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo">
      <select>
        <column table="b" column="name" as="gr_name">
        </column>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="v_vid_t_teplo_un" as="a">
        </query>
        <query name="v_vid_t_gr_teplo" as="b" join="inner">
          <call function="=">
            <column table="a" column="gr">
            </column>
            <column table="b" column="id">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="v_vid_t_gr_teplo">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="v_vid_t_gr_teplo_un" as="a">
        </query>
      </from>
    </query>
    <query name="v_vid_t_gr_teplo_un">
      <union>
        <query name="v_vid_t_teplo[1]">
        </query>
        <query name="v_vid_t_teplo[2]">
        </query>
        <query name="v_vid_t_teplo[3]">
        </query>
      </union>
    </query>
    <query name="v_vid_t_teplo[1]">
      <select>
        <const as="id" type="number">1</const>
        <const as="name" type="string">'1 Тепловая энергия'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[2]">
      <select>
        <const as="id">2</const>
        <const as="name">'2 Горячее водоснабжение'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[3]">
      <select>
        <const as="id">3</const>
        <const as="name">'3 Теплоноситель'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo_un">
      <union>
        <query name="v_vid_t_teplo[1.1]">
        </query>
        <query name="v_vid_t_teplo[2.1]">
        </query>
        <query name="v_vid_t_teplo[2.2]">
        </query>
        <query name="v_vid_t_teplo[2.3]">
        </query>
        <query name="v_vid_t_teplo[3.1]">
        </query>
        <query name="v_vid_t_teplo[3.2]">
        </query>
      </union>
    </query>
    <query name="v_vid_t_teplo[1.1]">
      <select>
        <const as="id" type="number">1.1</const>
        <const as="gr" type="number">1</const>
        <const as="name" type="string">'1.1 тепловая энергия'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[2.1]">
      <select>
        <const as="id">2.1</const>
        <const as="gr">2</const>
        <const as="name">'2.1 тепловая энергия на подогрев воды'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[2.2]">
      <select>
        <const as="id">2.2</const>
        <const as="gr">2</const>
        <const as="name">'2.2 холодная вода'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[2.3]">
      <select>
        <const as="id">2.3</const>
        <const as="gr">2</const>
        <const as="name">'2.3 теплоноситель'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[3.1]">
      <select>
        <const as="id">3.1</const>
        <const as="gr">3</const>
        <const as="name">'3.1 вода (ХОЧ)'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="v_vid_t_teplo[3.2]">
      <select>
        <const as="id">3.2</const>
        <const as="gr">3</const>
        <const as="name">'3.2 пар (ХОВ)'</const>
      </select>
      <from>
        <table name="dual" as="a">
        </table>
      </from>
    </query>
    <query name="temp_pr_selo_facras">
      <select>
        <column table="a" column="kod_ras">
        </column>
        <column table="a" column="prizn_selo">
        </column>
      </select>
      <from>
        <query name="sr_facras" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_ras">
          </column>
          <const>p_kod_ras</const>
        </call>
      </where>
    </query>
    <query name="sr_facras_text">
      <select>
        <column table="a" column="kod_ras">
        </column>
        <column table="a" column="kod_account">
        </column>
        <column table="a" column="voltage">
        </column>
        <column table="vlt" column="abbr" as="voltage_abbr">
        </column>
        <column table="a" column="kodinterval">
        </column>
        <column table="it" column="abbr" as="interval_abbr">
        </column>
        <column table="it" column="name" as="interval_name">
        </column>
        <column table="a" column="kod_f46">
        </column>
        <column table="f46" column="npp" as="f46_npp">
        </column>
        <column table="f46" column="name" as="f46_name">
        </column>
      </select>
      <from>
        <table name="sr_facras_text" as="a">
        </table>
        <query name="nr_account" as="ac" join="left outer">
          <call function="=">
            <column table="a" column="kod_account">
            </column>
            <column table="ac" column="kod_account">
            </column>
          </call>
        </query>
        <query name="hk_voltage" as="vlt" join="left outer">
          <call function="=">
            <column table="a" column="voltage">
            </column>
            <column table="vlt" column="voltage">
            </column>
          </call>
        </query>
        <query name="kk_interval" as="it" join="left outer">
          <call function="=">
            <column table="a" column="kodinterval">
            </column>
            <column table="it" column="kodinterval">
            </column>
          </call>
        </query>
        <query name="ks_46" as="f46" join="left outer">
          <call function="=">
            <column table="a" column="kod_f46">
            </column>
            <column table="f46" column="kod_f46">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_facvip">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="v" column="kod_sf" type="number">
        </column>
        <column table="v" column="dat_sf" type="date">
        </column>
        <column table="v" column="vid_real" type="number" title="Код вида реализации">
        </column>
        <column table="v" column="ym">
        </column>
        <column table="v" column="kod_dog">
        </column>
        <column table="v" column="num_sf" type="number">
        </column>
        <call function="||" as="name" title="Документ начисления">
          <const>'№ '</const>
          <column table="v" column="num_sf">
          </column>
          <const>' от '</const>
          <call function="date to char">
            <column table="v" column="dat_sf">
            </column>
          </call>
        </call>
        <column table="d" column="pr_active" as="dog_pr_active">
        </column>
        <column table="d" column="dat_fin" as="dog_dat_fin">
        </column>
        <column table="d" column="ndog">
        </column>
        <column table="d" column="inn">
        </column>
        <column table="d" column="kpp">
        </column>
        <column table="d" column="kodp">
        </column>
        <column table="d" column="nump">
        </column>
        <column table="d" column="payer_name">
        </column>
        <column table="d" column="tep_el">
        </column>
        <column table="d" column="dep">
        </column>
        <column table="d" column="dep_name">
        </column>
        <column table="d" column="name" as="dog_name">
        </column>
        <call function="case" as="kred_dolg" title="Кред. задолж по договору" type="number">
          <call function="when">
            <call function="=">
              <column table="v" column="kod_sf">
              </column>
              <column table="d" column="last_dolg_sf">
              </column>
            </call>
            <column table="d" column="kred_dolg">
            </column>
          </call>
          <call function="else">
            <const>null</const>
          </call>
        </call>
        <column table="r" column="vid_t_teplo_gr_name">
        </column>
        <call function="nvl0" as="nachisl" type="number">
          <column table="r" column="nachisl">
          </column>
        </call>
        <call function="nvl0" as="opl" type="number">
          <column table="o" column="oplf">
          </column>
        </call>
        <column table="d" column="prizn_selo" as="prizn_selo_dog">
        </column>
        <column table="rcsf" column="into_kniga">
        </column>
        <column table="rcsf" column="into_kniga_name">
        </column>
        <column table="rcsf" column="rym" as="fk_rym">
        </column>
        <column table="v" column="kod_deb">
        </column>
        <column table="def_state" column="state_fname" as="def_state_fname" title="Сост. на момент формирования">
        </column>
        <call function="nvl" as="dat_bzad_nvl" type="date" title="Дата возник. задолж.">
          <column table="deb" column="dat_bzad">
          </column>
          <column table="v" column="dat_sf">
          </column>
        </call>
        <call function="-nvl" as="dolg" title="Задолженность">
          <column table="r" column="nachisl">
          </column>
          <column table="o" column="oplf">
          </column>
        </call>
        <column table="deb" column="dolg" as="deb_dolg">
        </column>
        <call function="case" as="days_dolg" type="number" title="Срок задолженности(дн.)">
          <call function="when">
            <call function="=">
              <column table="this" column="dolg">
              </column>
              <const>0</const>
            </call>
            <const>null</const>
          </call>
          <call function="else">
            <call function="case">
              <call function="when">
                <call function="ls">
                  <column table="this" column="dat_bzad_nvl">
                  </column>
                  <useparam name="date">
                  </useparam>
                </call>
                <call function="-">
                  <useparam name="date">
                  </useparam>
                  <column table="this" column="dat_bzad_nvl">
                  </column>
                </call>
              </call>
              <call function="else">
                <const>0</const>
              </call>
            </call>
          </call>
        </call>
        <call function="case" as="days_dolg_diap" type="string" title="Критерий задолженности">
          <call function="when">
            <call function="between">
              <column table="this" column="days_dolg">
              </column>
              <const>45</const>
              <const>90</const>
            </call>
            <const>'от 45 до 90 дней'</const>
          </call>
          <call function="when">
            <call function="gt">
              <column table="this" column="days_dolg">
              </column>
              <const>90</const>
            </call>
            <const>'свыше 90 дней'</const>
          </call>
          <call function="else">
            <const>null</const>
          </call>
        </call>
      </select>
      <from>
        <table name="sr_facvip" as="v">
        </table>
        <query name="kr_dogovor" as="d" join="left outer">
          <call function="=">
            <column table="v" column="kod_dog">
            </column>
            <column table="d" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="sr_facvip.sr_facras" as="r" join="left outer">
          <call function="=">
            <column table="v" column="kod_sf">
            </column>
            <column table="r" column="kod_sf">
            </column>
          </call>
        </query>
        <query name="sr_facvip.sr_opl" as="o" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
          <call function="=">
            <column table="v" column="kod_sf">
            </column>
            <column table="o" column="kod_sf">
            </column>
          </call>
        </query>
        <query name="sr_recalc_sf" as="rcsf" join="left outer">
          <call function="=">
            <column table="v" column="kod_sf">
            </column>
            <column table="rcsf" column="kod_sf">
            </column>
          </call>
        </query>
        <query name="sr_debet" as="deb" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
          <call function="=">
            <column table="v" column="kod_deb">
            </column>
            <column table="deb" column="kod_deb">
            </column>
          </call>
        </query>
        <query name="sr_debet_state_ym" as="def_state" join="left outer">
          <call function="and">
            <call function="=">
              <column table="v" column="kod_deb">
              </column>
              <column table="def_state" column="kod_deb">
              </column>
            </call>
            <call function="=">
              <column table="v" column="ym">
              </column>
              <column table="def_state" column="ym">
              </column>
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_facvip.sr_opl">
      <param name="date">
        <const>sysdate</const>
      </param>
      <select>
        <column table="o" column="kod_sf" group="1">
        </column>
        <column table="o" column="nal" group="sum">
        </column>
        <column table="o" column="oplf" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="o">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
    </query>
    <query name="sr_facvip.sr_facras">
      <select>
        <column table="o" column="kod_sf" group="1">
        </column>
        <column table="o" column="nal" group="sum">
        </column>
        <column table="o" column="nachisl" group="sum">
        </column>
        <column table="o" column="cust" group="sum">
        </column>
        <!--<call function ="distinct" as="vid_t_teplo_gr_name"  group="stragg"  type="string">-->
        <column table="o" column="vid_t_teplo_gr_name" group="stragg_dist">
        </column>
        <!--</call>-->
      </select>
      <from>
        <query name="sr_facras" as="o">
        </query>
      </from>
    </query>
    <query name="sr_debet.sr_facvip">
      <param name="date">
        <const>sysdate</const>
      </param>
      <select>
        <column table="a" column="kod_deb" group="1">
        </column>
        <column table="a" column="dolg" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
    </query>
    <query name="kr_dogovor.sr_facvip">
      <params>
        <param name="date">
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1">
        </column>
        <column table="a" column="dolg" group="sum">
        </column>
        <column table="a" column="kod_sf" group="max">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=">
          <column table="a" column="dolg">
          </column>
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="sr_facvip.dolg">
      <!--удалить?-->
      <select>
        <column table="v" column="*">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="v">
        </query>
      </from>
      <where>
        <call function="gt">
          <call function="-">
            <column table="v" column="nachisl">
            </column>
            <column table="v" column="opl">
            </column>
          </call>
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="sr_opl">
      <params>
        <param name="date">
          <const>sysdate</const>
        </param>
      </params>
      <select>
        <column table="o" column="kod_opl" as="kod_opl">
        </column>
        <column table="o" column="kod_dog" as="kod_dog">
        </column>
        <column table="o" column="kod_vidopl">
        </column>
        <column table="o" column="kod_parent">
        </column>
        <column table="o" column="vid_real" as="vid_real_opl">
        </column>
        <column table="v" column="vid_real">
        </column>
        <column table="v" column="ym" as="sf_ym" title="Период начисления">
        </column>
        <column table="v" column="dat_bzad_nvl">
        </column>
        <column table="d" column="dep">
        </column>
        <column table="d" column="dep_name">
        </column>
        <column table="d" column="kodp">
        </column>
        <column table="d" column="nump">
        </column>
        <column table="d" column="ndog">
        </column>
        <column table="d" column="pr_active" as="dog_pr_active">
        </column>
        <column table="d" column="prizn_selo" as="prizn_selo_dog">
        </column>
        <call function="nvl0" as="nal" title="Оплачено НДС">
          <column table="n" column="nal">
          </column>
        </call>
        <column table="o" column="kod_sf">
        </column>
        <column table="o" column="ym">
        </column>
        <column table="o" column="dat_opl">
        </column>
        <call function="date to ym" as="date_ym">
          <column table="o" column="dat_opl">
          </column>
        </call>
        <column table="o" column="kod_type_opl" />
        <column table="tpo" column="name" as="type_opl_name" title="Тип оплаты" />
        <call function="case" as="pfact_prev" type="number">
          <!-- является ли оплата погашением факта оплатами пердыдущего периода-->
          <call function="when">
            <call function="and">
              <call function="ls">
                <call function="date to ym">
                  <column table="o" column="dat_opl">
                  </column>
                </call>
                <column table="o" column="ym">
                </column>
              </call>
              <call function="in">
                <column table="o" column="kod_type_opl">
                </column>
                <call function="array">
                  <const>3</const>
                  <const>4</const>
                </call>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="else">
            <const>0</const>
          </call>
        </call>
        <call function="case" as="pfact_prev_name" type="string">
          <call function="when">
            <call function="=">
              <column table="this" column="pfact_prev" group="1">
              </column>
              <const>1</const>
            </call>
            <const>'Погашение факта переплатой/авансом прошлого периода'</const>
          </call>
          <call function="else">
            <const>'Оплата текущего периода'</const>
          </call>
        </call>
        <call function="case" as="dat_oper">
          <call function="when">
            <call function="in">
              <column table="o" column="kod_type_opl">
              </column>
              <call function="array">
                <const>0</const>
                <const>1</const>
                <const>2</const>
              </call>
            </call>
            <column table="o" column="dat_opl">
            </column>
          </call>
          <call function="else">
            <call function="ym end time">
              <column table="o" column="ym" />
            </call>
          </call>
        </call>
        <call function="+" as="oplf" title="Оплачено (руб.)">
          <call function="nvl0">
            <column table="o" column="opl">
            </column>
          </call>
          <call function="nvl0">
            <column table="o" column="opls">
            </column>
          </call>
        </call>
        <column table="o" column="opl" type="number" title="Оплачено (руб.)">
        </column>
        <column table="o" column="opls" />
        <column table="stor" column="opls" as="storno">
        </column>
        <call function="case" as="dolg" title="Кредиторская задолженность" type="number">
          <call function="when">
            <call function="in">
              <column table="o" column="kod_type_opl">
              </column>
              <call function="array">
                <const>1</const>
                <const>2</const>
              </call>
            </call>
            <call function="+nvl">
              <column table="o" column="opl">
              </column>
              <column table="stor" column="oplf">
              </column>
            </call>
          </call>
          <call function="else">
            <const>null</const>
          </call>
        </call>
        <column table="ob" column="kodbpol" />
        <column table="ob" column="pol_rs">
        </column>
        <column table="ob" column="pol_rs_name">
        </column>
        <column table="ob" column="vid_opl_abbr">
        </column>
        <column table="rco" column="into_kniga">
        </column>
        <column table="rco" column="into_kniga_name">
        </column>
        <column table="rco" column="rym" as="fk_rym">
        </column>
      </select>
      <from>
        <table name="sr_opl" as="o">
        </table>
        <query name="kr_dogovor" as="d" join="left outer">
          <call function="=">
            <column table="o" column="kod_dog">
            </column>
            <column table="d" column="kod_dog">
            </column>
          </call>
        </query>
        <query name="sr_facvip" as="v" join="left outer">
          <call function="=">
            <column table="o" column="kod_sf">
            </column>
            <column table="v" column="kod_sf">
            </column>
          </call>
        </query>
        <query name="sr_opl.sr_opl_nal" as="n" join="left outer">
          <call function="=">
            <column table="o" column="kod_opl">
            </column>
            <column table="n" column="kod_opl">
            </column>
          </call>
        </query>
        <query name="sr_opl_bank" as="ob" join="left outer">
          <call function="=">
            <column table="o" column="kod_link">
            </column>
            <column table="ob" column="kod_link">
            </column>
          </call>
        </query>
        <query name="sk_type_opl" as="tpo" join="left outer">
          <call function="=">
            <column table="o" column="kod_type_opl">
            </column>
            <column table="tpo" column="kod_type_opl">
            </column>
          </call>
        </query>
        <!--сторно-->
        <query name="sr_opl.sr_opl" as="stor" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
          <call function="=">
            <column table="stor" column="kod_parent">
            </column>
            <column table="o" column="kod_opl">
            </column>
          </call>
        </query>
        <query name="sr_recalc_opl" as="rco" join="left outer">
          <call function="=">
            <column table="o" column="kod_opl">
            </column>
            <column table="rco" column="kod_opl">
            </column>
          </call>
        </query>
      </from>
      <call function="ls=">
        <column table="a" column="ym">
        </column>
        <call function="nvl">
          <call function="date to ym">
            <useparam name="date" />
          </call>
          <column table="b" column="ym">
          </column>
        </call>
      </call>
    </query>
    <query name="sr_opl.sr_opl">
      <params>
        <param name="date">
        </param>
      </params>
      <select>
        <column table="a" column="kod_parent" group="1">
        </column>
        <column table="a" column="oplf" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
      <where>
        <call function="in">
          <column table="a" column="kod_type_opl">
          </column>
          <call function="array">
            <const>5</const>
            <const>6</const>
          </call>
        </call>
      </where>
    </query>
    <query name="kr_dogovor.sr_opl">
      <params>
        <param name="date">
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1">
        </column>
        <column table="a" column="dolg" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
    </query>
    <query name="sr_opl_bank">
      <select>
        <column table="a" column="kod_link">
        </column>
        <column table="a" column="kodbpol" type="number">
        </column>
        <column table="bp" column="rs" as="pol_rs">
        </column>
        <column table="bp" column="rs_name" as="pol_rs_name">
        </column>
        <column table="vo" as="vid_opl_abbr" column="abbr" title="Вид оплаты(аббр.)">
        </column>
      </select>
      <from>
        <table name="sr_opl_bank" as="a">
        </table>
        <query name="ks_bankpol" as="bp" join="left outer">
          <call function="=">
            <column table="a" column="kodbpol">
            </column>
            <column table="bp" column="kodbpol">
            </column>
          </call>
        </query>
        <query name="ss_vidopl" as="vo" join="left outer">
          <call function="=">
            <column table="a" column="kod_vidopl">
            </column>
            <column table="vo" column="kod_vidopl">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_opl.sr_opl_nal">
      <select>
        <column table="n" column="kod_opl" as="kod_opl" group="1">
        </column>
        <column table="n" column="nal" group="sum">
        </column>
      </select>
      <from>
        <table name="sr_opl_nal" as="n">
        </table>
      </from>
    </query>
    <query name="sr_recalc">
      <select>
        <column table="a" column="kod_recalc" type="number">
        </column>
        <column table="a" column="kod_sf" type="number">
        </column>
        <column table="a" column="kod_opl" type="number">
        </column>
        <column table="a" column="into_kniga" type="number">
        </column>
        <column table="a" column="rym" type="number" title="ФК за период">
        </column>
        <column table="ik" column="name" as="into_kniga_name" type="string">
        </column>
      </select>
      <from>
        <table name="sr_recalc" as="a">
        </table>
        <query name="sk_into_kniga" as="ik" join="left outer">
          <call function="=">
            <column table="a" column="into_kniga">
            </column>
            <column table="ik" column="kod">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_recalc_opl">
      <select>
        <column table="a" column="kod_recalc" type="number" group="max">
        </column>
        <column table="a" column="kod_opl" type="number" group="1">
        </column>
        <column table="rc" column="into_kniga" group="max">
        </column>
        <column table="rc" column="into_kniga_name" group="max" title="ФК, способ отражения в книгах">
        </column>
        <column table="rc" column="rym" group="max">
        </column>
      </select>
      <from>
        <table name="sr_recalc_opl" as="a">
        </table>
        <query name="sr_recalc" as="rc" join="left outer">
          <call function="=">
            <column table="a" column="kod_recalc">
            </column>
            <column table="rc" column="kod_recalc">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="sr_recalc_sf">
      <select>
        <column table="a" column="kod_recalc" type="number" group="max">
        </column>
        <column table="a" column="kod_sf" type="number" group="1">
        </column>
        <column table="rc" column="into_kniga" group="max">
        </column>
        <column table="rc" column="into_kniga_name" group="max" title="ФК, способ отражения в книгах">
        </column>
        <column table="rc" column="rym" group="max">
        </column>
      </select>
      <from>
        <table name="sr_recalc_sf" as="a">
        </table>
        <query name="sr_recalc" as="rc" join="left outer">
          <call function="=">
            <column table="a" column="kod_recalc">
            </column>
            <column table="rc" column="kod_recalc">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="ss_state">
      <select>
        <column table="a" column="kod_state" type="number">
        </column>
        <column table="a" column="name" type="string">
        </column>
        <call function="||" as="fname">
          <column table="a" column="kod_state">
          </column>
          <const>' '</const>
          <column table="a" column="name">
          </column>
        </call>
      </select>
      <from>
        <table name="ss_state" as="a">
        </table>
      </from>
    </query>
    <query name="ss_vidopl">
      <select>
        <column table="a" column="kod_vidopl" type="number">
        </column>
        <column table="a" column="abbr" type="string">
        </column>
      </select>
      <from>
        <table name="ss_vidopl" as="a">
        </table>
      </from>
    </query>
    <query name="tnr_account">
      <select>
        <column table="a" column="kod_account" type="number">
        </column>
        <column table="a" column="kod_dog" type="number">
        </column>
        <column table="a" column="kod_izv" type="number">
        </column>
        <column table="a" column="ym" type="number">
        </column>
        <column table="a" column="nachisl" type="number">
        </column>
        <column table="a" column="rym" type="number">
        </column>
        <column table="dog" column="nump">
        </column>
      </select>
      <from>
        <table name="tnr_account" as="a">
        </table>
        <query name="tnr_izv" as="izv" join="left outer">
          <call finction="=">
            <column table="a" column="kod_izv" />
            <column table="izv" column="kod_izv" />
          </call>
        </query>
        <query name="kr_dogovor" as="dog" join="left outer">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="dog" column="kod_dog" />
          </call>
        </query>
      </from>
    </query>
    <query name="tnr_izv.tnr_account">
      <select>
        <column table="a" column="kod_izv" group="1">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
      </select>
      <from>
        <query name="tnr_account" as="a" />
      </from>
    </query>
    <query name="tnr_izv">
      <select>
        <column table="a" column="kod_izv" type="number">
        </column>
        <column table="a" column="num_izv" type="number">
        </column>
        <column table="a" column="ym" type="number">
        </column>
        <column table="a" column="kod_dog" type="number">
        </column>
        <column table="acc" column="nachisl">
        </column>
      </select>
      <from>
        <table name="tnr_izv" as="a">
        </table>
        <query name="tnr_izv.tnr_account" as="acc" join="left outer">
          <call function="=">
            <column table="a" column="kod_izv" />
            <column table="acc" column="kod_izv" />
          </call>
        </query>
      </from>
    </query>
    <query name="tsr_opl">
      <select>
        <column table="a" column="kod_opl" type="number">
        </column>
        <column table="a" column="kod_dog" type="number">
        </column>
        <column table="a" column="kod_izv" type="number">
        </column>
        <column table="a" column="dat_opl" type="date">
        </column>
        <column table="a" column="ym" type="number">
        </column>
        <column table="a" column="opl" type="number">
        </column>
        <column table="dog" column="nump">
        </column>
      </select>
      <from>
        <table name="tsr_opl" as="a">
        </table>
        <query name="tnr_izv" as="izv" join="left outer">
          <call finction="=">
            <column table="a" column="kod_izv" />
            <column table="izv" column="kod_izv" />
          </call>
        </query>
        <query name="kr_dogovor" as="dog" join="left outer">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="dog" column="kod_dog" />
          </call>
        </query>
      </from>
    </query>
    <query name="ur_dogplat">
      <select>
        <column table="a" column="kod_dogplat" type="number">
        </column>
        <column table="a" column="kod" type="number">
        </column>
        <column table="a" column="kod_sdp" type="number">
        </column>
        <column table="a" column="kod_izv" type="number">
        </column>
        <column table="mat" column="nump">
        </column>
        <column table="mat" column="num_delo">
        </column>
        <column table="mat" column="kod_mat">
        </column>
        <column table="izv" column="nachisl">
        </column>
      </select>
      <from>
        <table name="ur_dogplat" as="a">
        </table>
        <query name="ur_mat" as="mat" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod">
              </column>
              <column table="mat" column="kod_mat">
              </column>
            </call>
            <call function="=">
              <column table="a" column="kod_sdp">
              </column>
              <const>6</const>
            </call>
          </call>
        </query>
        <query name="tnr_izv" as="izv" join="left outer">
          <call function="=">
            <column table="a" column="kod_izv">
            </column>
            <column table="izv" column="kod_izv">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="ur_mat.ur_dogplat">
      <select>
        <column table="a" column="kod_mat" as="kod_mat" group="1">
        </column>
        <column table="a" column="kod_izv" group="stragg">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
      </select>
      <from>
        <query name="ur_dogplat" as="a">
        </query>
      </from>
    </query>
    <query name="ur_folders">
      <select>
        <column table="a" column="kod_folders" type="number">
        </column>
        <column table="a" column="kodp" type="number">
        </column>
        <column table="pay" column="nump">
        </column>
      </select>
      <from>
        <table name="ur_folders" as="a">
        </table>
        <query name="kr_payer" as="pay" join="left outer">
          <call function="=">
            <column table="a" column="kodp">
            </column>
            <column table="pay" column="kodp">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="ur_hist_mat">
      <select>
        <column table="a" column="kod_hist_mat" type="number">
        </column>
        <column table="a" column="kod_mat" type="number">
        </column>
        <column table="a" column="dat_post" type="date">
        </column>
        <column table="mat" column="nachisl">
        </column>
        <column table="mat" column="kod_izv">
        </column>
        <column table="mat" column="nump">
        </column>
        <column table="opl" column="opl">
        </column>
      </select>
      <from>
        <table name="ur_hist_mat" as="a">
        </table>
        <query name="ur_mat" as="mat" join="left outer">
          <call function="=">
            <column table="a" column="kod_mat">
            </column>
            <column table="mat" column="kod_mat">
            </column>
          </call>
        </query>
        <query name="ur_hist_mat.tsr_opl" as="opl" join="left outer">
          <call function="=">
            <column table="a" column="kod_mat">
            </column>
            <column table="opl" column="kod_mat">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="ur_hist_mat.tsr_opl">
      <!-- оплаты на дату решения-->
      <select>
        <!-- <column table="a" column="nump" group="max"></column>
        <column table="opl" column="dat_opl" group="max"></column> -->
        <column table="a" column="kod_mat" group="1">
        </column>
        <column table="opl" column="opl" group="sum">
        </column>
      </select>
      <from>
        <query name="ur_hist_mat" as="a">
        </query>
        <query name="ur_dogplat" as="dp" join="left outer">
          <call function="=">
            <column table="a" column="kod_mat">
            </column>
            <column table="dp" column="kod_mat">
            </column>
          </call>
        </query>
        <query name="tsr_opl" as="opl" join="left outer">
          <call function="=">
            <column table="dp" column="kod_izv">
            </column>
            <column table="opl" column="kod_izv">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="ls=">
          <column table="opl" column="dat_opl">
          </column>
          <column table="a" column="dat_post">
          </column>
        </call>
      </where>
    </query>
    <query name="ur_mat">
      <select>
        <column table="a" column="kod_mat" type="number">
        </column>
        <column table="a" column="num_delo" type="string">
        </column>
        <column table="a" column="kod_folders" type="number">
        </column>
        <column table="f" column="nump">
        </column>
        <column table="dp" column="nachisl">
        </column>
        <column table="dp" column="kod_izv">
        </column>
      </select>
      <from>
        <table name="ur_mat" as="a">
        </table>
        <query name="ur_folders" as="f" join="left outer">
          <call function="=">
            <column table="a" column="kod_folders">
            </column>
            <column table="f" column="kod_folders">
            </column>
          </call>
        </query>
        <query name="ur_mat.ur_dogplat" as="dp" join="left outer">
          <call function="=">
            <column table="a" column="kod_mat">
            </column>
            <column table="dp" column="kod_mat">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="10942(87)">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="ur_hist_mat" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="nump" />
          <const>'5465465'</const>
        </call>
      </where>
    </query>
    <query name="20484">
      <union>
        <query name="20484-АБ" />
        <query name="20484-В" />
      </union>
    </query>
    <query name="20484-В">
      <select>
        <usepart part="add-cols-add-group">
          <columns>
            <usepart part="20484-cols" />
          </columns>
          <query>a</query>
        </usepart>
        <column table="a" column="edizm_name" group="1">
        </column>
        <column table="a" column="tip_tar" group="1">
        </column>
        <column table="a" column="interval_name" group="1">
        </column>
        <usepart part="20484-cols-vals" />
      </select>
      <from>
        <query name="20484-main" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="f46_razdel">
            </column>
            <const>'I'</const>
          </call>
          <call function="in">
            <column table="a" column="f46_podrazdel">
            </column>
            <call function="array">
              <const>'В'</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="20484-АБ">
      <parts>
        <part id="20484-cols-vals">
          <usepart part="div1000" as="nachisl">
            <column table="a" column="nachisl" group="sum">
            </column>
          </usepart>
          <usepart part="div1000" as="cust">
            <column table="a" column="cust" group="sum">
            </column>
          </usepart>
        </part>
        <part id="div1000">
          <params>
            <param name="col" />
          </params>
          <call function="round">
            <call function="/">
              <useparam name="col" />
              <const>1000</const>
            </call>
            <const>0</const>
          </call>
        </part>
      </parts>
      <select>
        <usepart part="add-cols-add-group">
          <columns>
            <usepart part="20484-cols" />
          </columns>
          <query>a</query>
        </usepart>
        <column table="a" column="edizm_name" group="1">
        </column>
        <column table="a" column="tip_tar" group="1">
        </column>
        <column table="a" column="voltage_abbr" group="1">
        </column>
        <usepart part="20484-cols-vals" />
      </select>
      <from>
        <query name="20484-main" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="f46_razdel">
            </column>
            <const>'I'</const>
          </call>
          <call function="in">
            <column table="a" column="f46_podrazdel">
            </column>
            <call function="array">
              <const>'А'</const>
              <const>'Б'</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="20484-main">
      <parts>
        <part id="20484-cols">
          <column table="a" column="f46_razdel">
          </column>
          <column table="a" column="f46_podrazdel">
          </column>
          <column table="a" column="f46_razdel_name">
          </column>
          <column table="a" column="f46_podrazdel_name">
          </column>
          <column table="a" column="f46_npp">
          </column>
          <column table="a" column="f46_name">
          </column>
        </part>
      </parts>
      <select>
        <column table="a" column="kod_f46">
        </column>
        <column table="a" column="kod_ras">
        </column>
        <usepart part="20484-cols" />
        <column table="a" column="nachisl">
        </column>
        <column table="a" column="cust">
        </column>
        <column table="a" column="vid_t">
        </column>
        <column table="a" column="pr_2rate">
        </column>
        <column table="a" column="pr_2rate_name">
        </column>
        <column table="a" column="voltage">
        </column>
        <column table="a" column="voltage_abbr">
        </column>
        <column table="a" column="kodinterval">
        </column>
        <column table="a" column="interval_name">
        </column>
        <column table="a" column="edizm">
        </column>
        <column table="a" column="edizm_name">
        </column>
        <call function="case" as="tip_tar">
          <call function="when">
            <call function="!=">
              <call function="nvl">
                <column table="a" column="kodinterval">
                </column>
                <const>24</const>
              </call>
              <const>24</const>
            </call>
            <const>'Зонный'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pr_2rate">
              </column>
              <const>1</const>
            </call>
            <const>'Трехставочный'</const>
          </call>
          <call function="else">
            <const>'Отноставочный'</const>
          </call>
        </call>
      </select>
      <from>
        <query name="sr_facras" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="ym">
            </column>
            <const>@Период:Период_с</const>
            <const>@Период:Период_по</const>
          </call>
          <call function="in">
            <column table="a" column="edizm">
            </column>
            <call function="array">
              <const>3</const>
              <const>4</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="20484-1">
      <select>
        <column table="a" column="kod_account">
        </column>
        <column table="a" column="nachisl">
        </column>
        <column table="a" column="f46_podrazdel">
        </column>
        <column table="a" column="f46_podrazdel_name">
        </column>
        <column table="a" column="f46_razdel">
        </column>
        <column table="a" column="f46_razdel_name">
        </column>
        <column table="a" column="pr_2rate_name">
        </column>
      </select>
      <from>
        <query name="nr_account" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym">
          </column>
          <const>2013.05</const>
        </call>
      </where>
    </query>
    <query name="20484-1">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="nr_account_obj" as="a" />
      </from>
    </query>
    <query name="21033-title-dog">
      <params>
        <param name="date">
          <call function="date">
            <const>'01.02.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.01</const>
        </param>
        <param name="cond">
          <undefined />
        </param>
      </params>
      <select>
        <const as="id" group="1" type="number">1</const>
        <call function="" as="dat" type="date" title="Дата формирования">
          <useparam name="date" />
        </call>
        <call function="" as="ym" type="number" title="Отчетный период">
          <useparam name="ym" />
        </call>
        <column table="a" column="dep_name" group="stragg_dist">
        </column>
        <column table="a" column="dolg" group="sumnvl">
        </column>
        <column table="a" column="nachisl" group="sumnvl">
        </column>
        <column table="a" column="opl" group="sumnvl">
        </column>
        <column table="a" column="nachisl_god" group="sumnvl">
        </column>
        <column table="a" column="opl_god" group="sumnvl">
        </column>
        <column table="a" column="spis" group="sumnvl">
        </column>
        <column table="a" column="spis_god" group="sumnvl">
        </column>
      </select>
      <from>
        <query name="21033-dog" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <usepart part="1=1" />
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="cond">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
    <query name="21033">
      <params>
        <param name="date">
          <call function="date">
            <const>'01.02.2014'</const>
          </call>
        </param>
      </params>
      <select>
        <column column="rownum" as="rwn" type="number" title="№ пп">
        </column>
        <column table="a" column="kod_sf">
        </column>
        <call function="||" as="inn_kpp">
          <column table="a" column="inn">
          </column>
          <const>' / '</const>
          <column table="a" column="kpp">
          </column>
        </call>
        <column table="a" column="payer_name">
        </column>
        <column table="a" column="dep" />
        <column table="a" column="dep_name">
        </column>
        <column table="a" column="kodp">
        </column>
        <column table="a" column="nump">
        </column>
        <column table="a" column="dog_name">
        </column>
        <column table="a" column="name">
        </column>
        <column table="a" column="nachisl">
        </column>
        <column table="a" column="dat_bzad_nvl">
        </column>
        <column table="a" column="days_dolg">
        </column>
        <column table="a" column="dolg">
        </column>
        <column table="a" column="opl">
        </column>
        <column table="a" column="days_dolg_diap">
        </column>
        <column table="a" column="vid_t_teplo_gr_name">
        </column>
        <column table="a" column="kred_dolg">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_real">
            </column>
            <const>2</const>
          </call>
          <call function="=">
            <column table="a" column="tep_el">
            </column>
            <const>2</const>
          </call>
          <call function="gt=">
            <call function="nvl">
              <column table="a" column="dog_dat_fin">
              </column>
              <useparam name="date">
              </useparam>
            </call>
            <useparam name="date">
            </useparam>
          </call>
          <call function="!=">
            <call function="nvl">
              <column table="a" column="deb_dolg">
              </column>
              <column table="a" column="dolg">
              </column>
            </call>
            <const>0</const>
          </call>
          <call function="!=nvl">
            <column table="a" column="dolg">
            </column>
            <const>0</const>
          </call>
          <!--<call function="ls">
            <column column="rownum"></column>
            <const>10</const>
          </call>-->
          <!--<call function="is not null">
            <column table="a" column="days_dolg_diap"></column>
          </call>-->
        </call>
      </where>
    </query>
    <query name="21033-dog">
      <params>
        <param name="date">
          <call function="date">
            <const>'01.02.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.01</const>
        </param>
        <param name="cond">
          <undefined />
        </param>
      </params>
      <select>
        <column column="rownum" as="rwn" type="number" title="№ пп">
        </column>
        <column table="a" column="*">
        </column>
        <column table="n" column="nachisl">
        </column>
        <column table="o" column="opl">
        </column>
        <column table="ny" column="nachisl" as="nachisl_god">
        </column>
        <column table="oy" column="opl" as="opl_god">
        </column>
        <const as="spis" type="number">null</const>
        <const as="spis_god" type="number">null</const>
      </select>
      <from>
        <query name="21033-dog-dolg" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
        </query>
        <query name="21033-dog-nachisl-ym" as="n" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kodp" />
            <column table="n" column="kodp" />
          </call>
        </query>
        <query name="21033-dog-opl-ym" as="o" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kodp" />
            <column table="o" column="kodp" />
          </call>
        </query>
        <query name="21033-dog-nachisl-year" as="ny" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kodp" />
            <column table="ny" column="kodp" />
          </call>
        </query>
        <query name="21033-dog-opl-year" as="oy" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kodp" />
            <column table="oy" column="kodp" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <usepart part="1=1" />
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="cond">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
    <query name="21033-dog-dolg">
      <params>
        <param name="date">
          <call function="date">
            <const>'04.03.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.02</const>
        </param>
      </params>
      <select>
        <column table="a" column="dep_name" group="max">
        </column>
        <column table="a" column="dep" group="max">
        </column>
        <column table="a" column="kodp" group="1">
        </column>
        <column table="a" column="nump" group="max">
        </column>
        <column table="a" column="inn_kpp" group="max">
        </column>
        <column table="a" column="payer_name" group="max">
        </column>
        <column table="a" column="dolg" group="sum">
        </column>
      </select>
      <from>
        <query name="21033" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
    </query>
    <query name="21033-dog-nachisl-ym">
      <params>
        <param name="date">
          <call function="date">
            <const>'04.03.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.02</const>
        </param>
      </params>
      <select>
        <column table="a" column="kodp" group="1">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_real">
            </column>
            <const>2</const>
          </call>
          <call function="between">
            <column table="a" column="dat_bzad_nvl">
            </column>
            <call function="ym begin time">
              <useparam name="ym">
              </useparam>
            </call>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="21033-dog-nachisl-year">
      <params>
        <param name="date">
          <call function="date">
            <const>'04.03.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.02</const>
        </param>
      </params>
      <select>
        <column table="a" column="kodp" group="1">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facvip" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_real">
            </column>
            <const>2</const>
          </call>
          <call function="between">
            <column table="a" column="dat_bzad_nvl">
            </column>
            <call function="year begin time">
              <call function="trunc">
                <useparam name="ym">
                </useparam>
              </call>
            </call>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="21033-dog-opl-ym">
      <params>
        <param name="date">
          <call function="date">
            <const>'04.03.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.02</const>
        </param>
      </params>
      <select>
        <column table="a" column="kodp" group="1">
        </column>
        <column table="a" column="opl" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_real">
            </column>
            <const>2</const>
          </call>
          <call function="ls=">
            <column table="a" column="dat_bzad_nvl">
            </column>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
          <call function="=">
            <column table="a" column="ym">
            </column>
            <useparam name="ym">
            </useparam>
          </call>
        </call>
      </where>
    </query>
    <query name="21033-dog-opl-year">
      <params>
        <param name="date">
          <call function="date">
            <const>'04.03.2014'</const>
          </call>
        </param>
        <param name="ym">
          <const>2014.02</const>
        </param>
      </params>
      <select>
        <column table="a" column="kodp" group="1">
        </column>
        <column table="a" column="opl" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="vid_real">
            </column>
            <const>2</const>
          </call>
          <call function="ls=">
            <column table="a" column="dat_bzad_nvl">
            </column>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
          <call function="=">
            <call function="trunc">
              <column table="a" column="ym">
              </column>
            </call>
            <call function="trunc">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="21033-test">
      <params>
        <param name="date">
          <call function="date">
            <const>'01.03.2014'</const>
          </call>
        </param>
      </params>
      <select>
        <column table="a" column="kod_opl">
        </column>
        <column table="a" column="dolg">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="kodp">
          </column>
          <const>1874</const>
        </call>
      </where>
    </query>
    <query name="21445-2" order="dep_name,vid_t_teplo_name">
      <params>
        <param name="ym">
          <const>2014.01</const>
        </param>
        <param name="cols-for-group">
          <nodes>
            <usepart part="21445-2-cols-for-group" />
          </nodes>
        </param>
      </params>
      <select>
        <column table="a" column="*">
        </column>
        <call function="-nvl" as="dolg_beg" title="Задолженность на начало периода (руб)">
          <column table="s" column="dolg">
          </column>
          <call function="-nvl">
            <column table="n" column="nachisl">
            </column>
            <column table="o" column="opl">
            </column>
          </call>
        </call>
        <call function="-nvl" as="dolg_cust_beg" title="Задолженность на начало периода (квтч)">
          <column table="s" column="dolg_cust">
          </column>
          <call function="-nvl">
            <column table="n" column="cust">
            </column>
            <column table="o" column="cust">
            </column>
          </call>
        </call>
        <column table="n" column="nachisl">
        </column>
        <column table="n" column="cust">
        </column>
        <column table="o" column="opl">
        </column>
        <column table="o" column="cust" as="opl_cust">
        </column>
        <column table="s" column="dolg" title="Задолженность на конец периода (руб)">
        </column>
        <column table="s" column="dolg_cust" title="Задолженность на конец периода (нат. пок.)">
        </column>
      </select>
      <from>
        <query name="21445-2-bb" as="a">
          <withparams>
            <useparam name="cols-for-group" />
          </withparams>
        </query>
        <query name="21445-2-n" as="n" join="left outer">
          <withparams>
            <useparam name="ym">
            </useparam>
            <useparam name="cols-for-group" />
          </withparams>
          <usepart part="add-join">
            <useparam name="cols-for-group" />
            <const>a</const>
            <const>n</const>
          </usepart>
        </query>
        <query name="21445-2-o" as="o" join="left outer">
          <withparams>
            <useparam name="ym">
            </useparam>
            <useparam name="cols-for-group" />
          </withparams>
          <usepart part="add-join">
            <useparam name="cols-for-group" />
            <const>a</const>
            <const>o</const>
          </usepart>
        </query>
        <query name="21445-2-s" as="s" join="left outer">
          <withparams>
            <useparam name="ym">
            </useparam>
            <useparam name="cols-for-group" />
          </withparams>
          <usepart part="add-join">
            <useparam name="cols-for-group" />
            <const>a</const>
            <const>s</const>
          </usepart>
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="a" column="vid_t_teplo_name">
          </column>
        </call>
      </where>
    </query>
    <query name="21445-2-bb">
      <params>
        <param name="cols-for-group">
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <useparam name="cols-for-group" />
          <const>a</const>
        </usepart>
        <column table="a" column="dep_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_gr_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_name" group="max">
        </column>
      </select>
      <from>
        <query name="sr_facras" as="a" />
      </from>
    </query>
    <query name="21445-2-o">
      <params>
        <param name="ym">
        </param>
        <param name="cols-for-group" />
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <useparam name="cols-for-group" />
          <const>a</const>
        </usepart>
        <column table="a" column="opl" group="sum" />
        <column table="a" column="cust" group="sum" />
      </select>
      <from>
        <query name="sr_facopl" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym">
          </column>
          <useparam name="ym" />
        </call>
      </where>
    </query>
    <query name="21445-2-n">
      <params>
        <param name="ym">
        </param>
        <param name="cols-for-group" />
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <useparam name="cols-for-group" />
          <const>a</const>
        </usepart>
        <column table="a" column="nachisl" group="sum" />
        <column table="a" column="cust" group="sum" />
      </select>
      <from>
        <query name="sr_facras" as="a">
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym">
          </column>
          <useparam name="ym">
          </useparam>
        </call>
      </where>
    </query>
    <query name="21445-2-s">
      <params>
        <param name="ym">
        </param>
        <param name="cols-for-group" />
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <useparam name="cols-for-group" />
          <const>a</const>
        </usepart>
        <column table="a" column="dep_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_gr_name" group="max">
        </column>
        <column table="a" column="dolg" group="sum" />
        <column table="a" column="dolg_cust" group="sum" />
      </select>
      <from>
        <query name="sr_facras" as="a">
          <withparams>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="ls=">
          <column table="a" column="ym">
          </column>
          <useparam name="ym" />
        </call>
      </where>
    </query>
    <query name="21445-2-opl">
      <params>
        <param name="ym">
          <const>2013.03</const>
        </param>
        <param name="bankpol">
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <nodes>
            <column table="a" column="kodbpol">
            </column>
            <usepart part="21445-2-cols-for-group">
            </usepart>
          </nodes>
          <const>a</const>
        </usepart>
        <column table="a" column="pol_rs_name" group="max">
        </column>
        <column table="a" column="opl" group="sum" />
        <column table="a" column="cust" group="sum" />
      </select>
      <from>
        <query name="sr_facopl" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <useparam name="ym">
            </useparam>
          </call>
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="bankpol">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
    <query name="21445-2-bb-opl">
      <params>
        <param name="ym">
          <const>2013.03</const>
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <nodes>
            <usepart part="21445-2-cols-for-group">
            </usepart>
            <column table="a" column="pfact_prev">
            </column>
          </nodes>
          <const>a</const>
        </usepart>
        <column table="a" column="dep_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_gr_name" group="max">
        </column>
        <column table="a" column="vid_t_teplo_name" group="max">
        </column>
        <column table="a" column="pfact_prev_name" group="max">
        </column>
        <column table="a" column="opl" group="sum" />
      </select>
      <from>
        <query name="sr_facopl" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym">
          </column>
          <useparam name="ym">
          </useparam>
        </call>
      </where>
    </query>
    <query name="21445-2-opl-full" order="dep_name,vid_t_teplo_name">
      <params>
        <param name="ym">
          <const>2014.01</const>
        </param>
      </params>
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="21445-2-bb-opl" as="a">
          <withparams>
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="a" column="vid_t_teplo_name">
          </column>
        </call>
      </where>
    </query>
    <query name="21445-2-opl-full-nachisl">
      <params>
        <param name="ym">
          <const>2013.03</const>
        </param>
        <param name="bankpol">
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <nodes>
            <column table="a" column="kodbpol">
            </column>
            <usepart part="21445-2-cols-for-group">
            </usepart>
            <column table="a" column="pfact_prev">
            </column>
          </nodes>
          <const>a</const>
        </usepart>
        <column table="a" column="pol_rs_name" group="max">
        </column>
        <column table="a" column="opl" group="sum" />
        <column table="a" column="cust" group="sum" />
      </select>
      <from>
        <query name="sr_facopl" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <useparam name="ym">
            </useparam>
          </call>
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="bankpol">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
    <query name="21445-2-opl-full-kred">
      <params>
        <param name="ym">
          <const>2014.01</const>
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <nodes>
            <column table="a" column="dep">
            </column>
          </nodes>
          <const>a</const>
        </usepart>
        <column table="a" column="dep_name" group="max">
        </column>
        <const as="pfact_prev_name" type="string">'Переплата/Оплата аванса переходящая на следующий месяц'</const>
        <column table="a" column="oplf" group="sum" as="opl" />
      </select>
      <from>
        <query name="sr_opl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="dat_opl">
            </column>
            <call function="ym begin time">
              <useparam name="ym">
              </useparam>
            </call>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
          <call function="=">
            <column table="a" column="ym">
            </column>
            <useparam name="ym">
            </useparam>
          </call>
          <call function="in">
            <column table="a" column="kod_type_opl">
            </column>
            <call function="array">
              <const>1</const>
              <const>2</const>
              <const>5</const>
              <const>6</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="21445-2-opl-full-kred-b">
      <params>
        <param name="ym">
          <const>2014.01</const>
        </param>
      </params>
      <select>
        <usepart part="add-cols-add-group">
          <nodes>
            <column table="a" column="kodbpol">
            </column>
            <column table="a" column="dep">
            </column>
          </nodes>
          <const>a</const>
        </usepart>
        <column table="a" column="pol_rs_name" group="max">
        </column>
        <column table="a" column="oplf" group="sum" as="opl" />
      </select>
      <from>
        <query name="sr_opl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="dat_opl">
            </column>
            <call function="ym begin time">
              <useparam name="ym">
              </useparam>
            </call>
            <call function="ym end time">
              <useparam name="ym">
              </useparam>
            </call>
          </call>
          <call function="=">
            <column table="a" column="ym">
            </column>
            <useparam name="ym">
            </useparam>
          </call>
          <call function="in">
            <column table="a" column="kod_type_opl">
            </column>
            <call function="array">
              <const>1</const>
              <const>2</const>
              <const>5</const>
              <const>6</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="temp-7.1">
      <select>
        <column table="b" column="kod_dog" as="kod_parent">
        </column>
        <column table="a" column="kod_numobj">
        </column>
        <column table="a" column="kod_dog">
        </column>
        <column table="a" column="num_obj">
        </column>
      </select>
      <from>
        <query name="temp-7" as="a" />
        <query name="temp-8" as="b" join="inner">
          <call function="=">
            <column table="a" column="kod_dog">
            </column>
            <column table="b" column="kod_dog">
            </column>
          </call>
        </query>
      </from>
    </query>
    <query name="temp-7">
      <params>
        <param name="dat">
        </param>
      </params>
      <select>
        <column table="a" column="kod_numobj">
        </column>
        <column table="a" column="kod_dog">
        </column>
        <column table="a" column="ndog">
        </column>
        <column table="a" column="num_obj">
        </column>
      </select>
      <from>
        <query name="kr_numobj" as="a" />
      </from>
      <where>
        <call function="gt">
          <column table="a" column="dat_dog">
          </column>
          <useparam name="dat">
          </useparam>
        </call>
      </where>
    </query>
    <query name="temp-8">
      <params>
        <param name="dat">
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog">
        </column>
        <column table="a" column="ndog">
        </column>
        <column table="a" column="dat_dog">
        </column>
      </select>
      <from>
        <query name="kr_dogovor" as="a" />
      </from>
      <where>
        <call function="gt">
          <column table="a" column="dat_dog">
          </column>
          <useparam name="dat">
          </useparam>
        </call>
      </where>
    </query>
    <query name="temp-9">
      <params>
        <param name="dat">
        </param>
      </params>
      <select>
        <column table="a" column="kod_numobj" group="1">
        </column>
        <column table="a" column="vid_t" group="1">
        </column>
        <column table="a" column="vid_t_name" group="max">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
        <column table="a" column="cust" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facras" as="a" />
      </from>
      <where>
        <call function="gt">
          <column table="a" column="dat_sf">
          </column>
          <useparam name="dat">
          </useparam>
        </call>
      </where>
    </query>
    <query name="temp-5">
      <select>
        <column table="a" column="dep_name" group="1" />
        <column table="a" column="opl" group="sum" />
        <column table="a" column="sf_ym" group="1" />
      </select>
      <from>
        <query name="sr_facopl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym" />
            <const>2014.01</const>
          </call>
          <call function="!=">
            <column table="a" column="num_t" />
            <const>70</const>
          </call>
        </call>
      </where>
    </query>
    <query name="temp-6">
      <select>
        <column table="a" column="dep_name" group="1" />
        <column table="a" column="opl" group="sum" />
        <column table="a" column="date_ym" group="1" />
        <column table="a" column="type_opl_name" group="1" />
      </select>
      <from>
        <query name="sr_facopl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym" />
            <const>2014.01</const>
          </call>
          <call function="!=">
            <column table="a" column="num_t" />
            <const>70</const>
          </call>
        </call>
      </where>
    </query>
    <query name="temp-4">
      <select>
        <column table="a" column="ym" group="1" />
        <column table="a" column="dep_name" group="1" />
        <column table="a" column="sf_ym" group="1" />
        <column table="a" column="date_ym" group="1" />
        <column table="a" column="type_opl_name" group="1" />
        <column table="a" column="oplf" group="sum" />
      </select>
      <from>
        <query name="sr_opl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym" />
            <const>2014.01</const>
          </call>
        </call>
      </where>
    </query>
    <query name="temp-3" materialize="1">
      <select>
        <column table="b" column="kodp" />
        <column table="b" column="name" />
        <call function="||" as="fullname">
          <column table="b" column="kodp" />
          <column table="b" column="name" />
        </call>
      </select>
      <from>
        <query name="kr_org" as="b" />
      </from>
    </query>
    <query name="temp-2" materialize="1">
      <select>
        <column table="a" column="kod_dog" group="1" />
        <column table="a" column="dat_dog" group="1" />
        <column table="a" column="kodp" group="1" />
        <column table="a" column="ndog" group="1">
        </column>
        <column table="b" column="name" group="1" />
        <column table="b" column="fullname" group="max" />
      </select>
      <from>
        <query name="kr_dogovor" as="a" />
        <query name="temp-3" as="b" join="left outer">
          <call function="=">
            <column table="a" column="kodp" />
            <column table="b" column="kodp" />
          </call>
        </query>
      </from>
    </query>
    <query name="temp-2.1">
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="temp-2" as="a" />
      </from>
    </query>
    <query name="temp-1">
      <select>
        <column table="a" column="dep_name" group="1" />
        <column table="a" column="tep_el" group="1">
        </column>
        <column table="a" column="vid_t" group="1" />
        <column table="a" column="cust" group="sum" />
      </select>
      <from>
        <query name="sr_facras" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>2014.01</const>
          </call>
          <call function="=">
            <call function="nvl">
              <column table="a" column="rym">
              </column>
              <const>2014.01</const>
            </call>
            <const>2014.01</const>
          </call>
        </call>
      </where>
    </query>
    <query name="21445-opl">
      <params>
        <param name="date1">
          <call function="ym begin time">
            <const>2012.01</const>
          </call>
        </param>
        <param name="date2">
          <call function="ym end time">
            <const>2012.01</const>
          </call>
        </param>
      </params>
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="21445-opl-un" as="a">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="21445-opl-un">
      <params>
        <param name="date1">
        </param>
        <param name="date2">
        </param>
      </params>
      <union>
        <query name="21445-opl-fact">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
          </withparams>
        </query>
        <query name="21445-opl-kred">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
          </withparams>
        </query>
      </union>
    </query>
    <query name="21445-opl-fact">
      <params>
        <param name="date1">
          <call function="ym begin time">
            <const>2012.01</const>
          </call>
        </param>
        <param name="date2">
          <call function="ym end time">
            <const>2012.01</const>
          </call>
        </param>
      </params>
      <select>
        <column table="a" column="dep" group="1" />
        <column table="b" column="id" as="vid_t_teplo" group="1" />
        <column table="a" column="kodbpol" group="1" />
        <column table="a" column="dep_name" group="max" />
        <column table="a" column="pfact_prev" group="1">
        </column>
        <call function="case" as="opl_name" type="string">
          <call function="when">
            <call function="=">
              <column table="a" column="pfact_prev" group="1">
              </column>
              <const>1</const>
            </call>
            <const>'Погашение факта переплатой/авансом прошлого периода'</const>
          </call>
          <call function="else">
            <const>'Оплата текущего периода'</const>
          </call>
        </call>
        <column table="b" column="name" as="vid_t_teplo_name" group="max" />
        <column table="a" column="pol_rs_name" group="max" />
        <column table="a" column="opl" group="sum" />
        <column table="a" column="cust" as="opl_cust" group="sum" />
      </select>
      <from>
        <query name="sr_facopl" as="a" />
        <query name="v_vid_t_teplo" as="b" join="left outer">
          <call function="=">
            <column table="a" column="vid_t_teplo">
            </column>
            <column table="b" column="id">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="dat_oper">
            </column>
            <useparam name="date1" />
            <useparam name="date2" />
          </call>
          <call function="is not null">
            <column table="a" column="vid_t_teplo" />
          </call>
        </call>
      </where>
    </query>
    <query name="21445-opl-kred">
      <params>
        <param name="date1">
        </param>
        <param name="date2">
        </param>
      </params>
      <select>
        <column table="a" column="dep_name" group="1" />
        <const as="opl_name">'Переплата/Оплата аванса переходящая на следующий месяц'</const>
        <const as="vid_t_teplo_name">null</const>
        <column table="a" column="pol_rs_name" group="1" />
        <column table="a" column="oplf" group="sum" as="opl" />
        <const as="opl_cust">null</const>
      </select>
      <from>
        <query name="sr_opl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="dat_opl">
            </column>
            <useparam name="date1" />
            <useparam name="date2" />
          </call>
          <call function="in">
            <column table="a" column="kod_type_opl">
            </column>
            <call function="array">
              <const>1</const>
              <const>2</const>
              <const>5</const>
              <const>6</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="21445">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="21445-un" as="a" />
      </from>
    </query>
    <query name="21445-un">
      <union>
        <query name="21445-dep" />
        <query name="21445-gr" />
        <query name="21445-t" />
      </union>
    </query>
    <query name="21445-dep">
      <select>
        <const as="ord" type="number">1000</const>
        <column table="a" column="dep" group="1">
        </column>
        <const as="npp" type="string">null</const>
        <call function="||" as="name" group="1">
          <const>'Итого: '</const>
          <column table="a" column="dep_name">
          </column>
        </call>
        <usepart part="21445-columns-sum">
        </usepart>
      </select>
      <from>
        <query name="21445-main" as="a" />
      </from>
    </query>
    <query name="21445-gr">
      <select>
        <column table="a" column="gr" as="ord" group="1">
        </column>
        <column table="a" column="dep" group="1">
        </column>
        <column table="a" column="gr" as="npp" group="1">
        </column>
        <column table="a" column="gr_name" as="name" group="max">
        </column>
        <usepart part="21445-columns-sum">
        </usepart>
      </select>
      <from>
        <query name="21445-main" as="a" />
      </from>
    </query>
    <query name="21445-t">
      <select>
        <column table="a" column="vid_t_teplo" as="ord" group="1">
        </column>
        <column table="a" column="dep" group="1">
        </column>
        <const as="npp">null</const>
        <column table="a" column="vid_t_teplo_name" as="name" group="1">
        </column>
        <usepart part="21445-columns-sum">
        </usepart>
      </select>
      <from>
        <query name="21445-main" as="a" />
      </from>
    </query>
    <query name="21445-main">
      <params>
        <param name="ym">
          <const>2013.01</const>
        </param>
      </params>
      <select>
        <column table="a" column="dep">
        </column>
        <column table="a" column="dep_name">
        </column>
        <column table="a" column="vid_t_teplo">
        </column>
        <column table="a" column="vid_t_teplo_name">
        </column>
        <column table="a" column="gr">
        </column>
        <column table="a" column="gr_name">
        </column>
        <usepart part="21445-columns">
        </usepart>
      </select>
      <from>
        <query name="21445-main-1" as="a">
          <withparams>
            <call function="ym begin time">
              <useparam name="ym" />
            </call>
            <call function="ym end time">
              <useparam name="ym" />
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="is not null">
          <column table="a" column="dep_saldo">
          </column>
        </call>
      </where>
    </query>
    <query name="21445-main-1">
      <params>
        <param name="date1">
          <call function="ym begin time">
            <const>2013.12</const>
          </call>
        </param>
        <param name="date2">
          <call function="ym end time">
            <const>2013.12</const>
          </call>
        </param>
        <param name="cols-for-group">
          <group>
            <column column="dep" group="1" />
            <column column="vid_t_teplo" group="1" />
          </group>
        </param>
        <param name="cols-nachisl">
          <group>
          </group>
        </param>
      </params>
      <select>
        <column table="b" column="dep">
        </column>
        <column table="b" column="dep_name">
        </column>
        <column table="b" column="vid_t_teplo">
        </column>
        <column table="b" column="vid_t_teplo_name">
        </column>
        <column table="b" column="gr">
        </column>
        <column table="b" column="gr_name">
        </column>
        <call function="over" as="dep_saldo">
          <call function="sum">
            <column table="a" column="saldo_end">
            </column>
          </call>
          <call function="partition by">
            <column table="b" column="dep">
            </column>
          </call>
        </call>
        <usepart part="21445-columns">
        </usepart>
      </select>
      <from>
        <query as="b">
          <select>
            <column table="a" column="kodp" as="dep">
            </column>
            <column table="a" column="name" as="dep_name">
            </column>
            <column table="b" column="id" as="vid_t_teplo">
            </column>
            <column table="b" column="name" as="vid_t_teplo_name">
            </column>
            <column table="b" column="gr">
            </column>
            <column table="b" column="gr_name">
            </column>
          </select>
          <from>
            <query name="v_vid_t_teplo" as="b">
            </query>
            <query name="kr_org_dep" as="a" join="cross">
            </query>
          </from>
        </query>
        <query name="oborot" as="a" join="left outer">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
            <useparam name="cols-for-group" />
            <useparam name="cols-nachisl" />
          </withparams>
          <call function="and">
            <call function="=">
              <column table="a" column="vid_t_teplo">
              </column>
              <column table="b" column="vid_t_teplo">
              </column>
            </call>
            <call function="=">
              <column table="a" column="dep">
              </column>
              <column table="b" column="dep">
              </column>
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="21445-1 удалить?">
      <params>
        <param name="date1">
          <call function="ym begin time">
            <const>2013.12</const>
          </call>
        </param>
        <param name="date2">
          <call function="ym end time">
            <const>2013.12</const>
          </call>
        </param>
        <param name="cols-for-group">
          <group>
            <column column="dep" group="1" />
            <column column="ndog" group="1" />
            <column column="vid_t" group="1" />
          </group>
        </param>
        <param name="cols-nachisl">
          <group>
          </group>
        </param>
      </params>
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="oborot" as="a">
          <withparams>
            <useparam name="date1" />
            <useparam name="date2" />
            <useparam name="cols-for-group" />
            <useparam name="cols-nachisl" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="22402-n">
      <select>
        <column table="a" column="dep_name" group="1">
        </column>
        <column table="a" column="ndog" group="1">
        </column>
        <column table="a" column="prizn_selo" group="1">
        </column>
        <column table="a" column="vid_real" group="max">
        </column>
        <column table="a" column="num_t" group="1">
        </column>
        <column table="a" column="fk_rym" group="1">
        </column>
        <column table="a" column="into_kniga_name" group="1">
        </column>
        <column table="a" column="def_state_fname" group="1">
        </column>
        <column table="a" column="nachisl" group="sum">
        </column>
        <column table="a" column="nal" group="sum">
        </column>
        <column table="a" column="cust" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facras" as="a">
          <withparams>
            <call function="ym begin time">
              <const>@Период:Период</const>
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>@Период:Период</const>
          </call>
          <call function="!=">
            <column table="a" column="vid_real">
            </column>
            <const>0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="22402-o">
      <select>
        <column table="a" column="dep_name" group="1">
        </column>
        <column table="a" column="ndog" group="1">
        </column>
        <column table="a" column="type_opl_name" group="1">
        </column>
        <column table="a" column="prizn_selo" group="1">
        </column>
        <column table="a" column="vid_real" group="max">
        </column>
        <column table="a" column="num_t" group="1">
        </column>
        <column table="a" column="sf_ym" group="1">
        </column>
        <column table="a" column="fk_rym" group="1">
        </column>
        <column table="a" column="into_kniga_name" group="1">
        </column>
        <column table="a" column="vid_opl_abbr" group="1">
        </column>
        <column table="a" column="opl" group="sum">
        </column>
        <column table="a" column="nal" group="sum">
        </column>
        <column table="a" column="cust" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_facopl" as="a">
          <withparams>
            <call function="ym begin time">
              <const>@Период:Период</const>
            </call>
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>@Период:Период</const>
          </call>
          <call function="!=">
            <column table="a" column="vid_real">
            </column>
            <const>0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="22402-kred">
      <select>
        <column table="a" column="dep_name" group="1">
        </column>
        <column table="a" column="type_opl_name" group="1">
        </column>
        <column table="a" column="fk_rym" group="1">
        </column>
        <column table="a" column="into_kniga_name" group="1">
        </column>
        <column table="a" column="vid_opl_abbr" group="1">
        </column>
        <column table="a" column="oplf" group="sum">
        </column>
        <column table="a" column="nal" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>@Период:Период</const>
          </call>
          <call function="in">
            <column table="a" column="kod_type_opl">
            </column>
            <call function="array">
              <const>1</const>
              <const>2</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="22402-o1">
      <select>
        <!--<column table="a" column="dep_name" group="1"></column>
        <column table="a" column="ndog" group="1"></column>-->
        <column table="a" column="prizn_selo_dog" group="1">
        </column>
        <!--<column table="a" column="prizn_selo" group="1"></column>
        <column table="a" column="vid_real" group="max"></column>
        <column table="a" column="num_t" group="1"></column>
        <column table="a" column="fk_rym" group="1"></column>
        <column table="a" column="into_kniga_name" group="1"></column>
        <column table="a" column="opl" group="sum"></column>-->
        <column table="a" column="opl" group="sum">
        </column>
      </select>
      <from>
        <query name="sr_opl" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>2014.01</const>
          </call>
        </call>
      </where>
    </query>
    <query name="val.1">
      <select>
        <const as="val">1</const>
      </select>
      <from>
        <table name="dual">
        </table>
      </from>
    </query>
    <query name="val.0">
      <select>
        <const as="val">0</const>
      </select>
      <from>
        <table name="dual">
        </table>
      </from>
    </query>
    <query name="vr_0_1">
      <union>
        <query name="val.1">
        </query>
        <query name="val.0">
        </query>
      </union>
    </query>
    <query name="vr_gor_obl">
      <select>
        <column table="c" column="val" as="prizn_selo">
        </column>
        <call function="decode" as="name">
          <column table="c" column="val">
          </column>
          <const>0</const>
          <const>'Г'</const>
          <const>'О'</const>
        </call>
      </select>
      <from>
        <query name="vr_0_1" as="c">
        </query>
      </from>
    </query>
    <query name="46main">
      <select>
        <column table="b" column="kodp" as="podr">
        </column>
        <column table="b" column="sname" as="podr_name">
        </column>
        <column table="a" column="ym">
        </column>
        <column table="c" column="val" as="pr_free">
        </column>
        <column table="f46" column="kod_f46">
        </column>
        <column table="d" column="tarif">
        </column>
        <column table="d" column="tarif_parent">
        </column>
        <column table="d" column="npp" as="tarif_npp">
        </column>
        <column table="go" column="prizn_selo">
        </column>
        <column table="go" column="name" as="prizn_selo_name">
        </column>
        <column table="i" column="kod_ist">
        </column>
        <column table="v" column="voltage">
        </column>
        <column table="v" column="abbr" as="voltage_abbr">
        </column>
      </select>
      <from>
        <query name="kr_calc" as="a">
        </query>
        <query name="kr_org" as="b" join="inner">
          <call function="=">
            <column table="a" column="podr">
            </column>
            <column table="b" column="kodp">
            </column>
          </call>
        </query>
        <query name="vr_0_1" as="c" join="cross">
        </query>
        <query name="ks_tarif" as="d" join="cross">
        </query>
        <query name="hk_voltage+null" as="v" join="cross">
        </query>
        <query name="vr_gor_obl" as="go" join="cross">
        </query>
        <query name="ks_46" as="f46" join="cross">
        </query>
        <query name="ks_istfin" as="i" join="cross">
        </query>
      </from>
    </query>
    <query name="46main1">
      <select>
        <column table="a" column="*">
        </column>
      </select>
      <from>
        <query name="46.nr_account" as="a" params="nr_account[ym],2013.11">
        </query>
      </from>
    </query>
    <query name="46.nr_account">
      <select>
        <column table="b" column="podr">
        </column>
        <column table="b" column="pr_free">
        </column>
        <column table="b" column="kod_f46">
        </column>
        <column table="b" column="kod_ist">
        </column>
        <column table="b" column="tarif_osn" as="tarif">
        </column>
        <column table="b" column="tarif2">
        </column>
        <column table="b" column="tarif16">
        </column>
        <column table="b" column="ym">
        </column>
        <column table="b" column="prizn_selo">
        </column>
        <column table="b" column="voltage">
        </column>
        <column table="b" column="category">
        </column>
        <column table="b" column="kod_dhh">
        </column>
        <column table="b" column="kodinterval">
        </column>
        <column table="b" column="nal_pr_add">
        </column>
        <call function="sum" as="cust">
          <column table="b" column="cust">
          </column>
        </call>
        <call function="sum" as="nachisl">
          <column table="b" column="nachisl">
          </column>
        </call>
      </select>
      <from>
        <query name=":1" as="b" params=":2">
        </query>
      </from>
      <group>
        <column table="b" column="podr">
        </column>
        <column table="b" column="pr_free">
        </column>
        <column table="b" column="kod_f46">
        </column>
        <column table="b" column="kod_ist">
        </column>
        <column table="b" column="tarif_osn">
        </column>
        <column table="b" column="tarif2">
        </column>
        <column table="b" column="tarif16">
        </column>
        <column table="b" column="ym">
        </column>
        <column table="b" column="prizn_selo">
        </column>
        <column table="b" column="voltage">
        </column>
        <column table="b" column="category">
        </column>
        <column table="b" column="kod_dhh">
        </column>
        <column table="b" column="kodinterval">
        </column>
        <column table="b" column="nal_pr_add">
        </column>
      </group>
    </query>
    <query name="test1">
      <select>
        <call function="sum" as="nachisl">
          <column table="a" column="kod_ist">
          </column>
        </call>
      </select>
      <from>
        <query name="46" as="a">
        </query>
      </from>
    </query>
    <query name="46">
      <select>
        <call function="case" as="c1">
          <call function="and">
            <call function="=">
              <column table="a" column="ym">
              </column>
              <const>2013</const>
            </call>
            <call function="=">
              <const>2012</const>
              <const>2013</const>
            </call>
          </call>
          <column table="a" column="kod_ist">
          </column>
          <column table="c" column="cust">
          </column>
        </call>
        <call function="trunc" as="god">
          <column table="a" column="ym">
          </column>
        </call>
        <call function="mes" as="mes">
          <column table="a" column="ym">
          </column>
        </call>
        <column table="o" column="sname" as="podr_name">
        </column>
        <column table="t" column="npp" as="tarif_npp">
        </column>
        <column table="tm" column="npp" as="tarif_parent_npp">
        </column>
        <column table="a" column="pr_free">
        </column>
        <column table="a" column="kod_ist">
        </column>
        <column table="v" column="abbr" as="voltage_abbr">
        </column>
        <column table="b" column="cust" as="cust_3_22">
        </column>
        <column table="b" column="nachisl" as="nachisl_3_22">
        </column>
        <column table="c" column="cust" as="cust_3_72">
        </column>
        <column table="c" column="nachisl" as="nachisl_3_72">
        </column>
        <call function="+nvl" as="cust_3">
          <column table="b" column="cust">
          </column>
          <column table="c" column="cust">
          </column>
        </call>
        <call function="+nvl" as="nachisl_3">
          <column table="b" column="nachisl">
          </column>
          <column table="c" column="nachisl">
          </column>
        </call>
        <column table="d" column="cust" as="cust_4">
        </column>
        <call function="round" as="price_3">
          <call function="/0">
            <column table="d" column="nachisl">
            </column>
            <column table="d" column="cust">
            </column>
          </call>
          <const>5</const>
        </call>
        <column table="d" column="nachisl" as="nachisl_4">
        </column>
        <call function="decode" as="prizn_selo">
          <column table="a" column="prizn_selo">
          </column>
          <const>1</const>
          <const>'О'</const>
          <const>'Г'</const>
        </call>
        <column table="f" column="npp" as="f46">
        </column>
        <call function="||" as="tarif2_name">
          <column table="t2" column="npp">
          </column>
          <const>' '</const>
          <column table="t2" column="name">
          </column>
        </call>
        <column table="a" column="category">
        </column>
        <column table="h" column="name" as="dhh">
        </column>
        <column table="i" column="abbr" as="interval">
        </column>
        <const as="vid_dog">'?'</const>
        <call function="||" as="tarif16_name">
          <column table="t16" column="npp">
          </column>
          <const>' '</const>
          <column table="t16" column="name">
          </column>
        </call>
        <column table="a" column="nal_pr_add">
        </column>
        <const as="ist">'?'</const>
        <const as="seti">'?'</const>
      </select>
      <from>
        <query name="46main1" as="a">
        </query>
        <query name="46.nr_account" as="b" join="left outer" params="nr_account[vid_t],72">
          <usepart part="46join" params="a,b">
          </usepart>
        </query>
        <query name="46.nr_account" as="c" join="left outer" params="nr_account[vid_t],22">
          <usepart part="46join" params="a,c">
          </usepart>
        </query>
        <query name="46.nr_account" as="d" join="left outer" params="nr_account[edizm],4">
          <usepart part="46join" params="a,d">
          </usepart>
        </query>
        <query name="ks_tarif" as="t" join="inner">
          <call function="=">
            <column table="a" column="tarif">
            </column>
            <column table="t" column="tarif">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t2" join="left outer">
          <call function="=nvl">
            <column table="a" column="tarif2">
            </column>
            <column table="t2" column="tarif">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="t16" join="left outer">
          <call function="=nvl">
            <column table="a" column="tarif16">
            </column>
            <column table="t16" column="tarif">
            </column>
          </call>
        </query>
        <query name="kr_org" as="o" join="inner">
          <call function="=">
            <column table="a" column="podr">
            </column>
            <column table="o" column="kodp">
            </column>
          </call>
        </query>
        <query name="ks_tarif" as="tm" join="inner">
          <call function="=">
            <column table="t" column="tarif_parent">
            </column>
            <column table="tm" column="tarif">
            </column>
          </call>
        </query>
        <query name="hk_voltage" as="v" join="left outer">
          <call function="=">
            <column table="a" column="voltage">
            </column>
            <column table="v" column="voltage">
            </column>
          </call>
        </query>
        <query name="hk_dhh" as="h" join="left outer">
          <call function="=">
            <column table="a" column="kod_dhh">
            </column>
            <column table="h" column="kod_dhh">
            </column>
          </call>
        </query>
        <query name="kk_interval" as="i" join="left outer">
          <call function="=">
            <column table="a" column="kodinterval">
            </column>
            <column table="i" column="kodinterval">
            </column>
          </call>
        </query>
        <query name="ks_46" as="f" join="left outer">
          <call function="=">
            <column table="a" column="kod_f46">
            </column>
            <column table="f" column="kod_f46">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym">
            </column>
            <const>2013.11</const>
          </call>
          <call function="or">
            <call function="is not null">
              <column table="b" column="cust">
              </column>
            </call>
            <call function="is not null">
              <column table="c" column="cust">
              </column>
            </call>
            <call function="is not null">
              <column table="d" column="cust">
              </column>
            </call>
          </call>
        </call>
      </where>
    </query>
  </queries>
  <functions>
    <function name="=">
      <par1>
        <val />
      </par1>
      <par2>
        =<val /></par2>
    </function>
    <function name="!=">
      <par1>
        <val />
      </par1>
      <par2>
        !=<val /></par2>
    </function>
    <function name="||" type="string">
      <par1>
        <val />
      </par1>
      <par>
        ||<val /></par>
    </function>
    <function name="=nvl">
      <par1>
        nvl(<val />,0)
      </par1>
      <par2>
        =nvl(<val />,0)
      </par2>
    </function>
    <function name="!=nvl">
      <par1>
        nvl(<val />,0)
      </par1>
      <par2>
        !=nvl(<val />,0)
      </par2>
    </function>
    <function name="+nvl" type="number">
      <par1>
        nvl(<val />,0)
      </par1>
      <par2>
        +nvl(<val />,0)
      </par2>
    </function>
    <function name="/">
      <par1>
        <val />
      </par1>
      <par2>
        /<val /></par2>
    </function>
    <function name="/0">
      <par1>
        <val />
      </par1>
      <par2>
        /nullif(<val />,0)
      </par2>
    </function>
    <function name="ls">
      <par1>
        <val />
      </par1>
      <par2>
        &lt;<val /></par2>
    </function>
    <function name="ls=">
      <par1>
        <val />
      </par1>
      <par2>
        &lt;=<val /></par2>
    </function>
    <function name="gt">
      <par1>
        <val />
      </par1>
      <par2>
        &gt;<val /></par2>
    </function>
    <function name="gt=">
      <par1>
        <val />
      </par1>
      <par2>
        &gt;=<val /></par2>
    </function>
    <function name="not in">
      <par1>
        <val />
      </par1>
      <par2>
        not in<val /></par2>
    </function>
    <function name="not">
      <par1>
        not <val /></par1>
    </function>
    <function name="in">
      <par1>
        <val />
      </par1>
      <par2>
        in<val /></par2>
    </function>
    <function name="and">
      <par1>
        <val />
      </par1>
      <par>
        and <val /></par>
    </function>
    <function name="or">
      <par1>
        <val />
      </par1>
      <par>
        or <val /></par>
    </function>
    <function name="is not null">
      <par1>
        <val />is not null
      </par1>
      <par>
       or <val />is not null
      </par>
    </function>
    <function name="not 0">
      <par1>
        nvl(<val />,0)!=0
      </par1>
      <par>
        or nvl(<val />,0)!=0
      </par>
    </function>
    <function name="is null">
      <par1>
        <val />is  null
      </par1>
      <par>
        and <val />is  null
      </par>
    </function>
    <function name="array">
      <par1>
        <val />
      </par1>
      <par>
        , <val /></par>
    </function>
    <function name="sum" pth="0">
      sum(
      <par1><val /></par1>
      )
    </function>
    <function name="max" pth="0">
      max(
      <par1><val /></par1>
      )
    </function>
    <function name="nvl0">
      nvl(
      <par1><val /></par1>
      ,0)
    </function>
    <function name="round">
      round(
      <par1><val /></par1><par2>
          ,<val /></par2>)
    </function>
    <function name="trunc">
      trunc(
      <par1><val /></par1>)
    </function>
    <function name="mes">
      mod(
      <par1><val /></par1>,
      1)*100
    </function>
    <function name="between">
      <par1>
        <val />
      </par1>
      <par2>
        between <val /></par2>
      <par3>
        and<val /></par3>
    </function>
    <function name="date to char">
      <par1>
        to_char(<val />,'DD.MM.YYYY')
      </par1>
    </function>
    <function name="ym to char" type="string">
      <par1>
        to_char(<val />,'9999.99')
      </par1>
    </function>
    <function name="date to ym">
      <par1>
        to_number(to_char(<val />,'YYYY.MM'))
      </par1>
    </function>
    <function name="ym end time">
      <par1>
         LAST_DAY(to_date(<val />*100,'YYYYMM'))+(1-1/24/60/60) 
      </par1>
    </function>
    <function name="ym begin time">
      <par1>
        (to_date(<val />*100||'01','YYYYMMDD')) 
      </par1>
    </function>
    <function name="year begin time">
      <par1>
        (to_date(<val />||'0101','YYYYMMDD'))
      </par1>
    </function>
    <function name="nvl">
      nvl(
      <par1><val /></par1><par2>
        ,<val /></par2>)
    </function>
    <function name="+" type="number">
      <par1>
        nvl(<val />,0)
      </par1>
      <par2>
        +nvl(<val />,0)
      </par2>
    </function>
    <function name="case">
      case
      <par1><val /></par1>
      end
    </function>
    <function name="when" pth="0">
       when
      <par1><val /></par1><par2>
        then
        <val /></par2></function>
    <function name="else" pth="0">
      <par1>
        else<val /></par1>
    </function>
    <function name="distinct" pth="0">
      <par1>
        distinct <val /></par1>
    </function>
    <function name="-" type="number">
      <par1>
        <val />
      </par1>
      <par2>
        -<val /></par2>
    </function>
    <function name="0-" type="number">
      <par1>
        0-<val /></par1>
    </function>
    <function name="-nvl" type="number">
      <par1>
        nvl(<val />,0)
      </par1>
      <par2>
        -nvl(<val />,0)
      </par2>
    </function>
    <function name="decode">
      decode(
      <par1><val /></par1><par>
        , <val /></par>
      )
    </function>
    <function name="date">
      to_date(
      <par1><val /></par1>,'DD.MM.YYYY MI:SS'
      )
    </function>
    <function name="partition by" pth="0">
      partition by
      <par><val /></par><par>
        ,<val /></par></function>
    <function name="order by" pth="0">
      order by
      <par><val /></par><par>
        ,<val /></par></function>
    <function name="over">
      <par>
        <val />
      </par>
      <par>
        over(<val /></par>
      <par>
        <val />
      </par>
      )
    </function>
    <function name="keep first">
      <par>
        <val />
      </par>
      <par>
        keep(dense_rank first order by <val /></par>
      <par>
        ,<val /></par>
      )
    </function>
    <function name="keep last">
      <par>
        <val />
      </par>
      <par>
        keep(dense_rank last order by <val /></par>
      <par>
        ,<val /></par>
      )
    </function>
    <function name="nativity" pth="0">
      to_date('01.01.0001', 'dd.mm.yyyy')
      <par></par></function>
    <function name="doomsday" pth="0">
      to_date('31.12.9999', 'dd.mm.yyyy')
      <par></par></function>
    <function name="ng_account.f_category_account">
      ng_account.f_category_account(
      <par1><val /></par1>
      )
    </function>
  </functions>
  <parts>
    <part id="nativity">
      <const>'01.01.0001'</const>
    </part>
    <part id="doomsday">
      <const>'31.12.9999'</const>
    </part>
    <part id="1=1">
      <call function="=">
        <const>1</const>
        <const>1</const>
      </call>
    </part>
    <part id="between-nvl">
      <params>
        <param name="val" />
        <param name="left" />
        <param name="right" />
      </params>
      <call function="between">
        <useparam name="val" />
        <call function="nvl">
          <useparam name="left" />
          <useparam name="val" />
        </call>
        <call function="nvl">
          <useparam name="right" />
          <useparam name="val" />
        </call>
      </call>
    </part>
    <part id="columns">
      <params>
        <param name="col" multiple="1" />
        <param name="tbl" />
        <param name="pref" />
      </params>
      <column column=":col" table=":tbl" as=":as" />
      <usepart part="column">
        <useparam name="col" />
        <useparam name="tbl" />
        <group>
          <useparam name="pref" />
          <useparam name="col" />
        </group>
      </usepart>
    </part>
    <part id="column">
      <params>
        <param name="col" />
        <param name="tbl" />
        <param name="as" />
      </params>
      <column column=":col" table=":tbl" as=":as" />
    </part>
    <part id="add-cols-add-group">
      <params>
        <param name="col" multiple="1" />
        <param name="qry-pname" />
      </params>
      <column table=":qry-pname" column=":col.column" group="1" />
    </part>
    <part id="saldo">
      <params>
        <param name="dolg" />
        <param name="nachisl" />
        <param name="opl" />
      </params>
      <call function="+">
        <useparam name="dolg" />
        <call function="-">
          <useparam name="nachisl" />
          <useparam name="opl" />
        </call>
      </call>
    </part>
    <part id="add-cols-with-group">
      <params>
        <param name="col" multiple="1" />
        <param name="qry-pname" />
      </params>
      <column table=":qry-pname" column=":col.column" group=":col.group" />
    </part>
    <part id="add-cols">
      <params>
        <param name="col" multiple="1" />
        <param name="qry-pname" />
      </params>
      <column table=":qry-pname" column=":col.column" />
    </part>
    <part id="add-col-with-pref">
      <params>
        <param name="col" />
        <param name="qry-pname" />
        <param name="as" />
      </params>
      <column column=":col.column" table=":qry-pname" as=":as" />
    </part>
    <part id="add-cols-with-pref">
      <params>
        <param name="col" multiple="1" />
        <param name="qry-pname" />
      </params>
      <usepart part="add-col-with-pref">
        <useparam name="col" />
        <useparam name="qry-pname" />
        <nodes>
          <useparam name="qry-pname" />
          <const>_</const>
          <useparam name="col[@column]" />
        </nodes>
      </usepart>
    </part>
    <part id="add-col-use-pref">
      <params>
        <param name="col" />
        <param name="qry-pname" />
      </params>
      <column column=":col" table=":qry-pname" as=":as" />
    </part>
    <part id="add-cols-use-pref">
      <params>
        <param name="col" multiple="1" />
        <param name="qry-pname" />
        <param name="pref" />
      </params>
      <usepart part="add-col-use-pref">
        <nodes>
          <useparam name="pref" />
          <const>_</const>
          <useparam name="col[@column]" />
        </nodes>
        <useparam name="qry-pname" />
      </usepart>
    </part>
    <part id="add-join">
      <params>
        <param name="cols" />
        <param name="main-qry-pname" />
        <param name="qry-pname" />
      </params>
      <call function="and">
        <usepart part="add-join-1">
          <useparam name="cols" />
          <useparam name="main-qry-pname" />
          <useparam name="qry-pname" />
        </usepart>
      </call>
    </part>
    <part id="add-join-1">
      <params>
        <param name="col" multiple="1" />
        <param name="main-qry-pname" />
        <param name="qry-pname" />
      </params>
      <call function="=">
        <column table=":main-qry-pname" column=":col.column" />
        <column table=":qry-pname" column=":col.column" />
      </call>
    </part>
    <part id="cols-for-group">
      <group>
        <column column="dep" />
        <column column="dep_name" />
        <column column="kod_dog" />
        <column column="kod_sf" />
        <column column="ym" />
      </group>
    </part>
    <part id="ext-cond">
      <params>
        <param name="table-pname">
        </param>
        <param name="cond">
        </param>
      </params>
      <usepart>
        <content>
          <useparam name="cond">
          </useparam>
        </content>
        <useparam name="table-pname">
        </useparam>
      </usepart>
    </part>
    <part id="col-from-dual">
      <params>
        <param name="column" multiple="1" />
      </params>
      <useparam name="column">
      </useparam>
    </part>
    <part id="row-from-dual">
      <params>
        <param name="columns" />
      </params>
      <query>
        <select>
          <usepart part="col-from-dual">
            <useparam name="columns">
            </useparam>
          </usepart>
        </select>
        <from>
          <table name="dual" as="a">
          </table>
        </from>
      </query>
    </part>
    <part id="rows-from-dual">
      <params>
        <param name="row" multiple="1" />
      </params>
      <usepart part="row-from-dual">
        <useparam name="row" />
      </usepart>
    </part>
    <part id="table-from-dual">
      <params>
        <param name="rows" />
      </params>
      <query>
        <union>
          <usepart part="rows-from-dual">
            <useparam name="rows" />
          </usepart>
        </union>
      </query>
    </part>
    <part id="pr_nasel">
      <call function="case">
        <call function="when">
          <call function="in">
            <column table="a" column="vid_t" />
            <call function="array">
              <const>25</const>
              <const>35</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="else">
          <const>0</const>
        </call>
      </call>
    </part>
    <part id="f46_podrazdel">
      <call function="case">
        <call function="when">
          <call function="=">
            <usepart part="pr_nasel" as="pr_nasel" />
            <const>1</const>
          </call>
          <const>'В'</const>
        </call>
        <call function="else">
          <call function="case">
            <call function="when">
              <call function="=">
                <column table="ao" column="pr_usl">
                </column>
                <const>1</const>
              </call>
              <const>'А'</const>
            </call>
            <call function="else">
              <const>'Б'</const>
            </call>
          </call>
        </call>
      </call>
    </part>
    <part id="f46_razdel">
      <call function="case">
        <call function="when">
          <call function="=">
            <column table="ao" column="pr_free">
            </column>
            <const>0</const>
          </call>
          <const>'I'</const>
        </call>
        <call function="else">
          <const>'II'</const>
        </call>
      </call>
    </part>
    <part id="pr_2rate_name">
      <call function="case">
        <call function="when">
          <call function="=">
            <column table="ao" column="pr_2rate">
            </column>
            <const>1</const>
          </call>
          <const>'Двухставочный/Трехставочный'</const>
        </call>
        <call function="else">
          <const>'Одноставочный'</const>
        </call>
      </call>
    </part>
    <part id="gm to ym">
      <params>
        <param name="tbl">
        </param>
      </params>
      <call function="+" as="ym">
        <column table=":tbl" column="god" />
        <call function="/">
          <column table=":tbl" column="mes" />
          <const>100</const>
        </call>
      </call>
    </part>
    <part id="sr_facvip.public">
      <params>
        <param name="tbl" />
        <param name="pref" />
      </params>
      <usepart part="columns">
        <array>
          <const>kod_sf</const>
          <const>vid_real</const>
          <const>ym</const>
        </array>
        <useparam name="tbl" />
        <param name="pref" />
      </usepart>
    </part>
    <part id="20484-cols-vals">
      <usepart part="div1000" as="nachisl">
        <column table="a" column="nachisl" group="sum">
        </column>
      </usepart>
      <usepart part="div1000" as="cust">
        <column table="a" column="cust" group="sum">
        </column>
      </usepart>
    </part>
    <part id="div1000">
      <params>
        <param name="col" />
      </params>
      <call function="round">
        <call function="/">
          <useparam name="col" />
          <const>1000</const>
        </call>
        <const>0</const>
      </call>
    </part>
    <part id="20484-cols">
      <column table="a" column="f46_razdel">
      </column>
      <column table="a" column="f46_podrazdel">
      </column>
      <column table="a" column="f46_razdel_name">
      </column>
      <column table="a" column="f46_podrazdel_name">
      </column>
      <column table="a" column="f46_npp">
      </column>
      <column table="a" column="f46_name">
      </column>
    </part>
    <part id="21445-2-cols-for-group">
      <column table="a" column="dep">
      </column>
      <column table="a" column="vid_t_teplo">
      </column>
    </part>
    <part id="21445-2-cols-for-group-dog">
      <column table="a" column="dep">
      </column>
      <column table="a" column="nump">
      </column>
      <column table="a" column="vid_t_teplo">
      </column>
    </part>
    <part id="21445-columns">
      <column table="a" column="saldo_beg">
      </column>
      <column table="a" column="saldo_beg_cust">
      </column>
      <column table="a" column="nachisl">
      </column>
      <column table="a" column="cust">
      </column>
      <column table="a" column="opl">
      </column>
      <column table="a" column="opl_cust">
      </column>
      <column table="a" column="saldo_end">
      </column>
      <column table="a" column="saldo_end_cust">
      </column>
    </part>
    <part id="21445-columns-sum-1">
      <params>
        <param name="col" multiple="1">
        </param>
      </params>
      <column table=":col.table" column=":col.column" group="sum">
      </column>
    </part>
    <part id="21445-columns-sum">
      <usepart part="21445-columns-sum-1">
        <group>
          <usepart part="21445-columns">
          </usepart>
        </group>
      </usepart>
    </part>
    <part id="46join">
      <call function="and">
        <call function="=">
          <column table=":1" column="ym">
          </column>
          <column table=":2" column="ym">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="pr_free">
          </column>
          <column table=":2" column="pr_free">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="kod_f46">
          </column>
          <column table=":2" column="kod_f46">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="tarif">
          </column>
          <column table=":2" column="tarif">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="podr">
          </column>
          <column table=":2" column="podr">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="kod_ist">
          </column>
          <column table=":2" column="kod_ist">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="prizn_selo">
          </column>
          <column table=":2" column="prizn_selo">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="voltage">
          </column>
          <column table=":2" column="voltage">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="tarif2">
          </column>
          <column table=":2" column="tarif2">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="tarif16">
          </column>
          <column table=":2" column="tarif16">
          </column>
        </call>
        <call function="=">
          <column table=":1" column="category">
          </column>
          <column table=":2" column="category">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="kod_dhh">
          </column>
          <column table=":2" column="kod_dhh">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="kodinterval">
          </column>
          <column table=":2" column="kodinterval">
          </column>
        </call>
        <call function="=nvl">
          <column table=":1" column="nal_pr_add">
          </column>
          <column table=":2" column="nal_pr_add">
          </column>
        </call>
      </call>
    </part>
  </parts>
  <views>
    <view name="t_kr_org_dep">
      SELECT LEVEL lvl, kodp
      FROM kr_org a
      WHERE     kod_ecls = 4
      AND kod_separator &lt;= 2
      AND kodp IN
      (SELECT a.kodp
      FROM kr_org a, kr_org b
      WHERE     a.kod_ecls = 4
      AND kg_common.org_area (a.kodp, b.kodp) = 1
      AND b.kod_ecls = 4
      AND kg_common.user_podr_rights (1, b.kodp)  &gt; 0)
      CONNECT BY PRIOR kodp = kod_parent
      START WITH kod_parent IS NULL AND kod_ecls = 4 AND kod_separator &lt;= 2
      ORDER SIBLINGS BY kg.cut_num (name), name
    </view>
    <view name="n_calc">
      select to_number(to_char(v,'YYYY.MM')) ym from (
      select sysdate+60-level as v from dual connect by level&lt;1000
      ) group  by to_number(to_char(v,'YYYY.MM'))
    </view>
  </views>
  <reports>
    <report name="21033" title="Сомнительная задолженность (Ведомость,Акт)" form="21033">
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="21033-ved.xml" title="Ведомость" />
        </excel>
        <excel>
          <template name="21033-akt.xml" title="Акт" />
        </excel>
      </print-templates>
      <params>
        <param name="date">
        </param>
        <param name="ym">
        </param>
      </params>
      <queries>
        <query name="21033" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
          </withparams>
        </query>
        <query name="21033-title-dog" as="b" union="0">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
          </withparams>
        </query>
      </queries>
    </report>
    <report name="21033-dog" title="Сомнительная задолженность (Справка)" form="21033">
      <columns>
        <column table="a" name="rwn" />
        <column table="a" name="dep_name" />
        <column table="a" name="nump" />
        <column table="a" name="inn_kpp" type="string" title="ИНН/КПП контрагента" />
        <column table="a" name="payer_name" title="Наименование контрагента" />
        <column table="a" name="dolg" title="Сумма, включаемая в Резерв" />
        <band title="Изменение величины резерва по сомнительным долгам в целях бухгалтерсокго учета">
          <band title="Отчисления в резерв">
            <column table="a" name="nachisl" title="за отчетный месяц" />
            <column table="a" name="nachisl_god" title="с начала года" />
          </band>
          <band title="Погашение, восстановление резерва">
            <column table="a" name="opl" title="за отчетный месяц" />
            <column table="a" name="opl_god" title="с начала года" />
          </band>
          <band title="Списание за счет резерва">
            <column table="a" name="spis" title="за отчетный месяц" />
            <column table="a" name="spis_god" title="с начала года" />
          </band>
        </band>
      </columns>
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="21033-spravka.xml" title="Справка" />
        </excel>
      </print-templates>
      <params>
        <param name="date">
        </param>
        <param name="ym">
        </param>
        <param name="dep">
        </param>
      </params>
      <queries>
        <query name="21033-dog" as="a">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
            <part>
              <useparam name="dep">
              </useparam>
            </part>
          </withparams>
        </query>
        <query name="21033-title-dog" as="b" union="0">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="ym">
            </useparam>
            <part>
              <useparam name="dep">
              </useparam>
            </part>
          </withparams>
        </query>
      </queries>
    </report>
    <report name="21445-2" title="Оборотная ведомость по видам товара" form="21445">
      <customers>
        <customer id="101" />
      </customers>
      <params>
        <param name="ym">
        </param>
        <param name="bankpol">
        </param>
      </params>
      <columns>
        <column table="a" name="dep_name" />
        <column table="a" name="vid_t_teplo_gr_name" />
        <column table="a" name="vid_t_teplo_name" />
        <band title="Задолженность на начало периода">
          <column table="a" name="dolg_beg" title="Сумма" />
          <column table="a" name="dolg_cust_beg" title="Количество" />
        </band>
        <band title="Начислено">
          <column table="a" name="nachisl" title="Сумма" />
          <column table="a" name="cust" title="Количество" />
        </band>
        <band title="Оплачено">
          <band table="b" column="opl" title="Сумма">
            <column table="a" name="opl" title="Всего" />
          </band>
          <band table="b" column="cust" title="Количество">
            <column table="a" name="opl_cust" title="Всего" />
          </band>
        </band>
        <band title="Задолженность на конец периода">
          <column table="a" name="dolg" title="Сумма" />
          <column table="a" name="dolg_cust" title="Количество" />
        </band>
      </columns>
      <queries>
        <query name="21445-2" as="a">
          <withparams>
            <useparam name="ym">
            </useparam>
          </withparams>
          <query name="21445-2-opl" as="b">
            <withparams>
              <useparam name="ym">
              </useparam>
              <part>
                <call function="and">
                  <usepart part="1=1" />
                  <useparam name="bankpol">
                  </useparam>
                </call>
              </part>
            </withparams>
            <call function="and">
              <call function="=">
                <column table="a" column="dep">
                </column>
                <column table="b" column="dep">
                </column>
              </call>
              <call function="=">
                <column table="a" column="vid_t_teplo">
                </column>
                <column table="b" column="vid_t_teplo">
                </column>
              </call>
            </call>
            <transpose>
              <dimension>
                <column column="kodbpol" title="pol_rs_name">
                </column>
              </dimension>
              <values>
                <column column="opl">
                </column>
                <column column="cust">
                </column>
              </values>
            </transpose>
          </query>
        </query>
      </queries>
    </report>
    <report name="21445-2-dog" title="Оборотная ведомость по видам товара (детализация по договорам)" form="21445-dog">
      <customers>
        <customer id="101" />
      </customers>
      <params>
        <param name="ym">
        </param>
      </params>
      <columns>
        <column table="a" name="dep_name" />
        <column table="a" name="nump" />
        <column table="a" name="vid_t_teplo_gr_name" />
        <column table="a" name="vid_t_teplo_name" />
        <band title="Задолженность на начало периода">
          <column table="a" name="dolg_beg" title="Сумма" />
          <column table="a" name="dolg_cust_beg" title="Количество" />
        </band>
        <band title="Начислено">
          <column table="a" name="nachisl" title="Сумма" />
          <column table="a" name="cust" title="Количество" />
        </band>
        <band title="Оплачено">
          <column table="a" name="opl" title="Сумма" />
          <column table="a" name="opl_cust" title="Количество" />
        </band>
        <band title="Задолженность на конец периода">
          <column table="a" name="dolg" title="Сумма" />
          <column table="a" name="dolg_cust" title="Количество" />
        </band>
      </columns>
      <queries>
        <query name="21445-2" as="a">
          <withparams>
            <useparam name="ym">
            </useparam>
            <nodes>
              <usepart part="21445-2-cols-for-group-dog" />
            </nodes>
          </withparams>
        </query>
      </queries>
    </report>
    <report name="21445-2-opl" title="Оплата по видам товара" form="21445">
      <customers>
        <customer id="101" />
      </customers>
      <params>
        <param name="ym">
        </param>
        <param name="bankpol">
        </param>
      </params>
      <columns>
        <column table="a" name="dep_name" />
        <column table="a" name="pfact_prev_name" title="Тип оплаты">
        </column>
        <column table="a" name="vid_t_teplo_gr_name" />
        <column table="a" name="vid_t_teplo_name" />
        <band table="b" column="opl" title="Оплачено (руб)">
          <column table="a" name="opl" title="Всего" />
        </band>
      </columns>
      <queries>
        <query name="21445-2-opl-full" as="a">
          <withparams>
            <useparam name="ym">
            </useparam>
          </withparams>
          <query name="21445-2-opl-full-nachisl" as="b">
            <withparams>
              <useparam name="ym">
              </useparam>
              <part>
                <call function="and">
                  <usepart part="1=1" />
                  <useparam name="bankpol">
                  </useparam>
                </call>
              </part>
            </withparams>
            <call function="and">
              <call function="=">
                <column table="a" column="dep">
                </column>
                <column table="b" column="dep">
                </column>
              </call>
              <call function="=">
                <column table="a" column="vid_t_teplo">
                </column>
                <column table="b" column="vid_t_teplo">
                </column>
              </call>
              <call function="=">
                <column table="a" column="pfact_prev">
                </column>
                <column table="b" column="pfact_prev">
                </column>
              </call>
            </call>
            <transpose>
              <dimension>
                <column column="kodbpol" title="pol_rs_name">
                </column>
              </dimension>
              <values>
                <column column="opl">
                </column>
                <column column="cust">
                </column>
              </values>
            </transpose>
          </query>
        </query>
        <query name="21445-2-opl-full-kred" as="c" union="1">
          <withparams>
            <useparam name="ym">
            </useparam>
          </withparams>
          <query name="21445-2-opl-full-kred-b" as="d">
            <withparams>
              <useparam name="ym">
              </useparam>
              <part>
                <call function="and">
                  <usepart part="1=1" />
                  <useparam name="bankpol">
                  </useparam>
                </call>
              </part>
            </withparams>
            <call function="and">
              <call function="=">
                <column table="c" column="dep">
                </column>
                <column table="d" column="dep">
                </column>
              </call>
            </call>
            <transpose>
              <dimension>
                <column column="kodbpol" title="pol_rs_name">
                </column>
              </dimension>
              <values>
                <column column="opl">
                </column>
              </values>
            </transpose>
          </query>
        </query>
      </queries>
    </report>
    <report name="21445-2-opl-kred" title="Оплата по видам товара kred" form="21445">
      <params>
        <param name="ym">
        </param>
        <param name="bankpol">
        </param>
      </params>
      <queries>
        <query name="21445-2-opl-full-kred" as="a">
          <withparams>
            <useparam name="ym">
            </useparam>
          </withparams>
          <query name="21445-2-opl-full-kred-b" as="b">
            <withparams>
              <useparam name="ym">
              </useparam>
              <part>
                <call function="and">
                  <usepart part="1=1" />
                  <useparam name="bankpol">
                  </useparam>
                </call>
              </part>
            </withparams>
            <call function="and">
              <call function="=">
                <column table="a" column="dep">
                </column>
                <column table="b" column="dep">
                </column>
              </call>
            </call>
            <transpose>
              <dimension>
                <column column="kodbpol" title="pol_rs_name">
                </column>
              </dimension>
              <values>
                <column column="opl">
                </column>
              </values>
            </transpose>
          </query>
        </query>
      </queries>
    </report>
    <report name="temp-1" title="Тест" form="test-1">
      <params>
        <param name="data">
          <call function="date">
            <const>'01.07.2013'</const>
          </call>
        </param>
      </params>
      <queries>
        <query name="temp-8" as="a">
          <withparams>
            <useparam name="data" />
          </withparams>
          <query name="temp-7" as="b">
            <call function="=">
              <column table="a" column="kod_dog">
              </column>
              <column table="b" column="kod_dog">
              </column>
            </call>
            <query name="temp-9" as="c">
              <withparams>
                <useparam name="data" />
              </withparams>
              <transpose>
                <dimension>
                  <column column="vid_t" title="vid_t_name">
                  </column>
                </dimension>
                <values>
                  <column column="nachisl">
                  </column>
                  <column column="cust">
                  </column>
                </values>
              </transpose>
              <call function="=">
                <column table="b" column="kod_numobj">
                </column>
                <column table="c" column="kod_numobj">
                </column>
              </call>
            </query>
          </query>
        </query>
      </queries>
    </report>
    <report name="temp-2" title="Тест2" form="test-1">
      <params>
        <param name="data">
          <call function="date">
            <const>'01.07.2013'</const>
          </call>
        </param>
      </params>
      <queries>
        <query name="temp-7" as="b">
          <withparams>
            <useparam name="data" />
          </withparams>
          <query name="temp-9" as="c">
            <withparams>
              <useparam name="data" />
            </withparams>
            <transpose>
              <dimension>
                <column column="vid_t" title="vid_t_name">
                </column>
              </dimension>
              <values>
                <column column="nachisl">
                </column>
                <column column="cust">
                </column>
              </values>
            </transpose>
            <call function="=">
              <column table="b" column="kod_numobj">
              </column>
              <column table="c" column="kod_numobj">
              </column>
            </call>
          </query>
        </query>
      </queries>
    </report>
  </reports>
  <forms>
    <form name="21033">
      <content>
        <field name="ym" controlType="UIControlCombo" title="Отчетный период">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="kr_calc_max">
            </query>
          </defaultquery>
        </field>
        <field name="date" controlType="UIControlDate" title="Дата">
          <return>
            <call function="date">
              <fieldvalue />
            </call>
          </return>
        </field>
        <field name="dep" controlType="UIControlList" title="Отделение">
          <properties>
            <property name="MainView.OptionsView.ColumnAutoWidth">true</property>
            <property name="MainView.OptionsView.ShowColumnHeaders">false</property>
          </properties>
          <listquery>
            <query name="kr_org_dep%tbl">
            </query>
          </listquery>
          <return>
            <call function="in">
              <column table="a" column="dep" />
              <call function="array">
                <fieldvalue />
              </call>
            </call>
          </return>
        </field>
      </content>
    </form>
    <form name="21445">
      <content>
        <field name="ym" controlType="UIControlCombo" title="Период">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="kr_calc_max">
            </query>
          </defaultquery>
        </field>
        <field name="bankpol" controlType="UIControlList" title="Счет получателя оплаты">
          <properties>
            <property name="MainView.OptionsView.ShowAutoFilterRow">true</property>
            <property name="MainView.OptionsView.ColumnAutoWidth">true</property>
          </properties>
          <listquery>
            <query name="ks_bankpol%tbl">
            </query>
          </listquery>
          <return>
            <call function="in">
              <column table="a" column="kodbpol" />
              <call function="array">
                <fieldvalue />
              </call>
            </call>
          </return>
        </field>
      </content>
    </form>
    <form name="21445-dog">
      <content>
        <field name="ym" controlType="UIControlCombo" title="Период">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="kr_calc_max">
            </query>
          </defaultquery>
        </field>
      </content>
    </form>
    <form name="test-1">
      <content>
        <field name="ym1" controlType="UIControlCombo" title="Период">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="kr_calc_max">
            </query>
          </defaultquery>
        </field>
      </content>
    </form>
  </forms>
</root>