<root>
  <queries>
    <query name="s_debet">
      <params>
        <param name="date">
        </param>
        <param name="kodp_cond">
        </param>
      </params>
      <select>
        <column table="a" column="kod_deb" type="number">
        </column>
        <column table="a" column="vid_pl" type="number">
        </column>
        <column table="p" column="voda_par">
        </column>
        <column table="spis" column="ym" as="ym_spis" title="Период списания">
        </column>
        <column table="spis" column="dat_ust" as="dat_spis" title="Дата списания">
        </column>
        <column table="fv" column="dolg">
        </column>
        <call function="-nvl" as="dolg_s">
          <column table="fv" column="summa">
          </column>
          <column table="opl" column="oplf">
          </column>
        </call>
        <column table="fv" column="is_osn_real">
        </column>
        <call function="case" as="ym_end_dolg_c" type="date">
          <call function="when">
            <call function="=">
              <column table="fv" column="dolg">
              </column>
              <const>0</const>
            </call>
            <column table="fv" column="ym_opl">
            </column>
          </call>
          <call function="else">
            <const>null</const>
          </call>
        </call>
      </select>
      <from>
        <table name="s_debet" as="a">
        </table>
        <query name="d_payer" as="p" join="left outer">
          <call function="=">
            <column table="a" column="kodp">
            </column>
            <column table="p" column="kodp">
            </column>
          </call>
        </query>
        <query name="s_debet.s_debet_state_sp" as="spis" join="left outer">
          <call function="=">
            <column table="a" column="kod_deb">
            </column>
            <column table="spis" column="kod_deb">
            </column>
          </call>
        </query>
        <query name="s_debet.s_facvip" as="fv" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="kodp_cond">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kod_deb">
            </column>
            <column table="fv" column="kod_deb">
            </column>
          </call>
        </query>
        <query name="s_debet.s_opl" as="opl" join="left outer">
          <withparams>
            <useparam name="date">
            </useparam>
            <useparam name="kodp_cond">
            </useparam>
          </withparams>
          <call function="=">
            <column table="a" column="kod_deb">
            </column>
            <column table="opl" column="kod_deb">
            </column>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <const>1</const>
            <const>1</const>
          </call>
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="kodp_cond">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
  </queries>
</root>