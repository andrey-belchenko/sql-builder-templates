<root>
  <forms>
    <form name="22981">
      <content>
        <field name="ym1" controlType="UICombo" title="Период с">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="n_calc_max">
            </query>
          </defaultquery>
        </field>
        <field name="ym2" controlType="UICombo" title="По">
          <listquery>
            <query name="n_calc_dist">
            </query>
          </listquery>
          <defaultquery>
            <query name="n_calc_max">
            </query>
          </defaultquery>
        </field>
        <field name="vid_real" controlType="UIList" title="Вид реализации">
          <properties>
            <property name="Height">150</property>
            <property name="MainView.OptionsView.ShowColumnHeaders">false</property>
            <property name="MainView.OptionsView.ColumnAutoWidth">true</property>
          </properties>
          <listquery>
            <query name="k_vid_real%sl">
            </query>
          </listquery>
          <return>
            <call function="in">
              <column table=":table-pname" column="vid_real" />
              <fieldvalue />
            </call>
          </return>
        </field>
      </content>
    </form>
  </forms>
  <reports>
    <report name="22981" title="Начисления, детализация" form="22981" folder="nach">
      <customers>
        <customer id="2" />
      </customers>
      <params>
        <param name="ym1"/>
        <param name="ym2"/>
        <param name="vid_real">
        </param>
      </params>
      <queries>
        <query name="22981" as="a">
          <withparams>
            <useparam name="ym1" />
            <useparam name="ym2" />
            <part>
              <params>
                <param name="table-pname">
                </param>
              </params>
              <call function="and">
                <usepart part="1=1" />
                <!-- плохое решение придумать что-нибудь-->
                <useparam name="vid_real" />
              </call>
            </part>
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <queries>
    
    <query name="22981-test">
      <select>
        <column table="a" column="kod_sf">
        </column>
        <column table="a" column="vid_real_pl">
        </column>
      </select>
      <from>
        <query name="s_facvip" as="a">
          
        </query>
      </from>
      <where>
        <call function="and">
          <call function="ls=">
            <column table="a" column="ym">
            </column>
            <const>2013.01</const>
          </call>
          <usepart part="22837-main-cond">
            <const>a</const>
          </usepart>
        </call>
      </where>
    </query>
    
    <query name="22981">
      <params>
        <param name="ym1">
          <const>2014.02</const>
        </param>
        <param name="ym2">
          <const>2014.02</const>
        </param>
        <param name="cond">
          <undefined />
        </param>
      </params>
      <select>
        <column table="a" column="kod_ras">
        </column>
        <column table="a" column="voda_par_name">
        </column>
        <column table="a" column="payer_name">
        </column>
        <column table="a" column="adres">
        </column>
        <column table="a" column="inn"/>
        <column table="a" column="ndog"/>
        <column table="a" column="ktu"/>
        <column table="a" column="kodg"/>
        <column table="a" column="nom_sf">
        </column>
        <column table="a" column="dat_sf">
        </column>
        <column table="a" column="ym_name">
        </column>
        <column table="a" column="rym_name">
        </column>
        <column table="a" column="vid_real_fname">
        </column>
        <column table="a" column="kodp">
        </column>
        <column table="a" column="vid_t_name">
        </column>
        <column table="a" column="edizm_name">
        </column>
        <column table="a" column="cust">
        </column>
        <column table="a" column="price">
        </column>
        <column table="a" column="nachisl"/>
        <column table="a" column="nds">
        </column>
        <column table="a" column="summa">
        </column>
        <column table="a" column="otrasl_fl_fname">
        </column>
        <column table="a" column="otrasl_fname">
        </column>
        <column table="a" column="ar_name">
        </column>
        <column table="a" column="rtc_name">
        </column>
        <column table="a" column="ist_fin_name">
        </column>
        <column table="a" column="station_name">
        </column>
      </select>
      <from>
        <query name="s_facras" as="a">
        </query>
      </from>
      <where>
        <call function="and">
          <call function="between">
            <column table="a" column="ym">
            </column>
            <useparam name="ym1">
            </useparam>
            <useparam name="ym2">
            </useparam>
          </call>
          <usepart part="ext-cond">
            <const>a</const>
            <useparam name="cond">
            </useparam>
          </usepart>
        </call>
      </where>
    </query>
  </queries>
</root>