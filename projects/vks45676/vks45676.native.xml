<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:21:32.4153041+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="45676-p1" timestamp="21.01.2019 01:18:19" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="cond1">
          <column table="ipr_kod_opl_period" column="pr_ofz" />
          <const>1</const>
        </call>
        <call function="()" as="fin_sum_nds_ofz" group="sum">
          <fact column="ipr_fin_fact_sum_nds_npr" condition="cond1" />
        </call>
        <usepart part="45676-range-columns" />
        <call function="and" as="is_sou_tek_do">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Y" />
          </call>
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="and" as="is_sou_tek_ps">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="ge" as="is_sou_tek" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
        <call function="lt" as="is_sou_pr" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
        <call function="()" as="col_i_pr" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_i_tek_do" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_tek_do" />
        </call>
        <call function="()" as="col_i_tek_ps" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_tek_ps" />
        </call>
        <call function="()" as="col_l_2_tek" type="number" group="sum">
          <fact column="isv_ad_everyday_col_l_2" nvl="0" condition="is_sou_tek" />
        </call>
        <call function="()" as="col_l_2_pr" type="number" group="sum">
          <fact column="isv_ad_everyday_col_l_2" nvl="0" condition="is_sou_pr" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
        <column table="ipr_kod_ispolnit_tit" column="name" as="name_podr" />
        <column table="ipr_kod_ispolnit_tit" column="kod_predpr" as="kod_predpr" />
        <column table="ipr_kod_ispolnit_tit" column="fl_branch" />
        <fact column="fin_sum_nds_ofz" group="sum" title="Финансирование тыс. руб. с НДС" mp="-3" />
        <fact column="isv_ad_everyday_col_f" group="sum" as="col_f" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" group="sum" as="col_i" nvl="0" table="evd_cur" />
        <fact column="col_i_pr" group="sum" as="col_i_pr" nvl="0" table="evd_cur" />
        <fact column="col_i_tek_do" group="sum" as="col_i_tek_do" nvl="0" table="evd_cur" />
        <fact column="col_i_tek_ps" group="sum" as="col_i_tek_ps" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" group="sum" as="col_l" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_n" group="sum" as="col_n" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" group="sum" as="col_p" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" group="sum" as="col_p_2" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" group="sum" as="col_l_2" nvl="0" table="evd_cur" />
        <fact column="col_l_2_tek" group="sum" as="col_l_2_tek" nvl="0" table="evd_cur" />
        <fact column="col_l_2_pr" group="sum" as="col_l_2_pr" nvl="0" table="evd_cur" />
        <fact column="col_f_range" group="sum" nvl="0" table="evd" />
        <fact column="col_i_range" group="sum" nvl="0" table="evd" />
        <fact column="col_l_range" group="sum" nvl="0" table="evd" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" />
        <fact column="col_n_range" group="sum" nvl="0" table="evd" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit_tit" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" as="ipr_kod_ispolnit_tit" />
          <where>
            <call function="and">
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
          <dimset as="evd">
            <link name="kod_isv_ad_evd" />
            <link name="id_slice" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <link name="evd_otch_list" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="evd_otch_list" column="val" />
                  <const>1</const>
                </call>
                <call function="in">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice_range1" />
                  <column table="id_slice" column="id_slice" comment="если условие наложить так, то ошибка, только в этом запросе, глюк, разобраться потом" exclude="1" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <link name="kod_isv_ad_evd" />
            <link name="id_slice" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <link name="evd_otch_list" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="evd_otch_list" column="val" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice" />
                  <column table="id_slice" column="id_slice" comment="если условие наложить так, то ошибка, только в этом запросе, глюк, разобраться потом" exclude="1" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit_tit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-p2-cmn" timestamp="21.01.2019 01:19:02" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
        <param name="otch_list" type="array" />
      </params>
      <expressions>
        <usepart part="45676-range-columns" />
        <call function="if" as="col_itog1" type="number" group="sum">
          <call function="in">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <array>
              <const>2</const>
              <const>3</const>
            </array>
          </call>
          <call function="+nvl">
            <fact column="isv_ad_everyday_col_f" />
            <fact column="isv_ad_everyday_col_i" />
            <fact column="isv_ad_everyday_col_l" />
            <fact column="isv_ad_everyday_col_l_2" />
            <fact column="isv_ad_everyday_col_p" />
            <fact column="isv_ad_everyday_col_p_2" />
            <fact column="isv_ad_everyday_col_n" />
          </call>
        </call>
        <call function="if" as="col_itog2" type="number" group="sum">
          <call function="in">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <array>
              <const>3</const>
              <const>4</const>
            </array>
          </call>
          <call function="+nvl">
            <fact column="isv_ad_everyday_col_f" />
            <fact column="isv_ad_everyday_col_i" />
            <fact column="isv_ad_everyday_col_l" />
            <fact column="isv_ad_everyday_col_l_2" />
            <fact column="isv_ad_everyday_col_p" />
            <fact column="isv_ad_everyday_col_p_2" />
            <fact column="isv_ad_everyday_col_n" />
          </call>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <fact column="col_itog1" title="действующие на 01.01.16" group="sum" nvl="0" table="evd_cur" />
        <fact column="col_itog2" title="действующие на 01.01.17" group="sum" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" group="sum" as="col_f" nvl="0" if="pr4" table="evd_cur">
          <if>
            <call function="in">
              <column table="kod_isv_ad_evd" column="otch_list" />
              <array>
                <const>3</const>
                <const>4</const>
              </array>
            </call>
          </if>
        </fact>
        <fact column="col_f_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_i" group="sum" as="col_i" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_i_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_l" group="sum" as="col_l" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_l_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_n" group="sum" as="col_n" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_n_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_p" group="sum" as="col_p" nvl="0" if="pr4" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" group="sum" as="col_p_2" nvl="0" if="pr4" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" group="sum" as="col_l_2" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" if="pr4" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range1" />
                </call>
                <call function="in">
                  <column table="evd_otch_list" column="val" />
                  <useparam name="otch_list" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="in">
                  <column table="evd_otch_list" column="val" />
                  <useparam name="otch_list" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-title" timestamp="27.06.2019 14:50:18" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <select>
        <call function="to_char" as="slice_time" group="max">
          <column table="a" column="dat_copy_time" />
          <const>'HH24:MI DD.MM.YYYY'</const>
        </call>
        <call function="to_char" as="slice_date" group="max">
          <column table="a" column="dat_copy_time" />
          <const>'DD.MM.YYYY'</const>
        </call>
        <call function="to_char" as="sdate_begin" group="max">
          <useparam name="date_from" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_begin_full" group="max">
          <useparam name="date_from" />
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="to_char" as="sdate_end_1w" group="max">
          <call function="date add days">
            <useparam name="date_last_week" />
            <const>-1</const>
          </call>
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_begin_1w" group="max">
          <useparam name="date_last_2week" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_end" group="max">
          <useparam name="date_to" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_end_full" group="max">
          <useparam name="date_to" />
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="to_char" as="sdate_end1" group="max">
          <call function="-">
            <useparam name="date_to" />
            <const>1</const>
          </call>
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_end1_full" group="max">
          <call function="-">
            <useparam name="date_to" />
            <const>1</const>
          </call>
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="||" as="sdate_range" group="max">
          <column table="this" column="sdate_begin" group="no" />
          <const>'-'</const>
          <column table="this" column="sdate_end" group="no" />
        </call>
        <call function="||" as="sdate_range_1w" group="max">
          <column table="this" column="sdate_begin_1w" group="no" />
          <const>'-'</const>
          <column table="this" column="sdate_end_1w" group="no" />
        </call>
        <call as="slice_month_name" function="mes-name" group="max">
          <call function="month">
            <column table="a" column="dat_copy" />
          </call>
        </call>
        <call function="to_char" as="sdate_last_4week" group="max" type="string">
          <useparam name="date_last_4week" />
          <const>'dd.mm'</const>
        </call>
        <call function="||" as="sdate_range_4w" group="max">
          <column table="this" column="sdate_last_4week" group="no" />
          <const>'-'</const>
          <column table="this" column="sdate_end" group="no" />
        </call>
        <call function="()" as="sdate_last_4week" group="max" type="date" exclude="1">
          <useparam name="date_last_4week" />
        </call>
        <call function="to_char" as="date_end_cur_Q" part-id="45676-title_select_from_params" group="max">
          <useparam name="date_end_cur_Q" />
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="()" as="cy" type="number" part-id="45676-title_select_from_params" group="max">
          <useparam name="cur_year" />
        </call>
        <call function="()" as="py" type="number" part-id="45676-title_select_from_params" group="max">
          <useparam name="prev_year" />
        </call>
        <call function="()" as="ppy" type="number" part-id="45676-title_select_from_params" group="max">
          <useparam name="cur_year_minus_2" />
        </call>
        <call function="()" as="pppy" type="number" part-id="45676-title_select_from_params" group="max">
          <useparam name="cur_year_minus_3" />
        </call>
        <call function="()" as="p4y" type="number" part-id="45676-title_select_from_params" group="max">
          <useparam name="cur_year_minus_4" />
        </call>
        <call function="year" as="ny" part-id="45676-title_select_from_params" group="max">
          <useparam name="date_beg_next_Y" />
        </call>
        <call as="nkv" function="||" part-id="45676-title_select_from_params" group="max">
          <call name="kv" function="mes to kv">
            <call function="month">
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <const>' кв. '</const>
          <call name="year" function="year">
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="ckv" function="||" part-id="45676-title_select_from_params" group="max">
          <useparam name="kv" />
          <const>' кв. '</const>
          <useparam name="year" />
        </call>
        <call as="nnkv" function="||" part-id="45676-title_select_from_params" group="max">
          <call function="if">
            <call function="=">
              <call function="month">
                <useparam name="date_beg_cur_Q_pl2" />
              </call>
              <const>1</const>
            </call>
            <const>''</const>
            <call function="||">
              <call name="kv" function="mes to kv">
                <call function="month">
                  <useparam name="date_beg_cur_Q_pl2" />
                </call>
              </call>
              <const>' кв. '</const>
            </call>
          </call>
          <call name="year" function="year">
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call function="to_char" as="end_kv" part-id="45676-title_select_from_params" group="max">
          <useparam name="date_end_cur_Q" />
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=0" exclude="1">
            <column table="a" column="pr_srez" />
          </call>
          <call function="=" comment="От греха подальше" exclude="1">
            <call function="rownum" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-date-from-def" timestamp="14.09.2017 14:39:33" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice_week" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
      </where>
    </query>
    <query name="45676-date-to-def" timestamp="24.04.2017 21:24:41" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>-1</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="45676-p3-old" timestamp="13.04.2018 18:06:11" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <const>2017</const>
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <const>2017</const>
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <const>2017</const>
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" comment="начинка такая же как у all если вносить изменеия сделать через usepart" order="fl_branch, name_podr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p3-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-years-detail1" timestamp="10.04.2017 22:33:30" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <call function="-nvl" type="number" as="prev_end" group="max">
          <call function="year" exclude="1">
            <call function="sysdate" />
          </call>
          <const>2017</const>
          <const>2</const>
        </call>
        <call function="if" as="kod" type="number" group="1" key="1">
          <call function="lt">
            <column table="a" column="year" />
            <column table="this" column="prev_end" group="no" />
          </call>
          <const>0</const>
          <column table="a" column="year" />
        </call>
        <call function="if" type="string" as="name1" group="max">
          <call function="=0">
            <column table="this" column="kod" group="no" />
          </call>
          <call function="||">
            <const>'до '</const>
            <column table="this" column="prev_end" group="no" />
          </call>
          <call function="||">
            <const>'в '</const>
            <column table="a" column="year" />
          </call>
        </call>
      </select>
      <from>
        <query name="spr_time_year" as="a" />
      </from>
      <where exclude="1">
        <call function="le">
          <column table="a" column="year" />
          <call function="year">
            <call function="sysdate" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-p2-1" timestamp="19.07.2017 12:48:15" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="45676-p2-cmn" as="a">
          <withparams>
            <usepart part="45676-withparams" />
            <array>
              <const>2</const>
              <const>3</const>
              <const>4</const>
            </array>
          </withparams>
        </query>
      </from>
    </query>
    <query name="45676-p4-old" timestamp="13.04.2018 18:06:35" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-range-columns" />
        <call function="()" as="col_m2" type="number" group="sum">
          <fact column="isv_ad_everyday_col_o" condition="is_d0" />
        </call>
        <call function="if" as="col_m1" type="number" group="sum" title="Факт за текущий год">
          <call function="or">
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dt_reg" />
                </call>
                <const>2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <const>2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <const>2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
          </call>
          <fact column="isv_ad_evd_count" />
        </call>
        <call function="if" as="col_o_before2015" type="number" group="sum">
          <call function="lt">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <const>2015</const>
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2015" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <const>2015</const>
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2016" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <const>2016</const>
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2017" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <const>2017</const>
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2018" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <const>2018</const>
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <column table="kod_isv_ad_evd" column="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_f_range" as="col_f_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_i_range" as="col_i_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_range" as="col_l_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_n" as="col_n" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" as="col_p_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_o" as="col_o" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_m1" group="sum" as="col_m1" nvl="0" table="evd_cur" />
        <fact column="col_m2" group="sum" as="col_m2" nvl="0" table="evd" />
        <fact column="col_o_before2015" group="sum" as="col_before2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2015" group="sum" as="col_y2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2016" group="sum" as="col_y2016" nvl="0" table="evd_cur" />
        <fact column="col_o_y2017" group="sum" as="col_y2017" nvl="0" table="evd_cur" />
        <fact column="col_o_y2018" group="sum" as="col_y2018" nvl="0" table="evd_cur" />
        <fact column="col_n_range" group="sum" as="col_n_range" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" />
        <fact column="col_p_range" group="sum" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_o" as="col_o_week" nvl="0" group="sum" table="evd_week" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_dt_contract" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_hoz_sposob" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_week">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" order="fl_branch, name_podr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p4-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105-old" timestamp="13.04.2018 18:07:47" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_1" dontpushpred="1" exclude="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <call function="+nvl">
              <const>2017</const>
              <const>1</const>
            </call>
          </call>
          <call function="lt">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2018</const>
          </call>
          <call function="ge">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="ge" as="is_sou_nxt2" dontpushpred="1">
          <call function="year">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <const>2019</const>
        </call>
        <call function="le" as="is_sou_cur" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <const>date'2018-03-31'</const>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1" type="number" group="sum" exclude="1">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <const>date'2018-03-31'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-03-31'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>4</const>
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-03-31'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2019</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>2019</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <const>date'2019-01-01'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>4</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="or" exclude="1">
            <call function="=">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="le">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>2017</const>
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>4</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <const>4</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>4</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <const>4</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_1" nvl="0" group="sum" table="evd_cur" exclude="1" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <const name="date_end_year">date'2018-03-31'</const>
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <const name="date_end_year">date'2018-12-31'</const>
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="if" as="wait_end" type="number">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_1" group="sum" table="evd" nvl="0" exclude="1" />
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, name_podr">
            <where>
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="=1">
                <column table="this" column="pr_exist_pd_nh" />
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where>
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="=1">
                <column table="this" column="pr_hoz_sposob" />
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where>
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-date-yest-def" timestamp="08.08.2017 21:42:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>-1</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="45676-date-last-week-def" timestamp="14.09.2017 14:40:54" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice_week" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
      </where>
    </query>
    <query name="45676-date-last-2week-def" timestamp="14.09.2017 14:41:46" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice_2week" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
      </where>
    </query>
    <query name="45676-date-end-kv-def" timestamp="09.08.2017 15:16:22" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="ym2 end time" as="val" exclude="1">
          <call function="num to ym2">
            <call function="year">
              <column table="a" column="dat_copy" />
            </call>
            <call function="kv end mes">
              <call function="date to kv" type="date">
                <column table="a" column="dat_copy" />
              </call>
            </call>
          </call>
        </call>
        <const type="date" as="val">DATE'2017-11-01'</const>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="45676-date-end-year-def" timestamp="08.08.2017 21:37:59" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="year end time" as="val" type="date">
          <call function="year" exclude="1">
            <column table="a" column="dat_copy" />
          </call>
          <const>2017</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="45676-id_slice_range2" class="1" timestamp="11.09.2017 20:49:29" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="id_slice_week" type="number" />
        <param name="id_slice_2week" type="number" />
        <param name="id_slice_3week" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" />
        <column table="a" column="name" title="" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2week" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_3week" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-id_slice_3week" class="1" timestamp="14.09.2017 14:52:01" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_otch" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <call function="date add days">
              <useparam name="date_otch" />
              <const>-21</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45676-id_slice_cur" class="1" timestamp="28.08.2017 19:21:04" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <call function="trunc">
              <call function="sysdate" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45676-id_slice_range1" class="1" timestamp="11.09.2017 17:08:26" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="id_slice_week" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" />
        <column table="a" column="name" title="" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-detail" timestamp="29.09.2020 16:02:40" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <expressions>
        <call function="=" as="is_slice_cur" dontpushpred="1" part-id="45676-detail-status-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_slice_week" dontpushpred="1" part-id="45676-detail-status-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="()" as="status_vks_name_cur" type="string" group="max" part-id="45676-detail-status-expr">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_cur" />
        </call>
        <call function="()" as="status_vks_name_week" type="string" group="max" part-id="45676-detail-status-expr">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_week" />
        </call>
        <call group="max" type="string" as="status_vks_name_cur_x" function="over" part-id="45676-detail-status-expr">
          <call function="max">
            <fact column="status_vks_name_cur" />
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call group="max" type="string" as="status_vks_name_week_x" function="over" part-id="45676-detail-status-expr">
          <call function="max">
            <fact column="status_vks_name_week" />
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" part-id="45676-detail-links" />
          <link name="ipr_kod_ispolnit_tit" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" part-id="45676-detail-links" />
          <link name="kod_isv_ad_evd" part-id="45676-detail-links">
            <link name="kod_dt_cont_grp1" />
            <link name="status" />
            <link name="is_ad_all" />
          </link>
          <link name="evd_dt_contract" part-id="45676-detail-links" />
          <link name="evd_otch_list_3" part-id="45676-detail-links" />
          <link name="evd_otch_list" part-id="45676-detail-links" />
          <link name="evd_fl_build_real" part-id="45676-detail-links" />
          <link name="evd_pr_ofz_vkl" part-id="45676-detail-links" />
          <link name="evd_podr_name_titul" part-id="45676-detail-links" />
          <link name="id_slice" part-id="45676-detail-links" />
          <link name="evd_pr_hoz_sposob" part-id="45676-detail-links" />
          <link name="evd_pr_exist_pd" part-id="45676-detail-links" />
          <link name="evd_kodres" part-id="45676-detail-links" />
          <link name="evd_kod_list7" part-id="45676-detail-links" />
          <link name="kod_org_active" part-id="45676-detail-links" />
          <dimset as="evd_cur" part-id="45676-detail-links" />
          <dimset as="evd" part-id="45676-detail-links" />
          <dimset as="evd_week" part-id="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="45676-id_slice_week" class="1" timestamp="14.09.2017 14:50:01" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_otch" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <call function="date add days">
              <useparam name="date_otch" />
              <const>-7</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45676-detail-d1" timestamp="06.03.2018 17:46:49" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
        <usepart part="45676-range-columns" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" format="N0" halign="center">
          <call function="!=0">
            <call as="[column]" function="()" />
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call as="[column]" function="()" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="45676-detail-d2" timestamp="06.03.2018 17:46:51" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" format="N2">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="45676-detail-d3" timestamp="29.10.2018 19:46:16" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" halign="center" format="N0">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice_3week" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="45676-date-last-3week-def" timestamp="14.09.2017 14:43:17" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice_3week" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
      </where>
    </query>
    <query name="45676-id_slice_2week" class="1" timestamp="14.09.2017 14:50:54" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_otch" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <call function="date add days">
              <useparam name="date_otch" />
              <const>-14</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45676-id_slice_range3" class="1" timestamp="11.09.2017 16:26:19" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="id_slice_week" type="number" />
        <param name="id_slice_2week" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" />
        <column table="a" column="name" title="" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2week" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-date-otch-def" timestamp="14.09.2017 14:48:09" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
    </query>
    <query name="45676-43841-old" timestamp="13.04.2018 18:08:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_d0" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" as="kod_direct" />
        <column table="evd_kodres" column="kod_direct" as="kodres" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <column table="ipr_kod_ispolnit" column="name_kr" group="max" as="name_dep" title="Филиал" />
        <column table="evd_kodres" column="name" group="max" as="name_res" title="РЭС" />
        <fact column="isv_ad_everyday_col_plan" as="col_1" nvl="0" group="sum" table="evd_cur" title="Дей на 01.01.XXXX и закл в XXXX" />
        <fact column="isv_ad_everyday_col_f" as="col_3" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Выполнено" />
        <fact column="isv_ad_everyday_col_l" as="col_4" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Расторгнуто" />
        <fact column="isv_ad_everyday_col_i" as="col_6" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Закл ДС о готовн" />
        <fact column="isv_ad_everyday_col_l_2" as="col_7" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Прет-иск работа" />
        <fact column="isv_ad_everyday_col_p" as="col_8" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Направ увед о готовн" />
        <fact column="ostatok_posle2019" as="col_10" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2019+" />
        <fact column="ostatok_do2019" as="col_11" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2018-" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -2" comment="имя должно быть такое чтобы работала детализация" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -1" comment="имя должно быть такое чтобы работала детализация" />
      </select>
      <from>
        <qube single-way="1">
          <link name="kod_isv_ad_evd" />
          <link name="ipr_kod_ispolnit" />
          <link name="id_slice" />
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_kodres" />
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="ЛЭ">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
          <grset as="dep" title="По филиалам" order="decode(kod_direct,19,1,21,2,20,3,26,4,24,5,22,6,27,7,8), name_dep">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
            <usepart part="45676-p4-grsets">
              <const>'dep_'</const>
            </usepart>
            <grset as="res" title="По РЭС" order="name_res">
              <group>
                <sourcelink table="evd_kodres" />
              </group>
              <where>
                <call function="!=" comment="исключаем детализацию для КС">
                  <column table="this" column="kod_direct" />
                  <const>19</const>
                </call>
              </where>
              <usepart part="45676-p4-grsets">
                <const>'res_'</const>
              </usepart>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44502" timestamp="21.01.2019 01:22:39" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="evd_fl_build" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="year" as="year_otch" group="max" exclude="1">
          <useparam name="date_otch" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <column table="this" column="year_otch" group="no" exclude="1" />
          <useparam name="prev_year" />
          <const exclude="1">2017</const>
          <column table="this" column="year_zakl" group="no" />
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_kod_list7" column="val" as="kod_list7" />
        <column table="kod_isv_ad_evd" column="list7_name1" title="ДЗО" group="max" />
        <column table="kod_isv_ad_evd" column="list7_name2" title="БП" group="max" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
      </select>
      <from>
        <qube single-way="1">
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
            <link name="kod_dt_cont_grp2" exclude="1" />
            <link name="kod_dt_cont_grp3" exclude="1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <link name="evd_kod_list7" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="is not null">
                  <column table="evd_kod_list7" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="is not null">
                  <column table="evd_kod_list7" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" order="kod_list7">
          <group>
            <sourcelink table="evd_kod_list7" />
          </group>
          <grset as="all_do">
            <where>
              <call function="and">
                <call function="lt">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                  <const exclude="1">2017</const>
                  <call function="year" exclude="1">
                    <useparam name="date_otch" />
                  </call>
                </call>
              </call>
            </where>
            <grset as="do_no_rab">
              <where>
                <call function="=0">
                  <column table="this" column="fl_build" />
                </call>
              </where>
              <grset as="do_no_rab_do">
                <where>
                  <call function="lt">
                    <column table="this" column="year_zakl" />
                    <call function="-nvl">
                      <call function="year" exclude="1">
                        <useparam name="date_otch" />
                      </call>
                      <useparam name="prev_year" />
                      <const exclude="1">2017</const>
                      <const>2</const>
                    </call>
                  </call>
                </where>
              </grset>
              <grset as="do_no_rab_pos">
                <where>
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <call function="-nvl">
                      <call function="year" exclude="1">
                        <useparam name="date_otch" />
                      </call>
                      <useparam name="prev_year" />
                      <const exclude="1">2017</const>
                      <const>2</const>
                    </call>
                  </call>
                </where>
              </grset>
            </grset>
            <grset as="do_rab">
              <where>
                <call function="=1">
                  <column table="this" column="fl_build" />
                </call>
              </where>
              <grset as="do_rab_ygr3">
                <where>
                  <call function="gt">
                    <column table="this" column="dyear" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset as="do_rab_ygr2">
                <where>
                  <call function="=">
                    <column table="this" column="dyear" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset as="do_rab_ygr1">
                <where>
                  <call function="=">
                    <column table="this" column="dyear" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
            </grset>
          </grset>
          <grset as="all_tek">
            <where>
              <call function="and">
                <call function="ge">
                  <column table="this" column="year_zakl" />
                  <call function="year" exclude="1">
                    <useparam name="date_otch" />
                  </call>
                  <useparam name="prev_year" />
                  <const exclude="1">2017</const>
                </call>
              </call>
            </where>
            <grset as="tek_no_rab">
              <where>
                <call function="=0">
                  <column table="this" column="fl_build" />
                </call>
              </where>
            </grset>
            <grset as="tek_rab">
              <where>
                <call function="=1">
                  <column table="this" column="fl_build" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-old" timestamp="13.04.2018 18:08:15" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="and" as="is_new" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="if" as="col_f_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_f" />
        </call>
        <call function="if" as="col_f_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_f" />
        </call>
        <call function="and" as="col_f_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_i" />
        </call>
        <call function="and" as="col_f_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_l2" />
        </call>
        <call function="and" as="col_f_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_l" />
        </call>
        <call function="and" as="col_f_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_p" />
        </call>
        <call function="and" as="col_f_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_srok_before" />
        </call>
        <call function="and" as="col_f_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_srok_after" />
        </call>
        <call function="if" as="col_i_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_i" />
        </call>
        <call function="if" as="col_i_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_i" />
        </call>
        <call function="and" as="col_i_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_f" />
        </call>
        <call function="and" as="col_i_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_l2" />
        </call>
        <call function="and" as="col_i_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_l" />
        </call>
        <call function="and" as="col_i_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_p" />
        </call>
        <call function="and" as="col_i_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_srok_before" />
        </call>
        <call function="and" as="col_i_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_srok_after" />
        </call>
        <call function="if" as="col_l2_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l_2" />
        </call>
        <call function="if" as="col_l2_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l_2" />
        </call>
        <call function="and" as="col_l2_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_f" />
        </call>
        <call function="and" as="col_l2_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_i" />
        </call>
        <call function="and" as="col_l2_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_l" />
        </call>
        <call function="and" as="col_l2_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_p" />
        </call>
        <call function="and" as="col_l2_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_srok_before" />
        </call>
        <call function="and" as="col_l2_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_srok_after" />
        </call>
        <call function="if" as="col_l_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l" />
        </call>
        <call function="if" as="col_l_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l" />
        </call>
        <call function="and" as="col_l_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_f" />
        </call>
        <call function="and" as="col_l_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_i" />
        </call>
        <call function="and" as="col_l_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_l2" />
        </call>
        <call function="and" as="col_l_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_p" />
        </call>
        <call function="and" as="col_l_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_srok_before" />
        </call>
        <call function="and" as="col_l_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_srok_after" />
        </call>
        <call function="if" as="col_p_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_p" />
        </call>
        <call function="if" as="col_p_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_p" />
        </call>
        <call function="and" as="col_p_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_f" />
        </call>
        <call function="and" as="col_p_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_i" />
        </call>
        <call function="and" as="col_p_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_l2" />
        </call>
        <call function="and" as="col_p_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_l" />
        </call>
        <call function="and" as="col_p_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_srok_before" />
        </call>
        <call function="and" as="col_p_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_srok_after" />
        </call>
        <call function="if" as="srok_before_week" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="srok_before_curr" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="and" as="srok_before_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_f" />
        </call>
        <call function="and" as="srok_before_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_i" />
        </call>
        <call function="and" as="srok_before_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_l2" />
        </call>
        <call function="and" as="srok_before_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_l" />
        </call>
        <call function="and" as="srok_before_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_p" />
        </call>
        <call function="and" as="srok_before_2srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2srok_after" />
        </call>
        <call function="if" as="srok_after_week" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="srok_after_curr" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="and" as="srok_after_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_f" />
        </call>
        <call function="and" as="srok_after_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_i" />
        </call>
        <call function="and" as="srok_after_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_l2" />
        </call>
        <call function="and" as="srok_after_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_l" />
        </call>
        <call function="and" as="srok_after_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_p" />
        </call>
        <call function="and" as="srok_after_2srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2srok_before" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call function="if" as="new_srok_before" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
            <call function="is null">
              <call function="over" type="number" title=" ">
                <call function="max">
                  <call function="if">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <const>1</const>
                  </call>
                </call>
                <call function="partition by">
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
              </call>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="new_srok_after" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
            <call function="is null">
              <call function="over" type="number" title=" ">
                <call function="max">
                  <call function="if">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <const>1</const>
                  </call>
                </call>
                <call function="partition by">
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
              </call>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <call function="||" as="list_name">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" as="name_podr" />
        </call>
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" />
        <fact column="col_f_week" as="col_f_week" nvl="0" group="sum" title="АТП на начало периода" />
        <fact column="col_f_curr" as="col_f_curr" nvl="0" group="sum" title="АТП на конец периода" />
        <fact column="col_f_2col_i_cnt" as="col_f_2col_i" nvl="0" group="sum" title="из АТП в Приост" />
        <fact as="col_f_2col_l2" nvl="0" group="sum" column="col_f_2col_l2_cnt" title="из АТП в Претенз" />
        <fact column="col_f_2col_l_cnt" as="col_f_2col_l" nvl="0" group="sum" title="из АТП в Раст" />
        <fact column="col_f_2col_p_cnt" as="col_f_2col_p" nvl="0" group="sum" title="из АТП в РВУН" />
        <fact column="col_f_2srok_before_cnt" as="col_f_2srok_before" nvl="0" group="sum" title="из АТП в Ост до" />
        <fact column="col_f_2srok_after_cnt" as="col_f_2srok_after" nvl="0" group="sum" title="из АТП в Ост после" />
        <fact column="col_i_week" as="col_i_week" nvl="0" group="sum" title="Приостановлен на начало периода" />
        <fact column="col_i_curr" as="col_i_curr" nvl="0" group="sum" title="Приостановлен на конец периода" />
        <fact column="col_i_2col_f_cnt" as="col_i_2col_f" nvl="0" group="sum" />
        <fact as="col_i_2col_l2" nvl="0" group="sum" column="col_i_2col_l2_cnt" />
        <fact column="col_i_2col_l_cnt" as="col_i_2col_l" nvl="0" group="sum" />
        <fact column="col_i_2col_p_cnt" as="col_i_2col_p" nvl="0" group="sum" />
        <fact column="col_i_2srok_before_cnt" as="col_i_2srok_before" nvl="0" group="sum" />
        <fact column="col_i_2srok_after_cnt" as="col_i_2srok_after" nvl="0" group="sum" />
        <fact column="col_l2_week" as="col_l2_week" nvl="0" group="sum" />
        <fact column="col_l2_curr" as="col_l2_curr" nvl="0" group="sum" />
        <fact column="col_l2_2col_f_cnt" as="col_l2_2col_f" nvl="0" group="sum" />
        <fact as="col_l2_2col_i" nvl="0" group="sum" column="col_l2_2col_i_cnt" />
        <fact column="col_l2_2col_l_cnt" as="col_l2_2col_l" nvl="0" group="sum" />
        <fact column="col_l2_2col_p_cnt" as="col_l2_2col_p" nvl="0" group="sum" />
        <fact column="col_l2_2srok_before_cnt" as="col_l2_2srok_before" nvl="0" group="sum" />
        <fact column="col_l2_2srok_after_cnt" as="col_l2_2srok_after" nvl="0" group="sum" />
        <fact column="col_l_week" as="col_l_week" nvl="0" group="sum" />
        <fact column="col_l_curr" as="col_l_curr" nvl="0" group="sum" />
        <fact column="col_l_2col_f_cnt" as="col_l_2col_f" nvl="0" group="sum" />
        <fact as="col_l_2col_i" nvl="0" group="sum" column="col_l_2col_i_cnt" />
        <fact column="col_l_2col_l2_cnt" as="col_l_2col_l2" nvl="0" group="sum" />
        <fact as="col_l_2col_p" nvl="0" group="sum" column="col_l_2col_p_cnt" />
        <fact column="col_l_2srok_before_cnt" as="col_l_2srok_before" nvl="0" group="sum" />
        <fact column="col_l_2srok_after_cnt" as="col_l_2srok_after" nvl="0" group="sum" />
        <fact column="col_p_week" as="col_p_week" nvl="0" group="sum" />
        <fact column="col_p_curr" as="col_p_curr" nvl="0" group="sum" />
        <fact column="col_p_2col_f_cnt" as="col_p_2col_f" nvl="0" group="sum" />
        <fact as="col_p_2col_i" nvl="0" group="sum" column="col_p_2col_i_cnt" />
        <fact column="col_p_2col_l2_cnt" as="col_p_2col_l2" nvl="0" group="sum" />
        <fact column="col_p_2col_l_cnt" as="col_p_2col_l" nvl="0" group="sum" />
        <fact column="col_p_2srok_before_cnt" as="col_p_2srok_before" nvl="0" group="sum" />
        <fact column="col_p_2srok_after_cnt" as="col_p_2srok_after" nvl="0" group="sum" />
        <fact column="srok_before_week" as="srok_before_week" nvl="0" group="sum" />
        <fact column="srok_before_curr" as="srok_before_curr" nvl="0" group="sum" />
        <fact column="srok_before_2col_f_cnt" as="srok_before_2col_f" nvl="0" group="sum" />
        <fact as="srok_before_2col_i" nvl="0" group="sum" column="srok_before_2col_i_cnt" />
        <fact column="srok_before_2col_l2_cnt" as="srok_before_2col_l2" nvl="0" group="sum" />
        <fact column="srok_before_2col_l_cnt" as="srok_before_2col_l" nvl="0" group="sum" />
        <fact column="srok_before_2col_p_cnt" as="srok_before_2col_p" nvl="0" group="sum" />
        <fact column="srok_before_2srok_after_cnt" as="srok_before_2srok_after" nvl="0" group="sum" />
        <fact column="srok_after_week" as="srok_after_week" nvl="0" group="sum" />
        <fact column="srok_after_curr" as="srok_after_curr" nvl="0" group="sum" />
        <fact column="srok_after_2col_f_cnt" as="srok_after_2col_f" nvl="0" group="sum" />
        <fact as="srok_after_2col_i" nvl="0" group="sum" column="srok_after_2col_i_cnt" />
        <fact column="srok_after_2col_l2_cnt" as="srok_after_2col_l2" nvl="0" group="sum" />
        <fact column="srok_after_2col_l_cnt" as="srok_after_2col_l" nvl="0" group="sum" />
        <fact column="srok_after_2col_p_cnt" as="srok_after_2col_p" nvl="0" group="sum" />
        <fact as="srok_after_2srok_before" nvl="0" group="sum" column="srok_after_2srok_before_cnt" />
        <fact column="new_col_f" as="new_col_f" nvl="0" group="sum" />
        <fact as="new_col_i" nvl="0" group="sum" column="new_col_i" />
        <fact column="new_col_l2" as="new_col_l2" nvl="0" group="sum" />
        <fact column="new_col_l" as="new_col_l" nvl="0" group="sum" />
        <fact column="new_col_p" as="new_col_p" nvl="0" group="sum" />
        <fact column="new_srok_before" as="new_srok_before" nvl="0" group="sum" />
        <fact column="new_srok_after" as="new_srok_after" nvl="0" group="sum" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <where>
            <call function="and">
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="name_podr">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-date-limit-p8" timestamp="14.02.2018 15:51:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const type="date" as="val">DATE'2018-03-31'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-p3-test" timestamp="16.02.2018 16:22:51" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <const>2017</const>
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <const>2017</const>
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <const>2017</const>
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <const>2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-p3" timestamp="21.01.2019 01:19:40" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <useparam name="prev_year" />
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <useparam name="prev_year" type="number" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <useparam name="prev_year" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <fact as="fl_2018_fact" nvl="0" group="sum" table="evd_cur" column="isv_ad_evd_fl_2018_fact" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" comment="начинка такая же как у all если вносить изменеия сделать через usepart" order="fl_branch, kod_predpr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p3-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105" timestamp="09.10.2020 14:55:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="=1" as="is_mixed" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_mixed" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_mixed" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
          </call>
          <call function="ge" exclude="1">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
          <call function="=">
            <call function="trunc">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_mixed" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_mixed" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_fl_build" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_fb" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_work_pu" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_pu" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_both" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_fb_pu" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_nxt3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_mixed" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_fl_build" type="number" group="sum">
          <fact column="col_no_fact_cur_fl_build" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_work_pu" type="number" group="sum">
          <fact column="col_no_fact_cur_work_pu" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_both" type="number" group="sum">
          <fact column="col_no_fact_cur_both" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_mixed" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=" exclude="1">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
            </call>
            <call function="ge" exclude="1">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
            </call>
            <call function="=">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="lt" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток" exclude="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом" exclude="1">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_fl_build" title="Исполнено за 2018 год ниже 35" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_work_pu" title="Исполнено за 2018 год на ПУ" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_both" title="Исполнено за 2018 год ниже 35 и на ПУ" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_mixed_2018" type="number" function="()">
          <fact column="col_any_fact_mixed" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff">
          <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_fb">
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_pu">
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_both">
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_week" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_fb" as="col_no_fact_fb" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_pu" as="col_no_fact_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_fb_pu" as="col_no_fact_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_fl_build" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_work_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_fl_build" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_work_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" exclude="1" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_fl_build" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_work_pu" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_both" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_mixed_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_fb" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_pu" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_both" group="sum" />
        <call function="+nvl" group="sum" as="col_any_fact_week_diff_fb_both" type="number">
          <fact table="evd" column="col_any_fact_week_diff_fb" />
          <fact table="evd" column="col_any_fact_week_diff_both" />
        </call>
        <column table="is_filial_plan" column="nw_less" group="sum" as="plan_nw_less" />
        <column table="is_filial_plan" column="nw_more" group="sum" as="plan_nw_more" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_mixed" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
        <query name="is_filial_plan" join="left outer">
          <call function="and">
            <call function="ge">
              <call function="nvl">
                <column table="is_filial_plan" column="dat_end" />
                <call function="doomsday" />
              </call>
              <useparam name="date_to" />
            </call>
            <call function="le">
              <column table="is_filial_plan" column="dat_begin" />
              <useparam name="date_from" />
            </call>
            <call function="=">
              <column table="ipr_kod_ispolnit" column="kod_direct" />
              <column table="is_filial_plan" column="kod_direct" />
            </call>
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_fake" />
              <const>1</const>
            </call>
            <call function="is not null">
              <column table="kod_isv_ad_evd" column="kod_filial" />
            </call>
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </query>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-p4" timestamp="21.01.2019 01:20:52" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-range-columns" />
        <call function="()" as="col_m2" type="number" group="sum">
          <fact column="isv_ad_everyday_col_o" condition="is_d0" />
        </call>
        <call function="if" as="col_m1" type="number" group="sum" title="Факт за текущий год" exclude="1">
          <call function="or">
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dt_reg" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
          </call>
          <fact column="isv_ad_evd_count" />
        </call>
        <call function="if" as="col_o_before_p4y" type="number" group="sum">
          <call function="lt">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_4" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_p4y" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_4" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_before2015" type="number" group="sum">
          <call function="lt">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_3" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2015" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_3" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2016" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_2" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2017" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="prev_year" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2018" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <column table="kod_isv_ad_evd" column="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_f_range" as="col_f_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_i_range" as="col_i_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_range" as="col_l_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_n" as="col_n" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" as="col_p_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_o" as="col_o" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_m1" group="sum" as="col_m1" nvl="0" table="evd_cur" exclude="1" />
        <fact column="col_m2" group="sum" as="col_m2" nvl="0" table="evd" />
        <fact column="col_o_before_p4y" group="sum" as="col_before_p4y" nvl="0" table="evd_cur" />
        <fact column="col_o_p4y" group="sum" as="col_p4y" nvl="0" table="evd_cur" />
        <fact column="col_o_before2015" group="sum" as="col_before2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2015" group="sum" as="col_y2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2016" group="sum" as="col_y2016" nvl="0" table="evd_cur" />
        <fact column="col_o_y2017" group="sum" as="col_y2017" nvl="0" table="evd_cur" />
        <fact column="col_o_y2018" group="sum" as="col_y2018" nvl="0" table="evd_cur" />
        <fact column="col_n_range" group="sum" as="col_n_range" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" />
        <fact column="col_p_range" group="sum" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_o" as="col_o_week" nvl="0" group="sum" table="evd_week" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_dt_contract" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_hoz_sposob" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_week">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" order="fl_branch, kod_predpr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p4-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-43841" timestamp="21.01.2019 01:21:59" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_d0" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" as="kod_direct" />
        <column table="evd_kodres" column="kod_direct" as="kodres" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <column table="ipr_kod_ispolnit" column="name_kr" group="max" as="name_dep" title="Филиал" />
        <column table="evd_kodres" column="name" group="max" as="name_res" title="РЭС" />
        <fact column="isv_ad_everyday_col_plan" as="col_1" nvl="0" group="sum" table="evd_cur" title="Дей на 01.01.XXXX и закл в XXXX" />
        <fact column="isv_ad_everyday_col_f" as="col_3" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Выполнено" />
        <fact column="isv_ad_everyday_col_l" as="col_4" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Расторгнуто" />
        <fact column="isv_ad_everyday_col_i" as="col_6" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Закл ДС о готовн" />
        <fact column="isv_ad_everyday_col_l_2" as="col_7" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Прет-иск работа" />
        <fact column="isv_ad_everyday_col_p" as="col_8" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Направ увед о готовн" />
        <fact column="ostatok_posle2019" as="col_10" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2019+" />
        <fact column="ostatok_do2019" as="col_11" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2018-" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -2" comment="имя должно быть такое чтобы работала детализация" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -1" comment="имя должно быть такое чтобы работала детализация" />
      </select>
      <from>
        <qube single-way="1">
          <link name="kod_isv_ad_evd" />
          <link name="ipr_kod_ispolnit" />
          <link name="id_slice" />
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_kodres" />
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="ЛЭ">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
          <grset as="dep" title="По филиалам" order="decode(kod_direct,19,1,21,2,20,3,26,4,24,5,22,6,27,7,8), name_dep">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
            <usepart part="45676-p4-grsets">
              <const>'dep_'</const>
            </usepart>
            <grset as="res" title="По РЭС" order="name_res">
              <group>
                <sourcelink table="evd_kodres" />
              </group>
              <where>
                <call function="!=" comment="исключаем детализацию для КС">
                  <column table="this" column="kod_direct" />
                  <const>19</const>
                </call>
              </where>
              <usepart part="45676-p4-grsets">
                <const>'res_'</const>
              </usepart>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-detail-test" timestamp="16.01.2019 18:20:21" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <expressions>
        <call function="=" as="is_slice_cur" dontpushpred="1" part-id="45676-detail-status-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_slice_week" dontpushpred="1" part-id="45676-detail-status-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="()" as="status_vks_name_cur" type="string" group="max" part-id="45676-detail-status-expr">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_cur" />
        </call>
        <call function="()" as="status_vks_name_week" type="string" group="max" part-id="45676-detail-status-expr">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_week" />
        </call>
        <call group="max" type="string" as="status_vks_name_cur_x" function="over" part-id="45676-detail-status-expr">
          <call function="max">
            <fact column="status_vks_name_cur" />
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call group="max" type="string" as="status_vks_name_week_x" function="over" part-id="45676-detail-status-expr">
          <call function="max">
            <fact column="status_vks_name_week" />
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <column table="kod_isv_ad_evd" column="st_det" as="st" exclude="1" />
        <usepart part="45676-49578-column-Status" />
        <fact column="fl_build_curr" />
        <fact column="fl_build_week" />
        <fact column="col_fact_curr" nvl="0" />
        <fact table="evd" as="evd_cnt" column="isv_ad_evd_count" exclude="1" />
        <column table="evd_fl_build_real" column="val" as="fl_build_real" />
        <fact column="filial_curr" />
        <fact column="filial_week" />
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
          <dimset as="evd2">
            <link name="evd_fl_build_real" exclude="1" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="45676-44864-test" timestamp="21.01.2019 01:23:41" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="is_curr" dontpushpred="1" part-id="45676-44864-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1" part-id="45676-44864-expr">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_rab" dontpushpred="1" part-id="45676-44864-expr">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>1</const>
        </call>
        <call function="=" as="is_norab" dontpushpred="1" part-id="45676-44864-expr">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>0</const>
        </call>
        <call function="and" as="is_new" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_f_curr" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_f" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_i_curr" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_i" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_2_curr" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l_2" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_curr" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_p_curr" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_late" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_n" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost1" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost2" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                    <call function="between" exclude="1">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_next_Q" />
                      <useparam name="date_end_cur_Y" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost3" dontpushpred="1" part-id="45676-44864-expr">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="ge" exclude="1">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_next_Y" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_curr" part-id="45676-44864-expr">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_week" part-id="45676-44864-expr">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="()" as="col_fact_week" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_week" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_fact_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_f_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_col_f_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_i_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_col_i_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_2_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_col_l_2_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_col_l_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_p_curr" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_col_p_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="late" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_late" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost1" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_ost1" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost2" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_ost2" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost3" type="number" group="sum" part-id="45676-44864-expr">
          <fact condition="is_ost3" column="isv_ad_evd_count" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_late" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_everyday_col_n" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_evd_col_no_fact" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost1" function="()" part-id="45676-44864-expr">
          <fact column="new_ost" condition="is_ost1" />
        </call>
        <call group="sum" type="number" as="new_ost2" function="()" part-id="45676-44864-expr">
          <fact column="new_ost" condition="is_ost2" />
        </call>
        <call group="sum" type="number" as="new_ost3" function="()" part-id="45676-44864-expr">
          <fact column="new_ost" condition="is_ost3" />
        </call>
        <call group="sum" type="number" as="new_cnt" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_evd_count" condition="is_new" />
        </call>
        <call group="sum" type="number" as="cur_cnt" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_evd_count" condition="is_curr" />
        </call>
        <call group="sum" type="number" as="cur_cnt_rab" function="()" part-id="45676-44864-expr">
          <fact column="cur_cnt" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="cur_cnt_norab" function="()" part-id="45676-44864-expr">
          <fact column="cur_cnt" condition="is_norab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_rab" function="()" part-id="45676-44864-expr">
          <fact column="col_fact_week" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_norab" function="()" part-id="45676-44864-expr">
          <fact column="col_fact_week" condition="is_norab" />
        </call>
        <call function="and" as="is_not_in_cur" dontpushpred="1" part-id="45676-44864-expr">
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call group="sum" type="number" as="exclude_from_vks" function="()" part-id="45676-44864-expr">
          <fact column="isv_ad_evd_count" condition="is_not_in_cur" />
        </call>
        <call function="over" type="number" title=" " group="max" as="filial_curr" part-id="45676-44864-expr">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="ipr_kod_ispolnit" column="kod_direct">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="filial_week" part-id="45676-44864-expr">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="ipr_kod_ispolnit" column="kod_direct">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" part-id="45676-44864-select" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" part-id="45676-44864-select" />
        <call function="||" as="list_name" part-id="45676-44864-select">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" />
        </call>
        <column table="kod_isv_ad_evd" column="st_det" as="st" group="max" part-id="45676-44864-select" exclude="1" />
        <call as="st" title="Статус" group="max" function="()" part-id="45676-44864-select" type="string">
          <usepart part="45676-49578-column-Status" />
        </call>
        <fact column="col_fact_week" nvl="0" group="sum" title="Кол-во на начало периода" part-id="45676-44864-select" />
        <fact column="col_fact_curr" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="col_f_curr" nvl="0" group="sum" title="в АТП" part-id="45676-44864-select" />
        <fact nvl="0" group="sum" title="в Приост" column="col_i_curr" part-id="45676-44864-select" />
        <fact column="col_l_2_curr" nvl="0" group="sum" title="в Претенз" part-id="45676-44864-select" />
        <fact column="col_l_curr" nvl="0" group="sum" title="в Расторг" part-id="45676-44864-select" />
        <fact column="col_p_curr" nvl="0" group="sum" title="в РВУН" part-id="45676-44864-select" />
        <fact column="late" nvl="0" group="sum" title="в Просроченные" part-id="45676-44864-select" />
        <fact column="ost1" nvl="0" group="sum" title="в Остаток (период1)" part-id="45676-44864-select" />
        <fact column="ost2" nvl="0" group="sum" title="в Остаток (период2)" part-id="45676-44864-select" />
        <fact column="ost3" nvl="0" group="sum" title="в Остаток (период3)" part-id="45676-44864-select" />
        <fact column="new_col_f" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact nvl="0" group="sum" column="new_col_i" part-id="45676-44864-select" />
        <fact column="new_col_l2" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_col_l" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_col_p" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_late" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_ost1" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_ost2" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="new_ost3" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="fl_build_curr" group="max" part-id="45676-44864-select" />
        <fact column="fl_build_week" group="max" part-id="45676-44864-select" />
        <call function="year" as="year_zakl" group="max" part-id="45676-44864-select">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact table="evd2" group="sum" column="cur_cnt" part-id="45676-44864-select" />
        <fact table="evd2" as="week_cnt" group="sum" column="col_fact_week" part-id="45676-44864-select" />
        <fact table="evd2" as="evd_cnt" group="sum" column="isv_ad_evd_count" part-id="45676-44864-select" />
        <fact table="evd2" group="sum" column="cur_cnt_rab" part-id="45676-44864-select" nvl="0" />
        <fact table="evd2" group="sum" column="cur_cnt_norab" part-id="45676-44864-select" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_rab" part-id="45676-44864-select" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_norab" part-id="45676-44864-select" nvl="0" />
        <fact column="new_cnt" nvl="0" group="sum" part-id="45676-44864-select" />
        <column table="evd_fl_build_real" column="val" as="fl_build_real" part-id="45676-44864-select" />
        <call function="if" as="to_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <fact column="exclude_from_vks" nvl="0" group="sum" part-id="45676-44864-select" />
        <fact column="filial_curr" group="max" part-id="45676-44864-select" />
        <fact column="filial_week" group="max" part-id="45676-44864-select" />
        <call function="if" as="to_filial" type="number" group="sum" nvl="0" part-id="45676-44864-select">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_filial_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week_rab" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_filial_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week_norab" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" part-id="45676-44864-qube" />
          <link name="kod_isv_ad_evd" part-id="45676-44864-qube" />
          <link name="evd_otch_list_3" part-id="45676-44864-qube" />
          <link name="evd_dt_contract" part-id="45676-44864-qube" />
          <link name="evd_pr_hoz_sposob" part-id="45676-44864-qube" />
          <link name="evd_pr_exist_pd" part-id="45676-44864-qube" />
          <link name="id_slice" part-id="45676-44864-qube" />
          <where part-id="45676-44864-qube">
            <call function="and">
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </call>
          </where>
          <dimset as="evd2" part-id="45676-44864-qube">
            <link name="evd_fl_build_real" />
            <where exclude="1">
              <call function="=">
                <const>1</const>
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset title="с работами" as="rab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'rab_'</const>
          </usepart>
        </grset>
        <grset title="без работ" as="norab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'norab_'</const>
          </usepart>
        </grset>
        <grset title="новые с работами" as="rab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="новые без работ" as="norab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из безработных" as="from_norab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из работных" as="from_rab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset as="by_dep" title="По филиалам" order="name_podr" exclude="1">
          <usepart part="45676-44864-grsets">
            <const>'dep_'</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="dep_rab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="evd_cnt" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="dep_norab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="dep_rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="dep_norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="dep_from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="dep_from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864" timestamp="04.06.2018 15:20:39" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="and" as="is_new" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="if" as="col_f_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_f" />
        </call>
        <call function="if" as="col_f_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_f" />
        </call>
        <call function="and" as="col_f_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_i" />
        </call>
        <call function="and" as="col_f_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_l2" />
        </call>
        <call function="and" as="col_f_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_l" />
        </call>
        <call function="and" as="col_f_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_2col_p" />
        </call>
        <call function="and" as="col_f_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_srok_before" />
        </call>
        <call function="and" as="col_f_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_f_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_f_srok_after" />
        </call>
        <call function="if" as="col_i_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_i" />
        </call>
        <call function="if" as="col_i_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_i" />
        </call>
        <call function="and" as="col_i_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_f" />
        </call>
        <call function="and" as="col_i_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_l2" />
        </call>
        <call function="and" as="col_i_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_l" />
        </call>
        <call function="and" as="col_i_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_2col_p" />
        </call>
        <call function="and" as="col_i_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_srok_before" />
        </call>
        <call function="and" as="col_i_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_i_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_i_srok_after" />
        </call>
        <call function="if" as="col_l2_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l_2" />
        </call>
        <call function="if" as="col_l2_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l_2" />
        </call>
        <call function="and" as="col_l2_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_f" />
        </call>
        <call function="and" as="col_l2_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_i" />
        </call>
        <call function="and" as="col_l2_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_l" />
        </call>
        <call function="and" as="col_l2_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_2col_p" />
        </call>
        <call function="and" as="col_l2_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_srok_before" />
        </call>
        <call function="and" as="col_l2_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l2_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l2_srok_after" />
        </call>
        <call function="if" as="col_l_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l" />
        </call>
        <call function="if" as="col_l_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_l" />
        </call>
        <call function="and" as="col_l_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_f" />
        </call>
        <call function="and" as="col_l_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_i" />
        </call>
        <call function="and" as="col_l_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_l2" />
        </call>
        <call function="and" as="col_l_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_2col_p" />
        </call>
        <call function="and" as="col_l_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_srok_before" />
        </call>
        <call function="and" as="col_l_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_l_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_l_srok_after" />
        </call>
        <call function="if" as="col_p_week" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <column table="kod_isv_ad_evd" column="col_p" />
        </call>
        <call function="if" as="col_p_curr" dontpushpred="1" group="sum">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <column table="kod_isv_ad_evd" column="col_p" />
        </call>
        <call function="and" as="col_p_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_f" />
        </call>
        <call function="and" as="col_p_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_i" />
        </call>
        <call function="and" as="col_p_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_l2" />
        </call>
        <call function="and" as="col_p_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_2col_l" />
        </call>
        <call function="and" as="col_p_srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_srok_before" />
        </call>
        <call function="and" as="col_p_srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="col_p_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="col_p_srok_after" />
        </call>
        <call function="if" as="srok_before_week" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="srok_before_curr" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="and" as="srok_before_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_f" />
        </call>
        <call function="and" as="srok_before_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_i" />
        </call>
        <call function="and" as="srok_before_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_l2" />
        </call>
        <call function="and" as="srok_before_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_l" />
        </call>
        <call function="and" as="srok_before_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2017</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2col_p" />
        </call>
        <call function="and" as="srok_before_2srok_after" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="le">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="gt">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2018</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_before_2srok_after_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_before_2srok_after" />
        </call>
        <call function="if" as="srok_after_week" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="srok_after_curr" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="and" as="srok_after_2col_f" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_f_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_f" />
        </call>
        <call function="and" as="srok_after_2col_i" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_i_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_i" />
        </call>
        <call function="and" as="srok_after_2col_l2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l_2" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_l2_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_l2" />
        </call>
        <call function="and" as="srok_after_2col_l" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_l_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_l" />
        </call>
        <call function="and" as="srok_after_2col_p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <column table="kod_isv_ad_evd" column="col_p" />
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2col_p_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2col_p" />
        </call>
        <call function="and" as="srok_after_2srok_before" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_limit_p8">2018</useparam>
          </call>
          <call function="=">
            <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
            <const name="id_slice_week">1</const>
          </call>
          <call function="=">
            <call function="over">
              <call function="max">
                <call table="kod_isv_ad_evd" column="col_p" function="if">
                  <call function="le">
                    <column table="kod_isv_ad_evd" column="srok_uslug" />
                    <useparam name="date_limit_p8">2017</useparam>
                  </call>
                  <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <call group="sum" type="number" as="srok_after_2srok_before_cnt" function="()">
          <fact column="isv_ad_evd_count" condition="srok_after_2srok_before" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call function="if" as="new_srok_before" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2017</useparam>
            </call>
            <call function="is null">
              <call function="over" type="number" title=" ">
                <call function="max">
                  <call function="if">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <const>1</const>
                  </call>
                </call>
                <call function="partition by">
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
              </call>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
        <call function="if" as="new_srok_after" dontpushpred="1" group="sum">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_limit_p8">2018</useparam>
            </call>
            <call function="is null">
              <call function="over" type="number" title=" ">
                <call function="max">
                  <call function="if">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <const>1</const>
                  </call>
                </call>
                <call function="partition by">
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
              </call>
            </call>
          </call>
          <fact table="kod_isv_ad_evd" column="isv_ad_evd_col_no_fact">1</fact>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="||" as="list_name">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" as="name_podr" />
        </call>
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" />
        <fact column="col_f_week" as="col_f_week" nvl="0" group="sum" title="АТП на начало периода" />
        <fact column="col_f_curr" as="col_f_curr" nvl="0" group="sum" title="АТП на конец периода" />
        <fact column="col_f_2col_i_cnt" as="col_f_2col_i" nvl="0" group="sum" title="из АТП в Приост" />
        <fact as="col_f_2col_l2" nvl="0" group="sum" column="col_f_2col_l2_cnt" title="из АТП в Претенз" />
        <fact column="col_f_2col_l_cnt" as="col_f_2col_l" nvl="0" group="sum" title="из АТП в Раст" />
        <fact column="col_f_2col_p_cnt" as="col_f_2col_p" nvl="0" group="sum" title="из АТП в РВУН" />
        <fact column="col_f_2srok_before_cnt" as="col_f_2srok_before" nvl="0" group="sum" title="из АТП в Ост до" />
        <fact column="col_f_2srok_after_cnt" as="col_f_2srok_after" nvl="0" group="sum" title="из АТП в Ост после" />
        <fact column="col_i_week" as="col_i_week" nvl="0" group="sum" title="Приостановлен на начало периода" />
        <fact column="col_i_curr" as="col_i_curr" nvl="0" group="sum" title="Приостановлен на конец периода" />
        <fact column="col_i_2col_f_cnt" as="col_i_2col_f" nvl="0" group="sum" />
        <fact as="col_i_2col_l2" nvl="0" group="sum" column="col_i_2col_l2_cnt" />
        <fact column="col_i_2col_l_cnt" as="col_i_2col_l" nvl="0" group="sum" />
        <fact column="col_i_2col_p_cnt" as="col_i_2col_p" nvl="0" group="sum" />
        <fact column="col_i_2srok_before_cnt" as="col_i_2srok_before" nvl="0" group="sum" />
        <fact column="col_i_2srok_after_cnt" as="col_i_2srok_after" nvl="0" group="sum" />
        <fact column="col_l2_week" as="col_l2_week" nvl="0" group="sum" />
        <fact column="col_l2_curr" as="col_l2_curr" nvl="0" group="sum" />
        <fact column="col_l2_2col_f_cnt" as="col_l2_2col_f" nvl="0" group="sum" />
        <fact as="col_l2_2col_i" nvl="0" group="sum" column="col_l2_2col_i_cnt" />
        <fact column="col_l2_2col_l_cnt" as="col_l2_2col_l" nvl="0" group="sum" />
        <fact column="col_l2_2col_p_cnt" as="col_l2_2col_p" nvl="0" group="sum" />
        <fact column="col_l2_2srok_before_cnt" as="col_l2_2srok_before" nvl="0" group="sum" />
        <fact column="col_l2_2srok_after_cnt" as="col_l2_2srok_after" nvl="0" group="sum" />
        <fact column="col_l_week" as="col_l_week" nvl="0" group="sum" />
        <fact column="col_l_curr" as="col_l_curr" nvl="0" group="sum" />
        <fact column="col_l_2col_f_cnt" as="col_l_2col_f" nvl="0" group="sum" />
        <fact as="col_l_2col_i" nvl="0" group="sum" column="col_l_2col_i_cnt" />
        <fact column="col_l_2col_l2_cnt" as="col_l_2col_l2" nvl="0" group="sum" />
        <fact as="col_l_2col_p" nvl="0" group="sum" column="col_l_2col_p_cnt" />
        <fact column="col_l_2srok_before_cnt" as="col_l_2srok_before" nvl="0" group="sum" />
        <fact column="col_l_2srok_after_cnt" as="col_l_2srok_after" nvl="0" group="sum" />
        <fact column="col_p_week" as="col_p_week" nvl="0" group="sum" />
        <fact column="col_p_curr" as="col_p_curr" nvl="0" group="sum" />
        <fact column="col_p_2col_f_cnt" as="col_p_2col_f" nvl="0" group="sum" />
        <fact as="col_p_2col_i" nvl="0" group="sum" column="col_p_2col_i_cnt" />
        <fact column="col_p_2col_l2_cnt" as="col_p_2col_l2" nvl="0" group="sum" />
        <fact column="col_p_2col_l_cnt" as="col_p_2col_l" nvl="0" group="sum" />
        <fact column="col_p_2srok_before_cnt" as="col_p_2srok_before" nvl="0" group="sum" />
        <fact column="col_p_2srok_after_cnt" as="col_p_2srok_after" nvl="0" group="sum" />
        <fact column="srok_before_week" as="srok_before_week" nvl="0" group="sum" />
        <fact column="srok_before_curr" as="srok_before_curr" nvl="0" group="sum" />
        <fact column="srok_before_2col_f_cnt" as="srok_before_2col_f" nvl="0" group="sum" />
        <fact as="srok_before_2col_i" nvl="0" group="sum" column="srok_before_2col_i_cnt" />
        <fact column="srok_before_2col_l2_cnt" as="srok_before_2col_l2" nvl="0" group="sum" />
        <fact column="srok_before_2col_l_cnt" as="srok_before_2col_l" nvl="0" group="sum" />
        <fact column="srok_before_2col_p_cnt" as="srok_before_2col_p" nvl="0" group="sum" />
        <fact column="srok_before_2srok_after_cnt" as="srok_before_2srok_after" nvl="0" group="sum" />
        <fact column="srok_after_week" as="srok_after_week" nvl="0" group="sum" />
        <fact column="srok_after_curr" as="srok_after_curr" nvl="0" group="sum" />
        <fact column="srok_after_2col_f_cnt" as="srok_after_2col_f" nvl="0" group="sum" />
        <fact as="srok_after_2col_i" nvl="0" group="sum" column="srok_after_2col_i_cnt" />
        <fact column="srok_after_2col_l2_cnt" as="srok_after_2col_l2" nvl="0" group="sum" />
        <fact column="srok_after_2col_l_cnt" as="srok_after_2col_l" nvl="0" group="sum" />
        <fact column="srok_after_2col_p_cnt" as="srok_after_2col_p" nvl="0" group="sum" />
        <fact as="srok_after_2srok_before" nvl="0" group="sum" column="srok_after_2srok_before_cnt" />
        <fact column="new_col_f" as="new_col_f" nvl="0" group="sum" />
        <fact as="new_col_i" nvl="0" group="sum" column="new_col_i" />
        <fact column="new_col_l2" as="new_col_l2" nvl="0" group="sum" />
        <fact column="new_col_l" as="new_col_l" nvl="0" group="sum" />
        <fact column="new_col_p" as="new_col_p" nvl="0" group="sum" />
        <fact column="new_srok_before" as="new_srok_before" nvl="0" group="sum" />
        <fact column="new_srok_after" as="new_srok_after" nvl="0" group="sum" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <where>
            <call function="and">
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-dep" timestamp="16.01.2019 17:29:33" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-44864-expr" />
      </expressions>
      <select>
        <usepart part="45676-44864-select" />
        <usepart part="45676-title_select_from_params" />
      </select>
      <from>
        <qube>
          <usepart part="45676-44864-qube" />
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="by_dep" title="По филиалам" order="name_podr">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="rab">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build_real" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="norab">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build_real" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column column="fl_build_week" table="this" />
                </call>
                <call function="=">
                  <column column="fl_build_curr" table="this" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="col_fact_week" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="col_fact_week" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-49578-date_beg_next_Q" timestamp="27.09.2018 10:01:05" title="Первая дата следующего квартала" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_beg_cur_Q" type="date">
          <const>date'2018-07-01'</const>
        </param>
      </params>
      <select>
        <call function="add_months" as="val">
          <useparam name="date_beg_cur_Q" />
          <const>3</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-date_end_cur_Q" timestamp="27.09.2018 09:59:51" title="Последняя дата текущего квартала" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_beg_cur_Q" type="date">
          <const>date'2018-07-01'</const>
        </param>
      </params>
      <select>
        <call function="-" as="val" type="date">
          <call function="add_months">
            <useparam table="a" column="dat_copy" name="date_beg_cur_Q" />
            <const>3</const>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-48004-cur_year" title="Год отчета" timestamp="15.06.2018 15:17:18" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2018</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-next_year" title="Следующий год" timestamp="15.06.2018 15:24:14" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2019</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-prev_year" timestamp="15.06.2018 15:35:49" title="Предыдущий год" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2017</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-date_beg_next_Y" title="Первая дата следующего года" timestamp="15.06.2018 15:44:38" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">date'2019-01-01'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-48004-date_end_cur_Y" title="Последняя дата текущего года" timestamp="15.06.2018 15:57:54" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">date'2018-12-31'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-48004-cur_year_minus_2" title="Позапрошлый год" timestamp="18.06.2018 10:56:01" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2016</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-cur_year_minus_3" title="Текущий год минус 3" timestamp="18.06.2018 10:56:57" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2015</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-date_end_cur_Q-for_47522" title="Последняя дата текущего квартала" timestamp="19.06.2018 10:08:54" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params exclude="1">
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select exclude="1">
        <call function="-" as="val" type="date">
          <call function="add_months">
            <call function="trunc">
              <column table="a" column="dat_copy" />
              <const>'Q'</const>
            </call>
            <const>3</const>
          </call>
          <const>1</const>
        </call>
      </select>
      <from exclude="1">
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where exclude="1">
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
      <select>
        <const as="val">date'2018-09-30'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-48004-date_beg_next_Q-for_47522" title="Первая дата следующего квартала" timestamp="18.06.2018 11:54:51" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params exclude="1">
        <param name="id_slice" type="number">
          <const>204</const>
        </param>
      </params>
      <select exclude="1">
        <call function="add_months" as="val">
          <call function="trunc">
            <column table="a" column="dat_copy" />
            <const>'Q'</const>
          </call>
          <const>3</const>
        </call>
      </select>
      <from exclude="1">
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where exclude="1">
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice" />
        </call>
      </where>
      <select>
        <const as="val">date'2018-10-01'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-48004-next_Q_1st_month" title="Первый месяц следующего квартала" timestamp="18.06.2018 14:00:23" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">7</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-next_Q_1st_month-for_47522" title="Первый месяц следующего квартала" timestamp="18.06.2018 14:03:32" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">10</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-48004-next_Q_year" title="Год следующего квартала" timestamp="18.06.2018 14:08:21" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2018</const>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-49578-date_beg_cur_Q" timestamp="27.09.2018 10:04:01" title="Первая дата текущего квартала" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
        <param name="kv" type="number">
          <const>3</const>
        </param>
      </params>
      <select>
        <call as="val" function="ym2 begin time">
          <call function="num to ym2">
            <useparam name="year" />
            <call function="kv beg mes">
              <useparam name="kv" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-date_beg_cur_Q_pl2" timestamp="27.09.2018 10:03:14" title="Первая дата квартала + 2" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_beg_cur_Q" type="date">
          <const>date'2018-07-01'</const>
        </param>
      </params>
      <select>
        <call function="add_months" as="val">
          <useparam name="date_beg_cur_Q" />
          <const>6</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-date_beg_next_Y" title="Первая дата следующего года" timestamp="27.09.2018 11:05:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_beg_cur_Q" type="date">
          <const>date'2018-07-01'</const>
        </param>
      </params>
      <select>
        <call function="add_months" as="val">
          <call function="trunc">
            <useparam table="a" column="dat_copy" name="date_beg_cur_Q" />
            <const>'YYYY'</const>
          </call>
          <const>12</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-date_end_cur_Y" title="Последняя дата текущего года" timestamp="27.09.2018 14:46:00" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_beg_cur_Q" type="date">
          <const>date'2018-07-01'</const>
        </param>
      </params>
      <select>
        <call as="val" function="date add days">
          <call function="add_months">
            <call function="trunc">
              <useparam table="a" column="dat_copy" name="date_beg_cur_Q" />
              <const>'YYYY'</const>
            </call>
            <const>12</const>
          </call>
          <const>-1</const>
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-cur_year" title="Год отчета" timestamp="27.09.2018 12:17:12" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
      </params>
      <select>
        <call as="val" function="()">
          <useparam name="year" />2018</call>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-49578-prev_year" timestamp="27.09.2018 12:20:06" title="Предыдущий год" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
      </params>
      <select>
        <call as="val" function="-">
          <useparam name="year" />
          <const>1</const>2018</call>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-49578-cur_year_minus_2" title="Позапрошлый год" timestamp="27.09.2018 12:23:49" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
      </params>
      <select>
        <call as="val" function="-">
          <useparam name="year" />
          <const>2</const>2018</call>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-49578-cur_year_minus_3" title="Текущий год минус 3" timestamp="27.09.2018 12:33:38" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
      </params>
      <select>
        <call as="val" function="-">
          <useparam name="year" />
          <const>3</const>2018</call>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-49578_def_year" class="1" timestamp="27.01.2021 03:07:57" title="Год для параметра year" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2021</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578_def_kv" class="1" timestamp="02.10.2021 22:06:32" title="Квартал для параметра kv" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">4</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49680" timestamp="21.01.2019 08:15:38" title="Действующие договоры в разрезе населенных пунктов" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="and" as="do_rab_v1" dontpushpred="1" exclude="1">
          <call function="or">
            <const>A</const>
            <const>B</const>
          </call>
          <call function="or">
            <call function="and">
              <const>A</const>
              <const>C</const>
              <const>Y</const>
            </call>
            <call function="and">
              <const>B</const>
              <call function="not">
                <const>A</const>
              </call>
              <const>C</const>
            </call>
          </call>
        </call>
        <call function="and" as="do_rab_v2" dontpushpred="1" exclude="1">
          <const>C</const>
          <call function="or">
            <const>A</const>
            <const>B</const>
          </call>
          <call function="or">
            <call function="and">
              <const>A</const>
              <const>Y</const>
            </call>
            <call function="and">
              <const>B</const>
              <call function="not">
                <const>A</const>
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="do_rab_v3" dontpushpred="1" exclude="1">
          <const>C</const>
          <call function="or">
            <call function="and">
              <const>A</const>
              <const>Y</const>
            </call>
            <call function="and">
              <call function="not">
                <const>A</const>
              </call>
              <const>B</const>
            </call>
          </call>
        </call>
        <call function="and" as="do_rab_v4" dontpushpred="1" exclude="1">
          <const>C</const>
          <call function="or">
            <call function="and">
              <const>A</const>
              <const>Y</const>
            </call>
            <call function="and">
              <call function="not">
                <const>A</const>
              </call>
              <const>B</const>
            </call>
          </call>
        </call>
        <call function="and" as="do_rab" dontpushpred="1" exclude="1">
          <call function="or">
            <call function="=" comment="А">
              <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
              <const>1</const>
            </call>
            <call function="and" comment="B">
              <call function="ge">
                <call function="year">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <useparam name="cur_year" />
              </call>
              <call function="not in">
                <column table="kod_isv_ad_evd" column="status" />
                <array>
                  <const>0</const>
                  <const>2</const>
                </array>
              </call>
            </call>
          </call>
          <call function="or">
            <call function="and">
              <call function="=1" comment="A">
                <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
              </call>
              <call function="=1" comment="C">
                <column column="val" table="evd_fl_build_real" />
              </call>
              <call function="or" comment="Y">
                <call function="is not null">
                  <column column="kod_org_active" table="kod_isv_ad_evd" />
                </call>
                <call function="and">
                  <call function="le">
                    <call function="year">
                      <column column="val" table="evd_dt_contract" />
                    </call>
                    <useparam name="prev_year" />
                  </call>
                  <call function="is null">
                    <column column="kod_org_active" table="kod_isv_ad_evd" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="ge" comment="B">
                <call function="year">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <useparam name="cur_year" />
              </call>
              <call function="not in" comment="B">
                <column table="kod_isv_ad_evd" column="status" />
                <array>
                  <const>0</const>
                  <const>2</const>
                </array>
              </call>
              <call function="!=" comment="not A">
                <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                <const>1</const>
              </call>
              <call function="=1" comment="C">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="do_rab" dontpushpred="1">
          <call function="=1" comment="C">
            <column table="evd_fl_build_real" column="val" />
          </call>
          <call function="or">
            <call function="and" comment="B">
              <call function="ge">
                <call function="year">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <useparam name="cur_year" />
              </call>
              <call function="not in">
                <column table="kod_isv_ad_evd" column="status" />
                <array>
                  <const>0</const>
                  <const>2</const>
                </array>
              </call>
            </call>
            <call function="is not null" comment="Y">
              <column column="kod_org_active" table="kod_isv_ad_evd" />
            </call>
            <call function="and" comment="Y">
              <call function="le">
                <call function="year">
                  <column column="val" table="evd_dt_contract" />
                </call>
                <useparam name="prev_year" />
              </call>
            </call>
          </call>
        </call>
        <call function="le" as="usl_cur_y" dontpushpred="1">
          <call function="year">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="cur_year" />
        </call>
        <call function="and" as="is_sou_late" dontpushpred="1">
          <call function="lt" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="and" as="is_not_late" dontpushpred="1">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="usl_nxt_y" function="ge" dontpushpred="1">
          <call function="year">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="next_year" />
        </call>
        <call function="()" as="ostatok" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="do_rab" />
        </call>
        <call function="()" as="ostatok_cur_y" group="sum">
          <fact column="ostatok" condition="usl_cur_y" />
        </call>
        <call function="()" as="ostatok_late" group="sum">
          <fact column="ostatok_cur_y" condition="is_sou_late" />
        </call>
        <call function="()" as="ostatok_not_late" group="sum">
          <fact column="ostatok_cur_y" condition="is_not_late" />
        </call>
        <call function="()" as="ostatok_nxt_y" group="sum">
          <fact column="ostatok" condition="usl_nxt_y" />
        </call>
        <call function="and" as="is_fl_build_1" dontpushpred="1">
          <call function="=1">
            <column table="evd_fl_build_real" column="val" />
          </call>
        </call>
        <call function="()" as="col_any_fact" type="number" group="sum">
          <fact condition="is_fl_build_1" column="isv_ad_evd_col_any_fact" />
        </call>
      </expressions>
      <select>
        <column column="isv_ad_everyday_id" table="kod_isv_ad_evd" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="status" />
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <column column="kod_direct" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="name_kr" as="list_name" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <call function="year" as="year_zakl">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call as="name_rs_nvl" function="nvl">
          <column table="evd_kodres" column="name" />
          <const>'не заполнено'</const>
        </call>
        <column table="evd_name_mo" column="val" as="name_mo_nvl" type="string" />
        <column table="evd_name_sp" column="val" as="name_sp_nvl" type="string" />
        <column table="evd_name_np" column="val" as="name_np_nvl" type="string" />
        <fact table="evd_cur" column="ostatok" group="sum" type="number" nullif="0" />
        <fact table="evd_cur" column="ostatok_cur_y" group="sum" type="number" nullif="0" />
        <fact table="evd_cur" column="ostatok_late" group="sum" type="number" nullif="0" />
        <fact table="evd_cur" column="ostatok_not_late" group="sum" type="number" nullif="0" />
        <fact table="evd_cur" column="ostatok_nxt_y" group="sum" type="number" nullif="0" />
        <call function="-nvl" group="sum" as="col_any_fact_1w" type="number" nullif="0">
          <fact table="evd_cur" column="col_any_fact" />
          <fact table="evd_1w" column="col_any_fact" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_4w" nullif="0" type="number">
          <fact table="evd_cur" column="col_any_fact" />
          <fact column="col_any_fact" table="evd_4w" />
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_fl_build_real" />
          <link name="evd_kodres" />
          <link name="evd_name_mo" />
          <link name="evd_name_sp" />
          <link name="evd_name_np" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range_0_1_4" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_fake" />
                    <const>1</const>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_fake" />
                    <const>1</const>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_1w">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_fake" />
                    <const>1</const>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_4w">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_4week" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_fake" />
                    <const>1</const>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <where exclude="1">
        <call function="!=0">
          <column table="this" column="ostatok" />
          <column table="this" column="ostatok_cur_y" />
          <column table="this" column="ostatok_late" />
          <column table="this" column="ostatok_not_late" />
          <column table="this" column="ostatok_nxt_y" />
          <column table="this" column="col_any_fact_1w" />
          <column table="this" column="col_any_fact_4w" />
        </call>
      </where>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-49680-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset title="без КС" as="no_kc">
          <where>
            <call function="!=">
              <column table="this" column="kod_direct" />
              <const>19</const>
            </call>
          </where>
          <usepart part="45676-49680-grsets">
            <const>'no_kc_'</const>
          </usepart>
        </grset>
        <grset title="только КС" as="kc">
          <where>
            <call function="=">
              <column table="this" column="kod_direct" />
              <const>19</const>
            </call>
          </where>
          <usepart part="45676-49680-grsets">
            <const>'kc_'</const>
          </usepart>
        </grset>
        <grset as="fil" order="fl_branch, kod_predpr" exclude="1">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset as="rs" order="name_rs">
            <group>
              <sourcelink table="evd_name_rs" />
            </group>
            <grset as="mo" order="name_mo">
              <group>
                <sourcelink table="evd_name_mo" />
              </group>
              <grset as="sp" order="name_sp">
                <group>
                  <sourcelink table="evd_name_sp" />
                </group>
                <grset as="np" order="name_np">
                  <group>
                    <sourcelink table="evd_name_np" />
                  </group>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
      <having>
        <call function="!=0">
          <column table="this" column="ostatok" />
          <column table="this" column="ostatok_cur_y" />
          <column table="this" column="ostatok_late" />
          <column table="this" column="ostatok_not_late" />
          <column table="this" column="ostatok_nxt_y" />
          <column table="this" column="col_any_fact_1w" />
          <column table="this" column="col_any_fact_4w" />
        </call>
      </having>
    </query>
    <query name="45676-id_slice_4week" class="1" timestamp="04.10.2018 15:08:39" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="date_otch" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
        <column table="a" column="name" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="dat_copy" />
            <call function="date add days">
              <useparam name="date_otch" />
              <const>-28</const>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45676-date-last-4week-def" timestamp="04.10.2018 15:45:55" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice_4week" type="number">
          <const>204</const>
        </param>
      </params>
      <select>
        <call function="date add days" as="val" type="date">
          <column table="a" column="dat_copy" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id_slice" />
          <useparam name="id_slice_4week" />
        </call>
      </where>
    </query>
    <query name="45676-detail-d4w" timestamp="05.10.2018 15:12:22" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" halign="center" format="N0">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
          <dimset as="evd_4w" />
        </qube>
      </from>
    </query>
    <query name="45676-id_slice_range_0_1_4" class="1" timestamp="05.10.2018 15:07:02" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="id_slice_week" type="number" />
        <param name="id_slice_4week" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" />
        <column table="a" column="name" title="" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_4week" />
          </call>
        </call>
      </where>
    </query>
    <query name="45676-detail-d1w" timestamp="05.10.2018 15:13:13" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" halign="center" format="N0">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice_4week" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
          <dimset as="evd_1w" />
        </qube>
      </from>
    </query>
    <query name="45676-detail-d1_var2" timestamp="10.10.2018 18:52:10" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" halign="center" format="N0">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice_2week" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="45676-detail-d1vs2w" timestamp="10.10.2018 18:53:40" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" print-xlsx="1" post-process="0" del-cols="1" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <call function="if" as="[column]" type="number" title="Динамика" halign="center" format="N0">
          <call function="and">
            <call function="!=0">
              <call function="()" as="[column]" />
            </call>
            <call function="!=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
          <call function="over" title="Остаток динамика" type="number">
            <call function="sum">
              <call function="()" as="[column]" />
            </call>
            <call function="partition by">
              <column table="this" column="kod_dop_contract" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <qube>
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="test_WebMethod" class="1" timestamp="15.10.2018 21:00:47" title="Test Query Description" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param type="number" name="num_par" />
        <param name="string_par" type="string" />
        <param name="Dat_par" type="date" exclude="1" />
      </params>
      <select>
        <call function="+nvl" as="num_column" exclude="1">
          <useparam name="num_par" />
          <const>1</const>
        </call>
        <call function="||-" as="string_column" exclude="1">
          <useparam name="string_par" />
          <const>'concat text'</const>
        </call>
        <call as="datColumn" function="date add days" type="date" exclude="1">
          <useparam name="Dat_par" />
          <const>1</const>
        </call>
        <call function="+nvl" as="num_column">
          <column table="a" column="id_slice">1</column>
          <useparam name="num_par" />
        </call>
        <call function="||-" as="string_column">
          <column table="a" column="user_ad_all">'concat row'</column>
          <useparam name="string_par" />
        </call>
        <column table="a" column="dat_copy" />
      </select>
      <from>
        <query name="dual" as="a" exclude="1" />
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="in">
          <column table="a" column="id_slice" />
          <const>(753, 754)</const>
        </call>
      </where>
    </query>
    <query name="45676-test_is_dop_contract" class="1" timestamp="15.10.2018 11:12:01" title="Test Query Description" multi-select="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param type="number" name="kod_dop" />
      </params>
      <select>
        <column table="a" column="kod_filial" />
        <column table="a" column="kod_dop_contract" key="1" />
      </select>
      <from>
        <query name="is_dop_contract" as="a" />
      </from>
      <where>
        <call function="=" optional="1">
          <column table="a" column="kod_dop_contract" />
          <useparam name="kod_dop" />
        </call>
      </where>
    </query>
    <query name="test_hv_eopwrc" class="1" timestamp="15.10.2018 19:57:54" title="Test Query Description" multi-select="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param type="number" name="pwrc_id" />
      </params>
      <select>
        <column table="a" column="hv_eopwrc_id" key="1" />
        <column table="a" column="pwrc_id" />
        <column table="a" column="pwrcname" />
        <column table="a" column="bal_id" />
      </select>
      <from>
        <query as="a" name="hv_eopwrc" />
      </from>
      <where>
        <call function="=" optional="1">
          <column table="a" column="pwrc_id" />
          <useparam name="pwrc_id" />
        </call>
      </where>
    </query>
    <query name="test_jv_rep_cons_d_fl" class="1" timestamp="15.10.2018 19:57:40" title="Test Query Description" multi-select="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param type="number" name="pwrc_id" />
      </params>
      <select>
        <column table="a" key="1" column="kod_fl" />
        <column table="a" column="name" />
      </select>
      <from>
        <query as="a" name="jv_rep_cons_d_fl" />
      </from>
      <where>
        <call function="=" optional="1">
          <column table="a" column="kod_fl" />
          <useparam name="kod_fl" />
        </call>
      </where>
    </query>
    <query name="45676-p3_dzo" timestamp="26.02.2019 11:54:12" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" exclude="1" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" exclude="1" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" exclude="1" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <useparam name="prev_year" />
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <useparam name="prev_year" type="number" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <useparam name="prev_year" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <fact as="fl_2018_fact" nvl="0" group="sum" table="evd_cur" column="isv_ad_evd_fl_2018_fact" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" exclude="1" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <link name="kod_org_active" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="kod_org_active" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" optional="1" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="kod_org_active" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" optional="1" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" exclude="1">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" comment="начинка такая же как у all если вносить изменеия сделать через usepart" order="dzo">
          <group>
            <sourcelink table="kod_org_active" />
          </group>
          <usepart part="45676-p3_dzo-grsets">
            <const>'p_'</const>
          </usepart>
          <usepart part="45676-p3-grsets" exclude="1">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-49578_def_year_51312_TEST" class="1" timestamp="23.06.2021 20:55:17" title="Год для параметра year" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">2021</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578_def_kv_51312_TEST" class="1" timestamp="02.10.2021 22:07:05" title="Квартал для параметра kv" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <select>
        <const as="val">4</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="45676-49578-cur_year_minus_4" title="Текущий год минус 4" timestamp="15.01.2019 16:24:14" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="year" type="number">
          <const>2018</const>
        </param>
      </params>
      <select>
        <call as="val" function="-">
          <useparam name="year" />
          <const>4</const>2018</call>
      </select>
      <from>
        <query as="a" name="dual" />
      </from>
    </query>
    <query name="45676-p1_51312_TEST" timestamp="18.01.2019 09:11:01" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="cond1">
          <column table="ipr_kod_opl_period" column="pr_ofz" />
          <const>1</const>
        </call>
        <call function="()" as="fin_sum_nds_ofz" group="sum">
          <fact column="ipr_fin_fact_sum_nds_npr" condition="cond1" />
        </call>
        <usepart part="45676-range-columns" />
        <call function="and" as="is_sou_tek_do">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Y" />
          </call>
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="and" as="is_sou_tek_ps">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="ge" as="is_sou_tek" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
        <call function="lt" as="is_sou_pr" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
        <call function="()" as="col_i_pr" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_i_tek_do" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_tek_do" />
        </call>
        <call function="()" as="col_i_tek_ps" type="number" group="sum">
          <fact column="isv_ad_everyday_col_i" nvl="0" condition="is_sou_tek_ps" />
        </call>
        <call function="()" as="col_l_2_tek" type="number" group="sum">
          <fact column="isv_ad_everyday_col_l_2" nvl="0" condition="is_sou_tek" />
        </call>
        <call function="()" as="col_l_2_pr" type="number" group="sum">
          <fact column="isv_ad_everyday_col_l_2" nvl="0" condition="is_sou_pr" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
        <column table="ipr_kod_ispolnit_tit" column="name" as="name_podr" />
        <column table="ipr_kod_ispolnit_tit" column="kod_predpr" as="kod_predpr" />
        <column table="ipr_kod_ispolnit_tit" column="fl_branch" />
        <fact column="fin_sum_nds_ofz" group="sum" title="Финансирование тыс. руб. с НДС" mp="-3" />
        <fact column="isv_ad_everyday_col_f" group="sum" as="col_f" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" group="sum" as="col_i" nvl="0" table="evd_cur" />
        <fact column="col_i_pr" group="sum" as="col_i_pr" nvl="0" table="evd_cur" />
        <fact column="col_i_tek_do" group="sum" as="col_i_tek_do" nvl="0" table="evd_cur" />
        <fact column="col_i_tek_ps" group="sum" as="col_i_tek_ps" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" group="sum" as="col_l" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_n" group="sum" as="col_n" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" group="sum" as="col_p" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" group="sum" as="col_p_2" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" group="sum" as="col_l_2" nvl="0" table="evd_cur" />
        <fact column="col_l_2_tek" group="sum" as="col_l_2_tek" nvl="0" table="evd_cur" />
        <fact column="col_l_2_pr" group="sum" as="col_l_2_pr" nvl="0" table="evd_cur" />
        <fact column="col_f_range" group="sum" nvl="0" table="evd" />
        <fact column="col_i_range" group="sum" nvl="0" table="evd" />
        <fact column="col_l_range" group="sum" nvl="0" table="evd" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" />
        <fact column="col_n_range" group="sum" nvl="0" table="evd" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit_tit" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" as="ipr_kod_ispolnit_tit" />
          <where>
            <call function="and">
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit_tit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
            </call>
          </where>
          <dimset as="evd">
            <link name="kod_isv_ad_evd" />
            <link name="id_slice" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <link name="evd_otch_list" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="evd_otch_list" column="val" />
                  <const>1</const>
                </call>
                <call function="in">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice_range1" />
                  <column table="id_slice" column="id_slice" comment="если условие наложить так, то ошибка, только в этом запросе, глюк, разобраться потом" exclude="1" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <link name="kod_isv_ad_evd" />
            <link name="id_slice" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <link name="evd_otch_list" comment="Для прил.1 берем по kod_filial_tit для остальных по kod_filial!" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="evd_otch_list" column="val" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice" />
                  <column table="id_slice" column="id_slice" comment="если условие наложить так, то ошибка, только в этом запросе, глюк, разобраться потом" exclude="1" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit_tit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-p2-1_51312_TEST" timestamp="18.01.2019 09:13:21" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="45676-p2-cmn_51312_TEST" as="a">
          <withparams>
            <usepart part="45676-withparams" />
            <array>
              <const>2</const>
              <const>3</const>
              <const>4</const>
            </array>
          </withparams>
        </query>
      </from>
    </query>
    <query name="45676-p2-cmn_51312_TEST" timestamp="18.01.2019 09:13:09" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
        <param name="otch_list" type="array" />
      </params>
      <expressions>
        <usepart part="45676-range-columns" />
        <call function="if" as="col_itog1" type="number" group="sum">
          <call function="in">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <array>
              <const>2</const>
              <const>3</const>
            </array>
          </call>
          <call function="+nvl">
            <fact column="isv_ad_everyday_col_f" />
            <fact column="isv_ad_everyday_col_i" />
            <fact column="isv_ad_everyday_col_l" />
            <fact column="isv_ad_everyday_col_l_2" />
            <fact column="isv_ad_everyday_col_p" />
            <fact column="isv_ad_everyday_col_p_2" />
            <fact column="isv_ad_everyday_col_n" />
          </call>
        </call>
        <call function="if" as="col_itog2" type="number" group="sum">
          <call function="in">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <array>
              <const>3</const>
              <const>4</const>
            </array>
          </call>
          <call function="+nvl">
            <fact column="isv_ad_everyday_col_f" />
            <fact column="isv_ad_everyday_col_i" />
            <fact column="isv_ad_everyday_col_l" />
            <fact column="isv_ad_everyday_col_l_2" />
            <fact column="isv_ad_everyday_col_p" />
            <fact column="isv_ad_everyday_col_p_2" />
            <fact column="isv_ad_everyday_col_n" />
          </call>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <fact column="col_itog1" title="действующие на 01.01.16" group="sum" nvl="0" table="evd_cur" />
        <fact column="col_itog2" title="действующие на 01.01.17" group="sum" nvl="0" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" group="sum" as="col_f" nvl="0" if="pr4" table="evd_cur">
          <if>
            <call function="in">
              <column table="kod_isv_ad_evd" column="otch_list" />
              <array>
                <const>3</const>
                <const>4</const>
              </array>
            </call>
          </if>
        </fact>
        <fact column="col_f_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_i" group="sum" as="col_i" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_i_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_l" group="sum" as="col_l" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_l_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_n" group="sum" as="col_n" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_n_range" group="sum" nvl="0" if="pr4" table="evd" />
        <fact column="isv_ad_everyday_col_p" group="sum" as="col_p" nvl="0" if="pr4" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" group="sum" as="col_p_2" nvl="0" if="pr4" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" group="sum" as="col_l_2" nvl="0" if="pr4" table="evd_cur" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" if="pr4" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range1" />
                </call>
                <call function="in">
                  <column table="evd_otch_list" column="val" />
                  <useparam name="otch_list" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="in">
                  <column table="evd_otch_list" column="val" />
                  <useparam name="otch_list" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-p3_51312_TEST" timestamp="18.01.2019 09:14:08" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <useparam name="prev_year" />
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <useparam name="prev_year" type="number" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <useparam name="prev_year" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <fact as="fl_2018_fact" nvl="0" group="sum" table="evd_cur" column="isv_ad_evd_fl_2018_fact" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" comment="начинка такая же как у all если вносить изменеия сделать через usepart" order="fl_branch, kod_predpr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p3-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-p3_dzo_51312_TEST" timestamp="26.02.2019 19:15:12" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" exclude="1" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" exclude="1" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" exclude="1" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <useparam name="prev_year" />
          <column table="this" column="year_zakl" group="no" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" group="max">
          <useparam name="prev_year" type="number" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" group="max">
          <useparam name="prev_year" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
        <fact as="fl_2018_fact" nvl="0" group="sum" table="evd_cur" column="isv_ad_evd_fl_2018_fact" />
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" exclude="1" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <link name="kod_org_active" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="kod_org_active" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" optional="1" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="kod_org_active" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" optional="1" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" exclude="1">
          <usepart part="45676-p3-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" comment="начинка такая же как у all если вносить изменеия сделать через usepart" order="dzo">
          <group>
            <sourcelink table="kod_org_active" />
          </group>
          <usepart part="45676-p3_dzo-grsets">
            <const>'p_'</const>
          </usepart>
          <usepart part="45676-p3-grsets" exclude="1">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-p4_51312_TEST" timestamp="18.01.2019 09:15:46" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-range-columns" />
        <call function="()" as="col_m2" type="number" group="sum">
          <fact column="isv_ad_everyday_col_o" condition="is_d0" />
        </call>
        <call function="if" as="col_m1" type="number" group="sum" title="Факт за текущий год" exclude="1">
          <call function="or">
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_f" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dt_reg" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_i" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="=1">
                <column table="kod_isv_ad_evd" column="col_l" />
              </call>
              <call function="=">
                <call function="year">
                  <column table="kod_isv_ad_evd" column="dataizm" />
                </call>
                <useparam name="prev_year" />
                <const exclude="1">2017</const>
                <call function="year" exclude="1">
                  <const>sysdate</const>
                </call>
              </call>
            </call>
          </call>
          <fact column="isv_ad_evd_count" />
        </call>
        <call function="if" as="col_o_before_p4y" type="number" group="sum">
          <call function="lt">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_4" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_p4y" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_4" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_before2015" type="number" group="sum">
          <call function="lt">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_3" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2015" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_3" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2016" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year_minus_2" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2017" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="prev_year" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
        <call function="if" as="col_o_y2018" type="number" group="sum">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
            <useparam name="cur_year" />
          </call>
          <fact column="isv_ad_everyday_col_o" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <column table="kod_isv_ad_evd" column="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_f_range" as="col_f_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_i_range" as="col_i_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_range" as="col_l_range" nvl="0" group="sum" table="evd" />
        <fact column="isv_ad_everyday_col_n" as="col_n" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p_2" as="col_p_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_o" as="col_o" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_m1" group="sum" as="col_m1" nvl="0" table="evd_cur" exclude="1" />
        <fact column="col_m2" group="sum" as="col_m2" nvl="0" table="evd" />
        <fact column="col_o_before_p4y" group="sum" as="col_before_p4y" nvl="0" table="evd_cur" />
        <fact column="col_o_p4y" group="sum" as="col_p4y" nvl="0" table="evd_cur" />
        <fact column="col_o_before2015" group="sum" as="col_before2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2015" group="sum" as="col_y2015" nvl="0" table="evd_cur" />
        <fact column="col_o_y2016" group="sum" as="col_y2016" nvl="0" table="evd_cur" />
        <fact column="col_o_y2017" group="sum" as="col_y2017" nvl="0" table="evd_cur" />
        <fact column="col_o_y2018" group="sum" as="col_y2018" nvl="0" table="evd_cur" />
        <fact column="col_n_range" group="sum" as="col_n_range" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_l_2_range" group="sum" nvl="0" table="evd" />
        <fact column="col_p_range" group="sum" nvl="0" table="evd" />
        <fact column="isv_ad_everyday_col_o" as="col_o_week" nvl="0" group="sum" table="evd_week" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_dt_contract" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_hoz_sposob" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
          <dimset as="evd_week">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset as="p_all" order="fl_branch, kod_predpr">
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <usepart part="45676-p4-grsets">
            <const>'p_'</const>
          </usepart>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105_51312_TEST" timestamp="18.01.2019 09:17:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
          </call>
          <call function="ge" exclude="1">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
          <call function="=">
            <call function="trunc">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_nxt3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=" exclude="1">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
            </call>
            <call function="ge" exclude="1">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
            </call>
            <call function="=">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="lt" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток" exclude="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом" exclude="1">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff">
          <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact" condition="is_week" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" exclude="1" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-43841_51312_TEST" timestamp="18.01.2019 09:17:37" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_d0" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" as="kod_direct" />
        <column table="evd_kodres" column="kod_direct" as="kodres" />
        <column table="evd_fl_build_real" column="val" as="fl_build" />
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <column table="evd_pr_exist_pd" column="val" as="pr_exist_pd" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <column table="ipr_kod_ispolnit" column="name_kr" group="max" as="name_dep" title="Филиал" />
        <column table="evd_kodres" column="name" group="max" as="name_res" title="РЭС" />
        <fact column="isv_ad_everyday_col_plan" as="col_1" nvl="0" group="sum" table="evd_cur" title="Дей на 01.01.XXXX и закл в XXXX" />
        <fact column="isv_ad_everyday_col_f" as="col_3" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Выполнено" />
        <fact column="isv_ad_everyday_col_l" as="col_4" nvl="0" group="sum" table="evd_cur" title="Факт на дату. Расторгнуто" />
        <fact column="isv_ad_everyday_col_i" as="col_6" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Закл ДС о готовн" />
        <fact column="isv_ad_everyday_col_l_2" as="col_7" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Прет-иск работа" />
        <fact column="isv_ad_everyday_col_p" as="col_8" nvl="0" group="sum" table="evd_cur" title="Исполнено СО. Направ увед о готовн" />
        <fact column="ostatok_posle2019" as="col_10" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2019+" />
        <fact column="ostatok_do2019" as="col_11" nvl="0" group="sum" table="evd_cur" title="Остаток. СОУ 2018-" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -2" comment="имя должно быть такое чтобы работала детализация" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" title="Исполнение за неделю -1" comment="имя должно быть такое чтобы работала детализация" />
      </select>
      <from>
        <qube single-way="1">
          <link name="kod_isv_ad_evd" />
          <link name="ipr_kod_ispolnit" />
          <link name="id_slice" />
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_kodres" />
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="or">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    <const>1</const>
                  </call>
                  <call function="and">
                    <call function="ge">
                      <column table="this" column="year_zakl" />
                      <useparam name="cur_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
                <call function="in" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="ЛЭ">
          <usepart part="45676-p4-grsets">
            <const>''</const>
          </usepart>
          <grset as="dep" title="По филиалам" order="decode(kod_direct,19,1,21,2,20,3,26,4,24,5,22,6,27,7,8), name_dep">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
            <usepart part="45676-p4-grsets">
              <const>'dep_'</const>
            </usepart>
            <grset as="res" title="По РЭС" order="name_res">
              <group>
                <sourcelink table="evd_kodres" />
              </group>
              <where>
                <call function="!=" comment="исключаем детализацию для КС">
                  <column table="this" column="kod_direct" />
                  <const>19</const>
                </call>
              </where>
              <usepart part="45676-p4-grsets">
                <const>'res_'</const>
              </usepart>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44502_51312_TEST" timestamp="18.01.2019 09:18:38" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-ostatok-columns" />
        <usepart part="45676-range-columns" />
        <usepart part="45676-fact-3weeks-columns" />
      </expressions>
      <select>
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" />
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" />
        <call function="||" as="year_gr1_name1" group="max">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column table="evd_fl_build" column="val" as="fl_build" />
        <column table="evd_podr_name_titul" column="val" as="podr_name_titul" />
        <call function="year" as="year_zakl" group="max">
          <column table="evd_dt_contract" column="val" />
        </call>
        <call function="year" as="year_otch" group="max" exclude="1">
          <useparam name="date_otch" />
        </call>
        <call function="-nvl" as="dyear" group="max">
          <column table="this" column="year_otch" group="no" exclude="1" />
          <useparam name="prev_year" />
          <const exclude="1">2017</const>
          <column table="this" column="year_zakl" group="no" />
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" />
        <column table="evd_kod_list7" column="val" as="kod_list7" />
        <column table="kod_isv_ad_evd" column="list7_name1" title="ДЗО" group="max" />
        <column table="kod_isv_ad_evd" column="list7_name2" title="БП" group="max" />
        <column table="evd_otch_list_3" column="val" as="otch_list_3" />
        <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" />
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_posle" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_do" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_late" nvl="0" group="sum" table="evd_cur" title="Остаток" />
        <fact column="ostatok_range" group="sum" nvl="0" title="Остаток динамика" table="evd" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_2to1w" group="sum" nvl="0" table="evd" />
        <fact column="col_any_fact_1to0w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_do_1w" group="sum" nvl="0" table="evd" />
        <fact column="ostatok_2to1w" group="sum" nvl="0" table="evd" />
      </select>
      <from>
        <qube single-way="1">
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd">
            <link name="kod_dt_cont_grp1" />
            <link name="kod_dt_cont_grp2" exclude="1" />
            <link name="kod_dt_cont_grp3" exclude="1" />
          </link>
          <link name="evd_dt_contract" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build" />
          <link name="evd_pr_ofz_vkl" />
          <link name="evd_podr_name_titul" />
          <link name="id_slice" />
          <link name="evd_kod_list7" />
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="is not null">
                  <column table="evd_kod_list7" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range3" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="is not null">
                  <column table="evd_kod_list7" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="in" optional="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <useparam name="kod_ispolnit" />
                </call>
                <call function="!=">
                  <column table="kod_isv_ad_evd" column="pr_gen" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" order="kod_list7">
          <group>
            <sourcelink table="evd_kod_list7" />
          </group>
          <grset as="all_do">
            <where>
              <call function="and">
                <call function="lt">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                  <const exclude="1">2017</const>
                  <call function="year" exclude="1">
                    <useparam name="date_otch" />
                  </call>
                </call>
              </call>
            </where>
            <grset as="do_no_rab">
              <where>
                <call function="=0">
                  <column table="this" column="fl_build" />
                </call>
              </where>
              <grset as="do_no_rab_do">
                <where>
                  <call function="lt">
                    <column table="this" column="year_zakl" />
                    <call function="-nvl">
                      <call function="year" exclude="1">
                        <useparam name="date_otch" />
                      </call>
                      <useparam name="prev_year" />
                      <const exclude="1">2017</const>
                      <const>2</const>
                    </call>
                  </call>
                </where>
              </grset>
              <grset as="do_no_rab_pos">
                <where>
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <call function="-nvl">
                      <call function="year" exclude="1">
                        <useparam name="date_otch" />
                      </call>
                      <useparam name="prev_year" />
                      <const exclude="1">2017</const>
                      <const>2</const>
                    </call>
                  </call>
                </where>
              </grset>
            </grset>
            <grset as="do_rab">
              <where>
                <call function="=1">
                  <column table="this" column="fl_build" />
                </call>
              </where>
              <grset as="do_rab_ygr3">
                <where>
                  <call function="gt">
                    <column table="this" column="dyear" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset as="do_rab_ygr2">
                <where>
                  <call function="=">
                    <column table="this" column="dyear" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset as="do_rab_ygr1">
                <where>
                  <call function="=">
                    <column table="this" column="dyear" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
            </grset>
          </grset>
          <grset as="all_tek">
            <where>
              <call function="and">
                <call function="ge">
                  <column table="this" column="year_zakl" />
                  <call function="year" exclude="1">
                    <useparam name="date_otch" />
                  </call>
                  <useparam name="prev_year" />
                  <const exclude="1">2017</const>
                </call>
              </call>
            </where>
            <grset as="tek_no_rab">
              <where>
                <call function="=0">
                  <column table="this" column="fl_build" />
                </call>
              </where>
            </grset>
            <grset as="tek_rab">
              <where>
                <call function="=1">
                  <column table="this" column="fl_build" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-test_51312_TEST" timestamp="18.01.2019 09:20:59" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="is_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_rab" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>1</const>
        </call>
        <call function="=" as="is_norab" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>0</const>
        </call>
        <call function="and" as="is_new" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_f_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_f" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_i_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_i" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_2_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l_2" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_p_curr" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_late" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_n" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost1" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost2" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                    <call function="between" exclude="1">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_next_Q" />
                      <useparam name="date_end_cur_Y" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost3" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="ge" exclude="1">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_next_Y" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_curr" part-id="45676-44864-expr_51312_TEST">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_week" part-id="45676-44864-expr_51312_TEST">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="()" as="col_fact_week" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_week" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_fact_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_f_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_col_f_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_i_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_col_i_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_2_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_col_l_2_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_col_l_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_p_curr" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_col_p_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="late" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_late" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost1" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_ost1" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost2" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_ost2" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost3" type="number" group="sum" part-id="45676-44864-expr_51312_TEST">
          <fact condition="is_ost3" column="isv_ad_evd_count" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_late" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_everyday_col_n" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_evd_col_no_fact" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost1" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="new_ost" condition="is_ost1" />
        </call>
        <call group="sum" type="number" as="new_ost2" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="new_ost" condition="is_ost2" />
        </call>
        <call group="sum" type="number" as="new_ost3" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="new_ost" condition="is_ost3" />
        </call>
        <call group="sum" type="number" as="new_cnt" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_evd_count" condition="is_new" />
        </call>
        <call group="sum" type="number" as="cur_cnt" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_evd_count" condition="is_curr" />
        </call>
        <call group="sum" type="number" as="cur_cnt_rab" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="cur_cnt" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="cur_cnt_norab" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="cur_cnt" condition="is_norab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_rab" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="col_fact_week" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_norab" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="col_fact_week" condition="is_norab" />
        </call>
        <call function="and" as="is_not_in_cur" dontpushpred="1" part-id="45676-44864-expr_51312_TEST">
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call group="sum" type="number" as="exclude_from_vks" function="()" part-id="45676-44864-expr_51312_TEST">
          <fact column="isv_ad_evd_count" condition="is_not_in_cur" />
        </call>
        <call function="over" type="number" title=" " group="max" as="filial_curr" part-id="45676-44864-expr_51312_TEST">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="ipr_kod_ispolnit" column="kod_direct">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="filial_week" part-id="45676-44864-expr_51312_TEST">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="ipr_kod_ispolnit" column="kod_direct">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" part-id="45676-44864-select_51312_TEST" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" part-id="45676-44864-select_51312_TEST" />
        <call function="||" as="list_name" part-id="45676-44864-select_51312_TEST">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" />
        </call>
        <column table="kod_isv_ad_evd" column="st_det" as="st" group="max" part-id="45676-44864-select_51312_TEST" exclude="1" />
        <call as="st" title="Статус" group="max" function="()" part-id="45676-44864-select_51312_TEST" type="string">
          <usepart part="45676-49578-column-Status" />
        </call>
        <fact column="col_fact_week" nvl="0" group="sum" title="Кол-во на начало периода" part-id="45676-44864-select_51312_TEST" />
        <fact column="col_fact_curr" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="col_f_curr" nvl="0" group="sum" title="в АТП" part-id="45676-44864-select_51312_TEST" />
        <fact nvl="0" group="sum" title="в Приост" column="col_i_curr" part-id="45676-44864-select_51312_TEST" />
        <fact column="col_l_2_curr" nvl="0" group="sum" title="в Претенз" part-id="45676-44864-select_51312_TEST" />
        <fact column="col_l_curr" nvl="0" group="sum" title="в Расторг" part-id="45676-44864-select_51312_TEST" />
        <fact column="col_p_curr" nvl="0" group="sum" title="в РВУН" part-id="45676-44864-select_51312_TEST" />
        <fact column="late" nvl="0" group="sum" title="в Просроченные" part-id="45676-44864-select_51312_TEST" />
        <fact column="ost1" nvl="0" group="sum" title="в Остаток (период1)" part-id="45676-44864-select_51312_TEST" />
        <fact column="ost2" nvl="0" group="sum" title="в Остаток (период2)" part-id="45676-44864-select_51312_TEST" />
        <fact column="ost3" nvl="0" group="sum" title="в Остаток (период3)" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_col_f" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact nvl="0" group="sum" column="new_col_i" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_col_l2" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_col_l" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_col_p" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_late" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_ost1" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_ost2" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="new_ost3" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="fl_build_curr" group="max" part-id="45676-44864-select_51312_TEST" />
        <fact column="fl_build_week" group="max" part-id="45676-44864-select_51312_TEST" />
        <call function="year" as="year_zakl" group="max" part-id="45676-44864-select_51312_TEST">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact table="evd2" group="sum" column="cur_cnt" part-id="45676-44864-select_51312_TEST" />
        <fact table="evd2" as="week_cnt" group="sum" column="col_fact_week" part-id="45676-44864-select_51312_TEST" />
        <fact table="evd2" as="evd_cnt" group="sum" column="isv_ad_evd_count" part-id="45676-44864-select_51312_TEST" />
        <fact table="evd2" group="sum" column="cur_cnt_rab" part-id="45676-44864-select_51312_TEST" nvl="0" />
        <fact table="evd2" group="sum" column="cur_cnt_norab" part-id="45676-44864-select_51312_TEST" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_rab" part-id="45676-44864-select_51312_TEST" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_norab" part-id="45676-44864-select_51312_TEST" nvl="0" />
        <fact column="new_cnt" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <column table="evd_fl_build_real" column="val" as="fl_build_real" part-id="45676-44864-select_51312_TEST" />
        <call function="if" as="to_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select_51312_TEST">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select_51312_TEST">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <fact column="exclude_from_vks" nvl="0" group="sum" part-id="45676-44864-select_51312_TEST" />
        <fact column="filial_curr" group="max" part-id="45676-44864-select_51312_TEST" />
        <fact column="filial_week" group="max" part-id="45676-44864-select_51312_TEST" />
        <call function="if" as="to_filial" type="number" group="sum" nvl="0" part-id="45676-44864-select_51312_TEST">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_filial_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select_51312_TEST">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week_rab" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_filial_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select_51312_TEST">
          <call function="and">
            <call function="!=">
              <fact column="filial_week" table="evd2" />
              <fact column="filial_curr" table="evd2" />
            </call>
            <call function="=">
              <fact table="evd2" column="col_fact_week_norab" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" part-id="45676-44864-qube_51312_TEST" />
          <link name="kod_isv_ad_evd" part-id="45676-44864-qube_51312_TEST" />
          <link name="evd_otch_list_3" part-id="45676-44864-qube_51312_TEST" />
          <link name="evd_dt_contract" part-id="45676-44864-qube_51312_TEST" />
          <link name="evd_pr_hoz_sposob" part-id="45676-44864-qube_51312_TEST" />
          <link name="evd_pr_exist_pd" part-id="45676-44864-qube_51312_TEST" />
          <link name="id_slice" part-id="45676-44864-qube_51312_TEST" />
          <where part-id="45676-44864-qube_51312_TEST">
            <call function="and">
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </call>
          </where>
          <dimset as="evd2" part-id="45676-44864-qube_51312_TEST">
            <link name="evd_fl_build_real" />
            <where exclude="1">
              <call function="=">
                <const>1</const>
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset title="с работами" as="rab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'rab_'</const>
          </usepart>
        </grset>
        <grset title="без работ" as="norab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'norab_'</const>
          </usepart>
        </grset>
        <grset title="новые с работами" as="rab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="новые без работ" as="norab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из безработных" as="from_norab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из работных" as="from_rab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset as="by_dep" title="По филиалам" order="name_podr" exclude="1">
          <usepart part="45676-44864-grsets">
            <const>'dep_'</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="dep_rab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="evd_cnt" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="dep_norab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="dep_rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="dep_norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="dep_from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="dep_from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-dep_51312_TEST" timestamp="18.01.2019 09:22:23" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <usepart part="45676-44864-expr_51312_TEST" />
      </expressions>
      <select>
        <usepart part="45676-44864-select_51312_TEST" />
        <usepart part="45676-title_select_from_params" />
      </select>
      <from>
        <qube>
          <usepart part="45676-44864-qube_51312_TEST" />
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="by_dep" title="По филиалам" order="name_podr">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="rab">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build_real" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="norab">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build_real" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column column="fl_build_week" table="this" />
                </call>
                <call function="=">
                  <column column="fl_build_curr" table="this" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="col_fact_week" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="col_fact_week" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105_dzo" timestamp="14.01.2020 11:32:16" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call as="is_hoz" dontpushpred="1" function="=1">
          <column column="val" table="evd_pr_hoz_sposob" />
        </call>
        <call as="is_podr_dog" dontpushpred="1" function="=1">
          <call function="if" title="подр. дог не хоз. спос." type="number">
            <call function="=0">
              <column column="val" table="evd_pr_hoz_sposob" />
            </call>
            <column column="val" table="evd_pr_exist_pd" />
          </call>
        </call>
        <call function="=1" as="is_mixed" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_mixed" column="val" />
          </call>
        </call>
        <call as="is_not_hs_pd" dontpushpred="1" function="and" exclude="1">
          <call as="is_not_hs_pd" dontpushpred="1" function="=0">
            <column column="val" table="evd_pr_hoz_sposob" />
          </call>
          <call as="is_not_hs_pd" dontpushpred="1" function="=0">
            <call function="if" title="подр. дог не хоз. спос." type="number">
              <call function="=0">
                <column column="val" table="evd_pr_hoz_sposob" />
              </call>
              <column column="val" table="evd_pr_exist_pd" />
            </call>
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_mixed" column="val" />
            </call>
          </call>
        </call>
        <call as="is_sou_nxt1_2" dontpushpred="1" function="and">
          <call exclude="1" function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="next_Q_year" />
          </call>
          <call exclude="1" function="ge">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call exclude="1" function="month">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
          <call function="=">
            <call function="trunc">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call dontpushpred="1" exclude="1" function="ge">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call dontpushpred="1" function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call dontpushpred="1" function="le">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call as="is_sou_pr" dontpushpred="1" function="and">
          <call function="lt">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call dontpushpred="1" function="le">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_mon1" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call as="is_sou_mon2" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call as="is_sou_mon3" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call as="is_sou_mon4" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call as="is_sou_mon5" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call as="is_sou_mon6" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call as="is_sou_mon7" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call as="is_sou_mon8" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call as="is_sou_mon9" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call as="is_sou_mon10" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call as="is_sou_mon11" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call as="is_sou_mon12" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call as="is_sou_kv" dontpushpred="1" exclude="1" function="lt">
          <call function="trunc">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call as="col_any_fact_hoz" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call as="col_any_fact_pd" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call as="col_any_fact_not_hs_pd" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call as="col_no_fact_nxt1_2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call as="col_no_fact_cur" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call as="col_no_fact_nxt2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call as="col_no_fact_nxt3" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call as="col_no_fact_cur_hoz" function="()" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call as="col_no_fact_cur_pd" function="()" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call as="col_no_fact_cur_not_hs_pd" function="()" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call as="col_no_fact_pr" function="()" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call as="col_no_fact_pr_hoz" function="()" group="sum" type="number">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call as="col_no_fact_pr_pd" function="()" group="sum" type="number">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call as="col_no_fact_pr_not_hs_pd" function="()" group="sum" type="number">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call as="col_no_fact_mon0" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call as="col_no_fact_mon1" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call as="col_no_fact_mon2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call as="col_no_fact_mon3" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call as="col_no_fact_mon4" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call as="col_no_fact_mon5" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call as="col_no_fact_mon6" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call as="col_no_fact_mon7" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call as="col_no_fact_mon8" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call as="col_no_fact_mon9" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call as="col_no_fact_mon10" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call as="col_no_fact_mon11" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call as="col_no_fact_mon12" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call as="is_cur" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call as="is_week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call as="is_3week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call as="is_2week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call as="col_any_fact_week" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call as="is_fact_week" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column column="col_any_fact" table="kod_isv_ad_evd" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="col_any_fact_3week" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call as="col_any_fact_2to1w" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call as="is_sou_changed1_1" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column column="srok_uslug" table="kod_isv_ad_evd" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_changed1_2" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call dontpushpred="1" function="and">
            <call exclude="1" function="=">
              <call function="year">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_year" />
            </call>
            <call exclude="1" function="ge">
              <call function="month">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_1st_month" />
            </call>
            <call function="=">
              <call function="trunc">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column column="srok_uslug" table="kod_isv_ad_evd" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_changed2" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call exclude="1" function="ge">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column column="srok_uslug" table="kod_isv_ad_evd" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call exclude="1" function="lt">
                      <call function="year">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_year" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou2019p" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call exclude="1" function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column column="col_n" table="kod_isv_ad_evd" />
                        <column column="col_p_2" table="kod_isv_ad_evd" />
                      </call>
                      <const>0</const>
                    </call>
                    <call exclude="1" function="=">
                      <call function="year">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call exclude="1" function="ge">
                      <call function="month">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column column="col_n" table="kod_isv_ad_evd" />
              <column column="col_p_2" table="kod_isv_ad_evd" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call as="is_ispoln" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column column="col_n" table="kod_isv_ad_evd" />
              <column column="col_p_2" table="kod_isv_ad_evd" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column column="col_n" table="kod_isv_ad_evd" />
                        <column column="col_p_2" table="kod_isv_ad_evd" />
                      </call>
                      <const>0</const>
                    </call>
                    <call exclude="1" function="=">
                      <call function="year">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call exclude="1" function="ge">
                      <call function="month">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_vost" comment="вернулось из факта в остаток" dontpushpred="1" exclude="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column column="col_n" table="kod_isv_ad_evd" />
              <column column="col_p_2" table="kod_isv_ad_evd" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column column="col_n" table="kod_isv_ad_evd" />
                        <column column="col_p_2" table="kod_isv_ad_evd" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column column="srok_uslug" table="kod_isv_ad_evd" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call exclude="1" function="month">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_nxt1_1_plus" comment="договоров не было в данных на начало недели" dontpushpred="1" exclude="1" function="and">
          <call function="and">
            <call function="=">
              <column column="id_slice" table="kod_isv_ad_evd" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column column="col_n" table="kod_isv_ad_evd" />
                <column column="col_p_2" table="kod_isv_ad_evd" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call exclude="1" function="month">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column column="id_slice" table="kod_isv_ad_evd" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_nxt1_1_minus" comment="договоров не стало в данных на тек дату" dontpushpred="1" exclude="1" function="and">
          <call function="and">
            <call function="=">
              <column column="id_slice" table="kod_isv_ad_evd" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column column="col_n" table="kod_isv_ad_evd" />
                <column column="col_p_2" table="kod_isv_ad_evd" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column column="srok_uslug" table="kod_isv_ad_evd" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call exclude="1" function="month">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column column="id_slice" table="kod_isv_ad_evd" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="sou_changed1_1" function="()" group="sum" title="было СОУ 1кв2018 - продлено" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call as="sou_changed1_2" function="()" group="sum" title="продлено на 2-4кв.2018" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call as="sou_changed2" function="()" group="sum" title="продлено на 2019" type="number">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call as="sou_unchanged_week" function="-nvl" group="sum" nvl="0" title="Факт за неделю в т.ч. без продления">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" exclude="1" nvl="0" />
          <fact column="sou_changed2" exclude="1" nvl="0" />
        </call>
        <call as="col_no_fact_nxt1_2_week" function="()" group="sum" type="number">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call as="col_no_fact_nxt1_1_ispoln" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call as="col_no_fact_nxt1_2_to_2019" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом" exclude="1" function="-nvl" group="sum">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call as="is_not_fl_reestr_2018_fact" function="!=">
          <column column="fl_reestr_2018_fact" table="kod_isv_ad_evd" />
          <const>1</const>
        </call>
        <call as="col_any_fact_2018" function="()" group="sum" title="Исполнено за 2018 год" type="number">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call as="col_any_fact_hoz_2018" function="()" group="sum" type="number">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call as="col_any_fact_pd_2018" function="()" group="sum" type="number">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call as="col_any_fact_not_hs_pd_2018" function="()" group="sum" type="number">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call as="col_any_fact_week_diff" function="-nvl" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact" condition="is_week" />
        </call>
        <call function="()" as="col_any_fact_mixed" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_cur_mixed" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_pr_mixed" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_mixed" />
        </call>
        <call group="sum" as="col_any_fact_mixed_2018" type="number" function="()">
          <fact column="col_any_fact_mixed" condition="is_not_fl_reestr_2018_fact" />
        </call>
      </expressions>
      <select>
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="ipr_kod_ispolnit" column="kod_direct" exclude="1" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" exclude="1" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" exclude="1" />
        <column table="ipr_kod_ispolnit" column="fl_branch" exclude="1" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="kod_org_active" column="kod" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="kod_org_active" column="kod" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" exclude="1" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
        <fact column="col_any_fact_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact group="sum" table="evd_cur" column="col_any_fact_mixed_2018" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" exclude="1" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_mixed" />
          <link name="id_slice" />
          <link name="kod_org_active" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="kod_org_active" column="kod" />
                <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="kod_org_active" column="kod" />
                <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="dzo">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="kod_org_active" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="dzo">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="kod_org_active" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="dzo">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="kod_org_active" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105_w_dzo" timestamp="02.07.2019 14:35:14" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
          </call>
          <call function="ge" exclude="1">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
          <call function="=">
            <call function="trunc">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_nxt3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=" exclude="1">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
            </call>
            <call function="ge" exclude="1">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
            </call>
            <call function="=">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="lt" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток" exclude="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом" exclude="1">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff">
          <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact" condition="is_week" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="kod_org_active" column="kod" />
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" exclude="1" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <link name="kod_org_active" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where>
              <call function="in">
                <column table="this" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where>
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where>
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="by_dep_dzo" title="По филиалам" order="dzo">
            <where>
              <call function="in">
                <column table="this" column="kod" />
                <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
              </call>
            </where>
            <group>
              <sourcelink table="kod_org_active" />
            </group>
          </grset>
          <grset as="all_p_dzo" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p_dzo" title="По филиалам" order="dzo">
              <where>
                <call function="in">
                  <column table="this" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
              </where>
              <group>
                <sourcelink table="kod_org_active" />
              </group>
            </grset>
          </grset>
          <grset as="all_h_dzo" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h_dzo" title="По филиалам" order="dzo">
              <where>
                <call function="in">
                  <column table="this" column="kod" />
                  <const comment="ЦЭК, Курортэнерго">(22, 23)</const>
                </call>
              </where>
              <group>
                <sourcelink table="kod_org_active" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-detail_q" timestamp="28.10.2019 20:48:10" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <select>
        <column table="kod_isv_ad_evd" column="kod_ad_everyday" key="1" />
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" title="-" />
        <column table="kod_isv_ad_evd" column="kod_dop_contract" title="-" />
        <column table="kod_direct" column="kod_direct" title="-" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" title="-" />
        <column table="kod_direct" column="fl_branch" title="-" />
        <call function="||" as="year_gr1_name1" title="-">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="kod_direct" column="name" as="name_podr" title="-" />
        <column table="kod_isv_ad_evd" column="fl_build_real" title="-" as="fl_build" />
        <call function="year" as="year_zakl" title="-">
          <column table="kod_isv_ad_evd" column="dt_contract" title="-" />
        </call>
        <call function="year" as="year_otch" title="-">
          <useparam name="date_otch" />
        </call>
        <call function="-nvl" as="dyear" title="-">
          <column table="this" column="year_otch" />
          <column table="this" column="year_zakl" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" title="-">
          <column table="this" column="year_otch" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" title="-">
          <column table="this" column="year_otch" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" title="-" />
        <column table="kod_isv_ad_evd" column="podr_name_titul" title="-" />
        <column table="kod_isv_ad_evd" column="otch_list_3" title="-" />
        <column table="kod_isv_ad_evd" column="pr_ofz_vkl" title="-" />
        <column table="kod_isv_ad_evd" column="pr_hoz_sposob" title="-" />
        <column table="kod_isv_ad_evd" column="pr_exist_pd" title="-" />
        <column table="kod_isv_ad_evd" column="kod_list7" title="-" />
        <column table="kod_isv_ad_evd" column="kodres" title="-" comment="is_spr_direct" />
        <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
        <column table="is_ad_all" column="num_req" title="№ заявки" />
        <column table="is_ad_all" column="contr_sumf" />
        <column table="is_ad_all" column="contr_sum_m" />
        <column table="is_ad_all" column="contr_sum_e" />
        <column table="is_ad_all" column="contr_opl" />
        <column table="is_ad_all" column="contr_opl_d" />
        <column table="is_ad_all" column="contr_opl_i" />
        <column table="is_ad_all" column="zadol_opl" />
        <column table="is_ad_all" column="zadol_d" />
        <column table="is_ad_all" column="zadol_i" />
        <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
        <column table="is_ad_all" column="name_all" />
        <column table="is_ad_all" column="name_zayav" />
        <column table="is_ad_all" column="dt_contract" />
        <column table="is_ad_all" column="srok_uslug" />
        <column table="is_ad_all" column="fl_build" title="Наличие работ ЛЭ" as="fl_build2" />
        <column table="is_ad_all" column="name_obj" />
        <column table="is_ad_all" column="kn_zone" />
        <column table="is_ad_all" column="filial" />
        <column table="is_ad_all" column="lp_addr" />
        <column table="is_ad_all" column="load123" />
        <column table="is_ad_all" column="load1" />
        <column table="is_ad_all" column="load2" />
        <column table="is_ad_all" column="load3" />
        <column table="is_ad_all" column="sum_load" title="Суммарная мощность" />
        <column table="is_ad_all" column="load_units" />
        <call function="rtrim" as="load_safe_cat" title="Категория надежности (заявл.)" type="string">
          <call function="case">
            <call function="when">
              <call function="gt">
                <call function="+nvl">
                  <column table="is_ad_all" column="load1" />
                  <column table="is_ad_all" column="load2" />
                  <column table="is_ad_all" column="load3" />
                </call>
                <const>0</const>
              </call>
              <call function="||">
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load1" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'1, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load2" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'2, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load3" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'3, '</const>
                </call>
              </call>
            </call>
            <call function="when">
              <call function="gt">
                <call function="+nvl">
                  <column table="is_ad_all" column="load_sum1" />
                  <column table="is_ad_all" column="load_sum2" />
                  <column table="is_ad_all" column="load_sum3" />
                </call>
                <const>0</const>
              </call>
              <call function="||">
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum1" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'1, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum2" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'2, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum3" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'3, '</const>
                </call>
              </call>
            </call>
            <call function="else">
              <const>'3'</const>
            </call>
          </call>
          <const>', '</const>
        </call>
        <column table="is_ad_all" column="supply" />
        <column table="is_ad_all" column="supply1" />
        <column table="is_ad_all" column="name_status" />
        <column table="is_ad_all" column="vid_atp" />
        <column table="is_ad_all" column="dt_reg" title="Дата регистр. АТП" />
        <column table="is_ad_all" column="fl_rnk_not" />
        <column table="is_ad_all" column="read_to_close" />
        <column table="is_ad_all" column="dat_read_to_close" />
        <column table="is_ad_all" column="got_to_close" />
        <column table="is_ad_all" column="dat_got_to_close" />
        <column table="is_ad_all" column="status_ofz" />
        <column table="is_ad_all" column="vid_opl_ad" />
        <column table="is_ad_all" column="spos_vip" />
        <call function="-nvl" as="contr_sumf_ost" title="Остаток выручки">
          <column table="is_ad_all" column="contr_sumf" />
          <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
        </call>
        <call function="||" as="key" title="ключ">
          <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
          <column table="is_ad_all" column="num_req" title="№ заявки" />
        </call>
        <call function="case" as="sou_state" title="СОУ наступил/не наступил" type="string">
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_f" />
              <const>1</const>
            </call>
            <const>'Выдан постоянный АТП'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l" />
              <const>1</const>
            </call>
            <const>'Расторгнут'</const>
          </call>
          <call function="when">
            <call function="lt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_otch" />
            </call>
            <const>'Просрочен'</const>
          </call>
          <call function="else">
            <const>'Текущий'</const>
          </call>
        </call>
        <call function="case" as="sou_state_reason" title="Причина нарушения СОУ" type="string" comment="причина нарушения СОУ - алгоритм заполнения в заявке 44535">
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_f" />
              <const>1</const>
            </call>
            <const>'Выполнен'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l" />
              <const>1</const>
            </call>
            <const>'Расторгнут'</const>
          </call>
          <call function="when">
            <call function="ge">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_otch" />
            </call>
            <const>'Текущий'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="is_ad_all" column="vid_opl_ad" />
              <const>'ОДИ'</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dt_contract" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_build_real" />
              <const>0</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dt_contract" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l_2" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dataizm" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_i" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dataizm" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dat_read_to_close" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="status" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="kod_isv_ad_evd" column="fl_build_real" />
                <const>1</const>
              </call>
              <call function="=">
                <column column="vid_opl_ad" table="is_ad_all" />
                <const>'ОД'</const>
              </call>
            </call>
            <call function="case">
              <call function="when">
                <call function="is not null">
                  <column table="is_ad_all" column="dat_got_to_close" />
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина обоюдная'</const>
              </call>
            </call>
          </call>
        </call>
        <band title="ВКС">
          <call function="over" as="status_vks_name_cur_x" title="Статус ВКС (текущий)">
            <call function="max">
              <call function="if">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <column table="kod_isv_ad_evd" column="status_vks_name" />
              </call>
            </call>
            <call function="partition by">
              <column table="kod_isv_ad_evd" column="kod_dop_contract" />
            </call>
          </call>
          <call function="over" as="status_vks_name_week_x" title="Статус ВКС (предыдущий)">
            <call function="max">
              <call function="if">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
                <column table="kod_isv_ad_evd" column="status_vks_name" />
              </call>
            </call>
            <call function="partition by">
              <column table="kod_isv_ad_evd" column="kod_dop_contract" />
            </call>
          </call>
          <call function="()" as="status_vks_name_cur_x" title="Статус ВКС (текущий)" exclude="1">
            <query>
              <select>
                <call function="max">
                  <column table="iae_cur" column="status_vks_name" />
                </call>
              </select>
              <from>
                <query name="isv_ad_everyday" as="iae_cur" />
              </from>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="iae_cur" column="kod_dop_contract" />
                    <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                  </call>
                  <call function="=">
                    <column table="iae_cur" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                </call>
              </where>
            </query>
          </call>
          <call function="()" as="status_vks_name_week_x" title="Статус ВКС (предыдущий)" exclude="1">
            <query>
              <select>
                <call function="max">
                  <column table="iae_cur" column="status_vks_name" />
                </call>
              </select>
              <from>
                <query name="isv_ad_everyday" as="iae_cur" />
              </from>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="iae_cur" column="kod_dop_contract" />
                    <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                  </call>
                  <call function="=">
                    <column table="iae_cur" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                </call>
              </where>
            </query>
          </call>
          <call function="if" as="podr_me_name" title="Перечень МЭ РС/ДСО" type="string">
            <call function="=">
              <column table="kod_isv_ad_evd" column="otch_list" />
              <const>1</const>
            </call>
            <column table="kod_isv_ad_evd" column="podr_name_titul" />
          </call>
          <call function="to_char" title="Год договора" as="dog_year">
            <call function="year">
              <column column="dt_contract" table="is_ad_all" />
            </call>
          </call>
        </band>
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
        <column table="is_ad_all" column="name_rs" />
        <column table="is_ad_all" column="name_mo" />
        <column table="is_ad_all" column="name_sp" />
        <column table="is_ad_all" column="name_np" />
        <call function="nvl" as="name_rs_nvl" type="string">
          <column table="kodres" column="name" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_mo_nvl" type="string">
          <column table="this" column="name_mo" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_sp_nvl" type="string">
          <column table="this" column="name_sp" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_np_nvl" type="string">
          <column table="this" column="name_np" />
          <const>'не заполнено'</const>
        </call>
        <column table="kod_isv_ad_evd" column="name_kr" />
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="kod_org_active" column="kod" />
      </select>
      <from>
        <query name="isv_ad_everyday" as="kod_isv_ad_evd">
          <link name="kodres" />
          <link name="kod_direct" />
          <link name="is_ad_all" />
          <link name="kod_dt_cont_grp1" />
        </query>
        <query name="is_org_active" as="kod_org_active" join="left outer">
          <call function="=">
            <column table="kod_isv_ad_evd" column="kod_org_active" />
            <column table="kod_org_active" column="kod" />
          </call>
        </query>
      </from>
    </query>
    <query name="45676-detail-test_q" timestamp="29.10.2019 14:20:18" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <print-templates>
        <excel>
          <template name="45676-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <select>
        <column table="kod_isv_ad_evd" column="kod_ad_everyday" key="1" />
        <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" title="-" />
        <column table="kod_isv_ad_evd" column="kod_dop_contract" title="-" />
        <column table="kod_direct" column="kod_direct" title="-" />
        <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" title="-" />
        <column table="kod_direct" column="fl_branch" title="-" />
        <call function="||" as="year_gr1_name1" title="-">
          <const>'Заключенные '</const>
          <column table="kod_dt_cont_grp1" column="name1" />
        </call>
        <column table="kod_direct" column="name" as="name_podr" title="-" />
        <column table="kod_isv_ad_evd" column="fl_build_real" title="-" as="fl_build" />
        <call function="year" as="year_zakl" title="-">
          <column table="kod_isv_ad_evd" column="dt_contract" title="-" />
        </call>
        <call function="year" as="year_otch" title="-">
          <useparam name="date_otch" />
        </call>
        <call function="-nvl" as="dyear" title="-">
          <column table="this" column="year_otch" />
          <column table="this" column="year_zakl" />
        </call>
        <call function="-nvl" type="number" as="prev_year1" title="-">
          <column table="this" column="year_otch" />
          <const>1</const>
        </call>
        <call function="-nvl" type="number" as="prev_year2" title="-">
          <column table="this" column="year_otch" />
          <const>2</const>
        </call>
        <column table="kod_isv_ad_evd" column="otch_list" title="-" />
        <column table="kod_isv_ad_evd" column="podr_name_titul" title="-" />
        <column table="kod_isv_ad_evd" column="otch_list_3" title="-" />
        <column table="kod_isv_ad_evd" column="pr_ofz_vkl" title="-" />
        <column table="kod_isv_ad_evd" column="pr_hoz_sposob" title="-" />
        <column table="kod_isv_ad_evd" column="pr_exist_pd" title="-" />
        <column table="kod_isv_ad_evd" column="kod_list7" title="-" />
        <column table="kod_isv_ad_evd" column="kodres" title="-" comment="is_spr_direct" />
        <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
        <column table="is_ad_all" column="num_req" title="№ заявки" />
        <column table="is_ad_all" column="contr_sumf" />
        <column table="is_ad_all" column="contr_sum_m" />
        <column table="is_ad_all" column="contr_sum_e" />
        <column table="is_ad_all" column="contr_opl" />
        <column table="is_ad_all" column="contr_opl_d" />
        <column table="is_ad_all" column="contr_opl_i" />
        <column table="is_ad_all" column="zadol_opl" />
        <column table="is_ad_all" column="zadol_d" />
        <column table="is_ad_all" column="zadol_i" />
        <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
        <column table="is_ad_all" column="name_all" />
        <column table="is_ad_all" column="name_zayav" />
        <column table="is_ad_all" column="dt_contract" />
        <column table="is_ad_all" column="srok_uslug" />
        <column table="is_ad_all" column="fl_build" title="Наличие работ ЛЭ" as="fl_build2" />
        <column table="is_ad_all" column="name_obj" />
        <column table="is_ad_all" column="kn_zone" />
        <column table="is_ad_all" column="filial" />
        <column table="is_ad_all" column="lp_addr" />
        <column table="is_ad_all" column="load123" />
        <column table="is_ad_all" column="load1" />
        <column table="is_ad_all" column="load2" />
        <column table="is_ad_all" column="load3" />
        <column table="is_ad_all" column="sum_load" title="Суммарная мощность" />
        <column table="is_ad_all" column="load_units" />
        <call function="rtrim" as="load_safe_cat" title="Категория надежности (заявл.)" type="string">
          <call function="case">
            <call function="when">
              <call function="gt">
                <call function="+nvl">
                  <column table="is_ad_all" column="load1" />
                  <column table="is_ad_all" column="load2" />
                  <column table="is_ad_all" column="load3" />
                </call>
                <const>0</const>
              </call>
              <call function="||">
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load1" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'1, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load2" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'2, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load3" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'3, '</const>
                </call>
              </call>
            </call>
            <call function="when">
              <call function="gt">
                <call function="+nvl">
                  <column table="is_ad_all" column="load_sum1" />
                  <column table="is_ad_all" column="load_sum2" />
                  <column table="is_ad_all" column="load_sum3" />
                </call>
                <const>0</const>
              </call>
              <call function="||">
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum1" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'1, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum2" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'2, '</const>
                </call>
                <call function="if">
                  <call function="gt">
                    <call function="nvl0">
                      <column table="is_ad_all" column="load_sum3" />
                    </call>
                    <const>0</const>
                  </call>
                  <const>'3, '</const>
                </call>
              </call>
            </call>
            <call function="else">
              <const>'3'</const>
            </call>
          </call>
          <const>', '</const>
        </call>
        <column table="is_ad_all" column="supply" />
        <column table="is_ad_all" column="supply1" />
        <column table="is_ad_all" column="name_status" />
        <column table="is_ad_all" column="vid_atp" />
        <column table="is_ad_all" column="dt_reg" title="Дата регистр. АТП" />
        <column table="is_ad_all" column="fl_rnk_not" />
        <column table="is_ad_all" column="read_to_close" />
        <column table="is_ad_all" column="dat_read_to_close" />
        <column table="is_ad_all" column="got_to_close" />
        <column table="is_ad_all" column="dat_got_to_close" />
        <column table="is_ad_all" column="status_ofz" />
        <column table="is_ad_all" column="vid_opl_ad" />
        <column table="is_ad_all" column="spos_vip" />
        <call function="-nvl" as="contr_sumf_ost" title="Остаток выручки">
          <column table="is_ad_all" column="contr_sumf" />
          <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
        </call>
        <call function="||" as="key" title="ключ">
          <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
          <column table="is_ad_all" column="num_req" title="№ заявки" />
        </call>
        <call function="case" as="sou_state" title="СОУ наступил/не наступил" type="string">
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_f" />
              <const>1</const>
            </call>
            <const>'Выдан постоянный АТП'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l" />
              <const>1</const>
            </call>
            <const>'Расторгнут'</const>
          </call>
          <call function="when">
            <call function="lt">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_otch" />
            </call>
            <const>'Просрочен'</const>
          </call>
          <call function="else">
            <const>'Текущий'</const>
          </call>
        </call>
        <call function="case" as="sou_state_reason" title="Причина нарушения СОУ" type="string" comment="причина нарушения СОУ - алгоритм заполнения в заявке 44535">
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_f" />
              <const>1</const>
            </call>
            <const>'Выполнен'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l" />
              <const>1</const>
            </call>
            <const>'Расторгнут'</const>
          </call>
          <call function="when">
            <call function="ge">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_otch" />
            </call>
            <const>'Текущий'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="is_ad_all" column="vid_opl_ad" />
              <const>'ОДИ'</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dt_contract" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_build_real" />
              <const>0</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dt_contract" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l_2" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dataizm" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_i" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dataizm" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p" />
              <const>1</const>
            </call>
            <call function="case">
              <call function="when">
                <call function="lt">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <call function="trunc" type="date">
                    <column column="dat_read_to_close" table="is_ad_all" />
                  </call>
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина заявителя'</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="status" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="kod_isv_ad_evd" column="fl_build_real" />
                <const>1</const>
              </call>
              <call function="=">
                <column column="vid_opl_ad" table="is_ad_all" />
                <const>'ОД'</const>
              </call>
            </call>
            <call function="case">
              <call function="when">
                <call function="is not null">
                  <column table="is_ad_all" column="dat_got_to_close" />
                </call>
                <const>'Вина СО'</const>
              </call>
              <call function="else">
                <const>'Вина обоюдная'</const>
              </call>
            </call>
          </call>
        </call>
        <band title="ВКС">
          <call function="over" as="status_vks_name_cur_x" title="Статус ВКС (текущий)" exclude="1">
            <call function="max">
              <call function="if">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <column table="kod_isv_ad_evd" column="status_vks_name" />
              </call>
            </call>
            <call function="partition by">
              <column table="kod_isv_ad_evd" column="kod_dop_contract" />
            </call>
          </call>
          <call function="over" as="status_vks_name_week_x" title="Статус ВКС (предыдущий)" exclude="1">
            <call function="max">
              <call function="if">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
                <column table="kod_isv_ad_evd" column="status_vks_name" />
              </call>
            </call>
            <call function="partition by">
              <column table="kod_isv_ad_evd" column="kod_dop_contract" />
            </call>
          </call>
          <call function="()" as="status_vks_name_cur_x" title="Статус ВКС (текущий)">
            <query>
              <select>
                <call function="max">
                  <column table="iae_cur" column="status_vks_name" />
                </call>
              </select>
              <from>
                <query name="isv_ad_everyday" as="iae_cur" />
              </from>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="iae_cur" column="kod_dop_contract" />
                    <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                  </call>
                  <call function="=">
                    <column table="iae_cur" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                </call>
              </where>
            </query>
          </call>
          <call function="()" as="status_vks_name_week_x" title="Статус ВКС (предыдущий)">
            <query>
              <select>
                <call function="max">
                  <column table="iae_cur" column="status_vks_name" />
                </call>
              </select>
              <from>
                <query name="isv_ad_everyday" as="iae_cur" />
              </from>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="iae_cur" column="kod_dop_contract" />
                    <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                  </call>
                  <call function="=">
                    <column table="iae_cur" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                </call>
              </where>
            </query>
          </call>
          <call function="if" as="podr_me_name" title="Перечень МЭ РС/ДСО" type="string">
            <call function="=">
              <column table="kod_isv_ad_evd" column="otch_list" />
              <const>1</const>
            </call>
            <column table="kod_isv_ad_evd" column="podr_name_titul" />
          </call>
          <call function="to_char" title="Год договора" as="dog_year">
            <call function="year">
              <column column="dt_contract" table="is_ad_all" />
            </call>
          </call>
        </band>
        <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
        <column table="kod_isv_ad_evd" column="kod_org_active" />
        <column table="kod_isv_ad_evd" column="status" />
        <column table="is_ad_all" column="name_rs" />
        <column table="is_ad_all" column="name_mo" />
        <column table="is_ad_all" column="name_sp" />
        <column table="is_ad_all" column="name_np" />
        <call function="nvl" as="name_rs_nvl" type="string">
          <column table="kodres" column="name" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_mo_nvl" type="string">
          <column table="this" column="name_mo" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_sp_nvl" type="string">
          <column table="this" column="name_sp" />
          <const>'не заполнено'</const>
        </call>
        <call function="nvl" as="name_np_nvl" type="string">
          <column table="this" column="name_np" />
          <const>'не заполнено'</const>
        </call>
        <column table="kod_isv_ad_evd" column="name_kr" />
        <column table="kod_org_active" column="name" as="dzo" />
        <column table="kod_org_active" column="kod" />
        <call function="case" type="string" title="Статус" as="st">
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_f" />
              <const>1</const>
            </call>
            <const>'АТП'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_i" />
              <const>1</const>
            </call>
            <const>'Приост'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l_2" />
              <const>1</const>
            </call>
            <const>'Претенз'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_l" />
              <const>1</const>
            </call>
            <const>'Расторг'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p" />
              <const>1</const>
            </call>
            <const>'РВУН'</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="col_n" />
                <const>1</const>
              </call>
              <call function="le">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <useparam name="date_end_cur_Q" />
              </call>
            </call>
            <const>'Просроч'</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="col_p_2" />
                <const>1</const>
              </call>
              <call function="le">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <useparam name="date_end_cur_Q" />
              </call>
            </call>
            <const>'Ост1'</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="col_p_2" />
                <const>1</const>
              </call>
              <call function="=">
                <call function="trunc">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <const>'Q'</const>
                </call>
                <useparam name="date_beg_next_Q" />
              </call>
              <call function="between" exclude="1">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <useparam name="date_beg_next_Q" />
                <useparam name="date_end_cur_Y" />
              </call>
            </call>
            <const>'Ост2'</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="=">
                <column table="kod_isv_ad_evd" column="col_p_2" />
                <const>1</const>
              </call>
              <call function="ge">
                <call function="trunc">
                  <column table="kod_isv_ad_evd" column="srok_uslug" />
                  <const>'Q'</const>
                </call>
                <useparam name="date_beg_cur_Q_pl2" />
              </call>
              <call function="ge" exclude="1">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <useparam name="date_beg_next_Y" />
              </call>
            </call>
            <const>'Ост3'</const>
          </call>
        </call>
        <call function="()" as="fl_build_curr">
          <query>
            <select>
              <call function="max">
                <column table="iae_cur" column="fl_build_real" />
              </call>
            </select>
            <from>
              <query name="isv_ad_everyday" as="iae_cur" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="iae_cur" column="kod_dop_contract" />
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
                <call function="=">
                  <column table="iae_cur" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </query>
        </call>
        <call function="()" as="fl_build_week">
          <query>
            <select>
              <call function="max">
                <column table="iae_cur" column="fl_build_real" />
              </call>
            </select>
            <from>
              <query name="isv_ad_everyday" as="iae_cur" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="iae_cur" column="kod_dop_contract" />
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
                <call function="=">
                  <column table="iae_cur" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
              </call>
            </where>
          </query>
        </call>
        <const type="number" as="col_fact_curr">1</const>
        <column table="kod_isv_ad_evd" column="fl_build_real" />
        <call function="()" as="filial_curr">
          <query>
            <select>
              <call function="max">
                <column table="iae_cur" column="kod_filial" />
              </call>
            </select>
            <from>
              <query name="isv_ad_everyday" as="iae_cur" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="iae_cur" column="kod_dop_contract" />
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
                <call function="=">
                  <column table="iae_cur" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
              </call>
            </where>
          </query>
        </call>
        <call function="()" as="filial_week">
          <query>
            <select>
              <call function="max">
                <column table="iae_cur" column="kod_filial" />
              </call>
            </select>
            <from>
              <query name="isv_ad_everyday" as="iae_cur" />
            </from>
            <where>
              <call function="and">
                <call function="=">
                  <column table="iae_cur" column="kod_dop_contract" />
                  <column table="kod_isv_ad_evd" column="kod_dop_contract" />
                </call>
                <call function="=">
                  <column table="iae_cur" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
              </call>
            </where>
          </query>
        </call>
      </select>
      <from>
        <query name="isv_ad_everyday" as="kod_isv_ad_evd">
          <link name="kodres" />
          <link name="kod_direct" />
          <link name="is_ad_all" />
          <link name="kod_dt_cont_grp1" />
        </query>
        <query name="is_org_active" as="kod_org_active" join="left outer">
          <call function="=">
            <column table="kod_isv_ad_evd" column="kod_org_active" />
            <column table="kod_org_active" column="kod" />
          </call>
        </query>
      </from>
    </query>
    <query name="45676-43105_unstable" timestamp="02.10.2020 02:11:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="=1" as="is_mixed" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_mixed" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_mixed" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
          </call>
          <call function="ge" exclude="1">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
          <call function="=">
            <call function="trunc">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call function="ge" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_mixed" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_mixed" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_fl_build" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_fb" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_work_pu" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_pu" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_cur_both" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact_fb_pu" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_nxt3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_mixed" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_fl_build" type="number" group="sum">
          <fact column="col_no_fact_cur_fl_build" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_work_pu" type="number" group="sum">
          <fact column="col_no_fact_cur_work_pu" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_both" type="number" group="sum">
          <fact column="col_no_fact_cur_both" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_mixed" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_mixed" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=" exclude="1">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
            </call>
            <call function="ge" exclude="1">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
            </call>
            <call function="=">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                    <call function="lt" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge" exclude="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=" exclude="1">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                    </call>
                    <call function="ge" exclude="1">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток" exclude="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату" exclude="1">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом" exclude="1">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_fl_build" title="Исполнено за 2018 год ниже 35" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_work_pu" title="Исполнено за 2018 год на ПУ" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_2018_both" title="Исполнено за 2018 год ниже 35 и на ПУ" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_mixed_2018" type="number" function="()">
          <fact column="col_any_fact_mixed" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff">
          <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_fb">
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_fb" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_pu">
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_pu" condition="is_week" />
        </call>
        <call function="-nvl" group="sum" as="col_any_fact_week_diff_both">
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_cur" />
          <fact column="isv_ad_evd_col_any_fact_fb_pu" condition="is_week" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_fb" as="col_no_fact_fb" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_pu" as="col_no_fact_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact_fb_pu" as="col_no_fact_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_fl_build" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_work_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_fl_build" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_work_pu" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_both" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_mixed" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" exclude="1" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_fl_build" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_work_pu" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018_both" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_mixed_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_fb" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_pu" group="sum" />
        <fact table="evd" column="col_any_fact_week_diff_both" group="sum" />
        <call function="+nvl" group="sum" as="col_any_fact_week_diff_fb_both" type="number">
          <fact table="evd" column="col_any_fact_week_diff_fb" />
          <fact table="evd" column="col_any_fact_week_diff_both" />
        </call>
        <column table="is_filial_plan" column="nw_less" group="sum" as="plan_nw_less" />
        <column table="is_filial_plan" column="nw_more" group="sum" as="plan_nw_more" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="evd_pr_mixed" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="!=">
                <column table="kod_isv_ad_evd" column="pr_gen" />
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
        <query name="is_filial_plan" join="left outer">
          <call function="and">
            <call function="ge">
              <call function="nvl">
                <column table="is_filial_plan" column="dat_end" />
                <call function="doomsday" />
              </call>
              <useparam name="date_to" />
            </call>
            <call function="le">
              <column table="is_filial_plan" column="dat_begin" />
              <useparam name="date_from" />
            </call>
            <call function="=">
              <column table="ipr_kod_ispolnit" column="kod_direct" />
              <column table="is_filial_plan" column="kod_direct" />
            </call>
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_fake" />
              <const>1</const>
            </call>
            <call function="is not null">
              <column table="kod_isv_ad_evd" column="kod_filial" />
            </call>
            <call function="=">
              <column table="id_slice" column="id_slice" />
              <useparam name="id_slice" />
            </call>
          </call>
        </query>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-43105-47522-temp" timestamp="01.10.2018 15:36:32" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep_TEST.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
            <call function="year" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">2018</const>
          </call>
          <call function="ge">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
            <const exclude="1">2019</const>
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="and" as="is_sou_mon_total" exclude="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="le" as="is_sou_mon0" dontpushpred="1" exclude="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <const>date'2018-03-31'</const>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call group="sum" as="col_no_fact_mon_total" type="number" function="()" exclude="1">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon_total" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                      <const exclude="1">date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                      <const exclude="1">date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
            <const exclude="1">2019</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                      <const exclude="1">2019</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <const name="date_end_year" exclude="1">date'2018-06-30'</const>
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <const name="date_end_year" exclude="1">date'2018-12-31'</const>
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-test2" timestamp="20.06.2018 14:09:22" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep_TEST.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="is_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_rab" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>1</const>
        </call>
        <call function="=" as="is_norab" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>0</const>
        </call>
        <call function="and" as="is_new" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_f_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_f" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_i_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_i" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_2_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l_2" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_p_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_late" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_n" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost1" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost2" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="between">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-07-01'</const>
                      <const>date'2018-12-31'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost3" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2019-01-01'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_curr" part-id="45676-44864-expr2">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_week" part-id="45676-44864-expr2">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="()" as="col_fact_week" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_week" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_fact_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_f_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_f_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_i_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_i_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_2_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_l_2_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_l_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_p_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_p_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="late" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_late" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost1" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost1" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost2" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost2" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost3" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost3" column="isv_ad_evd_count" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_late" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_n" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_col_no_fact" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost1" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost1" />
        </call>
        <call group="sum" type="number" as="new_ost2" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost2" />
        </call>
        <call group="sum" type="number" as="new_ost3" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost3" />
        </call>
        <call group="sum" type="number" as="new_cnt" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_new" />
        </call>
        <call group="sum" type="number" as="cur_cnt" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_curr" />
        </call>
        <call group="sum" type="number" as="cur_cnt_rab" function="()" part-id="45676-44864-expr2">
          <fact column="cur_cnt" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="cur_cnt_norab" function="()" part-id="45676-44864-expr2">
          <fact column="cur_cnt" condition="is_norab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_rab" function="()" part-id="45676-44864-expr2">
          <fact column="col_fact_week" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_norab" function="()" part-id="45676-44864-expr2">
          <fact column="col_fact_week" condition="is_norab" />
        </call>
        <call function="and" as="is_not_in_cur" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call group="sum" type="number" as="exclude_from_vks" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_not_in_cur" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" part-id="45676-44864-select2" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" part-id="45676-44864-select2" />
        <call function="||" as="list_name" part-id="45676-44864-select2">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" />
        </call>
        <column table="kod_isv_ad_evd" column="st_det" as="st" group="max" part-id="45676-44864-select2" exclude="1" />
        <call as="st" title="Статус" group="max" function="()" part-id="45676-44864-select2" type="string">
          <usepart part="45676-48004-column-Status" />
        </call>
        <fact column="col_fact_week" nvl="0" group="sum" title="Кол-во на начало периода" part-id="45676-44864-select2" />
        <fact column="col_fact_curr" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="col_f_curr" nvl="0" group="sum" title="в АТП" part-id="45676-44864-select2" />
        <fact nvl="0" group="sum" title="в Приост" column="col_i_curr" part-id="45676-44864-select2" />
        <fact column="col_l_2_curr" nvl="0" group="sum" title="в Претенз" part-id="45676-44864-select2" />
        <fact column="col_l_curr" nvl="0" group="sum" title="в Расторг" part-id="45676-44864-select2" />
        <fact column="col_p_curr" nvl="0" group="sum" title="в РВУН" part-id="45676-44864-select2" />
        <fact column="late" nvl="0" group="sum" title="в Просроченные" part-id="45676-44864-select2" />
        <fact column="ost1" nvl="0" group="sum" title="в Остаток (период1)" part-id="45676-44864-select2" />
        <fact column="ost2" nvl="0" group="sum" title="в Остаток (период2)" part-id="45676-44864-select2" />
        <fact column="ost3" nvl="0" group="sum" title="в Остаток (период3)" part-id="45676-44864-select2" />
        <fact column="new_col_f" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact nvl="0" group="sum" column="new_col_i" part-id="45676-44864-select2" />
        <fact column="new_col_l2" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_col_l" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_col_p" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_late" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost1" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost2" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost3" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="fl_build_curr" group="max" part-id="45676-44864-select2" />
        <fact column="fl_build_week" group="max" part-id="45676-44864-select2" />
        <call function="year" as="year_zakl" group="max" part-id="45676-44864-select2">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact table="evd2" group="sum" column="cur_cnt" part-id="45676-44864-select2" />
        <fact table="evd2" as="week_cnt" group="sum" column="col_fact_week" part-id="45676-44864-select2" />
        <fact table="evd2" as="evd_cnt" group="sum" column="isv_ad_evd_count" part-id="45676-44864-select2" />
        <fact table="evd2" group="sum" column="cur_cnt_rab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="cur_cnt_norab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_rab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_norab" part-id="45676-44864-select2" nvl="0" />
        <fact column="new_cnt" nvl="0" group="sum" part-id="45676-44864-select2" />
        <column table="evd_fl_build_real" column="val" as="fl_build_real" part-id="45676-44864-select2" />
        <call function="if" as="to_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select2">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="cur_cnt" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select2">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="cur_cnt" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <fact column="exclude_from_vks" nvl="0" group="sum" part-id="45676-44864-select2" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" part-id="45676-44864-qube2" />
          <link name="kod_isv_ad_evd" part-id="45676-44864-qube2" />
          <link name="evd_otch_list_3" part-id="45676-44864-qube2" />
          <link name="evd_dt_contract" part-id="45676-44864-qube2" />
          <link name="evd_pr_hoz_sposob" part-id="45676-44864-qube2" />
          <link name="evd_pr_exist_pd" part-id="45676-44864-qube2" />
          <link name="id_slice" part-id="45676-44864-qube2" />
          <where part-id="45676-44864-qube2">
            <call function="and">
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </call>
          </where>
          <dimset as="evd2" part-id="45676-44864-qube2">
            <link name="evd_fl_build_real" />
            <where exclude="1">
              <call function="=">
                <const>1</const>
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset title="с работами" as="rab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'rab_'</const>
          </usepart>
        </grset>
        <grset title="без работ" as="norab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'norab_'</const>
          </usepart>
        </grset>
        <grset title="новые с работами" as="rab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="новые без работ" as="norab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из безработных" as="from_norab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из работных" as="from_rab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset as="by_dep" title="По филиалам" order="name_podr" exclude="1">
          <usepart part="45676-44864-grsets">
            <const>'dep_'</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="dep_rab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="evd_cnt" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="dep_norab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="dep_rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="dep_norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="dep_from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="dep_from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="49928-1" title="Приказ 452 Форма 1" timestamp="18.12.2018 17:11:14" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <usepart part="49928-params" />
      </params>
      <expressions>
        <call function="=" as="is_2709" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2709" />
        </call>
        <call function="=" as="is_0810" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_0810" />
        </call>
        <call function="=" as="is_1510" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_1510" />
        </call>
        <call function="=" as="is_2210" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2210" />
        </call>
        <call function="=" as="is_2910" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2910" />
        </call>
        <call function="=" as="is_0511" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_0511" />
        </call>
        <call function="=" as="is_1211" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_1211" />
        </call>
        <call function="=" as="is_1911" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_1911" />
        </call>
        <call function="=" as="is_2611" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2611" />
        </call>
        <call function="=" as="is_0312" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_0312" />
        </call>
        <call function="=" as="is_1012" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_1012" />
        </call>
        <call function="-nvl" as="col_any_fact_27_0710" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_2709" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_0810" />
        </call>
        <call function="-nvl" as="col_any_fact_08_1410" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_0810" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_1510" />
        </call>
        <call function="-nvl" as="col_any_fact_15_2110" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_1510" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_2210" />
        </call>
        <call function="-nvl" as="col_any_fact_22_2810" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_2210" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_2910" />
        </call>
        <call function="-nvl" as="col_any_fact_29_0411" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_2910" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_0511" />
        </call>
        <call function="-nvl" as="col_any_fact_05_1111" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_0511" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_1211" />
        </call>
        <call function="-nvl" as="col_any_fact_12_1811" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_1211" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_1911" />
        </call>
        <call function="-nvl" as="col_any_fact_19_2511" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_1911" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_2611" />
        </call>
        <call function="-nvl" as="col_any_fact_26_0212" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_2611" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_0312" />
        </call>
        <call function="-nvl" as="col_any_fact_03_0912" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_0312" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_1012" />
        </call>
        <call function="-nvl" as="col_any_fact_total" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_2709" />
          <fact column="isv_ad_evd_col_no_fact" condition="is_1012" />
        </call>
        <call function="=" as="is_dt_2709" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_2709" />
        </call>
        <call function="=" as="is_dt_0810" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_0810" />
        </call>
        <call function="=" as="is_dt_1510" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_1510" />
        </call>
        <call function="=" as="is_dt_2210" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_2210" />
        </call>
        <call function="=" as="is_dt_2910" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_2910" />
        </call>
        <call function="=" as="is_dt_0511" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_0511" />
        </call>
        <call function="=" as="is_dt_1211" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_1211" />
        </call>
        <call function="=" as="is_dt_1911" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_1911" />
        </call>
        <call function="=" as="is_dt_2611" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_2611" />
        </call>
        <call function="=" as="is_dt_0312" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_0312" />
        </call>
        <call function="=" as="is_dt_1012" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <useparam name="date_1012" />
        </call>
        <call as="is_dt_do_otch" function="le" dontpushpred="1">
          <column table="vks_prikaz_pl_dat" column="val" />
          <call function="trunc">
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="()" group="sum" as="plan_27_0710">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_0810" />
        </call>
        <call function="()" group="sum" as="plan_08_1410">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_1510" />
        </call>
        <call function="()" group="sum" as="plan_15_2110">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_2210" />
        </call>
        <call function="()" group="sum" as="plan_22_2810">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_2910" />
        </call>
        <call function="()" group="sum" as="plan_29_0411">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_0511" />
        </call>
        <call function="()" group="sum" as="plan_05_1111">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_1211" />
        </call>
        <call function="()" group="sum" as="plan_12_1811">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_1911" />
        </call>
        <call function="()" group="sum" as="plan_19_2511">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_2611" />
        </call>
        <call function="()" group="sum" as="plan_26_0212">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_0312" />
        </call>
        <call function="()" group="sum" as="plan_03_0912">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_1012" />
        </call>
        <call function="()" as="plan_do_otch" group="sum">
          <fact column="vr_vks_prikaz_plan_plan_dogs" condition="is_dt_do_otch" />
        </call>
      </expressions>
      <select>
        <column table="evd_name_podr" column="val" as="name_podr_calc" />
        <column table="evd_fl_branch" column="val" as="fl_branch_calc" />
        <column table="evd_kod_predpr" column="val" as="kod_predpr_calc" />
        <call function="to_char" as="date_otch_char" group="max">
          <useparam name="date_otch" />
          <const>'DD.MM.YYYY'</const>
        </call>
        <fact group="sum" table="evd" column="col_any_fact_27_0710" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_08_1410" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_15_2110" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_22_2810" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_29_0411" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_05_1111" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_12_1811" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_19_2511" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_26_0212" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_03_0912" nullif="0" type="number" />
        <fact group="sum" table="evd" column="col_any_fact_total" nullif="0" type="number" />
        <fact group="sum" table="plan" column="plan_27_0710" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_08_1410" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_15_2110" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_22_2810" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_29_0411" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_05_1111" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_12_1811" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_19_2511" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_26_0212" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_03_0912" type="number" nullif="0" />
        <fact group="sum" table="plan" column="plan_do_otch" type="number" nullif="0" />
        <fact group="sum" table="plan" column="vr_vks_prikaz_plan_plan_dogs" as="plan_total" type="number" nullif="0" />
      </select>
      <from>
        <qube>
          <link name="evd_name_podr" />
          <link name="evd_fl_branch" />
          <link name="evd_kod_predpr" />
          <dimset as="evd">
            <link name="ipr_kod_ispolnit" />
            <link name="kod_isv_ad_evd" />
            <link name="evd_fl_build_real" />
            <link name="evd_dt_contract" />
            <link name="id_slice" />
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range" />
              </call>
              <call function="is not null" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <usepart part="isv_ad_evd_filial_list" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <call function="year">
                      <column table="kod_isv_ad_evd" column="dt_contract" />
                    </call>
                    <useparam name="cur_year" />
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
              <call function="le" dontpushpred="1">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <useparam name="date_end_cur_Q" />
              </call>
            </where>
          </dimset>
          <dimset as="plan">
            <link name="vks_prikaz_pl_dat" />
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all">
          <grset as="by_dep" order="fl_branch_calc, kod_predpr_calc">
            <group>
              <column table="this" column="name_podr_calc" />
              <column table="this" column="fl_branch_calc" />
              <column table="this" column="kod_predpr_calc" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="49928-2" timestamp="18.12.2018 17:11:47" title="Приказ 452 Форма 2" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <usepart part="49928-params" />
      </params>
      <expressions>
        <call as="is_tit_link" function="is not null" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="titul_ip" />
        </call>
        <call as="no_tit_link" function="is null" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="titul_ip" />
        </call>
        <call as="gt_1_m_dt_cont" function="true" dontpushpred="1" exclude="1" />
        <call as="gt_1_m_dt_cont" function="gt" dontpushpred="1">
          <call function="months_between">
            <call function="trunc">
              <useparam name="date_otch" />
            </call>
            <call function="trunc">
              <column table="kod_isv_ad_evd" column="dt_contract" />
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="()" as="ostatok" group="sum" type="number" format="N0" halign="center">
          <fact column="isv_ad_evd_col_no_fact" />
        </call>
        <call function="()" as="ostatok_tit" group="sum" type="number" format="N0" halign="center">
          <fact column="ostatok" condition="is_tit_link" />
        </call>
        <call function="()" as="ostatok_no_tit" group="sum" type="number" format="N0" halign="center">
          <fact column="ostatok" condition="no_tit_link" />
        </call>
        <call function="()" as="ostatok_no_tit_gt_dt" group="sum" type="number" format="N0" halign="center">
          <fact column="ostatok_no_tit" condition="gt_1_m_dt_cont" />
        </call>
      </expressions>
      <select>
        <column table="evd_name_podr" column="val" as="name_podr_calc" />
        <column table="evd_fl_branch" column="val" as="fl_branch_calc" />
        <column table="evd_kod_predpr" column="val" as="kod_predpr_calc" />
        <call function="year" as="year_zakl">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <call function="to_char" as="date_otch_char" group="max">
          <useparam name="date_otch" />
          <const>'DD.MM.YYYY'</const>
        </call>
        <fact column="ostatok" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_tit" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_no_tit" nvl="0" group="sum" table="evd_cur" />
        <fact column="ostatok_no_tit_gt_dt" nvl="0" group="sum" table="evd_cur" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_name_podr" />
          <link name="evd_fl_branch" />
          <link name="evd_kod_predpr" />
          <link name="id_slice" />
          <dimset as="evd_cur">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice" />
                </call>
                <call function="=1">
                  <column table="evd_fl_build_real" column="val" />
                </call>
                <call function="or">
                  <call function="and">
                    <call function="=1">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    </call>
                    <call function="or">
                      <call function="is not null">
                        <column column="kod_org_active" table="kod_isv_ad_evd" />
                      </call>
                      <call function="and" comment="Y">
                        <call function="le">
                          <call function="year">
                            <column column="val" table="evd_dt_contract" />
                          </call>
                          <useparam name="prev_year" />
                        </call>
                      </call>
                    </call>
                  </call>
                  <call function="and">
                    <call function="!=">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <call function="year">
                        <column table="evd_dt_contract" column="val" />
                      </call>
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_week" exclude="1">
            <where>
              <call function="and">
                <call function="is not null">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="=">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_week" />
                </call>
                <call function="=1">
                  <column table="evd_fl_build_real" column="val" />
                </call>
                <call function="or">
                  <call function="and">
                    <call function="=1">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    </call>
                    <call function="or">
                      <call function="is not null">
                        <column column="kod_org_active" table="kod_isv_ad_evd" />
                      </call>
                      <call function="and" comment="Y">
                        <call function="le">
                          <call function="year">
                            <column column="val" table="evd_dt_contract" />
                          </call>
                          <useparam name="prev_year" />
                        </call>
                      </call>
                    </call>
                  </call>
                  <call function="and">
                    <call function="!=">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <call function="year">
                        <column table="evd_dt_contract" column="val" />
                      </call>
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd">
            <where>
              <call function="and">
                <call function="is not null" exclude="1">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
                <call function="in">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                  <usepart part="isv_ad_evd_filial_list" />
                </call>
                <call function="is not null">
                  <column table="evd_dt_contract" column="val" />
                </call>
                <call function="in">
                  <column table="id_slice" column="id_slice" />
                  <useparam name="id_slice_range1" />
                </call>
                <call function="=1">
                  <column table="evd_fl_build_real" column="val" />
                </call>
                <call function="or">
                  <call function="and">
                    <call function="=1">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                    </call>
                    <call function="or">
                      <call function="is not null">
                        <column column="kod_org_active" table="kod_isv_ad_evd" />
                      </call>
                      <call function="and" comment="Y">
                        <call function="le">
                          <call function="year">
                            <column column="val" table="evd_dt_contract" />
                          </call>
                          <useparam name="prev_year" />
                        </call>
                      </call>
                    </call>
                  </call>
                  <call function="and">
                    <call function="!=">
                      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <call function="year">
                        <column table="evd_dt_contract" column="val" />
                      </call>
                      <useparam name="cur_year" />
                    </call>
                    <call function="not in">
                      <column table="kod_isv_ad_evd" column="status" />
                      <array>
                        <const>0</const>
                        <const>2</const>
                      </array>
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" />
        <grset as="by_dep" order="fl_branch_calc, kod_predpr_calc">
          <group>
            <column table="this" column="name_podr_calc" />
            <column table="this" column="fl_branch_calc" />
            <column table="this" column="kod_predpr_calc" />
          </group>
        </grset>
      </grouping>
    </query>
    <query name="49928-id_slice_2709" class="1" timestamp="31.10.2018 17:17:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_2709" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_2709" />
            <const as="val" exclude="1">date'2018-09-27'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_0810" class="1" timestamp="31.10.2018 17:17:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_0810" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_0810" />
            <const as="val" exclude="1">date'2018-10-08'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_1510" class="1" timestamp="31.10.2018 17:17:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_1510" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" nvl="-6" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_1510" />
            <const as="val" exclude="1">date'2018-10-15'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_2210" class="1" timestamp="31.10.2018 17:17:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_2210" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_2210" />
            <const as="val" exclude="1">date'2018-10-22'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_2910" class="1" timestamp="31.10.2018 17:17:41" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_2910" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_2910" />
            <const as="val" exclude="1">date'2018-10-29'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_0511" class="1" timestamp="31.10.2018 17:18:04" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_0511" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_0511" />
            <const as="val" exclude="1">date'2018-11-05'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_1211" class="1" timestamp="31.10.2018 17:21:18" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_1211" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_1211" />
            <const as="val" exclude="1">date'2018-11-12'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_1911" class="1" timestamp="31.10.2018 17:21:37" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_1911" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_1911" />
            <const as="val" exclude="1">date'2018-11-19'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_2611" class="1" timestamp="31.10.2018 17:22:21" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_2611" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_2611" />
            <const as="val" exclude="1">date'2018-11-26'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_0312" class="1" timestamp="31.10.2018 17:22:42" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_0312" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_0312" />
            <const as="val" exclude="1">date'2018-12-03'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_1012" class="1" timestamp="31.10.2018 17:23:41" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice" type="number" />
        <param name="date_1012" type="date" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" group="max" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="!=nvl">
            <column table="a" column="pr_manual" />
            <const>1</const>
          </call>
          <call function="le">
            <column table="a" column="dat_copy" />
            <useparam name="date_1012" />
            <const as="val" exclude="1">date'2018-12-10'</const>
          </call>
          <call function="le">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-id_slice_range" class="1" timestamp="26.10.2018 15:33:04" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <param name="id_slice_2709" type="number" />
        <param name="id_slice_0810" type="number" />
        <param name="id_slice_1510" type="number" />
        <param name="id_slice_2210" type="number" />
        <param name="id_slice_2910" type="number" />
        <param name="id_slice_0511" type="number" />
        <param name="id_slice_1211" type="number" />
        <param name="id_slice_1911" type="number" />
        <param name="id_slice_2611" type="number" />
        <param name="id_slice_0312" type="number" />
        <param name="id_slice_1012" type="number" />
      </params>
      <select>
        <column table="a" column="id_slice" title="" vid="1" />
        <column table="a" column="name" title="" exclude="1" />
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2709" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_0810" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_1510" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2210" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2910" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_0511" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_1211" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_1911" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_2611" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_0312" />
          </call>
          <call function="=" optional="1">
            <column table="a" column="id_slice" />
            <useparam name="id_slice_1012" />
          </call>
        </call>
      </where>
    </query>
    <query name="49928-date_2709" timestamp="29.10.2018 12:11:11" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-09-27'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_0810" timestamp="29.10.2018 12:12:11" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-10-08'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_1510" timestamp="29.10.2018 12:12:20" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-10-15'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_2210" timestamp="29.10.2018 12:12:50" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-10-22'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_2910" timestamp="29.10.2018 12:13:14" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-10-29'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_0511" timestamp="29.10.2018 12:13:37" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-11-05'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_1211" timestamp="29.10.2018 12:14:58" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-11-12'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_1911" timestamp="29.10.2018 12:15:15" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-11-19'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_2611" timestamp="29.10.2018 12:15:31" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-11-26'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_0312" timestamp="29.10.2018 12:15:51" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-12-03'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-date_1012" timestamp="29.10.2018 12:16:17" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <select>
        <const as="val">date'2018-12-10'</const>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="49928-detail" timestamp="29.10.2018 19:54:49" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <usepart part="49928-params" />
      </params>
      <print-templates>
        <excel>
          <template name="49928-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <column as="name_podr_calc" table="evd_name_podr" column="val" />
        <column as="fl_branch_calc" table="evd_fl_branch" column="val" />
        <column as="kod_predpr_calc" table="evd_kod_predpr" column="val" />
      </select>
      <from>
        <qube>
          <link name="evd_name_podr" />
          <link name="evd_fl_branch" />
          <link name="evd_kod_predpr" />
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="49928-detail-d" timestamp="29.10.2018 20:51:17" title="Информация об исполнении договоров (детализация)" is-report="1" visible="0" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <usepart part="49928-params" />
      </params>
      <print-templates>
        <excel>
          <template name="49928-detail.xlsx" title="Детализация отчёта к ВКС" print-proc="2" del-cols="1" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <expressions exclude="1">
        <call as="is_slice_cur" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_1510" />
        </call>
        <call as="is_slice_week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_0810" />
        </call>
        <call as="status_vks_name_cur" function="()" group="max" type="string">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_cur" />
        </call>
        <call as="status_vks_name_week" function="()" group="max" type="string">
          <fact column="isv_ad_evd_status_vks_name" condition="is_slice_week" />
        </call>
        <call as="status_vks_name_cur_x" function="over" group="max" type="string">
          <call function="max">
            <fact column="status_vks_name_cur" />
          </call>
          <call function="partition by">
            <column column="kod_dop_contract" table="kod_isv_ad_evd" />
          </call>
        </call>
        <call as="status_vks_name_week_x" function="over" group="max" type="string">
          <call function="max">
            <fact column="status_vks_name_week" />
          </call>
          <call function="partition by">
            <column column="kod_dop_contract" table="kod_isv_ad_evd" />
          </call>
        </call>
      </expressions>
      <expressions>
        <usepart part="45676-detail-status-expr" />
      </expressions>
      <select>
        <usepart part="45676-detail-columns-new" />
        <column table="evd_name_podr" column="val" as="name_podr_calc" />
        <column table="evd_fl_branch" column="val" as="fl_branch_calc" />
        <column table="evd_kod_predpr" column="val" as="kod_predpr_calc" />
        <call function="over" type="number" title="Динамика" halign="center" format="N0" as="val_delta">
          <call function="sum">
            <call function="()" as="[column]" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dop_contract" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="evd_name_podr" />
          <link name="evd_fl_branch" />
          <link name="evd_kod_predpr" />
          <usepart part="45676-detail-links" />
        </qube>
      </from>
    </query>
    <query name="53419_vs1" timestamp="26.07.2019 14:14:00" file="sql.builder.templates\sql.builder\projects\vks45676\reports\53419-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call as="is_sou_nxt1_2" dontpushpred="1" function="and">
          <call function="=">
            <call function="trunc">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
              <const>'Q'</const>
            </call>
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
        <call as="is_sou_nxt3" function="and">
          <call dontpushpred="1" function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_beg_next_Y" />
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call dontpushpred="1" function="le">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_end_cur_Q" />
          </call>
        </call>
        <call as="is_sou_pr" dontpushpred="1" function="and">
          <call function="lt">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call dontpushpred="1" function="le">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_mon1" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call as="is_sou_mon2" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call as="is_sou_mon3" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call as="is_sou_mon4" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call as="is_sou_mon5" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call as="is_sou_mon6" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call as="is_sou_mon7" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call as="is_sou_mon8" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call as="is_sou_mon9" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call as="is_sou_mon10" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call as="is_sou_mon11" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call as="is_sou_mon12" dontpushpred="1" function="and">
          <call function="=">
            <call function="year">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call as="col_no_fact_nxt1_2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call as="col_no_fact_cur" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_cur" />
        </call>
        <call as="col_no_fact_nxt2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call as="col_no_fact_nxt3" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_nxt3" />
        </call>
        <call as="col_no_fact_pr" function="()" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call as="col_no_fact_mon0" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call as="col_no_fact_mon1" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call as="col_no_fact_mon2" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call as="col_no_fact_mon3" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call as="col_no_fact_mon4" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call as="col_no_fact_mon5" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call as="col_no_fact_mon6" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call as="col_no_fact_mon7" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call as="col_no_fact_mon8" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call as="col_no_fact_mon9" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call as="col_no_fact_mon10" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call as="col_no_fact_mon11" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call as="col_no_fact_mon12" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call as="is_cur" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call as="is_week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call as="is_3week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call as="is_2week" dontpushpred="1" function="=">
          <column column="id_slice" table="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call as="col_any_fact_week" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call as="is_fact_week" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column column="col_any_fact" table="kod_isv_ad_evd" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd" />
              </call>
            </call>
          </call>
        </call>
        <call as="col_any_fact_3week" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call as="col_any_fact_2to1w" function="-nvl" group="sum" type="number">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call as="is_sou_changed1_1" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_end_cur_Q" />
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd_vs1" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd_vs1" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_changed1_2" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call dontpushpred="1" function="and">
            <call function="=">
              <call function="trunc">
                <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd_vs1" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                      <useparam name="date_end_cur_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd_vs1" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou_changed2" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd_vs1" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                      <useparam name="date_beg_cur_Q_pl2" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd_vs1" />
              </call>
            </call>
          </call>
        </call>
        <call as="is_sou2019p" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd_vs1" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column column="col_n" table="kod_isv_ad_evd_vs1" />
                        <column column="col_p_2" table="kod_isv_ad_evd_vs1" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd_vs1" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column column="col_n" table="kod_isv_ad_evd_vs1" />
              <column column="col_p_2" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call as="is_ispoln" dontpushpred="1" function="and">
          <call function="=">
            <column column="id_slice" table="kod_isv_ad_evd_vs1" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column column="col_n" table="kod_isv_ad_evd_vs1" />
              <column column="col_p_2" table="kod_isv_ad_evd_vs1" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" title=" " type="number">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column column="id_slice" table="kod_isv_ad_evd_vs1" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column column="col_n" table="kod_isv_ad_evd_vs1" />
                        <column column="col_p_2" table="kod_isv_ad_evd_vs1" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="trunc">
                        <column column="srok_uslug" table="kod_isv_ad_evd_vs1" />
                        <const>'Q'</const>
                      </call>
                      <useparam name="date_beg_next_Q" />
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column column="kod_dop_contract" table="kod_isv_ad_evd_vs1" />
              </call>
            </call>
          </call>
        </call>
        <call as="sou_changed1_1" function="()" group="sum" title="было СОУ 1кв2018 - продлено" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call as="sou_changed1_2" function="()" group="sum" title="продлено на 2-4кв.2018" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call as="sou_changed2" function="()" group="sum" title="продлено на 2019" type="number">
          <fact column="isv_ad_evd_vs1_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call as="sou_unchanged_week" function="-nvl" group="sum" nvl="0" title="Факт за неделю в т.ч. без продления">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
        </call>
        <call as="col_no_fact_nxt1_2_week" function="()" group="sum" type="number">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call as="col_no_fact_nxt1_1_ispoln" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_count" condition="is_ispoln" />
        </call>
        <call as="col_no_fact_nxt1_2_to_2019" function="()" group="sum" type="number">
          <fact column="isv_ad_evd_vs1_count" condition="is_sou2019p" />
        </call>
        <call as="is_not_fl_reestr_2018_fact" function="!=">
          <column column="fl_reestr_fact" table="kod_isv_ad_evd_vs1" />
          <const>1</const>
        </call>
        <call as="col_any_fact_2018" function="()" group="sum" title="Исполнено за 2018 год" type="number">
          <fact column="isv_ad_evd_vs1_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call as="col_any_fact_week_diff" function="-nvl" group="sum">
          <fact column="isv_ad_evd_vs1_col_any_fact" condition="is_cur" />
          <fact column="isv_ad_evd_vs1_col_any_fact" condition="is_week" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_vs1_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_vs1_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_vs1_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_vs1_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_vs1_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_vs1_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_vs1_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact table="evd" column="col_any_fact_week_diff" group="sum" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd_vs1" as="kod_isv_ad_evd" />
          <link name="id_slice" />
          <link name="evd_c_zayav_num_z_id" exclude="1" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="or" exclude="1">
                <call function="=">
                  <column table="evd_c_zayav_num_z_id" column="kod_spr_query" />
                  <const comment="Вынос сетей">21</const>
                </call>
                <call function="is null">
                  <column table="kod_isv_ad_evd" column="num_req" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="or" exclude="1">
                <call function="=">
                  <column table="evd_c_zayav_num_z_id" column="kod_spr_query" />
                  <const comment="Вынос сетей">21</const>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="53419-title" timestamp="20.07.2019 12:52:57" file="sql.builder.templates\sql.builder\projects\vks45676\reports\53419-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <select>
        <call function="to_char" as="slice_date" group="max">
          <column table="a" column="dat_copy_time" />
          <const>'DD.MM.YYYY'</const>
        </call>
        <call as="sdate_begin" function="to_char" group="max">
          <useparam name="date_from" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_end" group="max">
          <useparam name="date_to" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_begin_full" group="max">
          <useparam name="date_from" />
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="||" as="sdate_range" group="max">
          <column table="this" column="sdate_begin" group="no" />
          <const>'-'</const>
          <column table="this" column="sdate_end" group="no" />
        </call>
        <call function="to_char" as="sdate_begin_1w" group="max">
          <useparam name="date_last_2week" />
          <const>'dd.mm'</const>
        </call>
        <call function="to_char" as="sdate_end_1w" group="max">
          <call function="date add days">
            <useparam name="date_last_week" />
            <const>-1</const>
          </call>
          <const>'dd.mm'</const>
        </call>
        <call function="||" as="sdate_range_1w" group="max">
          <column table="this" column="sdate_begin_1w" group="no" />
          <const>'-'</const>
          <column table="this" column="sdate_end_1w" group="no" />
        </call>
        <call as="slice_month_name" function="mes-name" group="max">
          <call function="month">
            <column table="a" column="dat_copy" />
          </call>
        </call>
        <call function="to_char" as="date_end_cur_Q" group="max">
          <useparam name="date_end_cur_Q" />
          <const>'dd.mm.yyyy'</const>
        </call>
        <call function="()" as="cy" type="number" group="max">
          <useparam name="cur_year" />
        </call>
        <call function="year" as="ny" group="max">
          <useparam name="date_beg_next_Y" />
        </call>
        <call as="nkv" function="||" group="max">
          <call name="kv" function="mes to kv">
            <call function="month">
              <useparam name="date_beg_next_Q" />
            </call>
          </call>
          <const>' кв. '</const>
          <call name="year" function="year">
            <useparam name="date_beg_next_Q" />
          </call>
        </call>
        <call as="ckv" function="||" group="max">
          <useparam name="kv" />
          <const>' кв. '</const>
          <useparam name="year" />
        </call>
        <call as="nnkv" function="||" group="max">
          <call function="if">
            <call function="=">
              <call function="month">
                <useparam name="date_beg_cur_Q_pl2" />
              </call>
              <const>1</const>
            </call>
            <const>''</const>
            <call function="||">
              <call name="kv" function="mes to kv">
                <call function="month">
                  <useparam name="date_beg_cur_Q_pl2" />
                </call>
              </call>
              <const>' кв. '</const>
            </call>
          </call>
          <call name="year" function="year">
            <useparam name="date_beg_cur_Q_pl2" />
          </call>
        </call>
      </select>
      <from>
        <query name="is_ad_all_slice" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="id_slice" />
            <useparam name="id_slice" />
          </call>
        </call>
      </where>
    </query>
    <query name="vr_vks_prikaz_plan" class="1" timestamp="29.10.2018 12:05:57" file="sql.builder.templates\sql.builder\projects\vks45676\scheme\original\vr_vks_prikaz_plan.xml">
      <select>
        <call function="rowid" as="vr_vks_prikaz_plan_id" key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="vks_prikaz_pl_dat" is-final-dimension="vks_prikaz_pl_dat" dimension="vks_prikaz_pl_dat" />
        <column table="a" column="name_podr" type="string" data-size="150" title="" is-private-dimension="evd_name_podr" is-final-dimension="evd_name_podr" dimension="evd_name_podr" />
        <column table="a" column="fl_branch" type="number" title="" is-private-dimension="evd_fl_branch" is-final-dimension="evd_fl_branch" dimension="evd_fl_branch" />
        <column table="a" column="kod_predpr" type="string" data-size="15" is-private-dimension="evd_kod_predpr" is-final-dimension="evd_kod_predpr" dimension="evd_kod_predpr" />
        <column table="a" column="plan_dogs" type="number" title="" is-fact="1" agg="sum" />
      </select>
      <from>
        <table name="vr_vks_prikaz_plan" as="a" />
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id">
    <part id="45676-withparams" timestamp="15.01.2019 16:28:57" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <useparam name="kod_ispolnit" />
      <useparam name="id_slice" />
      <useparam name="year" />
      <useparam name="kv" />
      <useparam name="id_slice_week" />
      <useparam name="id_slice_2week" />
      <useparam name="id_slice_3week" />
      <useparam name="id_slice_4week" />
      <useparam name="date_otch" />
      <useparam name="date_from" />
      <useparam name="date_to" />
      <useparam name="date_last_week" />
      <useparam name="date_last_2week" />
      <useparam name="date_last_3week" />
      <useparam name="date_last_4week" />
      <useparam name="id_slice_range1" />
      <useparam name="id_slice_range2" />
      <useparam name="id_slice_range3" />
      <useparam name="id_slice_range_0_1_4" />
      <useparam name="date_beg_cur_Q" />
      <useparam name="date_end_cur_Q" />
      <useparam name="date_beg_next_Q" />
      <useparam name="date_beg_cur_Q_pl2" />
      <useparam name="date_beg_next_Y" />
      <useparam name="date_end_cur_Y" />
      <useparam name="cur_year" />
      <useparam name="prev_year" />
      <useparam name="cur_year_minus_2" />
      <useparam name="cur_year_minus_3" />
      <useparam name="cur_year_minus_4" />
      <useparam name="next_year" />
      <useparam name="next_Q_1st_month" />
      <useparam name="next_Q_year" />
    </part>
    <part id="45676-p3-grsets" timestamp="30.06.2021 21:37:05" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]all_no_rab">
        <where>
          <call function="=0">
            <column table="this" column="fl_build" />
          </call>
        </where>
      </grset>
      <grset as="[:pfx]all_rab">
        <where>
          <call function="=1">
            <column table="this" column="fl_build" />
          </call>
        </where>
        <grset as="[:pfx]all_rab_ygr3">
          <where>
            <call function="gt">
              <column table="this" column="dyear" />
              <const>2</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr2">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>2</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr1">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>1</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr0">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>0</const>
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]all_do">
        <where>
          <call function="=">
            <column table="this" column="fl_reestr_2018" />
            <const>1</const>
          </call>
        </where>
        <grset as="[:pfx]do_no_rab">
          <where>
            <call function="=0">
              <column table="this" column="fl_build" />
            </call>
          </where>
          <grset as="[:pfx]do_no_rab_do">
            <where>
              <call function="le">
                <column table="this" column="year_zakl" />
                <useparam name="cur_year_minus_2" />
              </call>
              <call function="and" exclude="1">
                <call function="le">
                  <column table="this" column="year_zakl" />
                  <useparam name="cur_year_minus_2" />
                </call>
                <call function="is null">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_no_rab_pos">
            <where>
              <call function="=">
                <column table="this" column="year_zakl" />
                <useparam name="prev_year" />
              </call>
              <call function="and" exclude="1">
                <call function="=">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                </call>
                <call function="is null">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_no_rab_dzo" exclude="1">
            <where>
              <call function="is not null">
                <column table="this" column="kod_org_active" />
              </call>
            </where>
          </grset>
        </grset>
        <grset as="[:pfx]do_rab">
          <where>
            <call function="=1">
              <column table="this" column="fl_build" />
            </call>
          </where>
          <grset as="[:pfx]do_rab_do">
            <where>
              <call function="le">
                <column table="this" column="year_zakl" />
                <useparam name="cur_year_minus_2" />
              </call>
              <call function="and" exclude="1">
                <call function="le">
                  <column table="this" column="year_zakl" />
                  <useparam name="cur_year_minus_2" />
                </call>
                <call function="is null">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_rab_pos">
            <where>
              <call function="=">
                <column table="this" column="year_zakl" />
                <useparam name="prev_year" />
              </call>
              <call function="and" exclude="1">
                <call function="=">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                </call>
                <call function="is null">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_rab_dzo" exclude="1">
            <where>
              <call function="is not null">
                <column table="this" column="kod_org_active" />
              </call>
            </where>
          </grset>
        </grset>
      </grset>
      <grset as="[:pfx]all_tek">
        <where>
          <call function="and">
            <call function="ge">
              <column table="this" column="year_zakl" />
              <useparam name="cur_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="not in">
              <column table="this" column="status" />
              <array>
                <const>0</const>
                <const>2</const>
              </array>
            </call>
            <call function="!=">
              <column table="this" column="fl_reestr_2018" />
              <const>1</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]tek_no_rab">
          <where>
            <call function="=0">
              <column table="this" column="fl_build" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]tek_rab">
          <where>
            <call function="=1">
              <column table="this" column="fl_build" />
            </call>
          </where>
        </grset>
      </grset>
    </part>
    <part id="45676-p4-grsets" timestamp="19.04.2017 17:17:27" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]all_no_rab">
        <where>
          <call function="=0">
            <column table="this" column="fl_build" />
          </call>
        </where>
      </grset>
      <grset as="[:pfx]all_rab">
        <where>
          <call function="=1">
            <column table="this" column="fl_build" />
          </call>
        </where>
        <grset as="[:pfx]all_rab_pod">
          <where>
            <call function="=1">
              <column table="this" column="pr_exist_pd" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_hoz">
          <where>
            <call function="=1">
              <column table="this" column="pr_hoz_sposob" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_empt">
          <where>
            <call function="and">
              <call function="=0">
                <column table="this" column="pr_hoz_sposob" />
              </call>
              <call function="=0">
                <column table="this" column="pr_exist_pd" />
              </call>
            </call>
          </where>
        </grset>
      </grset>
    </part>
    <part id="45676-range-columns" timestamp="27.09.2018 12:02:53" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <call function="=" as="is_cur" dontpushpred="1">
        <column table="id_slice" column="id_slice" />
        <useparam name="id_slice" />
      </call>
      <call function="=" as="is_d0" dontpushpred="1">
        <column table="id_slice" column="id_slice" />
        <useparam name="id_slice_week" />
      </call>
      <call function="-nvl" as="col_f_range" group="sum">
        <fact column="isv_ad_everyday_col_f" condition="is_cur" />
        <fact column="isv_ad_everyday_col_f" condition="is_d0" />
      </call>
      <call function="-nvl" as="col_i_range" group="sum">
        <fact column="isv_ad_everyday_col_i" condition="is_cur" />
        <fact column="isv_ad_everyday_col_i" condition="is_d0" />
      </call>
      <call function="-nvl" as="col_l_range" group="sum">
        <fact column="isv_ad_everyday_col_l" condition="is_cur" />
        <fact column="isv_ad_everyday_col_l" condition="is_d0" />
      </call>
      <call function="-nvl" as="col_l_2_range" group="sum">
        <fact column="isv_ad_everyday_col_l_2" condition="is_cur" />
        <fact column="isv_ad_everyday_col_l_2" condition="is_d0" />
      </call>
      <call function="-nvl" as="col_n_range" group="sum">
        <fact column="isv_ad_everyday_col_n" condition="is_d0" />
        <fact column="isv_ad_everyday_col_n" condition="is_cur" />
      </call>
      <call function="-nvl" as="col_p_range" group="sum">
        <fact column="isv_ad_everyday_col_p" condition="is_d0" />
        <fact column="isv_ad_everyday_col_p" condition="is_cur" />
      </call>
    </part>
    <part id="45676-ostatok-columns-old" timestamp="13.04.2018 18:17:51" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <call function="()" as="ostatok" group="sum" type="number" format="N0" halign="center">
        <fact column="isv_ad_evd_col_no_fact" />
      </call>
      <call function="le" dontpushpred="1" as="is_sou_do">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <const>DATE'2018-03-31'</const>
      </call>
      <call function="and" as="is_sou_late" dontpushpred="1">
        <call function="le" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <const>DATE'2018-03-31'</const>
        </call>
        <call function="lt" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
      </call>
      <call function="ge" dontpushpred="1" as="is_sou_posle">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <const>DATE'2018-04-01'</const>
      </call>
      <call function="ge" dontpushpred="1" as="is_sou_posle2019">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <const>DATE'2019-01-01'</const>
      </call>
      <call function="lt" dontpushpred="1" as="is_sou_do2019">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <const>DATE'2019-01-01'</const>
      </call>
      <call function="()" as="ostatok_do" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_do" />
      </call>
      <call function="()" as="ostatok_late" type="number" group="sum" format="N0" halign="center">
        <fact column="isv_ad_everyday_col_n" condition="is_sou_do" />
      </call>
      <call function="()" as="ostatok_posle" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_posle" />
      </call>
      <call function="()" as="ostatok_posle2019" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_posle2019" />
      </call>
      <call function="()" as="ostatok_do2019" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_do2019" />
      </call>
    </part>
    <part id="45676-fact-3weeks-columns" timestamp="10.10.2017 12:00:50" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <call function="-nvl" as="ostatok_range" group="sum">
        <fact column="ostatok_do" condition="is_d0" />
        <fact column="ostatok_do" condition="is_cur" />
      </call>
      <call function="=" as="is_2week" dontpushpred="1">
        <column table="id_slice" column="id_slice" />
        <useparam name="id_slice_2week" />
      </call>
      <call group="sum" function="()" as="col_any_fact_1w">
        <fact column="isv_ad_evd_col_any_fact" condition="is_d0" />
      </call>
      <call group="sum" function="()" as="ostatok_do_1w">
        <fact column="ostatok_do" condition="is_d0" />
      </call>
      <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
        <fact column="col_any_fact_1w" />
        <fact column="isv_ad_evd_col_any_fact" condition="is_2week" />
      </call>
      <call function="-nvl" as="col_any_fact_1to0w" type="number" group="sum">
        <fact column="isv_ad_evd_col_any_fact" condition="is_cur" />
        <fact column="col_any_fact_1w" />
      </call>
      <call function="-nvl" as="ostatok_2to1w" type="number" group="sum">
        <fact column="ostatok_do" condition="is_2week" />
        <fact column="ostatok_do" condition="is_d0" />
      </call>
    </part>
    <part id="45676-detail-columns-new" timestamp="23.10.2020 21:26:38" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <column table="kod_isv_ad_evd" column="kod_ad_everyday" key="1" />
      <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" title="-" />
      <column table="kod_isv_ad_evd" column="kod_dop_contract" title="-" />
      <column table="ipr_kod_ispolnit" column="kod_direct" title="-" />
      <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" title="-" />
      <column table="ipr_kod_ispolnit" column="fl_branch" title="-" />
      <call function="||" as="year_gr1_name1" title="-">
        <const>'Заключенные '</const>
        <column table="kod_dt_cont_grp1" column="name1" />
      </call>
      <column table="ipr_kod_ispolnit" column="name" as="name_podr" title="-" />
      <column table="evd_fl_build_real" column="val" as="fl_build" title="-" />
      <call function="year" as="year_zakl" title="-">
        <column table="evd_dt_contract" column="val" />
      </call>
      <call function="year" as="year_otch" title="-">
        <useparam name="date_otch" />
      </call>
      <call function="-nvl" as="dyear" title="-">
        <column table="this" column="year_otch" group="no" />
        <column table="this" column="year_zakl" group="no" />
      </call>
      <call function="-nvl" type="number" as="prev_year1" title="-">
        <column table="this" column="year_otch" group="no" />
        <const>1</const>
      </call>
      <call function="-nvl" type="number" as="prev_year2" title="-">
        <column table="this" column="year_otch" group="no" />
        <const>2</const>
      </call>
      <column table="kod_isv_ad_evd" column="otch_list" title="-" />
      <column table="kod_isv_ad_evd" column="podr_name_titul" title="-" />
      <column table="evd_otch_list_3" column="val" as="otch_list_3" title="-" />
      <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" title="-" />
      <column table="kod_isv_ad_evd" column="pr_hoz_sposob" title="-" />
      <column table="kod_isv_ad_evd" column="pr_exist_pd" title="-" />
      <column table="evd_kod_list7" column="val" as="kod_list7" title="-" />
      <column table="evd_kodres" column="kod_direct" as="kodres" title="-" />
      <call function="row_num" as="npp" title="№ п/п" comment="не работает для динамики" exclude="1">
        <const>null</const>
      </call>
      <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
      <column table="is_ad_all" column="num_req" title="№ заявки" />
      <column table="is_ad_all" column="contr_sumf" />
      <column table="is_ad_all" column="name_vid_ad" exclude="1" />
      <column table="is_ad_all" column="contr_sum_m" />
      <column table="is_ad_all" column="contr_sum_e" />
      <column table="is_ad_all" column="contr_opl" />
      <column table="is_ad_all" column="contr_opl_d" />
      <column table="is_ad_all" column="contr_opl_i" />
      <column table="is_ad_all" column="zadol_opl" />
      <column table="is_ad_all" column="zadol_d" />
      <column table="is_ad_all" column="zadol_i" />
      <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
      <column table="is_ad_all" column="name_all" />
      <column table="is_ad_all" column="name_zayav" />
      <column table="is_ad_all" column="dt_contract" />
      <column table="is_ad_all" column="srok_uslug" />
      <column table="is_ad_all" column="fl_build" title="Наличие работ ЛЭ" as="fl_build2" />
      <column table="is_ad_all" column="fl_work_pu" title="Наличие работ ЛЭ" />
      <column table="is_ad_all" column="name_obj" />
      <column table="is_ad_all" column="kn_zone" />
      <column table="is_ad_all" column="filial" />
      <column table="is_ad_all" column="lp_addr" />
      <column table="is_ad_all" column="load123" />
      <column table="is_ad_all" column="load1" />
      <column table="is_ad_all" column="load2" />
      <column table="is_ad_all" column="load3" />
      <column table="is_ad_all" column="sum_load" title="Суммарная мощность" />
      <column table="is_ad_all" column="load_units" />
      <call function="rtrim" as="load_safe_cat" title="Категория надежности (заявл.)" type="string">
        <call function="case">
          <call function="when">
            <call function="gt">
              <call function="+nvl">
                <column table="is_ad_all" column="load1" />
                <column table="is_ad_all" column="load2" />
                <column table="is_ad_all" column="load3" />
              </call>
              <const>0</const>
            </call>
            <call function="||">
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load1" />
                  </call>
                  <const>0</const>
                </call>
                <const>'1, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load2" />
                  </call>
                  <const>0</const>
                </call>
                <const>'2, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load3" />
                  </call>
                  <const>0</const>
                </call>
                <const>'3, '</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="gt">
              <call function="+nvl">
                <column table="is_ad_all" column="load_sum1" />
                <column table="is_ad_all" column="load_sum2" />
                <column table="is_ad_all" column="load_sum3" />
              </call>
              <const>0</const>
            </call>
            <call function="||">
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum1" />
                  </call>
                  <const>0</const>
                </call>
                <const>'1, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum2" />
                  </call>
                  <const>0</const>
                </call>
                <const>'2, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum3" />
                  </call>
                  <const>0</const>
                </call>
                <const>'3, '</const>
              </call>
            </call>
          </call>
          <call function="else">
            <const>'3'</const>
          </call>
        </call>
        <const>', '</const>
      </call>
      <column table="is_ad_all" column="supply" />
      <column table="is_ad_all" column="supply1" />
      <column table="is_ad_all" column="name_status" />
      <column table="is_ad_all" column="vid_atp" />
      <column table="is_ad_all" column="dt_reg" title="Дата регистр. АТП" />
      <column table="is_ad_all" column="fl_rnk_not" />
      <column table="is_ad_all" column="read_to_close" />
      <column table="is_ad_all" column="dat_read_to_close" />
      <column table="is_ad_all" column="got_to_close" />
      <column table="is_ad_all" column="dat_got_to_close" />
      <column table="is_ad_all" column="status_ofz" />
      <column table="is_ad_all" column="vid_opl_ad" />
      <column table="is_ad_all" column="spos_vip" />
      <call function="-nvl" as="contr_sumf_ost" title="Остаток выручки">
        <column table="is_ad_all" column="contr_sumf" />
        <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
      </call>
      <call function="||" as="key" title="ключ">
        <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
        <column table="is_ad_all" column="num_req" title="№ заявки" />
      </call>
      <call function="case" as="sou_state" title="СОУ наступил/не наступил" type="string">
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const>1</const>
          </call>
          <const>'Выдан постоянный АТП'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const>1</const>
          </call>
          <const>'Расторгнут'</const>
        </call>
        <call function="when">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
          <const>'Просрочен'</const>
        </call>
        <call function="else">
          <const>'Текущий'</const>
        </call>
      </call>
      <call function="case" as="sou_state_reason" title="Причина нарушения СОУ" type="string" comment="причина нарушения СОУ - алгоритм заполнения в заявке 44535">
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const>1</const>
          </call>
          <const>'Выполнен'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const>1</const>
          </call>
          <const>'Расторгнут'</const>
        </call>
        <call function="when">
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
          <const>'Текущий'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="is_ad_all" column="vid_opl_ad" />
            <const>'ОДИ'</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dt_contract" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="fl_build_real" />
            <const>0</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dt_contract" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dataizm" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dataizm" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dat_read_to_close" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="status" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_build_real" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="is_ad_all" column="vid_opl_ad" />
              <const>'ОД'</const>
            </call>
          </call>
          <call function="case">
            <call function="when">
              <call function="is not null">
                <column table="is_ad_all" column="dat_got_to_close" />
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина обоюдная'</const>
            </call>
          </call>
        </call>
      </call>
      <band title="ВКС">
        <fact table="evd" column="status_vks_name_cur_x" title="Статус ВКС (текущий)" as="status_vks_name_cur_x" />
        <fact table="evd" column="status_vks_name_week_x" title="Статус ВКС (предыдущий)" as="status_vks_name_week_x" />
        <call function="if" as="podr_me_name" title="Перечень МЭ РС/ДСО" type="string">
          <call function="=">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <const>1</const>
          </call>
          <column table="kod_isv_ad_evd" column="podr_name_titul" />
        </call>
        <call function="to_char" title="Год договора" as="dog_year">
          <call function="year">
            <column table="is_ad_all" column="dt_contract" />
          </call>
        </call>
      </band>
      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
      <column table="kod_isv_ad_evd" column="kod_org_active" />
      <column table="kod_isv_ad_evd" column="status" />
      <column table="is_ad_all" column="name_rs" />
      <column table="is_ad_all" column="name_mo" />
      <column table="is_ad_all" column="name_sp" />
      <column table="is_ad_all" column="name_np" />
      <call function="nvl" as="name_rs_nvl" type="string">
        <column table="evd_kodres" column="name" />
        <const>'не заполнено'</const>
      </call>
      <call function="nvl" as="name_mo_nvl" type="string">
        <column table="this" column="name_mo" />
        <const>'не заполнено'</const>
      </call>
      <call function="nvl" as="name_sp_nvl" type="string">
        <column table="this" column="name_sp" />
        <const>'не заполнено'</const>
      </call>
      <call function="nvl" as="name_np_nvl" type="string">
        <column table="this" column="name_np" />
        <const>'не заполнено'</const>
      </call>
      <column table="kod_isv_ad_evd" column="name_kr" />
      <column table="kod_org_active" column="name" as="dzo" />
      <column table="kod_org_active" column="kod" />
      <column table="is_ad_all" column="sso" as="sso" />
      <column table="is_ad_all" column="vrem_tp" />
    </part>
    <part id="45676-49578-report-queries" timestamp="09.10.2020 14:57:27" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <query name="45676-title" as="t" title="Заголовок">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
      </query>
      <query name="45676-p1" as="p1" main="1" title="Перечень МЭ">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="fin_sum_nds_ofz" />
        </events>
      </query>
      <query name="45676-p2-1" as="p2" title="до 2015 с раб. кроме перечня">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3" as="p3" title="Форма ТП 1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3_dzo" as="p3dzo" title="Форма ТП 1 ДЗО" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query as="p4" title="Прил 2" name="45676-p4">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105" as="p5" main="1" title="Форма ТП 2">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="plan_nw_less" />
          <useaction event-name="double-click" column="plan_nw_more" />
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_fb">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_pu">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_both">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_fb_both">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_dzo" as="p5dzo" title="Форма ТП 2 ДЗО" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_w_dzo" as="p5wdzo" main="1" title="Форма ТП 2" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43841" as="p6" main="1" title="Карта">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1_var2" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1vs2w" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_12" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_13" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44502" as="p7" title="Форма ТП 1 СПбЭС и ПЭС">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-test" as="p8" title="Динамика изменений">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-dep" as="p9" title="Динамика изменений по филиалам">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
    </part>
    <part id="45676-ostatok-columns" timestamp="27.09.2018 11:57:58" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <call function="()" as="ostatok" group="sum" type="number" format="N0" halign="center">
        <fact column="isv_ad_evd_col_no_fact" />
      </call>
      <call function="le" dontpushpred="1" as="is_sou_do">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <useparam name="date_end_cur_Q" />
      </call>
      <call function="and" as="is_sou_late" dontpushpred="1">
        <call function="le" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_end_cur_Q" />
        </call>
        <call function="lt" dontpushpred="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <useparam name="date_otch" />
        </call>
      </call>
      <call function="ge" dontpushpred="1" as="is_sou_posle">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <useparam name="date_beg_next_Q" />
      </call>
      <call function="ge" dontpushpred="1" as="is_sou_posle2019">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <useparam name="date_beg_next_Y" />
      </call>
      <call function="lt" dontpushpred="1" as="is_sou_do2019">
        <column table="kod_isv_ad_evd" column="srok_uslug" />
        <useparam name="date_beg_next_Y" />
      </call>
      <call function="()" as="ostatok_do" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_do" />
      </call>
      <call function="()" as="ostatok_late" type="number" group="sum" format="N0" halign="center">
        <fact column="isv_ad_everyday_col_n" condition="is_sou_do" />
      </call>
      <call function="()" as="ostatok_posle" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_posle" />
      </call>
      <call function="()" as="ostatok_posle2019" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_posle2019" />
      </call>
      <call function="()" as="ostatok_do2019" type="number" group="sum" format="N0" halign="center">
        <fact column="ostatok" condition="is_sou_do2019" />
      </call>
    </part>
    <part id="45676-44864-grsets" timestamp="16.01.2019 16:09:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]atp">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'АТП'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]priost">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Приост'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]pretenz">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Претенз'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]rastorg">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Расторг'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]vipoln">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'РВУН'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]late">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Просроч'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ost1">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Ост1'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ost2">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Ост2'</const>
          </call>
        </where>
      </grset>
      <grset as="[:pfx]ost3">
        <where>
          <call function="=">
            <column table="this" column="st" />
            <const>'Ост3'</const>
          </call>
        </where>
      </grset>
      <grset title="из другого филиала" as="[:pfx]from_fil">
        <where>
          <call function="and">
            <call function="!=">
              <call function="nvl" comment="Исключаем новые заключенные АД (филиал пр недели null)">
                <column table="this" column="filial_week" />
                <column table="this" column="filial_curr" />
              </call>
              <column table="this" column="filial_curr" />
            </call>
            <call function="=">
              <column table="this" column="col_fact_curr" />
              <const>1</const>
            </call>
          </call>
        </where>
      </grset>
    </part>
    <part id="45676-detail-columns-test" timestamp="20.04.2018 17:11:40" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <column table="kod_isv_ad_evd" column="kod_ad_everyday" key="1" />
      <column table="kod_isv_ad_evd" column="isv_ad_everyday_id" title="-" />
      <column table="kod_isv_ad_evd" column="kod_dop_contract" title="-" />
      <column table="ipr_kod_ispolnit" column="kod_direct" title="-" />
      <column table="kod_dt_cont_grp1" column="kod" as="year_gr1" title="-" />
      <column table="ipr_kod_ispolnit" column="fl_branch" title="-" />
      <call function="||" as="year_gr1_name1" title="-">
        <const>'Заключенные '</const>
        <column table="kod_dt_cont_grp1" column="name1" />
      </call>
      <column table="ipr_kod_ispolnit" column="name" as="name_podr" title="-" />
      <column table="evd_fl_build_real" column="val" as="fl_build" title="-" />
      <call function="year" as="year_zakl" title="-">
        <column table="evd_dt_contract" column="val" />
      </call>
      <call function="year" as="year_otch" title="-">
        <useparam name="date_otch" />
      </call>
      <call function="-nvl" as="dyear" title="-">
        <column table="this" column="year_otch" group="no" />
        <column table="this" column="year_zakl" group="no" />
      </call>
      <call function="-nvl" type="number" as="prev_year1" title="-">
        <column table="this" column="year_otch" group="no" />
        <const>1</const>
      </call>
      <call function="-nvl" type="number" as="prev_year2" title="-">
        <column table="this" column="year_otch" group="no" />
        <const>2</const>
      </call>
      <column table="kod_isv_ad_evd" column="otch_list" title="-" />
      <column table="kod_isv_ad_evd" column="podr_name_titul" title="-" />
      <column table="evd_otch_list_3" column="val" as="otch_list_3" title="-" />
      <column table="evd_pr_ofz_vkl" column="val" as="pr_ofz_vkl" title="-" />
      <column table="kod_isv_ad_evd" column="pr_hoz_sposob" title="-" />
      <column table="kod_isv_ad_evd" column="pr_exist_pd" title="-" />
      <column table="evd_kod_list7" column="val" as="kod_list7" title="-" />
      <column table="evd_kodres" column="kod_direct" as="kodres" title="-" />
      <call function="row_num" as="npp" title="№ п/п" comment="не работает для динамики" exclude="1">
        <const>null</const>
      </call>
      <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
      <column table="is_ad_all" column="num_req" title="№ заявки" />
      <column table="is_ad_all" column="contr_sumf" />
      <column table="is_ad_all" column="name_vid_ad" exclude="1" />
      <column table="is_ad_all" column="contr_sum_m" />
      <column table="is_ad_all" column="contr_sum_e" />
      <column table="is_ad_all" column="contr_opl" />
      <column table="is_ad_all" column="contr_opl_d" />
      <column table="is_ad_all" column="contr_opl_i" />
      <column table="is_ad_all" column="zadol_opl" />
      <column table="is_ad_all" column="zadol_d" />
      <column table="is_ad_all" column="zadol_i" />
      <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
      <column table="is_ad_all" column="name_all" />
      <column table="is_ad_all" column="name_zayav" />
      <column table="is_ad_all" column="dt_contract" />
      <column table="is_ad_all" column="srok_uslug" />
      <column table="is_ad_all" column="fl_build" title="Наличие работ ЛЭ" as="fl_build2" />
      <column table="is_ad_all" column="name_obj" />
      <column table="is_ad_all" column="kn_zone" />
      <column table="is_ad_all" column="filial" />
      <column table="is_ad_all" column="lp_addr" />
      <column table="is_ad_all" column="load123" />
      <column table="is_ad_all" column="load1" />
      <column table="is_ad_all" column="load2" />
      <column table="is_ad_all" column="load3" />
      <column table="is_ad_all" column="sum_load" title="Суммарная мощность" />
      <column table="is_ad_all" column="load_units" />
      <call function="rtrim" as="load_safe_cat" title="Категория надежности (заявл.)" type="string">
        <call function="case">
          <call function="when">
            <call function="gt">
              <call function="+nvl">
                <column table="is_ad_all" column="load1" />
                <column table="is_ad_all" column="load2" />
                <column table="is_ad_all" column="load3" />
              </call>
              <const>0</const>
            </call>
            <call function="||">
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load1" />
                  </call>
                  <const>0</const>
                </call>
                <const>'1, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load2" />
                  </call>
                  <const>0</const>
                </call>
                <const>'2, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load3" />
                  </call>
                  <const>0</const>
                </call>
                <const>'3, '</const>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="gt">
              <call function="+nvl">
                <column table="is_ad_all" column="load_sum1" />
                <column table="is_ad_all" column="load_sum2" />
                <column table="is_ad_all" column="load_sum3" />
              </call>
              <const>0</const>
            </call>
            <call function="||">
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum1" />
                  </call>
                  <const>0</const>
                </call>
                <const>'1, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum2" />
                  </call>
                  <const>0</const>
                </call>
                <const>'2, '</const>
              </call>
              <call function="if">
                <call function="gt">
                  <call function="nvl0">
                    <column table="is_ad_all" column="load_sum3" />
                  </call>
                  <const>0</const>
                </call>
                <const>'3, '</const>
              </call>
            </call>
          </call>
          <call function="else">
            <const>'3'</const>
          </call>
        </call>
        <const>', '</const>
      </call>
      <column table="is_ad_all" column="supply" />
      <column table="is_ad_all" column="supply1" />
      <column table="is_ad_all" column="name_status" />
      <column table="is_ad_all" column="vid_atp" />
      <column table="is_ad_all" column="dt_reg" title="Дата регистр. АТП" />
      <column table="is_ad_all" column="fl_rnk_not" />
      <column table="is_ad_all" column="read_to_close" />
      <column table="is_ad_all" column="dat_read_to_close" />
      <column table="is_ad_all" column="got_to_close" />
      <column table="is_ad_all" column="dat_got_to_close" />
      <column table="is_ad_all" column="status_ofz" />
      <column table="is_ad_all" column="vid_opl_ad" />
      <column table="is_ad_all" column="spos_vip" />
      <call function="-nvl" as="contr_sumf_ost" title="Остаток выручки">
        <column table="is_ad_all" column="contr_sumf" />
        <column table="is_ad_all" column="sum_akts" title="Сумма выручки" />
      </call>
      <call function="||" as="key" title="ключ">
        <column table="is_ad_all" column="num_ouco" title="№ Уник.дог." />
        <column table="is_ad_all" column="num_req" title="№ заявки" />
      </call>
      <call function="case" as="sou_state" title="СОУ наступил/не наступил" type="string">
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const>1</const>
          </call>
          <const>'Выдан постоянный АТП'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const>1</const>
          </call>
          <const>'Расторгнут'</const>
        </call>
        <call function="when">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
          <const>'Просрочен'</const>
        </call>
        <call function="else">
          <const>'Текущий'</const>
        </call>
      </call>
      <call function="case" as="sou_state_reason" title="Причина нарушения СОУ" type="string" comment="причина нарушения СОУ - алгоритм заполнения в заявке 44535">
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const>1</const>
          </call>
          <const>'Выполнен'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const>1</const>
          </call>
          <const>'Расторгнут'</const>
        </call>
        <call function="when">
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
          <const>'Текущий'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="is_ad_all" column="vid_opl_ad" />
            <const>'ОДИ'</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dt_contract" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="fl_build_real" />
            <const>0</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dt_contract" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dataizm" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dataizm" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const>1</const>
          </call>
          <call function="case">
            <call function="when">
              <call function="lt">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <call function="trunc" type="date">
                  <column table="is_ad_all" column="dat_read_to_close" />
                </call>
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина заявителя'</const>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="status" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="kod_isv_ad_evd" column="fl_build_real" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="is_ad_all" column="vid_opl_ad" />
              <const>'ОД'</const>
            </call>
          </call>
          <call function="case">
            <call function="when">
              <call function="is not null">
                <column table="is_ad_all" column="dat_got_to_close" />
              </call>
              <const>'Вина СО'</const>
            </call>
            <call function="else">
              <const>'Вина обоюдная'</const>
            </call>
          </call>
        </call>
      </call>
      <band title="ВКС">
        <fact table="evd" column="status_vks_name_cur_x" title="Статус ВКС (текущий)" as="status_vks_name_cur_x" />
        <fact table="evd" column="status_vks_name_week_x" title="Статус ВКС (предыдущий)" as="status_vks_name_week_x" />
        <call function="if" as="podr_me_name" title="Перечень МЭ РС/ДСО" type="string">
          <call function="=">
            <column table="kod_isv_ad_evd" column="otch_list" />
            <const>1</const>
          </call>
          <column table="kod_isv_ad_evd" column="podr_name_titul" />
        </call>
        <call function="to_char" title="Год договора" as="dog_year">
          <call function="year">
            <column table="is_ad_all" column="dt_contract" />
          </call>
        </call>
      </band>
      <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
      <column table="kod_isv_ad_evd" column="kod_org_active" />
      <column table="kod_isv_ad_evd" column="status" />
    </part>
    <part id="45676-49578-column-Status" timestamp="27.09.2018 15:33:48" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <call function="case" type="string" title="Статус" as="st">
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_f" />
            <const>1</const>
          </call>
          <const>'АТП'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_i" />
            <const>1</const>
          </call>
          <const>'Приост'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l_2" />
            <const>1</const>
          </call>
          <const>'Претенз'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_l" />
            <const>1</const>
          </call>
          <const>'Расторг'</const>
        </call>
        <call function="when">
          <call function="=">
            <column table="kod_isv_ad_evd" column="col_p" />
            <const>1</const>
          </call>
          <const>'РВУН'</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_n" />
              <const>1</const>
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_end_cur_Q" />
            </call>
          </call>
          <const>'Просроч'</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p_2" />
              <const>1</const>
            </call>
            <call function="le">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_end_cur_Q" />
            </call>
          </call>
          <const>'Ост1'</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p_2" />
              <const>1</const>
            </call>
            <call function="=">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_next_Q" />
            </call>
            <call function="between" exclude="1">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_beg_next_Q" />
              <useparam name="date_end_cur_Y" />
            </call>
          </call>
          <const>'Ост2'</const>
        </call>
        <call function="when">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="col_p_2" />
              <const>1</const>
            </call>
            <call function="ge">
              <call function="trunc">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
                <const>'Q'</const>
              </call>
              <useparam name="date_beg_cur_Q_pl2" />
            </call>
            <call function="ge" exclude="1">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
              <useparam name="date_beg_next_Y" />
            </call>
          </call>
          <const>'Ост3'</const>
        </call>
      </call>
    </part>
    <part id="45676-49680-grsets" timestamp="10.10.2018 11:25:10" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]fil" order="fl_branch, kod_predpr">
        <group>
          <sourcelink table="ipr_kod_ispolnit" />
        </group>
        <grset as="[:pfx]rs" order="ostatok desc nulls last">
          <group>
            <sourcelink table="evd_kodres" />
          </group>
          <grset as="[:pfx]mo" order="ostatok desc nulls last">
            <group>
              <sourcelink table="evd_name_mo" />
            </group>
            <grset as="[:pfx]sp" order="ostatok desc nulls last">
              <group>
                <sourcelink table="evd_name_sp" />
              </group>
              <grset as="[:pfx]np" order="ostatok desc nulls last">
                <group>
                  <sourcelink table="evd_name_np" />
                </group>
              </grset>
            </grset>
          </grset>
        </grset>
      </grset>
    </part>
    <part id="45676-params" timestamp="17.01.2019 11:31:15" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <param name="kod_ispolnit" type="array" />
      <param name="id_slice" type="number">
        <const>852</const>
      </param>
      <param name="year" type="number">
        <const>2019</const>
      </param>
      <param name="kv" type="number">
        <const>1</const>
      </param>
      <param name="id_slice_week" type="number">
        <const>814</const>
      </param>
      <param name="id_slice_2week" type="number">
        <const>807</const>
      </param>
      <param name="id_slice_3week" type="number">
        <const>800</const>
      </param>
      <param name="id_slice_4week" type="number">
        <const>793</const>
      </param>
      <param name="date_otch" type="date">
        <const>to_date('17.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_from" type="date">
        <const>to_date('10.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_to" type="date">
        <const>to_date('17.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_last_week" type="date">
        <const>to_date('10.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_last_2week" type="date">
        <const>to_date('03.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_last_3week" type="date">
        <const>to_date('26.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_last_4week" type="date">
        <const>to_date('19.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="id_slice_range1" type="array">
        <const>(814,821)</const>
      </param>
      <param name="id_slice_range2" type="array">
        <const>(807,814,821)</const>
      </param>
      <param name="id_slice_range3" type="array">
        <const>(800,807,814,821)</const>
      </param>
      <param name="id_slice_range_0_1_4" type="array" />
      <param name="date_beg_cur_Q" type="date">
        <const>date'2018-10-01'</const>
      </param>
      <param name="date_end_cur_Q" type="date">
        <const>date'2018-12-31'</const>
      </param>
      <param name="date_beg_next_Q" type="date">
        <const>date'2019-01-01'</const>
      </param>
      <param name="date_beg_cur_Q_pl2" type="date">
        <const>date'2019-04-01'</const>
      </param>
      <param name="date_beg_next_Y" type="date">
        <const>date'2019-01-01'</const>
      </param>
      <param name="date_end_cur_Y" type="date">
        <const>date'2018-12-31'</const>
      </param>
      <param name="cur_year" type="number">
        <const>2019</const>
      </param>
      <param name="prev_year" type="number">
        <const>2018</const>
      </param>
      <param name="cur_year_minus_2" type="number">
        <const>2017</const>
      </param>
      <param name="cur_year_minus_3" type="number">
        <const>2016</const>
      </param>
      <param name="cur_year_minus_4" type="number">
        <const>2015</const>
      </param>
      <param name="next_year" type="number" />
      <param name="next_Q_1st_month" type="number" />
      <param name="next_Q_year" type="number" />
    </part>
    <part id="45676-49578-report-queries_51312_TEST" timestamp="18.01.2019 09:24:21" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <query name="45676-title" as="t" title="Заголовок">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
      </query>
      <query name="45676-p1_51312_TEST" as="p1" main="1" title="Перечень МЭ">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="fin_sum_nds_ofz" />
        </events>
      </query>
      <query name="45676-p2-1_51312_TEST" as="p2" title="до 2015 с раб. кроме перечня">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3_51312_TEST" as="p3" title="Форма ТП 1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3_dzo_51312_TEST" as="p3dzo" title="Форма ТП 1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query as="p4" title="Прил 2" name="45676-p4_51312_TEST">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_51312_TEST" as="p5" main="1" title="Форма ТП 2">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43841_51312_TEST" as="p6" main="1" title="Карта">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1_var2" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1vs2w" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_12" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_13" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44502_51312_TEST" as="p7" title="Форма ТП 1 СПбЭС и ПЭС">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-test_51312_TEST" as="p8" title="Динамика изменений">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-dep_51312_TEST" as="p9" title="Динамика изменений по филиалам">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
    </part>
    <part id="45676-p3_dzo-grsets" timestamp="26.02.2019 11:53:46" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="pfx" />
      </params>
      <grset as="[:pfx]all_no_rab">
        <where>
          <call function="=0">
            <column table="this" column="fl_build" />
          </call>
        </where>
      </grset>
      <grset as="[:pfx]all_rab">
        <where>
          <call function="=1">
            <column table="this" column="fl_build" />
          </call>
        </where>
        <grset as="[:pfx]all_rab_ygr3">
          <where>
            <call function="gt">
              <column table="this" column="dyear" />
              <const>2</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr2">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>2</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr1">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>1</const>
            </call>
          </where>
        </grset>
        <grset as="[:pfx]all_rab_ygr0">
          <where>
            <call function="=">
              <column table="this" column="dyear" />
              <const>0</const>
            </call>
          </where>
        </grset>
      </grset>
      <grset as="[:pfx]all_do">
        <where>
          <call function="=">
            <column table="this" column="fl_reestr_2018" />
            <const>1</const>
          </call>
        </where>
        <grset as="[:pfx]do_no_rab">
          <where>
            <call function="=0">
              <column table="this" column="fl_build" />
            </call>
          </where>
          <grset as="[:pfx]do_no_rab_do">
            <where>
              <call function="and">
                <call function="le">
                  <column table="this" column="year_zakl" />
                  <useparam name="cur_year_minus_2" />
                </call>
                <call function="is null" exclude="1">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_no_rab_pos">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                </call>
                <call function="is null" exclude="1">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_no_rab_dzo" exclude="1">
            <where>
              <call function="is not null">
                <column table="this" column="kod_org_active" />
              </call>
            </where>
          </grset>
        </grset>
        <grset as="[:pfx]do_rab">
          <where>
            <call function="=1">
              <column table="this" column="fl_build" />
            </call>
          </where>
          <grset as="[:pfx]do_rab_do">
            <where>
              <call function="and">
                <call function="le">
                  <column table="this" column="year_zakl" />
                  <useparam name="cur_year_minus_2" />
                </call>
                <call function="is null" exclude="1">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_rab_pos">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="year_zakl" />
                  <useparam name="prev_year" />
                </call>
                <call function="is null" exclude="1">
                  <column table="this" column="kod_org_active" />
                </call>
              </call>
            </where>
          </grset>
          <grset as="[:pfx]do_rab_dzo" exclude="1">
            <where>
              <call function="is not null">
                <column table="this" column="kod_org_active" />
              </call>
            </where>
          </grset>
        </grset>
      </grset>
      <grset as="[:pfx]all_tek">
        <where>
          <call function="and">
            <call function="ge">
              <column table="this" column="year_zakl" />
              <useparam name="cur_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="not in">
              <column table="this" column="status" />
              <array>
                <const>0</const>
                <const>2</const>
              </array>
            </call>
            <call function="!=">
              <column table="this" column="fl_reestr_2018" />
              <const>1</const>
            </call>
          </call>
        </where>
        <grset as="[:pfx]tek_no_rab">
          <where>
            <call function="=0">
              <column table="this" column="fl_build" />
            </call>
          </where>
        </grset>
        <grset as="[:pfx]tek_rab">
          <where>
            <call function="=1">
              <column table="this" column="fl_build" />
            </call>
          </where>
        </grset>
      </grset>
    </part>
    <part id="45676-49578-report-queries_unstable" timestamp="08.10.2020 18:39:50" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <query name="45676-title" as="t" title="Заголовок">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
      </query>
      <query name="45676-p1" as="p1" main="1" title="Перечень МЭ">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="fin_sum_nds_ofz" />
        </events>
      </query>
      <query name="45676-p2-1" as="p2" title="до 2015 с раб. кроме перечня">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3" as="p3" title="Форма ТП 1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-p3_dzo" as="p3dzo" title="Форма ТП 1 ДЗО" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query as="p4" title="Прил 2" name="45676-p4">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_f_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_n_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_i_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_l_2_range">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_unstable" as="p5" main="1" title="Форма ТП 2">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="plan_nw_less" />
          <useaction event-name="double-click" column="plan_nw_more" />
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_fb">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_pu">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_both">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff_fb_both">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_dzo" as="p5dzo" title="Форма ТП 2 ДЗО" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43105_w_dzo" as="p5wdzo" main="1" title="Форма ТП 2" exclude="1">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d2" column="col_any_fact_3w_avg">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" column="wait_kv1" />
          <useaction event-name="double-click" column="wait_end1" />
          <useaction event-name="double-click" column="wait_kv" />
          <useaction event-name="double-click" column="wait_end" />
          <useaction event-name="double-click" column="sou_unchanged_week" action-type="open-column-grouping-detail" call="45676-detail-d3">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d3" column="col_any_fact_week_diff">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-43841" as="p6" main="1" title="Карта">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1_var2" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1vs2w" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_12" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_13" exclude="1">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44502" as="p7" title="Форма ТП 1 СПбЭС и ПЭС">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_range">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="ostatok_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_2to1w">
            <usepart part="45676-withparams" />
          </useaction>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1" column="col_any_fact_1to0w">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-test" as="p8" title="Динамика изменений">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
      <query name="45676-44864-dep" as="p9" title="Динамика изменений по филиалам">
        <withparams>
          <usepart part="45676-withparams" />
        </withparams>
        <events>
          <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
            <usepart part="45676-withparams" />
          </useaction>
        </events>
      </query>
    </part>
    <part id="49928-params" timestamp="29.10.2018 15:07:35" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <param name="date_otch" type="date">
        <const>to_date('26.10.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_2709" type="date">
        <const>to_date('27.09.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_0810" type="date">
        <const>to_date('08.10.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_1510" type="date">
        <const>to_date('15.10.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_2210" type="date">
        <const>to_date('22.10.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_2910" type="date">
        <const>to_date('29.10.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_0511" type="date">
        <const>to_date('05.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_1211" type="date">
        <const>to_date('12.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_1911" type="date">
        <const>to_date('19.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_2611" type="date">
        <const>to_date('26.11.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_0312" type="date">
        <const>to_date('03.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="date_1012" type="date">
        <const>to_date('10.12.2018','DD.MM.YYYY')</const>
      </param>
      <param name="id_slice" type="number">
        <const>768</const>
      </param>
      <param name="id_slice_week" type="number">
        <const>761</const>
      </param>
      <param name="id_slice_2709" type="number">
        <const>739</const>
      </param>
      <param name="id_slice_0810" type="number">
        <const>750</const>
      </param>
      <param name="id_slice_1510" type="number">
        <const>757</const>
      </param>
      <param name="id_slice_2210" type="number">
        <const>764</const>
      </param>
      <param name="id_slice_2910" type="number">
        <const>771</const>
      </param>
      <param name="id_slice_0511" type="number">
        <const>778</const>
      </param>
      <param name="id_slice_1211" type="number">
        <const>785</const>
      </param>
      <param name="id_slice_1911" type="number">
        <const>792</const>
      </param>
      <param name="id_slice_2611" type="number">
        <const>799</const>
      </param>
      <param name="id_slice_0312" type="number">
        <const>806</const>
      </param>
      <param name="id_slice_1012" type="number">
        <const>813</const>
      </param>
      <param name="id_slice_range" type="array">
        <const>(739, 750, 757, 764, 771, 778, 785, 792, 799, 806, 813)</const>
      </param>
      <param name="id_slice_range1" type="array">
        <const>(761, 768)</const>
      </param>
      <param name="year" type="number">
        <const>2018</const>
      </param>
      <param name="kv" type="number">
        <const>3</const>
      </param>
      <param name="date_beg_cur_Q" type="date">
        <const>date'2018-10-01'</const>
      </param>
      <param name="date_end_cur_Q" type="date">
        <const>date'2018-12-31'</const>
      </param>
      <param name="cur_year" type="number">
        <const>2018</const>
      </param>
      <param name="prev_year" type="number">
        <const>2017</const>
      </param>
    </part>
    <part id="49928-withparams" timestamp="29.10.2018 15:07:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <useparam name="date_otch" />
      <useparam name="date_2709" />
      <useparam name="date_0810" />
      <useparam name="date_1510" />
      <useparam name="date_2210" />
      <useparam name="date_2910" />
      <useparam name="date_0511" />
      <useparam name="date_1211" />
      <useparam name="date_1911" />
      <useparam name="date_2611" />
      <useparam name="date_0312" />
      <useparam name="date_1012" />
      <useparam name="id_slice" />
      <useparam name="id_slice_week" />
      <useparam name="id_slice_2709" />
      <useparam name="id_slice_0810" />
      <useparam name="id_slice_1510" />
      <useparam name="id_slice_2210" />
      <useparam name="id_slice_2910" />
      <useparam name="id_slice_0511" />
      <useparam name="id_slice_1211" />
      <useparam name="id_slice_1911" />
      <useparam name="id_slice_2611" />
      <useparam name="id_slice_0312" />
      <useparam name="id_slice_1012" />
      <useparam name="id_slice_range" />
      <useparam name="id_slice_range1" />
      <useparam name="year" />
      <useparam name="kv" />
      <useparam name="date_beg_cur_Q" />
      <useparam name="date_end_cur_Q" />
      <useparam name="cur_year" />
      <useparam name="prev_year" />
    </part>
  </parts>
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="45676" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" timestamp="07.10.2020 16:25:42" form="45676-49578" table_select="1" folder="kido" mode="excel" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" format-source="45676-format.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <usepart part="45676-49578-report-queries" />
      </queries>
    </report>
    <report name="45676-current" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (текущий)" nogrid="1" timestamp="08.10.2018 11:16:50" form="45676-current" table_select="1" folder="kido" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" format-source="45676-format.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <usepart part="45676-49578-report-queries" />
      </queries>
    </report>
    <report name="45676-43105-test" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (43105-test)" nogrid="1" timestamp="01.02.2018 17:37:30" form="45676" table_select="1" folder="kido" visible="0" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676_43105.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" format-source="45676-format.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <query name="45676-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="45676-43105" as="p5" main="1" title="Лист 5">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="45676-43841-test" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (43841-test)" timestamp="01.02.2018 17:37:30" form="45676" table_select="1" folder="kido" visible="0" mode="excel" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676_43841.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="45676-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="45676-43841" as="p6" main="1" title="Лист 6">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d-ft-2to1w" column="col_12">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d-ft-1to0w" column="col_13">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="45676-44502-test" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (44502-test)" timestamp="01.02.2018 17:37:30" form="45676" table_select="1" folder="kido" visible="0" mode="excel" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676_44502.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="45676-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="45676-44502" as="p7" main="1" title="Лист 7">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d-ft-2to1w" column="col_12">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d-ft-1to0w" column="col_13">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="45676-temp" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (тестовый)" timestamp="30.06.2021 21:37:28" form="45676-49578_51312_TEST" table_select="1" folder="kido" mode="excel" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676-temp.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" format-source="45676-temp-format.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <usepart part="45676-49578-report-queries" />
        <usepart part="45676-49578-report-queries_51312_TEST" exclude="1" />
      </queries>
    </report>
    <report name="45676-44864-test" title="Динамика изменения состояний абонентских договоров (44864-test)" timestamp="24.04.2018 16:46:12" form="45676" table_select="1" folder="kido" visible="0" mode="excel" nogrid="1" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676_44864.xlsx" print-proc="2" print-xlsx="1" title="Детализация динамики данных" />
        </excel>
      </print-templates>
      <queries>
        <query name="45676-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="45676-44864-test" as="p8" main="1" title="Динамика ЛЭ">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
        <query name="45676-44864-dep" as="p9" main="1" title="Динамика по филиалам">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-test">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="45676-49680" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ в разрезе населенных пунктов" timestamp="09.10.2018 14:26:01" form="45676-49578" table_select="1" folder="kido" mode="excel" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676-49680.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ в разрезе населенных пунктов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="45676-title" as="t" title="Заголовок">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="45676-49680" as="p10">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d1w" column="col_any_fact_1w">
              <usepart part="45676-withparams" />
            </useaction>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45676-detail-d4w" column="col_any_fact_4w">
              <usepart part="45676-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="45676-test_WebMethodRep" timestamp="12.10.2018 15:37:33" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param type="number" name="kod_dop" />
      </params>
      <queries>
        <query name="45676-is_dop_contract_test" as="a">
          <withparams>
            <useparam name="kod_dop" />
          </withparams>
          <query name="is_spr_direct" as="b">
            <call function="=">
              <column table="a" column="kod_filial" />
              <column table="b" column="kod_direct" />
            </call>
          </query>
        </query>
      </queries>
    </report>
    <report name="test_WebMethodRep_2" timestamp="15.10.2018 19:58:31" multi-select="1" title="Test Some Description" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param type="number" name="pwrc_id" />
      </params>
      <queries>
        <query name="test_jv_rep_cons_d_fl" as="fil">
          <withparams>
            <useparam name="kod_fl" />
            <useparam name="pwrc_id" />
          </withparams>
          <query name="test_hv_eopwrc" as="pwrc">
            <withparams>
              <useparam name="kod_fl" />
              <useparam name="pwrc_id" />
            </withparams>
            <call function="=">
              <column table="fil" column="kod_fl" />
              <column table="pwrc" column="bal_id" />
            </call>
            <query as="fdr" name="hv_eopwrc_fdrs">
              <call function="=">
                <column column="pwrc_id" table="pwrc" />
                <column column="pwrc_id" table="fdr" />
              </call>
            </query>
          </query>
        </query>
      </queries>
    </report>
    <report name="45676_unstable" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ (ТЕСТ)" timestamp="09.10.2020 17:50:06" form="45676-49578" table_select="1" folder="kido" mode="excel" nogrid="1" visible="0" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="45676_unstable.xlsx" title="Информация об исполнении договоров на ТП Перечня Минэнерго РФ" print-proc="2" print-xlsx="1" format-source="45676-format_unstable.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <usepart part="45676-49578-report-queries_unstable" />
      </queries>
    </report>
    <report name="49928" title="Об исполнении Приказа от 02.10.2018 № 452 (тестовая)" timestamp="30.10.2018 16:44:44" form="49928" mode="excel" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <params>
        <usepart part="49928-params" />
      </params>
      <procedure>
        begin
        is_job.set_id_slice(:id_slice);
        
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="49928.xlsx" title="Об исполнении Приказа от 02.10.2018 № 452" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="49928-1" as="q1">
          <withparams>
            <usepart part="49928-withparams" />
          </withparams>
          <events>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_27_0710">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_08_1410">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_15_2110">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_22_2810">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_29_0411">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_05_1111">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_12_1811">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_19_2511">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_26_0212">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_03_0912">
              <usepart part="49928-withparams" />
            </useaction>
            <useaction action-type="open-column-grouping-detail" call="49928-detail-d" event-name="double-click" column="col_any_fact_total">
              <usepart part="49928-withparams" />
            </useaction>
          </events>
        </query>
        <query name="49928-2" as="q2">
          <withparams>
            <usepart part="49928-withparams" />
          </withparams>
          <events>
            <useaction event-name="double-click" action-type="open-column-grouping-detail" call="49928-detail">
              <usepart part="49928-withparams" />
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="53419" timestamp="20.07.2019 12:54:16" form="53419" table_select="1" mode="excel" nogrid="1" title="Вынос сетей 1" visible="0" file="sql.builder.templates\sql.builder\projects\vks45676\reports\53419-rep.xml">
      <params>
        <usepart part="45676-params" />
      </params>
      <procedure>
        begin
          is_job.set_id_slice(:id_slice);
        end;
      </procedure>
      <customers>
        <customer id="17" />
      </customers>
      <print-templates>
        <excel>
          <template name="53419.xlsx" title="Вынос сетей 1" print-proc="2" print-xlsx="1" format-source="53419-format.xlsx" />
        </excel>
      </print-templates>
      <queries>
        <query name="53419-title" as="t">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
        <query name="53419_vs1" as="p5">
          <withparams>
            <usepart part="45676-withparams" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="45676-49578" timestamp="12.04.2021 20:45:25" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <usefield field="kido_kod_direct" name="kod_ispolnit" />
      <usefield field="kido_id_slice_2" column-mandatory="1">
        <defaultquery>
          <query name="45676-id_slice_cur" />
        </defaultquery>
      </usefield>
      <fieldgroup title="Квартал отчета" part-id="45676-kv_otcheta">
        <usefield field="asuse_year2" mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_year" />
          </defaultquery>
        </usefield>
        <usefield field="asuse_kv" column-mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_kv" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты" part-id="45676-contr-slices-fields">
        <usefield field="kido_id_slice_2" name="id_slice_week" title="Неделя" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_2week" title="2 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_2week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_3week" title="3 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_3week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_4week" title="4 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_4week" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты" part-id="45676-contr-dates-fields">
        <usefield field="cmn_date" name="date_otch" title="Отчетная дата" column-mandatory="1" column-editable="0" column-visible="0">
          <defaultquery>
            <query name="45676-date-otch-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_from" title="Неделя" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-from-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_to" title="Конец недели" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-to-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_week" title="Неделя" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_2week" title="2 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-2week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_3week" title="3 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-3week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_4week" title="4 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-4week-def" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 1" name="id_slice_range1" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range1" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 2" name="id_slice_range2" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range2" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 3" name="id_slice_range3" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range3" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны (тек, пр нед, нед -4)" name="id_slice_range_0_1_4" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range_0_1_4" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q" column-mandatory="1" column-editable="0" title="Первая дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Q" column-mandatory="1" column-editable="0" title="Последняя дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Q" column-mandatory="1" column-editable="0" title="Первая дата следующего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q_pl2" column-mandatory="1" column-editable="0" title="Первая дата квартала + 2" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q_pl2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Y" column-mandatory="1" column-editable="0" title="Первая дата следующего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Y" column-mandatory="1" column-editable="0" title="Последняя дата текущего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year" column-mandatory="1" column-editable="0" title="Год отчета" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="prev_year" column-mandatory="1" column-editable="0" title="Предыдущий год" column-visible="0">
          <defaultquery>
            <query name="45676-49578-prev_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_2" column-mandatory="1" column-editable="0" title="Позапрошлый год" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_3" column-mandatory="1" column-editable="0" title="Текущий год минус 3" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_3" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_4" column-mandatory="1" column-editable="0" title="Текущий год минус 4" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_4" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_year" column-mandatory="1" column-editable="0" title="Следующий год" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_Q_1st_month" column-mandatory="1" column-editable="0" title="Первый месяц следующего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_Q_1st_month-for_47522" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_Q_year" column-mandatory="1" column-editable="0" title="Год следуюшего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_Q_year" />
          </defaultquery>
        </usefield>
      </fieldgroup>
    </form>
    <form name="45676-current" timestamp="01.10.2018 15:05:45" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <usefield field="ipr_kod_direct_no_rights" name="kod_ispolnit" exclude="1" />
      <usefield field="kido_kod_direct" name="kod_ispolnit" />
      <usepart part="45676-kv_otcheta" />
      <usefield field="kido_id_slice" column-mandatory="1">
        <defaultquery>
          <query name="is_ad_all_slice_current" />
        </defaultquery>
      </usefield>
      <usepart part="45676-contr-dates-fields" />
      <usepart part="45676-contr-slices-fields" />
    </form>
    <form name="45676-49578_51312_TEST" timestamp="30.09.2019 14:51:59" file="sql.builder.templates\sql.builder\projects\vks45676\reports\45676-rep.xml">
      <usefield field="kido_kod_direct" name="kod_ispolnit" />
      <usefield field="kido_id_slice_2" column-mandatory="1">
        <defaultquery>
          <query name="45676-id_slice_cur" />
        </defaultquery>
      </usefield>
      <fieldgroup title="Квартал отчета">
        <usefield field="asuse_year2" mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_year_51312_TEST" />
          </defaultquery>
        </usefield>
        <usefield field="asuse_kv" column-mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_kv_51312_TEST" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты">
        <usefield field="kido_id_slice_2" name="id_slice_week" title="Неделя" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_2week" title="2 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_2week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_3week" title="3 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_3week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_4week" title="4 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_4week" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты">
        <usefield field="cmn_date" name="date_otch" title="Отчетная дата" column-mandatory="1" column-editable="0" column-visible="0">
          <defaultquery>
            <query name="45676-date-otch-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_from" title="Неделя" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-from-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_to" title="Конец недели" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-to-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_week" title="Неделя" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_2week" title="2 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-2week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_3week" title="3 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-3week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_4week" title="4 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-4week-def" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 1" name="id_slice_range1" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range1" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 2" name="id_slice_range2" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range2" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 3" name="id_slice_range3" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range3" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны (тек, пр нед, нед -4)" name="id_slice_range_0_1_4" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range_0_1_4" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q" column-mandatory="1" column-editable="0" title="Первая дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Q" column-mandatory="1" column-editable="0" title="Последняя дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Q" column-mandatory="1" column-editable="0" title="Первая дата следующего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q_pl2" column-mandatory="1" column-editable="0" title="Первая дата квартала + 2" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q_pl2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Y" column-mandatory="1" column-editable="0" title="Первая дата следующего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Y" column-mandatory="1" column-editable="0" title="Последняя дата текущего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year" column-mandatory="1" column-editable="0" title="Год отчета" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="prev_year" column-mandatory="1" column-editable="0" title="Предыдущий год" column-visible="0">
          <defaultquery>
            <query name="45676-49578-prev_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_2" column-mandatory="1" column-editable="0" title="Позапрошлый год" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_3" column-mandatory="1" column-editable="0" title="Текущий год минус 3" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_3" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year_minus_4" column-mandatory="1" column-editable="0" title="Текущий год минус 4" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year_minus_4" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_year" column-mandatory="1" column-editable="0" title="Следующий год" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_Q_1st_month" column-mandatory="1" column-editable="0" title="Первый месяц следующего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_Q_1st_month-for_47522" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_Q_year" column-mandatory="1" column-editable="0" title="Год следуюшего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_Q_year" />
          </defaultquery>
        </usefield>
      </fieldgroup>
    </form>
    <form name="49928" timestamp="31.10.2018 18:48:19" file="sql.builder.templates\sql.builder\projects\vks45676\reports\49928.xml">
      <usefield field="kido_id_slice_2" column-mandatory="1">
        <defaultquery>
          <query name="45676-id_slice_cur" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_otch" title="Отчетная дата" column-visible="0">
        <defaultquery>
          <query name="45676-date-otch-def" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_otch" title="Отчетная дата" exclude="1" column-visible="0">
        <defaultquery>
          <query name="49928-date_otch" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_2709" title="Дата 27.09.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_2709" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_0810" title="Дата 08.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_0810" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_1510" title="Дата 15.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_1510" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_2210" title="Дата 22.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_2210" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_2910" title="Дата 29.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_2910" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_0511" title="Дата 05.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_0511" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_1211" title="Дата 12.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_1211" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_1911" title="Дата 19.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_1911" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_2611" title="Дата 26.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_2611" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_0312" title="Дата 03.12.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_0312" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_1012" title="Дата 10.12.18" column-visible="0">
        <defaultquery>
          <query name="49928-date_1012" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice" title="Срез отчетной даты" exclude="1" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice" />
        </defaultquery>
      </usefield>
      <usefield field="kido_id_slice_2" name="id_slice_week" title="Неделя" column-visible="0">
        <defaultquery>
          <query name="45676-id_slice_week" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_2709" title="Срез 27.09.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_2709" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_0810" title="Срез 08.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_0810" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_1510" title="Срез 15.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_1510" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_2210" title="Срез 22.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_2210" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_2910" title="Срез 29.10.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_2910" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_0511" title="Срез 05.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_0511" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_1211" title="Срез 12.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_1211" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_1911" title="Срез 19.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_1911" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_2611" title="Срез 26.11.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_2611" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_0312" title="Срез 03.12.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_0312" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="id_slice_1012" title="Срез 10.12.18" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_1012" />
        </defaultquery>
      </usefield>
      <usefield field="kido_id_slice_m" name="id_slice_range" title="Массив срезов, кроме cur" column-visible="0">
        <defaultquery>
          <query name="49928-id_slice_range" />
        </defaultquery>
      </usefield>
      <usefield field="kido_id_slice_m" title="Выбранные диапазоны 1" name="id_slice_range1" column-visible="0">
        <defaultquery>
          <query name="45676-id_slice_range1" />
        </defaultquery>
      </usefield>
      <usefield field="asuse_year2" column-visible="0">
        <defaultquery>
          <query name="45676-49578_def_year" />
        </defaultquery>
      </usefield>
      <usefield field="asuse_kv" column-visible="0">
        <defaultquery>
          <query name="45676-49578_def_kv" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_beg_cur_Q" title="Первая дата текущего квартала" column-visible="0">
        <defaultquery>
          <query name="45676-49578-date_beg_cur_Q" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_date" name="date_end_cur_Q" title="Последняя дата текущего квартала" column-visible="0">
        <defaultquery>
          <query name="45676-49578-date_end_cur_Q" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="cur_year" title="Год отчета" column-visible="0">
        <defaultquery>
          <query name="45676-49578-cur_year" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" name="prev_year" title="Предыдущий год" column-visible="0">
        <defaultquery>
          <query name="45676-49578-prev_year" />
        </defaultquery>
      </usefield>
    </form>
    <form name="53419" timestamp="20.07.2019 13:03:03" file="sql.builder.templates\sql.builder\projects\vks45676\reports\53419-rep.xml">
      <usefield field="kido_id_slice_2" column-mandatory="1">
        <defaultquery>
          <query name="45676-id_slice_cur" />
        </defaultquery>
      </usefield>
      <fieldgroup title="Квартал отчета">
        <usefield field="asuse_year2" mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_year" />
          </defaultquery>
        </usefield>
        <usefield field="asuse_kv" column-mandatory="1" column-visible="0" column-editable="0">
          <defaultquery>
            <query name="45676-49578_def_kv" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты">
        <usefield field="kido_id_slice_2" name="id_slice_week" title="Неделя" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_2week" title="2 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_2week" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_2" name="id_slice_3week" title="3 недели" column-mandatory="1">
          <defaultquery>
            <query name="45676-id_slice_3week" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <fieldgroup title="Контрольные даты">
        <usefield field="cmn_date" name="date_otch" title="Отчетная дата" column-mandatory="1" column-editable="0" column-visible="0">
          <defaultquery>
            <query name="45676-date-otch-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_from" title="Неделя" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-from-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_to" title="Конец недели" column-mandatory="1" column-visible="0">
          <defaultquery>
            <query name="45676-date-to-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_week" title="Неделя" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_2week" title="2 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-2week-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_last_3week" title="3 недели" column-visible="0">
          <defaultquery>
            <query name="45676-date-last-3week-def" />
          </defaultquery>
        </usefield>
        <usefield field="kido_id_slice_m" title="Выбранные диапазоны 2" name="id_slice_range2" column-visible="0">
          <defaultquery>
            <query name="45676-id_slice_range2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q" column-mandatory="1" column-editable="0" title="Первая дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Q" column-mandatory="1" column-editable="0" title="Последняя дата текущего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Q" column-mandatory="1" column-editable="0" title="Первая дата следующего квартала" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Q" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_cur_Q_pl2" column-mandatory="1" column-editable="0" title="Первая дата квартала + 2" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_cur_Q_pl2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_beg_next_Y" column-mandatory="1" column-editable="0" title="Первая дата следующего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_beg_next_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_date" name="date_end_cur_Y" column-mandatory="1" column-editable="0" title="Последняя дата текущего года" column-visible="0">
          <defaultquery>
            <query name="45676-49578-date_end_cur_Y" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="cur_year" column-mandatory="1" column-editable="0" title="Год отчета" column-visible="0">
          <defaultquery>
            <query name="45676-49578-cur_year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_integer" name="next_year" column-mandatory="1" column-editable="0" title="Следующий год" column-visible="0">
          <defaultquery>
            <query name="45676-48004-next_year" />
          </defaultquery>
        </usefield>
      </fieldgroup>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>