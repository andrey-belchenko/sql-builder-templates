<?xml version="1.0" encoding="utf-8"?>
<root>
  <reports />
  <queries>
    <query name="45676-43105-47522-temp" timestamp="01.10.2018 15:36:32">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=1" as="is_hoz" dontpushpred="1">
          <column table="evd_pr_hoz_sposob" column="val" />
        </call>
        <call function="=1" as="is_podr_dog" dontpushpred="1">
          <call function="if" type="number" title="подр. дог не хоз. спос.">
            <call function="=0">
              <column table="evd_pr_hoz_sposob" column="val" />
            </call>
            <column table="evd_pr_exist_pd" column="val" />
          </call>
        </call>
        <call function="and" as="is_not_hs_pd" dontpushpred="1">
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <call function="=0" as="is_not_hs_pd" dontpushpred="1">
            <call function="if" type="number" title="подр. дог не хоз. спос.">
              <call function="=0">
                <column table="evd_pr_hoz_sposob" column="val" />
              </call>
              <column table="evd_pr_exist_pd" column="val" />
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_nxt1_2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_year" />
            <call function="year" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">2018</const>
          </call>
          <call function="ge">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_Q_1st_month" />
            <call function="month" exclude="1">
              <useparam name="date_beg_next_Q" />
            </call>
            <const exclude="1">7</const>
          </call>
        </call>
        <call as="is_sou_nxt2" function="and">
          <call function="ge" dontpushpred="1">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
            <const exclude="1">2019</const>
          </call>
        </call>
        <call as="is_sou_cur" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
        </call>
        <call function="and" as="is_sou_pr" dontpushpred="1">
          <call function="lt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_otch" />
          </call>
        </call>
        <call function="and" as="is_sou_mon_total" exclude="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
        </call>
        <call as="is_sou_mon0" function="and">
          <call function="le" dontpushpred="1">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <call function="ym2 end time">
              <call function="+">
                <call function="*">
                  <call function="year">
                    <useparam name="date_otch" />
                  </call>
                  <const>100</const>
                </call>
                <call function="month">
                  <useparam name="date_otch" />
                </call>
              </call>
            </call>
          </call>
        </call>
        <call function="le" as="is_sou_mon0" dontpushpred="1" exclude="1">
          <column table="kod_isv_ad_evd" column="srok_uslug" />
          <const>date'2018-03-31'</const>
        </call>
        <call function="and" as="is_sou_mon1" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon2" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>2</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon3" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon4" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon5" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>5</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon6" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon7" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>7</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon8" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>8</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon9" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>9</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon10" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>10</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon11" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>11</const>
          </call>
        </call>
        <call function="and" as="is_sou_mon12" dontpushpred="1">
          <call function="=">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="cur_year" />
            <const exclude="1">2018</const>
          </call>
          <call function="=">
            <call function="month">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <const>12</const>
          </call>
        </call>
        <call function="lt" as="is_sou_kv" dontpushpred="1" exclude="1">
          <call function="trunc">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
          </call>
          <useparam name="date_end_kv" />
        </call>
        <call function="()" as="col_any_fact_hoz" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_hoz" />
        </call>
        <call function="()" as="col_any_fact_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_any_fact_not_hs_pd" type="number" group="sum">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt1_2" />
        </call>
        <call function="()" as="col_no_fact_cur" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_cur" />
        </call>
        <call function="()" as="col_no_fact_nxt2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_nxt2" />
        </call>
        <call function="()" as="col_no_fact_cur_hoz" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_cur_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_cur_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_not_hs_pd" />
        </call>
        <call function="()" as="col_no_fact_pr" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_sou_pr" />
        </call>
        <call function="()" as="col_no_fact_pr_hoz" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_hoz" />
        </call>
        <call function="()" as="col_no_fact_pr_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_podr_dog" />
        </call>
        <call function="()" as="col_no_fact_pr_not_hs_pd" type="number" group="sum">
          <fact column="col_no_fact_pr" condition="is_not_hs_pd" />
        </call>
        <call group="sum" as="col_no_fact_mon_total" type="number" function="()" exclude="1">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon_total" />
        </call>
        <call function="()" as="col_no_fact_mon0" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon0" />
        </call>
        <call function="()" as="col_no_fact_mon1" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon1" />
        </call>
        <call function="()" as="col_no_fact_mon2" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon2" />
        </call>
        <call function="()" as="col_no_fact_mon3" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon3" />
        </call>
        <call function="()" as="col_no_fact_mon4" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon4" />
        </call>
        <call function="()" as="col_no_fact_mon5" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon5" />
        </call>
        <call function="()" as="col_no_fact_mon6" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon6" />
        </call>
        <call function="()" as="col_no_fact_mon7" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon7" />
        </call>
        <call function="()" as="col_no_fact_mon8" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon8" />
        </call>
        <call function="()" as="col_no_fact_mon9" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon9" />
        </call>
        <call function="()" as="col_no_fact_mon10" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon10" />
        </call>
        <call function="()" as="col_no_fact_mon11" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon11" />
        </call>
        <call function="()" as="col_no_fact_mon12" type="number" group="sum">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_mon12" />
        </call>
        <call function="=" as="is_cur" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_3week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_3week" />
        </call>
        <call function="=" as="is_2week" dontpushpred="1">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_2week" />
        </call>
        <call function="-nvl" as="col_any_fact_week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="and" as="is_fact_week" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=0">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_any_fact" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="-nvl" as="col_any_fact_3week" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_3week" />
          <fact column="col_no_fact_cur" condition="is_cur" />
        </call>
        <call function="-nvl" as="col_any_fact_2to1w" type="number" group="sum">
          <fact column="col_no_fact_cur" condition="is_2week" />
          <fact column="col_no_fact_cur" condition="is_week" />
        </call>
        <call function="and" as="is_sou_changed1_1" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_end_cur_Q" />
            <const exclude="1">date'2018-06-30'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                      <const exclude="1">date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed1_2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="and" dontpushpred="1">
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <useparam name="date_end_cur_Q" />
                      <const exclude="1">date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou_changed2" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <call function="year">
              <column table="kod_isv_ad_evd" column="srok_uslug" />
            </call>
            <useparam name="next_year" />
            <const exclude="1">2019</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="lt">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_year" />
                      <const exclude="1">2019</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_sou2019p" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="ge">
            <column table="kod_isv_ad_evd" column="srok_uslug" />
            <useparam name="date_beg_next_Y" />
            <const exclude="1">date'2019-01-01'</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
          <call function="!=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
        </call>
        <call function="and" as="is_ispoln" dontpushpred="1">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="=">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="gt">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_vost" dontpushpred="1" comment="вернулось из факта в остаток">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="gt">
            <call function="+nvl">
              <column table="kod_isv_ad_evd" column="col_n" />
              <column table="kod_isv_ad_evd" column="col_p_2" />
            </call>
            <const>0</const>
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice_week" />
                    </call>
                    <call function="=">
                      <call function="+nvl">
                        <column table="kod_isv_ad_evd" column="col_n" />
                        <column table="kod_isv_ad_evd" column="col_p_2" />
                      </call>
                      <const>0</const>
                    </call>
                    <call function="=">
                      <call function="year">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_year" />
                      <const exclude="1">2018</const>
                    </call>
                    <call function="ge">
                      <call function="month">
                        <column table="kod_isv_ad_evd" column="srok_uslug" />
                      </call>
                      <useparam name="next_Q_1st_month" />
                      <call function="month" exclude="1">
                        <useparam name="date_beg_next_Q" />
                      </call>
                      <const exclude="1">7</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_plus" dontpushpred="1" comment="договоров не было в данных на начало недели">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_nxt1_1_minus" dontpushpred="1" comment="договоров не стало в данных на тек дату">
          <call function="and">
            <call function="=">
              <column table="kod_isv_ad_evd" column="id_slice" />
              <useparam name="id_slice_week" />
            </call>
            <call function="gt">
              <call function="+nvl">
                <column table="kod_isv_ad_evd" column="col_n" />
                <column table="kod_isv_ad_evd" column="col_p_2" />
              </call>
              <const>0</const>
            </call>
            <call function="=">
              <call function="year">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_year" />
              <const exclude="1">2018</const>
            </call>
            <call function="ge">
              <call function="month">
                <column table="kod_isv_ad_evd" column="srok_uslug" />
              </call>
              <useparam name="next_Q_1st_month" />
              <call function="month" exclude="1">
                <useparam name="date_beg_next_Q" />
              </call>
              <const exclude="1">7</const>
            </call>
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="()" as="sou_changed1_1" type="number" group="sum" title="было СОУ 1кв2018 - продлено">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_1" />
        </call>
        <call function="()" as="sou_changed1_2" type="number" group="sum" title="продлено на 2-4кв.2018">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed1_2" />
        </call>
        <call function="()" as="sou_changed2" type="number" group="sum" title="продлено на 2019">
          <fact column="isv_ad_evd_col_no_fact" condition="is_sou_changed2" />
        </call>
        <call function="-nvl" title="Факт за неделю в т.ч. без продления" group="sum" as="sou_unchanged_week" nvl="0">
          <fact column="col_any_fact_week" nvl="0" />
          <fact column="sou_changed1_1" nvl="0" />
          <fact column="sou_changed1_2" nvl="0" exclude="1" />
          <fact column="sou_changed2" nvl="0" exclude="1" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_week" type="number" group="sum">
          <fact column="col_no_fact_nxt1_2" condition="is_week" />
        </call>
        <call function="()" as="col_no_fact_nxt1_1_ispoln" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_ispoln" />
        </call>
        <call function="()" as="col_no_fact_nxt1_2_to_2019" type="number" group="sum">
          <fact column="isv_ad_evd_count" condition="is_sou2019p" />
        </call>
        <call function="-nvl" group="sum" as="col_no_fact_nxt1_1_zakl" comment="прирост выводится с минусом">
          <call function="+nvl">
            <fact column="isv_ad_evd_count" condition="is_nxt1_1_plus" />
            <fact column="isv_ad_evd_count" condition="is_vost" />
          </call>
          <fact column="isv_ad_evd_count" condition="is_nxt1_1_minus" />
        </call>
        <call function="!=" as="is_not_fl_reestr_2018_fact">
          <column table="kod_isv_ad_evd" column="fl_reestr_2018_fact" />
          <const>1</const>
        </call>
        <call group="sum" as="col_any_fact_2018" title="Исполнено за 2018 год" type="number" function="()">
          <fact column="isv_ad_evd_col_any_fact" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_hoz_2018" type="number" function="()">
          <fact column="col_any_fact_hoz" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_pd_2018" type="number" function="()">
          <fact column="col_any_fact_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
        <call group="sum" as="col_any_fact_not_hs_pd_2018" type="number" function="()">
          <fact column="col_any_fact_not_hs_pd" condition="is_not_fl_reestr_2018_fact" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" />
        <column column="kod_predpr" as="kod_predpr" table="ipr_kod_ispolnit" />
        <column table="ipr_kod_ispolnit" column="fl_branch" />
        <call function="if" as="pr_exist_pd_nh" type="number" title="подр. дог не хоз. спос.">
          <call function="=0">
            <column table="evd_pr_hoz_sposob" column="val" />
          </call>
          <column table="evd_pr_exist_pd" column="val" />
        </call>
        <column table="evd_pr_hoz_sposob" column="val" as="pr_hoz_sposob" />
        <call function="year" as="year_zakl" group="max">
          <column table="kod_isv_ad_evd" column="dt_contract" />
        </call>
        <fact column="isv_ad_everyday_col_plan" as="col_plan" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_any_fact" as="col_any_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_f" as="col_f" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_i" as="col_i" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l" as="col_l" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_l_2" as="col_l_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_everyday_col_p" as="col_p" nvl="0" group="sum" table="evd_cur" />
        <fact column="isv_ad_evd_col_no_fact" as="col_no_fact" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt1_2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_nxt2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_cur_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_hoz" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_pr_not_hs_pd" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_any_fact_week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_3week" nvl="0" group="sum" table="evd" />
        <fact column="col_any_fact_2to1w" nvl="0" group="sum" table="evd" />
        <call function="()" as="col_any_fact_3w_avg" group="sum">
          <call function="/">
            <fact column="col_any_fact_3week" nvl="0" table="evd" />
            <const>3</const>
          </call>
        </call>
        <call function="()" as="col_any_fact_mon_avg" group="sum">
          <call function="*">
            <call function="/">
              <fact column="col_any_fact_3week" nvl="0" table="evd" />
              <const>21</const>
            </call>
            <call function="/">
              <const column="col_any_fact_3week" nvl="0" table="evd">365</const>
              <const>12</const>
            </call>
          </call>
        </call>
        <call as="col_any_fact_mon_avg0" function="()" group="sum">
          <call function="if">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column column="col_any_fact_mon_avg" nvl="0" table="this" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="round" as="weeks_to_end" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <const name="date_end_year" exclude="1">date'2018-06-30'</const>
                <useparam name="date_end_cur_Q" />
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="round" as="weeks_to_end2" group="max">
          <call function="/">
            <call function="+">
              <call function="-">
                <useparam name="date_end_cur_Y" />
                <const name="date_end_year" exclude="1">date'2018-12-31'</const>
                <useparam name="date_otch" />
              </call>
              <const>1</const>
            </call>
            <const>7</const>
          </call>
          <const>0</const>
        </call>
        <call function="*" as="wait_end1" group="sum">
          <column table="this" column="col_any_fact_3w_avg" group="no" />
          <column table="this" column="weeks_to_end" group="no" />
        </call>
        <call function="()" group="sum" as="wait_end">
          <call function="if" type="number">
            <call function="gt">
              <call function="over">
                <call function="sum">
                  <column table="this" column="wait_end1" group="no" />
                </call>
                <call function="partition by">
                  <column table="ipr_kod_ispolnit" column="kod_direct" />
                </call>
              </call>
              <const>0</const>
            </call>
            <column table="this" column="wait_end1" group="no" />
            <const>0</const>
          </call>
        </call>
        <call function="if" as="wait_end" type="number" exclude="1">
          <call function="gt">
            <column table="this" column="wait_end1" group="sum" />
            <const>0</const>
          </call>
          <column table="this" column="wait_end1" group="sum" />
          <const>0</const>
        </call>
        <fact column="sou_changed1_2" group="sum" table="evd" nvl="0" />
        <fact column="sou_changed2" group="sum" table="evd" nvl="0" />
        <fact column="sou_unchanged_week" table="evd" group="sum" nvl="0" />
        <fact column="col_no_fact_nxt1_2_week" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018" nvl="0" />
        <fact column="col_no_fact_nxt1_2_to_2019" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018. Продлено на 2019" nvl="0" />
        <fact column="col_no_fact_nxt1_1_zakl" table="evd" group="sum" title="Остаток плана на 1 кв. 2018 Заключено" nvl="0" />
        <fact column="col_no_fact_nxt1_1_ispoln" table="evd" group="sum" title="Остаток плана на 2-4 кв. 2018 Исполнено" nvl="0" />
        <fact table="evd_cur" column="col_no_fact_mon_total" group="sum" nvl="0" exclude="1" />
        <fact column="col_no_fact_mon0" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon1" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon2" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon3" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon4" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon5" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon6" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon7" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon8" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon9" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon10" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon11" nvl="0" group="sum" table="evd_cur" />
        <fact column="col_no_fact_mon12" nvl="0" group="sum" table="evd_cur" />
        <column table="kod_isv_ad_evd" column="fl_fake" />
        <fact group="sum" table="evd_cur" column="col_any_fact_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_hoz_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_pd_2018" nvl="0" />
        <fact group="sum" table="evd_cur" column="col_any_fact_not_hs_pd_2018" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" />
          <link name="kod_isv_ad_evd" />
          <link name="evd_otch_list_3" />
          <link name="evd_fl_build_real" />
          <link name="evd_dt_contract" />
          <link name="evd_pr_hoz_sposob" />
          <link name="evd_pr_exist_pd" />
          <link name="id_slice" />
          <dimset as="evd">
            <where>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range2" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
          <dimset as="evd_cur">
            <where>
              <call function="=">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <useparam name="cur_year" />
                    <const exclude="1">2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
              <call function="=1">
                <column table="evd_fl_build_real" column="val" />
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <grset as="by_dep" title="По филиалам" order="fl_branch, kod_predpr">
            <where exclude="1">
              <call function="in">
                <column table="this" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </where>
            <group>
              <sourcelink table="ipr_kod_ispolnit" />
            </group>
          </grset>
          <grset as="all_p" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_exist_pd_nh" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_p" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
          <grset as="all_h" title="Итог">
            <where>
              <call function="or">
                <call function="=1">
                  <column table="this" column="pr_hoz_sposob" />
                </call>
                <call function="=">
                  <column table="this" column="fl_fake" />
                  <const>1</const>
                </call>
              </call>
            </where>
            <grset as="by_dep_h" title="По филиалам" order="fl_branch, name_podr">
              <where exclude="1">
                <call function="in">
                  <column table="this" column="kod_direct" />
                  <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
                </call>
              </where>
              <group>
                <sourcelink table="ipr_kod_ispolnit" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45676-44864-test2" timestamp="20.06.2018 14:09:22">
      <params>
        <usepart part="45676-params" />
      </params>
      <expressions>
        <call function="=" as="is_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice" />
        </call>
        <call function="=" as="is_week" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="id_slice" column="id_slice" />
          <useparam name="id_slice_week" />
        </call>
        <call function="=" as="is_rab" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>1</const>
        </call>
        <call function="=" as="is_norab" dontpushpred="1" part-id="45676-44864-expr2">
          <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
          <const>0</const>
        </call>
        <call function="and" as="is_new" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice" />
          </call>
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice_week" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_f_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_f" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_i_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_i" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_2_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l_2" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_l_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_l" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_col_p_curr" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_late" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_n" />
                      <const>1</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost1" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="le">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-06-30'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost2" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="between">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2018-07-01'</const>
                      <const>date'2018-12-31'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="and" as="is_ost3" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="=" exclude="1">
            <column table="kod_isv_ad_evd" column="id_slice" />
            <useparam name="id_slice_week" />
          </call>
          <call function="=1">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="and">
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="id_slice" />
                      <useparam name="id_slice" />
                    </call>
                    <call function="=">
                      <column table="kod_isv_ad_evd" column="col_p_2" />
                      <const>1</const>
                    </call>
                    <call function="ge">
                      <column table="kod_isv_ad_evd" column="srok_uslug" />
                      <const>date'2019-01-01'</const>
                    </call>
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_curr" part-id="45676-44864-expr2">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="over" type="number" title=" " group="max" as="fl_build_week" part-id="45676-44864-expr2">
          <call function="max">
            <call function="if">
              <call function="=">
                <column table="kod_isv_ad_evd" column="id_slice" />
                <useparam name="id_slice_week" />
              </call>
              <column table="kod_isv_ad_evd" column="fl_build_real">1</column>
            </call>
          </call>
          <call function="partition by">
            <column table="kod_isv_ad_evd" column="kod_dop_contract" />
          </call>
        </call>
        <call function="()" as="col_fact_week" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_week" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_fact_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_f_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_f_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_i_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_i_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_2_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_l_2_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_l_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_l_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="col_p_curr" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_col_p_curr" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="late" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_late" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost1" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost1" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost2" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost2" column="isv_ad_evd_count" />
        </call>
        <call function="()" as="ost3" type="number" group="sum" part-id="45676-44864-expr2">
          <fact condition="is_ost3" column="isv_ad_evd_count" />
        </call>
        <call group="sum" type="number" as="new_col_f" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_f" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_i" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_i" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l2" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_l_2" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_l" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_l" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_col_p" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_p" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_late" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_everyday_col_n" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_col_no_fact" condition="is_new" />
        </call>
        <call group="sum" type="number" as="new_ost1" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost1" />
        </call>
        <call group="sum" type="number" as="new_ost2" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost2" />
        </call>
        <call group="sum" type="number" as="new_ost3" function="()" part-id="45676-44864-expr2">
          <fact column="new_ost" condition="is_ost3" />
        </call>
        <call group="sum" type="number" as="new_cnt" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_new" />
        </call>
        <call group="sum" type="number" as="cur_cnt" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_curr" />
        </call>
        <call group="sum" type="number" as="cur_cnt_rab" function="()" part-id="45676-44864-expr2">
          <fact column="cur_cnt" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="cur_cnt_norab" function="()" part-id="45676-44864-expr2">
          <fact column="cur_cnt" condition="is_norab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_rab" function="()" part-id="45676-44864-expr2">
          <fact column="col_fact_week" condition="is_rab" />
        </call>
        <call group="sum" type="number" as="col_fact_week_norab" function="()" part-id="45676-44864-expr2">
          <fact column="col_fact_week" condition="is_norab" />
        </call>
        <call function="and" as="is_not_in_cur" dontpushpred="1" part-id="45676-44864-expr2">
          <call function="is null">
            <call function="over" type="number" title=" ">
              <call function="max">
                <call function="if">
                  <call function="=">
                    <column table="kod_isv_ad_evd" column="id_slice" />
                    <useparam name="id_slice" />
                  </call>
                  <const>1</const>
                </call>
              </call>
              <call function="partition by">
                <column table="kod_isv_ad_evd" column="kod_dop_contract" />
              </call>
            </call>
          </call>
        </call>
        <call group="sum" type="number" as="exclude_from_vks" function="()" part-id="45676-44864-expr2">
          <fact column="isv_ad_evd_count" condition="is_not_in_cur" />
        </call>
      </expressions>
      <select>
        <column table="ipr_kod_ispolnit" column="kod_direct" part-id="45676-44864-select2" />
        <column table="ipr_kod_ispolnit" column="name" as="name_podr" part-id="45676-44864-select2" />
        <call function="||" as="list_name" part-id="45676-44864-select2">
          <const>'Анализ '</const>
          <column table="ipr_kod_ispolnit" column="name_kr" />
        </call>
        <column table="kod_isv_ad_evd" column="st_det" as="st" group="max" part-id="45676-44864-select2" exclude="1" />
        <call as="st" title="Статус" group="max" function="()" part-id="45676-44864-select2" type="string">
          <usepart part="45676-48004-column-Status" />
        </call>
        <fact column="col_fact_week" nvl="0" group="sum" title="Кол-во на начало периода" part-id="45676-44864-select2" />
        <fact column="col_fact_curr" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="col_f_curr" nvl="0" group="sum" title="в АТП" part-id="45676-44864-select2" />
        <fact nvl="0" group="sum" title="в Приост" column="col_i_curr" part-id="45676-44864-select2" />
        <fact column="col_l_2_curr" nvl="0" group="sum" title="в Претенз" part-id="45676-44864-select2" />
        <fact column="col_l_curr" nvl="0" group="sum" title="в Расторг" part-id="45676-44864-select2" />
        <fact column="col_p_curr" nvl="0" group="sum" title="в РВУН" part-id="45676-44864-select2" />
        <fact column="late" nvl="0" group="sum" title="в Просроченные" part-id="45676-44864-select2" />
        <fact column="ost1" nvl="0" group="sum" title="в Остаток (период1)" part-id="45676-44864-select2" />
        <fact column="ost2" nvl="0" group="sum" title="в Остаток (период2)" part-id="45676-44864-select2" />
        <fact column="ost3" nvl="0" group="sum" title="в Остаток (период3)" part-id="45676-44864-select2" />
        <fact column="new_col_f" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact nvl="0" group="sum" column="new_col_i" part-id="45676-44864-select2" />
        <fact column="new_col_l2" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_col_l" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_col_p" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_late" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost1" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost2" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="new_ost3" nvl="0" group="sum" part-id="45676-44864-select2" />
        <fact column="fl_build_curr" group="max" part-id="45676-44864-select2" />
        <fact column="fl_build_week" group="max" part-id="45676-44864-select2" />
        <call function="year" as="year_zakl" group="max" part-id="45676-44864-select2">
          <column table="evd_dt_contract" column="val" />
        </call>
        <fact table="evd2" group="sum" column="cur_cnt" part-id="45676-44864-select2" />
        <fact table="evd2" as="week_cnt" group="sum" column="col_fact_week" part-id="45676-44864-select2" />
        <fact table="evd2" as="evd_cnt" group="sum" column="isv_ad_evd_count" part-id="45676-44864-select2" />
        <fact table="evd2" group="sum" column="cur_cnt_rab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="cur_cnt_norab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_rab" part-id="45676-44864-select2" nvl="0" />
        <fact table="evd2" group="sum" column="col_fact_week_norab" part-id="45676-44864-select2" nvl="0" />
        <fact column="new_cnt" nvl="0" group="sum" part-id="45676-44864-select2" />
        <column table="evd_fl_build_real" column="val" as="fl_build_real" part-id="45676-44864-select2" />
        <call function="if" as="to_rab" type="number" group="sum" nvl="0" part-id="45676-44864-select2">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="cur_cnt" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="to_norab" type="number" group="sum" nvl="0" part-id="45676-44864-select2">
          <call function="and">
            <call function="=">
              <fact column="fl_build_week" table="evd2" />
              <const>1</const>
            </call>
            <call function="=">
              <fact table="evd2" column="fl_build_curr" />
              <const>0</const>
            </call>
            <call function="=">
              <fact table="evd2" column="cur_cnt" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <fact column="exclude_from_vks" nvl="0" group="sum" part-id="45676-44864-select2" />
      </select>
      <from>
        <qube>
          <link name="ipr_kod_ispolnit" part-id="45676-44864-qube2" />
          <link name="kod_isv_ad_evd" part-id="45676-44864-qube2" />
          <link name="evd_otch_list_3" part-id="45676-44864-qube2" />
          <link name="evd_dt_contract" part-id="45676-44864-qube2" />
          <link name="evd_pr_hoz_sposob" part-id="45676-44864-qube2" />
          <link name="evd_pr_exist_pd" part-id="45676-44864-qube2" />
          <link name="id_slice" part-id="45676-44864-qube2" />
          <where part-id="45676-44864-qube2">
            <call function="and">
              <call function="is not null">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
              </call>
              <call function="is not null">
                <column table="evd_dt_contract" column="val" />
              </call>
              <call function="or">
                <call function="=">
                  <column table="kod_isv_ad_evd" column="fl_reestr_2018" />
                  <const>1</const>
                </call>
                <call function="and">
                  <call function="ge">
                    <column table="this" column="year_zakl" />
                    <const>2018</const>
                  </call>
                  <call function="not in">
                    <column table="kod_isv_ad_evd" column="status" />
                    <array>
                      <const>0</const>
                      <const>2</const>
                    </array>
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="id_slice" column="id_slice" />
                <useparam name="id_slice_range1" />
                <array name="id_slice_range2" exclude="1">
                  <useparam name="id_slice" />
                  <useparam name="id_slice_week" />
                </array>
              </call>
              <call function="in" exclude="1">
                <column table="ipr_kod_ispolnit" column="kod_direct" />
                <array name="id_slice_range2">19, 20, 21, 22, 24, 26, 27</array>
              </call>
            </call>
          </where>
          <dimset as="evd2" part-id="45676-44864-qube2">
            <link name="evd_fl_build_real" />
            <where exclude="1">
              <call function="=">
                <const>1</const>
                <const>1</const>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping materialize-type="temp-table">
        <grset as="all" title="Итог">
          <usepart part="45676-44864-grsets">
            <const>''</const>
          </usepart>
        </grset>
        <grset title="с работами" as="rab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'rab_'</const>
          </usepart>
        </grset>
        <grset title="без работ" as="norab">
          <where>
            <call function="or">
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="fl_build_real" />
              </call>
            </call>
          </where>
          <usepart part="45676-44864-grsets">
            <const>'norab_'</const>
          </usepart>
        </grset>
        <grset title="новые с работами" as="rab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="новые без работ" as="norab_new">
          <where>
            <call function="and">
              <call function="is null">
                <column table="this" column="fl_build_week" />
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из безработных" as="from_norab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset title="из работных" as="from_rab">
          <where>
            <call function="and">
              <call function="=">
                <column table="this" column="fl_build_week" />
                <const>1</const>
              </call>
              <call function="=">
                <column table="this" column="fl_build_curr" />
                <const>0</const>
              </call>
              <call function="=">
                <column table="this" column="col_fact_curr" />
                <const>1</const>
              </call>
            </call>
          </where>
        </grset>
        <grset as="by_dep" title="По филиалам" order="name_podr" exclude="1">
          <usepart part="45676-44864-grsets">
            <const>'dep_'</const>
          </usepart>
          <group>
            <sourcelink table="ipr_kod_ispolnit" />
          </group>
          <grset title="с работами" as="dep_rab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>1</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="evd_cnt" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_rab_'</const>
            </usepart>
          </grset>
          <grset title="без работ" as="dep_norab" exclude="1">
            <where>
              <call function="or">
                <call function="and">
                  <call function="=">
                    <column table="this" column="fl_build_week" />
                    <const>0</const>
                  </call>
                  <call function="=">
                    <column table="this" column="fl_build_curr" />
                    <const>0</const>
                  </call>
                </call>
                <call function="is not null">
                  <column table="this" column="fl_build" />
                </call>
              </call>
            </where>
            <usepart part="45676-44864-grsets">
              <const>'dep_norab_'</const>
            </usepart>
          </grset>
          <grset title="новые с работами" as="dep_rab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="новые без работ" as="dep_norab_new">
            <where>
              <call function="and">
                <call function="is null">
                  <column table="this" column="fl_build_week" />
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из безработных" as="dep_from_norab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>0</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>1</const>
                </call>
              </call>
            </where>
          </grset>
          <grset title="из работных" as="dep_from_rab">
            <where>
              <call function="and">
                <call function="=">
                  <column table="this" column="fl_build_week" />
                  <const>1</const>
                </call>
                <call function="=">
                  <column table="this" column="fl_build_curr" />
                  <const>0</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
    </query>
  </queries>
  <parts />
  <forms />
</root>