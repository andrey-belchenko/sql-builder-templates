<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="vr_rb_fact" class="1" timestamp="15.04.2021 02:39:58">
      <select>
        <column table="a" column="rowid" as="id " key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <call as="bal_id_act" function="case">
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Лупполово">59071</const>
            </call>
            <const comment="ВВ ЭС -&gt; ПрЭС">12968</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Северная долина">208972</const>
            </call>
            <const comment="ВВ ЭС -&gt; КС">13082</const>
          </call>
          <call function="else">
            <column table="a" column="bal_id" />
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_nas_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_nas_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <call function="if" as="count_tu_mkd" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_mkd_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_mkd_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_mkd_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_mkd_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_mkd_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_izs" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_izs_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_izs_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_izs_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_izs_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_izs_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_ul_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_ul_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_ul_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_pwrc_g" as="pwrc_id" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id_act" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl_real" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl_real" column="kod_fl" />
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="pwrc_id" table="a" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="bal_id" table="a" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="def_fdr" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="a" column="bal_id" />
              <column table="def_fdr" column="kod_fl" />
            </call>
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="not in">
          <column table="a" column="bal_id" />
          <const>(13082, 12968)</const>
        </call>
      </where>
    </query>
    <query name="vr_rb_fact_test" class="1" timestamp="20.02.2019 21:33:33">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <call as="bal_id_act" function="case">
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Лупполово">59071</const>
            </call>
            <const comment="ВВ ЭС -&gt; ПрЭС">12968</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <const comment="Северная долина">208972</const>
            </call>
            <const comment="ВВ ЭС -&gt; КС">13082</const>
          </call>
          <call function="else">
            <column table="a" column="bal_id" />
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_nas_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_nas_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="kg_name" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="kod_fl" column="ym" exclude="1" />
        <column table="kod_fl" column="ym" as="ym_dat" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id_act" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym_dat" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
            <call function="=" exclude="1">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="not in">
          <column table="a" column="bal_id" />
          <const>(13082, 12968)</const>
        </call>
      </where>
    </query>
    <query name="vr_rb_fact_test2" class="1" timestamp="24.01.2023 07:27:31">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <column table="a" column="wp_in_raw" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum">
          <call function="if">
            <call function="=">
              <call function="nvl0">
                <column table="k_gr_f_tp" column="exclude_auto_fdr" />
              </call>
              <const>0</const>
            </call>
            <column table="a" column="wp_in" />
          </call>
          <column table="a" column="wp_in" exclude="1" />
        </call>
        <call function="if" as="wp_in_raw_fdr" type="number" is-fact="1" agg="max">
          <call function="=">
            <call function="nvl0">
              <column table="k_gr_f_tp" column="exclude_auto_fdr" />
            </call>
            <const>0</const>
          </call>
          <column table="a" column="wp_in_raw" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="wp_out_raw" type="number" title="" />
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="constypex" type="string" />
        <column table="a" column="count_tu_auto" type="number" />
        <column table="a" column="count_tu_hand" type="number" />
        <column table="a" column="count_tu_no" type="number" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call type="number" function="if" as="wp_out_raw_fdr" is-fact="1" agg="max">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <column table="a" column="wp_out_raw" />
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <call function="if" as="count_tp_le" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp" type="number" title="" />
        </call>
        <call function="if" as="count_tp_le_0null" type="number" is-fact="1" agg="sum">
          <call function="!=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <call function="+">
            <column table="a" column="count_tp_0" type="number" title="" />
            <column table="a" column="count_tp_null" type="number" title="" />
          </call>
        </call>
        <call function="if" as="count_tp_potr_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_0" type="number" title="" />
        </call>
        <call function="if" as="count_tp_potr_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="tp_id" column="srcbalname" />
            <const>'ПОТР.'</const>
          </call>
          <column table="a" column="count_tp_null" type="number" title="" />
        </call>
        <call function="if" as="count_tu_ul" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_nas" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'НАСЕЛЕНИЕ'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_mkd" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_izs" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu" />
        </call>
        <call function="if" as="count_tu_ul_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_ul_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_mkd_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_izs_0" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_0" />
        </call>
        <call function="if" as="count_tu_mkd_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_izs_null" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_null" />
        </call>
        <call function="if" as="count_tu_ul_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_mkd_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_izs_auto" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_auto" />
        </call>
        <call function="if" as="count_tu_ul_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_mkd_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_izs_hand" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_hand" />
        </call>
        <call function="if" as="count_tu_ul_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constype" />
            <const>'ЮЛ'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_mkd_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'МКД'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <call function="if" as="count_tu_izs_no" type="number" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="constypex" />
            <const>'ИЖС'</const>
          </call>
          <column table="a" column="count_tu_no" />
        </call>
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym_dat" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="def_fdr" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_fdr" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_fact_52733" class="1" timestamp="23.05.2019 19:35:45">
      <select>
        <column table="a" column="rowid" as="rid" key="1" exclude="1" />
        <column table="a" column="dat" type="date" title="" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" exclude="1" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" exclude="1" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" exclude="1" />
        <column table="a" column="constype" type="string" title="" exclude="1" />
        <column table="a" column="wp_in" type="number" title="" exclude="1" />
        <call as="wp_in_fdr" function="nvl0" is-fact="1" agg="sum" exclude="1">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_in_fdr" is-fact="1" agg="sum" />
        <column table="a" column="wp_out" type="number" title="" exclude="1" />
        <column table="a" column="id_dat" type="number" is-private-dimension="id_dat" is-final-dimension="id_dat" dimension="id_dat" exclude="1" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="constypex" type="string" exclude="1" />
        <column table="a" column="count_tu_auto" type="number" exclude="1" />
        <column table="a" column="count_tu_hand" type="number" exclude="1" />
        <column table="a" column="count_tu_no" type="number" exclude="1" />
        <column table="a" column="count_tp" type="number" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tp_0" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tp_null" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu_0" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <column table="a" column="count_tu_null" type="number" title="" is-fact="1" agg="sum" exclude="1" />
        <call type="number" function="if" as="wp_out_fdr" is-fact="1" agg="sum" exclude="1">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <column table="a" column="wp_out_fdr" is-fact="1" agg="sum" />
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
      </select>
      <from>
        <query name="vr_rb_fact_52733_presum" as="a" />
        <table name="vr_rb_fact" as="a" exclude="1" />
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=" exclude="1">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
    <query name="vr_rb_fact_52733_presum" class="1" timestamp="23.05.2019 19:50:31">
      <select>
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" group="1" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" group="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" group="1" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" group="1" />
        <column table="a" column="ym" type="number" group="1" />
        <column table="a" column="wp_in_fdr" type="number" title="" group="sum" />
        <column table="a" column="wp_out_fdr" type="number" title="" group="sum" />
      </select>
      <from>
        <query name="vr_rb_fact_tbl" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_tbl" class="1" timestamp="23.05.2019 19:28:17">
      <select>
        <column table="a" column="rowid" as="rid" key="1" />
        <column table="a" column="dat" type="date" title="" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="constype" type="string" title="" />
        <column table="a" column="wp_in" type="number" title="" />
        <call as="wp_in_fdr" function="nvl0">
          <column table="a" column="wp_in" />
        </call>
        <column table="a" column="wp_out" type="number" title="" />
        <column table="a" column="id_dat" type="number" />
        <column table="a" column="ym" type="number" />
        <column table="a" column="constypex" type="string" />
        <column table="a" column="count_tu_auto" type="number" />
        <column table="a" column="count_tu_hand" type="number" />
        <column table="a" column="count_tu_no" type="number" />
        <column table="a" column="count_tp" type="number" />
        <column table="a" column="count_tp_0" type="number" title="" />
        <column table="a" column="count_tp_null" type="number" title="" />
        <column table="a" column="count_tu" type="number" title="" />
        <column table="a" column="count_tu_0" type="number" title="" />
        <column table="a" column="count_tu_null" type="number" title="" />
        <call type="number" function="if" as="wp_out_fdr">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <call function="nvl">
            <column table="a" column="wp_out" />
            <const>0</const>
          </call>
          <const>0</const>
        </call>
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
      </select>
      <from>
        <table name="vr_rb_fact" as="a" />
      </from>
    </query>
    <query name="vr_rb_fact_52733_2" class="1" timestamp="28.05.2021 17:58:25">
      <select>
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="Филиал" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="src_fdrid" type="number" />
        <column table="a" column="ym" type="number" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="a" column="wp_in" is-fact="1" agg="sum" as="wp_in_fdr" exclude="1" />
        <column table="a" column="wp_in" type="number" />
        <call type="number" function="if" as="wp_in_fdr" is-fact="1" agg="sum">
          <call function="=">
            <call function="nvl0">
              <column table="k_gr_f_tp" column="exclude_auto_fdr" />
            </call>
            <const>0</const>
          </call>
          <column table="this" column="wp_in" />
        </call>
        <column table="a" column="wp_out" is-fact="1" agg="sum" as="wp_out_fdr" />
        <column table="a" column="wp_out_1" as="wp_out_fdr_1" is-fact="1" agg="sum" />
        <column table="a" column="wp_out_2" as="wp_out_fdr_2" is-fact="1" agg="sum" />
        <column table="a" column="wp_out_3" as="wp_out_fdr_3" is-fact="1" agg="sum" />
        <column table="a" column="pnt_fdr" type="number" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid" type="number" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_1" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_2" is-fact="1" agg="sum" />
        <column table="a" column="pnt_grid_3" is-fact="1" agg="sum" />
        <call function="||-" as="tp_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="tp_id" column="srcbalname" />
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <column table="kod_fl" column="ym" as="ym_dat" />
        <column table="def_pwrc" column="kod_id" is-private-dimension="def_pwrc" is-final-dimension="def_pwrc" dimension="def_pwrc" />
        <column table="kod_fl" column="kod_fl" />
        <call as="grid_dtl_kg" function="||-">
          <column table="a" column="pwrc_fdrid" />
          <column table="a" column="src_fdrid" />
          <column table="a" column="ym" />
        </call>
      </select>
      <from>
        <table name="vr_rb_fact_presum_52733" as="a" exclude="1" />
        <query name="vr_rb_fact_presum_52733" as="a" />
        <query name="vr_rb_eq_kg" as="pwrc_grid_dtl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="grid_dtl_kg" />
            <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
            <call function="replace" exclude="1">
              <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
              <const>9999.99</const>
              <column table="this" column="ym" />
            </call>
          </call>
        </query>
        <query name="vr_rb_tp" as="tp_id" join="left outer">
          <call function="=">
            <column table="this" column="tp_id" />
            <column table="tp_id" column="tp_id" />
          </call>
        </query>
        <query name="vr_rb_fider" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vr_rb_filial" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1" exclude="1">
          <call function="=">
            <column table="this" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="this" column="tp_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="=">
            <column table="this" column="k_gr_f_tp" />
            <column table="k_pwrc_fdr" column="k_gr_f_tp" />
          </call>
        </query>
        <query as="pwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc_g">
          <call function="=">
            <column column="m2m_pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
        <query as="hv_eopwrc_id" dimension="1" is-final-dimension="1" is-private-dimension="1" join="left outer" name="vr_rb_pwrc">
          <call function="and">
            <call function="=">
              <column column="m2m_pwrc_id" table="this" />
              <column column="pwrc_id" table="hv_eopwrc_id" />
            </call>
            <call function="=">
              <column column="kod_fl" table="this" />
              <column column="bal_id" table="hv_eopwrc_id" />
            </call>
          </call>
        </query>
        <query name="vb_rb_default_pwrc" as="def_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="m2m_pwrc_id" />
              <column table="def_pwrc" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="this" column="bal_id" />
              <column table="def_pwrc" column="kod_fl" />
            </call>
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
    </query>
  </queries>
</root>