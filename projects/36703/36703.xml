<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:24:15.8052047+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="61943test" timestamp="27.12.2021 15:35:07" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\61943test.xml">
      <params>
        <param name="dat" type="date">
          <const>to_date('01.12.2021','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <column table="kod_sf" column="vid_real" as="vid_real" />
        <column table="kod_sf" column="ym" as="ym" />
        <column table="kod_dog" column="ndog" as="ndog" />
        <fact column="sr_facvip_norm_av_av_nach" as="sr_facvip_norm_av_av_nach" is-fact-use="1" />
        <fact column="sr_facvip_norm_av_osn_nach" as="sr_facvip_norm_av_osn_nach" is-fact-use="1" />
        <fact column="sr_opl_norm_av_av_opl" as="sr_opl_norm_av_av_opl" is-fact-use="1" />
        <fact column="sr_opl_norm_av_osn_opl" as="sr_opl_norm_av_osn_opl" is-fact-use="1" />
        <call function="-nvl" as="fin_ul_ob_os_av_norm" title="Оборот деб. осн. и ав. (долг)">
          <call function="+nvl">
            <fact column="sr_facvip_norm_av_av_nach" />
            <fact column="sr_facvip_norm_av_osn_nach" />
          </call>
          <call function="+nvl">
            <fact column="sr_opl_norm_av_av_opl" />
            <fact column="sr_opl_norm_av_osn_opl" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog" />
          <link name="kod_sf" />
          <link name="dat_dolg_norm" />
          <where>
            <call function="in">
              <column table="kod_dog" column="ndog" />
              <call function="array">
                <const>'6539 КУ'</const>
              </call>
            </call>
            <call function="ls" dont-push="1">
              <column table="dat_dolg_norm" column="val" />
              <useparam name="dat" />
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="!=0">
          <column table="this" column="fin_ul_ob_os_av_norm" />
        </call>
      </where>
    </query>
    <query name="61943test_1" timestamp="27.12.2021 15:51:58" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\61943test.xml">
      <params>
        <param name="dat" type="date">
          <const>to_date('01.12.2021','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="kod_opl" column="kod_opl" as="kod_opl" />
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <column table="kod_sf" column="vid_real" as="vid_real" />
        <column table="kod_sf" column="ym" as="ym" />
        <column table="kod_dog" column="ndog" as="ndog" />
        <fact column="sr_opl_norm_av_osn_opl" as="sr_opl_norm_av_osn_opl" is-fact-use="1" />
      </select>
      <from>
        <qube>
          <link name="kod_dog" />
          <link name="kod_sf" />
          <link name="kod_opl" />
          <link name="dat_dolg_norm" />
          <where>
            <call function="in">
              <column table="kod_dog" column="ndog" />
              <call function="array">
                <const>'6539 КУ'</const>
              </call>
            </call>
            <call function="ls" dont-push="1">
              <column table="dat_dolg_norm" column="val" />
              <useparam name="dat" />
            </call>
            <call function="=">
              <column table="kod_sf" column="kod_sf" />
              <const>3573344</const>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-fin-dat" timestamp="07.06.2019 15:49:04" use-repository="1" inherit="36703-fin-cmn" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_dog_fin" column="kod_dog" as="kod_dog" />
        <column table="kod_dog_fin" column="ndog" as="ndog" />
        <column table="dep" column="name" as="name" />
        <column table="kodp" column="nump" as="nump" />
        <column table="ym_vozn" column="val" as="ym_vozn" />
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <column table="vid_real" column="vid_real" as="vid_real" />
        <column table="kod_sf" column="dat_bzad" group="max" as="dat_bzad" />
        <column table="kod_sf" column="ym" as="ym" />
        <column table="kod_sf_ret_inf" column="name_podpis" group="max" as="name_podpis" />
        <call function="case" as="name_plat" type="string" group="max" title="Наименование платежа">
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>2</const>
                <const>3</const>
              </call>
            </call>
            <call function="||">
              <const>'Итоговый расчет за '</const>
              <call function="lower">
                <call function="mes-name">
                  <call function="mes">
                    <column table="this" column="ym_vozn" />
                  </call>
                </call>
              </call>
              <const>' '</const>
              <call function="trunc">
                <column table="this" column="ym_vozn" />
              </call>
              <const>' г.'</const>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>0</const>
              </call>
            </call>
            <call function="||">
              <const>'Аванс '</const>
              <column table="kod_sf_dop" column="perc" />
              <const>'% за '</const>
              <call function="lower">
                <call function="mes-name">
                  <call function="mes">
                    <column table="kod_sf" column="rym" />
                  </call>
                </call>
              </call>
              <const>' '</const>
              <call function="trunc">
                <column table="kod_sf" column="rym" />
              </call>
              <const>' г.'</const>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>9</const>
              </call>
            </call>
            <call function="||">
              <const>'Гос. пошлина '</const>
              <call function="if" type="string">
                <call function="is not null">
                  <column table="this" column="num_delo" />
                </call>
                <call function="||">
                  <const>'по делу № '</const>
                  <column table="this" column="num_delo" />
                </call>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="num_delo" />
              </call>
            </call>
            <call function="||">
              <const>'Проценты по делу № '</const>
              <column table="this" column="num_delo" />
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                </call>
              </call>
              <call function="is null">
                <column table="this" column="num_delo" />
              </call>
            </call>
            <const>'Проценты за пользование чужими денежными средствами'</const>
          </call>
        </call>
        <fact column="nach_all" table="sf" group="sum" nvl="0" as="nach" is-fact-use="1" />
        <fact column="opl_nach_all" table="sf" group="sum" nvl="0" as="opl_nach" is-fact-use="1" />
        <fact column="opl_in_month" table="sf" group="sum" as="opl" nvl="0" is-fact-use="1" />
        <fact column="dolg" as="dolg" table="sf" group="sum" nvl="0" is-fact-use="1" />
        <fact column="dolg_not_av" as="dolg_check" table="sf" group="sum" nvl="0" is-fact-use="1" />
        <fact column="dolg_pros_dat" table="sf" group="sum" nvl="0" as="dolg_pros" is-fact-use="1" />
        <fact column="dolg_kred_os" table="sf" group="sum" nvl="0" as="dolg_kred_os" is-fact-use="1" />
        <fact column="dolg_kred_av" table="sf" group="sum" nvl="0" as="dolg_kred_av" is-fact-use="1" />
        <call function="+nvl" as="dolg_kred" group="sum" nvl="0">
          <fact column="dolg_kred_os" table="sf" />
          <fact column="dolg_kred_av" table="sf" />
        </call>
        <call function="coalesce" type="string" as="num_delo">
          <fact column="iv_sf_astr_info_num_delo" table="sf" />
          <fact column="iv_sf_ur_prizn_info_num_delo" table="sf" />
        </call>
        <fact column="kr_dogovor_kod_dog" group="max" title=" " as="pr_dog" is-fact-use="1" />
      </select>
      <grouping>
        <grset as="itog">
          <where>
            <call function="!=0">
              <column table="this" column="dolg_check" />
              <column table="this" column="dolg_kred" />
              <column table="this" column="opl" />
            </call>
          </where>
          <group>
            <sourcelink table="kod_dog_fin" />
          </group>
          <grset as="itog_deb">
            <where>
              <call function="!=0">
                <column table="this" column="dolg_check" />
                <column table="this" column="opl" />
              </call>
            </where>
          </grset>
          <grset as="itog_osn_av">
            <where>
              <call function="and">
                <call function="!=0">
                  <column table="this" column="dolg_check" />
                  <column table="this" column="opl" />
                </call>
                <call function="or">
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                      <const>3</const>
                      <const>0</const>
                    </call>
                  </call>
                  <call function="is not null">
                    <column table="this" column="pr_dog" />
                  </call>
                </call>
              </call>
            </where>
            <grset as="itog_osn">
              <where>
                <call function="or">
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                    </call>
                  </call>
                  <call function="is not null">
                    <column table="this" column="pr_dog" />
                  </call>
                </call>
              </where>
              <grset as="det_osn">
                <where>
                  <call function="!=0">
                    <column table="this" column="dolg_check" />
                    <column table="this" column="nach" />
                  </call>
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                    </call>
                  </call>
                </where>
                <group>
                  <sourcelink table="ym_vozn" />
                </group>
              </grset>
            </grset>
            <grset as="det_av">
              <group>
                <sourcelink table="kod_sf" />
                <sourcelink table="ym_vozn" />
              </group>
              <where>
                <call function="in">
                  <column table="this" column="vid_real" />
                  <call function="array">
                    <const>0</const>
                  </call>
                </call>
              </where>
            </grset>
          </grset>
          <grset as="det_othr">
            <group>
              <sourcelink table="kod_sf" />
              <sourcelink table="ym_vozn" />
            </group>
            <where>
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                  <const>9</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
          <dimset as="sf">
            <where>
              <call function="and" dont-push="1">
                <call function="lt">
                  <column table="dat" column="val" />
                  <useparam name="dat" />
                </call>
              </call>
            </where>
            <link name="kod_sf">
              <link name="kod_sf_dop" />
              <link name="kod_sf_ret_inf" />
            </link>
            <link name="dat" />
            <link name="vid_real" />
            <link name="ym_vozn" />
          </dimset>
          <dimset as="sf_all_time" comment="без условия по дате">
            <link name="kod_sf">
              <link name="kod_sf_dop" />
            </link>
            <link name="dat" />
            <link name="vid_real" />
            <link name="ym_vozn" />
          </dimset>
        </qube>
      </from>
      <where>
        <call function="!=0">
          <column table="this" column="dolg_check" />
          <column table="this" column="dolg_kred" />
          <column table="this" column="pr_dog" />
          <column table="this" column="opl" />
        </call>
      </where>
    </query>
    <query name="36703-abon" use-repository="1" timestamp="15.05.2024 14:51:04" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kodp" column="kodp" group="1" as="kodp" key="1" fixed="1" />
        <column table="kodp" column="nump" group="max" as="nump" key="0" />
        <column table="kodp" column="name" group="max" as="name" key="0" />
        <column table="kodp" column="inn" group="max" as="inn" key="0" />
        <column table="kodp" column="kpp" group="max" as="kpp" key="0" />
        <column table="kr_emp_ruk_kod_emp" column="fio" as="fio_ruk" group="max" key="0" />
        <column table="kr_emp_ruk_kod_emp" column="tel" as="tel_ruk" group="max" key="0" />
        <column table="kr_emp_buh_kod_emp" column="fio" as="fio_buh" group="max" key="0" />
        <column table="kr_emp_buh_kod_emp" column="tel" as="tel_buh" group="max" key="0" />
        <column table="kod_edo" column="name_edo" group="max" as="name_edo" key="0" />
        <call column="ur_bk_kodp_last_st_name" as="bk_st_name" group="max" function="()" type="string" key="0">
          <call function="case" title="Банкрот" type="string">
            <call function="when">
              <call function="and">
                <call function="=">
                  <column table="udo" column="pr_active" />
                  <const type="number">0</const>
                </call>
                <call function="=">
                  <column table="kodp" column="ac_egr_status" />
                  <column table="udo" column="sulst" />
                </call>
                <call function="=">
                  <column table="udo" column="type_sulst" />
                  <call function="if">
                    <call function="is null">
                      <column table="kodp" column="kpp" />
                    </call>
                    <const type="string">'ИП'</const>
                    <const type="string">'ЮЛ'</const>
                  </call>
                </call>
                <call function="=">
                  <call function="case">
                    <call function="when">
                      <call function="=">
                        <const type="string">'A'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_a" />
                    </call>
                    <call function="when">
                      <call function="=">
                        <const type="string">'B'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_b" />
                    </call>
                    <call function="when">
                      <call function="=">
                        <const type="string">'C'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_c" />
                    </call>
                  </call>
                  <const type="number">1</const>
                </call>
              </call>
              <column table="udo" column="shortname" type="string" />
            </call>
            <call function="when">
              <call function="=">
                <useparam table="kodp" column="ac_egr_status" name="p_cat_rep" />
                <const table="udo" column="sulst" type="string">'-'</const>
              </call>
              <column table="kodp" column="ac_egr_status_name" type="string" />
            </call>
          </call>
        </call>
        <column group="max" table="kod_d_ur" column="kf_adress_o" title="Юридический адрес" as="ur_addr" key="0" />
        <column group="max" table="kod_d" column="kf_adress_o" title="Адрес фактический" as="real_addr" key="0" />
      </select>
      <from>
        <qube>
          <factlinks>
            <link name="kr_emp_ruk_kod_emp" />
            <link name="kr_emp_buh_kod_emp" />
          </factlinks>
          <link name="kod_dog" only-for-cond="1">
            <link name="kod_dog_fin" />
          </link>
          <link name="kodp" all-rows="1">
            <link name="kodp" as="kodp1">
              <elink name="kr_org_edo">
                <link name="kod_edo" />
              </elink>
            </link>
            <link name="kod_d_ur" />
            <link name="kod_d" />
            <link name="udo" />
          </link>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-dog" timestamp="21.11.2016 19:39:49" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_dog" column="kod_dog" as="kod_dog" />
        <column table="kod_dog" column="kodp" as="kodp" />
        <column table="kod_dog" column="name" as="name" />
        <column table="kod_dog" column="ndog" as="ndog" />
        <column table="kod_bzad" column="name" as="name_bzad" />
      </select>
      <from>
        <qube>
          <link name="kod_dog" all-rows="1">
            <link name="kod_bzad" />
          </link>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_dog" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
            <call function="!=">
              <column table="kod_dog" column="pr_active" />
              <const>1</const>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-info" timestamp="10.04.2018 14:58:08" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <call function="||" as="ssdate1" title="Дата" optional="1" key="0">
          <call function="day">
            <useparam name="dat1" />
          </call>
          <const>' '</const>
          <call function="lower">
            <call function="mes-name-rp">
              <call function="month">
                <useparam name="dat1" />
              </call>
            </call>
          </call>
          <const>' '</const>
          <call function="year">
            <useparam name="dat1" />
          </call>
          <const>' г.'</const>
        </call>
        <call function="date to char" as="sdate1" title="Дата" optional="1" key="0">
          <useparam name="dat1" />
        </call>
        <call function="||" as="ssdate" title="Дата" key="0">
          <call function="day">
            <useparam name="dat" />
          </call>
          <const>' '</const>
          <call function="lower">
            <call function="mes-name-rp">
              <call function="month">
                <useparam name="dat" />
              </call>
            </call>
          </call>
          <const>' '</const>
          <call function="year">
            <useparam name="dat" />
          </call>
          <const>' г.'</const>
        </call>
        <call function="date to char" as="sdate" title="Дата" key="0">
          <useparam name="dat" />
        </call>
        <call function="month ym between" as="ym_cnt" key="0">
          <call function="date to ym">
            <useparam name="dat" />
          </call>
          <call function="date to ym">
            <useparam name="dat1" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" as="dual" />
      </from>
    </query>
    <query name="36703-avans-info" timestamp="21.11.2016 19:40:01" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_vist_day" as="kod_vist_day" key="1" fixed="1" />
        <column table="kod_dog" column="kod_dog" as="kod_dog" key="0" />
        <call function="||" as="name" key="0">
          <column table="kod_bzad" column="name" as="name_bzad" />
          <const>' '</const>
          <column table="a" column="perc" />
          <const>'% '</const>
          <call function="lower">
            <column table="vid_avans" column="name" />
          </call>
          <const>' '</const>
          <column table="a" column="period" />
        </call>
      </select>
      <from>
        <query name="kr_vist_day" as="a">
          <link name="kod_bzad" as="kod_bzad" table="ss_zadol_day" child="kr_vist_day" field="kod_bzad" parent="ss_zadol_day" back="kr_vist_day" />
          <link name="vid_avans" as="vid_avans" table="sk_vid_avans" child="kr_vist_day" field="vid_avans" parent="sk_vid_avans" back="kr_vist_day" />
          <link name="kod_dog" as="kod_dog" table="kr_dogovor" child="kr_vist_day" field="kod_dog" parent="kr_dogovor" back="kr_vist_day" title="Договор" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="kod_dog" column="kodp" />
            <useparam name="kodp" />
          </call>
          <call function="in" optional="1">
            <column table="kod_dog" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="36703-dog-lim" timestamp="21.11.2016 19:44:21" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_dog" column="kod_dog" as="kod_dog" />
        <column table="kodp" column="nump" as="nump" />
        <fact column="dr_dogval_lim_y_bring" as="limit" is-fact-use="1" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kodp" />
            <link name="kod_bzad" />
          </link>
          <link name="kod_dogval_limit" />
          <link name="ym" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_dog" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
            <call function="=">
              <column table="kod_dogval_limit" column="n_year" />
              <call function="year">
                <useparam name="dat" />
              </call>
            </call>
            <call function="le">
              <column table="ym" column="val" />
              <call function="date to ym">
                <useparam name="dat" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-obj" timestamp="21.11.2016 19:47:30" use-repository="1" order="num_obj_par,num_obj nulls first" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_numobj" as="kod_numobj" key="1" fixed="1" />
        <column table="kod_dog" column="kod_dog" as="kod_dog" key="0" />
        <call function="nvl" type="number" as="num_obj_par" key="0">
          <column table="kod_parent_sa" column="num_obj" />
          <column table="a" column="num_obj" />
        </call>
        <call function="decode" type="number" as="num_obj" key="0">
          <column table="kod_parent_sa" column="num_obj" />
          <const>null</const>
          <const>-1</const>
          <column table="a" column="num_obj" />
        </call>
        <call function="||" as="name" key="0">
          <call function="if">
            <call function="is not null">
              <column table="kod_parent_sa" column="num_obj" />
            </call>
            <call function="||">
              <column table="kod_parent_sa" column="num_obj" />
              <const>'.'</const>
            </call>
          </call>
          <column table="a" column="num_obj" />
          <const>'.  '</const>
          <call function="nk_adress.kf_address">
            <const>2</const>
            <column table="kod_obj" column="kodd" />
          </call>
          <const>' '</const>
          <column table="a" column="name" />
        </call>
      </select>
      <from>
        <query name="kr_numobj" as="a">
          <link name="kod_dog" as="kod_dog" table="kr_dogovor" child="kr_numobj" field="kod_dog" parent="kr_dogovor" back="kr_numobj" title="Договор" />
          <link name="kod_obj" as="kod_obj" table="kr_object" child="kr_numobj" field="kod_obj" parent="kr_object" back="kr_numobj" />
          <link name="kod_parent_sa" as="kod_parent_sa" table="kr_numobj" child="kr_numobj" field="kod_parent_sa" parent="kr_numobj" back="kr_numobj" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="and">
            <call function="true" />
            <call function="in" optional="1">
              <column table="kod_dog" column="kodp" />
              <useparam name="kodp" />
            </call>
            <call function="in" optional="1">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="kod_dog" />
            </call>
          </call>
          <call function="!=">
            <column table="a" column="pr_active" />
            <const>1</const>
          </call>
        </call>
      </where>
      <order>
        <column column="num_obj_par" />
        <column column="num_objnullsfirst" />
      </order>
    </query>
    <query name="36703-isk" use-repository="1" timestamp="01.07.2024 18:16:19" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="ur_mat" column="kod_mat" as="kod_mat" />
        <column table="kod_dog" column="kod_dog" as="kod_dog" />
        <column table="kod_hist_mat_dec" column="kod_hist_mat_desc" as="kod_hist_mat_desc" />
        <column table="ur_isp" column="kod_isp" as="kod_isp" />
        <column table="ur_mat" column="num_delo" as="num_delo" />
        <fact column="ur_dp_summa" as="vist" group="sum" is-fact-use="1" />
        <call function="vg_period.ym_enum_str_to_date_ranges_str" as="period" group="max">
          <fact column="ur_dogplat_ym_all" />
        </call>
        <call function="||" as="resh_res">
          <column table="kod_result" column="name" as="result" />
          <const>''</const>
        </call>
        <column table="kod_hist_mat_dec" column="dat_rassm" as="dat_rassm" />
        <column table="kod_hist_mat_dec" column="dat_post" as="dat_post" />
        <column table="kod_hist_mat_dec" column="prim" as="prim" />
        <column table="kod_ur_state_pp" column="name" group="max" as="name_st" />
        <column table="ur_isp" column="num_reg" as="num_il" />
        <column table="ur_isp" column="dat_doc" as="dat_v_il" />
        <column table="ur_isp" column="dat_function" as="dat_v_silu_il" />
        <fact column="dolg_on_il" as="prizn_il" group="sum" is-fact-use="1" />
        <fact column="ur_isp_pr_min_date" as="dat_na_isp_il" group="min" is-fact-use="1" />
        <fact column="fin_ul_ob" as="tek_dolg" group="sum" is-fact-use="1" />
      </select>
      <from>
        <qube merge-dimsets="1">
          <factlinks>
            <link name="kod_ur_state_pp" />
          </factlinks>
          <link name="kod_mat" as="ur_mat">
            <link name="kod_folders" />
          </link>
          <link name="kod_dog" />
          <link name="kod_hist_mat_dec">
            <elink name="ur_isp" />
            <link name="kod_result">
              <link name="kod_post" />
            </link>
          </link>
          <where>
            <call function="is not null">
              <column table="ur_mat" column="kod_mat" />
            </call>
            <call function="is not null">
              <column table="kod_dog" column="kod_dog" />
            </call>
            <call function="=">
              <column table="kod_folders" column="kod_sdp" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="kod_folders" column="kod_vi" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="kod_folders" column="is_active" />
              <const>1</const>
            </call>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_dog" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
            <call function="!=">
              <column table="kod_dog" column="pr_active" />
              <const>1</const>
            </call>
            <call function="is not null">
              <column table="ur_mat" column="num_delo" />
            </call>
            <call function="is not null">
              <column table="ur_mat" column="dat_prin" />
            </call>
            <call function="is not null">
              <column table="ur_mat" column="dat_doc" />
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="isk">
          <where>
            <call function="!=0">
              <column table="this" column="tek_dolg" />
            </call>
          </where>
          <group>
            <sourcelink table="ur_mat" />
            <sourcelink table="kod_dog" />
          </group>
          <grset as="resh">
            <group>
              <sourcelink table="kod_hist_mat_dec" />
            </group>
            <where>
              <call function="is not null">
                <column table="this" column="kod_hist_mat_desc" />
              </call>
            </where>
            <grset as="il">
              <group>
                <sourcelink table="ur_isp" />
              </group>
              <where>
                <call function="is not null">
                  <column table="this" column="kod_isp" />
                </call>
              </where>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="36703-uved-pre" timestamp="17.05.2019 13:23:59" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_pred" column="kod_pred" group="1" as="kod_pred" key="1" fixed="1" />
        <column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <column table="kod_sf" column="kod_sf" group="1" as="kod_sf" key="1" fixed="1" />
        <call function="if" as="dolg_uved" type="number" group="sum" key="0">
          <call function="and">
            <call function="le">
              <column table="dat_dolg" column="val" as="dat_dolg" />
              <column table="kod_pred" column="dat_ras" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <column table="kod_pred" column="dat_ras" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_tek" type="number" group="sum" key="0">
          <call function="and">
            <call function="le">
              <column table="dat_dolg" column="val" as="dat_dolg" />
              <useparam name="dat" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="decode" as="inf" type="string" group="max" key="0">
          <column table="kod_pred" column="kod_otkloper" />
          <const>9</const>
          <const>'Направлено предупреждение о задолженности'</const>
          <const>2</const>
          <const>'Намечен на ограничение'</const>
          <const>1</const>
          <const>'Намечен на отключение'</const>
        </call>
        <call function="decode" as="dat" type="date" group="max" key="0">
          <column table="kod_pred" column="kod_otkloper" />
          <const>9</const>
          <column table="kod_pred" column="dat_tlg" />
          <const>2</const>
          <column table="kod_pred" column="dat_otkl" />
          <const>1</const>
          <column table="kod_pred" column="dat_otkl" />
        </call>
        <column table="kod_pred" column="sved_isp" group="max" as="sved_isp" key="0" />
      </select>
      <from>
        <qube>
          <link name="kod_dog" />
          <link name="kod_pred" />
          <link name="kod_sf" />
          <link name="dat_dolg" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_dog" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
            <call function="or">
              <call function="!=">
                <column table="kod_pred" column="pr_arx" />
                <const>1</const>
              </call>
              <call function="gt">
                <column table="kod_pred" column="dat_ras" />
                <call function="date add days">
                  <useparam name="dat" />
                  <const>-200</const>
                </call>
              </call>
            </call>
            <call function="in">
              <column table="kod_pred" column="kod_otkloper" />
              <call function="array">
                <const>1</const>
                <const>2</const>
                <const>9</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <having>
        <call function="and">
          <call function="gt">
            <column table="this" column="dolg_uved" />
            <const>0</const>
          </call>
          <call function="gt">
            <column table="this" column="dolg_tek" />
            <const>0</const>
          </call>
        </call>
      </having>
    </query>
    <query name="36703-uved" order="dat" timestamp="22.11.2016 16:01:46" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_pred" group="max" key="1" as="kod_pred" />
        <column table="a" column="kod_dog" group="1" as="kod_dog" />
        <column table="a" column="inf" group="1" as="inf" />
        <column table="a" column="dat" group="max" as="dat" />
        <column table="a" column="sved_isp" group="max" as="sved_isp" />
      </select>
      <from>
        <query name="36703-uved-pre" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <order>
        <column column="dat" />
      </order>
    </query>
    <query name="36703-teh" timestamp="07.12.2020 14:23:49" order="num_obj" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_numobj" column="kod_numobj" group="1" as="kod_numobj" key="1" fixed="1" />
        <column table="kod_numobj" column="num_obj" group="max" as="num_obj" key="0" />
        <call function="||" as="name" group="max" key="0">
          <column table="kod_numobj" column="num_obj" />
          <const>'. '</const>
          <column table="kod_numobj" column="name" />
        </call>
        <column table="kod_numobj" column="kod_dog" group="max" as="kod_dog" key="0" />
        <column table="a" column="dakt_go" group="max" as="dakt_go" key="0" />
        <column table="a" column="dakt_gpp" group="max" as="dakt_gpp" key="0" />
        <column table="a" column="dakt_gotov" group="max" as="dakt_gotov" key="0" />
        <column table="a" column="dpassp_gotov" group="max" as="dpassp_gotov" key="0" />
        <column table="b" column="d_zayav" group="max" as="d_zayav" key="0" />
        <column table="b" column="pusk_tep" group="max" as="pusk_tep" key="0" />
        <column table="b" column="otkl_tep" group="max" as="otkl_tep" key="0" />
      </select>
      <from>
        <query name="kr_numobj" as="kod_numobj">
          <elink name="br_oto_obj" as="a" table="br_oto_obj" child="br_oto_obj" field="kod_numobj" parent="kr_numobj" back="br_oto_obj" />
          <elink name="br_oto_tu" as="b" table="br_oto_tu" child="br_oto_tu" field="kod_numobj" parent="kr_numobj" back="br_oto_tu" />
          <link name="kod_dog" as="kod_dog" table="kr_dogovor" child="kr_numobj" field="kod_dog" parent="kr_dogovor" back="kr_numobj" title="Договор" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="and">
            <call function="true" />
            <call function="in" optional="1">
              <column table="kod_dog" column="kodp" />
              <useparam name="kodp" />
            </call>
            <call function="in" optional="1">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="kod_dog" />
            </call>
          </call>
          <call function="!=">
            <column table="kod_numobj" column="pr_active" />
            <const>1</const>
          </call>
          <call function="is null">
            <column table="kod_numobj" column="kod_parent_sa" />
          </call>
        </call>
      </where>
      <order>
        <column column="num_obj" />
      </order>
    </query>
    <query name="qube_fin_ul_kred" timestamp="07.10.2016 15:46:24" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <select>
        <column table="kod_dog" column="kod_dog" agg="" dimension="kod_dog" as="kod_dog" />
        <call function="date to ym" dimension="ym" as="ym">
          <column table="dat" column="val" as="dat" />
        </call>
        <column table="dat" column="val" as="dat" dimension="dat" />
        <fact column="fin_ul_ob_kr" agg="sum" fact="qube_fin_ul_kred_ob_kr" as="fin_ul_ob_kr" is-fact-use="1" />
        <fact column="fin_ul_ob_kr_os" agg="sum" fact="qube_fin_ul_kred_ob_kr_os" as="fin_ul_ob_kr_os" is-fact-use="1" />
        <fact column="fin_ul_ob_kr_av" agg="sum" fact="qube_fin_ul_kred_ob_kr_av" as="fin_ul_ob_kr_av" is-fact-use="1" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="dat_kred" as="dat" />
        </qube>
      </from>
    </query>
    <query name="36703-fin-per" timestamp="10.04.2018 14:28:41" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <expressions>
        <call as="is_osn_real" function="in">
          <column table="vid_real_no_av" column="vid_real" />
          <call function="array">
            <const>2</const>
            <const>3</const>
          </call>
        </call>
        <call function="()" group="sum" type="number" as="nach">
          <fact column="sr_facras_nachisl" condition="is_osn_real" />
        </call>
        <call function="()" group="sum" type="number" as="opl_per">
          <fact column="sr_opl_opl_bnk" condition="is_osn_real" />
        </call>
        <call function="()" group="sum" type="number" as="opl_nach">
          <fact column="q36703_opl_nach_opl" condition="is_osn_real" />
        </call>
        <call function="()" group="max" type="date" as="opl_dt">
          <fact column="q36703_opl_nach_dt" condition="is_osn_real" />
        </call>
        <call function="()" group="sum" type="number" as="ob_deb">
          <fact column="fin_ul_ob" condition="is_osn_real" />
        </call>
        <call function="()" group="sum" type="number" as="ob_kred">
          <fact column="fin_ul_ob_kr" condition="is_osn_real" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog_fin" column="kod_dog" as="kod_dog" />
        <column table="ym" column="val" as="ym" />
        <call function="||" as="name_plat">
          <const>'Итоговый расчет за '</const>
          <call function="lower">
            <call function="mes-name">
              <call function="mes">
                <column table="this" column="ym" />
              </call>
            </call>
          </call>
          <const>' '</const>
          <call function="trunc">
            <column table="this" column="ym" />
          </call>
          <const>' г.'</const>
        </call>
        <fact column="nach" nvl="0" as="nach" is-fact-use="1" />
        <fact column="opl_nach" nvl="0" as="opl_nach" is-fact-use="1" />
        <fact column="opl_dt" as="opl_dt" is-fact-use="1" />
        <fact column="opl_per" as="opl" nvl="0" is-fact-use="1" />
        <fact column="q36703_sf_info_name_podpis" as="name_podpis" is-fact-use="1" />
        <fact column="q36703_sf_info_dat_bzad" as="dat_bzad" is-fact-use="1" />
        <fact column="q36703_dog_ym_ft" as="dog_ym_ft" is-fact-use="1" />
        <call function="over" as="deb_end">
          <call function="sum">
            <fact column="ob_deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="kred_end">
          <call function="sum">
            <fact column="ob_kred" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <fact column="q36703_nak_svd_sn" as="dolg_pros" is-fact-use="1" />
      </select>
      <grouping />
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="ym" />
          <link name="dat" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="lt" dont-push="1">
                <column table="dat" column="val" />
                <useparam name="dat" />
              </call>
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-fin-cmn" timestamp="07.06.2019 15:47:04" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <expressions>
        <call function="if" as="dolg_pros_av" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat_dolg" column="val" />
              <useparam name="dat" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
            <call function="=0">
              <column table="vid_real" column="vid_real" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="()" as="dolg_pros" group="sum" type="number">
          <fact column="fin_ul_sverh_dolg_deb_ng">
            <withparams>
              <useparam name="dat" />
            </withparams>
          </fact>
        </call>
        <call function="()" as="dolg_pros_dat" group="sum" type="number">
          <fact column="fin_ul_sverh_dolg_deb_pre_ng_dat">
            <withparams>
              <useparam name="dat" />
            </withparams>
          </fact>
        </call>
        <call function="if" as="dolg_pros_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat_dolg" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_not_av" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
            <call function="gt">
              <call function="if">
                <call function="=0">
                  <column table="kod_sf" column="vid_real" />
                </call>
                <call function="ym end time">
                  <column table="kod_sf" column="rym" />
                </call>
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg" type="number" group="sum">
          <call function="=0">
            <column table="vid_real" column="vid_real" />
          </call>
          <fact column="dolg_pros_av" />
          <fact column="dolg_not_av" />
        </call>
        <call function="if" as="dolg_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_kred_av" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
            <call function="le">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_av" />
        </call>
        <call function="if" as="dolg_kred_av_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="lt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_av" />
        </call>
        <call function="if" as="dolg_kred_os" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_not_av" />
        </call>
        <call function="if" as="dolg_kred_os_beg" type="number" group="sum">
          <call function="and">
            <call function="true" />
            <call function="lt" optional="1">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_not_av" />
        </call>
        <call as="nach" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_facras_nachisl" />
        </call>
        <call as="opl_nach" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_opl_sf" />
        </call>
        <call as="opl1" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_opl_bnk" />
        </call>
        <call as="opl2" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_opl_bnk_36703" />
        </call>
        <call function="if" group="max" type="date" as="last_dat_opl">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_dat_opl_max" />
        </call>
        <call as="nach_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_facras_nachisl" />
        </call>
        <call as="opl_nach_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_opl_opl_sf" />
        </call>
        <call as="opl1_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_opl_opl_bnk" />
        </call>
        <call as="opl_in_month" function="if" group="sum" type="number">
          <call function="and">
            <call function="ge">
              <column table="dat" column="val" />
              <call function="ym begin time">
                <call function="date to ym">
                  <useparam name="dat" />
                </call>
              </call>
            </call>
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
          </call>
          <fact column="sr_opl_opl_bnk" />
        </call>
      </expressions>
      <select />
    </query>
    <query name="36703-info-dat" timestamp="21.11.2016 19:03:10" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <call function="||" as="ssdate" title="Дата" key="0">
          <call function="day">
            <useparam name="dat" />
          </call>
          <const>' '</const>
          <call function="lower">
            <call function="mes-name-rp">
              <call function="month">
                <useparam name="dat" />
              </call>
            </call>
          </call>
          <const>' '</const>
          <call function="year">
            <useparam name="dat" />
          </call>
          <const>' г.'</const>
        </call>
        <call function="date to char" as="sdate" title="Дата" key="0">
          <useparam name="dat" />
        </call>
      </select>
      <from>
        <query name="dual" as="dual" />
      </from>
    </query>
    <query name="36703-dat1-def" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <select>
        <call function="ym begin time" as="val" key="1" fixed="1">
          <call function="date to ym">
            <call function="sysdate" />
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="36703-fin-test" timestamp="28.03.2019 11:03:33" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <expressions>
        <call function="if" as="dolg_pros" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat_dolg" column="val" />
              <useparam name="dat" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_pros_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat_dolg" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob" />
        </call>
        <call function="if" as="dolg_kred_av" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
            <call function="le">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_av" />
        </call>
        <call function="if" as="dolg_kred_av_beg" type="number" group="sum">
          <call function="and">
            <call function="lt">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
            <call function="lt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_av" />
        </call>
        <call function="if" as="dolg_kred_os" type="number" group="sum">
          <call function="and">
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="dat" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_not_av" />
        </call>
        <call function="if" as="dolg_kred_os_beg" type="number" group="sum">
          <call function="and">
            <call function="true" />
            <call function="lt" optional="1">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="fin_ul_ob_kr_not_av" />
        </call>
        <call as="nach" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_facras_nachisl" />
        </call>
        <call as="opl_nach" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_opl_sf" />
        </call>
        <call as="opl1" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_opl_bnk" />
        </call>
        <call function="if" group="max" type="date" as="last_dat_opl">
          <call function="and">
            <call function="true" />
            <call function="ge">
              <column table="dat" column="val" />
              <useparam name="dat1" />
            </call>
          </call>
          <fact column="sr_opl_dat_opl_max" />
        </call>
        <call as="nach_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_facras_nachisl" />
        </call>
        <call as="opl_nach_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_opl_opl_sf" />
        </call>
        <call as="opl1_all" function="if" group="sum" type="number">
          <call function="and">
            <call function="true" />
          </call>
          <fact column="sr_opl_opl_bnk" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog_fin" column="kod_dog" as="kod_dog" />
        <column table="kod_dog_fin" column="ndog" as="ndog" />
        <column table="dep" column="name" as="name" />
        <column table="kodp" column="nump" as="nump" />
        <column table="ym_vozn" column="val" as="ym_vozn" />
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <column table="vid_real" column="vid_real" as="vid_real" />
        <column table="kod_sf" column="dat_bzad" as="dat_bzad" />
        <column table="kod_sf" column="ym" as="ym" />
        <fact column="fin_ul_sverh_dolg_deb_ng" table="sf" as="fin_ul_sverh_dolg_deb_ng" is-fact-use="1">
          <withparams>
            <useparam name="dat" />
          </withparams>
        </fact>
        <fact column="dolg" as="dolg" table="sf" nvl="0" group="sum" is-fact-use="1" />
        <fact column="dolg_kred_os" table="sf" nvl="0" group="sum" as="dolg_kred_os" is-fact-use="1" />
        <fact column="dolg_kred_av" table="sf" nvl="0" group="sum" as="dolg_kred_av" is-fact-use="1" />
        <fact column="kr_dogovor_kod_dog" title=" " as="pr_dog" group="max" is-fact-use="1" />
      </select>
      <grouping />
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <where>
            <call function="and">
              <call function="=" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
          <dimset as="sf">
            <where>
              <call function="and" dont-push="1">
                <call function="le">
                  <column table="dat" column="val" />
                  <useparam name="dat" />
                </call>
              </call>
            </where>
            <link name="kod_sf">
              <link name="kod_sf_dop" />
            </link>
            <link name="dat" />
            <link name="vid_real" />
            <link name="ym_vozn" />
          </dimset>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_dog" column="kod_dog" />
            <const>281276</const>
          </call>
          <call function="!=0">
            <column table="this" column="pr_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="sr_opl_bnk_36703" class="1" inherit="sr_opl" timestamp="28.07.2017 15:41:03" comment="в отличии от sr_opl_bnk период возниконовения из оплаты а не из СФ" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <select>
        <column table="a" column="kod_opl" type="number" key-dimension="kod_opl" as="kod_opl" key="1" fixed="1" />
        <column table="a" column="kod_vidopl" type="number" as="kod_vidopl" reference="ss_vidopl" refcol="kod_vidopl" key="0" />
        <column table="a" column="vid_real" type="number" title="" as="vid_real" reference="sk_vid_real" refcol="vid_real" key="0" />
        <column table="a" column="kod_dog" type="number" as="kod_dog" reference="kr_dogovor" refcol="kod_dog" key="0" />
        <column table="a" column="kod_sf" type="number" as="kod_sf" reference="sr_facvip" refcol="kod_sf" key="0" />
        <column table="a" column="num_opl" type="string" title="Номер платежного документа" as="num_opl" key="0" />
        <column table="a" column="opl" type="number" title="" as="opl" key="0" />
        <column table="a" column="ym" type="number" title="Период оплаты" dimension="ym" as="ym" key="0" />
        <column table="a" column="remark" type="string" title="" comment="примечания" as="remark" key="0" />
        <column table="a" column="d_m" type="date" title="" comment="когда изменено" as="d_m" key="0" />
        <column table="a" column="num_sf" type="number" title="Номер СФ" as="num_sf" key="0" />
        <column table="a" column="kod_parent" type="number" as="kod_parent" key="0" />
        <column table="a" column="u_m" type="string" title="" comment="кем изменено" as="u_m" key="0" />
        <column table="a" column="kod_sf_uo" type="number" as="kod_sf_uo" reference="sr_facvip" refcol="kod_sf" key="0" />
        <column table="a" column="opls" type="number" title="" as="opls" key="0" />
        <column table="a" column="kod_dest" type="number" as="kod_dest" reference="ss_dest_opl" refcol="kod_dest" key="0" />
        <column table="a" column="kod_type_opl" type="number" as="kod_type_opl" key="0" />
        <column table="a" column="kod_link" type="number" as="kod_link" reference="sr_opl_bank" refcol="kod_link" key="0" />
        <column table="a" column="dat_opl" type="date" title="Дата платежного документа" as="dat_opl" key="0" />
        <column table="a" column="tep_el" type="number" title="" as="tep_el" reference="kk_tep_el" refcol="tep_el" key="0" />
        <column table="a" column="kod_dog_r" type="number" as="kod_dog_r" reference="kr_dogovor" refcol="kod_dog" key="0" />
        <column table="a" column="vid_sf" type="number" title="" comment="вид счета-фактуры для переплаты" as="vid_sf" reference="sk_vid_sf" refcol="vid_sf" key="0" />
        <column table="a" column="prim" type="string" title="" comment="дополнительные отметки" as="prim" key="0" />
        <column table="a" column="nom_sf" type="string" title="Номер СФ" comment="полный номер сф по оплате для печати" as="nom_sf" key="0" />
        <column table="a" column="u_c" type="string" title="" comment="кем добавлено" as="u_c" key="0" />
        <column table="a" column="d_c" type="date" title="" comment="когда добавлено" as="d_c" key="0" />
        <column table="a" column="dat_uch" type="date" title="" as="dat_uch" key="0" />
        <column table="a" column="pr_not_in_graf" type="number" title="Не учитывать в ГПЗ" controlType="UICheck" as="pr_not_in_graf" key="0" />
        <call function="if" as="opl_kred" key="0">
          <call function="in">
            <column table="a" column="kod_type_opl" />
            <call function="array">
              <const>1</const>
              <const>2</const>
            </call>
          </call>
          <column table="a" column="opl" />
        </call>
        <column table="this" column="dat_uch" as="dat_oper" dimension="dat" key="0" />
        <column table="a" column="dat_graf" as="dat_oper_graf" dimension="dat_graf" key="0" />
        <call function="date to ym" as="ym_bank" type="number" key="0">
          <column table="a" column="dat_opl" />
        </call>
        <call function="+nvl" as="oplf" fact="opl" agg="sum" title="Оплачено" key="0">
          <column table="a" column="opl" />
          <column table="a" column="opls" />
        </call>
        <call function="if" as="opl_sf_out_spis" key="0">
          <call function="is null">
            <column table="this" column="pr_spis_tt" />
          </call>
          <column table="this" column="oplf" />
        </call>
        <call function="if" as="opl_sf_spis" key="0">
          <call function="=">
            <column table="this" column="pr_spis_tt" />
            <const>1</const>
          </call>
          <column table="this" column="oplf" />
        </call>
        <call function="-nvl" as="oplf_nonal" fact="opl_nonal" agg="sum" title="Оплачено без налога" key="0">
          <column table="this" column="oplf" />
          <column table="this" column="nal" />
        </call>
        <column table="kod_parent" column="ym" as="parent_ym" key="0" />
        <column table="storno_tek" column="oplf" dgroup="sum" as="storno_tek" title="Сумма оплаты (руб.)" key="0" />
        <call function="if" as="opl_sled" key="0">
          <call function="in">
            <column table="a" column="kod_type_opl" />
            <call function="array">
              <const>1</const>
              <const>2</const>
            </call>
          </call>
          <call function="+nvl">
            <column table="this" column="opl" />
            <column table="this" column="storno_tek" />
          </call>
        </call>
        <call function="case" as="kod_type_opl2" type="number" key="0">
          <call function="when">
            <call function="=">
              <column table="a" column="kod_type_opl" />
              <call function="array">
                <const>0</const>
              </call>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="a" column="kod_type_opl" />
                <call function="array">
                  <const>3</const>
                  <const>4</const>
                </call>
              </call>
              <call function="=">
                <column table="a" column="ym" />
                <column table="this" column="parent_ym" />
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="a" column="kod_type_opl" />
                <call function="array">
                  <const>3</const>
                  <const>4</const>
                </call>
              </call>
              <call function="gt">
                <column table="a" column="ym" />
                <column table="this" column="parent_ym" />
              </call>
            </call>
            <const>1</const>
          </call>
        </call>
        <column table="sr_opl_nal" column="nal" title="Налоги, руб." as="nal" key="0" />
        <call function="nvl" as="dat_dog_edit" title="Дата редакции договора" class-title="Договор" key="0">
          <column table="kod_opl_text" column="datdog_pl" />
          <column table="kod_sf_text" column="datdog_pl" />
        </call>
        <column table="sr_recalc_opl" column="kod_recalc" as="kod_recalc" key="0" />
        <column table="kod_sf" column="dat_bzad" as="sf_dat_bzad" key="0" />
        <column as="dat_ur" table="a" column="dat_opl" dimension="dat_ur" key="0" />
        <column as="dat_ur_ent" table="a" column="dat_opl" dimension="dat_ur_ent" key="0" />
        <column table="this" column="ym" as="ym_graf" dimension="ym_graf" key="0" />
        <call function="nvl" type="number" as="ym_root" key="0">
          <column table="kod_opl_root" column="ym" />
          <column table="this" column="ym" />
        </call>
        <call function="nvl" type="number" as="kod_opl_recalc_root" key="0">
          <column table="kod_opl_root" column="kod_opl" />
          <column table="this" column="kod_opl" />
        </call>
        <column as="dat_opl_max" table="a" column="dat_opl" fact="sr_opl_dat_opl_max" agg="max" key="0" />
        <call function="if" type="number" as="vid_real_no_av" dimension="vid_real_no_av" key="0">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>0</const>
          </call>
          <const>2</const>
          <column table="a" column="vid_real" />
        </call>
        <call function="if" as="pr_spis_tt" type="number" key="0">
          <call function="or">
            <call function="like">
              <column table="kod_vidopl" column="abbr" />
              <const>'SPS%'</const>
            </call>
            <call function="like">
              <column table="kodbpol" column="rs" />
              <const>'%Списание деб%'</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="kod_sf_text" column="pr_edo" as="pr_edo" key="0" />
        <column table="kod_sf_text" column="name_edo_pok" as="name_edo_pok" key="0" />
        <call function="nvl" as="kod_opl_main" key="0">
          <column table="a" column="kod_parent" />
          <column table="a" column="kod_opl" />
        </call>
        <column table="a" column="is_new" type="number" sys="1" as="is_new" key="0" />
        <column table="a" column="is_not_new" type="number" sys="1" as="is_not_new" key="0" />
        <column as="opl_bnk" table="this" column="oplf" fact="sr_opl_opl_bnk_36703" agg="sum" title="Оплата (поступление на счет)" />
        <column table="this" column="ym" as="ym_vozn" dimension="ym_vozn" />
      </select>
      <from>
        <table name="sr_opl" as="a">
          <link name="kod_parent" as="kod_parent1" table="sr_opl" child="sr_opl_bnk_36703" field="kod_parent" parent="sr_opl" back="sr_opl_bnk_36703" />
          <link name="kod_link" as="kod_link1" table="sr_opl_bank" child="sr_opl_bnk_36703" field="kod_link" parent="sr_opl_bank" back="sr_opl_bnk_36703">
            <link name="kodbpol" as="kodbpol" table="ks_bankpol" child="sr_opl_bank" field="kodbpol" parent="ks_bankpol" back="sr_opl_bank" />
          </link>
          <link name="kod_opl_text" as="kod_opl_text1" table="sr_opl_text" child="sr_opl_bnk_36703" field="kod_opl_text" parent="sr_opl_text" back="sr_opl_bnk_36703" />
          <link name="kod_sf" as="kod_sf1" table="sr_facvip" child="sr_opl_bnk_36703" field="kod_sf" parent="sr_facvip" back="sr_opl_bnk_36703">
            <link name="kod_sf_text" as="kod_sf_text" table="sr_facvip_text" child="sr_facvip" field="kod_sf_text" parent="sr_facvip_text" back="sr_facvip" />
          </link>
          <slink name="sr_opl_nal" as="sr_opl_nal" table="sr_opl_nal" />
          <dlink name="storno" as="storno_tek" pushpred="1" table="sr_opl" child="sr_opl" field="kod_parent_kred" parent="sr_opl" back="storno">
            <where>
              <call function="=">
                <column table="a" column="ym" />
                <column table="storno_tek" column="ym" />
              </call>
            </where>
          </dlink>
          <link name="sr_opl_recalc_tree_info" as="sr_opl_recalc_tree_info1" table="sr_opl_recalc_tree_info" child="sr_opl_bnk_36703" field="sr_opl_recalc_tree_info" parent="sr_opl_recalc_tree_info" back="sr_opl_bnk_36703">
            <link name="kod_opl_root" as="kod_opl_root" table="sr_opl" child="sr_opl_recalc_tree_info" field="kod_opl_root" parent="sr_opl" back="sr_opl_recalc_tree_info" />
          </link>
          <link name="kod_dog" as="kod_dog1" table="kr_dogovor" child="sr_opl_bnk_36703" field="kod_dog" parent="kr_dogovor" back="sr_opl_bnk_36703" title="Договор">
            <link name="kod_dep" dimension="1" as="kod_dep" table="kr_dep" child="kr_dogovor" field="kod_dep" parent="kr_dep" back="kr_dogovor" />
            <link name="kodp" dimension="1" as="kodp" table="kr_payer" child="kr_dogovor" field="kodp" parent="kr_payer" back="kr_dogovor" title="Абонент" />
          </link>
          <dlink name="sr_recalc_opl" as="sr_recalc_opl2" table="sr_recalc_opl" child="sr_recalc_opl" field="kod_opl" parent="sr_opl" back="sr_recalc_opl">
            <link name="kod_recalc" as="kod_recalc2" table="sr_recalc" child="sr_recalc_opl" field="kod_recalc" parent="sr_recalc" back="sr_recalc_opl">
              <link name="vid_recalc" is-private-dimension="1" is-final-dimension="1" dimension="1" as="vid_recalc" table="ss_vid_recalc" child="sr_recalc" field="vid_recalc" parent="ss_vid_recalc" back="sr_recalc" />
            </link>
          </dlink>
        </table>
        <query name="sr_opl_text" as="kod_opl_text" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_opl" />
            <column table="kod_opl_text" column="kod_opl" />
          </call>
        </query>
        <query name="sr_facvip" as="kod_sf_uo" join="left outer" dname="sr_opl_uo">
          <call function="=">
            <column table="a" column="kod_sf_uo" />
            <column table="kod_sf_uo" column="kod_sf" />
          </call>
        </query>
        <query name="kk_tep_el" as="tep_el" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="tep_el" />
            <column table="tep_el" column="tep_el" />
          </call>
        </query>
        <query name="sk_type_opl" as="kod_type_opl" join="left outer" dimension="kod_type_opl" title="Тип оплаты" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_type_opl" />
            <column table="kod_type_opl" column="kod_type_opl" />
          </call>
        </query>
        <query name="sk_vid_real" as="vid_real" join="left outer" dimension="1" title="Вид реализации" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="vid_real" />
            <column table="vid_real" column="vid_real" />
          </call>
        </query>
        <query name="sr_facvip" as="kod_sf" join="left outer" dimension="kod_sf" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_sf" />
            <column table="kod_sf" column="kod_sf" />
          </call>
        </query>
        <query name="sr_opl_bank" as="kod_link" join="left outer" dimension="1" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_link" />
            <column table="kod_link" column="kod_link" />
          </call>
        </query>
        <query name="sr_opl" as="kod_parent" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_parent" />
            <column table="kod_parent" column="kod_opl" />
          </call>
        </query>
        <query name="ss_dest_opl" as="kod_dest" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_dest" />
            <column table="kod_dest" column="kod_dest" />
          </call>
        </query>
        <query name="ss_vidopl" as="kod_vidopl" join="left outer" dimension="1" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_vidopl" />
            <column table="kod_vidopl" column="kod_vidopl" />
          </call>
        </query>
        <query name="kr_dogovor" as="kod_dog" join="left outer" dimension="kod_dog" title="Договор" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="kod_dog" column="kod_dog" />
          </call>
        </query>
        <query name="sk_vid_sf" as="vid_sf" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="vid_sf" />
            <column table="vid_sf" column="vid_sf" />
          </call>
        </query>
        <query name="kr_dogovor" as="kod_dog_r" join="left outer" title="Договор" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_dog_r" />
            <column table="kod_dog_r" column="kod_dog" />
          </call>
        </query>
        <query name="sr_opl" as="kod_parent_kred" dname="storno" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_parent" />
              <column table="kod_parent_kred" column="kod_opl" />
            </call>
            <call function="in">
              <column table="a" column="kod_type_opl" />
              <call function="array">
                <const>5</const>
                <const>6</const>
              </call>
            </call>
          </call>
        </query>
        <query name="sr_recalc_opl" as="sr_recalc_opl" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_opl" />
            <column table="sr_recalc_opl" column="kod_opl" />
          </call>
        </query>
        <query name="sr_opl_recalc_tree_info" as="sr_opl_recalc_tree_info" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_opl" />
            <column table="sr_opl_recalc_tree_info" column="kod_opl" />
          </call>
        </query>
        <query name="sr_recalc" as="kod_recalc" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_recalc" />
            <column table="kod_recalc" column="kod_recalc" />
          </call>
        </query>
        <query name="sr_opl" as="kod_opl_main" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_opl_main" />
            <column table="kod_opl_main" column="kod_opl" />
          </call>
        </query>
        <query name="sr_opl" as="kod_opl_recalc_root" join="left outer" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="this" column="kod_opl_recalc_root" />
            <column table="kod_opl_recalc_root" column="kod_opl" />
          </call>
        </query>
        <query name="sr_opl" as="kod_opl" join="left outer" dimension="1" dname="sr_opl_bnk_36703">
          <call function="=">
            <column table="a" column="kod_opl" />
            <column table="kod_opl" column="kod_opl" />
          </call>
        </query>
      </from>
      <where>
        <call function="in">
          <column table="this" column="kod_type_opl" />
          <call function="array">
            <const>0</const>
            <const>1</const>
            <const>2</const>
          </call>
        </call>
      </where>
    </query>
    <query name="36703-fin-per-dolg" timestamp="28.02.2018 19:37:47" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="ym" as="ym" key="0" />
        <column table="a" column="deb_beg" as="deb_beg" key="0" />
        <column table="a" column="kred_beg" as="kred_beg" key="0" />
        <column table="a" column="deb_end" as="deb_end" key="0" />
        <column table="a" column="kred_end" as="kred_end" key="0" />
      </select>
      <from>
        <query name="36703-fin-per-dolg1" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="ge">
          <column table="a" column="ym" />
          <call function="date to ym">
            <useparam name="dat1" />
          </call>
        </call>
      </where>
    </query>
    <query name="36703-fin-per-dolg1" timestamp="28.02.2018 19:32:23" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_dog_fin" column="kod_dog" as="kod_dog" />
        <column table="ym" column="val" as="ym" />
        <fact column="fin_ul_ob_osn" as="deb" agg="" is-fact-use="1" />
        <fact column="fin_ul_ob_kr" as="kred" agg="" is-fact-use="1" />
        <call function="over" as="deb_beg" agg="">
          <call function="lag">
            <column table="this" column="deb_end" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="kred_beg" agg="">
          <call function="lag">
            <column table="this" column="kred_end" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="deb_end" agg="">
          <call function="sum">
            <column table="this" column="deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="kred_end" agg="">
          <call function="sum">
            <column table="this" column="kred" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="ym" />
          <link name="dat" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="le">
                <column table="dat" column="val" />
                <useparam name="dat" />
              </call>
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-fin-per-oth" timestamp="10.04.2018 17:22:17" use-repository="1" inherit="36703-fin-cmn" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_dog_fin" column="kod_dog" as="kod_dog" />
        <column table="ym_vozn" column="val" as="ym_vozn" />
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <column table="vid_real" column="vid_real" as="vid_real" />
        <column table="kod_sf" column="dat_bzad" group="max" as="dat_bzad" />
        <column table="kod_sf" column="ym" as="ym" />
        <call function="case" as="name_plat" type="string" group="max" title="Наименование платежа">
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>2</const>
                <const>3</const>
              </call>
            </call>
            <call function="||">
              <const>'Итоговый расчет за '</const>
              <call function="lower">
                <call function="mes-name">
                  <call function="mes">
                    <column table="this" column="ym_vozn" />
                  </call>
                </call>
              </call>
              <const>' '</const>
              <call function="trunc">
                <column table="this" column="ym_vozn" />
              </call>
              <const>' г.'</const>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>0</const>
              </call>
            </call>
            <call function="||">
              <const>'Аванс '</const>
              <column table="kod_sf_dop" column="perc" />
              <const>'% за '</const>
              <call function="lower">
                <call function="mes-name">
                  <call function="mes">
                    <column table="kod_sf" column="rym" />
                  </call>
                </call>
              </call>
              <const>' '</const>
              <call function="trunc">
                <column table="kod_sf" column="rym" />
              </call>
              <const>' г.'</const>
            </call>
          </call>
          <call function="when">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>9</const>
              </call>
            </call>
            <call function="||">
              <const>'Гос. пошлина '</const>
              <call function="if" type="string">
                <call function="is not null">
                  <column table="this" column="num_delo" />
                </call>
                <call function="||">
                  <const>'по делу № '</const>
                  <column table="this" column="num_delo" />
                </call>
              </call>
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                </call>
              </call>
              <call function="is not null">
                <column table="this" column="num_delo" />
              </call>
            </call>
            <call function="||">
              <const>'Проценты по делу № '</const>
              <column table="this" column="num_delo" />
            </call>
          </call>
          <call function="when">
            <call function="and">
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                </call>
              </call>
              <call function="is null">
                <column table="this" column="num_delo" />
              </call>
            </call>
            <const>'Проценты за пользование чужими денежными средствами'</const>
          </call>
        </call>
        <fact column="nach_all" table="sf" group="sum" nvl="0" as="nach" is-fact-use="1" />
        <fact column="opl_nach_all" table="sf" group="sum" nvl="0" as="opl_nach" is-fact-use="1" />
        <fact column="opl_in_month" table="sf" group="sum" as="opl" nvl="0" is-fact-use="1" />
        <fact column="dolg" as="dolg" table="sf" group="sum" nvl="0" is-fact-use="1" />
        <fact column="dolg_not_av" as="dolg_check" table="sf" group="sum" nvl="0" is-fact-use="1" />
        <fact column="dolg_pros" table="sf" group="sum" nvl="0" as="dolg_pros" is-fact-use="1" />
        <call function="coalesce" type="string" as="num_delo">
          <fact column="iv_sf_astr_info_num_delo" table="sf" />
          <fact column="iv_sf_ur_prizn_info_num_delo" table="sf" />
        </call>
        <fact column="kr_dogovor_kod_dog" group="max" title=" " as="pr_dog" is-fact-use="1" />
      </select>
      <grouping>
        <grset as="itog">
          <where>
            <call function="!=0">
              <column table="this" column="dolg_check" />
              <column table="this" column="opl" />
            </call>
          </where>
          <group>
            <sourcelink table="kod_dog_fin" />
          </group>
          <grset as="itog_deb">
            <where>
              <call function="!=0">
                <column table="this" column="dolg_check" />
                <column table="this" column="opl" />
              </call>
            </where>
          </grset>
          <grset as="itog_osn_av">
            <where>
              <call function="and">
                <call function="!=0">
                  <column table="this" column="dolg_check" />
                  <column table="this" column="opl" />
                </call>
                <call function="or">
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                      <const>3</const>
                      <const>0</const>
                    </call>
                  </call>
                  <call function="is not null">
                    <column table="this" column="pr_dog" />
                  </call>
                </call>
              </call>
            </where>
            <grset as="itog_osn">
              <where>
                <call function="or">
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                    </call>
                  </call>
                  <call function="is not null">
                    <column table="this" column="pr_dog" />
                  </call>
                </call>
              </where>
              <grset as="det_osn">
                <where>
                  <call function="!=0">
                    <column table="this" column="dolg_check" />
                    <column table="this" column="nach" />
                  </call>
                  <call function="in">
                    <column table="this" column="vid_real" />
                    <call function="array">
                      <const>2</const>
                    </call>
                  </call>
                </where>
                <group>
                  <sourcelink table="ym_vozn" />
                </group>
              </grset>
            </grset>
            <grset as="det_av">
              <group>
                <sourcelink table="kod_sf" />
                <sourcelink table="ym_vozn" />
              </group>
              <where>
                <call function="in">
                  <column table="this" column="vid_real" />
                  <call function="array">
                    <const>0</const>
                  </call>
                </call>
              </where>
            </grset>
          </grset>
          <grset as="det_othr">
            <group>
              <sourcelink table="kod_sf" />
              <sourcelink table="ym_vozn" />
            </group>
            <where>
              <call function="in">
                <column table="this" column="vid_real" />
                <call function="array">
                  <const>7</const>
                  <const>9</const>
                </call>
              </call>
            </where>
          </grset>
        </grset>
      </grouping>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog_fin" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
          <dimset as="sf">
            <where>
              <call function="and" dont-push="1">
                <call function="lt">
                  <column table="dat" column="val" />
                  <useparam name="dat" />
                </call>
              </call>
            </where>
            <link name="kod_sf">
              <link name="kod_sf_dop" />
            </link>
            <link name="dat" />
            <link name="vid_real" />
            <link name="ym_vozn" />
          </dimset>
          <dimset as="sf_all_time" comment="без условия по дате">
            <link name="kod_sf">
              <link name="kod_sf_dop" />
            </link>
            <link name="dat" />
            <link name="vid_real" />
            <link name="ym_vozn" />
          </dimset>
        </qube>
      </from>
      <where>
        <call function="!=0">
          <column table="this" column="dolg_check" />
          <column table="this" column="pr_dog" />
          <column table="this" column="opl" />
        </call>
      </where>
    </query>
    <query name="q36703_opl_nach" timestamp="10.04.2018 14:32:25" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <expressions>
        <call as="is_osn_real" function="in">
          <column table="vid_real" column="vid_real" />
          <call function="array">
            <const>2</const>
            <const>3</const>
          </call>
        </call>
        <call function="()" group="sum" type="number" as="nach">
          <fact column="sr_facras_nachisl" condition="is_osn_real" />
        </call>
        <call function="()" group="sum" type="number" as="opl_per">
          <fact column="sr_opl_opl_bnk" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" />
        <column table="kod_sf" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" as="ym" />
        <column table="vid_real_no_av" column="vid_real" as="vid_real" is-private-dimension="vid_real_no_av" is-final-dimension="vid_real_no_av" dimension="vid_real_no_av" />
        <column table="dat" column="val" as="dat_val" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <fact column="sr_opl_opl_sf" as="opl" is-fact="1" agg="sum" is-fact-use="1" fact="q36703_opl_nach_opl" />
        <fact column="sr_opl_sf_dat_max" as="dt" is-fact="1" agg="max" is-fact-use="1" fact="q36703_opl_nach_dt" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="kod_sf" />
          <link name="vid_real_no_av" />
          <link name="dat" />
          <link name="ym" />
        </qube>
      </from>
    </query>
    <query name="q36703_sf_info" timestamp="09.04.2018 23:52:23" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <select>
        <column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" />
        <column table="kod_sf" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" as="ym" />
        <column table="dat" column="val" as="dat_val" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <column table="kod_sf_ret_inf" column="name_podpis" is-fact="1" agg="max" as="name_podpis" fact="q36703_sf_info_name_podpis" />
        <column table="kod_sf" column="dat_bzad" is-fact="1" agg="min" as="dat_bzad" fact="q36703_sf_info_dat_bzad" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="kod_sf" all-rows="1">
            <link name="kod_sf_dop" />
            <link name="kod_sf_ret_inf" />
          </link>
          <link name="vid_real_no_av" />
          <link name="dat" />
          <link name="ym" />
          <where>
            <call function="in">
              <column table="vid_real_no_av" column="vid_real" />
              <call function="array">
                <const>2</const>
                <const>3</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-fin-per1" timestamp="25.04.2018 17:31:58" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="ym" as="ym" key="0" />
        <column table="a" column="ym" as="ym_vozn" key="0" />
        <column table="a" column="name_plat" as="name_plat" key="0" />
        <column table="a" column="nach" as="nach" key="0" is-fact-use="1" />
        <column table="a" column="opl_nach" as="opl_nach" key="0" is-fact-use="1" />
        <column table="a" column="opl_dt" as="opl_dt" key="0" is-fact-use="1" />
        <column table="a" column="opl" as="opl" key="0" is-fact-use="1" />
        <column table="a" column="name_podpis" as="name_podpis" key="0" is-fact-use="1" />
        <column table="a" column="dat_bzad" as="dat_bzad" key="0" is-fact-use="1" />
        <column table="a" column="deb_end" as="deb_end" key="0" />
        <column table="a" column="kred_end" as="kred_end" key="0" />
        <column table="a" column="dog_ym_ft" as="dog_ym_ft" key="0" is-fact-use="1" />
        <call function="over" as="deb_beg" nvl="0" key="0">
          <call function="lag">
            <column table="this" column="deb_end" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="kred_beg" nvl="0" key="0">
          <call function="lag">
            <column table="this" column="kred_end" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by 2">
            <column table="this" column="ym" />
          </call>
        </call>
        <column table="a" column="dolg_pros" as="dolg_pros" key="0" is-fact-use="1" />
      </select>
      <from>
        <query name="36703-fin-per" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="q36703_dog_ym" timestamp="10.04.2018 13:24:08" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <select>
        <column table="kod_dog" column="kod_dog" agg="" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" key="0" />
        <column table="ym" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" as="ym" reference="spr_time_ym" refcol="ym" key="1" />
        <call function="ym begin time" as="dat" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" key="0">
          <column table="this" column="ym" />
        </call>
        <call type="number" function="()" as="ft" is-fact="1" agg="sum" fact="q36703_dog_ym_ft" key="0">
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog" all-rows="1">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
        </qube>
        <query name="spr_time_ym" as="ym" join="left outer" dname="q36703_dog_ym">
          <call function="between">
            <column table="ym" column="ym" />
            <const>2010.01</const>
            <call function="date to ym">
              <call function="date add days">
                <call function="sysdate" />
                <const>300</const>
              </call>
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="q36703_nak_svd" timestamp="10.04.2018 14:08:54" use-repository="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <select>
        <column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog" is-final-dimension="kod_dog" dimension="kod_dog" as="kod_dog" />
        <column table="ym" column="val" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" as="ym" />
        <call function="ym end time" as="dat" is-private-dimension="dat" is-final-dimension="dat" dimension="dat">
          <column table="this" column="ym" />
        </call>
        <fact column="sr_nak_tep_sv_dolg_end" as="sn" is-fact="1" agg="sum" is-fact-use="1" fact="q36703_nak_svd_sn" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kod_dog_fin">
              <link name="dep" />
              <link name="kodp" />
            </link>
          </link>
          <link name="ym" />
        </qube>
      </from>
    </query>
    <query name="36703-fin-per2" timestamp="09.06.2022 16:56:00" use-repository="1" order="ym" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="ym" as="ym" key="0" />
        <column table="a" column="ym" as="ym_vozn" key="0" />
        <column table="a" column="name_plat" as="name_plat" key="0" />
        <column table="a" column="nach" as="nach" key="0" is-fact-use="1" />
        <column table="a" column="opl_nach" as="opl_nach" key="0" is-fact-use="1" />
        <column table="a" column="opl_dt" as="opl_dt" key="0" is-fact-use="1" />
        <column table="a" column="opl" as="opl" key="0" is-fact-use="1" />
        <column table="a" column="name_podpis" as="name_podpis" key="0" is-fact-use="1" />
        <column table="a" column="dat_bzad" as="dat_bzad" key="0" is-fact-use="1" />
        <column table="a" column="deb_end" as="deb_end" key="0" />
        <column table="a" column="kred_end" as="kred_end" key="0" />
        <column table="a" column="dog_ym_ft" as="dog_ym_ft" key="0" is-fact-use="1" />
        <column table="a" column="deb_beg" as="deb_beg" key="0" />
        <column table="a" column="kred_beg" as="kred_beg" key="0" />
        <column table="a" column="dolg_pros" as="dolg_pros" key="0" is-fact-use="1" />
      </select>
      <from>
        <query name="36703-fin-per1" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="ge">
          <column table="this" column="ym" />
          <call function="date to ym">
            <useparam name="dat1" />
          </call>
        </call>
      </where>
      <order>
        <column column="ym" />
      </order>
    </query>
    <query name="q36703_32" timestamp="09.11.2018 13:05:40" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="*" as="*" key="0" />
        <call function="over" as="pr_pret_with_last_and_dolg_sf" type="number" key="0">
          <call function="max">
            <column table="this" column="pr_last_and_dolg" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_pret" />
          </call>
        </call>
      </select>
      <from>
        <query name="q36703_32_pre" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="q36703_32_grouped_pret" timestamp="09.11.2018 14:52:09" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="a" column="kod_pret" group="1" title="Договор" as="kod_pret" key="1" fixed="1" />
        <column table="a" column="kod_dog" group="max" title="Договор" as="kod_dog" key="0" />
        <call function="substr" as="dat_form" key="0">
          <call function="date to char">
            <column table="a" column="dat_form" group="1" />
          </call>
          <const type="number">1</const>
          <const type="number">10</const>
        </call>
        <column table="a" column="dolg_osn_real" group="sum" as="dolg_osn_real" key="0" />
        <column table="a" column="dolg_gp" group="sum" as="dolg_gp" key="0" />
        <column table="a" column="dolg_peni" group="sum" as="dolg_peni" key="0" />
        <column table="a" column="dolg_sud_peni" group="sum" as="dolg_sud_peni" key="0" />
        <column table="a" column="dolg_astr" group="sum" as="dolg_astr" key="0" />
        <column table="a" column="dolg_othr" group="sum" as="dolg_othr" key="0" />
        <call function="substr" as="dolg_detail_string" key="0">
          <call function="||">
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_osn_real" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', основной долг  '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_osn_real" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_gp" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', госпошлина  '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_gp" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_peni" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', пени - '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_peni" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_sud_peni" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', взысканные проценты  '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_sud_peni" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_astr" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', астрент '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_astr" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
            <call function="if">
              <call function="gt">
                <column table="a" column="dolg_othr" group="sum" />
                <const type="number">0</const>
              </call>
              <call function="||">
                <const type="string">', иное  '</const>
                <call type="string" function="number_to_currency_string">
                  <column table="a" column="dolg_othr" group="sum" />', основной долг - '</call>
                <const type="string">' р.'</const>
              </call>
            </call>
          </call>
          <const type="number">2</const>
        </call>
        <call function="number_to_currency_string" as="dolg_total" key="0">
          <call function="+">
            <column table="a" column="dolg_osn_real" group="sum" />
            <column table="a" column="dolg_gp" group="sum" />
            <column table="a" column="dolg_peni" group="sum" />
            <column table="a" column="dolg_sud_peni" group="sum" />
            <column table="a" column="dolg_astr" group="sum" />
            <column table="a" column="dolg_othr" group="sum" />
          </call>
        </call>
        <call function="vg_period.ym_enum_str_to_date_ranges_str" as="period_string" key="0">
          <column table="a" column="period_string" group="stragg_dist" />
        </call>
        <column table="a" column="kod_pret_dolg_sf" group="count" as="sf_count" title="Количество с/ф" key="0" />
        <call function="over" as="cnt_pret" type="number" key="0">
          <call function="count">
            <column table="this" column="kod_pret" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
        </call>
      </select>
      <from>
        <query name="q36703_32" as="a">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=1">
            <column table="a" column="pr_pret_with_last_and_dolg_sf" />
            <const type="number">1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="q36703_32_pre" timestamp="09.11.2018 13:26:38" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="ps" column="kod_pret_dolg_sf" as="kod_pret_dolg_sf" />
        <column table="p" column="kod_dog" as="kod_dog" />
        <column table="s" column="kodp" as="kodp" />
        <call function="if" as="period_string">
          <call function="!=">
            <const type="number">0</const>
            <call function="nvl0">
              <column table="ps" column="dolg_osn_real" />
            </call>
          </call>
          <column table="s" column="ym" />
        </call>
        <column table="p" column="dat_form" as="dat_form" />
        <column table="p" column="kod_pret" as="kod_pret" />
        <call function="nvl0" as="dolg_osn_real">
          <column table="ps" column="dolg_osn_real" />
        </call>
        <call function="nvl0" as="dolg_gp">
          <column table="ps" column="dolg_gp" />
        </call>
        <call function="nvl0" as="dolg_peni">
          <column table="ps" column="dolg_peni" />
        </call>
        <call function="nvl0" as="dolg_sud_peni">
          <column table="ps" column="dolg_sud_peni" />
        </call>
        <call function="nvl0" as="dolg_astr">
          <column table="ps" column="dolg_astr" />
        </call>
        <call function="nvl0" as="dolg_othr">
          <column table="ps" column="dolg_othr" />
        </call>
        <call function="dense_rank" as="pret_order">
          <call function="partition by">
            <column table="p" column="kod_dog" />
          </call>
          <call function="order by 2">
            <call function="desc">
              <column table="p" column="dat_form" />
            </call>
          </call>
        </call>
        <fact column="fin_ul_ob" as="fin_ul_ob" is-fact-use="1" />
        <call function="if" as="pr_last_and_dolg" type="number">
          <call function="and">
            <call function="gt">
              <column table="this" column="fin_ul_ob" />
              <const>0</const>
            </call>
            <call function="=1">
              <column table="this" column="pret_order" />
            </call>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_sf" as="s" />
          <link name="dat" as="d" />
          <link name="vr_pret_dolg_sf" as="ps" />
          <link name="kr_pret" as="p" />
          <where>
            <call function="and">
              <call function="le">
                <column table="d" column="val" />
                <useparam name="dat" />
              </call>
              <call function="in" optional="1">
                <column table="p" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
              <call function="in" optional="1">
                <column table="s" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="le">
                <column table="p" column="dat_form" />
                <useparam name="dat" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="36703-graf" timestamp="21.11.2018 16:01:57" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <column table="kod_graf" column="kod_graf" group="1" as="kod_graf" key="1" fixed="1" />
        <column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <column group="1" table="kodp" column="kodp" as="kodp" key="1" fixed="1" />
        <column table="kodp" column="nump" group="1" as="nump" key="1" fixed="1" />
        <column column="ym_min" table="kod_graf" group="1" as="ym_min" key="1" fixed="1" />
        <column group="1" table="kod_graf" column="kod_graf_status" as="kod_graf_status" key="1" fixed="1" />
        <call function="nvl" type="string" as="num_delo" group="1" key="1" fixed="1">
          <column table="kod_mat" column="num_delo" />
          <column table="kod_mat_i" column="num_delo" />
        </call>
        <column table="kod_graf" column="sum_graf" group="1" as="sum_graf" key="1" fixed="1" />
        <call function="||-" as="graf_period" group="1" key="1" fixed="1">
          <call function="ym to char">
            <column column="ym_min" table="kod_graf" />
          </call>
          <call function="ym to char">
            <column column="ym_max" table="kod_graf" />
          </call>
        </call>
        <call function="if" as="graf_nach" group="sum" title="Начислено" key="0">
          <call function="le" dont-push="1">
            <column table="dat" column="val" />
            <call function="nvl">
              <column table="kod_graf" column="dat_finish" />
              <call function="doomsday" />
            </call>
          </call>
          <fact column="ur_graf_opl_sum" as="graf_nach" />
        </call>
        <call function="if" as="graf_opl" group="sum" title="Оплачено" key="0">
          <call function="le" dont-push="1">
            <column table="dat" column="val" />
            <call function="nvl">
              <column table="kod_graf" column="dat_finish" />
              <call function="doomsday" />
            </call>
          </call>
          <fact column="sr_opl_opl_sf" as="graf_opl" />
        </call>
        <column table="kod_graf_status" column="name" as="status_name" group="1" key="1" fixed="1" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="kodp" />
          </link>
          <link name="kod_graf">
            <link name="kod_hist_mat">
              <link name="kod_mat" />
            </link>
            <link name="kod_isp">
              <link name="kod_hist_mat" as="kod_hist_mat_i">
                <link name="kod_mat" as="kod_mat_i" />
              </link>
            </link>
            <link name="kod_graf_status" />
          </link>
          <link name="dat" />
          <link name="kod_opl">
            <where>
              <call function="!=nvl">
                <column table="kod_opl" column="pr_not_in_graf" />
                <const type="number">1</const>
              </call>
            </where>
          </link>
          <where>
            <call function="and">
              <call function="or">
                <call function="is not null" dont-push="1">
                  <column table="kod_graf" column="kod_hist_mat" />
                </call>
                <call function="is not null" dont-push="1">
                  <column table="kod_graf" column="kod_isp" />
                </call>
                <call function="is not null" dont-push="1">
                  <column table="kod_graf" column="kod_sogl" />
                </call>
              </call>
              <call function="le" dont-push="1">
                <column table="kod_graf" column="dat_opl_beg_nvl" />
                <column table="kod_opl" column="dat_opl" />
              </call>
              <call function="le" dont-push="1">
                <column column="val" table="dat" />
                <useparam name="dat" />
              </call>
              <call function="gt" dont-push="1" optional="1">
                <call function="nvl">
                  <column table="kod_graf" column="dat_finish" />
                  <call function="doomsday" />
                </call>
                <useparam name="dat1" />
              </call>
              <call function="in" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="le" dont-push="1">
          <call function="nvl">
            <column table="kod_graf" column="ym_min" />
            <const type="number">0</const>
          </call>
          <call function="date to ym">
            <useparam name="dat" />
          </call>
        </call>
      </where>
    </query>
    <query name="36703-graf_d" timestamp="23.11.2018 16:41:54" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml" haskeys="1">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
        <param name="exclude_status" type="array" />
      </params>
      <select>
        <column table="g" column="kod_dog" as="kod_dog" key="1" fixed="1" />
        <column table="g" column="kod_graf" as="kod_graf" key="1" fixed="1" />
        <column table="g" column="kodp" group="max" as="kodp" key="1" fixed="1" />
        <column table="g" column="nump" group="max" as="nump" key="1" fixed="1" />
        <column table="g" column="ym_min" group="max" as="ym_min" key="1" fixed="1" />
        <column table="g" column="kod_graf_status" group="max" as="kod_graf_status" key="1" fixed="1" />
        <column table="g" column="num_delo" group="max" as="num_delo" key="1" fixed="1" />
        <column table="g" column="sum_graf" group="max" as="sum_graf" key="1" fixed="1" />
        <column table="g" column="graf_period" group="max" as="graf_period" key="1" fixed="1" />
        <column table="g" column="graf_nach" group="max" as="graf_nach" key="0" />
        <column table="g" column="graf_opl" group="max" as="graf_opl" key="0" />
        <call function="-nvl" as="graf_ost" title="Остаток оплаты" group="max" key="0">
          <column table="g" column="sum_graf" />
          <column table="g" column="graf_opl" />
        </call>
        <call function="if" type="string" as="graf_isp" title="Исполнено/не исполнено" group="max" key="0">
          <call function="gt">
            <call function="-nvl">
              <column table="g" column="graf_nach" />
              <column table="g" column="graf_opl" />
            </call>
            <const>0</const>
          </call>
          <const>'не исполнено'</const>
          <const>'исполнено'</const>
        </call>
        <column table="g" column="status_name" group="max" as="status_name" key="1" fixed="1" />
      </select>
      <from>
        <query name="36703-graf" as="g">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="not in" optional="1">
            <column table="g" column="kod_graf_status" />
            <useparam name="exclude_status" />
          </call>
        </call>
      </where>
      <grouping>
        <grset as="dog">
          <group>
            <column table="this" column="kod_dog" />
          </group>
          <grset as="graf">
            <group>
              <column table="this" column="kod_graf" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="form:36703" haskeys="1">
      <select>
        <column table="u" column="title" title="Параметр" as="title" />
        <column table="u" column="name" key="1" as="name" />
        <column table="u" column="text" title="Значение" as="text" />
      </select>
      <from>
        <query as="u">
          <union>
            <query>
              <select>
                <const type="string" as="title">'Дата'</const>
                <const type="string" as="name">'dat'</const>
                <const type="string" as="text">NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'Абонент'</const>
                <const>'kodp'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'Договор'</const>
                <const>'kod_dog'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
    <query name="form:36703-per" haskeys="1">
      <select>
        <column table="u" column="title" title="Параметр" as="title" />
        <column table="u" column="name" key="1" as="name" />
        <column table="u" column="text" title="Значение" as="text" />
      </select>
      <from>
        <query as="u">
          <union>
            <query>
              <select>
                <const type="string" as="title">'С даты'</const>
                <const type="string" as="name">'dat1'</const>
                <const type="string" as="text">NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'По дату'</const>
                <const>'dat'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'Абонент'</const>
                <const>'kodp'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'Договор'</const>
                <const>'kod_dog'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id">
    <part id="36703-params" timestamp="14.05.2024 23:34:11" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <param name="dat1" type="date">
        <const>to_date('01.01.2015','DD.MM.YYYY')</const>
      </param>
      <param name="dat" type="date">
        <const>to_date('28.03.2019','DD.MM.YYYY')</const>
      </param>
      <param name="kodp" type="array" />
      <param name="kod_dog" type="array" />
      <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
    </part>
    <part id="36703-withparams" timestamp="14.05.2024 23:35:07" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <useparam name="dat1" />
      <useparam name="dat" />
      <useparam name="kodp" />
      <useparam name="kod_dog" />
      <useparam name="p_cat_rep" />
    </part>
    <part id="36703-name_plat" timestamp="09.10.2016 19:05:38" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <call function="case" as="name_plat" type="string" group="max" title="Наименование платежа">
        <call function="when">
          <call function="in">
            <column table="this" column="vid_real" />
            <call function="array">
              <const>2</const>
              <const>3</const>
            </call>
          </call>
          <call function="||">
            <const>'Итоговый расчет за '</const>
            <call function="lower">
              <call function="mes-name">
                <call function="mes">
                  <column table="this" column="ym_vozn" />
                </call>
              </call>
            </call>
            <const>' '</const>
            <call function="trunc">
              <column table="this" column="ym_vozn" />
            </call>
            <const>' г.'</const>
          </call>
        </call>
        <call function="when">
          <call function="in">
            <column table="this" column="vid_real" />
            <call function="array">
              <const>0</const>
            </call>
          </call>
          <call function="||">
            <const>'Аванс '</const>
            <column table="kod_sf_dop" column="perc" />
            <const>'% за '</const>
            <call function="lower">
              <call function="mes-name">
                <call function="mes">
                  <column table="kod_sf" column="rym" />
                </call>
              </call>
            </call>
            <const>' '</const>
            <call function="trunc">
              <column table="kod_sf" column="rym" />
            </call>
            <const>' г.'</const>
          </call>
        </call>
        <call function="when">
          <call function="in">
            <column table="this" column="vid_real" />
            <call function="array">
              <const>9</const>
            </call>
          </call>
          <call function="||">
            <const>'Гос. пошлина '</const>
            <call function="if" type="string">
              <call function="is not null">
                <column table="this" column="num_delo" />
              </call>
              <call function="||">
                <const>'по делу № '</const>
                <column table="this" column="num_delo" />
              </call>
            </call>
          </call>
        </call>
        <call function="when">
          <call function="and">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>7</const>
              </call>
            </call>
            <call function="is not null">
              <column table="this" column="num_delo" />
            </call>
          </call>
          <call function="||">
            <const>'Проценты по делу № '</const>
            <column table="this" column="num_delo" />
          </call>
        </call>
        <call function="when">
          <call function="and">
            <call function="in">
              <column table="this" column="vid_real" />
              <call function="array">
                <const>7</const>
              </call>
            </call>
            <call function="is null">
              <column table="this" column="num_delo" />
            </call>
          </call>
          <const>'Проценты за пользование чужими денежными средствами'</const>
        </call>
      </call>
    </part>
  </parts>
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="36703" form="36703" timestamp="20.12.2021 21:30:01" folder="dolg" autobands="1" title="Справка о задолженности на дату" nogrid="1" save-compiled="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <customers>
        <customer id="101" />
      </customers>
      <procedure>
begin
vg_mview.refresh('vv_sr_facvip_norm_av');
vg_mview.refresh('vv_sr_opl_norm_av');
end;
</procedure>
      <print-templates>
        <excel>
          <template name="36703-dat.xml" title="Справка о задолженности на дату" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="36703-abon" as="abon" title="Абонент">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
          <query name="36703-dog" as="dog" title="Договор">
            <withparams>
              <useparam name="dat1" />
              <useparam name="dat" />
              <useparam name="kodp" />
              <useparam name="kod_dog" />
              <useparam name="p_cat_rep" />
            </withparams>
            <call function="=">
              <column table="abon" column="kodp" />
              <column table="dog" column="kodp" />
            </call>
            <query name="36703-fin-dat" as="fin" title="Задолженность">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="fin" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-avans-info" as="av_info" title="Аванс по договору">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="av_info" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-dog-lim" as="lim" title="Лимит">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="lim" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-obj" title="Объекты" as="obj">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="obj" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-isk" as="isk" title="Юридическая работа">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="isk" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-uved" as="uved" title="Ограничение">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="uved" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-teh" as="teh" title="Техническая информация">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="teh" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="q36703_32_grouped_pret" as="pret" title="Отправленные претензии">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="pret" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-graf_d" as="graf" title="ГПЗ">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
                <call function="array">
                  <const>1</const>
                  <const>2</const>
                  <const>3</const>
                </call>
              </withparams>
              <call function="=">
                <column table="graf" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
          </query>
        </query>
        <query name="36703-info-dat" as="info" title="Доп. информация">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="36703-per" form="36703-per" timestamp="07.12.2020 14:24:03" folder="dolg" autobands="1" title="Справка о задолженности за период" nogrid="1" use-repository="1" save-compiled="1" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="36703-per.xlsx" title="Справка о задолженности за период" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="36703-abon" as="abon" title="Абонент">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
          <query name="36703-dog" as="dog" title="Договор">
            <withparams>
              <useparam name="dat1" />
              <useparam name="dat" />
              <useparam name="kodp" />
              <useparam name="kod_dog" />
              <useparam name="p_cat_rep" />
            </withparams>
            <call function="=">
              <column table="abon" column="kodp" />
              <column table="dog" column="kodp" />
            </call>
            <query name="36703-fin-per-oth" as="fin" title="Задолженность">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="fin" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-fin-per2" as="finp" title="Задолженность">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="finp" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-avans-info" as="av_info" title="Аванс по договору">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="av_info" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-dog-lim" as="lim" title="Лимит">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="lim" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-obj" title="Объекты" as="obj">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="obj" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-isk" as="isk" title="Юридическая работа">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="isk" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-uved" as="uved" title="Ограничение">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="uved" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-teh" as="teh" title="Техническая информация">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="teh" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="q36703_32_grouped_pret" as="pret" title="Отправленные претензии">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="pret" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
            <query name="36703-graf_d" as="graf" title="ГПЗ">
              <withparams>
                <useparam name="dat1" />
                <useparam name="dat" />
                <useparam name="kodp" />
                <useparam name="kod_dog" />
                <useparam name="p_cat_rep" />
              </withparams>
              <call function="=">
                <column table="graf" column="kod_dog" />
                <column table="dog" column="kod_dog" />
              </call>
            </query>
          </query>
        </query>
        <query name="36703-info" as="info" title="Доп. информация">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="36703-test" form="36703" timestamp="23.11.2018 18:41:54" folder="dolg" autobands="1" title="Справка о задолженности на дату" nogrid="1" use-repository="1" use-temp="1" visible="0" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <params>
        <param name="dat1" type="date">
          <const>to_date('01.01.2015','DD.MM.YYYY')</const>
        </param>
        <param name="dat" type="date">
          <const>to_date('28.03.2019','DD.MM.YYYY')</const>
        </param>
        <param name="kodp" type="array" />
        <param name="kod_dog" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="36703-dat.xml" title="Справка о задолженности на дату" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="36703-dog" as="dog" title="Договор">
          <withparams>
            <useparam name="dat1" />
            <useparam name="dat" />
            <useparam name="kodp" />
            <useparam name="kod_dog" />
            <useparam name="p_cat_rep" />
          </withparams>
          <query name="36703-fin-dat" as="fin" title="Задолженность">
            <withparams>
              <useparam name="dat1" />
              <useparam name="dat" />
              <useparam name="kodp" />
              <useparam name="kod_dog" />
              <useparam name="p_cat_rep" />
            </withparams>
            <call function="=">
              <column table="fin" column="kod_dog" />
              <column table="dog" column="kod_dog" />
            </call>
          </query>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="36703" timestamp="14.05.2024 23:40:48" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <content>
        <field controlType="UIDate" type="date" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" name="dat" title="Дата" column-mandatory="1" visible="1">
          <defaultquery>
            <query name="today" />
          </defaultquery>
        </field>
        <field name="kodp" controlType="UIList" title="Абонент" type="number" rows-limit="100" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" valid="vld" search-field-name="inn" visible="1">
          <listquery>
            <query name="kr_payer_list" />
          </listquery>
        </field>
        <field controlType="UIList" title="Договор" name="kod_dog" type="number" rows-limit="100" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" valid="vld" visible="1">
          <defaultquery>
            <query name="36703-dog-def" />
          </defaultquery>
          <listquery>
            <query name="kr_dogovor_list_active" />
          </listquery>
        </field>
        <field controlType="UIText" type="string" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" title="Валидация" name="vld" visible="0">
          <defaultquery>
            <query name="36703-validation-def" />
          </defaultquery>
        </field>
        <field name="p_cat_rep" type="string" visible="0" controlType="UIText" title="Категория отчета">
          <defaultquery>
            <query name="category_report_num_2" />
          </defaultquery>
        </field>
      </content>
    </form>
    <form name="36703-per" timestamp="15.05.2024 11:08:21" file="sql.builder.templates\sql.builder\projects\36703\reports\all36703.xml">
      <content>
        <field controlType="UIDate" type="date" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" name="dat1" title="С даты" column-mandatory="1" visible="1">
          <defaultquery>
            <query name="36703-dat1-def" />
          </defaultquery>
        </field>
        <field controlType="UIDate" type="date" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" name="dat" title="По дату" column-mandatory="1" visible="1">
          <defaultquery>
            <query name="today" />
          </defaultquery>
        </field>
        <field name="kodp" controlType="UIList" title="Абонент" type="number" rows-limit="100" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" valid="vld" search-field-name="inn" visible="1">
          <listquery>
            <query name="kr_payer_list" />
          </listquery>
        </field>
        <field controlType="UIList" title="Договор" name="kod_dog" type="number" rows-limit="100" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" valid="vld" visible="1">
          <defaultquery>
            <query name="36703-dog-def" />
          </defaultquery>
          <listquery>
            <query name="kr_dogovor_list_active" />
          </listquery>
        </field>
        <field controlType="UIText" type="string" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" title="Вылидация" name="vld" column-visible="0" visible="1">
          <defaultquery>
            <query name="36703-validation-def" />
          </defaultquery>
        </field>
        <field name="p_cat_rep" type="string" visible="0" controlType="UIText" title="Категория отчета">
          <defaultquery>
            <query name="category_report_num_3" />
          </defaultquery>
        </field>
      </content>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>