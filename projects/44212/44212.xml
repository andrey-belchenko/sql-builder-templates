<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:21:32.1029231+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="44212-1" timestamp="17.12.2019 19:04:02" order="dt" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in" part-id="44212-expr">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_peni_sud" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>-44</const>
            <const>44</const>
          </call>
        </call>
        <call as="is_peni_other" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>-48</const>
            <const>48</const>
            <const>47</const>
          </call>
        </call>
        <call as="is_zach" function="contains" part-id="44212-expr">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=" part-id="44212-expr">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=" part-id="44212-expr">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null" part-id="44212-expr">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act" part-id="44212-expr">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act" part-id="44212-expr">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act" part-id="44212-expr">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach" part-id="44212-expr">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr" part-id="44212-expr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis" part-id="44212-expr">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb" part-id="44212-expr">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc" part-id="44212-expr">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc" part-id="44212-expr">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc" part-id="44212-expr">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
        <call group="sum" function="()" type="number" as="nach_peni_sud">
          <fact column="sr_facras_nachisl" condition="is_peni_sud" />
        </call>
        <call group="sum" function="()" type="number" as="nach_peni_other">
          <fact column="sr_facras_nachisl" condition="is_peni_other" />
        </call>
        <call group="sum" function="()" type="number" as="opl_peni_sud">
          <fact column="sr_facopl_opl" condition="is_peni_sud" />
        </call>
        <call group="sum" function="()" type="number" as="opl_peni_other">
          <fact column="sr_facopl_opl" condition="is_peni_other" />
        </call>
      </expressions>
      <select>
        <column table="ym" column="val" as="ym" agg="" />
        <column table="kod_dog" column="kod_dog" agg="" as="kod_dog" />
        <call function="ym begin time" as="dt" agg="">
          <column table="this" column="ym" />
        </call>
        <fact column="q44212_av_nach_av" as="nach_av" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_10" as="nach_av_10" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_10_w_day" as="nach_av_10_w_day" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_25" as="nach_av_25" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_25_w_day" as="nach_av_25_w_day" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="fin_ul_nachisl_osn" as="nach" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="nach_act" agg="" part-id="44212-cols1" nvl="0" as="nach_act" is-fact-use="1" />
        <call function="0-" as="opl_stor" agg="" part-id="44212-cols1" nvl="0">
          <fact column="sr_opl_opl_stor" />
        </call>
        <fact column="sr_opl_opl_kred" as="opl_kred" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="opl" as="opl" agg="" part-id="44212-cols1" nvl="0" is-fact-use="1" />
        <fact column="opl_act" agg="" part-id="44212-cols1" nvl="0" as="opl_act" is-fact-use="1" />
        <fact column="opl_zach" agg="" part-id="44212-cols1" nvl="0" as="opl_zach" is-fact-use="1" />
        <fact column="opl_vozvr" agg="" part-id="44212-cols1" nvl="0" as="opl_vozvr" is-fact-use="1" />
        <fact column="opl_spis" agg="" part-id="44212-cols1" nvl="0" as="opl_spis" is-fact-use="1" />
        <fact column="fin_ul_ob_all" as="ob_all" agg="" nvl="0" is-fact-use="1" />
        <fact column="fin_ul_ob_kr_os_av" as="ob_kr" agg="" nvl="0" is-fact-use="1" />
        <fact column="ob_deb" as="ob_deb" agg="" nvl="0" is-fact-use="1" />
        <fact column="ob_act" agg="" nvl="0" as="ob_act" is-fact-use="1" />
        <fact column="fin_ul_ob_gp" as="ob_gp" agg="" nvl="0" is-fact-use="1" />
        <fact column="fin_ul_ob_peni" as="ob_peni" agg="" nvl="0" is-fact-use="1" />
        <call function="over" as="sld_all" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_all" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_kr" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_kr" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_deb" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_act" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_act" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_gp" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_gp" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_peni" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_peni" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <fact column="q44212_dog_ym_ft" as="q44212_dog_ym_ft" is-fact-use="1" />
        <call function="-nvl" title="Перерасчеты - сумма" as="total_recalc">
          <fact column="nach_recalc" />
          <fact column="opl_recalc" />
        </call>
        <call function="vg_period.ym_enum_str_to_ym_ranges_str" as="rym_recalc">
          <call function="replace">
            <fact column="rym_recalc" />
            <const table="this" column="rym_recalc" type="string">';'</const>
            <const table="this" column="rym_recalc">','</const>
          </call>
        </call>
        <fact column="fin_ul_opl_gp" as="opl_gp" nvl="0" is-fact-use="1" />
        <fact column="fin_ul_nachisl_gp" as="nach_gp" nvl="0" is-fact-use="1" />
        <fact column="opl_peni_sud" nvl="0" as="opl_peni_sud" is-fact-use="1" />
        <fact column="nach_peni_sud" nvl="0" as="nach_peni_sud" is-fact-use="1" />
        <fact column="opl_peni_other" nvl="0" as="opl_peni_other" is-fact-use="1" />
        <fact column="nach_peni_other" nvl="0" as="nach_peni_other" is-fact-use="1" />
        <call function="-nvl" as="ob_peni_sud" title="Оборот по счетам на пени">
          <fact column="nach_peni_sud" />
          <fact column="opl_peni_sud" />
        </call>
        <call function="-nvl" title="Оборот по счетам на пени" as="ob_peni_other">
          <fact column="nach_peni_other" />
          <fact column="opl_peni_other" />
        </call>
        <call function="over" as="sld_peni_sud" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_peni_sud" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld_peni_other" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_peni_other" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="ym" as="ym" />
          <link name="kod_dog_fin" as="kod_dog" />
          <link name="dat" />
          <link name="vid_recalc" />
          <where>
            <call function="=">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="p_kod_dog" />
            </call>
            <call function="le" dont-push="1">
              <column table="dat" column="val" />
              <useparam name="p_dat" />
            </call>
          </where>
        </qube>
      </from>
      <order>
        <column column="dt" />
      </order>
    </query>
    <query name="q44212_av" timestamp="17.12.2019 19:02:00" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <select>
        <column table="kod_dog" column="kod_dog" is-private-dimension="kod_dog_fin" dimension="kod_dog_fin" is-final-dimension="kod_dog_fin" as="kod_dog" />
        <column table="ym" column="val" as="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
        <column table="dat" column="val" as="dat" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" />
        <fact column="fin_ul_nachisl_av" as="nach_av" is-fact="1" agg="sum" is-fact-use="1" fact="q44212_av_nach_av" />
        <fact column="fin_ul_nachisl_av_10" as="nach_av_10" is-fact="1" agg="sum" is-fact-use="1" fact="q44212_av_nach_av_10" />
        <fact column="fin_ul_nachisl_av_10_w_day" as="nach_av_10_w_day" is-fact="1" agg="sum" is-fact-use="1" fact="q44212_av_nach_av_10_w_day" />
        <fact column="fin_ul_nachisl_av_25" as="nach_av_25" is-fact="1" agg="sum" is-fact-use="1" fact="q44212_av_nach_av_25" />
        <fact column="fin_ul_nachisl_av_25_w_day" as="nach_av_25_w_day" is-fact="1" agg="sum" is-fact-use="1" fact="q44212_av_nach_av_25_w_day" />
      </select>
      <from>
        <qube>
          <link name="ym_vozn" as="ym" />
          <link name="kod_dog_fin" as="kod_dog" />
          <link name="dat" />
        </qube>
      </from>
    </query>
    <query name="44212-2" timestamp="22.11.2018 14:39:06" order="dt" use-repository="1" materialize="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="*" as="*" key="0" />
        <call function="over" as="sld0_all" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_all" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_kr" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_kr" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_deb" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_act" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_act" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_gp" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_gp" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_peni" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_peni" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_peni_sud" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_peni_sud" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="over" as="sld0_peni_other" type="number" agg="" key="0">
          <call function="last_value">
            <column table="this" column="sld_peni_other" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
          <call function="order by rows * -1">
            <column table="this" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <query name="44212-1" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <order>
        <column column="dt" />
      </order>
    </query>
    <query name="44212-d" timestamp="12.01.2018 19:05:29" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_zach" function="contains">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog" column="kod_dog" agg="" as="kod_dog" />
        <column table="dep" column="name" agg="" as="name" />
        <column table="kod_dog" column="ndog" agg="" as="ndog" />
        <fact column="q44212_av_nach_av" as="nach_av" agg="" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_10" as="nach_av_10" agg="" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_10_w_day" as="nach_av_10_w_day" agg="" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_25" as="nach_av_25" agg="" nvl="0" is-fact-use="1" />
        <fact column="q44212_av_nach_av_25_w_day" as="nach_av_25_w_day" agg="" nvl="0" is-fact-use="1" />
        <fact column="fin_ul_nachisl_osn" as="nach" agg="" nvl="0" is-fact-use="1" />
        <fact column="nach_act" agg="" nvl="0" as="nach_act" is-fact-use="1" />
        <call function="0-" as="opl_stor" agg="" nvl="0">
          <fact column="sr_opl_opl_stor" />
        </call>
        <fact column="sr_opl_opl_kred" as="opl_kred" agg="" nvl="0" is-fact-use="1" />
        <fact column="opl" as="opl" agg="" nvl="0" is-fact-use="1" />
        <fact column="opl_act" agg="" nvl="0" as="opl_act" is-fact-use="1" />
        <fact column="opl_zach" agg="" nvl="0" as="opl_zach" is-fact-use="1" />
        <fact column="opl_vozvr" agg="" nvl="0" as="opl_vozvr" is-fact-use="1" />
        <fact column="opl_spis" agg="" nvl="0" as="opl_spis" is-fact-use="1" />
      </select>
      <from>
        <qube>
          <link name="ym" as="ym" />
          <link name="kod_dog">
            <link name="dep" />
          </link>
          <where>
            <call function="between">
              <column table="ym" column="val" />
              <useparam name="p_ym1" />
              <useparam name="p_ym2" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="44212-3" timestamp="17.07.2018 19:36:01" order="dt" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="*" as="*" key="0" />
        <column table="b" column="ym_vozn" as="ym_vozn" key="0" />
      </select>
      <from>
        <query name="44212-2" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
        <query name="44212-p1" as="b" join="left outer" dname="44212-3">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
          <call function="=">
            <column table="a" column="ym" />
            <column table="b" column="ym" />
          </call>
        </query>
      </from>
      <where>
        <call function="between">
          <column table="a" column="ym" />
          <useparam name="p_ym1" />
          <useparam name="p_ym2" />
        </call>
      </where>
      <order>
        <column column="dt" />
      </order>
    </query>
    <query name="44212-p_old" timestamp="21.02.2019 18:23:00" use-repository="1" comment="старый неправильный вариант" title="старый неправильный вариант" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_zach" function="contains">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog" column="kod_dog" agg="" as="kod_dog" />
        <column table="ym" column="val" as="ym" agg="" />
        <column table="ym_vozn" column="val" as="ym_vozn" agg="" />
        <fact column="ob_deb" as="ob_deb" agg="" nvl="0" is-fact-use="1" />
        <call function="over" as="sld_deb" type="number" agg="">
          <call function="sum">
            <column table="this" column="ob_deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
            <column table="this" column="ym_vozn" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="ym" as="ym" />
          <link name="ym_vozn" />
          <link name="dat" />
          <link name="kod_dog" as="d">
            <link name="kod_dog_fin" as="kod_dog" />
          </link>
          <where>
            <call function="=">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="p_kod_dog" />
            </call>
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="p_dat" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="44212-p1_old" timestamp="21.02.2019 18:23:00" use-repository="1" comment="старый неправильный вариант" title="старый неправильный вариант" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="ym" group="1" as="ym" key="1" fixed="1" />
        <call function="vg_period.ym_enum_str_to_ym_ranges_str" as="ym_vozn" key="0">
          <column table="a" column="ym_vozn" group="stragg" />
        </call>
      </select>
      <from>
        <query name="44212-p" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=0">
          <column table="a" column="sld_deb" />
        </call>
      </where>
    </query>
    <query name="44212-4" timestamp="13.01.2018 02:31:55" order="dt" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="*" as="*" key="0" />
      </select>
      <from>
        <query name="44212-2" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="ym" />
          <call function="ym add month">
            <useparam name="p_ym1" />
            <const>-1</const>
          </call>
        </call>
      </where>
      <order>
        <column column="dt" />
      </order>
    </query>
    <query name="44212-dog" timestamp="31.03.2019 16:28:44" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="kod_dog" column="kod_dog" as="kod_dog" />
        <call function="date to char" as="d1">
          <call function="ym begin time">
            <useparam name="p_ym1" />
          </call>
        </call>
        <call function="date to char" as="d2">
          <useparam name="p_dat" />
        </call>
        <column table="kodp" column="name" as="namep" />
        <column table="kod_dog" column="name" as="named" />
        <column table="kodp" column="inn" as="inn" />
        <call function="nvl" type="string" as="avans_info">
          <column table="kod_dog" column="avans_info" />
          <const>'-'</const>
        </call>
        <column table="kod_dog" column="postplat_info" as="postplat_info" />
        <call function="substr" as="name_dep">
          <column table="kod_dep" column="name" />
          <const>29</const>
        </call>
        <column table="kodp_uch" column="name" as="name_uch" />
      </select>
      <from>
        <qube>
          <link name="kod_dog_fin" all-rows="1" as="kod_dog">
            <link name="kod_bzad" />
            <link name="kodp" />
            <link name="kod_dep" />
            <link name="kodp_uch" />
          </link>
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="p_kod_dog" />
              </call>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="44212-dat-val" timestamp="13.01.2018 03:20:38" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_ym2" type="number">
          <const>2017.12</const>
        </param>
      </params>
      <select>
        <call function="earliest" as="val" key="0">
          <call function="ym end day">
            <useparam name="p_ym2" />
          </call>
          <call function="sysdate" />
        </call>
      </select>
      <from>
        <query name="dual" as="dual" />
      </from>
    </query>
    <query name="44212-ym2-val" timestamp="13.01.2018 03:31:45" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_dat" type="date" />
      </params>
      <select>
        <call function="date to ym" as="val" key="0">
          <call function="nvlu">
            <useparam name="p_dat" />
            <call function="sysdate" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" as="dual" />
      </from>
    </query>
    <query name="44212-dolg" timestamp="29.10.2018 21:31:54" use-repository="1" materialize="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="kod_sf" column="kod_sf" as="kod_sf" />
        <call function="||" as="name">
          <call function="if">
            <call function="=0">
              <column table="kod_sf" column="vid_real" />
            </call>
            <call function="||">
              <const>'аванс '</const>
              <column table="kod_sf" column="perc" />
              <const>'% '</const>
            </call>
            <const>'окончательная оплата '</const>
          </call>
          <const>'за '</const>
          <call function="lower">
            <call function="mes-name">
              <call function="mes">
                <column table="kod_sf" column="rym" />
              </call>
            </call>
          </call>
          <const>' '</const>
          <call function="trunc">
            <column table="kod_sf" column="rym" />
          </call>
          <const>' года'</const>
          <call function="||">
            <const>' (срок оплаты до '</const>
            <call function="date to char">
              <column table="kod_sf" column="dat_bzad" />
            </call>
            <const>') '</const>
          </call>
        </call>
        <column table="kod_sf" column="kod_dog" as="kod_dog" />
        <column table="kod_sf" column="dat_bzad" as="dat_bzad" />
        <call function="if" type="number" as="sld">
          <call function="or">
            <call function="!=0">
              <column table="kod_sf" column="vid_real" />
            </call>
            <call function="is null">
              <column table="kod_sf" column="dat_ezad" />
            </call>
          </call>
          <fact column="fin_ul_ob" as="sld" />
        </call>
        <call function="if" as="dolg" type="number">
          <call function="lt">
            <column table="kod_sf" column="dat_bzad" />
            <useparam name="p_dat" />
          </call>
          <fact column="fin_ul_ob" as="sld" />
        </call>
        <call as="sld_all" function="over" type="number">
          <call function="sum">
            <column table="this" column="sld" />
          </call>
          <call function="partition by">
            <column table="kod_sf" column="kod_dog" />
          </call>
        </call>
        <call function="/nvl" as="dolg_perc">
          <column table="this" column="dolg" />
          <column table="this" column="sld_all" />
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog" as="d">
            <link name="kod_dog_fin" as="kod_dog">
              <link name="dep" />
            </link>
          </link>
          <link name="kod_sf" />
          <link name="dat" />
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="p_kod_dog" />
              </call>
            </call>
            <call function="or">
              <call function="lt">
                <column table="kod_sf" column="dat_bzad" />
                <useparam name="p_dat" />
              </call>
              <call function="=">
                <column table="kod_sf" column="vid_real" />
                <const>2</const>
              </call>
            </call>
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="p_dat" />
            </call>
            <call function="gt">
              <call function="nvl">
                <column table="kod_sf" column="dat_ezad" />
                <call function="doomsday" />
              </call>
              <useparam name="p_dat" />
            </call>
            <call function="in">
              <column table="kod_sf" column="vid_real" />
              <call function="array">
                <const>2</const>
                <const>0</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="!=0">
          <column table="this" column="sld" />
          <column table="this" column="dolg" />
        </call>
      </where>
    </query>
    <query name="44212-dolg-i" timestamp="13.01.2018 19:07:48" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <call function="date to char" as="dat" group="max" key="0">
          <useparam name="p_dat" />
        </call>
        <column table="a" column="sld" group="sum" as="sld" key="0" />
        <column table="a" column="dolg" group="sum" as="dolg" key="0" />
      </select>
      <from>
        <query name="44212-dolg" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44212-dolg-d" timestamp="13.01.2018 19:12:29" use-repository="1" order="dat_bzad" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="name" group="1" as="name" key="1" fixed="1" />
        <column table="a" column="dat_bzad" group="max" as="dat_bzad" key="0" />
        <column table="a" column="dolg" group="sum" as="dolg" key="0" />
        <column table="a" column="dolg_perc" group="sum" as="dolg_perc" key="0" />
      </select>
      <from>
        <query name="44212-dolg" as="a">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=0">
          <column table="a" column="dolg" />
        </call>
      </where>
      <order>
        <column column="dat_bzad" />
      </order>
    </query>
    <query name="q44212_dog_ym" timestamp="30.10.2018 17:00:31" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <select>
        <column table="kod_dog" column="kod_dog" agg="" is-private-dimension="kod_dog_fin" dimension="kod_dog_fin" is-final-dimension="kod_dog_fin" as="kod_dog" key="0" />
        <column table="ym" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" as="ym" reference="spr_time_ym" refcol="ym" key="1" />
        <call function="ym begin time" as="dat" is-private-dimension="dat" is-final-dimension="dat" dimension="dat" key="0">
          <column table="this" column="ym" />
        </call>
        <call type="number" function="()" as="ft" is-fact="1" agg="sum" fact="q44212_dog_ym_ft" key="0">
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog_fin" all-rows="1" as="kod_dog">
            <link name="dep" />
          </link>
        </qube>
        <query name="spr_time_ym" as="ym" join="left outer" dname="q44212_dog_ym">
          <call function="between">
            <column table="ym" column="ym" />
            <const>2010.01</const>
            <call function="date to ym">
              <call function="date add days">
                <call function="sysdate" />
                <const>300</const>
              </call>
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="44212-p-test" timestamp="21.02.2019 18:23:16" use-repository="1" comment="Близкий к правильному, но сложный вариант. Ломается при отрицательных начислениях и оплатах." title="см. комментарий" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_zach" function="contains">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog" column="kod_dog" agg="" as="kod_dog" />
        <column table="ym" column="val" as="ym" agg="" />
        <column table="ym_vozn" column="val" as="ym_vozn" agg="" />
        <fact column="fin_ul_nachisl_osn" as="nach" is-fact-use="1" />
        <fact column="fin_ul_opl_sf_osn" as="opl" is-fact-use="1" />
      </select>
      <from>
        <qube>
          <link name="ym" as="ym" />
          <link name="ym_vozn" />
          <link name="dat" />
          <link name="kod_dog" as="d">
            <link name="kod_dog_fin" as="kod_dog" />
          </link>
          <link name="kod_sf" />
          <where>
            <call function="=">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="p_kod_dog" />
            </call>
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="p_dat" />
            </call>
            <call function="=">
              <column table="kod_sf" column="vid_real" />
              <const>2</const>
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="44212-p1_test" timestamp="21.02.2019 18:45:29" use-repository="1" comment="Близкий к правильному, но сложный вариант. Ломается при отрицательных начислениях и оплатах." title="см. комментарий" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="spr_time_ym" column="ym" group="1" as="ym" key="1" fixed="1" />
        <column table="a" column="ym_vozn" group="1" as="ym_vozn" key="1" fixed="1" />
        <call function="over" as="opl_over" group="max" key="0">
          <call function="sum">
            <call function="if" as="opl">
              <call function="=">
                <column table="a" column="ym" />
                <column table="spr_time_ym" column="ym" />
              </call>
              <column table="a" column="opl" is-fact-use="1" />
            </call>
          </call>
          <call function="partition by">
            <column table="a" column="kod_dog" />
            <column table="a" column="ym_vozn" />
          </call>
          <call function="order by rows * 0">
            <column table="spr_time_ym" column="ym" />
          </call>
        </call>
        <call function="over" as="nach_over" group="max" key="0">
          <call function="sum">
            <call function="if" as="nach">
              <call function="=">
                <column table="a" column="ym" />
                <column table="spr_time_ym" column="ym" />
              </call>
              <column table="a" column="nach" is-fact-use="1" />
            </call>
          </call>
          <call function="partition by">
            <column table="a" column="kod_dog" />
            <column table="a" column="ym_vozn" />
          </call>
          <call function="order by range * 0">
            <column table="spr_time_ym" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <query name="spr_time_ym" as="spr_time_ym" />
        <query name="44212-p-test" as="a" join="cross" title="см. комментарий">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="44212-p2_test" timestamp="21.02.2019 18:23:16" use-repository="1" comment="Близкий к правильному, но сложный вариант. Ломается при отрицательных начислениях и оплатах." title="см. комментарий" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="ym" group="1" as="ym" key="1" fixed="1" />
        <call function="vg_period.ym_enum_str_to_ym_ranges_str" as="ym_vozn" key="0">
          <column table="a" column="ym_vozn" group="stragg" />
        </call>
      </select>
      <from>
        <query name="44212-p1_test" as="a" title="см. комментарий">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=0">
          <call function="-nvl">
            <column table="a" column="nach_over" />
            <column table="a" column="opl_over" />
          </call>
        </call>
      </where>
    </query>
    <query name="44212-p" timestamp="28.02.2019 18:43:06" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_zach" function="contains">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
      </expressions>
      <select>
        <column table="b" column="kod_dog" agg="" as="kod_dog" key="1" fixed="1" />
        <column table="b" column="ym" as="ym" agg="" reference="44212-p-pre" refcol="ym" key="1" fixed="1" />
        <column table="b" column="ym_vozn" as="ym_vozn" reference="44212-p-pre" refcol="ym" key="1" fixed="1" />
        <fact column="ob_deb" as="ob_deb" agg="" nvl="0" is-fact-use="1" key="0" />
        <call function="over" as="sld_deb" type="number" agg="" key="0">
          <call function="sum">
            <column table="this" column="ob_deb" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
            <column table="this" column="ym_vozn" />
          </call>
          <call function="order by rows * 0">
            <column table="this" column="ym" />
          </call>
        </call>
      </select>
      <from>
        <qube>
          <link name="ym" as="ym" />
          <link name="ym_vozn" />
          <link name="dat" />
          <link name="kod_dog" as="d">
            <link name="kod_dog_fin" as="kod_dog" />
          </link>
          <where>
            <call function="=">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="p_kod_dog" />
            </call>
            <call function="le">
              <column table="dat" column="val" />
              <useparam name="p_dat" />
            </call>
          </where>
        </qube>
        <query name="44212-p-pre" as="b" join="right outer" dname="44212-p">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="ym" column="val" />
              <column table="b" column="ym" />
            </call>
            <call function="=" as="" type="">
              <column table="ym_vozn" column="val" />
              <column table="b" column="ym_vozn" />
            </call>
            <call function="=" as="" type="">
              <column table="kod_dog" column="kod_dog" />
              <column table="b" column="kod_dog" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="44212-p-pre" timestamp="21.02.2019 18:59:44" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <expressions>
        <call as="is_vn_act" function="in">
          <column table="vid_t" column="vid_t" />
          <call function="array">
            <const>73</const>
            <const>65</const>
          </call>
        </call>
        <call as="is_zach" function="contains">
          <column table="kodbpol" column="rs" />
          <const>'зачет'</const>
        </call>
        <call as="is_vozvr" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>2</const>
        </call>
        <call as="is_spis" function="=">
          <column table="vid_recalc" column="vid_recalc" />
          <const>-1</const>
        </call>
        <call as="is_recal" function="is not null">
          <column table="vid_recalc" column="vid_recalc" />
        </call>
        <call function="()" type="number" group="sum" as="nach_act">
          <fact column="sr_facras_nachisl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_act">
          <fact column="sr_facopl_opl" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="ob_act">
          <fact column="fin_ul_ob_fac" condition="is_vn_act" />
        </call>
        <call function="()" type="number" group="sum" as="opl_zach">
          <fact column="sr_opl_opl_bnk" condition="is_zach" />
        </call>
        <call function="()" type="number" group="sum" as="opl_vozvr">
          <fact column="opl" condition="is_vozvr" />
        </call>
        <call function="()" type="number" group="sum" as="opl_spis">
          <fact column="opl" condition="is_spis" />
        </call>
        <call function="()" type="number" group="sum" as="ob_deb">
          <fact column="fin_ul_ob_osn" />
        </call>
        <call function="()" type="number" group="sum" as="opl_recalc">
          <fact column="opl" condition="is_recal" title="Перерасчеты - оплата" />
        </call>
        <call function="()" type="number" group="sum" as="nach_recalc">
          <fact column="sr_facras_nachisl" condition="is_recal" title="Перерасчеты - начисления" />
        </call>
        <call function="()" type="string" group="list" as="rym_recalc">
          <fact column="sr_facras_rym" condition="is_recal" title="Перерасчеты - периоды" />
        </call>
      </expressions>
      <select>
        <column table="kod_dog_fin" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <column table="ym_vozn" column="val" as="ym_vozn" agg="" group="1" key="1" fixed="1" />
        <column table="b" column="ym" group="1" as="ym" key="1" fixed="1" />
      </select>
      <from>
        <qube>
          <link name="kod_sf" all-rows="1">
            <link name="kod_dog">
              <link name="kod_dog_fin" as="kod_dog_fin" />
            </link>
          </link>
          <link name="ym_vozn" />
          <where>
            <call function="=">
              <column table="kod_dog" column="kod_dog" />
              <useparam name="p_kod_dog" />
            </call>
          </where>
        </qube>
        <query name="spr_time_ym" as="b" join="cross" />
      </from>
    </query>
    <query name="44212-p1" timestamp="21.02.2019 18:14:55" use-repository="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml" haskeys="1">
      <params>
        <param name="p_kod_dog" type="number">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <select>
        <column table="a" column="ym" group="1" as="ym" key="1" fixed="1" />
        <call function="vg_period.ym_enum_str_to_ym_ranges_str" as="ym_vozn" key="0">
          <column table="a" column="ym_vozn" group="stragg" />
        </call>
      </select>
      <from>
        <query as="a" name="44212-p">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=0">
          <column table="a" column="sld_deb" />
        </call>
      </where>
    </query>
    <query name="form:44212" haskeys="1">
      <select>
        <column table="u" column="title" title="Параметр" as="title" />
        <column table="u" column="name" key="1" as="name" />
        <column table="u" column="text" title="Значение" as="text" />
      </select>
      <from>
        <query as="u">
          <union>
            <query>
              <select>
                <const type="string" as="title">'Договор'</const>
                <const type="string" as="name">'p_kod_dog'</const>
                <const type="string" as="text">NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'C'</const>
                <const>'p_ym1'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'По'</const>
                <const>'p_ym2'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
            <query>
              <select>
                <const>'На дату'</const>
                <const>'p_dat'</const>
                <const>NULL</const>
              </select>
              <from>
                <table name="dual" />
              </from>
            </query>
          </union>
        </query>
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id" />
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="44212" timestamp="28.02.2019 18:42:05" use-repository="1" use-temp="1" form="44212" title="Справка о задолженности за электрическую энергию за период" nogrid="1" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <print-templates>
        <excel>
          <template name="44212.xlsx" title="Справка о задолженности за электрическую энергию за период" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <params>
        <param name="p_kod_dog" type="number" part-id="44212-pars">
          <const>36581111</const>
        </param>
        <param name="p_ym1" type="number" part-id="44212-pars">
          <const>2018.01</const>
        </param>
        <param name="p_ym2" type="number" part-id="44212-pars">
          <const>2019.02</const>
        </param>
        <param name="p_dat" type="date" part-id="44212-pars">
          <const>to_date('28.02.2019','DD.MM.YYYY')</const>
        </param>
      </params>
      <queries>
        <query name="44212-3" as="a">
          <withparams>
            <useparam name="p_kod_dog" part-id="44212-withpars" />
            <useparam name="p_ym1" part-id="44212-withpars" />
            <useparam name="p_ym2" part-id="44212-withpars" />
            <useparam name="p_dat" part-id="44212-withpars" />
          </withparams>
        </query>
        <query name="44212-4" as="b">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
        <query name="44212-dog" as="d">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
        <query name="44212-dolg-d" as="dd">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
        <query name="44212-dolg-i" as="di">
          <withparams>
            <useparam name="p_kod_dog" />
            <useparam name="p_ym1" />
            <useparam name="p_ym2" />
            <useparam name="p_dat" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="44212" timestamp="23.12.2019 19:47:28" file="sql.builder.templates\sql.builder\projects\44212\query\query.xml">
      <content>
        <field controlType="UICombo" title="Договор" name="p_kod_dog" type="number" rows-limit="100" timestamp="30.10.2018 18:09:12" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" column-mandatory="1">
          <listquery>
            <query name="kr_dogovor_list_fin(dep)" />
          </listquery>
        </field>
        <fieldgroup title="Период">
          <field name="p_ym1" controlType="UICombo" type="number" title="C" timestamp="11.09.2017 00:29:33" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" column-mandatory="1">
            <listquery>
              <query name="spr_time_ym" />
            </listquery>
            <defaultquery>
              <query name="spr_time_ym_beg_year" />
            </defaultquery>
          </field>
          <field name="p_ym2" controlType="UICombo" type="number" title="По" timestamp="11.09.2017 00:29:33" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" column-mandatory="1">
            <listquery>
              <query name="spr_time_ym" />
            </listquery>
            <defaultquery>
              <query name="44212-ym2-val" />
            </defaultquery>
          </field>
        </fieldgroup>
        <field controlType="UIDate" type="date" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" title="На дату" name="p_dat" column-mandatory="1">
          <defaultquery>
            <query name="44212-dat-val" />
          </defaultquery>
        </field>
      </content>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>