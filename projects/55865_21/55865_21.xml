<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:24:15.8052047+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="55865_21_pre" timestamp="20.02.2022 02:30:59" materialize="1" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2021.06</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2021.06</const>
        </param>
      </params>
      <select>
        <column table="kod_dog" column="dep" as="dep" />
        <column table="kod_dog" column="kodp" as="kodp" />
        <column table="kod_dog" column="kod_dog" as="kod_dog" />
        <column table="kod_opl_kred" column="kod_type_opl" as="kod_type_opl" />
        <call as="pr_edo" type="number" function="coalesce">
          <call type="" function="if">
            <call function="!=0">
              <fact table="kvit" column="sr_facvip_count" />
            </call>
            <const>null</const>
            <column table="kod_sf_text" column="pr_edo" as="" type="" />
          </call>
          <column table="kod_opl_kred" column="pr_edo" as="" type="" />
        </call>
        <call as="oper_edo" type="string" function="coalesce">
          <call type="" function="if">
            <call function="!=0">
              <fact table="kvit" column="sr_facvip_count" />
            </call>
            <const>null</const>
            <column table="kod_sf_text" column="name_edo_pok" as="" type="" />
          </call>
          <column table="kod_opl_kred" column="name_edo_pok" as="" type="" />
        </call>
        <call function="case" as="kod_report_doc_type" type="string">
          <call function="when">
            <call function="!=0">
              <fact table="kvit" column="sr_facvip_count" />
            </call>
            <const>5</const>
          </call>
          <call function="when">
            <call type="" function="and">
              <call function="is not null">
                <column table="kod_sf" column="kod_sf" />
              </call>
              <call function="=" as="" type="">
                <column table="kod_sf_text" column="kod_doc" />
                <const>22</const>
              </call>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call type="" function="and">
              <call function="is not null">
                <column table="kod_sf" column="kod_sf" />
              </call>
              <call function="=" as="" type="">
                <column table="kod_sf_text" column="kod_doc" />
                <const>11122</const>
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="kod_opl_kred" column="kod_opl" />
            </call>
            <const>3</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="kod_akt_sver" column="kod" />
            </call>
            <const>4</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="kr_pret" column="kod_pret" />
            </call>
            <const>6</const>
          </call>
        </call>
        <call function="+" as="kod_report_doc">
          <column table="this" column="kod_report_doc_type" mp="15" />
          <call function="coalesce">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_opl_kred" column="kod_opl" />
            <column table="kod_akt_sver" column="kod" />
            <column table="kr_pret" column="kod_pret" />
          </call>
        </call>
        <column table="dep" column="sname" as="dep_name" />
        <column table="kod_dog" column="ndog" as="ndog" />
        <column table="kod_dog" column="dat_sign" as="dat_dog" />
        <column table="kodp" column="name" as="abon_name" />
        <call type="string" function="coalesce" as="num_doc">
          <call type="" function="int to char">
            <column table="kod_akt_sver" column="kod" as="" type="" />
          </call>
          <column table="kod_opl_kred" column="nom_sf" />
          <call type="" function="if">
            <call function="!=0">
              <fact table="kvit" column="sr_facvip_count" />
            </call>
            <call type="" function="int to char">
              <column table="kod_deb" column="num_pl" as="" type="" />
            </call>
            <column table="kod_sf" column="nom_sf" as="" type="" />
          </call>
          <column table="kr_pret" column="nom_pret" />
        </call>
        <call as="dat_doc" type="date" function="nvl">
          <column table="kod_sf" column="dat_sf" />
          <column table="dat" column="val" as="" type="" />
        </call>
        <call as="ym" type="number" function="coalesce">
          <column table="kod_akt_sver" column="ym_end" as="" type="" />
          <column table="kod_opl_kred" column="ym" as="" type="" />
        </call>
        <call function="+nvl" as="doc_count">
          <fact column="sr_akt_count" table="akt_sv" />
          <fact table="sf" column="sr_facvip_count" />
          <fact table="av" column="sr_opl_kred_count" />
          <fact table="kvit" column="sr_facvip_count" />
          <fact table="pret" column="kr_pret_cnt" />
        </call>
        <column table="vid_real" column="vid_real" as="kvit_vid_real" comment="чтобы не схлопывались dimset ы" />
      </select>
      <from>
        <qube>
          <link name="kod_dog">
            <link name="dep" />
            <link name="kodp" />
          </link>
          <link name="dat" />
          <where>
            <call function="in" optional="1">
              <column table="kod_dog" column="dep" />
              <useparam name="p_dep" />
            </call>
          </where>
          <dimset as="pret">
            <where>
              <call function="le">
                <call function="date to ym">
                  <column table="kr_pret" column="dat_form" />
                </call>
                <useparam name="p_ym_po" />
              </call>
              <call function="ge">
                <call function="date to ym">
                  <column table="kr_pret" column="dat_form" />
                </call>
                <useparam name="p_ym_s" />
              </call>
            </where>
            <link name="kr_pret" />
          </dimset>
          <dimset as="akt_sv">
            <where>
              <call function="between">
                <column table="kod_akt_sver" column="ym_end" />
                <useparam name="p_ym_s" />
                <useparam name="p_ym_po" />
              </call>
            </where>
            <link name="kod_akt_sver" />
          </dimset>
          <dimset as="sf">
            <link name="kod_sf">
              <link name="kod_sf_text" />
              <link name="kod_deb" />
            </link>
            <where>
              <call function="and">
                <call function="in">
                  <column table="kod_sf_text" column="kod_doc" />
                  <call function="array">
                    <const>22</const>
                    <const>11122</const>
                  </call>
                </call>
                <call function="ge" dont-push="1">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_s" />
                </call>
                <call function="le">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_po" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="av">
            <link name="kod_opl_kred" />
            <where>
              <call function="!=0">
                <column table="kod_opl_kred" column="num_sf" />
              </call>
              <call function="is not null">
                <column table="kod_opl_kred" column="num_sf" />
              </call>
              <call function="and">
                <call function="ge" dont-push="1">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_s" />
                </call>
                <call function="le">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_po" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="kvit">
            <link name="kod_sf">
              <link name="kod_sf_text" />
              <link name="kod_deb" />
            </link>
            <link name="vid_real" />
            <where>
              <call function="=">
                <column table="kod_deb" column="vid_pl" />
                <const>4</const>
              </call>
              <call function="=">
                <column table="vid_real" column="vid_real" />
                <const>2</const>
              </call>
              <call function="or">
                <call function="not in">
                  <column column="kod_doc" table="kod_sf_text" />
                  <call function="array">
                    <const>11122</const>
                  </call>
                </call>
                <call function="=">
                  <column column="ym" table="kod_sf" />
                  <column column="ym" table="kod_deb" />
                </call>
              </call>
              <call function="and">
                <call function="ge" dont-push="1">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_s" />
                </call>
                <call function="le">
                  <call function="date to ym">
                    <column table="dat" column="val" />
                  </call>
                  <useparam name="p_ym_po" />
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
    </query>
    <query name="55865_21_akt_sv_edo" timestamp="25.08.2021 02:26:12" materialize="1" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml" haskeys="1">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2021.06</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2021.06</const>
        </param>
      </params>
      <select>
        <column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <call function="date to ym" as="ym" group="1" key="1" fixed="1">
          <column table="dat" column="val" />
        </call>
        <call as="pr_edo" type="number" function="()" group="max" key="0">
          <const>1</const>
        </call>
      </select>
      <from>
        <qube>
          <link name="kod_dog" />
          <link name="dat" />
          <where>
            <call function="ge">
              <call function="date to ym">
                <column table="dat" column="val" />
              </call>
              <useparam name="p_ym_s" />
            </call>
            <call function="le">
              <call function="date to ym">
                <column table="dat" column="val" />
              </call>
              <useparam name="p_ym_po" />
            </call>
            <call function="in" optional="1">
              <column table="kod_dog" column="dep" />
              <useparam name="p_dep" />
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="is not null">
          <fact column="ks_konvert_doc_count_akt_sv" as="" type="" />
        </call>
      </where>
    </query>
    <query name="55865_21" timestamp="14.05.2023 23:44:23" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2021.06</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2021.06</const>
        </param>
      </params>
      <select>
        <call as="ym" type="number" function="coalesce" key="0">
          <column table="a" column="ym" />
          <call function="date to ym" as="" type="">
            <column table="this" column="dat_doc" />
          </call>
        </call>
        <column table="a" column="dep" as="dep" key="0" />
        <column table="a" column="kodp" as="kodp" key="0" />
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="kod_report_doc_type" as="kod_report_doc_type" key="0" />
        <column table="a" column="kod_report_doc" as="kod_report_doc" key="0" />
        <call type="number" function="decode" as="pr_edo" key="0">
          <column table="a" column="kod_report_doc_type" as="" type="" />
          <const>4</const>
          <call type="" function="coalesce nullif 0">
            <column table="akt_edo" column="pr_edo" as="" type="" />
            <call function="if" as="" type="">
              <call function="is not null">
                <column table="kr_el_inter_contact" column="text" />
              </call>
              <const>1</const>
            </call>
          </call>
          <const>3</const>
          <call type="" function="if">
            <call function="=">
              <column table="a" column="kod_type_opl" />
              <const>1</const>
            </call>
            <call type="" function="nullif">
              <column table="perepl_edo" column="pr_edo" as="" type="" />
              <const>0</const>
            </call>
            <column table="a" column="pr_edo" />
          </call>
          <const>6</const>
          <call function="if" as="" type="">
            <call function="is not null">
              <column table="kr_el_inter_contact" column="text" />
            </call>
            <const>1</const>
          </call>
          <column table="a" column="pr_edo" />
        </call>
        <call type="string" function="decode" as="report_doc_type_name" key="0">
          <column table="a" column="kod_report_doc_type" as="" type="" />
          <const>1</const>
          <const>'УПД '</const>
          <const>2</const>
          <const>'УКД '</const>
          <const>3</const>
          <const>'Счет-фактура на аванс'</const>
          <const>4</const>
          <const>'Акт сверки '</const>
          <const>5</const>
          <const>'Квитанции '</const>
          <const>6</const>
          <const>'Претензия'</const>
        </call>
        <column table="a" column="dep_name" as="dep_name" key="0" />
        <column table="a" column="ndog" as="ndog" key="0" />
        <column table="a" column="dat_dog" as="dat_dog" key="0" />
        <column table="a" column="abon_name" as="abon_name" key="0" />
        <column table="a" column="num_doc" type="string" as="num_doc" key="0" />
        <column table="a" column="dat_doc" type="date" as="dat_doc" key="0" />
        <call as="oper_edo" type="string" function="if" key="0">
          <call function="is not null">
            <column table="this" column="pr_edo" />
          </call>
          <call type="" function="decode" as="">
            <column table="a" column="kod_report_doc_type" as="" type="" />
            <const>4</const>
            <call type="" function="nvl">
              <column table="akt_edo" column="name_edo" as="" type="" />
              <column table="kr_el_inter_contact" column="text" />
            </call>
            <const>5</const>
            <const>null</const>
            <const>3</const>
            <call type="" function="if">
              <call function="=">
                <column table="a" column="kod_type_opl" />
                <const>1</const>
              </call>
              <call type="" function="nvl">
                <column table="perepl_edo" column="name_edo" as="" type="" />
                <column table="kr_el_inter_contact" column="text" />
              </call>
              <column table="a" column="oper_edo" />
            </call>
            <const>6</const>
            <column table="kr_el_inter_contact" column="text" />
            <column table="a" column="oper_edo" />
          </call>
        </call>
        <column table="a" column="doc_count" as="doc_count" key="0" />
        <call as="not_edo_doc_count" type="number" function="if" key="0">
          <call function="and">
            <call function="is null">
              <column table="this" column="pr_edo" as="" type="" />
            </call>
          </call>
          <column table="a" column="doc_count" as="" type="" />
        </call>
        <call as="edo_doc_count" type="number" function="if" key="0">
          <call function="=1">
            <column table="this" column="pr_edo" as="" type="" />
          </call>
          <column table="a" column="doc_count" as="" type="" />
        </call>
      </select>
      <from>
        <query name="55865_21_pre" as="a">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
        </query>
        <query name="55865_21_perepl_edo" as="perepl_edo" join="left outer" dname="55865_21">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
          <call type="" function="and">
            <call function="=">
              <column table="a" column="kod_report_doc_type" as="" type="" />
              <const>3</const>
            </call>
            <call function="=" as="" type="">
              <column table="a" column="kod_dog" />
              <column table="perepl_edo" column="kod_dog" />
            </call>
            <call function="=1" as="" type="">
              <column table="perepl_edo" column="rwn" />
            </call>
            <call function="=" as="" type="">
              <column table="a" column="ym" as="" type="" />
              <column table="perepl_edo" column="ym" />
            </call>
          </call>
        </query>
        <query name="55865_21_perepl_edo" as="akt_edo" join="left outer" dname="55865_21">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
          <call type="" function="and">
            <call function="=">
              <column table="a" column="kod_report_doc_type" as="" type="" />
              <const>4</const>
            </call>
            <call function="=" as="" type="">
              <column table="a" column="kod_dog" />
              <column table="akt_edo" column="kod_dog" />
            </call>
            <call function="=1" as="" type="">
              <column table="akt_edo" column="rwn" />
            </call>
            <call function="=" as="" type="">
              <column table="a" column="ym" as="" type="" />
              <column table="akt_edo" column="ym" />
            </call>
          </call>
        </query>
        <query name="55865_21_kr_inter_contact" join="left outer" as="kr_el_inter_contact" dname="55865_21">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="kr_el_inter_contact" column="kod_dog" />
          </call>
        </query>
      </from>
    </query>
    <query name="55865_21_gr" timestamp="20.02.2022 03:07:57" title="Отчет по количеству документов в АСУСЭ" is-report="1" nogrid="1" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml">
      <params>
        <param name="p_dep" controlType="UIList" title="Отделение" timestamp="13.05.2019 13:13:44" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" />
        <param name="p_ym_s" controlType="UICombo" title="Период с" timestamp="11.09.2017 00:29:33" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" column-mandatory="1" />
        <param name="p_ym_po" controlType="UICombo" title="Период по" timestamp="11.09.2017 00:29:33" file="sql.builder.templates\sql.builder\projects\asuse2_ipr\param_fields_asuse.xml" column-mandatory="1" />
        <param controlType="UIList" file="sql.builder.templates\sql.builder\projects\common\param_fields_common.xml" name="kod_report_doc_type" title="Тип документа" />
      </params>
      <print-templates>
        <excel>
          <template name="55865_21.xlsx" print-proc="2" print-xlsx="1" title="Отчет по количеству документов в АСУСЭ" />
        </excel>
      </print-templates>
      <content>
        <usefield field="asuse_dep" name="p_dep" />
        <usefield field="asuse_ym_othr" name="p_ym_s" title="Период с" column-mandatory="1" />
        <usefield field="asuse_ym_othr" name="p_ym_po" title="Период по" column-mandatory="1" />
        <usefield field="cmn_list" name="kod_report_doc_type" type="number" title="Тип документа">
          <listquery>
            <query name="55865_21_report_doc_type" />
          </listquery>
        </usefield>
      </content>
      <select>
        <column table="a" column="kod_report_doc_type" as="kod_report_doc_type" key="0" />
        <column table="a" column="kod_report_doc" as="kod_report_doc" key="0" />
        <column table="a" column="dep" as="dep" key="0" />
        <column table="a" column="kodp" group="max" as="kodp" key="0" />
        <column table="a" column="kod_dog" group="max" as="kod_dog" key="0" />
        <column table="a" column="report_doc_type_name" group="max" as="report_doc_type_name" key="0" />
        <column table="a" column="dep_name" group="max" as="dep_name" key="0" />
        <column table="a" column="ndog" group="max" as="ndog" key="0" />
        <column table="a" column="dat_dog" group="max" as="dat_dog" key="0" />
        <column table="a" column="abon_name" group="max" as="abon_name" key="0" />
        <column table="a" column="num_doc" group="max" as="num_doc" key="0" />
        <column table="a" column="dat_doc" group="max" as="dat_doc" key="0" />
        <column table="a" column="oper_edo" group="max" as="oper_edo" key="0" />
        <column table="a" column="doc_count" group="sum" as="doc_count" key="0" />
        <column table="a" column="not_edo_doc_count" group="sum" as="not_edo_doc_count" key="0" />
        <column table="a" column="edo_doc_count" group="sum" as="edo_doc_count" key="0" />
      </select>
      <from>
        <query name="55865_21" as="a">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
        </query>
      </from>
      <where>
        <call type="" function="and">
          <call function="true" />
          <call function="in" as="" type="" optional="1">
            <column table="a" column="kod_report_doc_type" />
            <useparam name="kod_report_doc_type" />
          </call>
        </call>
      </where>
      <grouping>
        <grset as="itog">
          <grset as="dep" order="dep_name">
            <group>
              <column table="a" column="dep" />
            </group>
            <grset as="doc_type" order="kod_report_doc_type">
              <group>
                <column table="a" column="kod_report_doc_type" />
              </group>
              <grset as="doc" order="dep,num_doc">
                <group>
                  <column table="a" column="kod_report_doc" />
                </group>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="55865_21_data" timestamp="07.07.2021 18:04:15" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml">
      <params>
        <param name="p_ym_s" type="number">
          <const>2021.06</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2021.06</const>
        </param>
      </params>
      <select>
        <column table="a" column="ym" as="ym" key="0" />
        <column table="a" column="dep" as="dep" key="0" />
        <column table="a" column="kodp" as="kodp" key="0" />
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="kod_report_doc_type" as="kod_report_doc_type" key="0" />
        <column table="a" column="kod_report_doc" as="kod_report_doc" key="0" />
        <column table="a" column="pr_edo" as="pr_edo" key="0" />
        <column table="a" column="report_doc_type_name" as="report_doc_type_name" key="0" />
        <column table="a" column="dep_name" as="dep_name" key="0" />
        <column table="a" column="ndog" as="ndog" key="0" />
        <column table="a" column="dat_dog" as="dat_dog" key="0" />
        <column table="a" column="abon_name" as="abon_name" key="0" />
        <column table="a" column="num_doc" as="num_doc" key="0" />
        <column table="a" column="dat_doc" as="dat_doc" key="0" />
        <column table="a" column="oper_edo" as="oper_edo" key="0" />
        <column table="a" column="doc_count" as="doc_count" key="0" />
        <column table="a" column="not_edo_doc_count" as="not_edo_doc_count" key="0" />
        <column table="a" column="edo_doc_count" as="edo_doc_count" key="0" />
      </select>
      <from>
        <query name="55865_21" as="a">
          <withparams>
            <undefined />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="55865_21_perepl_edo" timestamp="05.10.2021 21:19:35" materialize="1" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml" haskeys="1">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2021.05</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2021.05</const>
        </param>
      </params>
      <select>
        <column table="kod_dog" column="kod_dog" group="1" as="kod_dog" key="1" fixed="1" />
        <column table="kr_calc" column="ym" group="1" as="ym" reference="kr_calc" refcol="podr" key="1" fixed="1" />
        <column table="a" column="ym" group="1" as="sf_ym" reference="kr_calc" refcol="podr" key="1" fixed="1" />
        <call as="pr_edo" type="number" group="max" function="nvl" key="0">
          <column table="kod_sf_text" column="pr_edo" as="" type="" />
          <const>0</const>
        </call>
        <column table="kod_edo_pok" column="name_edo" group="max" as="name_edo" key="0" />
        <call function="row_number" as="rwn" key="0">
          <call function="partition by">
            <column table="this" column="kod_dog" />
            <column table="this" column="ym" />
          </call>
          <call function="order by simple">
            <call type="" function="desc">
              <column table="this" column="sf_ym" as="" type="" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <link name="kod_sf_text" as="kod_sf_text" table="sr_facvip_text" child="sr_facvip" field="kod_sf_text" parent="sr_facvip_text" back="sr_facvip">
            <link name="kod_edo_pok" as="kod_edo_pok" table="kk_edo" child="sr_facvip_text" field="kod_edo_pok" parent="kk_edo" back="sr_facvip_text" />
          </link>
          <link name="kod_dog" as="kod_dog" table="kr_dogovor" child="sr_facvip" field="kod_dog" parent="kr_dogovor" back="sr_facvip" title="Договор" />
        </query>
        <query name="kr_calc" join="left outer" dimension="kod_sf" as="kr_calc" dname="55865_21_perepl_edo">
          <call type="" function="and">
            <call function="=" as="" type="">
              <column table="kod_dog" column="dep" />
              <column table="kr_calc" column="podr" />
            </call>
            <call function="between" as="" type="" comment="проверяем наличие признака в док. нач. за прошлый и тек. месяц">
              <column table="a" column="ym" />
              <call type="" function="ym add month">
                <column table="kr_calc" column="ym" as="" type="" />
                <const>-7</const>
              </call>
              <column table="kr_calc" column="ym" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in" optional="1">
            <column table="kod_dog" column="dep" />
            <useparam name="p_dep" />
          </call>
          <call function="between">
            <column table="kr_calc" column="ym" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </call>
        </call>
      </where>
    </query>
    <query name="55865_21_test" timestamp="14.05.2023 23:29:46" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2023.03</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2023.03</const>
        </param>
      </params>
      <select>
        <call as="ym" type="number" function="coalesce" key="0">
          <column table="a" column="ym" />
          <call function="date to ym" as="" type="">
            <column table="this" column="dat_doc" />
          </call>
        </call>
        <column table="a" column="dep" as="dep" key="0" />
        <column table="a" column="kodp" as="kodp" key="0" />
        <column table="a" column="kod_dog" as="kod_dog" key="0" />
        <column table="a" column="kod_report_doc_type" as="kod_report_doc_type" key="0" />
        <column table="a" column="kod_report_doc" as="kod_report_doc" key="0" />
        <call type="number" function="decode" as="pr_edo" key="0">
          <column table="a" column="kod_report_doc_type" as="" type="" />
          <const>4</const>
          <call type="" function="coalesce nullif 0">
            <column table="akt_edo" column="pr_edo" as="" type="" />
            <call function="if" as="" type="">
              <call function="is not null">
                <column table="kr_el_inter_contact" column="text" />
              </call>
              <const>1</const>
            </call>
          </call>
          <const>3</const>
          <call type="" function="if">
            <call function="=">
              <column table="a" column="kod_type_opl" />
              <const>1</const>
            </call>
            <call type="" function="nullif">
              <column table="perepl_edo" column="pr_edo" as="" type="" />
              <const>0</const>
            </call>
            <column table="a" column="pr_edo" />
          </call>
          <const>6</const>
          <call function="if" as="" type="">
            <call function="is not null">
              <column table="kr_el_inter_contact" column="text" />
            </call>
            <const>1</const>
          </call>
          <column table="a" column="pr_edo" />
        </call>
        <call type="string" function="decode" as="report_doc_type_name" key="0">
          <column table="a" column="kod_report_doc_type" as="" type="" />
          <const>1</const>
          <const>'УПД '</const>
          <const>2</const>
          <const>'УКД '</const>
          <const>3</const>
          <const>'Счет-фактура на аванс'</const>
          <const>4</const>
          <const>'Акт сверки '</const>
          <const>5</const>
          <const>'Квитанции '</const>
          <const>6</const>
          <const>'Претензия'</const>
        </call>
        <column table="a" column="dep_name" as="dep_name" key="0" />
        <column table="a" column="ndog" as="ndog" key="0" />
        <column table="a" column="dat_dog" as="dat_dog" key="0" />
        <column table="a" column="abon_name" as="abon_name" key="0" />
        <column table="a" column="num_doc" type="string" as="num_doc" key="0" />
        <column table="a" column="dat_doc" type="date" as="dat_doc" key="0" />
        <call as="oper_edo" type="string" function="if" key="0">
          <call function="is not null">
            <column table="this" column="pr_edo" />
          </call>
          <call type="" function="decode" as="">
            <column table="a" column="kod_report_doc_type" as="" type="" />
            <const>4</const>
            <call type="" function="nvl">
              <column table="akt_edo" column="name_edo" as="" type="" />
              <column table="kr_el_inter_contact" column="text" />
            </call>
            <const>5</const>
            <const>null</const>
            <const>3</const>
            <call type="" function="if">
              <call function="=">
                <column table="a" column="kod_type_opl" />
                <const>1</const>
              </call>
              <call type="" function="nvl">
                <column table="perepl_edo" column="name_edo" as="" type="" />
                <column table="kr_el_inter_contact" column="text" />
              </call>
              <column table="a" column="oper_edo" />
            </call>
            <const>6</const>
            <column table="kr_el_inter_contact" column="text" />
            <column table="a" column="oper_edo" />
          </call>
        </call>
        <column table="a" column="doc_count" as="doc_count" key="0" />
        <call as="not_edo_doc_count" type="number" function="if" key="0">
          <call function="and">
            <call function="is null">
              <column table="this" column="pr_edo" as="" type="" />
            </call>
          </call>
          <column table="a" column="doc_count" as="" type="" />
        </call>
        <call as="edo_doc_count" type="number" function="if" key="0">
          <call function="=1">
            <column table="this" column="pr_edo" as="" type="" />
          </call>
          <column table="a" column="doc_count" as="" type="" />
        </call>
      </select>
      <from>
        <query name="55865_21_pre" as="a">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
        </query>
        <query name="55865_21_perepl_edo" as="perepl_edo" join="left outer" dname="55865_21_test">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
          <call type="" function="and">
            <call function="=">
              <column table="a" column="kod_report_doc_type" as="" type="" />
              <const>3</const>
            </call>
            <call function="=" as="" type="">
              <column table="a" column="kod_dog" />
              <column table="perepl_edo" column="kod_dog" />
            </call>
            <call function="=1" as="" type="">
              <column table="perepl_edo" column="rwn" />
            </call>
            <call function="=" as="" type="">
              <column table="a" column="ym" as="" type="" />
              <column table="perepl_edo" column="ym" />
            </call>
          </call>
        </query>
        <query name="55865_21_perepl_edo" as="akt_edo" join="left outer" dname="55865_21_test">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
          <call type="" function="and">
            <call function="=">
              <column table="a" column="kod_report_doc_type" as="" type="" />
              <const>4</const>
            </call>
            <call function="=" as="" type="">
              <column table="a" column="kod_dog" />
              <column table="akt_edo" column="kod_dog" />
            </call>
            <call function="=1" as="" type="">
              <column table="akt_edo" column="rwn" />
            </call>
            <call function="=" as="" type="">
              <column table="a" column="ym" as="" type="" />
              <column table="akt_edo" column="ym" />
            </call>
          </call>
        </query>
        <query name="55865_21_kr_inter_contact" join="left outer" as="kr_el_inter_contact" dname="55865_21_test">
          <call function="=">
            <column table="a" column="kod_dog" />
            <column table="kr_el_inter_contact" column="kod_dog" />
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_report_doc" />
          <const>1000000003955084</const>
        </call>
      </where>
    </query>
    <query name="55865_21_kr_inter_contact" materialize="1" timestamp="14.05.2023 23:36:25" file="sql.builder.templates\sql.builder\projects\55865_21\all\55865_21_queries.xml" haskeys="1">
      <params>
        <param name="p_dep" type="array">
          <call function="array">
            <const>102276623</const>
          </call>
        </param>
        <param name="p_ym_s" type="number">
          <const>2023.04</const>
        </param>
        <param name="p_ym_po" type="number">
          <const>2023.04</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_dog" group="1" key="1" as="kod_dog" />
        <column table="a" column="text" group="max" as="text" />
      </select>
      <from>
        <query name="kr_el_inter_contact" as="a">
          <withparams>
            <useparam name="p_dep" />
            <useparam name="p_ym_s" />
            <useparam name="p_ym_po" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_el_inter_type" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="a" column="pr_active" />
            <const>0</const>
          </call>
        </call>
      </where>
    </query>
    <query name="55865_21_report_doc_type" class="1" timestamp="20.02.2022 03:06:39" file="sql.builder.templates\sql.builder\projects\55865_21\scheme\original\v55865_21_report_doc_type.xml" haskeys="1">
      <select>
        <column table="a" column="kod_report_doc_type" type="number" key="1" as="kod_report_doc_type" />
        <column table="a" column="report_doc_type_name" type="string" data-size="21" title="Тип документа" is-name="1" vid="1" as="report_doc_type_name" />
      </select>
      <from>
        <table name="55865_21_report_doc_type" as="a" view="1" />
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id" />
  <views child-name="view" key-name="id">
    <view name="55865_21_report_doc_type" class="1" file="sql.builder.templates\sql.builder\projects\55865_21\scheme\original\v55865_21_report_doc_type.xml">
      select 1 as kod_report_doc_type, 'УПД' as report_doc_type_name from dual
      union all
      select 2 , 'УКД' from dual
      union all
      select 3 , 'Счет-фактура на аванс' from dual
      union all
      select 4 , 'Акт сверки' from dual
      union all
      select 5 ,'Квитанция' from dual
      union all
      select 6 ,'Претензия' from dual
    </view>
  </views>
  <reports child-name="report" key-name="name" />
  <forms child-name="form" key-name="name" />
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>