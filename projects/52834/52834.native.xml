<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:21:33.7905943+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="52834-main" materialize="0" timestamp="03.11.2022 16:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="dep" type="array" />
        <param name="prizn_arch_folder" type="array" />
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="not_done_dat" type="date" />
        <param name="done_dat1" type="date" />
        <param name="done_dat2" type="date" />
        <param name="vidan_dat1" type="date" />
        <param name="vidan_dat2" type="date" />
        <param name="postup_dat1" type="date" />
        <param name="postup_dat2" type="date" />
        <param name="kod_emp_isp" type="number" />
        <param name="kod_emp_podp" type="number" />
        <param name="pr_bankrupt" type="number" />
      </params>
      <select>
        <column table="a" column="kod_isp" />
        <column table="a" column="dat_last_opl" title="Дата последней оплаты" />
        <column table="a" column="dep" as="dep" />
        <column table="a" column="kodp" as="kodp" />
        <column table="a" column="ab_dog" title="Абонент и договор" />
        <column table="cat" column="abbr" as="category" />
        <column table="a" column="num_delo" title="Номер дела" />
        <column table="a" column="debt_all_do" title="Долг до выдачи ИЛ" group="sum" />
        <column table="a" column="debt_osn_do" title="Долг осн до выдачи ИЛ" group="sum" />
        <column table="a" column="debt_peni_do" title="Долг пени до выдачи ИЛ" group="sum" />
        <column table="a" column="debt_gp_do" title="Долг ГП до выдачи ИЛ" group="sum" />
        <column table="a" column="dat_vid" title="Дата выдачи исп. листа" />
        <column table="a" column="dat_post_upr" title="Дата поступления исп.листа в Упр." />
        <column table="a" column="dat_post" title="Дата поступления исп.листа в отделение" />
        <column table="a" column="debt_all" title="Долг" group="sum" />
        <call function="if" as="debt_all_before_not_done_dat" group="sum">
          <call function="or">
            <call function="false" />
            <call function="or" optional="1">
              <call function="and">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <call function="!=0">
                <column table="a" column="debt_all" />
              </call>
            </call>
          </call>
          <column table="a" column="debt_all_before_not_done_dat" />
        </call>
        <call function="if" as="debt_osn_before_not_done_dat" group="sum">
          <call function="or">
            <call function="false" />
            <call function="or" optional="1">
              <call function="and">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <call function="!=0">
                <column table="a" column="debt_all" />
              </call>
            </call>
          </call>
          <column table="a" column="debt_osn_before_not_done_dat" />
        </call>
        <call function="if" as="debt_peni_before_not_done_dat" group="sum">
          <call function="or">
            <call function="false" />
            <call function="or" optional="1">
              <call function="and">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <call function="!=0">
                <column table="a" column="debt_all" />
              </call>
            </call>
          </call>
          <column table="a" column="debt_peni_before_not_done_dat" />
        </call>
        <call function="if" as="debt_gp_before_not_done_dat" group="sum">
          <call function="or">
            <call function="false" />
            <call function="or" optional="1">
              <call function="and">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <call function="!=0">
                <column table="a" column="debt_all" />
              </call>
            </call>
          </call>
          <column table="a" column="debt_gp_before_not_done_dat" />
        </call>
        <column table="a" column="debt_all_do" title="Долг до выдачи ИЛ" group="sum" as="debt_osn_before_not_done_dat" exclude="1" />
        <column table="a" column="debt_all_do" title="Долг до выдачи ИЛ" group="sum" as="debt_peni_before_not_done_dat" exclude="1" />
        <column table="a" column="debt_all_do" title="Долг до выдачи ИЛ" group="sum" as="debt_gp_before_not_done_dat" exclude="1" />
        <column table="a" column="ym_nach_s" title="Период начисления с" />
        <column table="a" column="ym_nach_po" title="Период начисления по" />
        <column table="a" column="peni_per" title="Период пени" />
        <column table="a" column="other_work_prim" title="Примечание в других работах" />
        <column table="a" column="dep_sname" title="Подразделение" />
        <column table="a" column="dep_name" title="Подразделение" />
        <call function="over" as="min_dat_vid">
          <call function="min">
            <column table="a" column="dat_vid" />
          </call>
          <call function="partition by">
            <column table="a" column="dep" />
            <column table="a" column="kodp" />
            <column table="a" column="ndog" exclude="1" />
          </call>
          <call function="order by rows * *">
            <const type="number">1</const>
          </call>
        </call>
        <call function="row_number" as="npp" title="№ п/п" exclude="1">
          <call function="partition by">
            <column table="a" column="dep" />
          </call>
          <call function="order by simple">
            <column table="this" column="min_dat_vid" exclude="1" />
            <column table="a" column="dat_vid" />
            <column table="a" column="dat_post" />
            <column table="a" column="kod_isp" />
          </call>
        </call>
        <call function="rownum" as="npp" title="№ п/п" exclude="1" />
        <call function="if" as="last_month" type="number">
          <call function="or">
            <call function="=">
              <call function="date to ym">
                <column table="a" column="dat_vid" />
              </call>
              <call function="date to ym">
                <call function="nvlu">
                  <useparam name="vidan_dat2" />
                  <call function="null" />
                </call>
              </call>
            </call>
            <call function="=">
              <call function="date to ym">
                <column table="a" column="dat_post" />
              </call>
              <call function="date to ym">
                <call function="nvlu">
                  <useparam name="postup_dat2" />
                  <call function="null" />
                </call>
              </call>
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="52834-pre" as="a">
          <withparams>
            <useparam name="not_done_dat" />
            <useparam name="pr_bankrupt" />
          </withparams>
        </query>
        <query name="52834-pre_il_gr_cust" join="inner" as="b">
          <withparams>
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
          <call function="=">
            <column table="a" column="kod_isp" />
            <column table="b" column="kod_isp" />
          </call>
        </query>
        <query name="us_category" join="left outer" as="cat">
          <call function="=">
            <column table="a" column="kod_category" />
            <column table="cat" column="kod_category" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="or">
            <call function="false" />
            <call function="or" optional="1">
              <call function="and">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <call function="!=0">
                <column table="a" column="debt_all" />
              </call>
            </call>
            <call function="and">
              <call function="or">
                <call function="false" />
                <call function="is not null" optional="1">
                  <useparam name="done_dat1" />
                </call>
                <call function="is not null" optional="1">
                  <useparam name="done_dat2" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="ge">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="done_dat1" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=0">
                  <column table="a" column="debt_all" />
                </call>
                <call function="le">
                  <column table="a" column="dat_last_opl" />
                  <useparam name="done_dat2" />
                </call>
              </call>
            </call>
          </call>
          <call function="in" optional="1">
            <column table="a" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="is_active" />
            <useparam name="prizn_arch_folder" />
          </call>
          <call function="ge" optional="1">
            <column table="a" column="dat_vid" />
            <useparam name="vidan_dat1" />
          </call>
          <call function="le" optional="1">
            <column table="a" column="dat_vid" />
            <useparam name="vidan_dat2" />
          </call>
          <call function="ge" optional="1">
            <call function="nvl">
              <column table="a" column="dat_post_upr" />
              <column table="a" column="dat_post" />
            </call>
            <useparam name="postup_dat1" />
          </call>
          <call function="le" optional="1">
            <call function="nvl">
              <column table="a" column="dat_post_upr" />
              <column table="a" column="dat_post" />
            </call>
            <useparam name="postup_dat2" />
          </call>
        </call>
      </where>
      <grouping>
        <grset as="itog" />
        <grset as="dep" order="dep_sname">
          <group>
            <column table="this" column="dep" />
            <column table="this" column="dep_sname" />
            <column table="this" column="dep_name" />
          </group>
          <grset as="isp" order="min_dat_vid, kodp, dat_vid, dat_post, kod_isp">
            <group>
              <column table="this" column="kod_isp" />
              <column table="this" column="dat_last_opl" />
              <column table="this" column="min_dat_vid" />
              <column table="this" column="kodp" />
              <column table="this" column="ab_dog" />
              <column table="this" column="category" />
              <column table="this" column="num_delo" />
              <column table="this" column="dat_vid" />
              <column table="this" column="dat_post_upr" />
              <column table="this" column="dat_post" />
              <column table="this" column="ym_nach_s" />
              <column table="this" column="ym_nach_po" />
              <column table="this" column="peni_per" />
              <column table="this" column="other_work_prim" />
              <column table="this" column="last_month" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="52834-pre" timestamp="21.11.2022 11:20:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="not_done_dat" type="date" />
        <param name="pr_bankrupt" type="number" />
      </params>
      <select>
        <column table="ur_isp" column="kod_isp" group="1" title="Код ИЛ" as="kod_isp" />
        <column table="ur_folders_isp" column="is_active" group="1" />
        <column table="ur_folders_isp" column="kod_category" group="1" />
        <call function="greatest" group="1" as="dat_last_opl" comment="если попадет хоть один Null, то вернет null">
          <call function="coalesce" comment="разница в порядке дат">
            <column table="astr_opl_posl" column="dat_opl" />
            <column table="do_opl_k_posl" column="dat_opl" />
            <column table="do_opl_sf_posl" column="dat_opl" />
          </call>
          <call function="coalesce">
            <column table="do_opl_k_posl" column="dat_opl" />
            <column table="do_opl_sf_posl" column="dat_opl" />
            <column table="astr_opl_posl" column="dat_opl" />
          </call>
          <call function="coalesce">
            <column table="do_opl_sf_posl" column="dat_opl" />
            <column table="astr_opl_posl" column="dat_opl" />
            <column table="do_opl_k_posl" column="dat_opl" />
          </call>
        </call>
        <column table="kod_dep" column="kodp" group="1" as="dep" title="Код подразделения" />
        <column table="kodp" column="kodp" group="1" as="kodp" title="Код абонента" />
        <column table="dp_nach" column="ndog" as="ndog" />
        <call function="||" as="ab_dog" group="1">
          <column table="kodp" column="name" />
          <call function="chr">
            <const>13</const>
          </call>
          <call function="chr">
            <const>10</const>
          </call>
          <const>'ИНН '</const>
          <column table="kodp" column="inn" />
          <call function="chr">
            <const>13</const>
          </call>
          <call function="chr">
            <const>10</const>
          </call>
          <const>'('</const>
          <column table="dp_nach" column="ndog" />
          <const>')'</const>
        </call>
        <column table="kod_mat_pp" column="num_delo" group="1" />
        <call function="-" as="debt_all_do" group="1">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="kod_hist_mat_dec" column="sud_izd" comment="ручные суммы" />
            <column table="astr_nach" column="nachisl_astr" />
            <column table="dp_nach" column="sum_v" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="astr_opl_do" column="oplf" />
            <column table="do_opl_k_do" column="oplf" />
            <column table="do_opl_sf_do" column="oplf" />
          </call>
        </call>
        <call function="-" as="debt_osn_do" group="1">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="dp_nach" column="sum_v_osn" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_osn" />
            <column table="do_opl_sf_do" column="oplf_osn" />
          </call>
        </call>
        <call function="-" as="debt_peni_do" group="1">
          <call function="+nvl" comment="начислено">
            <column table="dp_nach" column="sum_v_peni" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_peni" />
            <column table="do_opl_sf_do" column="oplf_peni" />
          </call>
        </call>
        <call function="-" as="debt_gp_do" group="1">
          <call function="+nvl" comment="начислено">
            <column table="dp_nach" column="sum_v_gp" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_gp" />
            <column table="do_opl_sf_do" column="oplf_gp" />
          </call>
        </call>
        <column table="ur_isp" column="dat_doc" group="1" as="dat_vid" />
        <column table="ur_isp" column="dat_post_upr" group="1" />
        <column table="ur_isp" column="dat_post" group="1" />
        <call function="-" as="debt_all" group="1">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="kod_hist_mat_dec" column="sud_izd" comment="ручные суммы" />
            <column table="astr_nach" column="nachisl_astr" />
            <column table="dp_nach" column="sum_v" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="astr_opl_do" column="oplf" />
            <column table="astr_opl_posl" column="oplf" />
            <column table="do_opl_k_do" column="oplf" />
            <column table="do_opl_k_posl" column="oplf" />
            <column table="do_opl_sf_do" column="oplf" />
            <column table="do_opl_sf_posl" column="oplf" />
            <column table="kod_hist_mat_dec" column="opl_ogr" comment="ручные оплаты" />
            <column table="kod_hist_mat_dec" column="opl_sud_izd" comment="ручные оплаты" />
          </call>
        </call>
        <call function="-" as="debt_all_before_not_done_dat" group="1">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="kod_hist_mat_dec" column="sud_izd" comment="ручные суммы" />
            <column table="astr_nach" column="nachisl_astr" />
            <column table="dp_nach" column="sum_v" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="astr_opl_do" column="oplf" />
            <column table="astr_opl_posl" column="oplf_before_not_done_dat" />
            <column table="do_opl_k_do" column="oplf" />
            <column table="do_opl_k_posl" column="oplf_before_not_done_dat" />
            <column table="do_opl_sf_do" column="oplf" />
            <column table="do_opl_sf_posl" column="oplf_before_not_done_dat" />
            <call function="if">
              <call function="and">
                <call function="true" />
                <call function="lt" optional="1">
                  <call function="nvl">
                    <column table="kod_hist_mat_dec" column="opl_ogr_dat" />
                    <call function="doomsday" />
                  </call>
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <column table="kod_hist_mat_dec" column="opl_ogr" comment="ручные оплаты" />
            </call>
            <call function="if">
              <call function="and">
                <call function="true" />
                <call function="lt" optional="1">
                  <call function="nvl">
                    <column table="kod_hist_mat_dec" column="opl_sud_izd_dat" />
                    <call function="doomsday" />
                  </call>
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <column table="kod_hist_mat_dec" column="opl_sud_izd" comment="ручные оплаты" />
            </call>
          </call>
        </call>
        <call function="-" as="debt_osn_before_not_done_dat" group="1">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="dp_nach" column="sum_v_osn" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_osn" />
            <column table="do_opl_k_posl" column="oplf_osn_before_not_done_dat" />
            <column table="do_opl_sf_do" column="oplf_osn" />
            <column table="do_opl_sf_posl" column="oplf_osn_before_not_done_dat" />
            <call function="if">
              <call function="and">
                <call function="true" />
                <call function="lt" optional="1">
                  <call function="nvl">
                    <column table="kod_hist_mat_dec" column="opl_ogr_dat" />
                    <call function="doomsday" />
                  </call>
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <column table="kod_hist_mat_dec" column="opl_ogr" comment="ручные оплаты" />
            </call>
          </call>
        </call>
        <call function="-" as="debt_peni_before_not_done_dat" group="1">
          <call function="+nvl" comment="начислено">
            <column table="dp_nach" column="sum_v_peni" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_peni" />
            <column table="do_opl_k_posl" column="oplf_peni_before_not_done_dat" />
            <column table="do_opl_sf_do" column="oplf_peni" />
            <column table="do_opl_sf_posl" column="oplf_peni_before_not_done_dat" />
          </call>
        </call>
        <call function="-" as="debt_gp_before_not_done_dat" group="1">
          <call function="+nvl" comment="начислено">
            <column table="dp_nach" column="sum_v_gp" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_gp" />
            <column table="do_opl_k_posl" column="oplf_gp_before_not_done_dat" />
            <column table="do_opl_sf_do" column="oplf_gp" />
            <column table="do_opl_sf_posl" column="oplf_gp_before_not_done_dat" />
          </call>
        </call>
        <column table="dp_nach" column="ym_min_priz" group="1" as="ym_nach_s" />
        <column table="dp_nach" column="ym_max_priz" group="1" as="ym_nach_po" />
        <call function="vg_period.ym_enum_str_to_ym_ranges_str" as="peni_per" comment="период пени" group="1">
          <column table="dp_nach" column="peni_per" />
        </call>
        <column group="stragg_dist" table="ur_isp_other_prim" column="prim" as="other_work_prim" exclude="1" />
        <call function="over" as="other_work_prim" group="max">
          <call function="stragg_dist">
            <column table="ur_isp_other_prim" column="prim" />
          </call>
          <call function="partition by">
            <column table="ur_isp" column="kod_isp" />
          </call>
          <call function="order by rows * *">
            <column table="ur_isp_other_prim" column="kod_isp_other_prim" />
          </call>
        </call>
        <column table="kod_dep" column="sname" group="1" as="dep_sname" />
        <column table="kod_dep" column="name" group="1" as="dep_name" />
        <call function="over" as="min_dat_vid" group="1" title="Дата выдачи исп. листа (минимум по абоненту)" type="date" exclude="1">
          <call function="min">
            <column table="ur_isp" column="dat_doc" />
          </call>
          <call function="partition by">
            <column table="kod_dep" column="kodp" />
            <column table="kodp" column="kodp" />
            <column table="dp_nach" column="ndog" exclude="1" />
          </call>
          <call function="order by rows * *">
            <const type="number">1</const>
          </call>
        </call>
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp" />
          </link>
          <link name="kod_folders">
            <link name="kod_dep" />
            <link name="kodp">
              <elink name="kr_dopdoc" />
            </link>
          </link>
          <elink name="ur_folders_isp">
            <elink name="ur_isp_other_isp">
              <elink name="ur_isp_other_prim" />
            </elink>
          </elink>
        </query>
        <query name="52834-pre_astr_nach_g" as="astr_nach" join="left outer" comment="астрент нач">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_nach" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_astr_opl_do_g" as="astr_opl_do" join="left outer" comment="астрент опл до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_opl_do" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_astr_opl_posl_g" as="astr_opl_posl" join="left outer" comment="астрент опл после">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_opl_posl" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_dogplat_nach_g" as="dp_nach" join="left outer" comment="dogplat нач">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="dp_nach" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_dogplat_opl_k_do_g" as="do_opl_k_do" join="left outer" comment="dogplat опл кред до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_k_do" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_dogplat_opl_k_posl_g" as="do_opl_k_posl" join="left outer" comment="dogplat опл кред посл">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_k_posl" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_dogplat_opl_sf_do_g" as="do_opl_sf_do" join="left outer" comment="dogplat опл сф до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_sf_do" column="kod_isp" />
          </call>
        </query>
        <query name="52834-pre_dogplat_opl_sf_posl_g" as="do_opl_sf_posl" join="left outer" comment="dogplat опл сф посл">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_sf_posl" column="kod_isp" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="=">
              <useparam name="pr_bankrupt" />
              <const>0</const>
            </call>
            <call function="and">
              <call function="=">
                <useparam name="pr_bankrupt" />
                <const>1</const>
              </call>
              <call function="in">
                <column table="kodp" column="ogrn" />
                <query>
                  <select>
                    <column table="a" column="ogrn" />
                  </select>
                  <from>
                    <query name="kr_egr_ul" as="a" />
                  </from>
                  <where>
                    <call function="in">
                      <column table="a" column="sulst" />
                      <array>114,115,116,117</array>
                    </call>
                  </where>
                </query>
              </call>
            </call>
            <call function="and">
              <call function="=">
                <useparam name="pr_bankrupt" />
                <const>2</const>
              </call>
              <call function="not exists">
                <query>
                  <select>
                    <const>1</const>
                  </select>
                  <from>
                    <query name="kr_egr_ul" as="a" />
                  </from>
                  <where>
                    <call function="and">
                      <call function="=">
                        <column table="a" column="ogrn" />
                        <column table="kodp" column="ogrn" />
                      </call>
                      <call function="in">
                        <column table="a" column="sulst" />
                        <array>114,115,116,117</array>
                      </call>
                    </call>
                  </where>
                </query>
              </call>
            </call>
          </call>
          <call function="not like" comment="По заявке 64523 пункт 6">
            <column table="dp_nach" column="ndog" />
            <const>'%-51 Э'</const>
          </call>
          <call function="not like" comment="По заявке 64523 пункт 6">
            <column table="dp_nach" column="ndog" />
            <const>'%-51 Э-ОДН'</const>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_astr_nach" timestamp="18.06.2019 16:28:20" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_facras_astr" column="kod_ras_astr" group="1" />
        <column table="sr_facras_astr" column="nachisl_astr" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="sr_penni_astr">
                <link name="kod_sf_astr">
                  <elink name="sr_facras_astr" />
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="52834-pre_astr_opl_do" timestamp="02.11.2022 17:35:29" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl_astr" column="kod_opl" group="1" />
        <column table="sr_opl_astr" column="dat_opl" group="1" />
        <column table="sr_opl_astr" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="sr_penni_astr">
                <link name="kod_sf_astr">
                  <elink name="sr_opl_astr" />
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="lt">
          <column table="sr_opl_astr" column="dat_opl" />
          <call function="nvl">
            <column table="ur_isp" column="dat_doc" />
            <call function="doomsday" />
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_astr_opl_posl" timestamp="17.06.2019 16:47:12" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl_astr" column="kod_opl" group="1" />
        <column table="sr_opl_astr" column="dat_opl" group="1" />
        <column table="sr_opl_astr" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="sr_penni_astr">
                <link name="kod_sf_astr">
                  <elink name="sr_opl_astr" />
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="ge">
          <column column="dat_opl" table="sr_opl_astr" />
          <column column="dat_doc" table="ur_isp" />
        </call>
      </where>
    </query>
    <query name="52834-pre_astr_nach_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column table="a" column="nachisl_astr" group="sum" />
      </select>
      <from>
        <query name="52834-pre_astr_nach" as="a" />
      </from>
    </query>
    <query name="52834-pre_astr_opl_do_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column table="a" column="oplf" group="sum" />
      </select>
      <from>
        <query name="52834-pre_astr_opl_do" as="a" />
      </from>
    </query>
    <query name="52834-pre_astr_opl_posl_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="not_done_dat" type="date" />
      </params>
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column table="a" column="dat_opl" group="max" />
        <column table="a" column="oplf" group="sum" />
        <call function="if" as="oplf_before_not_done_dat" group="sum">
          <call function="and">
            <call function="true" />
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
      </select>
      <from>
        <query name="52834-pre_astr_opl_posl" as="a" />
      </from>
    </query>
    <query name="52834-pre_dogplat_nach" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="ur_dogplat" column="kod_dogplat" group="1" />
        <column table="ur_dogplat" column="sum_v" group="1" />
        <column table="ur_dogplat" column="vid_real" group="1" />
        <column table="ur_dogplat" column="ym_min_priz" group="1" />
        <column table="ur_dogplat" column="ym_max_priz" group="1" />
        <column table="kod_dog" column="ndog" group="max" />
        <column table="vr_peni_period" column="name" group="stragg" as="peni_per" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="ur_dogplat">
                <link name="kod_deb_sf">
                  <link name="kod_sf">
                    <link name="kod_dog" />
                    <elink name="vr_peni_period" />
                  </link>
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="52834-pre_dogplat_nach_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column table="a" column="sum_v" group="sum" />
        <call function="if" as="sum_v_osn" group="sum">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <column table="a" column="sum_v" />
        </call>
        <call function="if" group="sum" as="sum_v_peni">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>7</const>
          </call>
          <column table="a" column="sum_v" />
        </call>
        <call function="if" group="sum" as="sum_v_gp">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>9</const>
          </call>
          <column table="a" column="sum_v" />
        </call>
        <column table="a" column="ndog" group="stragg_dist" />
        <column table="a" column="ym_min_priz" group="min" />
        <column table="a" column="ym_max_priz" group="max" />
        <column table="a" column="peni_per" group="stragg" />
      </select>
      <from>
        <query name="52834-pre_dogplat_nach" as="a" />
      </from>
    </query>
    <query name="52834-pre_dogplat_opl_k_do" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl" column="kod_opl" group="1" />
        <column group="1" table="sr_opl" column="vid_real" />
        <column table="sr_opl" column="dat_opl" group="1" />
        <column table="sr_opl" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="sr_opl_bank">
                <elink name="sr_opl" />
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="sr_opl" column="kod_type_opl" />
            <array>1,2,5,6</array>
          </call>
          <call function="lt">
            <column table="sr_opl" column="dat_uch" />
            <call function="nvl">
              <column table="ur_isp" column="dat_doc" />
              <call function="doomsday" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_dogplat_opl_k_posl" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl" column="kod_opl" group="1" />
        <column table="sr_opl" column="vid_real" group="1" />
        <column table="sr_opl" column="dat_opl" group="1" />
        <column table="sr_opl" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="sr_opl_bank">
                <elink name="sr_opl" />
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="sr_opl" column="kod_type_opl" />
            <array>1,2,5,6</array>
          </call>
          <call function="ge">
            <column table="sr_opl" column="dat_uch" />
            <call function="nvl">
              <column table="ur_isp" column="dat_doc" />
              <call function="doomsday" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_dogplat_opl_k_do_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column column="oplf" group="sum" table="a" />
        <call function="if" group="sum" as="oplf_osn">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_peni">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>7</const>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_gp">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>9</const>
          </call>
          <column table="a" column="oplf" />
        </call>
      </select>
      <from>
        <query name="52834-pre_dogplat_opl_k_do" as="a" />
      </from>
    </query>
    <query name="52834-pre_dogplat_opl_k_posl_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="not_done_dat" type="date" />
      </params>
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column column="oplf" group="sum" table="a" />
        <call function="if" group="sum" as="oplf_osn_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>2</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_peni_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>7</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_gp_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>9</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <column table="a" column="dat_opl" group="max" />
        <call function="if" as="oplf_before_not_done_dat" group="sum">
          <call function="and">
            <call function="true" />
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
      </select>
      <from>
        <query name="52834-pre_dogplat_opl_k_posl" as="a" />
      </from>
    </query>
    <query name="52834-pre_dogplat_opl_sf_do" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl_sf" column="kod_opl" group="1" />
        <column group="1" table="sr_opl_sf" column="vid_real" />
        <column table="sr_opl_sf" column="dat_opl" group="1" />
        <column table="sr_opl_sf" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="ur_dogplat">
                <link name="kod_deb_sf">
                  <link name="kod_sf">
                    <elink name="sr_opl_sf" />
                  </link>
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="sr_opl_sf" column="kod_type_opl" />
            <array>0,2,3,4</array>
          </call>
          <call function="not in" exclude="1" comment="есть в kod_sf">
            <column table="kod_sf" column="vid_sf" />
            <array>2,9</array>
          </call>
          <call function="lt">
            <column table="sr_opl_sf" column="dat_uch" />
            <call function="nvl">
              <column table="ur_isp" column="dat_doc" />
              <call function="doomsday" />
            </call>
          </call>
          <call function="ge">
            <column table="sr_opl_sf" column="dat_uch" />
            <column table="kod_hist_mat_dec" column="dat_post" />
          </call>
          <call function="or">
            <call function="=">
              <column table="ur_dogplat" column="prizn_konv" />
              <const>1</const>
            </call>
            <call function="ge">
              <column table="sr_opl_sf" column="dat_uch" />
              <call function="earliest">
                <call function="nvl">
                  <column table="ur_dogplat" column="dat_form" />
                  <call function="doomsday" />
                </call>
                <call function="nvl">
                  <column table="kod_hist_mat_dec" column="dat_post" />
                  <call function="doomsday" />
                </call>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_dogplat_opl_sf_posl" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
        <column table="sr_opl_sf" column="kod_opl" group="1" />
        <column group="1" table="sr_opl_sf" column="vid_real" />
        <column table="sr_opl_sf" column="dat_opl" group="1" />
        <column table="sr_opl_sf" column="oplf" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="ur_dogplat">
                <link name="kod_deb_sf">
                  <link name="kod_sf">
                    <elink name="sr_opl_sf" />
                  </link>
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="sr_opl_sf" column="kod_type_opl" />
            <array>0,2,3,4</array>
          </call>
          <call function="not in" exclude="1">
            <column table="kod_sf" column="vid_sf" />
            <array>2,9</array>
          </call>
          <call function="ge">
            <column table="sr_opl_sf" column="dat_uch" />
            <call function="nvl">
              <column table="ur_isp" column="dat_doc" />
              <call function="doomsday" />
            </call>
          </call>
          <call function="ge">
            <column table="sr_opl_sf" column="dat_uch" />
            <column table="kod_hist_mat_dec" column="dat_post" />
          </call>
          <call function="or">
            <call function="=">
              <column table="ur_dogplat" column="prizn_konv" />
              <const>1</const>
            </call>
            <call function="ge">
              <column table="sr_opl_sf" column="dat_uch" />
              <call function="earliest">
                <call function="nvl">
                  <column table="ur_dogplat" column="dat_form" />
                  <call function="doomsday" />
                </call>
                <call function="nvl">
                  <column table="kod_hist_mat_dec" column="dat_post" />
                  <call function="doomsday" />
                </call>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_dogplat_opl_sf_do_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column column="oplf" group="sum" table="a" />
        <call function="if" group="sum" as="oplf_osn">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_peni">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>7</const>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_gp">
          <call function="=">
            <column table="a" column="vid_real" />
            <const>9</const>
          </call>
          <column table="a" column="oplf" />
        </call>
      </select>
      <from>
        <query name="52834-pre_dogplat_opl_sf_do" as="a" />
      </from>
    </query>
    <query name="52834-pre_dogplat_opl_sf_posl_g" materialize="1" timestamp="02.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="not_done_dat" type="date" />
      </params>
      <select>
        <column table="a" column="kod_isp" group="1" />
        <column table="a" column="oplf" group="sum" />
        <call function="if" group="sum" as="oplf_osn_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>2</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_peni_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>7</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <call function="if" group="sum" as="oplf_gp_before_not_done_dat">
          <call function="and">
            <call function="=">
              <column table="a" column="vid_real" />
              <const>9</const>
            </call>
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
        <column table="a" column="dat_opl" group="max" />
        <call function="if" as="oplf_before_not_done_dat" group="sum">
          <call function="and">
            <call function="true" />
            <call function="lt" optional="1">
              <column table="a" column="dat_opl" />
              <useparam name="not_done_dat" />
            </call>
          </call>
          <column table="a" column="oplf" />
        </call>
      </select>
      <from>
        <query name="52834-pre_dogplat_opl_sf_posl" as="a" />
      </from>
    </query>
    <query name="52834-pre_il_gr_cust" timestamp="01.11.2022 16:30:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <column table="ur_isp" column="kod_isp" group="1" />
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp">
              <elink name="ur_dogplat">
                <link name="kod_deb_sf">
                  <link name="kod_sf">
                    <link name="kod_dog">
                      <link name="kod_dog_dop">
                        <link name="kod_group_cust">
                          <link name="kod_group_cust_parent" exclude="1" />
                        </link>
                      </link>
                    </link>
                  </link>
                </link>
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <query>
              <select>
                <column table="a" column="kod_group_cust" />
              </select>
              <from>
                <query name="ks_group_cust" as="a" />
              </from>
              <start>
                <call function="=">
                  <column table="a" column="kod_group_cust" />
                  <column table="kod_group_cust" column="kod_group_cust" />
                </call>
              </start>
              <connect>
                <call function="=">
                  <column table="a" column="kod_gr_parent" prior="1" />
                  <column table="a" column="kod_group_cust" />
                </call>
              </connect>
              <where>
                <call function="is null">
                  <column table="a" column="kod_gr_parent" />
                </call>
              </where>
            </query>
            <column table="kod_group_cust_parent" column="kod_group_cust" exclude="1" />
            <useparam name="kod_group_cust_parent" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust" column="kod_group_cust" />
            <useparam name="kod_group_cust" />
          </call>
        </call>
      </where>
    </query>
    <query name="kr_employee_podpisant_52834" order="fio" class="1" timestamp="18.06.2019 22:55:13" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="dep" type="array">
          <!--<const>(102276621)</const>-->
        </param>
      </params>
      <select>
        <column table="a" column="kod_emp" key="1" />
        <column table="a" column="fio" title="Юрист" vid="1" />
      </select>
      <from>
        <query name="kr_employee" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="a" column="kodp" />
            <query>
              <select>
                <column table="b" column="kodp" />
              </select>
              <from>
                <query name="kr_org_branch3" as="b">
                  <withparams>
                    <useparam name="dep" />
                  </withparams>
                </query>
              </from>
            </query>
          </call>
          <call function="=" exclude="1">
            <column table="a" column="kod_dolzhfun" />
            <const>-1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-pre_test" timestamp="25.08.2021 12:29:46" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="dep" type="array" />
        <param name="prizn_arch_folder" type="array" />
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="not_done_dat" type="date">
          <const type="date">to_date('01.08.2021','dd.mm.yyyy')</const>
        </param>
        <param name="done_dat1" type="date" />
        <param name="done_dat2" type="date" />
        <param name="vidan_dat1" type="date" />
        <param name="vidan_dat2" type="date" />
        <param name="postup_dat1" type="date" />
        <param name="postup_dat2" type="date" />
        <param name="kod_emp_isp" type="number" />
        <param name="kod_emp_podp" type="number" />
      </params>
      <select>
        <column table="ur_isp" column="kod_isp" />
        <call function="||" as="ab_dog">
          <column table="kodp" column="name" />
          <const>' ('</const>
          <column table="dp_nach" column="ndog" />
          <const>')'</const>
        </call>
        <column table="kod_mat_pp" column="num_delo" />
        <column table="ur_isp" column="dat_post" />
        <fact column="dolg_on_il_hnd" exclude="1" />
        <call function="-" as="debt_all_do">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="kod_hist_mat_dec" column="sud_izd" comment="ручные суммы" />
            <column table="astr_nach" column="nachisl_astr" />
            <column table="dp_nach" column="sum_v" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="astr_opl_do" column="oplf" />
            <column table="do_opl_k_do" column="oplf" />
            <column table="do_opl_sf_do" column="oplf" />
          </call>
        </call>
        <call function="-" as="debt_osn_before_not_done_dat">
          <call function="+nvl" comment="начислено">
            <column table="kod_hist_mat_dec" column="ogr" comment="ручные суммы" />
            <column table="dp_nach" column="sum_v_osn" />
          </call>
          <call function="+nvl" comment="оплачено до выдачи ИЛ">
            <column table="do_opl_k_do" column="oplf_osn" />
            <column table="do_opl_k_posl" column="oplf_osn_before_not_done_dat" />
            <column table="do_opl_sf_do" column="oplf_osn" />
            <column table="do_opl_sf_posl" column="oplf_osn_before_not_done_dat" />
            <call function="if">
              <call function="and">
                <call function="true" />
                <call function="lt" optional="1">
                  <call function="nvl">
                    <column table="kod_hist_mat_dec" column="opl_ogr_dat" />
                    <call function="doomsday" />
                  </call>
                  <useparam name="not_done_dat" />
                </call>
              </call>
              <column table="kod_hist_mat_dec" column="opl_ogr" comment="ручные оплаты" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="ur_isp">
          <link name="kod_hist_mat_dec">
            <link name="kod_mat_pp" />
          </link>
          <link name="kod_folders">
            <link name="kod_dep" />
            <link name="kodp">
              <elink name="kr_dopdoc" />
            </link>
          </link>
          <elink name="ur_folders_isp">
            <elink name="ur_isp_other_isp">
              <elink name="ur_isp_other_prim" />
            </elink>
          </elink>
        </query>
        <query join="left outer" name="52834-pre_astr_nach_g" as="astr_nach" comment="астрент нач">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_nach" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_astr_opl_do_g" as="astr_opl_do" comment="астрент опл до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_opl_do" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_astr_opl_posl_g" as="astr_opl_posl" comment="астрент опл после">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="astr_opl_posl" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_dogplat_nach_g" as="dp_nach" comment="dogplat нач">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="dp_nach" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_dogplat_opl_k_do_g" as="do_opl_k_do" comment="dogplat опл кред до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_k_do" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_dogplat_opl_k_posl_g" as="do_opl_k_posl" comment="dogplat опл кред посл">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_k_posl" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_dogplat_opl_sf_do_g" as="do_opl_sf_do" comment="dogplat опл сф до">
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_sf_do" column="kod_isp" />
          </call>
        </query>
        <query join="left outer" name="52834-pre_dogplat_opl_sf_posl_g" as="do_opl_sf_posl" comment="dogplat опл сф посл">
          <withparams>
            <useparam name="not_done_dat" />
          </withparams>
          <call function="=">
            <column table="ur_isp" column="kod_isp" />
            <column table="do_opl_sf_posl" column="kod_isp" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call table="kod_isp" column="kod_isp" function="=">
            <column table="ur_isp" column="kod_isp" />
            <const type="number">2000002157</const>
          </call>
        </call>
      </where>
    </query>
    <query name="52834-params" timestamp="19.10.2022 14:32:13" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="kod_emp_isp" type="number" />
        <param name="kod_emp_podp" type="number" />
        <param name="not_done_dat" type="date" />
        <param name="done_dat1" type="date" />
        <param name="done_dat2" type="date" />
        <param name="vidan_dat1" type="date" />
        <param name="vidan_dat2" type="date" />
        <param name="postup_dat1" type="date" />
        <param name="postup_dat2" type="date" />
      </params>
      <select>
        <call function="date to char" as="dat" title="Дата">
          <call function="sysdate" />
        </call>
        <column table="isp" column="fio" title="Фио исполнителя" as="isp_fio" />
        <column table="isp" column="tel" as="isp_phone" title="Телефон исполнителя" />
        <column table="podp" column="fio" as="podp_fio" title="Фио подписанта" />
        <column table="podp_dolzh" column="name" as="podp_dolg" title="Должность подписанта" />
        <call function="date to char" as="not_done_dat">
          <call function="nvlu" type="date">
            <useparam name="not_done_dat" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="done_dat1">
          <call function="nvlu" type="date">
            <useparam name="done_dat1" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="done_dat2">
          <call function="nvlu" type="date">
            <useparam name="done_dat2" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="vidan_dat1">
          <call function="nvlu" type="date">
            <useparam name="vidan_dat1" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="vidan_dat2">
          <call function="nvlu" type="date">
            <useparam name="vidan_dat2" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="postup_dat1">
          <call function="nvlu" type="date">
            <useparam name="postup_dat1" />
            <call function="null" />
          </call>
        </call>
        <call function="date to char" as="postup_dat2">
          <call function="nvlu" type="date">
            <useparam name="postup_dat2" />
            <call function="null" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" />
        <query name="kr_employee" join="left outer" as="isp">
          <call function="=">
            <column table="isp" column="kod_emp" />
            <call function="nvlu">
              <useparam name="kod_emp_isp" />
              <call function="null" />
            </call>
          </call>
        </query>
        <query name="kr_employee" as="podp" join="left outer">
          <call function="=">
            <column table="podp" column="kod_emp" />
            <call function="nvlu">
              <useparam name="kod_emp_podp" />
              <call function="null" />
            </call>
          </call>
        </query>
        <query name="ks_namedolzh" as="podp_dolzh" join="left outer">
          <call function="=">
            <column table="podp_dolzh" column="kod_namedolzh" />
            <column table="podp" column="kod_namedolzh" />
          </call>
        </query>
      </from>
    </query>
    <query name="52834-done_dat2_default" timestamp="10.02.2020 23:48:46" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="not_done_dat" type="date" />
        <param name="done_dat1" type="date" />
        <param name="done_dat2" type="date" />
      </params>
      <select>
        <call function="if" as="dat">
          <call function="and">
            <call function="or">
              <call function="false" />
              <call function="is not null" optional="1">
                <useparam name="done_dat1" />
              </call>
            </call>
            <call function="or">
              <call function="false" />
              <call function="is not null" optional="1">
                <useparam name="not_done_dat" />
              </call>
            </call>
            <call function="and" exclude="1">
              <call function="true" />
              <call function="is null" optional="1">
                <useparam name="done_dat2" />
              </call>
            </call>
          </call>
          <call function="nvlu">
            <useparam name="not_done_dat" />
            <call function="null" />
          </call>
          <call function="nvlu">
            <useparam name="done_dat2" />
            <call function="null" />
          </call>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="52834-bankrupt_list" timestamp="03.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <select>
        <column table="a" column="id" key="1" />
        <column table="a" column="name" />
      </select>
      <from>
        <usepart part="table-from-dual" as="a">
          <rows>
            <row>
              <const as="id" type="number">0</const>
              <const as="name" type="string">'Все'</const>
            </row>
            <row>
              <const as="id">1</const>
              <const as="name">'Банкроты'</const>
            </row>
            <row>
              <const as="id">2</const>
              <const as="name">'Не банкроты'</const>
            </row>
          </rows>
        </usepart>
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id" />
  <views child-name="view" key-name="id" />
  <reports child-name="report" key-name="name">
    <report name="52834" form="52834" title="Отчёт по исполнительному производству по юридическим лицам" datareader="1" nogrid="1" timestamp="03.11.2022 12:50:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <params>
        <param name="dep" type="array" />
        <param name="prizn_arch_folder" type="array" />
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="not_done_dat" type="date" />
        <param name="done_dat1" type="date" />
        <param name="done_dat2" type="date" />
        <param name="vidan_dat1" type="date" />
        <param name="vidan_dat2" type="date" />
        <param name="postup_dat1" type="date" />
        <param name="postup_dat2" type="date" />
        <param name="kod_emp_isp" type="number" comment="Исполнитель" />
        <param name="kod_emp_podp" type="number" comment="Подписант" />
        <param name="pr_bankrupt" type="number" comment="Признак банкрота" />
      </params>
      <customers>
        <customer id="10" />
      </customers>
      <print-templates>
        <excel>
          <template name="52834.xlsx" title="Отчёт по исполнительному производству по юридическим лицам" print-xlsx="1" print-proc="2" del-cols="1" />
        </excel>
      </print-templates>
      <queries>
        <query name="52834-main" as="a" title="data">
          <withparams>
            <useparam name="dep" />
            <useparam name="prizn_arch_folder" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="not_done_dat" />
            <useparam name="done_dat1" />
            <useparam name="done_dat2" />
            <useparam name="vidan_dat1" />
            <useparam name="vidan_dat2" />
            <useparam name="postup_dat1" />
            <useparam name="postup_dat2" />
            <useparam name="kod_emp_isp" />
            <useparam name="kod_emp_podp" />
            <useparam name="pr_bankrupt" />
          </withparams>
        </query>
        <query name="52834-params" as="param" title="params">
          <withparams>
            <useparam name="kod_emp_isp" />
            <useparam name="kod_emp_podp" />
            <useparam name="not_done_dat" />
            <useparam name="done_dat1" />
            <useparam name="done_dat2" />
            <useparam name="vidan_dat1" />
            <useparam name="vidan_dat2" />
            <useparam name="postup_dat1" />
            <useparam name="postup_dat2" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <forms child-name="form" key-name="name">
    <form name="52834" timestamp="03.11.2022 12:40:00" file="sql.builder.templates\sql.builder\projects\52834\all\all.xml">
      <content>
        <usefield field="asuse_dep" />
        <usefield field="asuse_prizn_arch_folder" />
        <usefield field="asuse_kod_group_cust_parent" />
        <usefield field="asuse_kod_group_cust_recursive" name="kod_group_cust" />
        <fieldgroup title="ИЛИ">
          <usefield field="cmn_date" name="not_done_dat" title="Не исполнено на" />
          <fieldgroup title="Исполнено в период">
            <usefield field="cmn_date" name="done_dat1" title="c" width-perc="50" halign="left" />
            <usefield field="cmn_date" name="done_dat2" title="по" width-perc="50" halign="right">
              <defaultquery>
                <query name="52834-done_dat2_default" />
              </defaultquery>
            </usefield>
          </fieldgroup>
        </fieldgroup>
        <fieldgroup title="Выдано в период">
          <usefield field="cmn_date" name="vidan_dat1" title="c" width-perc="50" halign="left" />
          <usefield field="cmn_date" name="vidan_dat2" title="по" width-perc="50" halign="right" />
        </fieldgroup>
        <fieldgroup title="Поступило в период">
          <usefield field="cmn_date" name="postup_dat1" title="c" width-perc="50" halign="left" />
          <usefield field="cmn_date" name="postup_dat2" title="по" width-perc="50" halign="right" />
        </fieldgroup>
        <usefield field="cmn_combo_num" name="pr_bankrupt" type="number" title="Признак банкрота" mandatory="1">
          <listquery>
            <query name="52834-bankrupt_list" />
          </listquery>
          <defaultquery>
            <query name="zero" />
          </defaultquery>
        </usefield>
        <field name="kod_emp_isp" type="number" controlType="UICombo" title="Исполнитель">
          <listquery>
            <query name="kr_employee_urists" />
          </listquery>
        </field>
        <field name="kod_emp_podp" type="number" controlType="UICombo" title="Подписант">
          <listquery>
            <query name="kr_employee_podpisant_52834" />
          </listquery>
        </field>
      </content>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name" />
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name" />
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>