<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="generator_ipr" is-report="1" title="ИПР Сводный (демо)" params-customization="1" allow-save="1" edit-columns="1" form="frm_generator_ipr" add-names="1" autobands="1" folder="invpro" timestamp="21.11.2016 14:21:00" with-behavior="0">
      <customers>
        <customer id="17" />
      </customers>
      <columns>
        <column name="doc_osn_fname" title="Год ИПР/Документ" />
        <column name="ym" title="Период" />
        <band title="Вид затрат">
          <band title="Вид">
            <column name="smet_num" title="Номер" />
            <column name="smet_name" title="Наименование" />
          </band>
          <band title="Подвид">
            <column name="vidzatrat_abbr" title="Номер" />
            <column name="vidzatrat_name" title="Наименование" />
          </band>
        </band>
        <band title="Подразделение">
          <column name="direct_name" title="Заказчик" />
          <column name="ispolnit_name" title="Исполнитель" />
        </band>
        <band title="Титул">
          <band title="Сборный">
            <column name="sbor_tit_num_new" title="Код" />
            <column name="sbor_tit_name" title="Наименование" />
          </band>
          <band title="Головной">
            <column name="parent_tit_num_new" title="Код" />
            <column name="parent_tit_name" title="Наименование" />
          </band>
          <band title="Головной/Одиночный">
            <column name="main_tit_num_new" title="Код" />
            <column name="main_tit_name" title="Наименование" />
            <band title="Субъект федерации">
              <column name="subject_name" title="Наименование" />
              <column name="subject_abbr" title="Аббревиатура" />
            </band>
          </band>
          <band title="Одиночный/Дочерний">
            <column name="tit_num_new" title="Код" />
            <column name="tit_name" title="Наименование" />
            <column name="priority_name" title="Степень важности" />
          </band>
          <band title="Дочерний">
            <column name="child_tit_num_new" title="Код" />
            <column name="child_tit_name" title="Наименование" />
          </band>
        </band>
        <band title="Раздел">
          <column name="razdel_root_fname" title="Наименование раздела первого уровня" />
          <column name="razdel_fname" title="Наименование раздела" />
        </band>
        <band title="Сметная стоимость">
          <band title="Текущая">
            <band title="УРС">
              <column name="summ_usr_tek" title="без НДС" />
              <column name="summ_nds_usr_tek" title="c НДС" />
              <band title="-10 %">
                <column name="summ_10_usr_tek" title="без НДС" />
                <column name="summ_10_nds_usr_tek" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_30_usr_tek" title="без НДС" />
                <column name="summ_30_nds_usr_tek" title="с НДС" />
              </band>
            </band>
            <band title="ПСД">
              <column name="summ_psd_tek" title="без НДС" />
              <column name="summ_nds_psd_tek" title="c НДС" />
              <band title="-10 %">
                <column name="summ_psd_10_tek" title="без НДС" />
                <column name="summ_nds_psd_10_tek" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_psd_30_tek" title="без НДС" />
                <column name="summ_nds_psd_30_tek" title="с НДС" />
              </band>
            </band>
            <band title="Утвержденная ПСД">
              <column name="summ_utvpsd_tek" title="без НДС" />
              <column name="summ_nds_utvpsd_tek" title="c НДС" />
            </band>
          </band>
          <band title="Фисированная">
            <band title="УРС">
              <column name="summ_usr" title="без НДС" />
              <column name="summ_nds_usr" title="c НДС" />
              <band title="-10 %">
                <column name="summ_10_usr" title="без НДС" />
                <column name="summ_10_nds_usr" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_30_usr" title="без НДС" />
                <column name="summ_30_nds_usr" title="с НДС" />
              </band>
            </band>
            <band title="ПСД">
              <column name="summ_psd" title="без НДС" />
              <column name="summ_nds_psd" title="c НДС" />
              <band title="-10 %">
                <column name="summ_psd_10" title="без НДС" />
                <column name="summ_nds_psd_10" title="с НДС" />
              </band>
              <band title="-30 %">
                <column name="summ_psd_30" title="без НДС" />
                <column name="summ_nds_psd_30" title="с НДС" />
              </band>
            </band>
            <band title="Утвержденная ПСД">
              <column name="summ_utvpsd" title="без НДС" />
              <column name="summ_nds_utvpsd" title="c НДС" />
            </band>
          </band>
        </band>
        <band title="План">
          <band title="На начало периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_beg" />
              <column title="НДС" name="fp_nds_beg" />
              <column title="c НДС" name="fp_sum_nds_beg" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_beg" />
              <column title="НДС" name="kap_nds_beg" />
              <column title="c НДС" name="kap_sum_nds_beg" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_beg" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_itog_beg" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_itog_beg" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_itog_beg" />
            </band>
          </band>
          <band title="За отчетный период">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_per" />
              <column title="НДС" name="fp_nds_per" />
              <column title="c НДС" name="fp_sum_nds_per" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_per" />
              <column title="НДС" name="kap_nds_per" />
              <column title="c НДС" name="kap_sum_nds_per" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_per" />
            </band>
          </band>
          <band title="По выделенным периодам">
            <band title="Финансирование">
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="fp_sum_nds_by_per" />
              </band>
              <band title="cНДС">
                <column title="[Период]" dimension="period" name="fp_nds_by_per" />
              </band>
            </band>
            <band title="Освоение">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="kap_sum_by_per" />
              </band>
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="kap_sum_nds_by_per" />
              </band>
            </band>
            <band title="Ввод">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="vvod_sum_by_per" />
              </band>
            </band>
          </band>
          <band title="На конец периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_end" />
              <column title="НДС" name="fp_nds_end" />
              <column title="c НДС" name="fp_sum_nds_end" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_end" />
              <column title="НДС" name="kap_nds_end" />
              <column title="c НДС" name="kap_sum_nds_end" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_end" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_itog_end" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_itog_end" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_itog_end" />
            </band>
          </band>
        </band>
        <band title="Факт">
          <band title="На начало периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_beg" />
              <column title="НДС" name="fp_nds_fact_beg" />
              <column title="c НДС" name="fp_sum_nds_fact_beg" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_beg" />
              <column title="НДС" name="kap_nds_fact_beg" />
              <column title="c НДС" name="kap_sum_nds_fact_beg" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_beg" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_fact_itog_beg" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_fact_itog_beg" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_fact_itog_beg" />
            </band>
          </band>
          <band title="За отчетный период">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_per" />
              <column title="НДС" name="fp_nds_fact_per" />
              <column title="c НДС" name="fp_sum_nds_fact_per" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_per" />
              <column title="НДС" name="kap_nds_fact_per" />
              <column title="c НДС" name="kap_sum_nds_fact_per" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_per" />
            </band>
          </band>
          <band title="По выделенным периодам">
            <band title="Финансирование">
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="fp_sum_nds_fact_by_per" />
              </band>
              <band title="cНДС">
                <column title="[Период]" dimension="period" name="fp_nds_fact_by_per" />
              </band>
            </band>
            <band title="Освоение">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="kap_sum_fact_by_per" />
              </band>
              <band title="c НДС">
                <column title="[Период]" dimension="period" name="kap_sum_nds_fact_by_per" />
              </band>
            </band>
            <band title="Ввод">
              <band title="без НДС">
                <column title="[Период]" dimension="period" name="vvod_sum_fact_by_per" />
              </band>
            </band>
          </band>
          <band title="На конец периода">
            <band title="Финансирование">
              <column title="без НДС" name="fp_sum_fact_end" />
              <column title="НДС" name="fp_nds_fact_end" />
              <column title="c НДС" name="fp_sum_nds_fact_end" />
            </band>
            <band title="Освоение">
              <column title="без НДС" name="kap_sum_fact_end" />
              <column title="НДС" name="kap_nds_fact_end" />
              <column title="c НДС" name="kap_sum_nds_fact_end" />
            </band>
            <band title="Ввод">
              <column title="без НДС" name="vvod_sum_fact_end" />
            </band>
            <band title="ДЗ">
              <column title="с НДС" name="debet_fact_itog_end" />
            </band>
            <band title="KЗ">
              <column title="с НДС" name="kredit_fact_itog_end" />
            </band>
            <band title="НЗС">
              <column title="без НДС" name="nzs_fact_itog_end" />
            </band>
          </band>
        </band>
      </columns>
      <columnspreset />
      <select>
        <column table="ym" column="name" group="1" as="ym" />
        <column table="kod_smet" column="name" group="1" as="smet_name" />
        <column table="kod_smet" column="kod_smet" group="1" as="smet_num" />
        <column table="kodzatrat" column="abbr" group="1" as="vidzatrat_abbr" />
        <column table="kodzatrat" column="name" group="1" as="vidzatrat_name" />
        <column table="kod_doc_osn" column="full_name" title="Год ИПР/Документ" group="1" as="doc_osn_fname" />
        <column table="kod_priority" column="name" group="1" as="priority_name" />
        <column table="kod_subject" column="name" group="1" as="subject_name" />
        <column table="kod_subject" column="abbr" group="1" as="subject_abbr" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" group="1" />
        <column table="kod_direct" column="name" as="direct_name" group="1" />
        <column table="kod_titul_ip" column="tit_num_new" group="1" />
        <column table="kod_titul_ip" column="full_name" group="1" as="tit_name" />
        <column table="kod_parent" column="tit_num_new" as="parent_tit_num_new" group="1" />
        <column table="kod_parent" column="full_name" group="1" as="parent_tit_name" />
        <column table="kod_main_titul" column="tit_num_new" as="main_tit_num_new" group="1" />
        <column table="kod_main_titul" column="full_name" group="1" as="main_tit_name" />
        <column table="kod_child_titul" column="tit_num_new" as="child_tit_num_new" group="1" />
        <column table="kod_child_titul" column="full_name" group="1" as="child_tit_name" />
        <column table="kod_parent_sbor" column="tit_num_new" group="1" as="sbor_tit_num_new" />
        <column table="kod_parent_sbor" column="full_name" group="1" as="sbor_tit_name" />
        <column table="razdel_root" column="full_name" as="razdel_root_fname" group="1" title="{+} первого уровня" />
        <column table="kod_razdel" column="full_name" as="razdel_fname" group="1" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="period">
          <if pfx="_per">
            <call function="and">
              <call function="true" />
              <call function="ge" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym1" />
              </call>
              <call function="le" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym2" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="beg">
          <if pfx="_beg">
            <call function="or">
              <call function="false" />
              <call function="lt" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym1" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum" group="sum" if="end">
          <if pfx="_end">
            <call function="or">
              <call function="false" />
              <call function="le" optional="1">
                <column table="ipr_fin_body_united" column="ym" />
                <useparam name="ym2" />
              </call>
            </call>
          </if>
        </column>
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="debet_itog" group="sum" as="debet_itog_beg" title="{+} на начало периода" if="beg_sect">
          <section>
            <call function="ym2 add month">
              <call function="nvlu">
                <useparam name="ym1" />
                <call function="nativity_ym2" />
              </call>
              <const>-1</const>
            </call>
          </section>
        </column>
        <column table="ipr_fin_body_united" column="kredit_itog" group="sum" as="kredit_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="nzs_itog" group="sum" as="nzs_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="debet_itog" group="sum" as="debet_itog_end" title="{+} на конец периода" if="end_sect">
          <section>
            <call function="nvlu">
              <useparam name="ym2" />
              <call function="doomsday_ym2" />
            </call>
          </section>
        </column>
        <column table="ipr_fin_body_united" column="kredit_itog" group="sum" as="kredit_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="nzs_itog" group="sum" as="nzs_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kap_sum_nds" group="sum" dimname="period">
          <pivot title=" по периодам" pfx="_by_per">
            <call function="between">
              <column table="ipr_fin_body_united" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="kod" />
                <column table="a" column="full_name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="ipr_time_intervals" as="a">
                  <withparams>
                    <useparam name="ym1" />
                    <useparam name="ym2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="or">
                  <call function="false" />
                  <call function="in" optional="1">
                    <column table="a" column="kod" />
                    <useparam name="time_interval" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="ipr_fin_body_united" column="kap_sum" group="sum" dimname="period">
          <pivot title=" по периодам" pfx="_by_per">
            <call function="between">
              <column table="ipr_fin_body_united" column="ym" />
              <column table="dim" column="ym1" />
              <column table="dim" column="ym2" />
            </call>
            <query>
              <select>
                <column table="a" column="kod" />
                <column table="a" column="full_name" />
                <call function="date to ym2" as="ym1">
                  <column table="a" column="date_begin" />
                </call>
                <call function="date to ym2" as="ym2">
                  <column table="a" column="date_end" />
                </call>
              </select>
              <from>
                <query name="ipr_time_intervals" as="a">
                  <withparams>
                    <useparam name="ym1" />
                    <useparam name="ym2" />
                  </withparams>
                </query>
              </from>
              <where>
                <call function="or">
                  <call function="false" />
                  <call function="in" optional="1">
                    <column table="a" column="kod" />
                    <useparam name="time_interval" />
                  </call>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <column table="ipr_fin_body_united" column="fp_sum_nds" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_nds" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="vvod_sum" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="period" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="beg" />
        <column table="ipr_fin_body_united" column="fp_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" if="end" />
        <column table="ipr_fin_body_united" column="debet_fact_itog" group="sum" as="debet_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="kredit_fact_itog" group="sum" as="kredit_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="nzs_fact_itog" group="sum" as="nzs_fact_itog_beg" title="{+} на начало периода" if="beg_sect" />
        <column table="ipr_fin_body_united" column="debet_fact_itog" group="sum" as="debet_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kredit_fact_itog" group="sum" as="kredit_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="nzs_fact_itog" group="sum" as="nzs_fact_itog_end" title="{+} на конец периода" if="end_sect" />
        <column table="ipr_fin_body_united" column="kap_sum_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="kap_sum_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_sum_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="fp_nds_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="vvod_sum_fact" group="sum" dimname="period" />
        <column table="ipr_fin_body_united" column="summ_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_utvpsd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_utvpsd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_30" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_10" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_30" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_10" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_nds_usr" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_utvpsd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_utvpsd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_30_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_10_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_psd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_30_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_10_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_nds_psd_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_30_nds_usr_tek" group="sum" />
        <column table="ipr_fin_body_united" column="summ_10_nds_usr_tek" group="sum" />
      </select>
      <from>
        <query name="ipr_fin_body_united">
          <extendwhere>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_doc_osn" />
                <useparam name="doc_osn" />
              </call>
              <call function="in" optional="1">
                <column table="*" column="kod_ipr" />
                <useparam name="kod_ipr_simple" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_parent" />
                <useparam name="kod_titul_ip_head" />
              </call>
              <call function="in" optional="1" selective="1">
                <column table="kod_titul_ip1" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in" optional="1" selective="1">
                <column table="kod_titul_ip1" column="kod_ispolnit" />
                <useparam name="kod_ispolnit" />
              </call>
              <call function="or" optional="1" selective="1">
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_direct" />
                  <useparam name="kod_dir_or_isp" />
                </call>
                <call function="in">
                  <column table="kod_titul_ip1" column="kod_ispolnit" />
                  <useparam name="kod_dir_or_isp" />
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_main_titul1" column="kod_subject" />
                <useparam name="kod_subject" />
              </call>
              <call function="in" optional="1">
                <column table="kod_ipr" column="kod_priority" />
                <useparam name="kod_priority" />
              </call>
              <call function="in" optional="1" exclude="1">
                <column table="*" column="kod_sbor_titul" />
                <useparam name="kod_titul_ip_sbor" />
              </call>
              <call function="le" optional="1" selective="1" exclude="1">
                <column table="*" column="ym" />
                <useparam name="ym2" />
              </call>
              <call function="ge" optional="1" selective="1" exclude="1">
                <column table="*" column="ym" />
                <useparam name="ym1" />
              </call>
            </call>
          </extendwhere>
          <link name="kod_titul_ip">
            <link name="kod_ispolnit" />
            <link name="kod_direct" />
          </link>
          <link name="kod_ipr">
            <link name="kod_doc_osn" />
            <link name="kod_parent" />
            <link name="kod_main_titul">
              <link name="kod_razdel">
                <link name="kod_root" as="razdel_root" />
              </link>
              <link name="kod_parent_sbor" />
              <link name="kod_subject" />
            </link>
            <link name="kod_child_titul" />
            <link name="kod_priority" />
          </link>
          <link name="ym" />
          <link name="kod_smet" />
          <link name="kodzatrat" />
        </query>
      </from>
      <where exclude="1">
        <call function="and">
          <call function="true" />
          <call function="ge" optional="1" exclude="1">
            <column table="ipr_fin_body_united" column="ym" />
            <useparam name="ym1" />
          </call>
          <call function="le" optional="1" exclude="1">
            <column table="ipr_fin_body_united" column="ym" />
            <useparam name="ym2" />
          </call>
          <call function="ge" optional="1">
            <call function="nvl">
              <column table="ipr_fin_body_united" column="ym_nxt" />
              <useparam name="ym1" />
            </call>
            <useparam name="ym1" />
          </call>
        </call>
      </where>
    </query>
    <query name="ipr_time_intervals">
      <params>
        <param name="ym1" type="number">
          <const>201404</const>
        </param>
        <param name="ym2" type="number">
          <const>201510</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod" />
        <column table="a" column="full_name" />
        <column table="a" column="kod_parent" />
        <column table="a" column="time_type" />
        <column table="a" column="in_year_id" />
        <!--<column table="a" column="period_id"/>-->
        <column table="a" column="date_begin" />
        <column table="a" column="date_end" />
      </select>
      <from>
        <query name="spr_time_intervals1" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="ge">
            <call function="date to ym2">
              <column table="a" column="date_begin" />
            </call>
            <useparam name="ym1" />
          </call>
          <call function="le">
            <call function="date to ym2">
              <column table="a" column="date_end" />
            </call>
            <useparam name="ym2" />
          </call>
        </call>
      </where>
    </query>
  </queries>
  <forms>
    <form name="frm_generator_ipr" with-behavior="0" timestamp="12.05.2017 19:46:34">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_doc_osn_list" />
        <fieldgroup title="Отчетный период">
          <usefield field="ipr_ym" name="ym1" title="С" />
          <usefield field="ipr_ym" name="ym2" title="По" />
          <usefield field="ipr_time_interval" />
        </fieldgroup>
        <fieldgroup title="Подразделение">
          <usefield field="ipr_kod_direct" title="Подразделение исполнителя" name="kod_ispolnit" />
          <usefield field="ipr_kod_direct" title="Подразделение заказчика" />
          <usefield field="ipr_kod_direct" title="Подразделение" name="kod_dir_or_isp" />
        </fieldgroup>
        <fieldgroup title="Титул">
          <usefield field="ipr_titul_ip_sbor" />
          <usefield field="ipr_titul_ip_head" />
          <usefield field="ipr_ipr_data_simple" />
          <usefield field="ipr_subject" />
          <usefield field="ipr_priority" />
        </fieldgroup>
      </content>
    </form>
  </forms>
</root>