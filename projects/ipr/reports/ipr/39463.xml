<?xml version="1.0" encoding="utf-8"?>
<root>
  <parts>
    <part id="39463-fields1" timestamp="22.05.2018 18:51:25" comment="41356(3)">
      <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_params_visible">
        <defaultquery>
          <query name="39463-kod-doc-corr-visible" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" title="Горизонт планирования N+" name="goriz_plan" max-length="2" column-mandatory="1">
        <defaultquery>
          <query name="39463-goriz_plan-default" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_combo_num" name="god_info" title="Год Х раскрытия информации" column-mandatory="1">
        <listquery>
          <query name="39463-years-list" />
        </listquery>
        <defaultquery>
          <query name="39463-ipr-year" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_integer" title="Кол-во лет, от года Х для поквартального раскрытия информации" name="god_x" max-length="2" column-mandatory="0">
        <defaultquery>
          <query name="39463-god_x-default" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_combo_num" name="god_last_ipr" title="Последний год утвержденной ИПР" column-mandatory="1">
        <listquery>
          <query name="39463-years-list" />
        </listquery>
        <defaultquery>
          <query name="39463-ipr-year" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" visible="1" />
      <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов вместо Факта" visible="kod_doc_corr_visible" visible-invert="1" />
      <usefield field="cmn_check" title="Использование Лимитов и Приростов физ. характеристик вместо Плана" name="use_fiz_limits" visible="1">
        <defaultquery>
          <query name="one" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_check" name="use_fiz_limits_ft" title="Использование Лимитов и Приростов физ. характеристик вместо Факта" visible="kod_doc_corr_visible" visible-invert="1" />
      <usefield field="cmn_check" title="Расшифровка источников финансирования (графы 3-7,9-12,14-17) раздела 6.2." name="rassh_ist_fin62" />
      <usefield field="cmn_check" title="Расшифровка видов затрат освоения КВЛ (графы 3-7,9-12,14-17) раздела 6.2." name="rassh_vid_zatr62" />
      <fieldgroup title="Не формировать паспорта ИП с нулевыми данными">
        <usefield field="cmn_check" name="pr_not_null" title="Применить" />
        <usefield field="ipr_ym" name="not_null_ym1" title="С" mandatory="pr_not_null" editable="pr_not_null">
          <defaultquery>
            <query name="spr_time_ym2_beg_year" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_ym" name="not_null_ym2" title="По" mandatory="pr_not_null" editable="pr_not_null">
          <defaultquery>
            <query name="spr_time_ym2_cur" />
          </defaultquery>
        </usefield>
      </fieldgroup>
      <usefield field="cmn_check" title="Не выводить букву в наименовании Паспорта ИП" name="pasp_hide_letter" />
    </part>
  </parts>
  <queries>
    <query name="39463" timestamp="03.05.2018 15:16:51" is-report="1" with-behavior="1" title="Коды титулов по условиям" visible="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" visible="0" />
        </fieldgroup>
        <usefield field="cmn_combo_num" name="god_info" title="Год Х раскрытия информации" column-mandatory="1">
          <listquery>
            <query name="39463-years-list" />
          </listquery>
          <defaultquery>
            <query name="39463-ipr-year" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов вместо Факта" />
        <usefield field="cmn_check" title="Использование Лимитов и Приростов физ. характеристик вместо Плана" name="use_fiz_limits">
          <defaultquery>
            <query name="one" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="use_fiz_limits_ft" title="Использование Лимитов и Приростов физ. характеристик вместо Факта" />
        <fieldgroup title="Не формировать паспорта ИП с нулевыми данными">
          <usefield field="cmn_check" name="pr_not_null" title="Применить" />
          <usefield field="ipr_ym" name="not_null_ym1" title="С" mandatory="pr_not_null" editable="pr_not_null">
            <defaultquery>
              <query name="spr_time_ym2_beg_year" />
            </defaultquery>
          </usefield>
          <usefield field="ipr_ym" name="not_null_ym2" title="По" mandatory="pr_not_null" editable="pr_not_null">
            <defaultquery>
              <query name="spr_time_ym2_cur" />
            </defaultquery>
          </usefield>
        </fieldgroup>
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=0">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_sbor_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_main_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-1" timestamp="26.04.2018 21:41:06" is-report="1" with-behavior="1" title="Коды титулов по условиям 2" visible="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev">
              <withparams>
                <useparam name="kod_doc" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" />
          <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
          <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
            <defaultquery>
              <query name="39463-doc-type-default" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_check" title="Заполнить поле &quot;Текущая стадия реализации ИП&quot;" name="fill_cur_stage_ip" />
        </fieldgroup>
        <usefield field="cmn_check" name="output_xml" title="Вывод отчёта в хml-формате" column-editable="0" />
        <usefield field="cmn_check" name="replace_existed" title="Заменить существующие" />
        <usefield field="ipr_passport_doc_control" />
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" visible="kod_doc_kontr" visible-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=0">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="or" optional="1">
              <call function="in">
                <column table="kod_sbor_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_main_titul" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
              <call function="in">
                <column table="kod_titul_ip" column="kod_titul_ip" />
                <useparam name="kod_titul_ip" />
              </call>
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-data-for-report">
      <select>
        <column table="a" column="kod" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="39463-data-for-report" as="a" view="1" />
      </from>
    </query>
    <query name="39463-kod-doc-corr-visible">
      <params>
        <param name="data_for_report" type="number" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="=">
            <useparam name="data_for_report" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-doc-type-default">
      <params>
        <param name="data_for_report" type="number" />
      </params>
      <select>
        <call function="case" as="val" type="number">
          <call function="when">
            <call function="=">
              <useparam name="data_for_report" />
              <const>1</const>
            </call>
            <const>470</const>
          </call>
          <call function="when">
            <call function="=">
              <useparam name="data_for_report" />
              <const>2</const>
            </call>
            <const>902</const>
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-ipr-year-message" timestamp="13.10.2017 14:57:50">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <call function="||" as="val" type="string">
          <const>'Год N = году ИПР '</const>
          <call function="to_char">
            <column table="a" column="god_ip" />
          </call>
        </call>
      </select>
      <from>
        <table name="ipr_doc" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-data-for-report-default">
      <select>
        <const type="number" as="val">1</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-2" timestamp="08.11.2018 19:21:10" is-report="1" with-behavior="1" title="Паспорт ИП" visible="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
        <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
          <defaultquery>
            <query name="39463-doc-type-default" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" editable="kod_doc_kontr" visible="1" editable-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="dual" column="dummy" />
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="39463-ipr-year" timestamp="16.10.2017 16:41:53">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <column table="a" column="god_ip" as="val" />
      </select>
      <from>
        <table name="ipr_doc" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-years-list" timestamp="13.10.2017 15:32:00" order="god desc">
      <select>
        <column table="a" column="god" key="1" />
        <call function="to_char" as="name" title="Год">
          <column table="a" column="god" />
        </call>
      </select>
      <from>
        <query name="is_god" as="a" />
      </from>
      <where>
        <call function="lt">
          <column table="a" column="god" />
          <const>3000</const>
        </call>
      </where>
    </query>
    <query name="39463-goriz_plan-default" timestamp="11.12.2017 15:20:49">
      <select>
        <const type="number" as="val">5</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-3" timestamp="26.04.2018 21:41:06" is-report="1" with-behavior="1" title="Коды титулов по условиям 3" visible="0" comment="41356(14)">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="cmn_string" name="ipr_year_message" column-editable="0" show-checkbox="0">
          <defaultquery>
            <query name="39463-ipr-year-message" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_doc" column-mandatory="1" />
        <usefield field="ipr_kod_direct" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" />
        <usefield field="ipr_subject" />
        <usefield field="ipr_titul_ip_head" name="kod_titul_ip" />
        <usefield field="ipr_status_tit" />
        <usefield field="ipr_kod_ofz" />
        <usefield field="ipr_pr_notaip" />
        <field name="kod_klass_titul" controlType="UIList" title="Принадлежность к важн. объектам, программам" parent-field-name="kod_parent" expand-all="1" auto-check="1" type="number">
          <listquery>
            <query name="ips_klass_titul_tree" />
          </listquery>
          <defaultquery>
            <query name="ips_klass_titul_tree_def" />
          </defaultquery>
        </field>
        <usefield field="cmn_check" name="pr_rasch" title="Только с признаком &quot;Готовность к расчёту&quot;" />
        <usefield field="cmn_check" name="pr_limit" title="Использование Лимитов вместо Плана" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_ft" title="Использование Лимитов по Факту вместо Факта" exclude="1" />
        <usefield field="cmn_check" name="pr_limit_fiz_ft" title="Использование Лимитов и Приростов физ. характеристик по Факту вместо Факта" exclude="1" />
        <field name="data_for_report" controlType="UICombo" title="Данные в отчёт" type="number" column-mandatory="1">
          <listquery>
            <query name="39463-data-for-report" />
          </listquery>
          <defaultquery>
            <query name="39463-data-for-report-default" />
          </defaultquery>
        </field>
        <usefield field="ipr_kod_doc" name="kod_doc_corr" title="Документ, предшествующий кор." visible="kod_doc_corr_visible" mandatory="kod_doc_corr_visible">
          <defaultquery>
            <query name="ipr_doc_main_prev">
              <withparams>
                <useparam name="kod_doc" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" column-visible="0" name="kod_doc_corr_visible">
          <defaultquery>
            <query name="39463-kod-doc-corr-visible" />
          </defaultquery>
        </usefield>
        <fieldgroup title="Настройки расчёта">
          <usefield field="ipr_kod_doc_e_ef" column-mandatory="1" />
          <usefield field="cmn_date_cur" title="Дата расчёта" name="date_calc" column-mandatory="1" />
          <usefield field="cmn_check" title="Заполнить поле 23" name="fill_f23" />
          <usefield field="cmn_check" name="create_doc" title="Сформировать документ" />
          <usefield field="ipr_doc_type_single" visible="create_doc" column-mandatory="1">
            <defaultquery>
              <query name="39463-doc-type-default" />
            </defaultquery>
          </usefield>
          <usefield field="cmn_check" title="Заполнить поле &quot;Текущая стадия реализации ИП&quot;" name="fill_cur_stage_ip" />
        </fieldgroup>
        <usefield field="cmn_check" name="output_xml" title="Вывод отчёта в хml-формате" column-editable="0" />
        <usefield field="cmn_check" name="replace_existed" title="Заменить существующие" />
        <usefield field="ipr_passport_doc_control" />
        <fieldgroup title="Контрольные этапы">
          <field name="kod_doc_kontr" controlType="UIList" title="Документ-основание (если не задан, берется последний)" type="number">
            <listquery>
              <query name="ipr_doc_kontr_list" />
            </listquery>
          </field>
          <field name="date" controlType="UIDate" title="Документ-основание на дату" type="date" column-mandatory="1" visible="kod_doc_kontr" visible-invert="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
          <field name="datef" controlType="UIDate" title="Фактические данные на дату" type="date" column-mandatory="1">
            <defaultquery>
              <query name="30581-date-def" />
            </defaultquery>
          </field>
        </fieldgroup>
        <usepart part="39463-fields1" />
      </content>
      <select>
        <column table="kod_ipr" column="kod_ipr" title="kod_ipr " />
        <column table="kod_ipr" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <qube>
          <link name="kod_ipr" all-rows="1">
            <link name="kod_main_titul">
              <link name="kod_sbor_titul" />
            </link>
            <link name="kod_titul_ip">
              <link name="kod_ispolnit" />
              <link name="pr_ofz" />
            </link>
            <link name="kod_main_ipr_ipr_data" />
          </link>
          <link name="kod_report_dop" only-for-cond="1" />
          <where>
            <call function="=">
              <column table="kod_ipr" column="kod_doc_osn" />
              <useparam name="kod_doc" />
            </call>
            <call function="=1">
              <column table="kod_titul_ip" column="is_head_tit" />
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_titul_ip" />
              <useparam name="kod_titul_ip" />
            </call>
            <call function="or" optional="1">
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_ispolnit" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,3</array>
                </call>
              </call>
              <call function="and">
                <call function="in">
                  <column table="kod_titul_ip" column="kod_direct" />
                  <useparam name="kod_direct" />
                </call>
                <call function="in">
                  <useparam name="kod_dirisp" />
                  <array>1,2</array>
                </call>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_titul" column="kod_subject" />
              <useparam name="kod_subject" />
            </call>
            <call function="not" optional="1">
              <call function="=">
                <column table="kod_titul_ip" column="kod_aip" />
                <useparam name="pr_notaip" />
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_titul_ip" column="pr_ofz" />
              <useparam name="kod_ofz" />
            </call>
            <call function="and" optional="1">
              <call function="=">
                <call function="nvl0">
                  <column column="val" table="kod_report_dop" />
                </call>
                <useparam name="pr_rasch">1</useparam>
              </call>
              <call function="=">
                <column table="kod_report_dop" column="kod_doc" />
                <useparam name="kod_doc_e_ef" />
              </call>
              <call function="=">
                <column table="kod_report_dop" column="name" />
                <const type="string">'TABL15_P1_1'</const>
              </call>
            </call>
            <call function="in" optional="1">
              <column table="kod_main_ipr_ipr_data" column="kod_klass" />
              <useparam name="kod_klass_titul" />
            </call>
            <call function="in" optional="1">
              <column table="kod_ipr" column="kod_status" />
              <useparam name="kod_status_tit" />
            </call>
          </where>
        </qube>
      </from>
    </query>
    <query name="39463-god_x-default" timestamp="11.12.2017 15:22:36">
      <select>
        <const type="number" as="val">0</const>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="39463-4" timestamp="25.02.2019 13:56:25" is-report="1" with-behavior="1" title="Массовое копирование титулов" visible="0">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="ipr_kod_doc_new" column-mandatory="1" title="Версия ИПР (источник данных) " />
        <usefield field="ipr_kod_doc_new" column-mandatory="1" title="Версия ИПР (получатель данных)" name="kod_doc_target">
          <listquery>
            <query name="39463-ipr_version_adv" />
          </listquery>
          <defaultquery>
            <query name="39463-ipr_version_project" />
          </defaultquery>
        </usefield>
        <usefield field="ipr_kod_direct" title="Подразделение (источник данных)" />
        <usefield name="kod_dirisp" field="ipr_kod_dirisp_all" title="Заказчик/Исполнитель (источник данных)">
          <defaultquery>
            <query name="is_spr_dirisp_isp_1" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_str" title="Статус титула (получатель данных)" name="kod_status_tit" type="number">
          <listquery>
            <query name="ipv_status_tit" />
          </listquery>
        </usefield>
        <usefield field="cmn_check" name="only_aip_flag" title="Только титулы АИП" type="number" />
        <usefield field="ipr_kod_titul_ip_plain" />
      </content>
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" title="kod_ipr " />
        <column table="ipr_ipr_data" column="kod_titul_ip" title="kod_titul_ip " />
      </select>
      <from>
        <query name="ipr_ipr_data">
          <link name="kod_titul_ip">
            <link name="kod_direct" exclude="1" />
            <link name="kod_ispolnit" exclude="1" />
            <link name="kod_subject" as="kod_subject1" exclude="1" />
          </link>
          <link name="kod_razdel" exclude="1" />
          <link name="kod_parent" exclude="1">
            <link name="kod_parent_sbor" />
          </link>
          <link name="kod_main_titul" exclude="1">
            <link name="kod_subject" />
          </link>
        </query>
        <query name="ipr_ipr_data" as="ipr_ipr_data_target" join="left outer">
          <call function="and">
            <call function="=">
              <column table="ipr_ipr_data" column="kod_titul_ip" />
              <column table="ipr_ipr_data_target" column="kod_titul_ip" />
            </call>
            <call function="=">
              <column table="ipr_ipr_data_target" column="kod_doc_osn" />
              <useparam name="kod_doc_target" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in" optional="1">
            <column table="ipr_ipr_data" column="kod_ipr" />
            <useparam name="kod_titul_ip" />
          </call>
          <call function="!=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Сборный'</const>
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=" optional="1">
            <column table="kod_titul_ip" column="kod_aip" />
            <useparam name="only_aip_flag" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
          </call>
          <call function="is null">
            <column table="ipr_ipr_data_target" column="kod_ipr" />
          </call>
        </call>
      </where>
    </query>
    <query name="39463-ipr_version" timestamp="17.09.2018 17:44:24">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
        <column table="ipv_ipr_version" column="full_name" vid="1" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
    </query>
    <query name="39463-ipr_version_active" timestamp="17.09.2018 17:51:47">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipv_ipr_version" column="status_name" />
            <const>'Утвержденная ИПР'</const>
          </call>
          <call function="=">
            <call function="rownum" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="39463-ipr_version_adv" timestamp="17.09.2018 18:00:57">
      <params>
        <param name="kod_doc" type="number" />
      </params>
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
        <column table="ipv_ipr_version" column="full_name" vid="1" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="!=">
          <column table="ipv_ipr_version" column="kod_doc" />
          <useparam name="kod_doc" />
        </call>
      </where>
    </query>
    <query name="39463-ipr_version_project" timestamp="17.09.2018 18:03:20">
      <select>
        <column table="ipv_ipr_version" column="kod_doc" />
      </select>
      <from>
        <query name="ipv_ipr_version" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="ipv_ipr_version" column="status_name" />
            <const>'Проект'</const>
          </call>
          <call function="=">
            <call function="rownum" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="39463-tituls_plain" timestamp="25.02.2019 13:56:25" with-behavior="1" visible="0">
      <params>
        <param name="kod_doc" type="number">
          <const>143403</const>
        </param>
        <param name="kod_doc_target" type="number" />
        <param name="kod_direct" type="array" />
        <param name="kod_dirisp" type="number" />
        <param name="only_aip_flag" type="number" />
      </params>
      <select>
        <column table="ipr_ipr_data" column="kod_ipr" />
        <column table="kod_titul_ip" column="tit_num_new" title="Код титула" />
        <column table="ipr_ipr_data" column="name" />
        <call function="if" as="itip" vid="1" title="Тип" type="string">
          <call function="=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Одиночный/Дочерний'</const>
          </call>
          <call function="if">
            <call function="gt">
              <column table="ipr_ipr_data" column="kod_parent" />
              <const>0</const>
            </call>
            <const>'Дочерний'</const>
            <const>'Одиночный'</const>
          </call>
          <column table="kod_titul_ip" column="itip" />
        </call>
        <column table="kod_direct" column="name" as="direct_name" title="Подразделение заказчика" />
        <column table="kod_ispolnit" column="name" as="ispolnit_name" title="Подразделение исполнителя" />
        <call function="nvl" type="string" as="subject_name">
          <column table="kod_subject" column="name" as="subject_name" />
          <column table="kod_subject1" column="name" as="subject_name" />
        </call>
        <column table="kod_parent" column="tit_num_new" title="Код головного титула" as="tit_num_new_h" />
        <column table="kod_parent_sbor" column="tit_num_new" title="Код сборного титула" as="tit_num_new_s" />
        <column table="ipr_ipr_data_target" column="kod_ipr" as="kod_ipr_t" title="kod_ipr_tqqq" exclude="1" />
      </select>
      <from>
        <query name="ipr_ipr_data">
          <link name="kod_titul_ip">
            <link name="kod_direct" />
            <link name="kod_ispolnit" />
            <link name="kod_subject" as="kod_subject1" />
          </link>
          <link name="kod_razdel" />
          <link name="kod_parent">
            <link name="kod_parent_sbor" />
          </link>
          <link name="kod_main_titul">
            <link name="kod_subject" />
          </link>
        </query>
        <query name="ipr_ipr_data" as="ipr_ipr_data_target" join="left outer">
          <call function="and">
            <call function="=">
              <column table="ipr_ipr_data" column="kod_titul_ip" />
              <column table="ipr_ipr_data_target" column="kod_titul_ip" />
            </call>
            <call function="=">
              <column table="ipr_ipr_data_target" column="kod_doc_osn" />
              <useparam name="kod_doc_target" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=">
            <column table="kod_titul_ip" column="itip" />
            <const>'Сборный'</const>
          </call>
          <call function="=">
            <column table="ipr_ipr_data" column="kod_doc_osn" />
            <useparam name="kod_doc" />
          </call>
          <call function="=" optional="1">
            <column table="kod_titul_ip" column="kod_aip" />
            <useparam name="only_aip_flag" />
          </call>
          <call function="or" optional="1">
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_ispolnit" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,3</array>
              </call>
            </call>
            <call function="and">
              <call function="in">
                <column table="kod_titul_ip" column="kod_direct" />
                <useparam name="kod_direct" />
              </call>
              <call function="in">
                <useparam name="kod_dirisp" />
                <array>1,2</array>
              </call>
            </call>
          </call>
          <call function="is null">
            <column table="ipr_ipr_data_target" column="kod_ipr" />
          </call>
        </call>
      </where>
    </query>
  </queries>
  <views>
    <view name="39463-data-for-report">
      select 1 as kod, 'План + Коррект.плана' as name from dual
      union all
      select 2, 'План + Факт' from dual
    </view>
  </views>
</root>