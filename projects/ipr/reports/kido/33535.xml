<?xml version="1.0" encoding="utf-8"?>
<root>
  <parts>
    <part id="33535-params">
      <param name="year">
        <const>2014</const>
      </param>
    </part>
    <part id="33535-useparams">
      <useparam name="year" />
    </part>
  </parts>
  <forms>
    <form name="33535" with-behavior="0" timestamp="21.11.2016 14:27:52">
      <customers>
        <customer id="17" />
      </customers>
      <content>
        <usefield field="asuse_year" name="year" title="Отчётный год" />
      </content>
    </form>
  </forms>
  <reports>
    <report name="33535" title="Форма 2 (Старая)" form="33535" folder="forms_tp" timestamp="02.06.2017 16:14:30" nogrid="1" visible="0">
      <customers>
        <customer id="17" />
      </customers>
      <params>
        <usepart part="33535-params" />
      </params>
      <print-templates>
        <excel>
          <template name="33535.xml" title="Форма 2" print-proc="2" />
        </excel>
      </print-templates>
      <queries>
        <query name="33535-title" as="m" title="Шапка">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
        </query>
        <query name="33535" as="a" title="Данные" main="1">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
          <!--<columns>
            <column table="a" name="grsetid"/>
            <column table="a" name="parent_growid"/>
            <band title ="Действующие  договоры на начало">
              <band title ="ВСЕГО">
                <column table="a" name="power2_7_sum" type="number" title="кВт"/>
                <column table="a" name="col2_7_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество поданных заявок на ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power8_19_sum" type="number" title="кВт"/>
                <column table="a" name="col8_19_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество направленных проектов договоров ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power20_25_sum" type="number" title="кВт"/>
                <column table="a" name="col20_25_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power26_31_sum" type="number" title="кВт"/>
                <column table="a" name="col26_31_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Количество направленных проектов договоров ТП за отчетный период с нарушением установленных сроков направления">
              <column table="a" name="power32_33_sum" type="number" title="кВт"/>
              <column table="a" name="col32_33_count" type="number" title="шт"/>
            </band>
            <band title ="Фактическая длительность рассмотрения заявки ТП &quot;заявка-оферта&quot; по офертам, направленным в отчетном периоде">
              <column table="a" name="col34_count" type="number" title="суммарное количество дней"/>
            </band>
            <band title ="Заявки, аннулированные за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power35_36_sum" type="number" title="кВт"/>
                <column table="a" name="col35_36_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по инициативе заявителя">
                <column table="a" name="power37_38_sum" type="number" title="кВт"/>
                <column table="a" name="col37_38_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Заключено договоров ТП за отчетный период по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power39_44_sum" type="number" title="кВт"/>
                <column table="a" name="col39_44_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power45_50_sum" type="number" title="кВт"/>
                <column table="a" name="col45_50_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 4 мес.для заявителей до 670 кВт или 1 год для заявителей свыше 670 кВт&quot;">
                <column table="a" name="power51_54_sum" type="number" title="кВт"/>
                <column table="a" name="col51_54_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 6 мес.&quot;">
                <column table="a" name="power55_58_sum" type="number" title="кВт"/>
                <column table="a" name="col55_58_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Заключено дополнительных соглашений за отчетный период на изменение запрашиваемой максимальной мощности по договорам ТП">
              <column table="a" name="power59_60_sum" type="number" title="кВт"/>
              <column table="a" name="col59_60_count" type="number" title="шт"/>
            </band>
            <band title ="Расторгнутые договоры ТП за отчетный период">
              <column table="a" name="power61_62_sum" type="number" title="кВт"/>
              <column table="a" name="col61_62_count" type="number" title="шт"/>
            </band>
            <band title ="Исполнено договоров ТП за отчетный период (подписанные акты ТП) по диапазонам напряжения U, кВ">
              <band title ="ВСЕГО">
                <column table="a" name="power63_68_sum" type="number" title="кВт"/>
                <column table="a" name="col63_68_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. по заявкам, поступившим  за отчетный период">
                <column table="a" name="power69_74_sum" type="number" title="кВт"/>
                <column table="a" name="col69_74_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 4 мес.для заявителей до 670 кВт или 1 год для заявителей свыше 670 кВт&quot;">
                <column table="a" name="power75_78_sum" type="number" title="кВт"/>
                <column table="a" name="col75_78_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. соответствующие критерию: &quot;срок исполнения договора 6 мес.&quot;">
                <column table="a" name="power79_82_sum" type="number" title="кВт"/>
                <column table="a" name="col79_82_count" type="number" title="шт"/>
              </band>
            </band>
            <band title ="Исполнено договоров ТП за отчетный период (подписанные акты ТП) с нарушением установленных сроков технологического присоединения">
              <column table="a" name="power83_84_sum" type="number" title="кВт"/>
              <column table="a" name="col83_84_count" type="number" title="шт"/>
            </band>
            <band title ="Общее количество дней на осуществление ТП по договорам ТП, исполненным за отчетный период &quot;заявка-акт&quot;">
              <column table="a" name="col85_count" type="number" title="суммарное количество дней"/>
            </band>
            <band title ="Фактическая длительность выполнения договора ТП по договорам ТП, исполненным за отчетный период &quot;договор-акт&quot;">
              <column table="a" name="col86_count" type="number" title="суммарное количество дней"/>
            </band>

            <band title ="Действующие договоры ТП на конец">
              <band title ="ВСЕГО">
                <column table="a" name="power89_94_sum" type="number" title="кВт"/>
                <column table="a" name="col89_94_count" type="number" title="шт"/>
              </band>
              <band title ="в т.ч. договоры, по которым не исполнены в срок обязательства по договору ТП на конец">
                <band title="ВСЕГО">
                  <column table="a" name="power95_96_sum" type="number" title="кВт"/>
                  <column table="a" name="col95_96_count" type="number" title="шт"/>
                </band>
              </band>
              <band title="Действующие договоры ТП на конец по типу тарифообразования">
                <band title="объем договоров, по ставке C1">
                  <column table="a" name="power99_100_sum" type="number" title="кВт"/>
                  <column table="a" name="col99_100_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по ставке за единицу максимальной мощности &quot;руб./кВт&quot;">
                  <column table="a" name="power101_102_sum" type="number" title="кВт"/>
                  <column table="a" name="col101_102_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по стандартизированным ставкам &quot;руб./км&quot;">
                  <column table="a" name="power103_104_sum" type="number" title="кВт"/>
                  <column table="a" name="col103_104_count" type="number" title="шт"/>
                </band>
                <band title="объем договоров, по индивидуальному тарифу">
                  <column table="a" name="power105_106_sum" type="number" title="кВт"/>
                  <column table="a" name="col105_106_count" type="number" title="шт"/>
                </band>
              </band>
              <band title="Действующие договоры ТП на конец по типу обязательств">
                <band title="объем договоров с затратами, выполняемых &quot;подрядным способом&quot;">
                  <column table="a" name="power109_110_sum" type="number" title="кВт"/>
                  <column table="a" name="col109_110_count" type="number" title="шт"/>
                </band>
              </band>
            </band>
          </columns>-->
        </query>
      </queries>
    </report>
  </reports>
  <queries>
    <query name="33535-title">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <call function="date to char" as="date_begin" title="Начальная отчётная дата">
          <call function="year begin time">
            <useparam name="year" />
          </call>
        </call>
        <call function="date to char" as="date_end" title="Начальная отчётная дата">
          <call function="year end time">
            <useparam name="year" />
          </call>
        </call>
      </select>
      <from>
        <table name="dual" as="a" />
      </from>
    </query>
    <query name="33535">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <column table="a" column="*" />
      </select>
      <from>
        <query name="33535-data" as="a">
          <withparams>
            <usepart part="33535-useparams" />
          </withparams>
          <grsets>
            <grset level="1" title="Субъект федерации" as="ro">
              <where>
                <call function="is not null">
                  <column table="a" column="ro" />
                </call>
              </where>
              <grset level="" title="до 15 кВт включительно, всего" as="ro_do15">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="в т.ч. физ.лица до 15 кВт включительно" as="ro_do15fiz">
                <where>
                  <call function="and">
                    <call function="=">
                      <column table="a" column="prizn_power" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="a" column="ur_lico" />
                      <const>0</const>
                    </call>
                  </call>
                </where>
              </grset>
              <grset level="" title="свыше 15 и до 150 кВт включительно" as="ro_ot15do150">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="свыше 150 кВт и менее 670 кВт" as="ro_ot150do670">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>3</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="не менее 670 кВт" as="ro_ot670">
                <where>
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>4</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="объекты по производству электрической энергии" as="ro_vrem2">
                <where>
                  <call function="=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>2</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="ВСЕГО без учета временного ТП" as="ro_novrem1">
                <where>
                  <call function="!=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <grset level="" title="временное технологическое присоединение" as="ro_vrem1">
                <where>
                  <call function="=">
                    <column table="a" column="fl_vrem_tp" />
                    <const>1</const>
                  </call>
                </where>
              </grset>
              <!--<grset level="" title="ВСЕГО с учетом временного ТП" as="ro_all"/>-->
              <grset level="" title="садоводческие, огороднические, дачные некоммерческие объединения и иные некоммерческие объединения" as="ro_garden">
                <where>
                  <call function="or">
                    <call function="=">
                      <column table="a" column="pr_garden_obj" />
                      <const>1</const>
                    </call>
                    <call function="=">
                      <column table="a" column="pr_nonprofit" />
                      <const>1</const>
                    </call>
                  </call>
                </where>
              </grset>
            </grset>
            <grset level="" title="до 15 кВт включительно, всего" as="do15">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="в т.ч. физ.лица до 15 кВт включительно" as="do15fiz">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="a" column="prizn_power" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="a" column="ur_lico" />
                    <const>0</const>
                  </call>
                </call>
              </where>
            </grset>
            <grset level="" title="свыше 15 и до 150 кВт включительно" as="ot15do150">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>2</const>
                </call>
              </where>
            </grset>
            <grset level="" title="свыше 150 кВт и менее 670 кВт" as="ot150do670">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>3</const>
                </call>
              </where>
            </grset>
            <grset level="" title="не менее 670 кВт" as="ot670">
              <where>
                <call function="=">
                  <column table="a" column="prizn_power" />
                  <const>4</const>
                </call>
              </where>
            </grset>
            <grset level="" title="объекты по производству электрической энергии" as="vrem2">
              <where>
                <call function="=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>2</const>
                </call>
              </where>
            </grset>
            <grset level="" title="ВСЕГО без учета временного ТП" as="novrem1">
              <where>
                <call function="!=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="временное технологическое присоединение" as="vrem1">
              <where>
                <call function="=">
                  <column table="a" column="fl_vrem_tp" />
                  <const>1</const>
                </call>
              </where>
            </grset>
            <grset level="" title="ВСЕГО с учетом временного ТП" as="all" />
            <grset level="" title="садоводческие, огороднические, дачные некоммерческие объединения и иные некоммерческие объединения" as="garden">
              <where>
                <call function="or">
                  <call function="=">
                    <column table="a" column="pr_garden_obj" />
                    <const>1</const>
                  </call>
                  <call function="=">
                    <column table="a" column="pr_nonprofit" />
                    <const>1</const>
                  </call>
                </call>
              </where>
            </grset>
          </grsets>
        </query>
      </from>
    </query>
    <query name="33535-data" grouplevel="no">
      <params>
        <usepart part="33535-params" />
      </params>
      <select>
        <call function="case" as="ro" type="number" group="1">
          <call function="when">
            <call function="=">
              <column table="a" column="kn_zone" />
              <const>0</const>
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="!=">
              <column table="a" column="kn_zone" />
              <const>0</const>
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="case" as="ro_name" type="string" group="max">
          <call function="when">
            <call function="=">
              <column table="this" column="ro" />
              <const>0</const>
            </call>
            <const>'Лененградская область'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="this" column="ro" />
              <const>1</const>
            </call>
            <const>'Санкт-Петербург'</const>
          </call>
        </call>
        <column table="a" column="isv_rep_ad_id" group="2" />
        <column table="a" column="ur_lico" group="2" />
        <column table="a" column="fl_vrem_tp" group="2" />
        <column table="a" column="pr_garden_obj" group="2" />
        <column table="a" column="pr_nonprofit" group="2" />
        <column table="a" column="sum_power" group="2" />
        <call function="case" as="prizn_power" group="2">
          <call function="when">
            <call function="le">
              <column table="a" column="sum_power" />
              <const>15</const>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="gt">
                <column table="a" column="sum_power" />
                <const>15</const>
              </call>
              <call function="le">
                <column table="a" column="sum_power" />
                <const>150</const>
              </call>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="and">
              <call function="gt">
                <column table="a" column="sum_power" />
                <const>150</const>
              </call>
              <call function="lt">
                <column table="a" column="sum_power" />
                <const>670</const>
              </call>
            </call>
            <const>3</const>
          </call>
          <call function="when">
            <call function="ge">
              <column table="a" column="sum_power" />
              <const>670</const>
            </call>
            <const>4</const>
          </call>
        </call>
        <call function="case" as="voltage_kod" type="number" group="2">
          <call function="when">
            <call function="=">
              <column table="a" column="voltage" />
              <const>'НН'</const>
            </call>
            <const>1</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="voltage" />
              <const>'СН2'</const>
            </call>
            <const>2</const>
          </call>
          <call function="when">
            <call function="in">
              <column table="a" column="voltage" />
              <array>
                <const>'СН1'</const>
                <const>'ВН'</const>
              </array>
            </call>
            <const>3</const>
          </call>
        </call>
        <call function="if" as="col2_7" group="2">
          <call function="and">
            <call function="lt">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
            </call>
            <call function="or">
              <call function="is null">
                <column table="a" column="srok_uslug" />
              </call>
              <call function="gt">
                <column table="a" column="srok_uslug" />
                <call function="year begin time">
                  <useparam name="year" />
                </call>
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col2_7" as="col2_7_count" type="number" dimname="volt" group="sumnvl" title="шт">
          <pivot title=" по уровням напряжения">
            <column table="this" column="voltage_kod" />
            <query order="kod">
              <select>
                <column table="a" column="kod" />
                <column table="a" column="title" />
              </select>
              <from>
                <query name="33535-voltage" as="a" />
              </from>
            </query>
          </pivot>
        </column>
        <call function="if" as="power2_7" group="2">
          <call function="=">
            <column table="this" column="col2_7" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power2_7" as="power2_7_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col8_19" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="date_coming" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col8_19" as="col8_19_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power8_19" group="2">
          <call function="=">
            <column table="this" column="col8_19" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power8_19" as="power8_19_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col20_25" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_project" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col20_25" as="col20_25_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power20_25" group="2">
          <call function="=">
            <column table="this" column="col20_25" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power20_25" as="power20_25_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col26_31" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col20_25" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col26_31" as="col26_31_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power26_31" group="2">
          <call function="=">
            <column table="this" column="col26_31" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power26_31" as="power26_31_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col32_33" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col20_25" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="proekttu_over" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col32_33" as="col32_33_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power32_33" group="2">
          <call function="=">
            <column table="this" column="col32_33" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power32_33" as="power32_33_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col34_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col20_25" />
            <const>1</const>
          </call>
          <column table="a" column="srok_project" />
        </call>
        <call function="if" as="col35_36" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="date_off" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="=">
              <column table="a" column="kn_st_req" />
              <const>1</const>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col35_36" as="col35_36_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power35_36" group="2">
          <call function="=">
            <column table="this" column="col35_36" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power35_36" as="power35_36_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col37_38" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col35_36" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="kn_off_reason" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col37_38" as="col37_38_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power37_38" group="2">
          <call function="=">
            <column table="this" column="col37_38" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power37_38" as="power37_38_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col39_44" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col39_44" as="col39_44_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power39_44" group="2">
          <call function="=">
            <column table="this" column="col39_44" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power39_44" as="power39_44_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col45_50" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col45_50" as="col45_50_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power45_50" group="2">
          <call function="=">
            <column table="this" column="col45_50" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power45_50" as="power45_50_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col51_54" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_51_54" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col51_54" as="col51_54_count" type="number" dimname="volt_s" group="sumnvl" title="шт">
          <pivot title=" по уровням напряжения">
            <column table="this" column="voltage_kod" />
            <query order="kod">
              <select>
                <column table="a" column="kod" />
                <column table="a" column="title" />
              </select>
              <from>
                <query name="33535-voltage" as="a" />
              </from>
              <where>
                <call function="in">
                  <column table="a" column="kod" />
                  <array>
                    <const>1</const>
                    <const>2</const>
                  </array>
                </call>
              </where>
            </query>
          </pivot>
        </column>
        <call function="if" as="power51_54" group="2">
          <call function="=">
            <column table="this" column="col51_54" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power51_54" as="power51_54_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col55_58" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col39_44" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_55_58" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col55_58" as="col55_58_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power55_58" group="2">
          <call function="=">
            <column table="this" column="col55_58" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power55_58" as="power55_58_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col59_60" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_contract" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="=">
              <column table="a" column="kod_vid_ds" />
              <const>14</const>
            </call>
            <call function="is not null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col59_60" as="col59_60_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power59_60" group="2">
          <call function="=">
            <column table="this" column="col59_60" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power59_60" as="power59_60_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col61_62" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dat_rastorg" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col61_62" as="col61_62_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power61_62" group="2">
          <call function="=">
            <column table="this" column="col61_62" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power61_62" as="power61_62_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col63_68" group="2">
          <call function="and">
            <call function="between">
              <column table="a" column="dt_akt" />
              <call function="year begin time">
                <useparam name="year" />
              </call>
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col63_68" as="col63_68_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power63_68" group="2">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power63_68" as="power63_68_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col69_74" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col8_19" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col69_74" as="col69_74_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power69_74" group="2">
          <call function="=">
            <column table="this" column="col69_74" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power69_74" as="power69_74_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col75_78" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col51_54" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col75_78" as="col75_78_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power75_78" group="2">
          <call function="=">
            <column table="this" column="col75_78" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power75_78" as="power75_78_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col79_82" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col55_58" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col79_82" as="col79_82_count" type="number" dimname="volt_s" group="sumnvl" title="шт" />
        <call function="if" as="power79_82" group="2">
          <call function="=">
            <column table="this" column="col79_82" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power79_82" as="power79_82_sum" dimname="volt_s" group="sumnvl" title="кВт" />
        <call function="if" as="col83_84" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col63_68" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="col_83_84" comment="колонка из БД!" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col83_84" as="col83_84_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power83_84" group="2">
          <call function="=">
            <column table="this" column="col83_84" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power83_84" as="power83_84_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col85_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="srok_project" />
        </call>
        <call function="if" as="col86_count" type="number" group="sumnvl" title="суммарное количество дней">
          <call function="=">
            <column table="this" column="col63_68" />
            <const>1</const>
          </call>
          <column table="a" column="col_86" />
        </call>
        <call function="if" as="col89_94" group="2">
          <call function="and">
            <call function="lt">
              <column table="a" column="dt_contract" />
              <call function="year end time">
                <useparam name="year" />
              </call>
            </call>
            <call function="or">
              <call function="is null">
                <column table="a" column="srok_uslug" />
              </call>
              <call function="gt">
                <column table="a" column="srok_uslug" />
                <call function="year end time">
                  <useparam name="year" />
                </call>
              </call>
            </call>
            <call function="is null">
              <column table="a" column="kn_contract_p" />
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col89_94" as="col89_94_count" type="number" dimname="volt" group="sumnvl" title="шт" />
        <call function="if" as="power89_94" group="2">
          <call function="=">
            <column table="this" column="col89_94" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power89_94" as="power89_94_sum" dimname="volt" group="sumnvl" title="кВт" />
        <call function="if" as="col95_96" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="or">
              <call function="gt">
                <column table="a" column="dt_akt" />
                <column table="a" column="srok_uslug" />
              </call>
              <call function="and">
                <call function="is null">
                  <column table="a" column="dt_akt" />
                </call>
                <call function="lt">
                  <column table="a" column="srok_uslug" />
                  <call function="year end time">
                    <useparam name="year" />
                  </call>
                </call>
              </call>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col95_96" as="col95_96_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power95_96" group="2">
          <call function="=">
            <column table="this" column="col95_96" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power95_96" as="power95_96_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col99_100" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>1</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col99_100" as="col99_100_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power99_100" group="2">
          <call function="=">
            <column table="this" column="col99_100" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power99_100" as="power99_100_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col101_102" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>2</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col101_102" as="col101_102_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power101_102" group="2">
          <call function="=">
            <column table="this" column="col101_102" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power101_102" as="power101_102_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col103_104" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>3</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col103_104" as="col103_104_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power103_104" group="2">
          <call function="=">
            <column table="this" column="col103_104" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power103_104" as="power103_104_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col105_106" group="2">
          <call function="and">
            <call function="=">
              <column table="this" column="col89_94" />
              <const>1</const>
            </call>
            <call function="=">
              <column table="a" column="tarif_st" />
              <const>4</const>
            </call>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col105_106" as="col105_106_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power105_106" group="2">
          <call function="=">
            <column table="this" column="col105_106" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power105_106" as="power105_106_sum" group="sumnvl" title="кВт" />
        <call function="if" as="col109_110" group="2">
          <call function="=">
            <column table="this" column="col89_94" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
        <column table="this" column="col109_110" as="col109_110_count" type="number" group="sumnvl" title="шт" />
        <call function="if" as="power109_110" group="2">
          <call function="=">
            <column table="this" column="col109_110" />
            <const>1</const>
          </call>
          <column table="a" column="sum_power" />
        </call>
        <column table="this" column="power109_110" as="power109_110_sum" group="sumnvl" title="кВт" />
      </select>
      <from>
        <query name="isv_rep_ad_m" as="a" />
      </from>
    </query>
    <query name="33535-voltage">
      <select>
        <column table="a" column="kod" type="number" />
        <column table="a" column="title" type="string" />
      </select>
      <from>
        <table name="33535-voltage_view" view="1" as="a" />
      </from>
    </query>
  </queries>
  <views>
    <view name="33535-voltage_view">
      select 1 as kod, '0,4' as title from dual
      union all
      select 2 ,'1-20' from dual
      union all
      select 3, 'не менее 35 кВ' from dual
    </view>
  </views>
</root>