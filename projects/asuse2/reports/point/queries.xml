<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="poisk_energy_point" is-report="1" title="Поиск точек учёта" timestamp="27.12.2017 13:01:56" visible="0">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия точки">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_seti" column-visible="1" title="Зона филиала,за которой закреплен энергообъект" name="kod_seti" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принадл. энергообъекта" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org" column-visible="1" title="Экспл. ответств. энергообъекта" name="exp_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield title="Вид энергообъекта" field="asuse_kod_srckind" show-nulls="1" name="kod_srckind" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Энергообъект" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" editable-invert="1" title="Оборудование" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже" name="pr_full_schema" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже да" name="pr_full_schema_yes" new-val="pr_full_schema" column-visible="0" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже нет" name="pr_full_schema_no" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_full_schema" />
                </defaultquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Классификатор собственника оборудования" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" new-val="with_pu" column-visible="0" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_is_no_pu" />
                </defaultquery>
              </usefield>
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <fieldgroup title="Точка учёта">
              <usefield title="Филиал ТСО, в зоне которого находится ТУ" field="asuse_kod_seti" name="fil_tu" />
              <usefield field="asuse_kod_elter_org_tu" title="РЭС, в зоне которого находится ТУ" name="res_tu" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" editable="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m_obj" />
                <usefield field="asuse_k_house_chet" name="kod_chet_obj" />
                <usefield field="asuse_k_strits" name="kod_street_obj">
                  <listquery>
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house" name="kod_d_obj">
                  <listquery>
                    <query name="k_house-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house-flats" name="kodd_flat_obj">
                  <listquery>
                    <query name="k_house-flats-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                        <useparam name="kod_d_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <fieldgroup title="Индекс" expanded="0">
                  <usefield field="cmn_integer" name="index_obj" />
                  <fieldgroup title="Диапазон" expanded="0">
                    <usefield field="cmn_integer" title="С" name="index_obj_s" width-perc="50" />
                    <usefield field="cmn_integer" title="По" name="index_obj_po" width-perc="50" />
                  </fieldgroup>
                </fieldgroup>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield title="Потребитель (Абонент)" name="kodp" field="asuse_kodp_cmb" />
              <usefield field="asuse_kod_dog_abon_cmd" title="№ Договора" name="kod_dog" />
              <usefield title="№ Объекта" field="asuse_kod_numobj(kod_dog)_cmb" name="kod_numobj" />
              <usefield field="asuse_kod_point(numobj)_cmb" name="kod_point" title="№ Точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select>
        <column table="kod_bal_point" column="kod_bal_point" as="kod_point" title="kod_point" />
        <const as="type_of_accounting">1</const>
        <const as="name_type_of_accounting">'технический'</const>
        <call function="||" title="interval_existence" as="interval_existence">
          <call function="to_char">
            <column table="kod_bal_point" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="kod_bal_point" column="dat_po" />
            <call function="null">NULL</call>
            <const>''</const>
            <const>'-'</const>
          </call>
          <call function="to_char">
            <column table="kod_bal_point" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="kod_bal_point" column="dat_po" />
            <call function="null">NULL</call>
            <const>'А'</const>
            <const>'У'</const>
          </call>
        </call>
        <call function="||" title="date_readings" as="date_readings">
          <column table="day_pokaz" column="name" />
          <call function="decode">
            <column table="day_pokaz" column="day_pokaz" />
            <const function="null">0</const>
            <const>''</const>
            <const>'-ого числа след.мес.'</const>
          </call>
        </call>
        <fact column="hr_bal_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" />
        <fact column="hr_bal_point_pu_nom_pu" as="nom_pu_" title="nom_pu_" exclude="1" />
        <fact column="hr_bal_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" />
        <fact column="hr_bal_point_pu_all_name_pk" title="name_typepu" as="name_typepu" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_bal_en_askue" as="isaskue" title="isaskue" />
        </call>
        <fact column="hr_bal_point_en_energy_abbr" as="energy" title="energy" />
        <fact column="hr_bal_point_ini_zona_day" as="zonaofday" title="zonaofday" />
        <fact column="hr_bal_pnt_h_all_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" />
        <column table="kod_v" column="sv" title="name_fact_voltage" as="name_fact_voltage" />
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <fact column="hr_eosrc_elnet_sname" title="name_net" as="name_net" exclude="1" />
        <column table="kod_eobject_senter_nut" column="name_senter_nut" as="name_senter_nut" title="name_senter_nut" />
        <column table="kod_eobject_senter_nut" column="name_fider_nut" as="name_fider_nut" title="name_fider_nut" />
        <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
        <call function="||-" as="name_eobject" title="name_eobject">
          <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
          <column table="kod_parent_eo" column="fname" as="name_eobject" title="name_eobject" />
        </call>
        <column table="eobj_id" column="name" as="name_equipment" title="name_equipment" />
        <column table="kodp_bal" column="name" as="bal_name_eobject" title="bal_name_eobject" />
        <column table="kodp_elter" column="name" as="elter_name_eobject" title="elter_name_eobject" />
        <column table="kod_org_group" column="name" as="name_org_group" title="name_org_group" />
        <column table="kod_bal_point" column="nomer" as="number_point" title="number_point" />
        <column table="kod_bal_point" column="name" as="name_point" title="name_point" />
        <column table="kod_bal_point" column="name_point" as="type_point" title="type_point" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_bal_point" all-rows="1" />
          <link name="kod_bal_point_pu" />
          <link name="kod_seti" />
          <link name="kod_pktippu" />
          <link name="voltage" title="Экономическое напряжение" />
          <link name="kod_v" />
          <link name="dat_s" />
          <link name="dat_po" />
          <link name="day_pokaz" />
          <link name="kod_elter" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kod_eobject_senter_nut" />
          <link name="kodp_bal" />
          <link name="kodp_elter" />
          <link name="kod_elnet" exclude="1" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_bal_point" column="kod_bal_point" />
              </call>
              <call function="in nnull" optional="1" comment="Условие на экономич.УН">
                <column table="voltage" column="voltage" />
                <useparam name="voltage" />
              </call>
              <call function="in nnull" optional="1" comment="Условия на фактич. УН">
                <column table="kod_v" column="kod_v" />
                <useparam name="voltage_fiz" />
              </call>
              <call function="le" optional="1" comment="Заданный период ограничивает точку, прибор">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
              <call function="true" />
              <call function="le" optional="1">
                <call function="latest">
                  <useparam name="date_s" />
                  <column table="kod_bal_point" column="dat_s" />
                </call>
                <call function="nvl">
                  <column table="kod_bal_point" column="dat_po" />
                  <call function="doomsday" />
                </call>
              </call>
              <call function="ge" optional="1">
                <call function="earliest">
                  <useparam name="date_po" />
                  <call function="nvl">
                    <column table="kod_bal_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <column table="kod_bal_point" column="dat_s" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_bal_point" column="kod_bal_point" />
              </call>
              <call function="like" optional="1" comment="Поиск по фрагменту номера ПУ">
                <column table="kod_bal_point_pu" column="nom_pu" />
                <useparam name="serial_num" />
              </call>
              <call function="in" optional="1" comment="Поиск по типу ПУ">
                <column table="kod_pktippu" column="kod_pktippu" />
                <useparam name="kod_pktippu" />
              </call>
              <call function="le" optional="1" use-only-with-other="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_bal_point" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_bal_point_pu" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_pu" />
                </call>
                <call function="is not null">
                  <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_no_pu" />
                </call>
                <call function="is null">
                  <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                </call>
              </call>
              <call function="in nnull" optional="1" comment="Поиск по дате снятия показаний">
                <column table="day_pokaz" column="day_pokaz" />
                <useparam name="day_pokaz" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по типу учёта">
                <column table="this" column="type_of_accounting" />
                <useparam name="kod_accounting" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_seti" column="kod" />
                <useparam name="fil_tu" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                <column table="kod_elter" column="kodp" />
                <useparam name="res_tu" />
              </call>
            </call>
            <call function="and" comment="Поиск по сети">
              <call function="true" />
              <call function="in nnull" optional="1" comment="Поиск по типу энергообъекта">
                <column table="kod_srckind" column="kod_srckind" />
                <useparam name="kod_srckind" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по балансовой принадлежности энергообъекта">
                <column table="kodp_bal" column="kodp" />
                <useparam name="bal_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по эксплуатационной принадлежности">
                <column table="kodp_elter" column="kodp" />
                <useparam name="exp_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                <column table="kod_org_group" column="kod_org_group" />
                <useparam name="kod_org_elmarket" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по сетям" exclude="1">
                <column table="kod_elnet" column="kodp" />
                <useparam name="kod_seti" />
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_no" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_parent_eo" column="eobj_id" />
                  <useparam name="eobj_id_eo" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_no" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="eobj_id" column="eobj_id" />
                  <useparam name="eobj_id" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_yes" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                  <useparam name="eobj_id" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_yes" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                  <useparam name="eobj_id_eo" />
                </call>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="this" column="isaskue" />
            <useparam name="in_askue" />
          </call>
        </call>
      </where>
    </query>
    <query name="yeas_or_no" timestamp="29.08.2017 18:14:24">
      <const as="id" type="number">1</const>
      <const as="name" type="string" title="1">'Есть'</const>
      <const>0</const>
      <const>'Нет'</const>
    </query>
    <query name="yeas_or_no_use" timestamp="11.10.2017 12:32:05">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="yeas_or_no" as="a" />
      </from>
    </query>
    <query name="method_search_point" timestamp="30.08.2017 11:50:07">
      <const as="id" type="number">1</const>
      <const as="name" type="string" title="1">'Период'</const>
      <const>2</const>
      <const>'Интервал дат'</const>
    </query>
    <query name="method_search_point_use" timestamp="30.08.2017 11:52:30">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" title="1" />
      </select>
      <from>
        <query name="method_search_point" as="a" />
      </from>
    </query>
    <query name="poisk_point_is_ym" timestamp="30.08.2017 12:47:58">
      <params>
        <param type="array" name="kod_method_search" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="in">
            <const>1</const>
            <useparam name="kod_method_search" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="poisk_point_is_date" timestamp="30.08.2017 12:51:53">
      <params>
        <param type="array" name="kod_method_search" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="in">
            <const>2</const>
            <useparam name="kod_method_search" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="hv_type_of_accounting_def2" timestamp="30.08.2017 12:58:55">
      <select>
        <column table="hv_type_of_accounting" column="kod" type="number" title="" />
        <column table="hv_type_of_accounting" column="name" type="string" title="Вид учёта" />
      </select>
      <from>
        <query name="hv_type_of_accounting" />
      </from>
    </query>
    <query name="hv_org_pes_onlyfil" timestamp="30.08.2017 13:15:13" order="name">
      <select>
        <column table="hv_org_pes" column="kodp" key="1" />
        <column table="hv_org_pes" column="name" />
        <column table="hv_org_pes" column="sname" title="Краткое наименование" halign="center" />
      </select>
      <from>
        <query name="hv_org_pes" />
      </from>
      <where>
        <call function="=">
          <column table="hv_org_pes" column="kod_ecls" />
          <const>2</const>
        </call>
      </where>
    </query>
    <query name="kr_numobj(kodp,dog)" title="Список объектов конкретного договора и абонента" timestamp="31.08.2017 11:03:17">
      <params>
        <param name="dep" type="array" />
        <param type="array" name="kodp" exclude="1" />
        <param type="number" name="kod_dog" />
      </params>
      <select>
        <column table="a" column="kod_numobj" type="number" comment="код объекта в договоре" key-dimension="kod_numobj" key="1" />
        <column table="a" column="num_obj" type="number" title="Номер объекта договора" comment="номер объекта в списке объектов договора" />
        <column table="a" column="name" type="string" title="Наименование объекта договора" comment="наименование объекта в текущем договоре" />
        <column table="a" column="dat_create" type="date" title="Дата  создания" comment="дата  создания объекта в списке" />
        <column table="a" column="dat_fin" type="date" title="Дата окончания действия" comment="дата перевода объекта в архив в текущем договоре" />
      </select>
      <from>
        <query name="kr_numobj" as="a">
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in nnull" optional="1">
            <column table="kod_dog" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="=" optional="1">
            <column table="kod_dog" column="kod_dog" />
            <useparam name="kod_dog" />
          </call>
        </call>
      </where>
    </query>
    <query name="hr_point(numobj)" title="Точки учёта по объекту договора" timestamp="31.08.2017 10:53:06">
      <params>
        <param type="number" name="kod_numobj" />
      </params>
      <select>
        <column table="a" column="kod_point" key="1" />
        <column table="a" column="nomer" title="Номер" />
        <column table="a" column="name" title="Наименование" />
        <column table="a" column="mesto" title="Место установки" />
        <column table="a" column="dat_s" title="Дата начала действия" />
        <column table="a" column="dat_po" title="Дата конца действия" />
      </select>
      <from>
        <query name="hr_point" as="a">
          <link name="kod_obj" as="b">
            <dlink name="kr_numobj" as="c" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="=" optional="1">
            <column table="c" column="kod_numobj" />
            <useparam name="kod_numobj" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_elter_org_short_tu" title="РЭСы, в зоне которых находятся ТУ" timestamp="31.08.2017 11:08:10">
      <params>
        <param type="array" name="fil_tu" />
      </params>
      <select>
        <column table="hv_elter_org" column="kodp" />
        <column table="hv_elter_org" column="altername" title="Наименование" />
        <column table="hv_elter_org" column="sname" title="Краткое наименование" halign="left" />
        <column table="hv_elter_org" column="kod_parent" />
      </select>
      <from>
        <query name="hv_elter_org" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in nnull" optional="1">
            <column table="hv_elter_org" column="kod_parent" />
            <useparam name="fil_tu" />
          </call>
        </call>
      </where>
    </query>
    <query name="poisk_energy_point_test1" is-report="1" title="Поиск точек учёта" timestamp="28.11.2017 00:23:35">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия" exclude="1">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_seti" column-visible="1" title="Зона филиала,за которой закреплен энергообъект" name="kod_seti" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принадл. энергообъекта" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org" column-visible="1" title="Экспл. ответств. энергообъекта" name="exp_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield title="Вид энергообъекта" field="asuse_kod_srckind" show-nulls="1" name="kod_srckind" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Энергообъект" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" editable-invert="1" title="Оборудование" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже" name="pr_full_schema" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже да" name="pr_full_schema_yes" new-val="pr_full_schema" column-visible="0" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже нет" name="pr_full_schema_no" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_full_schema" />
                </defaultquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Классификатор собственника оборудования" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" />
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <fieldgroup title="Точка учёта">
              <usefield title="Филиал ТСО, в зоне которого находится ТУ" field="asuse_kod_seti" name="fil_tu" />
              <usefield field="asuse_kod_elter_org_tu" title="РЭС, в зоне которого находится ТУ" name="res_tu" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия точки">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
              <usefield title="Филиал ТСО точки учёта" field="asuse_kod_seti" name="fil_tu" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org_tu" name="res_tu" title="РЭС ТСО точки учёта" />
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принад. ЦП" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eosrc(kodp_res)" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" title="Оборудование" clear-on-list-change="1" editable-invert="1" />
              <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" title="ТП ( КТП)" name="eobj_id_eo_tp" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Линия НН" clear-on-list-change="1">
                <listquery>
                  <query name="hv_eobject_eq_tp">
                    <withparams exclude="1">
                      <useparam name="kod_adr_m" />
                    </withparams>
                  </query>
                </listquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Признак подключения к сети" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" new-val="with_pu" column-visible="0" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_is_no_pu" />
                </defaultquery>
              </usefield>
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" editable="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m_obj" />
                <usefield field="asuse_k_house_chet" name="kod_chet_obj" />
                <usefield field="asuse_k_strits" name="kod_street_obj">
                  <listquery>
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house" name="kod_d_obj">
                  <listquery>
                    <query name="k_house-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house-flats" name="kodd_flat_obj">
                  <listquery>
                    <query name="k_house-flats-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                        <useparam name="kod_d_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <fieldgroup title="Индекс" expanded="0">
                  <usefield field="cmn_integer" name="index_obj" />
                  <fieldgroup title="Диапазон" expanded="0">
                    <usefield field="cmn_integer" title="С" name="index_obj_s" width-perc="50" />
                    <usefield field="cmn_integer" title="По" name="index_obj_po" width-perc="50" />
                  </fieldgroup>
                </fieldgroup>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield title="Потребитель (Абонент)" name="kodp" field="asuse_kodp_cmb" />
              <usefield field="asuse_kod_dog_abon_cmd" title="№ Договора" name="kod_dog" />
              <usefield title="№ Объекта" field="asuse_kod_numobj(kod_dog)_cmb" name="kod_numobj" />
              <usefield field="asuse_kod_point(numobj)_cmb" name="kod_point" title="№ Точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select>
        <column table="kod_point" column="kod_point" as="kod_point" title="kod_point" />
        <const as="type_of_accounting">0</const>
        <const as="name_type_of_accounting">'расчётный'</const>
        <call function="||" title="interval_existence" as="interval_existence">
          <call function="to_char">
            <column table="kod_point" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">1</const>
            <const>'-'</const>
            <const>''</const>
          </call>
          <call function="to_char">
            <column table="kod_point" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">0</const>
            <const>'А'</const>
            <const function="null">1</const>
            <const>'У'</const>
            <const function="null">2</const>
            <const>'Н'</const>
          </call>
        </call>
        <fact column="kr_dog_date_readings" as="date_readings" title="date_readings" exclude="1" />
        <fact column="hr_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" />
        <fact column="hr_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" />
        <fact column="hr_pnt_pu_all_name_pk" title="name_typepu" as="name_typepu" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" />
        </call>
        <fact column="hr_pnt_en_energy_abbr" as="energy" title="energy" />
        <fact column="hr_pnt_ini_zona_day" as="zonaofday" title="zonaofday" />
        <fact column="hr_pnt_tar_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" />
        <column table="kod_v" column="sv" title="name_fact_voltage" as="name_fact_voltage" />
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <call function="||-" as="name_eobject" title="Энергообъект">
          <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
          <column table="kod_parent_eo" column="fname" as="name_eobject" title="name_eobject" />
        </call>
        <column table="eobj_id" column="name" as="name_equipment" title="Оборудование" />
        <column table="kod_eobject_senter_nut" column="seti_senter_nut" title="Сеть ЦП" as="name_net" />
        <column table="kod_eobject_senter_nut" column="baltername_senter_nut" as="bal_name_eobject" title="Бал. принад. ЦП" />
        <column table="kod_eobject_senter_nut" column="name_senter_nut" as="name_senter_nut" title="Центр питания" />
        <column table="kod_eobject_senter_nut" column="name_fider_nut" as="name_fider_nut" title="Питающий фидер" />
        <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
        <column table="kod_org_group" column="name" as="name_org_group" title="name_org_group" />
        <column table="kod_point" column="nomer" as="number_point" title="number_point" />
        <column table="kod_point" column="name" as="name_point" title="name_point" />
        <column table="kod_point" column="type_point" as="type_point" title="type_point" />
        <fact column="kr_numobj_mn_f23_name" as="dover_sps" title="dover_sps" exclude="1" />
        <fact column="kr_numobj_mn_num_obj" as="number_numobj" title="number_numobj" exclude="1" />
        <fact column="kr_numobj_mn_saddr" as="numobj_addr" title="numobj_addr" exclude="1" />
        <fact column="kr_numobj_mn_int_exst_inf" title="interval_existence_numobj" as="interval_existence_numobj" exclude="1" />
        <fact column="kr_dog_ndog" title="number_dog" as="number_dog" exclude="1" />
        <fact column="kr_dog_interval_exist" title="interval_existence_dog" as="interval_existence_dog" exclude="1" />
        <fact column="kr_dog_sbyt" as="name_sbyt_org" title="name_sbyt_org" exclude="1" />
        <fact column="kr_payer_name" as="name_payer" title="name_payer" exclude="1" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_point" all-rows="1" />
          <link name="kod_point_pu" />
          <link name="kod_point_har" />
          <link name="kod_pktippu" />
          <link name="point_dat_s" />
          <link name="point_dat_po" />
          <link name="voltage" />
          <link name="kod_v" />
          <link name="kod_seti" />
          <link name="kod_elter" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kod_eobject_senter_nut" />
          <link name="kod_numobj_mn" />
          <link name="kodd" exclude="1" />
          <link name="kod_dog" />
          <link name="day_pokaz" exclude="1" />
          <link name="kodp" />
          <link name="kod_org_sbyt" exclude="1" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="voltage" column="voltage" />
                <useparam name="voltage" />
              </call>
              <call function="in" optional="1">
                <column table="kod_v" column="kod_v" />
                <useparam name="voltage_fiz" />
              </call>
              <call function="is not null">
                <column table="kod_point" column="kod_point" />
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" use-only-with-other="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
              <call function="true" />
              <call function="le" optional="1">
                <call function="latest">
                  <useparam name="date_s" />
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="nvl">
                  <column table="kod_point" column="dat_po" />
                  <call function="doomsday" />
                </call>
              </call>
              <call function="ge" optional="1">
                <call function="earliest">
                  <useparam name="date_po" />
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <column table="kod_point" column="dat_s" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="and">
                <call function="le" optional="1" use-only-with-other="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_point_pu" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point_pu" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="like" optional="1">
                  <column table="kod_point_pu" column="nom_pu" />
                  <useparam name="serial_num" />
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_pu" />
                  </call>
                  <call function="is not null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_no_pu" />
                  </call>
                  <call function="is null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_pktippu" column="kod_pktippu" />
                <useparam name="kod_pktippu" />
              </call>
              <call function="in nnull" comment="Поиск по дате снятия показаний" optional="1" exclude="1">
                <column table="day_pokaz" column="day_pokaz" />
                <useparam name="day_pokaz" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по типу учёта">
                <column table="this" column="type_of_accounting" />
                <useparam name="kod_accounting" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_seti" column="kod" />
                <useparam name="fil_tu" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                <column table="kod_elter" column="kodp" />
                <useparam name="res_tu" />
              </call>
            </call>
            <call function="and" comment="Поиск по сети">
              <call function="true" />
              <call function="le" optional="1" use-only-with-other="1" comment="Ограничение характеристики периодом">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_point_har" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point_har" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="and" comment="Заданный интервал ограничивает интервал действия характеристики">
                <call function="true" />
                <call function="le" optional="1">
                  <call function="latest">
                    <useparam name="date_s" />
                    <column table="kod_point_har" column="dat_s" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point_har" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <call function="ge" optional="1">
                  <call function="earliest">
                    <useparam name="date_po" />
                    <call function="nvl">
                      <column table="kod_point_har" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                  <column table="kod_point_har" column="dat_s" />
                </call>
              </call>
              <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                <column table="kod_org_group" column="kod_org_group" />
                <useparam name="kod_org_elmarket" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="bal_id_senter_nut" />
                <useparam name="bal_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                <useparam name="eobj_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                <useparam name="eobj_id" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="eobj_id" column="eobj_id" />
                <useparam name="eobj_id_tp" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_parent_eo" column="eobj_id" />
                <useparam name="eobj_id_eo_tp" />
              </call>
            </call>
            <call function="and" exclude="1">
              <call function="true" />
              <call function="le" optional="1" use-only-with-other="1" exclude="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_numobj" column="dat_create" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_numobj" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_dog" column="pr_active" />
                <useparam name="kod_activ_dog" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_numobj_mn" column="pr_active" />
                <useparam name="kod_activ_obj" />
              </call>
              <call function="=" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="=" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
              <call function="=" optional="1">
                <column table="kod_numobj_mn" column="kod_numobj" />
                <useparam name="kod_numobj" />
              </call>
              <call function="le" optional="1" comment="Условие по периоду на договор">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_dog" column="dat_dog" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_dog" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" comment="Условие по периоду на объект договора">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_numobj_mn" column="dat_create" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_numobj_mn" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="this" column="isaskue" />
            <useparam name="in_askue" />
          </call>
        </call>
      </where>
    </query>
    <query name="hr_bal_point_pu_en_ini" title="Информация о ПУ, энергии, шкалах" timestamp="22.09.2017 16:44:36">
      <select>
        <column table="a" column="nom_pu" is-fact="1" agg="list" fact="hr_bal_pnt_pu_all_nom_pu_en_ini" />
        <column table="kod_pktippu" column="name_pk" is-fact="1" agg="list" fact="hr_bal_pnt_pu_en_ini_name_pk_en_ini" />
        <column table="kod_bal_point_en" column="energy_abbr" is-fact="1" agg="list" fact="hr_bal_pnt_pu_en_ini_energy_abbr_en_ini" />
        <call function="||" title="interval_existence" as="interval_existence" is-fact="1" fact="hr_bal_pnt_pu_all_existint_en_ini" agg="list">
          <call function="to_char">
            <column table="a" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="a" column="dat_po" />
            <call function="null">NULL</call>
            <const>''</const>
            <const>'-'</const>
          </call>
          <call function="to_char">
            <column table="a" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="a" column="dat_po" />
            <call function="null">NULL</call>
            <const>'А'</const>
            <const>'У'</const>
          </call>
        </call>
        <column table="a" column="dat_s" dimension="dat_s" is-final-dimension="1" is-private-dimension="1" />
        <column table="a" column="dat_po" dimension="dat_po" is-final-dimension="1" is-private-dimension="1" />
        <column table="kod_bal_point_ini" column="zona_day" as="zona_day" is-fact="1" agg="list" fact="hr_bal_pnt_pu_en_ini_zona_day" />
      </select>
      <from>
        <query name="hr_bal_point_pu" as="a" dimension="1" is-final-dimension="1" is-private-dimension="1" />
        <query name="hr_bal_point" as="kod_bal_point" join="left outer" dimension="1">
          <call function="=">
            <column table="a" column="kod_bal_point" />
            <column table="kod_bal_point" column="kod_bal_point" />
          </call>
        </query>
        <query name="hs_tippu" as="kod_tippu" join="left outer" dimension="1" is-final-dimension="1" is-private-dimension="1">
          <call function="=">
            <column table="a" column="kod_tippu" />
            <column table="kod_tippu" column="kod_tippu" />
          </call>
        </query>
        <query join="left outer" name="hs_pktippu" as="kod_pktippu">
          <call function="=">
            <column table="kod_tippu" column="kod_pktippu" />
            <column table="kod_pktippu" column="kod_pktippu" />
          </call>
        </query>
        <query name="hr_pu_u" as="kod_pu_u" join="left outer">
          <call function="=">
            <column table="a" column="kod_pu_u" />
            <column table="kod_pu_u" column="kod_pu_u" />
          </call>
        </query>
        <query join="left outer" name="hr_bal_point_en" as="kod_bal_point_en">
          <call function="=">
            <column table="kod_bal_point_en" column="kod_bal_point_pu" />
            <column table="a" column="kod_bal_point_pu" />
          </call>
        </query>
        <query join="left outer" name="hr_bal_point_ini" as="kod_bal_point_ini">
          <call function="=">
            <column table="kod_bal_point_en" column="kod_bal_point_en" />
            <column table="kod_bal_point_ini" column="kod_bal_point_en" />
          </call>
        </query>
      </from>
      <links>
        <link name="kod_bal_point" dimension="1" is-final-dimension="1" is-private-dimension="1">
          <dimlink name="voltage" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="voltage_fact" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_pktippu" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_tippu" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_bal_point_pu" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_v" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="day_pokaz" is-final-dimension="1" dimension="1" is-private-dimension="1" />
          <dimlink name="kod_seti" dimension="1" is-final-dimension="1" is-private-dimension="1" />
          <dimlink name="kod_elter" dimension="1" is-final-dimension="1" is-private-dimension="1" />
        </link>
      </links>
    </query>
    <query name="poisk_point_is_no_pu" timestamp="17.10.2017 00:45:42">
      <params>
        <param type="number" name="with_pu" />
      </params>
      <select>
        <call function="decode" as="val">
          <call function="nvl">
            <useparam name="with_pu" />
            <const>1</const>
          </call>
          <const>1</const>
          <const>0</const>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="poisk_point_full_schema" timestamp="10.10.2017 12:44:52">
      <params>
        <param type="number" name="pr_full_schema" />
      </params>
      <select>
        <call function="true if 0" as="val">
          <call function="nvl">
            <useparam name="pr_full_schema" />
            <const>0</const>
          </call>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="43375-search" is-report="1" title="Поиск точек учёта" timestamp="28.11.2017 00:25:37" can-use-simple-params="1">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_seti" column-visible="1" title="Зона филиала,за которой закреплен энергообъект" name="kod_seti" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принадл. энергообъекта" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org" column-visible="1" title="Экспл. ответств. энергообъекта" name="exp_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield title="Вид энергообъекта" field="asuse_kod_srckind" show-nulls="1" name="kod_srckind" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Энергообъект" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" editable-invert="1" title="Оборудование" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже" name="pr_full_schema" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже да" name="pr_full_schema_yes" new-val="pr_full_schema" column-visible="0" />
              <usefield field="cmn_check" title="От выбранного элемента и ниже нет" name="pr_full_schema_no" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_full_schema" />
                </defaultquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Классификатор собственника оборудования" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" />
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <fieldgroup title="Точка учёта">
              <usefield title="Филиал ТСО, в зоне которого находится ТУ" field="asuse_kod_seti" name="fil_tu" />
              <usefield field="asuse_kod_elter_org_tu" title="РЭС, в зоне которого находится ТУ" name="res_tu" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m_obj" />
                <usefield field="asuse_k_house_chet" name="kod_chet_obj" />
                <usefield field="asuse_k_strits" name="kod_street_obj">
                  <listquery>
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house" name="kod_d_obj">
                  <listquery>
                    <query name="k_house-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <usefield field="asuse_k_house-flats" name="kodd_flat_obj">
                  <listquery>
                    <query name="k_house-flats-list">
                      <withparams>
                        <useparam name="kod_adr_m_obj" />
                        <useparam name="kod_street_obj" />
                        <useparam name="kod_chet_obj" />
                        <useparam name="kod_d_obj" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
                <fieldgroup title="Индекс" expanded="0">
                  <usefield field="cmn_integer" name="index_obj" />
                  <fieldgroup title="Диапазон" expanded="0">
                    <usefield field="cmn_integer" title="С" name="index_obj_s" width-perc="50" />
                    <usefield field="cmn_integer" title="По" name="index_obj_po" width-perc="50" />
                  </fieldgroup>
                </fieldgroup>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield title="Потребитель (Абонент)" name="kodp" field="asuse_kodp_cmb" />
              <usefield field="asuse_kod_dog_abon_cmd" title="№ Договора" name="kod_dog" />
              <usefield title="№ Объекта" field="asuse_kod_numobj(kod_dog)_cmb" name="kod_numobj" />
              <usefield field="asuse_kod_point(numobj)_cmb" name="kod_point" title="№ Точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select call="43375-output">
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
        </call>
        <column table="kod_point" column="kod_point" as="p_kod_point" title="kod_point" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" />
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_point" all-rows="1">
            <link name="kod_nugruz" exclude="1" />
          </link>
          <link name="kod_point_pu" />
          <link name="kod_pktippu" />
          <link name="point_dat_s" />
          <link name="point_dat_po" />
          <link name="voltage" />
          <link name="kod_v" />
          <link name="kod_seti" />
          <link name="kod_elter" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kodp_org" />
          <link name="kodp_elter" />
          <link name="kod_eobject_senter_nut" />
          <link name="kod_elnet" />
          <link name="kod_numobj_mn" />
          <link name="kodd" />
          <link name="kod_dog" />
          <link name="day_pokaz" />
          <link name="kodp" />
          <link name="kod_org_sbyt" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="voltage" column="voltage" />
                <useparam name="voltage" />
              </call>
              <call function="in" optional="1">
                <column table="kod_v" column="kod_v" />
                <useparam name="voltage_fiz" />
              </call>
              <call function="is not null">
                <column table="kod_point" column="kod_point" />
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" use-only-with-other="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
              <call function="true" />
              <call function="le" optional="1">
                <call function="latest">
                  <useparam name="date_s" />
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="nvl">
                  <column table="kod_point" column="dat_po" />
                  <call function="doomsday" />
                </call>
              </call>
              <call function="ge" optional="1">
                <call function="earliest">
                  <useparam name="date_po" />
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <column table="kod_point" column="dat_s" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="and">
                <call function="le" optional="1" use-only-with-other="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_point_pu" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point_pu" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="like" optional="1">
                  <column table="kod_point_pu" column="nom_pu" />
                  <useparam name="serial_num" />
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_pu" />
                  </call>
                  <call function="is not null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_no_pu" />
                  </call>
                  <call function="is null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_pktippu" column="kod_pktippu" />
                <useparam name="kod_pktippu" />
              </call>
              <call function="in nnull" comment="Поиск по дате снятия показаний" optional="1">
                <column table="day_pokaz" column="day_pokaz" />
                <useparam name="day_pokaz" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_seti" column="kod" />
                <useparam name="fil_tu" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                <column table="kod_elter" column="kodp" />
                <useparam name="res_tu" />
              </call>
            </call>
            <call function="and" comment="Поиск по сети">
              <call function="true" />
              <call function="in nnull" optional="1" comment="Поиск по типу энергообъекта">
                <column table="kod_srckind" column="kod_srckind" />
                <useparam name="kod_srckind" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по балансовой принадлежности энергообъекта">
                <column table="kodp_org" column="kodp" />
                <useparam name="bal_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по эксплуатационной принадлежности">
                <column table="kodp_elter" column="kodp" />
                <useparam name="exp_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                <column table="kod_org_group" column="kod_org_group" />
                <useparam name="kod_org_elmarket" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по сетям">
                <column table="kod_elnet" column="kodp" />
                <useparam name="kod_seti" />
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_no" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_parent_eo" column="eobj_id" />
                  <useparam name="eobj_id_eo" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_no" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="eobj_id" column="eobj_id" />
                  <useparam name="eobj_id" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_yes" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                  <useparam name="eobj_id" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_full_schema_yes" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по оборудованию">
                  <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                  <useparam name="eobj_id_eo" />
                </call>
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="=" optional="1">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="=" optional="1">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
              <call function="=" optional="1">
                <column table="kod_numobj_mn" column="kod_numobj" />
                <useparam name="kod_numobj" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="this" column="isaskue" />
            <useparam name="in_askue" />
          </call>
        </call>
      </where>
    </query>
    <query name="43375-output" is-report="1" title="Поиск точек учёта" timestamp="28.11.2017 00:24:24">
      <params>
        <param name="p_kod_point" type="array" />
        <param type="number" name="ym" />
      </params>
      <select>
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
        </call>
        <column table="kod_point" column="kod_point" as="kod_point" title="kod_point" />
        <const as="type_of_accounting">0</const>
        <const as="name_type_of_accounting">'расчётный'</const>
        <call function="||" title="interval_existence" as="interval_existence">
          <call function="to_char">
            <column table="kod_point" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">1</const>
            <const>'-'</const>
            <const>''</const>
          </call>
          <call function="to_char">
            <column table="kod_point" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">0</const>
            <const>'А'</const>
            <const function="null">1</const>
            <const>'У'</const>
            <const function="null">2</const>
            <const>'Н'</const>
          </call>
        </call>
        <fact column="kr_dog_date_readings" as="date_readings" title="date_readings" />
        <fact column="hr_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" />
        <fact column="hr_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" />
        <fact column="hr_pnt_pu_all_name_pk" title="name_typepu" as="name_typepu" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" />
        </call>
        <fact column="hr_pnt_en_energy_abbr" as="energy" title="energy" />
        <fact column="hr_pnt_ini_zona_day" as="zonaofday" title="zonaofday" />
        <fact column="hr_pnt_tar_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" />
        <fact column="hk_v_sv" title="name_fact_voltage" />
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <fact column="hr_eosrc_elnet_sname" title="seti_eobj" as="seti_eobj" exclude="1" />
        <fact column="hv_eobj_sent_name" as="name_senter_nut" title="name_senter_nut" />
        <fact column="hv_eobj_sent_fider_name" title="name_fider_nut" as="name_fider_nut" />
        <fact column="hk_srckind_sname" as="kind_eobject" title="kind_eobject" />
        <fact column="hr_eosrc_name_obj" as="name_eobject" title="name_eobject" />
        <fact column="hr_eobject_name" title="name_equipment" as="name_equipment" />
        <fact column="kr_org_bal_name" as="bal_name_eobject" title="bal_name_eobject" />
        <fact column="kr_org_elter_name" as="elter_name_object" title="elter_name_object" />
        <fact column="kr_org_group_name" as="name_org_group" title="name_org_group" />
        <column table="kod_point" column="nomer" as="number_point" title="number_point" />
        <column table="kod_point" column="name" as="name_point" title="name_point" />
        <column table="kod_point" column="type_point" as="type_point" title="type_point" />
        <fact column="kr_numobj_mn_f23_name" as="dover_sps" title="dover_sps" table="dog" />
        <fact column="kr_numobj_mn_num_obj" as="number_numobj" title="number_numobj" table="dog" />
        <fact column="kr_numobj_mn_saddr" as="numobj_addr" title="numobj_addr" table="dog" />
        <fact column="kr_numobj_mn_int_exst_inf" title="interval_existence_numobj" as="interval_existence_numobj" table="dog" />
        <fact column="kr_dog_ndog" title="number_dog" as="number_dog" table="dog" />
        <fact column="kr_dog_interval_exist" title="interval_existence_dog" as="interval_existence_dog" table="dog" />
        <fact column="kr_payer_name" as="name_payer" title="name_payer" table="dog" />
        <fact column="kr_dog_sbyt" as="name_sbyt_org" title="name_sbyt_org" table="dog" />
      </select>
      <from>
        <qube star-scheme="1">
          <where>
            <call function="and">
              <call function="true" />
              <call function="in">
                <column table="kod_point" column="kod_point" />
                <useparam name="p_kod_point" />
              </call>
              <call function="le" comment="Условие по периоду на точку, приборы, виды энергии, шкалы" optional="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
          </where>
          <dimset as="dog">
            <link name="kod_dog" />
            <link name="kod_numobj_mn" />
            <where>
              <call function="true" />
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_dog" column="dat_dog" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_dog" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_numobj_mn" column="dat_create" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_numobj_mn" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <link name="kod_point" all-rows="1">
            <link name="kod_seti" />
            <link name="kod_elter" />
          </link>
          <link name="point_dat_s" />
          <link name="point_dat_po" />
        </qube>
      </from>
    </query>
    <query name="poisk_navigation_tree" timestamp="17.10.2017 00:07:38">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <usefield field="asuse_kod_search_nav_tree" type="number" name="kod_search" title="Поиск" />
            <usefield field="asuse_kod_eobject_src" name="eobj_id_eo" column-visible="1" title="Энергообъект" editable="1" />
          </fieldgroup>
        </tabcontainer>
      </content>
      <select />
      <from />
    </query>
    <query name="poisk_energy_point2" title="Поиск точек тех учёта " timestamp="27.12.2017 13:03:04" is-report="1" visible="0">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия точки">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
              <usefield title="Филиал ТСО точки учёта" field="asuse_kod_seti" name="fil_tu" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org_tu" name="res_tu" title="РЭС ТСО точки учёта" />
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принад. ЦП" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eosrc(kodp_res)" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" title="Оборудование" clear-on-list-change="1" editable-invert="1" />
              <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" title="ТП ( КТП)" name="eobj_id_eo_tp" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Линия НН" clear-on-list-change="1">
                <listquery>
                  <query name="hv_eobject_eq_tp">
                    <withparams exclude="1">
                      <useparam name="kod_adr_m" />
                    </withparams>
                  </query>
                </listquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Признак подключения к сети" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" new-val="with_pu" column-visible="0" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_is_no_pu" />
                </defaultquery>
              </usefield>
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" editable="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m" />
                <usefield field="asuse_k_strits" name="kod_street_obj" editable="kod_adr_m" clear-on-list-change="1">
                  <listquery exclude="1">
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield name="kodp" field="asuse_kodp_kod_res" title="Потребитель (Абонент)" />
              <usefield field="asuse_kod_dog_kodp_res" title="№ Договора" name="kod_dog" />
              <usefield title="№ объекта" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
              <usefield field="asuse_kod_point_kod_res" name="kod_point" title="№ точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select>
        <column table="kod_bal_point" column="kod_bal_point" as="kod_point" title="kod_point" />
        <const as="type_of_accounting">1</const>
        <const as="name_type_of_accounting">'технический'</const>
        <call function="||" title="interval_existence" as="interval_existence">
          <call function="to_char">
            <column table="kod_bal_point" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="kod_bal_point" column="dat_po" />
            <call function="null">NULL</call>
            <const>''</const>
            <const>'-'</const>
          </call>
          <call function="to_char">
            <column table="kod_bal_point" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="kod_bal_point" column="dat_po" />
            <call function="null">NULL</call>
            <const>'А'</const>
            <const>'У'</const>
          </call>
        </call>
        <call function="||" title="date_readings" as="date_readings">
          <column table="day_pokaz" column="name" />
          <call function="decode">
            <column table="day_pokaz" column="day_pokaz" />
            <const function="null">0</const>
            <const>''</const>
            <const>'-ого числа след.мес.'</const>
          </call>
        </call>
        <fact column="hr_bal_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" />
        <fact column="hr_bal_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" />
        <fact column="hr_bal_point_pu_all_name_pk" title="name_typepu" as="name_typepu" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_bal_en_askue" as="isaskue" title="isaskue" />
        </call>
        <fact column="hr_bal_point_en_energy_abbr" as="energy" title="energy" />
        <fact column="hr_bal_point_ini_zona_day" as="zonaofday" title="zonaofday" />
        <fact column="hr_bal_pnt_h_all_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" />
        <column table="kod_v" column="sv" title="name_fact_voltage" as="name_fact_voltage" />
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <call function="||-" as="name_eobject" title="Энергообъект">
          <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
          <column table="kod_parent_eo" column="fname" as="name_eobject" title="name_eobject" />
        </call>
        <column table="eobj_id" column="name" as="name_equipment" title="Оборудование" />
        <column table="kod_eobject_senter_nut" column="seti_senter_nut" title="Сеть ЦП" as="name_net" />
        <column table="kod_eobject_senter_nut" column="baltername_senter_nut" as="bal_name_eobject" title="Бал. принад. ЦП" />
        <column table="kod_eobject_senter_nut" column="name_senter_nut" as="name_senter_nut" title="Центр питания" />
        <column table="kod_eobject_senter_nut" column="name_fider_nut" as="name_fider_nut" title="Питающий фидер" />
        <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
        <column table="kod_org_group" column="name" as="name_org_group" title="name_org_group" />
        <column table="kod_bal_point" column="nomer" as="number_point" title="number_point" />
        <column table="kod_bal_point" column="name" as="name_point" title="name_point" />
        <column table="kod_bal_point" column="name_point" as="type_point" title="type_point" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_bal_point" all-rows="1" />
          <link name="kod_bal_point_pu" />
          <link name="kod_seti" />
          <link name="kod_pktippu" />
          <link name="voltage" title="Экономическое напряжение" />
          <link name="kod_v" />
          <link name="dat_s" />
          <link name="dat_po" />
          <link name="day_pokaz" />
          <link name="kod_elter" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kod_eobject_senter_nut" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_bal_point" column="kod_bal_point" />
              </call>
              <call function="in nnull" optional="1" comment="Условие на экономич.УН">
                <column table="voltage" column="voltage" />
                <useparam name="voltage" />
              </call>
              <call function="in nnull" optional="1" comment="Условия на фактич. УН">
                <column table="kod_v" column="kod_v" />
                <useparam name="voltage_fiz" />
              </call>
              <call function="le" optional="1" comment="Заданный период ограничивает точку, прибор">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
              <call function="true" />
              <call function="le" optional="1">
                <call function="latest">
                  <useparam name="date_s" />
                  <column table="kod_bal_point" column="dat_s" />
                </call>
                <call function="nvl">
                  <column table="kod_bal_point" column="dat_po" />
                  <call function="doomsday" />
                </call>
              </call>
              <call function="ge" optional="1">
                <call function="earliest">
                  <useparam name="date_po" />
                  <call function="nvl">
                    <column table="kod_bal_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <column table="kod_bal_point" column="dat_s" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="is not null">
                <column table="kod_bal_point" column="kod_bal_point" />
              </call>
              <call function="like" optional="1" comment="Поиск по фрагменту номера ПУ">
                <column table="kod_bal_point_pu" column="nom_pu" />
                <useparam name="serial_num" />
              </call>
              <call function="in" optional="1" comment="Поиск по типу ПУ">
                <column table="kod_pktippu" column="kod_pktippu" />
                <useparam name="kod_pktippu" />
              </call>
              <call function="le" optional="1" use-only-with-other="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_bal_point" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_bal_point_pu" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_pu" />
                </call>
                <call function="is not null">
                  <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                </call>
              </call>
              <call function="and" optional="1">
                <call function="=1">
                  <useparam name="pr_no_pu" />
                </call>
                <call function="is null">
                  <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                </call>
              </call>
              <call function="in nnull" optional="1" comment="Поиск по дате снятия показаний">
                <column table="day_pokaz" column="day_pokaz" />
                <useparam name="day_pokaz" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по типу учёта">
                <column table="this" column="type_of_accounting" />
                <useparam name="kod_accounting" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_seti" column="kod" />
                <useparam name="fil_tu" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                <column table="kod_elter" column="kodp" />
                <useparam name="res_tu" />
              </call>
            </call>
            <call function="and" comment="Поиск по сети">
              <call function="true" />
              <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                <column table="kod_org_group" column="kod_org_group" />
                <useparam name="kod_org_elmarket" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="bal_id_senter_nut" />
                <useparam name="bal_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                <useparam name="eobj_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                <useparam name="eobj_id" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="eobj_id" column="eobj_id" />
                <useparam name="eobj_id_tp" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_parent_eo" column="eobj_id" />
                <useparam name="eobj_id_eo_tp" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="this" column="isaskue" />
            <useparam name="in_askue" />
          </call>
        </call>
      </where>
    </query>
    <query name="43375-search(2)" title="Поиск точек ком учёта с новым прочтением схемы" timestamp="27.12.2017 13:04:01" is-report="1" can-use-simple-params="1" visible="0">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number" />
              <fieldgroup title="Интервал действия точки">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
              <usefield title="Филиал ТСО точки учёта" field="asuse_kod_seti" name="fil_tu" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org_tu" name="res_tu" title="РЭС ТСО точки учёта" />
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принад. ЦП" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eosrc(kodp_res)" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="pr_tree" title="Оборудование" clear-on-list-change="1" editable-invert="1" />
              <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" title="ТП ( КТП)" name="eobj_id_eo_tp" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Линия НН" clear-on-list-change="1">
                <listquery>
                  <query name="hv_eobject_eq_tp">
                    <withparams exclude="1">
                      <useparam name="kod_adr_m" />
                    </withparams>
                  </query>
                </listquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Признак подключения к сети" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" new-val="with_pu" column-visible="0" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_is_no_pu" />
                </defaultquery>
              </usefield>
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="1" editable="1" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m" />
                <usefield field="asuse_k_strits" name="kod_street_obj" editable="kod_adr_m" clear-on-list-change="1">
                  <listquery exclude="1">
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield name="kodp" field="asuse_kodp_kod_res" title="Потребитель (Абонент)" />
              <usefield field="asuse_kod_dog_kodp_res" title="№ Договора" name="kod_dog" />
              <usefield title="№ объекта" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
              <usefield field="asuse_kod_point_kod_res" name="kod_point" title="№ точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select call="43375-output(2)">
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
        </call>
        <column table="kod_point" column="kod_point" as="p_kod_point" title="kod_point" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" />
        </call>
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_point" all-rows="1">
            <link name="kod_nugruz" exclude="1" />
          </link>
          <link name="kod_point_pu" />
          <link name="kod_pktippu" />
          <link name="kod_point_har" />
          <link name="point_dat_s" />
          <link name="point_dat_po" />
          <link name="voltage" />
          <link name="kod_v" />
          <link name="kod_seti" />
          <link name="kod_elter" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kod_eobject_senter_nut" />
          <link name="kod_numobj_mn" />
          <link name="kodd">
            <link name="kod_s" />
          </link>
          <link name="kod_dog" />
          <link name="day_pokaz" />
          <link name="kodp" />
          <link name="kod_org_sbyt" />
          <where>
            <call function="and">
              <call function="true" />
              <call function="in" optional="1">
                <column table="voltage" column="voltage" />
                <useparam name="voltage" />
              </call>
              <call function="in" optional="1">
                <column table="kod_v" column="kod_v" />
                <useparam name="voltage_fiz" />
              </call>
              <call function="is not null">
                <column table="kod_point" column="kod_point" />
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" use-only-with-other="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
            <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
              <call function="true" />
              <call function="le" optional="1">
                <call function="latest">
                  <useparam name="date_s" />
                  <column table="kod_point" column="dat_s" />
                </call>
                <call function="nvl">
                  <column table="kod_point" column="dat_po" />
                  <call function="doomsday" />
                </call>
              </call>
              <call function="ge" optional="1">
                <call function="earliest">
                  <useparam name="date_po" />
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <column table="kod_point" column="dat_s" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="and">
                <call function="le" optional="1" use-only-with-other="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_point_pu" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point_pu" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="like" optional="1">
                  <column table="kod_point_pu" column="nom_pu" />
                  <useparam name="serial_num" />
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_pu" />
                  </call>
                  <call function="is not null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_no_pu" />
                  </call>
                  <call function="is null">
                    <column table="kod_point_pu" column="kod_point_pu" />
                  </call>
                </call>
              </call>
              <call function="in" optional="1">
                <column table="kod_pktippu" column="kod_pktippu" />
                <useparam name="kod_pktippu" />
              </call>
              <call function="in nnull" comment="Поиск по дате снятия показаний" optional="1">
                <column table="day_pokaz" column="day_pokaz" />
                <useparam name="day_pokaz" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_seti" column="kod" />
                <useparam name="fil_tu" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                <column table="kod_elter" column="kodp" />
                <useparam name="res_tu" />
              </call>
            </call>
            <call function="and" comment="Поиск по сети">
              <call function="true" />
              <call function="le" optional="1" use-only-with-other="1" comment="Ограничение характеристики периодом">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_point_har" column="dat_s" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point_har" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="and" comment="Заданный интервал ограничивает интервал действия характеристики">
                <call function="true" />
                <call function="le" optional="1">
                  <call function="latest">
                    <useparam name="date_s" />
                    <column table="kod_point_har" column="dat_s" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point_har" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <call function="ge" optional="1">
                  <call function="earliest">
                    <useparam name="date_po" />
                    <call function="nvl">
                      <column table="kod_point_har" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                  <column table="kod_point_har" column="dat_s" />
                </call>
              </call>
              <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                <column table="kod_org_group" column="kod_org_group" />
                <useparam name="kod_org_elmarket" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="bal_id_senter_nut" />
                <useparam name="bal_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                <useparam name="eobj_id_eo" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                <useparam name="eobj_id" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="eobj_id" column="eobj_id" />
                <useparam name="eobj_id_tp" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_parent_eo" column="eobj_id" />
                <useparam name="eobj_id_eo_tp" />
              </call>
            </call>
            <call function="and">
              <call function="true" />
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_dog" column="pr_active" />
                <useparam name="kod_activ_dog" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_numobj_mn" column="pr_active" />
                <useparam name="kod_activ_obj" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_dog" column="kod_dog" />
                <useparam name="kod_dog" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_numobj_mn" column="kod_numobj" />
                <useparam name="kod_numobj" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kodp" column="kodp" />
                <useparam name="kodp" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_point" column="kod_point" />
                <useparam name="kod_point" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kod_s" column="kod_m" />
                <useparam name="kod_adr_m" />
              </call>
              <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                <column table="kodd" column="kod_s" />
                <useparam name="kod_street_obj" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="this" column="isaskue" />
            <useparam name="in_askue" />
          </call>
        </call>
      </where>
    </query>
    <query name="43375-output(2)" title="Поиск точек учёта по договорам" is-report="1" timestamp="27.12.2017 13:05:33" visible="0">
      <params>
        <param name="p_kod_point" type="array" />
        <param type="number" name="ym" />
      </params>
      <select>
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
        </call>
        <column table="kod_point" column="kod_point" as="kod_point" title="kod_point" />
        <const as="type_of_accounting">0</const>
        <const as="name_type_of_accounting">'расчётный'</const>
        <call function="||" title="interval_existence" as="interval_existence">
          <call function="to_char">
            <column table="kod_point" column="dat_s" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">1</const>
            <const>'-'</const>
            <const>''</const>
          </call>
          <call function="to_char">
            <column table="kod_point" column="dat_po" />
            <const>'DD.MM.YYYY'</const>
          </call>
          <const>','</const>
          <call function="decode">
            <column table="kod_point" column="pr_active" />
            <const function="null">0</const>
            <const>'А'</const>
            <const function="null">1</const>
            <const>'У'</const>
            <const function="null">2</const>
            <const>'Н'</const>
          </call>
        </call>
        <fact column="kr_dog_date_readings" as="date_readings" title="date_readings" />
        <fact column="hr_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" />
        <fact column="hr_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" />
        <fact column="hr_pnt_pu_all_name_pk" title="name_typepu" as="name_typepu" />
        <call function="true if not null" title="isaskue" as="isaskue">
          <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" />
        </call>
        <fact column="hr_pnt_en_energy_abbr" as="energy" title="energy" />
        <fact column="hr_pnt_ini_zona_day" as="zonaofday" title="zonaofday" />
        <fact column="hr_pnt_tar_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" />
        <fact column="hk_v_sv" title="name_fact_voltage" />
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <call function="||-" as="name_eobject" title="Энергообъект">
          <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
          <column table="kod_parent_eo" column="fname" as="name_eobject" title="name_eobject" />
        </call>
        <column table="eobj_id" column="name" as="name_equipment" title="Оборудование" />
        <column table="kod_eobject_senter_nut" column="seti_senter_nut" title="Сеть ЦП" as="name_net" />
        <column table="kod_eobject_senter_nut" column="baltername_senter_nut" as="bal_name_eobject" title="Бал. принад. ЦП" />
        <column table="kod_eobject_senter_nut" column="name_senter_nut" as="name_senter_nut" title="Центр питания" />
        <column table="kod_eobject_senter_nut" column="name_fider_nut" as="name_fider_nut" title="Питающий фидер" />
        <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
        <column table="kod_org_group" column="name" as="name_org_group" title="name_org_group" />
        <column table="kod_point" column="nomer" as="number_point" title="number_point" />
        <column table="kod_point" column="name" as="name_point" title="name_point" />
        <column table="kod_point" column="type_point" as="type_point" title="type_point" />
        <fact column="kr_numobj_mn_f23_name" as="dover_sps" title="dover_sps" table="dog" />
        <fact column="kr_numobj_mn_num_obj" as="number_numobj" title="number_numobj" table="dog" />
        <fact column="kr_numobj_mn_saddr" as="numobj_addr" title="numobj_addr" table="dog" />
        <fact column="kr_numobj_mn_int_exst_inf" title="interval_existence_numobj" as="interval_existence_numobj" table="dog" />
        <fact column="kr_dog_ndog" title="number_dog" as="number_dog" table="dog" />
        <fact column="kr_dog_interval_exist" title="interval_existence_dog" as="interval_existence_dog" table="dog" />
        <fact column="kr_payer_name" as="name_payer" title="name_payer" table="dog" />
        <fact column="kr_dog_sbyt" as="name_sbyt_org" title="name_sbyt_org" table="dog" />
      </select>
      <from>
        <qube star-scheme="1">
          <where>
            <call function="and">
              <call function="true" />
              <call function="in">
                <column table="kod_point" column="kod_point" />
                <useparam name="p_kod_point" />
              </call>
              <call function="le" comment="Условие по периоду на точку, приборы, виды энергии, шкалы" optional="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </call>
          </where>
          <dimset as="dog">
            <link name="kod_dog" />
            <link name="kod_numobj_mn" />
            <where>
              <call function="true" />
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_dog" column="dat_dog" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_dog" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_numobj_mn" column="dat_create" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_numobj_mn" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <link name="kod_point" all-rows="1">
            <link name="kod_seti" />
            <link name="kod_elter" />
          </link>
          <link name="point_dat_s" />
          <link name="point_dat_po" />
          <link name="eobj_id" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="kod_org_group" />
          <link name="kod_eobject_senter_nut" />
        </qube>
      </from>
    </query>
    <query name="43375-search(3)" title="Поиск точек ком учёта с новым прочтением схемы" timestamp="29.07.2021 11:26:40" can-use-simple-params="1" visible="0" is-report="1">
      <customers>
        <customer id="102" />
      </customers>
      <content>
        <tabcontainer>
          <fieldgroup title="Основные условия">
            <fieldgroup title="Основные условия">
              <usefield title="Вариант поиска ТУ" field="asuse_method_search_point" name="kod_method_search">
                <defaultquery>
                  <query name="one" />
                </defaultquery>
              </usefield>
              <usefield title="Расчётный период" field="asuse_ym_othr" name="ym" type="number">
                <defaultquery>
                  <query name="43375-ym-val" />
                </defaultquery>
              </usefield>
              <fieldgroup title="Интервал действия точки">
                <usefield field="cmn_date" name="date_s" title="C" color="tttttt37" width-perc="50" />
                <usefield field="cmn_date" name="date_po" title="По" width-perc="50" />
              </fieldgroup>
              <usefield field="asuse_kod_type_of_accounting" name="kod_accounting" title="Вид учёта" show-nulls="1">
                <defaultquery>
                  <query name="hv_type_of_accounting_def2" />
                </defaultquery>
              </usefield>
              <usefield title="Филиал ТСО точки учёта" field="asuse_kod_seti" name="fil_tu" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_elter_org_tu" name="res_tu" title="РЭС ТСО точки учёта" />
            </fieldgroup>
            <fieldgroup title="Схема сети">
              <usefield field="asuse_kod_balter_org" column-visible="1" title="Бал. принад. ЦП" name="bal_id_eo" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eosrc(kodp_res)" name="eobj_id_eo" column-visible="1" title="Центр питания" editable="pr_tree" editable-invert="1" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id" column-visible="1" editable="1" title="Оборудование" clear-on-list-change="1" visible="1" />
              <usefield field="asuse_kod_eosrc_tp(kodp_res)" column-visible="1" editable="1" title="ТП ( КТП)" name="eobj_id_eo_tp" />
              <usefield field="asuse_kod_eobject_eq" name="eobj_id_tp" column-visible="1" editable="eobj_id_eo_tp" title="Линия НН" clear-on-list-change="1">
                <listquery>
                  <query name="hv_eobject_eq_tp">
                    <withparams exclude="1">
                      <useparam name="kod_adr_m" />
                    </withparams>
                  </query>
                </listquery>
              </usefield>
              <usefield field="asuse_kod_org_group_elmarket" show-nulls="1" name="kod_org_elmarket" title="Признак подключения к сети" />
            </fieldgroup>
            <fieldgroup title="Средство измерения">
              <usefield field="asuse_yeas_or_no" title="Счётчик" name="with_pu" />
              <usefield field="cmn_check" name="pr_pu" title="Есть счетчик" new-val="with_pu" column-visible="0" />
              <usefield field="cmn_check" name="pr_no_pu" title="Нет счетчика" column-visible="0">
                <defaultquery>
                  <query name="poisk_point_is_no_pu" />
                </defaultquery>
              </usefield>
              <usefield title="Заводской №" field="cmn_string" name="serial_num" />
              <usefield field="asuse_kod_pktippu_2" title="Модификации типа счётчиков" visible="is_pu" />
              <usefield field="asuse_in_askue" title="В АИИС КУЭ" name="in_askue" />
              <usefield field="asuse_voltage" show-nulls="1" name="voltage" title="Расчетный уровень напряжения" />
              <usefield field="asuse_kod_v" show-nulls="1" name="voltage_fiz" title="Фактический уровень напряжения" />
              <usefield field="asuse_day_pokaz" title="Дата снятия показаний" name="day_pokaz" />
            </fieldgroup>
            <usefield field="cmn_check" name="pr_useMaket" column-default="1" checked="0" column-visible="0" editable="1" title="Точки из макетов приложения 15" />
            <usefield title="Учитывать выбор в навигаторе" field="cmn_check" name="pr_tree" column-default="1" checked="1" column-visible="0" editable="1" type="number" />
            <usefield field="cmn_check" name="pr_balance" column-default="1" checked="1" column-visible="0" editable="1" type="number" title="Модуль балансы+" visible="0" />
            <usefield field="cmn_check" name="is_method_search_ym" column-default="1" checked="1" column-visible="0" title="Метод поиска точек по периоду">
              <defaultquery>
                <query name="poisk_point_is_ym" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_method_search_date" column-default="1" checked="1" column-visible="0" title="Метод  поиска точек по интервалу">
              <defaultquery>
                <query name="poisk_point_is_date" />
              </defaultquery>
            </usefield>
            <usefield field="cmn_check" name="is_show_eq" column-default="1" checked="1" column-visible="1" title="Показывать ли выбор фидера" exclude="1">
              <defaultquery>
                <query name="poisk_point_show_eq" />
              </defaultquery>
            </usefield>
          </fieldgroup>
          <fieldgroup title="Расчётный учёт">
            <fieldgroup title="Договор энергоснабжения">
              <usefield title="Сбытовая организация" field="asuse_kod_org_sbyt" name="kod_org_sbyt" />
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_dog" />
            </fieldgroup>
            <fieldgroup title="Объект">
              <fieldgroup title="Адреc">
                <usefield field="asuse_adr_m" name="kod_adr_m" />
                <usefield field="asuse_k_strits" name="kod_street_obj" editable="kod_adr_m" clear-on-list-change="1">
                  <listquery exclude="1">
                    <query name="k_strits-list">
                      <withparams>
                        <useparam name="kod_adr_m" />
                      </withparams>
                    </query>
                  </listquery>
                </usefield>
              </fieldgroup>
              <usefield field="asuse_prizn_activ_dog" title="Статус" name="kod_activ_obj" />
            </fieldgroup>
            <fieldgroup title="Точный поиск">
              <usefield name="kodp" field="asuse_kodp_kod_res" title="Потребитель (Абонент)" />
              <usefield field="asuse_kod_dog_kodp_res" title="№ Договора" name="kod_dog" />
              <usefield title="№ объекта" field="asuse_kod_numobj_kod_res" name="kod_numobj" />
              <usefield field="asuse_kod_point_kod_res" name="kod_point" title="№ точки" />
            </fieldgroup>
          </fieldgroup>
        </tabcontainer>
      </content>
      <select call="43375-output(3)">
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
          <column table="kod_bal_point" column="kod_bal_point" />
        </call>
        <column table="kod_point" column="kod_point" as="p_kod_point" title="kod_point" />
        <column table="kod_bal_point" column="kod_bal_point" as="p_kod_bal_point" title="kod_point_bal_point" />
        <call function="case" type="number" as="type_of_accounting">
          <call function="when">
            <call function="is not null">
              <column table="kod_point" column="kod_point" />
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="kod_bal_point" column="kod_bal_point" />
            </call>
            <const>1</const>
          </call>
        </call>
        <column table="eobj_id" column="eobj_id" as="p_eobj_id" />
      </select>
      <select exclude="1">
        <column as="kod_point" table="a" column="id_point">1</column>
        <column as="kod_bal_point" table="a" column="id_point">1</column>
        <column as="type_of_accounting" table="a" column="type_calc">1</column>
        <column as="name_type_of_accounting" table="a" column="name_calc">1</column>
        <column as="number_point" table="a" column="name_point">1</column>
        <column as="name_point" table="a" column="name_point">1</column>
        <column as="type_point" table="a" column="name_type">1</column>
        <column as="interval_existence" table="a" column="state_point">1</column>
        <column as="date_readings" table="a" column="day_of_meters">1</column>
        <column as="nom_pu" table="a" column="nom_pu">1</column>
        <column as="interval_existence_pu_all" table="a" column="state_pu">1</column>
        <column as="name_typepu" table="a" column="name_type_pu">1</column>
        <column as="energy" table="a" column="energy">1</column>
        <column as="isaskue" table="a" column="askue">1</column>
        <column as="name_econ_voltage" table="a" column="econ_voltage">1</column>
        <column as="name_fact_voltage" table="a" column="fiz_voltage">1</column>
        <column as="name_fil_tu" table="a" column="name_fsk">1</column>
        <column as="name_res_tu" table="a" column="name_rsk">1</column>
        <column as="name_net" table="a" column="seti_senter_nut">1</column>
        <column as="bal_name_eobject" table="a" column="baltername_senter_nut">1</column>
        <column as="name_senter_nut" table="a" column="name_senter_nut">1</column>
        <column as="name_fider_nut" table="a" column="name_fider_nut">1</column>
        <column as="kind_eobject" table="a" column="type_eo">1</column>
        <column as="name_eobject" table="a" column="name_eo">1</column>
        <column as="name_equipment" table="a" column="name_eq">1</column>
        <column as="name_org_group" table="a" column="type_connect">1</column>
        <column as="dover_sps" table="a" column="attorney">1</column>
        <column as="kod_numobj" table="a" column="id_obj">1</column>
        <column as="number_numobj" table="a" column="num_obj">1</column>
        <column as="numobj_addr" table="a" column="addr_obj">1</column>
        <column as="interval_existence_numobj" table="a" column="status_obj">1</column>
        <column as="kod_dog" table="a" column="id_dog">1</column>
        <column as="number_dog" table="a" column="num_dog">1</column>
        <column as="interval_existence_dog" table="a" column="status_dog">1</column>
        <column as="name_sbyt_org" table="a" column="name_sbyt_org">1</column>
        <column as="kod_payer" table="a" column="id_customer">1</column>
        <column as="name_payer" table="a" column="name_customer">1</column>
      </select>
      <from>
        <qube>
          <link name="kod_pktippu" />
          <link name="voltage" title="Экономическое напряжение" />
          <link name="kod_seti" title="Сети" />
          <link name="kod_org_group" />
          <link name="kod_parent_eo" title="Энергообъект" />
          <link name="kod_srckind" />
          <link name="eobj_id" />
          <link name="kod_v" />
          <link name="day_pokaz" title="Дата снятия показаний" />
          <link name="kod_elter" />
          <link name="kod_eobject_senter_nut" />
          <dimset as="comm">
            <link name="kod_point" all-rows="1" />
            <link name="kod_point_pu" />
            <link name="kod_point_har" />
            <link name="point_dat_s" />
            <link name="point_dat_po" />
            <link name="kod_numobj_mn" />
            <link name="kodd">
              <link name="kod_s" />
            </link>
            <link name="kod_dog" />
            <link name="kodp" />
            <link name="kod_org_sbyt" />
            <where>
              <call function="true" />
              <call function="in" optional="1">
                <const>0</const>
                <useparam name="kod_accounting" />
              </call>
              <call function="and" optional="1">
                <call function="true" />
                <call function="=" optional="1">
                  <const>1</const>
                  <useparam name="pr_useMaket" />
                </call>
                <call function="=">
                  <column table="kod_point" column="use_maket" />
                  <const>1</const>
                </call>
              </call>
              <call function="and">
                <call function="true" />
                <call function="in" optional="1">
                  <column table="voltage" column="voltage" />
                  <useparam name="voltage" />
                </call>
                <call function="in" optional="1">
                  <column table="kod_v" column="kod_v" />
                  <useparam name="voltage_fiz" />
                </call>
                <call function="is not null">
                  <column table="kod_point" column="kod_point" />
                </call>
                <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="point_dat_s" column="val" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="point_dat_po" column="val" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="le" optional="1" use-only-with-other="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_point" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
              </call>
              <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
                <call function="true" />
                <call function="le" optional="1">
                  <call function="latest">
                    <useparam name="date_s" />
                    <column table="kod_point" column="dat_s" />
                  </call>
                  <call function="nvl">
                    <column table="kod_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <call function="ge" optional="1">
                  <call function="earliest">
                    <useparam name="date_po" />
                    <call function="nvl">
                      <column table="kod_point" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                  <column table="kod_point" column="dat_s" />
                </call>
              </call>
              <call function="and">
                <call function="true" />
                <call function="and">
                  <call function="le" optional="1" use-only-with-other="1">
                    <call function="latest">
                      <call function="ym begin time">
                        <useparam name="ym" />
                      </call>
                      <column table="kod_point_pu" column="dat_s" />
                    </call>
                    <call function="earliest">
                      <call function="ym end time">
                        <useparam name="ym" />
                      </call>
                      <call function="nvl">
                        <column table="kod_point_pu" column="dat_po" />
                        <call function="doomsday" />
                      </call>
                    </call>
                  </call>
                  <call function="like" optional="1">
                    <column table="kod_point_pu" column="nom_pu" />
                    <useparam name="serial_num" />
                  </call>
                  <call function="and" optional="1">
                    <call function="=1">
                      <useparam name="pr_pu" />
                    </call>
                    <call function="is not null">
                      <column table="kod_point_pu" column="kod_point_pu" />
                    </call>
                  </call>
                  <call function="and" optional="1">
                    <call function="=1">
                      <useparam name="pr_no_pu" />
                    </call>
                    <call function="is null">
                      <column table="kod_point_pu" column="kod_point_pu" />
                    </call>
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="kod_pktippu" column="kod_pktippu" />
                  <useparam name="kod_pktippu" />
                </call>
                <call function="in nnull" comment="Поиск по дате снятия показаний" optional="1">
                  <column table="day_pokaz" column="day_pokaz" />
                  <useparam name="day_pokaz" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_seti" column="kod" />
                  <useparam name="fil_tu" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                  <column table="kod_elter" column="kodp" />
                  <useparam name="res_tu" />
                </call>
              </call>
              <call function="and" comment="Поиск по сети">
                <call function="true" />
                <call function="le" optional="1" use-only-with-other="1" comment="Ограничение характеристики периодом">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_point_har" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point_har" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="and" comment="Заданный интервал ограничивает интервал действия характеристики">
                  <call function="true" />
                  <call function="le" optional="1">
                    <call function="latest">
                      <useparam name="date_s" />
                      <column table="kod_point_har" column="dat_s" />
                    </call>
                    <call function="nvl">
                      <column table="kod_point_har" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                  <call function="ge" optional="1">
                    <call function="earliest">
                      <useparam name="date_po" />
                      <call function="nvl">
                        <column table="kod_point_har" column="dat_po" />
                        <call function="doomsday" />
                      </call>
                    </call>
                    <column table="kod_point_har" column="dat_s" />
                  </call>
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_point" column="kod_org_group" />
                  <useparam name="kod_org_elmarket" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_eobject_senter_nut" column="bal_id_senter_nut" />
                  <useparam name="bal_id_eo" />
                </call>
                <call function="and">
                  <call function="true" />
                  <call function="or" optional="1">
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                      <useparam name="eobj_id_eo" />
                    </call>
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_parent_eo" column="eobj_id" />
                      <useparam name="eobj_id_eo" />
                    </call>
                  </call>
                </call>
                <call function="and">
                  <call function="true" />
                  <call function="or" optional="1">
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                      <useparam name="eobj_id" />
                    </call>
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="eobj_id" column="eobj_id" />
                      <useparam name="eobj_id" />
                    </call>
                  </call>
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="eobj_id" column="eobj_id" />
                  <useparam name="eobj_id_tp" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_parent_eo" column="eobj_id" />
                  <useparam name="eobj_id_eo_tp" />
                </call>
              </call>
              <call function="and">
                <call function="true" />
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_dog" column="pr_active" />
                  <useparam name="kod_activ_dog" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_numobj_mn" column="pr_active" />
                  <useparam name="kod_activ_obj" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_dog" column="kod_dog" />
                  <useparam name="kod_dog" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_numobj_mn" column="kod_numobj" />
                  <useparam name="kod_numobj" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kodp" column="kodp" />
                  <useparam name="kodp" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_point" column="kod_point" />
                  <useparam name="kod_point" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_s" column="kod_m" />
                  <useparam name="kod_adr_m" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kodd" column="kod_s" />
                  <useparam name="kod_street_obj" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="tech">
            <link name="kod_bal_point" all-rows="1" />
            <link name="kod_bal_point_pu" />
            <link name="dat_s" />
            <link name="dat_po" />
            <where>
              <call function="true" />
              <call function="in" optional="1">
                <const>1</const>
                <useparam name="kod_accounting" />
              </call>
              <call function="and">
                <call function="true" />
                <call function="is not null">
                  <column table="kod_bal_point" column="kod_bal_point" />
                </call>
                <call function="in nnull" optional="1" comment="Условие на экономич.УН">
                  <column table="voltage" column="voltage" />
                  <useparam name="voltage" />
                </call>
                <call function="in nnull" optional="1" comment="Условия на фактич. УН">
                  <column table="kod_v" column="kod_v" />
                  <useparam name="voltage_fiz" />
                </call>
                <call function="le" optional="1" comment="Заданный период ограничивает точку, прибор">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="dat_s" column="val" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="dat_po" column="val" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
              </call>
              <call function="and" comment="Заданный интервал ограничивает интервал действия точки">
                <call function="true" />
                <call function="le" optional="1">
                  <call function="latest">
                    <useparam name="date_s" />
                    <column table="kod_bal_point" column="dat_s" />
                  </call>
                  <call function="nvl">
                    <column table="kod_bal_point" column="dat_po" />
                    <call function="doomsday" />
                  </call>
                </call>
                <call function="ge" optional="1">
                  <call function="earliest">
                    <useparam name="date_po" />
                    <call function="nvl">
                      <column table="kod_bal_point" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                  <column table="kod_bal_point" column="dat_s" />
                </call>
              </call>
              <call function="and">
                <call function="true" />
                <call function="is not null">
                  <column table="kod_bal_point" column="kod_bal_point" />
                </call>
                <call function="like" optional="1" comment="Поиск по фрагменту номера ПУ">
                  <column table="kod_bal_point_pu" column="nom_pu" />
                  <useparam name="serial_num" />
                </call>
                <call function="in" optional="1" comment="Поиск по типу ПУ">
                  <column table="kod_pktippu" column="kod_pktippu" />
                  <useparam name="kod_pktippu" />
                </call>
                <call function="le" optional="1" use-only-with-other="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="kod_bal_point" column="dat_s" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="kod_bal_point_pu" column="dat_po" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_pu" />
                  </call>
                  <call function="is not null">
                    <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                  </call>
                </call>
                <call function="and" optional="1">
                  <call function="=1">
                    <useparam name="pr_no_pu" />
                  </call>
                  <call function="is null">
                    <column table="kod_bal_point_pu" column="kod_bal_point_pu" />
                  </call>
                </call>
                <call function="in nnull" optional="1" comment="Поиск по дате снятия показаний">
                  <column table="day_pokaz" column="day_pokaz" />
                  <useparam name="day_pokaz" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_seti" column="kod" />
                  <useparam name="fil_tu" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к рэс">
                  <column table="kod_elter" column="kodp" />
                  <useparam name="res_tu" />
                </call>
              </call>
              <call function="and" comment="Поиск по сети">
                <call function="true" />
                <call function="in nnull" optional="1" comment="Поиск по группе балансового собственника оборудования">
                  <column table="kod_org_group" column="kod_org_group" />
                  <useparam name="kod_org_elmarket" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_eobject_senter_nut" column="bal_id_senter_nut" />
                  <useparam name="bal_id_eo" />
                </call>
                <call function="and">
                  <call function="true" />
                  <call function="or" optional="1">
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_eobject_senter_nut" column="id_senter_nut" />
                      <useparam name="eobj_id_eo" />
                    </call>
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_parent_eo" column="eobj_id" />
                      <useparam name="eobj_id_eo" />
                    </call>
                  </call>
                </call>
                <call function="and">
                  <call function="true" />
                  <call function="or" optional="1">
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="kod_eobject_senter_nut" column="id_fider_nut" />
                      <useparam name="eobj_id" />
                    </call>
                    <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                      <column table="eobj_id" column="eobj_id" />
                      <useparam name="eobj_id" />
                    </call>
                  </call>
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="eobj_id" column="eobj_id" />
                  <useparam name="eobj_id_tp" />
                </call>
                <call function="in nnull" optional="1" comment="Поиск по принадлежности к филиалу">
                  <column table="kod_parent_eo" column="eobj_id" />
                  <useparam name="eobj_id_eo_tp" />
                </call>
              </call>
            </where>
          </dimset>
        </qube>
        <query name="hr_point_search_system" as="a" exclude="1" comment="ffdf" />
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <call function="decode" as="isaskue" type="number">
              <column table="this" column="type_of_accounting" />
              <const>0</const>
              <call function="true if not null" title="isaskue" as="isaskue">
                <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" table="comm" />
              </call>
              <const>1</const>
              <call function="true if not null" title="isaskue" as="isaskue">
                <fact column="hr_pnt_bal_en_askue" as="isaskue" title="isaskue" table="tech" />
              </call>
            </call>
            <useparam name="in_askue" />
          </call>
          <call function="and" optional="1">
            <call function="true" />
            <call function="=" optional="1">
              <const>1</const>
              <useparam name="pr_useMaket" />
            </call>
            <call function="is not null">
              <column table="kod_point" column="kod_point" />
            </call>
          </call>
        </call>
      </where>
      <where exclude="1">
        <call function="and">
          <call function="true" />
          <call function="in" optional="1">
            <column table="a" column="type_calc" />
            <useparam name="kod_accounting" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp_fsk" />
            <useparam name="fil_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="kodp_rsk" />
            <useparam name="res_tu" />
          </call>
          <call function="in" optional="1">
            <column table="a" column="id_day_of_meters" />
            <useparam name="day_pokaz" />
          </call>
          <call function="like" optional="1" comment="Поиск по фрагменту номера ПУ">
            <column table="a" column="nom_pu" />
            <useparam name="serial_num" />
          </call>
          <call function="in" optional="1" comment="Поиск по типу ПУ">
            <column table="a" column="id_point" />
            <useparam name="kod_pktippu" />
          </call>
        </call>
      </where>
    </query>
    <query name="43375-output(3)" title="Поиск точек учёта по договорам" timestamp="11.11.2018 02:10:14" visible="0" is-report="1">
      <params>
        <param type="number" name="ym" />
        <param type="array" name="kod_accounting" />
        <param name="p_kod_point" type="array" />
        <param name="p_kod_bal_point" type="array" />
        <param name="p_eobj_id" type="array" />
      </params>
      <select>
        <call function="||-" as="id" key="1">
          <call function="rownum" />
          <column table="kod_point" column="kod_point" />
          <column table="kod_bal_point" column="kod_bal_point" />
        </call>
        <column table="kod_point" column="kod_point" />
        <column table="kod_bal_point" column="kod_bal_point" />
        <call function="case" type="number" as="type_of_accounting">
          <call function="when">
            <call function="is not null">
              <column table="kod_point" column="kod_point" />
            </call>
            <const>0</const>
          </call>
          <call function="when">
            <call function="is not null">
              <column table="kod_bal_point" column="kod_bal_point" />
            </call>
            <const>1</const>
          </call>
        </call>
        <call function="decode" as="name_type_of_accounting" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <const>'расчётный'</const>
          <const>1</const>
          <const>'технический'</const>
        </call>
        <call function="decode" as="interval_existence" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <call function="||" title="interval_existence" as="interval_existence">
            <call function="to_char">
              <column table="kod_point" column="dat_s" />
              <const>'DD.MM.YYYY'</const>
            </call>
            <call function="decode">
              <column table="kod_point" column="pr_active" />
              <const function="null">1</const>
              <const>'-'</const>
              <const>''</const>
            </call>
            <call function="to_char">
              <column table="kod_point" column="dat_po" />
              <const>'DD.MM.YYYY'</const>
            </call>
            <const>','</const>
            <call function="decode">
              <column table="kod_point" column="pr_active" />
              <const function="null">0</const>
              <const>'А'</const>
              <const function="null">1</const>
              <const>'У'</const>
              <const function="null">2</const>
              <const>'Н'</const>
            </call>
          </call>
          <const>1</const>
          <call function="||" title="interval_existence" as="interval_existence">
            <call function="to_char">
              <column table="kod_bal_point" column="dat_s" />
              <const>'DD.MM.YYYY'</const>
            </call>
            <call function="decode">
              <column table="kod_bal_point" column="dat_po" />
              <call function="null">NULL</call>
              <const>''</const>
              <const>'-'</const>
            </call>
            <call function="to_char">
              <column table="kod_bal_point" column="dat_po" />
              <const>'DD.MM.YYYY'</const>
            </call>
            <const>','</const>
            <call function="decode">
              <column table="kod_bal_point" column="dat_po" />
              <call function="null">NULL</call>
              <const>'А'</const>
              <const>'У'</const>
            </call>
          </call>
        </call>
        <call function="decode" as="date_readings" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="kr_dog_date_readings" as="date_readings" title="date_readings" table="comm" />
          <const>1</const>
          <call function="||" title="date_readings" as="date_readings">
            <column table="day_pokaz" column="name" />
            <call function="decode">
              <column table="day_pokaz" column="day_pokaz" />
              <const function="null">0</const>
              <const>''</const>
              <const>'-ого числа след.мес.'</const>
            </call>
          </call>
        </call>
        <call function="decode" as="nom_pu" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" table="comm" />
          <const>1</const>
          <fact column="hr_bal_pnt_pu_all_nom_pu" as="nom_pu" title="nom_pu" table="tech" />
        </call>
        <call function="decode" as="interval_existence_pu_all" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" table="comm" />
          <const>1</const>
          <fact column="hr_bal_pnt_pu_all_existint" as="interval_existence_pu_all" title="interval_existence_pu_all" table="tech" />
        </call>
        <call function="decode" as="name_typepu" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_pu_all_name_pk" title="name_typepu" as="name_typepu" table="comm" />
          <const>1</const>
          <fact column="hr_bal_point_pu_all_name_pk" title="name_typepu" as="name_typepu" table="tech" />
        </call>
        <call function="decode" as="energy" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_en_energy_abbr" as="energy" title="energy" table="comm" />
          <const>1</const>
          <fact column="hr_bal_point_en_energy_abbr" as="energy" title="energy" table="tech" />
        </call>
        <call function="decode" as="isaskue" type="number">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <call function="true if not null" title="isaskue" as="isaskue">
            <fact column="hr_pnt_en_kod_point_askue" as="isaskue" title="isaskue" table="comm" />
          </call>
          <const>1</const>
          <call function="true if not null" title="isaskue" as="isaskue">
            <fact column="hr_pnt_bal_en_askue" as="isaskue" title="isaskue" table="tech" />
          </call>
        </call>
        <call function="decode" as="zonaofday" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_ini_zona_day" as="zonaofday" title="zonaofday" table="comm" />
          <const>1</const>
          <fact column="hr_bal_point_ini_zona_day" as="zonaofday" title="zonaofday" table="tech" />
        </call>
        <call function="decode" as="name_econ_voltage" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hr_pnt_tar_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" table="comm" />
          <const>1</const>
          <fact column="hr_bal_pnt_h_all_volt_abbr" as="name_econ_voltage" title="name_econ_voltage" table="tech" />
        </call>
        <call function="decode" as="name_fact_voltage" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <fact column="hk_v_sv" title="name_fact_voltage" table="comm" />
          <const>1</const>
          <column table="kod_v" column="sv" title="name_fact_voltage" as="name_fact_voltage" />
        </call>
        <column table="kod_seti" column="aname" title="name_fil_tu" as="name_fil_tu" />
        <column table="kod_elter" column="altername" title="name_res_tu" as="name_res_tu" />
        <call function="||-" as="name_eobject" title="Энергообъект">
          <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
          <column table="kod_parent_eo" column="dnum" as="name_eobject" title="name_eobject" />
        </call>
        <call function="decode" as="name_org_group" type="string" title="name_org_group">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <column table="kod_point" column="net_point" as="name_org_group" />
          <const>1</const>
          <column table="kod_org_group" column="name" as="name_org_group" title="name_org_group" />
        </call>
        <column table="kod_srckind" column="sname" as="kind_eobject" title="kind_eobject" />
        <column table="kod_eobject_senter_nut" column="name_fider_nut" as="name_fider_nut" title="Питающий фидер" />
        <column table="kod_eobject_senter_nut" column="name_senter_nut" as="name_senter_nut" title="Центр питания" />
        <column table="kod_eobject_senter_nut" column="baltername_senter_nut" as="bal_name_eobject" title="Бал. принад. ЦП" />
        <column table="kod_eobject_senter_nut" column="seti_senter_nut" title="Сеть ЦП" as="name_net" />
        <column table="eobj_id" column="name" as="name_equipment" title="Название оборудования" />
        <call function="decode" as="number_point" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <column table="kod_point" column="nomer" as="number_point" title="number_point" />
          <const>1</const>
          <column table="kod_bal_point" column="nomer" as="number_point" title="number_point" />
        </call>
        <call function="decode" as="name_point" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <column table="kod_point" column="name" as="name_point" title="name_point" />
          <const>1</const>
          <column table="kod_bal_point" column="name" as="name_point" title="name_point" />
        </call>
        <call function="decode" as="type_point" type="string">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <column table="kod_point" column="type_point" as="type_point" title="type_point" />
          <const>1</const>
          <column table="kod_bal_point" column="name_point" as="type_point" title="type_point" />
        </call>
        <call function="decode" as="dover_sps" type="string" title="dover_sps" comment="доверенность">
          <column table="this" column="type_of_accounting" />
          <const>0</const>
          <column table="kod_point" column="dover" as="dover_sps" title="type_point" />
          <const>1</const>
          <const table="kod_bal_point" column="name_point" as="type_point" title="type_point">''</const>
        </call>
        <fact column="kr_numobj_mn_num_obj" as="number_numobj" title="number_numobj" table="dog" />
        <fact column="kr_numobj_mn_saddr" as="numobj_addr" title="numobj_addr" table="dog" />
        <fact column="kr_numobj_mn_int_exst_inf" title="interval_existence_numobj" as="interval_existence_numobj" table="dog" />
        <fact column="kr_dog_ndog" title="number_dog" as="number_dog" table="dog" />
        <fact column="kr_dog_interval_exist" title="interval_existence_dog" as="interval_existence_dog" table="dog" />
        <fact column="kr_payer_name" as="name_payer" title="name_payer" table="dog" />
        <fact column="kr_dog_sbyt" as="name_sbyt_org" title="name_sbyt_org" table="dog" />
      </select>
      <from>
        <qube>
          <link name="kod_org_group" />
          <link name="kod_parent_eo" />
          <link name="kod_srckind" />
          <link name="eobj_id" />
          <link name="kod_eobject_senter_nut" />
          <link name="kod_seti" />
          <link name="kod_elter" />
          <dimset as="dog">
            <link name="kod_dog" />
            <link name="kod_numobj_mn" />
            <link name="kod_point" all-rows="1" />
            <link name="point_dat_s" />
            <link name="point_dat_po" />
            <where>
              <call function="true" />
              <call function="in" optional="1">
                <const>0</const>
                <useparam name="kod_accounting" />
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_dog" column="dat_dog" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_dog" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="le" optional="1" comment="Условие по периоду на точку, приборы, виды энергии, шкалы">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="kod_numobj_mn" column="dat_create" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="kod_numobj_mn" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
              <call function="in">
                <column table="kod_point" column="kod_point" />
                <useparam name="p_kod_point" />
              </call>
              <call function="le" comment="Условие по периоду на точку, приборы, виды энергии, шкалы" optional="1">
                <call function="latest">
                  <call function="ym begin time">
                    <useparam name="ym" />
                  </call>
                  <column table="point_dat_s" column="val" />
                </call>
                <call function="earliest">
                  <call function="ym end time">
                    <useparam name="ym" />
                  </call>
                  <call function="nvl">
                    <column table="point_dat_po" column="val" />
                    <call function="doomsday" />
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="comm">
            <link name="kod_point" all-rows="1">
              <link name="kod_seti" />
              <link name="kod_elter" />
            </link>
            <link name="point_dat_s" />
            <link name="point_dat_po" />
            <where>
              <call function="and">
                <call function="true" />
                <call function="in" optional="1">
                  <const>0</const>
                  <useparam name="kod_accounting" />
                </call>
                <call function="in">
                  <column table="kod_point" column="kod_point" />
                  <useparam name="p_kod_point" />
                </call>
                <call function="le" comment="Условие по периоду на точку, приборы, виды энергии, шкалы" optional="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="point_dat_s" column="val" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="point_dat_po" column="val" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="tech">
            <link name="kod_bal_point" all-rows="1" />
            <link name="dat_s" />
            <link name="dat_po" />
            <link name="day_pokaz" />
            <link name="kod_v" />
            <where>
              <call function="and">
                <call function="true" />
                <call function="in" optional="1">
                  <const>1</const>
                  <useparam name="kod_accounting" />
                </call>
                <call function="in">
                  <column table="kod_bal_point" column="kod_bal_point" />
                  <useparam name="p_kod_bal_point" />
                </call>
                <call function="le" comment="Условие по периоду на точку, приборы, виды энергии, шкалы" optional="1">
                  <call function="latest">
                    <call function="ym begin time">
                      <useparam name="ym" />
                    </call>
                    <column table="dat_s" column="val" />
                  </call>
                  <call function="earliest">
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                    <call function="nvl">
                      <column table="dat_po" column="val" />
                      <call function="doomsday" />
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <where>
        <call function="and">
          <call function="true" />
          <call function="in">
            <column table="eobj_id" column="eobj_id" />
            <useparam name="p_eobj_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="43375-ym-val" timestamp="07.12.2017 19:26:57">
      <select>
        <column table="a" column="val" />
      </select>
      <from>
        <table name="43375-ym-val" as="a" view="1" />
      </from>
    </query>
    <query name="poisk_point_show_eq" timestamp="08.04.2020 16:52:20">
      <params>
        <param type="number" name="pr_balance" />
      </params>
      <select>
        <call function="if" as="val" type="number">
          <call function="in">
            <const>1</const>
            <useparam name="pr_balance" />
          </call>
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
  </queries>
  <views>
    <view name="43375-ym-val">
      SELECT TO_NUMBER(trim(  PR.VAL)) as val
      FROM HV_SEARCH_PRMS PR
      WHERE PR.PRMNAME = 'CUR_YM'
    </view>
  </views>
</root>