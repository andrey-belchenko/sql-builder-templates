<?xml version="1.0" encoding="utf-8"?>
<root>
  <forms>
    <form name="21033-new" with-behavior="0" timestamp="15.05.2024 12:49:29">
      <content>
        <field name="ym" controlType="UICombo" title="Отчетный период">
          <listquery>
            <query name="kr_calc_list" />
          </listquery>
          <defaultquery>
            <query name="kr_calc_max" />
          </defaultquery>
        </field>
        <field name="date" controlType="UIDate" title="Дата" valuequery="ym-end-date" />
        <usefield field="asuse_dep" />
        <usefield field="asuse_kod_group_cust_parent" />
        <usefield field="asuse_kod_group_cust" />
        <field name="p_cat_rep" type="string" visible="0" controlType="UIText" title="Категория отчета">
          <defaultquery>
            <query name="category_report_num_4" />
          </defaultquery>
        </field>
      </content>
    </form>
    <form name="21033-new-rep" with-behavior="0" timestamp="15.05.2024 12:50:05">
      <content>
        <field name="ym" controlType="UICombo" title="Отчетный период">
          <listquery>
            <query name="kr_calc_list" />
          </listquery>
          <defaultquery>
            <query name="kr_calc_max" />
          </defaultquery>
        </field>
        <field name="date" controlType="UIDate" title="Дата" valuequery="ym-end-date" />
        <usefield field="asuse_dep" />
        <usefield field="asuse_kod_group_cust_parent" />
        <usefield field="asuse_kod_group_cust" />
        <field name="p_cat_rep" type="string" visible="0" controlType="UIText" title="Категория отчета">
          <defaultquery>
            <query name="category_report_num_5" />
          </defaultquery>
        </field>
      </content>
    </form>
  </forms>
  <reports>
    <report name="21033-new-rep-nalog" title="Сомнительная задолженность налоговая (Ведомость,Акт)" form="21033-new" folder="somn_dolg" timestamp="07.06.2024 17:44:28">
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="21033-ved.xml" title="Ведомость для налогового учета" />
          <template name="21033-akt.xml" title="Акт для налогового учета" />
          <!--<template name="21033-ved-buh.xml" title="Ведомость для бухгалтерского учета" />
          <template name="21033-akt-buh.xml" title="Акт для бухгалтерского учета" />-->
        </excel>
      </print-templates>
      <params>
        <param name="date" />
        <param name="ym" />
        <param name="dep" />
        <param name="kod_group_cust_parent" />
        <param name="kod_group_cust" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <queries>
        <query name="21033-12-nal" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
        <query name="21033-12-title-nal" as="b" union="0">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="21033-new-rep-buh" title="Сомнительная задолженность бухгалтерская (Ведомость,Акт)" form="21033-new" folder="somn_dolg" timestamp="15.05.2024 11:25:32">
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <!--<template name="21033-ved.xml" title="Ведомость для налогового учета" />
          <template name="21033-akt.xml" title="Акт для налогового учета" />-->
          <template name="21033-ved-buh.xml" title="Ведомость для бухгалтерского учета" />
          <template name="21033-akt-buh.xml" title="Акт для бухгалтерского учета" />
        </excel>
      </print-templates>
      <params>
        <param name="date" />
        <param name="ym" />
        <param name="dep" />
        <param name="kod_group_cust_parent" />
        <param name="kod_group_cust" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <queries>
        <query name="21033-12-buh" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
        <query name="21033-12-title-buh" as="b" union="0">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
          </withparams>
        </query>
      </queries>
    </report>
    <report name="21033-dog-new-rep" title="Сомнительная задолженность (Справка)" form="21033-new-rep" folder="somn_dolg" timestamp="15.05.2024 13:06:14">
      <columns>
        <column table="a" name="rwn" />
        <column table="a" name="kodp" />
        <column table="a" name="dep_name" />
        <column table="a" name="nump" />
        <column table="a" name="inn_kpp" type="string" title="ИНН/КПП контрагента" />
        <column table="a" name="payer_name" title="Наименование контрагента" />
        <column table="a" name="ostatok_full" />
        <column table="a" name="dolg" title="Сумма, включаемая в Резерв" />
        <band title="Изменение величины резерва по сомнительным долгам в целях бухгалтерсокго учета">
          <band title="Отчисления в резерв">
            <column table="a" name="nachisl" title="за отчетный месяц" />
            <column table="a" name="nachisl_god" title="с начала года" />
          </band>
          <band title="Погашение, восстановление резерва">
            <column table="a" name="opl" title="за отчетный месяц" />
            <column table="a" name="opl_god" title="с начала года" />
          </band>
          <band title="Списание за счет резерва">
            <column table="a" name="spis" title="за отчетный месяц" />
            <column table="a" name="spis_god" title="с начала года" />
          </band>
        </band>
      </columns>
      <customers>
        <customer id="101" />
      </customers>
      <print-templates>
        <excel>
          <template name="21033-spravka.xml" title="Справка" />
        </excel>
      </print-templates>
      <params>
        <param name="date" />
        <param name="ym" />
        <param name="dep" />
        <param name="kod_group_cust_parent" />
        <param name="kod_group_cust" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <queries>
        <query name="21033-12-dog-buh" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
        <query name="21033-12-title-buh" as="b" union="0">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </queries>
    </report>
  </reports>
  <queries>
    <!--<query name="21033-new" pushpred="1">
      <params>
        <param name="date" type="date">
          <const>DATE'2014-03-01'</const>
        </param>
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп">
          <call function="order by simple">
            <column table="a" column="ndog"/>
            <column table="a" column="dat_sf"/>
          </call>
        </call>
        <column table="a" column="*"/>
      </select>
      <from>
        <query name="21033-new2" as="a">
          <withparams>
            <useparam name="date"/>
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=">
            <column table="a" column="ostatok_full"/>
            <const>0</const>
          </call>
        </call>
      </where>
    </query>-->
    <query name="21033">
      <params>
        <param name="date" type="date">
          <const>DATE'2014-03-01'</const>
        </param>
        <param name="dep" type="array" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп">
          <call function="order by simple">
            <column table="dog" column="ndog" />
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="kod_sf" key="1" />
        <call function="||" as="inn_kpp" title="ИНН/КПП">
          <column table="payer" column="inn" />
          <const>' / '</const>
          <column table="payer" column="kpp" />
        </call>
        <column table="payer" column="name" as="payer_name" />
        <column table="dog" column="dep" />
        <column table="dog" column="kod_dog" />
        <column table="dog" column="ndog" />
        <column table="dep" column="name" as="dep_name" title="Отделение" />
        <column table="payer" column="kodp" />
        <column table="payer" column="nump" />
        <call function="if" as="udo" title="Банкрот" type="string">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <const>'Банкрот'</const>
        </call>
        <column table="payer" column="datepublic" />
        <column table="dog" column="name" as="dog_name" />
        <call function="||" as="name">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="a" column="kod_sf_first" />
              </call>
              <call function="lt">
                <column table="this" column="dolg" />
                <const>0</const>
              </call>
            </call>
            <const>'Корректировочная счет-фактура № '</const>
            <const>'Акт приёма-передачи № '</const>
          </call>
          <column table="a" column="nom_sf" />
          <const>' от '</const>
          <call function="date to char">
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="name" as="name_sf" />
        <column table="sf_date" column="dolg" as="nachisl" />
        <column table="a" column="nachisl" as="nachisl_sf" />
        <column table="a" column="dat_sf" title="Дата возникновения задолженности" />
        <column table="kod_deb" column="dat_bzad" />
        <column table="sf_date" column="opl" />
        <column table="sf_date" column="ostatok" />
        <column table="sf_date" column="nach_recalc" />
        <column table="sf_date" column="opl_recalc" />
        <column table="sf_date" column="nach_recalc1" />
        <column table="sf_date" column="opl_recalc1" />
        <column table="sf_date" column="ostatok_full" />
        <column table="sf_date" column="dolg" />
        <column table="sf_date" column="days_dolg" />
        <column table="sf_date" column="days_dolg_diap" />
        <column table="vid_t_gr" column="name" dgroup="stragg_dist" as="vid_t_teplo_gr_name" />
        <call function="if" as="reserv">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <column table="sf_date" column="dolg" />
          <column table="sf_date" column="reserv_tat_teplo" />
        </call>
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
        <call function="no dublers" as="kred_dolg">
          <column table="a" column="kod_dog" />
          <column table="opl_date" column="ostatok_kred" dgroup="sum" />
        </call>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <link name="kod_dog" as="dog">
            <link name="kodp" as="payer" />
            <link name="dep" as="dep" />
            <dlink name="sr_opl">
              <slink name="sr_opl(date)" as="opl_date">
                <withparams>
                  <useparam name="date" />
                </withparams>
              </slink>
            </dlink>
          </link>
          <dlink name="sr_facras">
            <link name="vid_t_teplo">
              <link name="vid_t_gr" />
            </link>
          </dlink>
          <slink name="sr_facvip(date)" as="sf_date">
            <withparams>
              <useparam name="date" />
            </withparams>
          </slink>
          <link name="kod_deb" />
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="in">
            <column table="a" column="kod_dog" />
            <array>8527</array>
          </call>-->
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <call function="=">
            <column table="dog" column="tep_el" />
            <const>2</const>
          </call>
          <call function="or">
            <call function="=">
              <column table="dog" column="pr_active" />
              <const>0</const>
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="dog" column="dat_fin" />
                <useparam name="date" />
              </call>
              <useparam name="date" />
            </call>
          </call>
          <call function="and">
            <call function="!=">
              <column table="this" column="ostatok_full" />
              <const>0</const>
            </call>
          </call>
          <call function="ge">
            <column table="a" column="dat_sf" />
            <const>DATE'2013-01-01'</const>
          </call>
          <call function="in" optional="1">
            <column table="dog" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="is not null">
            <column table="sf_date" column="days_dolg" />
          </call>
          <call function="!=0">
            <column table="this" column="reserv" nvl="0" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-buh" timestamp="21.12.2016 21:39:51">
      <params>
        <param name="date" type="date">
          <const>DATE'2014-03-01'</const>
        </param>
        <param name="dep" type="array" />
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп">
          <call function="order by simple">
            <column table="dog" column="ndog" />
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="kod_sf" key="1" />
        <call function="||" as="inn_kpp" title="ИНН/КПП">
          <column table="payer" column="inn" />
          <const>' / '</const>
          <column table="payer" column="kpp" />
        </call>
        <column table="payer" column="name" as="payer_name" />
        <column table="dog" column="dep" />
        <column table="dog" column="kod_dog" />
        <column table="dog" column="ndog" />
        <column table="dep" column="name" as="dep_name" title="Отделение" />
        <column table="payer" column="kodp" />
        <column table="payer" column="nump" />
        <call function="if" as="udo" title="Банкрот" type="string">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <const>'Банкрот'</const>
        </call>
        <column table="payer" column="datepublic" />
        <column table="dog" column="name" as="dog_name" />
        <call function="||" as="name">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="a" column="kod_sf_first" />
              </call>
              <!--<call function="lt">
                <column table="this" column="dolg"/>
                <const>0</const>
              </call>-->
            </call>
            <const>'Корректировочная счет-фактура № '</const>
            <const>'Акт приёма-передачи № '</const>
          </call>
          <column table="a" column="nom_sf" />
          <const>' от '</const>
          <call function="date to char">
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="name" as="name_sf" />
        <column table="sf_date" column="dolg" as="nachisl" />
        <column table="a" column="nachisl" as="nachisl_sf" />
        <column table="a" column="dat_sf" title="Дата возникновения задолженности" />
        <column table="kod_deb" column="dat_bzad" />
        <column table="sf_date" column="opl" />
        <column table="sf_date" column="ostatok" />
        <column table="sf_date" column="nach_recalc" />
        <column table="sf_date" column="opl_recalc" />
        <column table="sf_date" column="nach_recalc1" />
        <column table="sf_date" column="opl_recalc1" />
        <column table="sf_date" column="ostatok_full" />
        <column table="sf_date" column="ostatok_full" as="dolg" />
        <!--<column table="sf_date" column="dolg" />-->
        <column table="sf_date" column="days_dolg" />
        <column table="sf_date" column="days_dolg_diap" />
        <column table="vid_t_gr" column="name" dgroup="stragg_dist" as="vid_t_teplo_gr_name" />
        <call function="if" as="reserv">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <!--<column table="sf_date" column="dolg"/>-->
          <column table="sf_date" column="ostatok_full" />
          <column table="sf_date" column="reserv_tat_teplo" />
        </call>
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
        <call function="no dublers" as="kred_dolg">
          <column table="a" column="kod_dog" />
          <column table="opl_date" column="ostatok_kred" dgroup="sum" />
        </call>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <link name="kod_dog" as="dog">
            <link name="kodp" as="payer" />
            <link name="dep" as="dep" />
            <link name="kod_dog_dop">
              <link name="kod_group_cust">
                <link name="kod_group_cust_parent" />
              </link>
            </link>
            <dlink name="sr_opl">
              <slink name="sr_opl(date)" as="opl_date">
                <withparams>
                  <useparam name="date" />
                </withparams>
              </slink>
            </dlink>
          </link>
          <dlink name="sr_facras">
            <link name="vid_t_teplo">
              <link name="vid_t_gr" />
            </link>
          </dlink>
          <slink name="sr_facvip(date)" as="sf_date">
            <withparams>
              <useparam name="date" />
            </withparams>
          </slink>
          <link name="kod_deb" />
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="in">
            <column table="a" column="kod_dog" />
            <array>6995</array>
          </call>-->
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <call function="=">
            <column table="dog" column="tep_el" />
            <const>2</const>
          </call>
          <call function="or">
            <call function="=">
              <column table="dog" column="pr_active" />
              <const>0</const>
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="dog" column="dat_fin" />
                <useparam name="date" />
              </call>
              <useparam name="date" />
            </call>
          </call>
          <call function="and">
            <call function="!=">
              <column table="this" column="ostatok_full" />
              <const>0</const>
            </call>
          </call>
          <call function="ge">
            <column table="a" column="dat_sf" />
            <const>DATE'2013-01-01'</const>
          </call>
          <call function="in" optional="1">
            <column table="dog" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="!=0">
            <column table="this" column="reserv" nvl="0" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust_parent" column="kod_group_cust" />
            <useparam name="kod_group_cust_parent" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust" column="kod_group_cust" />
            <useparam name="kod_group_cust" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-nalog">
      <params>
        <param name="date" type="date">
          <const>DATE'2014-03-01'</const>
        </param>
        <param name="dep" type="array" />
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп">
          <call function="order by simple">
            <column table="dog" column="ndog" />
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="kod_sf" key="1" />
        <call function="||" as="inn_kpp" title="ИНН/КПП">
          <column table="payer" column="inn" />
          <const>' / '</const>
          <column table="payer" column="kpp" />
        </call>
        <column table="payer" column="name" as="payer_name" />
        <column table="dog" column="dep" />
        <column table="dog" column="kod_dog" />
        <column table="dog" column="ndog" />
        <column table="dep" column="name" as="dep_name" title="Отделение" />
        <column table="payer" column="kodp" />
        <column table="payer" column="nump" />
        <call function="if" as="udo" title="Банкрот" type="string">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <const>'Банкрот'</const>
        </call>
        <column table="payer" column="datepublic" />
        <column table="dog" column="name" as="dog_name" />
        <call function="||" as="name">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="a" column="kod_sf_first" />
              </call>
              <!--<call function="lt">
                <column table="this" column="dolg"/>
                <const>0</const>
              </call>-->
            </call>
            <const>'Корректировочная счет-фактура № '</const>
            <const>'Акт приёма-передачи № '</const>
          </call>
          <column table="a" column="nom_sf" />
          <const>' от '</const>
          <call function="date to char">
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="name" as="name_sf" />
        <column table="sf_date" column="dolg" as="nachisl" />
        <column table="a" column="nachisl" as="nachisl_sf" />
        <column table="a" column="dat_sf" title="Дата возникновения задолженности" />
        <column table="kod_deb" column="dat_bzad" />
        <column table="sf_date" column="opl" />
        <column table="sf_date" column="ostatok" />
        <column table="sf_date" column="nach_recalc" />
        <column table="sf_date" column="opl_recalc" />
        <column table="sf_date" column="nach_recalc1" />
        <column table="sf_date" column="opl_recalc1" />
        <column table="sf_date" column="ostatok_full" />
        <column table="sf_date" column="dolg" />
        <column table="sf_date" column="days_dolg" />
        <column table="sf_date" column="days_dolg_diap" />
        <column table="vid_t_gr" column="name" dgroup="stragg_dist" as="vid_t_teplo_gr_name" />
        <!--<call function="if" as="reserv">
          <call function="is not null">
            <column table="payer" column="datepublic" />
          </call>
          <column table="sf_date" column="dolg"/>
          <column table="sf_date" column="reserv_tat_teplo"/>
        </call>-->
        <column table="sf_date" column="reserv_tat_teplo" as="reserv" />
        <call function="no dublers" as="kred_dolg">
          <column table="a" column="kod_dog" />
          <column table="opl_date" column="ostatok_kred" dgroup="sum" />
        </call>
      </select>
      <from>
        <query name="sr_facvip" as="a">
          <link name="kod_dog" as="dog">
            <link name="kodp" as="payer" />
            <link name="dep" as="dep" />
            <link name="kod_dog_dop">
              <link name="kod_group_cust">
                <link name="kod_group_cust_parent" />
              </link>
            </link>
            <dlink name="sr_opl">
              <slink name="sr_opl(date)" as="opl_date">
                <withparams>
                  <useparam name="date" />
                </withparams>
              </slink>
            </dlink>
          </link>
          <dlink name="sr_facras">
            <link name="vid_t_teplo">
              <link name="vid_t_gr" />
            </link>
          </dlink>
          <slink name="sr_facvip(date)" as="sf_date">
            <withparams>
              <useparam name="date" />
            </withparams>
          </slink>
          <link name="kod_deb" />
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="in">
            <column table="a" column="kod_dog" />
            <array>8527</array>
          </call>-->
          <call function="=">
            <column table="a" column="vid_real" />
            <const>2</const>
          </call>
          <call function="=">
            <column table="dog" column="tep_el" />
            <const>2</const>
          </call>
          <call function="or">
            <call function="=">
              <column table="dog" column="pr_active" />
              <const>0</const>
            </call>
            <call function="ge">
              <call function="nvl">
                <column table="dog" column="dat_fin" />
                <useparam name="date" />
              </call>
              <useparam name="date" />
            </call>
          </call>
          <call function="and">
            <call function="!=">
              <column table="this" column="ostatok_full" />
              <const>0</const>
            </call>
          </call>
          <call function="ge">
            <column table="a" column="dat_sf" />
            <const>DATE'2013-01-01'</const>
          </call>
          <call function="in" optional="1">
            <column table="dog" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="is not null">
            <column table="sf_date" column="days_dolg" />
          </call>
          <call function="!=0">
            <column table="this" column="reserv" nvl="0" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust_parent" column="kod_group_cust" />
            <useparam name="kod_group_cust_parent" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust" column="kod_group_cust" />
            <useparam name="kod_group_cust" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-dog" timestamp="21.12.2016 22:57:34">
      <params>
        <param name="date" type="date">
          <const>DATE'2014-05-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2014.04</const>
        </param>
        <param name="dep" type="array">
          <const>1111</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп">
          <call function="order by simple">
            <column table="payer" column="nump" />
          </call>
        </call>
        <column table="dep" column="name" dgroup="stragg_dist" as="dep_name" />
        <column table="payer" column="kodp" />
        <column table="payer" column="nump" />
        <call function="||" as="inn_kpp" title="ИНН/КПП">
          <column table="payer" column="inn" />
          <const>' / '</const>
          <column table="payer" column="kpp" />
        </call>
        <column table="payer" column="name" as="payer_name" />
        <column table="sf_date" column="reserv_tat_teplo" as="reserv" dgroup="sum" />
        <column table="sf_date" column="dolg" dgroup="sum" />
        <column table="sf_date" column="ostatok_full" dgroup="sum" />
        <column table="sf_nach" column="nachisl_p" as="nachisl" dgroup="sum" />
        <column table="sf_nach_y" column="nachisl_p" as="nachisl_god" dgroup="sum" />
        <call function="-nvl" as="opl">
          <column table="opl" column="opl" dgroup="sum" />
          <column table="sf_nach" column="nachisl_m" dgroup="sum" />
        </call>
        <call function="-nvl" as="opl_god">
          <column table="opl_y" column="opl" as="opl_y" dgroup="sum" />
          <column table="sf_nach_y" column="nachisl_m" as="nachisl_m_y" dgroup="sum" />
        </call>
        <const as="spis" type="number">null</const>
        <const as="spis_god" type="number">null</const>
      </select>
      <from>
        <query name="kr_payer" as="payer">
          <dlink name="kr_dogovor" as="a">
            <!--<link name="kodp" as="payer"/>-->
            <where>
              <call function="and">
                <call function="=">
                  <column table="a" column="tep_el" />
                  <const>2</const>
                </call>
                <call function="or">
                  <call function="=">
                    <column table="a" column="pr_active" />
                    <const>0</const>
                  </call>
                  <call function="ge">
                    <call function="nvl">
                      <column table="a" column="dat_fin" />
                      <useparam name="date" />
                    </call>
                    <useparam name="date" />
                  </call>
                </call>
                <call function="in" optional="1">
                  <column table="a" column="dep" />
                  <useparam name="dep" />
                </call>
              </call>
            </where>
            <link name="dep" as="dep" />
            <link name="kod_dog_dop">
              <link name="kod_group_cust">
                <link name="kod_group_cust_parent" />
              </link>
            </link>
            <dlink name="sr_facvip">
              <slink name="sr_facvip(date)" as="sf_date">
                <withparams>
                  <useparam name="date" />
                </withparams>
              </slink>
              <where>
                <call function="and">
                  <call function="=">
                    <column table="sr_facvip" column="vid_real" />
                    <const>2</const>
                  </call>
                  <call function="ge">
                    <column table="sr_facvip" column="dat_sf" />
                    <const>DATE'2013-01-01'</const>
                  </call>
                </call>
              </where>
            </dlink>
            <dlink name="sr_facvip" as="sf_nach">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="sf_nach" column="vid_real" />
                    <const>2</const>
                  </call>
                  <call function="=">
                    <column table="sf_nach" column="ym" />
                    <useparam name="ym" />
                  </call>
                </call>
              </where>
            </dlink>
            <dlink name="sr_facvip" as="sf_nach_y">
              <where>
                <call function="and">
                  <call function="=">
                    <column table="sf_nach_y" column="vid_real" />
                    <const>2</const>
                  </call>
                  <call function="between">
                    <call function="ym end time">
                      <column table="sf_nach_y" column="ym" />
                    </call>
                    <call function="year begin time">
                      <call function="trunc">
                        <useparam name="ym" />
                      </call>
                    </call>
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                  </call>
                </call>
              </where>
            </dlink>
            <dlink name="sr_facvip" as="sf_opl">
              <dlink name="sr_opl" as="opl">
                <where>
                  <call function="=">
                    <column table="opl" column="ym" />
                    <useparam name="ym" />
                  </call>
                </where>
              </dlink>
              <where>
                <call function="=">
                  <column table="sf_opl" column="vid_real" />
                  <const>2</const>
                </call>
              </where>
            </dlink>
            <dlink name="sr_facvip" as="sf_opl_y">
              <dlink name="sr_opl" as="opl_y">
                <where>
                  <call function="between">
                    <call function="ym end time">
                      <column table="opl_y" column="ym" />
                    </call>
                    <call function="year begin time">
                      <call function="trunc">
                        <useparam name="ym" />
                      </call>
                    </call>
                    <call function="ym end time">
                      <useparam name="ym" />
                    </call>
                  </call>
                </where>
              </dlink>
              <where>
                <call function="=">
                  <column table="sf_opl_y" column="vid_real" />
                  <const>2</const>
                </call>
              </where>
            </dlink>
          </dlink>
        </query>
      </from>
      <where>
        <call function="and">
          <!--<call function="=">
            <column table="payer" column="nump" />
           <const>'12682'</const>
          </call>-->
          <call function="!=0">
            <column table="this" column="reserv" />
            <column table="this" column="nachisl" />
            <column table="this" column="nachisl_god" />
            <column table="this" column="opl" />
            <column table="this" column="opl_god" />
          </call>
          <call function="in" optional="1" exclude="1">
            <column table="a" column="dep" />
            <useparam name="dep" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust_parent" column="kod_group_cust" />
            <useparam name="kod_group_cust_parent" />
          </call>
          <call function="in" optional="1">
            <column table="kod_group_cust" column="kod_group_cust" />
            <useparam name="kod_group_cust" />
          </call>
        </call>
      </where>
    </query>
    <!--query name="21033-title-new" timestamp="22.12.2016 02:33:44">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym">
          <const>2016.11</const>
        </param>
        <param name="dep">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" />
        <param name="kod_group_cust" />
      </params>
      <select>
        <const as="id" group="1" type="number">1</const>
        <call function="" as="dat" type="date" title="Дата формирования">
          <useparam name="date" />
        </call>
        <call function="" as="ym" type="number" title="Отчетный период">
          <useparam name="ym" />
        </call>
        <column table="a" column="dep_name" group="stragg_dist" />
        <column table="a" column="dolg" group="sumnvl" />
        <column table="a" column="reserv" group="sumnvl" />
        <column table="a" column="nachisl" group="sumnvl" />
        <column table="a" column="opl" group="sumnvl" />
        <column table="a" column="nachisl_god" group="sumnvl" />
        <column table="a" column="opl_god" group="sumnvl" />
        <column table="a" column="spis" group="sumnvl" />
        <column table="a" column="spis_god" group="sumnvl" />
      </select>
      <from>
        <query name="21033-12-dog" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </from>
    </query-->
    <query name="21033-12" timestamp="15.05.2024 14:33:57">
      <params>
        <param name="date" type="date">
          <const>DATE'2021-06-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2021.05</const>
        </param>
        <param name="dep" type="array">
          <const>102276623</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <expressions>
        <call as="do_dat" function="lt" dontpushpred="1">
          <column table="dat" column="val" />
          <useparam name="date" />
        </call>
        <call as="in_year" function="and" dontpushpred="1">
          <call function="lt">
            <column table="dat" column="val" />
            <useparam name="date" />
          </call>
          <call function="ge">
            <column table="dat" column="val" />
            <call function="year begin time">
              <call function="trunc">
                <useparam name="ym" />
              </call>
            </call>
          </call>
        </call>
        <call as="in_ym" function="=" dontpushpred="1">
          <call function="date to ym">
            <column table="dat" column="val" />
          </call>
          <useparam name="ym" />
        </call>
        <call as="in_year" function="between" dontpushpred="1" exclude="1">
          <column table="dat" column="val" />
          <call function="year begin time">
            <call function="year">
              <useparam name="date" />
            </call>
          </call>
          <useparam name="date" />
        </call>
        <call as="is_spis" function="=1" dontpushpred="1">
          <column table="kod_opl" column="pr_spis_tt" />
        </call>
        <call as="is_not_spis" function="!=nvl" dontpushpred="1">
          <column table="kod_opl" column="pr_spis_tt" />
          <const>1</const>
        </call>
        <call as="is_not_spis" function="true" exclude="1" />
        <call function="()" as="ob_full" type="number" group="sum">
          <fact column="fin_ul_ob" condition="do_dat" />
        </call>
        <call function="()" as="nachisl_full" type="number" group="sum">
          <fact column="sr_facras_nachisl" condition="do_dat" />
        </call>
        <call function="()" as="opl_full" type="number" group="sum">
          <fact column="sr_opl_opl_sf" condition="do_dat" />
        </call>
        <call function="if" as="ob_rec" type="number" group="sum">
          <call function="!=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="ob_full" />
        </call>
        <call function="if" as="ob_ish" type="number" group="sum">
          <call function="=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="ob_full" />
        </call>
        <call function="if" as="nachisl_rec" type="number" group="sum">
          <call function="!=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="nachisl_full" />
        </call>
        <call function="if" as="nachisl_ish" type="number" group="sum">
          <call function="=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="nachisl_full" />
        </call>
        <call function="if" as="opl_rec" type="number" group="sum">
          <call function="!=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="opl_full" />
        </call>
        <call function="if" as="opl_ish" type="number" group="sum">
          <call function="=nvl">
            <column table="kod_sf" column="kod_sf" />
            <column table="kod_sf" column="kod_sf_main" />
          </call>
          <fact column="opl_full" />
        </call>
        <call function="()" as="ob_kred" group="sum" type="number">
          <fact column="fin_ul_ob_kr" condition="do_dat" />
        </call>
        <call function="()" as="ob_res_buh" group="sum" type="number">
          <fact column="fin_ul_rsrv_buh_ob" condition="do_dat" />
        </call>
        <call function="+nvl" as="nach_res_buh_ym" group="sum">
          <fact column="fin_ul_rsrv_buh_nach" condition="in_ym" />
        </call>
        <call function="+nvl" as="nach_res_buh_year" group="sum">
          <fact column="fin_ul_rsrv_buh_nach" condition="in_year" />
        </call>
        <call function="()" as="ob_res_nal" group="sum" type="number">
          <fact column="fin_ul_rsrv_nal_ob" condition="in_year" />
        </call>
        <call function="+nvl" as="nach_res_nal_ym" group="sum">
          <fact column="fin_ul_rsrv_nal_nach" condition="in_ym" />
        </call>
        <call function="+nvl" as="nach_res_nal_year" group="sum">
          <fact column="fin_ul_rsrv_nal_nach" condition="in_year" />
        </call>
        <call function="+nvl" as="umen_res_buh_ym" group="sum">
          <fact column="fin_ul_rsrv_buh_opl" condition="in_ym" />
        </call>
        <call function="+nvl" as="umen_res_buh_year" group="sum">
          <fact column="fin_ul_rsrv_buh_opl" condition="in_year" />
        </call>
        <call function="+nvl" as="umen_res_nal_ym" group="sum">
          <fact column="fin_ul_rsrv_nal_opl" condition="in_ym" />
        </call>
        <call function="+nvl" as="umen_res_nal_year" group="sum">
          <fact column="fin_ul_rsrv_nal_opl" condition="in_year" />
        </call>
        <call function="+nvl" as="opl_res_buh_ym" group="sum">
          <fact column="umen_res_buh_ym" condition="is_not_spis" />
        </call>
        <call function="+nvl" as="opl_res_buh_year" group="sum">
          <fact column="umen_res_buh_year" condition="is_not_spis" />
        </call>
        <call function="+nvl" as="opl_res_nal_ym" group="sum">
          <fact column="umen_res_nal_ym" condition="is_not_spis" />
        </call>
        <call function="+nvl" as="opl_res_nal_year" group="sum">
          <fact column="umen_res_nal_year" condition="is_not_spis" />
        </call>
        <call function="+nvl" as="spis_res_buh_ym" group="sum">
          <fact column="umen_res_buh_ym" condition="is_spis" />
        </call>
        <call function="+nvl" as="spis_res_buh_year" group="sum">
          <fact column="umen_res_buh_year" condition="is_spis" />
        </call>
        <call function="+nvl" as="spis_res_nal_ym" group="sum">
          <fact column="umen_res_nal_ym" condition="is_spis" />
        </call>
        <call function="+nvl" as="spis_res_nal_year" group="sum">
          <fact column="umen_res_nal_year" condition="is_spis" />
        </call>
      </expressions>
      <select>
        <column table="kod_sf_main" column="kod_sf" key="1" />
        <fact column="fin_ul_rsrv_nal_ob" table="sf" exclude="1" />
        <column table="kod_sf" column="dat_res_nal_45" exclude="1" />
        <column table="kod_sf" column="dat_res_nal_90" exclude="1" />
        <fact column="sr_facras_rsrv_nal_45_nach" table="sf" exclude="1" />
        <fact column="sr_opl_rsrv_nal_45_nach" table="sf" exclude="1" />
        <fact column="sr_facras_rsrv_nal_90_nach" table="sf" exclude="1" />
        <fact column="sr_opl_rsrv_nal_90_nach" table="sf" exclude="1" />
        <fact column="sr_opl_rsrv_nal_45_opl" table="sf" exclude="1" />
        <fact column="sr_opl_rsrv_nal_90_opl" table="sf" exclude="1" />
        <call function="||" as="inn_kpp" title="ИНН/КПП">
          <column table="kodp" column="inn" />
          <const>' / '</const>
          <column table="kodp" column="kpp" />
        </call>
        <column table="kodp" column="name" as="payer_name" />
        <column table="kod_dog" column="dep" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dog" column="ndog" />
        <column table="kod_dog" column="dat_sign" title="Дата подписания договора" />
        <column table="dep" column="name" as="dep_name" title="Отделение" />
        <column table="kodp" column="kodp" />
        <column table="kodp" column="nump" />
        <call function="egr_payer_sulst" as="bk_kod_sulst">
          <column table="kodp" column="kodp" />
        </call>
        <call function="()" as="udo" title="Банкрот" type="string">
          <query exclude="1">
            <select>
              <column table="a" column="sulst_name" />
            </select>
            <from>
              <query name="kk_egr_sulst" as="a" />
            </from>
            <where>
              <call function="and">
                <call function="in">
                  <column table="a" column="sulst" />
                  <array>101,107,113,114,117,801</array>
                </call>
                <call function="=">
                  <column table="a" column="sulst" />
                  <call function="egr_payer_sulst">
                    <column table="kodp" column="kodp" />
                  </call>
                </call>
              </call>
            </where>
          </query>
          <call function="case" title="Банкрот" type="string">
            <call function="when">
              <call function="and">
                <call function="=">
                  <column table="udo" column="pr_active" />
                  <const type="number">0</const>
                </call>
                <call function="=">
                  <column table="kodp" column="ac_egr_status" />
                  <column table="udo" column="sulst" />
                </call>
                <call function="=">
                  <column table="udo" column="type_sulst" />
                  <call function="if">
                    <call function="is null">
                      <column table="kodp" column="kpp" />
                    </call>
                    <const type="string">'ИП'</const>
                    <const type="string">'ЮЛ'</const>
                  </call>
                </call>
                <call function="=">
                  <call function="case">
                    <call function="when">
                      <call function="=">
                        <const type="string">'A'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_a" />
                    </call>
                    <call function="when">
                      <call function="=">
                        <const type="string">'B'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_b" />
                    </call>
                    <call function="when">
                      <call function="=">
                        <const type="string">'C'</const>
                        <useparam name="p_cat_rep" />
                      </call>
                      <column table="udo" column="cat_c" />
                    </call>
                  </call>
                  <const type="number">1</const>
                </call>
              </call>
              <column table="udo" column="shortname" type="string" />
            </call>
            <call function="when">
              <call function="=">
                <useparam table="kodp" column="ac_egr_status" name="p_cat_rep" />
                <const table="udo" column="sulst" type="string">'-'</const>
              </call>
              <column table="kodp" column="ac_egr_status_name" type="string" />
            </call>
            <call function="else" exclude="1">
              <column table="kodp" column="ac_egr_status_name" />
            </call>
          </call>
        </call>
        <call function="if" as="datepublic">
          <call function="in">
            <column table="this" column="bk_kod_sulst" />
            <array>'101','107','113','114','117','801'</array>
          </call>
          <call function="egr_payer_sulst_dat">
            <column table="kodp" column="kodp" />
          </call>
        </call>
        <column table="kodp" column="datepublic" exclude="1" />
        <column table="kod_dog" column="name" as="dog_name" />
        <call function="||" as="name" title="Документ">
          <call function="if">
            <call function="and">
              <call function="is not null">
                <column table="kod_sf_main" column="kod_sf_first" />
              </call>
              <!--<call function="lt">
                <column table="this" column="dolg"/>
                <const>0</const>
              </call>-->
            </call>
            <const>'Корректировочная счет-фактура № '</const>
            <const>'Акт приёма-передачи № '</const>
          </call>
          <column table="kod_sf_main" column="nom_sf" />
          <const>' от '</const>
          <call function="date to char">
            <column table="kod_sf_main" column="dat_sf" />
          </call>
        </call>
        <column table="kod_sf_main" column="dat_sf" title="Дата возникновения задолженности" />
        <column table="kod_sf_main" column="dat_bzad_ksf" as="dat_bzad" />
        <fact as="nachisl" column="ob_full" title="Задолженность" table="sf" />
        <fact column="nachisl_ish" as="nachisl_sf" title="Начислено" table="sf" />
        <fact column="opl_ish" title="Оплачено" table="sf" />
        <fact column="ob_ish" title="Отстаток" table="sf" />
        <fact column="nachisl_rec" title="Перерасчет (ФК)" table="sf" />
        <fact column="opl_rec" title="Оплата перерасчета (ФК)" table="sf" />
        <fact column="ob_full" as="dolg" title="Остаток с учетом перерасчетов" table="sf" />
        <call function="if" as="days_dolg" title="Срок просроченной задолженности в днях" type="number" format="F0">
          <call function="and">
            <call function="lt">
              <column table="this" column="dat_bzad" />
              <useparam name="date" />
            </call>
            <call function="!=0">
              <column table="this" column="dolg" />
            </call>
          </call>
          <call function="-">
            <useparam name="date" />
            <column table="this" column="dat_bzad" />
            <const>1</const>
          </call>
          <const>0</const>
        </call>
        <usepart part="days_dolg_diap">
          <column table="this" column="days_dolg" />
        </usepart>
        <call function="case" as="days_dolg_diap_buh" type="string" title="Критерий задолженности">
          <call function="when">
            <call function="is not null">
              <column table="this" column="udo" />
            </call>
            <const>'Банкрот'</const>
          </call>
          <call function="when">
            <call function="gt">
              <column table="this" column="days_dolg" />
              <const>365</const>
            </call>
            <const>'Cвыше года'</const>
          </call>
          <call function="else">
            <const>'Неплатежи'</const>
          </call>
        </call>
        <fact as="vid_t_teplo_gr_name" column="vid_t_teplo_gr_name" table="sf" title="Предмет договора" />
        <fact column="ob_res_buh" as="reserv_buh" title="Резерв бух. учет" table="sf" />
        <fact column="nach_res_buh_ym" title="Отчисление в резерв за период бух. учет" table="sf" />
        <fact column="nach_res_buh_year" title="Отчисление в резерв с начала года бух. учет" table="sf" />
        <fact column="ob_res_nal" as="reserv_nal" title="Резерв нал. учет" table="sf" />
        <fact column="nach_res_nal_ym" title="Отчисление в резерв за период нал. учет" table="sf" />
        <fact column="nach_res_nal_year" title="Отчисление в резерв с начала года нал. учет" table="sf" />
        <fact column="opl_res_buh_ym" title="Погашение резерва за период бух. учет" table="sf" />
        <fact column="opl_res_buh_year" title="Погашение резерва с начала года бух. учет" table="sf" />
        <fact column="opl_res_nal_ym" title="Погашение резерва за период нал. учет" table="sf" />
        <fact column="opl_res_nal_year" title="Погашение резерва с начала года нал. учет" table="sf" />
        <fact column="spis_res_buh_ym" title="Списание резерва за период бух. учет" table="sf" />
        <fact column="spis_res_buh_year" title="Списание резерва с начала года бух. учет" table="sf" />
        <fact column="spis_res_nal_ym" title="Списание резерва за период нал. учет" table="sf" />
        <fact column="spis_res_nal_year" title="Списание резерва с начала года нал. учет" table="sf" />
        <call function="over" type="number" as="kred_dolg_pre">
          <call function="sum">
            <fact column="ob_kred" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
        </call>
        <call function="over" type="number" as="reserv_buh_on_dog">
          <call function="sum">
            <column table="this" column="reserv_buh" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
        </call>
        <call function="over" type="number" as="reserv_buh_on_deb">
          <call function="sum">
            <column table="this" column="reserv_buh" />
          </call>
          <call function="partition by">
            <column table="kod_sf_main" column="kod_deb" />
          </call>
        </call>
        <call function="over" type="number" as="reserv_nal_on_dog">
          <call function="sum">
            <column table="this" column="reserv_nal" />
          </call>
          <call function="partition by">
            <column table="this" column="kod_dog" />
          </call>
        </call>
        <call function="over" type="number" as="reserv_nal_on_deb">
          <call function="sum">
            <column table="this" column="reserv_nal" />
          </call>
          <call function="partition by">
            <column table="kod_sf_main" column="kod_deb" />
          </call>
        </call>
        <column table="kod_sf_main" column="data_gpz" title="Дата возникновения задолженности ГПЗ" />
        <!--<column table="sf_date" column="dolg" />-->
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
      </select>
      <from>
        <qube>
          <dimset as="sf">
            <link name="kod_sf_main" />
            <link name="kod_sf" />
            <where>
              <call function="and">
                <call function="=">
                  <column table="kod_sf_main" column="vid_real" />
                  <const>2</const>
                </call>
                <call function="ge">
                  <column table="kod_sf_main" column="dat_sf" />
                  <const>DATE'2013-01-01'</const>
                </call>
                <call function="=" exclude="1">
                  <column table="kod_sf" column="kod_sf" />
                  <const>111688170</const>
                </call>
              </call>
            </where>
          </dimset>
          <link name="kod_dog">
            <link name="kodp">
              <link name="udo" />
            </link>
            <link name="dep" />
            <link name="kod_dog_dop">
              <link name="kod_group_cust">
                <link name="kod_group_cust_parent" />
              </link>
            </link>
          </link>
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_dog" column="tep_el" />
                <const>2</const>
              </call>
              <call function="=" exclude="1">
                <column table="kod_sf" column="kod_dog" />
                <const>120014246</const>
              </call>
              <call function="ge">
                <call function="if">
                  <call function="=">
                    <column table="kod_dog" column="pr_active" />
                    <const>0</const>
                  </call>
                  <call function="doomsday" />
                  <call function="nvl">
                    <column table="kod_dog" column="dat_fin" />
                    <call function="doomsday" />
                  </call>
                </call>
                <useparam name="date" />
              </call>
              <call function="in" optional="1">
                <column table="kod_dog" column="dep" />
                <useparam name="dep" />
              </call>
              <call function="in" optional="1">
                <column table="kod_group_cust_parent" column="kod_group_cust" />
                <useparam name="kod_group_cust_parent" />
              </call>
              <call function="in" optional="1">
                <column table="kod_group_cust" column="kod_group_cust" />
                <useparam name="kod_group_cust" />
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where exclude="1">
        <call function="and" exclude="1">
          <!--<call function="in">
            <column table="a" column="kod_dog" />
            <array>6995</array>
          </call>-->
          <call function="!=0" exclude="1">
            <column table="this" column="reserv" nvl="0" />
          </call>
        </call>
        <call function="and">
          <call function="!=0">
            <column table="this" column="dolg" />
            <column table="this" column="kred_dolg" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-12-buh" timestamp="15.05.2024 11:32:29">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп" format="F0" key="1">
          <call function="order by simple">
            <column table="a" column="ndog" />
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="kod_sf" />
        <column table="a" column="inn_kpp" />
        <column table="a" column="payer_name" />
        <column table="a" column="vid_t_teplo_gr_name" />
        <column table="a" column="dep" />
        <column table="a" column="kod_dog" />
        <column table="a" column="ndog" />
        <column table="a" column="dat_sign" />
        <column table="a" column="dep_name" />
        <column table="a" column="kodp" />
        <column table="a" column="nump" />
        <column table="a" column="udo" />
        <column table="a" column="datepublic" />
        <column table="a" column="dog_name" />
        <column table="a" column="name" />
        <column table="a" column="dat_sf" />
        <column table="a" column="dat_bzad" />
        <column table="a" column="nachisl" />
        <column table="a" column="reserv_buh" as="dolg" title="Резерв" />
        <column table="a" column="days_dolg" />
        <column table="a" column="days_dolg_diap_buh" as="days_dolg_diap" />
        <call function="no dublers" as="kred_dolg" title="Кредиторская задолженность">
          <column table="a" column="kod_dog" />
          <column table="a" column="kred_dolg_pre" dgroup="sum" />
        </call>
        <column table="a" column="data_gpz" />
        <call function="if" as="dat_entry" title="Дата вст. реш. в зак. силу">
          <call function="like">
            <column table="a" column="ndog" />
            <const>'%БД'</const>
          </call>
          <column table="b" column="dat_entry" />
        </call>
        <call function="if" as="num_delo" title="Номер дела">
          <call function="like">
            <column table="a" column="ndog" />
            <const>'%БД'</const>
          </call>
          <column table="b" column="num_delo" />
        </call>
        <call function="if" as="dat_post" title="Дата прин. суд. акта">
          <call function="like">
            <column table="a" column="ndog" />
            <const>'%БД'</const>
          </call>
          <column table="b" column="dat_post" />
        </call>
        <call function="if" as="dat_post_num_delo" title="Дата решения и номер дела">
          <call function="like">
            <column table="a" column="ndog" />
            <const>'%БД'</const>
          </call>
          <call function="||">
            <call function="date to char">
              <column table="b" column="dat_post" />
            </call>
            <const>' '</const>
            <column table="b" column="num_delo" />
          </call>
        </call>
        <!--<column table="sf_date" column="dolg" />-->
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
      </select>
      <from>
        <query name="21033-12" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
        <query join="left outer" name="21033-12-sf_last_sud_resh_g" as="b">
          <call function="=">
            <column table="a" column="kod_sf" />
            <column table="b" column="kod_sf" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="this" column="dolg" />
          </call>
          <call function="!=0">
            <column table="a" column="reserv_buh_on_dog" />
          </call>
          <call function="!=0">
            <column table="a" column="reserv_buh_on_deb" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-12-dog-buh" timestamp="15.05.2024 13:10:36">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп" format="F0">
          <call function="order by simple">
            <column table="a" column="nump" group="max" />
          </call>
        </call>
        <column table="a" column="kodp" group="1" />
        <column table="a" column="nump" group="max" />
        <column table="a" column="dep_name" dgroup="stragg_dist" group="max" />
        <column table="a" column="inn_kpp" group="max" />
        <column table="a" column="payer_name" group="max" />
        <column table="a" column="reserv_buh" dgroup="sum" group="sum" as="dolg" />
        <column table="a" column="nach_res_buh_ym" dgroup="sum" group="sum" as="nachisl" />
        <column table="a" column="nach_res_buh_year" dgroup="sum" group="sum" as="nachisl_god" />
        <column table="a" column="opl_res_buh_ym" dgroup="sum" group="sum" as="opl" />
        <column table="a" column="opl_res_buh_year" dgroup="sum" group="sum" as="opl_god" />
        <column table="a" column="spis_res_buh_ym" dgroup="sum" group="sum" as="spis" />
        <column table="a" column="spis_res_buh_year" dgroup="sum" group="sum" as="spis_god" />
        <!--<column table="sf_date" column="dolg" />-->
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
      </select>
      <from>
        <query name="21033-12" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="this" column="dolg" group="no" />
            <column table="this" column="nachisl_god" group="no" />
            <column table="this" column="nachisl" group="no" />
            <column table="this" column="opl_god" group="no" />
            <column table="this" column="opl" group="no" />
            <column table="this" column="spis" group="no" />
            <column table="this" column="spis_god" group="no" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-12-title-buh" timestamp="22.12.2016 03:55:24">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <const as="id" group="1" type="number">1</const>
        <call function="" as="dat" type="date" title="Дата формирования">
          <useparam name="date" />
        </call>
        <call function="" as="ym" type="number" title="Отчетный период">
          <useparam name="ym" />
        </call>
        <column table="a" column="dep_name" group="stragg_dist" />
        <column table="a" column="dolg" group="sumnvl" />
        <column table="a" column="nachisl" group="sumnvl" />
        <column table="a" column="opl" group="sumnvl" />
        <column table="a" column="nachisl_god" group="sumnvl" />
        <column table="a" column="opl_god" group="sumnvl" />
        <column table="a" column="spis" group="sumnvl" />
        <column table="a" column="spis_god" group="sumnvl" />
      </select>
      <from>
        <query name="21033-12-dog-buh" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="21033-12-nal" timestamp="07.06.2024 17:46:44">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
        <param name="p_cat_rep" type="string" comment="Категория отчета из таблицы kk_report_sulst" />
      </params>
      <select>
        <call function="row_number" as="rwn" title="№ пп" format="F0" key="1">
          <call function="order by simple">
            <column table="a" column="ndog" />
            <column table="a" column="dat_sf" />
          </call>
        </call>
        <column table="a" column="kod_sf" />
        <column table="a" column="inn_kpp" />
        <column table="a" column="payer_name" />
        <column table="a" column="vid_t_teplo_gr_name" />
        <column table="a" column="dep" />
        <column table="a" column="kod_dog" />
        <column table="a" column="ndog" />
        <column table="a" column="dep_name" />
        <column table="a" column="kodp" />
        <column table="a" column="nump" />
        <column table="a" column="udo" />
        <column table="a" column="datepublic" />
        <column table="a" column="dog_name" />
        <column table="a" column="name" />
        <column table="a" column="dat_sf" />
        <column table="a" column="dat_bzad" />
        <column table="a" column="nachisl" />
        <column table="a" column="reserv_nal" as="reserv" title="Резерв" />
        <column table="a" column="days_dolg" />
        <column table="a" column="days_dolg_diap" />
        <call function="no dublers" as="kred_dolg" title="Кредиторская задолженность">
          <column table="a" column="kod_dog" />
          <column table="a" column="kred_dolg_pre" dgroup="sum" />
        </call>
        <!--<column table="sf_date" column="dolg" />-->
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
      </select>
      <from>
        <query name="21033-12" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
            <useparam name="p_cat_rep" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="this" column="reserv" />
          </call>
          <call function="!=0">
            <column table="a" column="reserv_nal_on_dog" />
          </call>
          <call function="!=0">
            <column table="a" column="reserv_nal_on_deb" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-12-dog-nal" timestamp="01.11.2017 18:05:06">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <column table="a" column="kodp" group="1" />
        <column table="a" column="nump" group="max" />
        <column table="a" column="dep_name" dgroup="stragg_dist" group="max" />
        <column table="a" column="inn_kpp" group="max" />
        <column table="a" column="payer_name" group="max" />
        <column table="a" column="reserv_nal" dgroup="sum" group="sum" as="reserv" />
        <column table="a" column="nach_res_nal_ym" dgroup="sum" group="sum" as="nachisl" />
        <column table="a" column="nach_res_nal_year" dgroup="sum" group="sum" as="nachisl_god" />
        <column table="a" column="opl_res_nal_ym" dgroup="sum" group="sum" as="opl" />
        <column table="a" column="opl_res_nal_year" dgroup="sum" group="sum" as="opl_god" />
        <column table="a" column="spis_res_nal_ym" dgroup="sum" group="sum" as="spis" />
        <column table="a" column="spis_res_nal_year" dgroup="sum" group="sum" as="spis_god" />
        <!--<column table="sf_date" column="dolg" />-->
        <!--<column table="sf_date" column="reserv_tat_teplo" as="reserv" />-->
      </select>
      <from>
        <query name="21033-12" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="this" column="reserv" group="no" />
            <column table="this" column="nachisl_god" group="no" />
            <column table="this" column="nachisl" group="no" />
            <column table="this" column="opl_god" group="no" />
            <column table="this" column="opl" group="no" />
            <column table="this" column="spis" group="no" />
            <column table="this" column="spis_god" group="no" />
          </call>
        </call>
      </where>
    </query>
    <query name="21033-12-title-nal" timestamp="22.12.2016 03:58:44">
      <params>
        <param name="date" type="date">
          <const>DATE'2016-12-01'</const>
        </param>
        <param name="ym" type="number">
          <const>2016.11</const>
        </param>
        <param name="dep" type="array">
          <const>102276621</const>
        </param>
        <param name="kod_group_cust_parent" type="array" />
        <param name="kod_group_cust" type="array" />
      </params>
      <select>
        <const as="id" group="1" type="number">1</const>
        <call function="" as="dat" type="date" title="Дата формирования">
          <useparam name="date" />
        </call>
        <call function="" as="ym" type="number" title="Отчетный период">
          <useparam name="ym" />
        </call>
        <column table="a" column="dep_name" group="stragg_dist" />
        <column table="a" column="reserv" group="sumnvl" />
        <column table="a" column="nachisl" group="sumnvl" />
        <column table="a" column="opl" group="sumnvl" />
        <column table="a" column="nachisl_god" group="sumnvl" />
        <column table="a" column="opl_god" group="sumnvl" />
        <column table="a" column="spis" group="sumnvl" />
        <column table="a" column="spis_god" group="sumnvl" />
      </select>
      <from>
        <query name="21033-12-dog-nal" as="a">
          <withparams>
            <useparam name="date" />
            <useparam name="ym" />
            <useparam name="dep" />
            <useparam name="kod_group_cust_parent" />
            <useparam name="kod_group_cust" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="21033-12-sf_last_sud_resh_g" timestamp="25.02.2021 08:05:10">
      <select>
        <column table="a" column="kod_sf" group="1" />
        <column table="a" column="dat_entry" group="1" />
        <column table="a" column="num_delo" group="1" />
        <column table="a" column="dat_post" group="1" />
      </select>
      <from>
        <query name="21033-12-sf_last_sud_resh" as="a" />
      </from>
    </query>
    <query name="21033-12-sf_last_sud_resh" timestamp="11.06.2021 15:33:58">
      <select>
        <column table="kod_deb_sf" column="kod_sf" />
        <column table="kod_mat" column="kod_mat" exclude="1" />
        <call function="over" as="dat_entry" type="date" agg="">
          <call function="last_value">
            <column table="a" column="dat_entry" />
          </call>
          <call function="partition by">
            <column table="kod_deb_sf" column="kod_sf" />
          </call>
          <call function="order by simple">
            <call function="asc nulls first">
              <column table="a" column="dat_entry" />
            </call>
          </call>
        </call>
        <call function="over" agg="" as="num_delo" type="string">
          <call function="last_value">
            <column table="kod_mat" column="num_delo" />
          </call>
          <call function="partition by">
            <column table="kod_deb_sf" column="kod_sf" />
          </call>
          <call function="order by simple">
            <call function="asc nulls first">
              <column table="a" column="dat_entry" />
            </call>
          </call>
        </call>
        <call function="over" as="dat_post" type="date" agg="">
          <call function="last_value">
            <column table="a" column="dat_post" />
          </call>
          <call function="partition by">
            <column table="kod_deb_sf" column="kod_sf" />
          </call>
          <call function="order by simple">
            <call function="asc nulls first">
              <column table="a" column="dat_entry" />
            </call>
          </call>
        </call>
      </select>
      <from>
        <query name="ur_hist_mat" as="a">
          <link name="kod_mat">
            <elink name="ur_dogplat">
              <link name="kod_deb_sf">
                <link name="kod_sf">
                  <link name="kod_dog" />
                </link>
              </link>
            </elink>
          </link>
          <link name="kod_result" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_result" column="decision" />
            <const>1</const>
          </call>
          <call function="is not null">
            <column table="kod_deb_sf" column="kod_sf" />
          </call>
          <call function="like">
            <column table="kod_dog" column="ndog" />
            <const>'%БД'</const>
          </call>
          <call function="=" exclude="1">
            <column table="kod_deb_sf" column="kod_sf" />
            <const>3121187</const>
          </call>
        </call>
      </where>
    </query>
  </queries>
</root>