<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="un-dp-nach-deb" class="1" timestamp="15.11.2018 16:05:53">
      <select>
        <const type="string" as="row_type">'nach-deb'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_sf" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_deb" column="kod_deb" />
        <column table="kod_deb" column="dat_deb" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_ras" column="kod_ras" />
        <column table="kod_ras" column="vid_t" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="ym" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_ras" column="nachisl" />
      </select>
      <from>
        <query name="sr_facras" as="kod_ras">
          <link name="kod_sf">
            <link name="kod_deb">
              <elink name="ur_dogplat" as="kod_dogplat">
                <!--<link name="kod_mat_pp">
                  <link name="kod_hist_mat_last">
                    <dlink name="ur_isp" as="kod_isp"/>
                  </link>
                </link>-->
              </elink>
            </link>
            <link name="kod_dog">
              <link name="kodp" />
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="un-dogplat" cstyle="union" class="1" timestamp="27.09.2017 01:25:08">
      <select>
        <column table="*" column="row_type" type="string" group="1" />
        <!--Абонент-->
        <column table="*" column="kod_abon_type" type="number" group="1" />
        <column table="*" column="dep" type="number" group="1" />
        <column table="*" column="kodp" type="number" group="1" />
        <column table="*" column="kod_dog" type="number" group="1" />
        <!--Документ-->
        <column table="*" column="kod_folders" type="number" group="1" />
        <column table="*" column="kod_sogl" type="number" group="1" comment="Дополнительный документ (kod_sdp = 3)" />
        <column table="*" column="kod_pretenz" type="number" group="1" comment="Претензия (kod_sdp = 4)" />
        <column table="*" column="kod_mat_pp" type="number" group="1" comment="Претензионно-исковая работа.Материалы в суд (kod_sdp - 6)" />
        <column table="*" column="kod_inkasso" type="number" group="1" comment="Исполнительное производство.Инкассо (kod_sdp = 11)" />
        <column table="*" column="kod_kazn" type="number" group="1" comment="Исполнительное производство.Казначейство (kod_sdp = 12)" />
        <column table="*" column="kod_mat_ssp" type="number" group="1" comment="Исполнительное производство.Материалы в ССП (kod_sdp = 13)" />
        <column table="*" column="kod_mat_ip" type="number" group="1" comment="Исполнительное производство.Материалы не в ССП (kod_sdp = 14)" />
        <column table="*" column="kod_mat_ba" type="number" group="1" comment="Банкротство.Материалы в суд (kod_sdp = 15)" />
        <column table="*" column="kod_stage_bk" type="number" group="1" comment="Банкротство.Стадии процедуры банкротства (kod_sdp = 20)" />
        <column table="*" column="kod_likvid" type="number" group="1" comment="Ликвидация.Ликвидационная комиссия (kod_sdp = 30)" />
        <column table="*" column="kod_dead" type="number" group="1" comment="Мёртвая задолженность.Документы (kod_sdp = 37)" />
        <!--Связь-->
        <column table="*" column="kod_dogplat" type="number" group="1" />
        <column table="*" column="kod" type="number" group="1" />
        <column table="*" column="kod_sdp" type="number" group="1" />
        <column table="*" column="vid_real" type="number" group="1" />
        <column table="*" column="dat_form" type="date" group="1" />
        <column table="*" column="kod_izv" type="number" group="1" />
        <column table="*" column="kod_sf" type="number" group="1" />
        <column table="*" column="kod_deb" type="number" group="1" />
        <column table="*" column="dat_izv" type="number" group="1" />
        <column table="*" column="dat_sf" type="number" group="1" />
        <column table="*" column="dat_deb" type="number" group="1" />
        <column table="*" column="ym" type="number" group="1" />
        <!--Начисления-->
        <column table="*" column="kod_account" type="number" group="1" />
        <column table="*" column="kod_ras" type="number" group="1" />
        <column table="*" column="vid_t" type="number" group="1" />
        <column table="*" column="dat_priem" type="date" group="1" />
        <column table="*" column="ym_nach" type="number" group="1" />
        <!--Оплаты-->
        <column table="*" column="kod_opl_fl" type="number" group="1" />
        <column table="*" column="kod_opl_ul" type="number" group="1" />
        <column table="*" column="dat_deb_bank" type="date" group="1" />
        <column table="*" column="dat_opl_bank" type="date" group="1" />
        <column table="*" column="dat_bal" type="date" group="1" />
        <column table="*" column="dat_opl" type="date" group="1" />
        <column table="*" column="ym_opl" type="number" group="1" />
        <column table="kod_dogplat" column="prizn_konv" type="number" group="1" as="prizn_konv" />
        <column table="kod_mat_pp" column="last_dat_post" type="number" group="1" />
        <column table="un_mat_pp" column="sum_gp" group="sumnvl" />
        <column table="un_mat_pp_prin" column="sum_gp_prin" group="sumnvl" />
        <column table="un_hist_mat_pp" column="sum_gp_es" group="sumnvl" />
        <column table="un_hist_mat_pp" column="sum_gp_otv" group="sumnvl" />
        <column table="un_hist_mat_pp" column="sum_gp_ret" group="sumnvl" />
        <!--Начисления-->
        <column table="un_nach_izv" column="nachisl" as="nachisl_izv" group="sumnvl" />
        <column table="un_nach_sf" column="nachisl" as="nachisl_sf" group="sumnvl" />
        <column table="un_nach_pn_sf" column="nachisl" as="nachisl_pn_sf" group="sumnvl" />
        <column table="un_nach_deb" column="nachisl" as="nachisl_deb" group="sumnvl" />
        <call function="+nvl" as="nachisl" type="number">
          <column table="this" column="nachisl_izv" />
          <column table="this" column="nachisl_sf" />
          <column table="this" column="nachisl_pn_sf" />
          <column table="this" column="nachisl_deb" />
        </call>
        <call function="if" as="nachisl_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_noosn" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_peny" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_astrent" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <call function="if" as="nachisl_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="nachisl" />
          <const>0</const>
        </call>
        <column table="un_dp" column="summa" as="summa" group="sumnvl" />
        <call function="if" as="summa_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="summa" />
          <const>0</const>
        </call>
        <call function="if" as="summa_osn" type="number" title="Выставлено: основная реализация">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="summa" />
          <const>0</const>
        </call>
        <call function="if" as="summa_shtraf" type="number" title="">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="summa" />
          <const>0</const>
        </call>
        <call function="if" as="summa_peny" type="number" title="Выставлено: проц. за польз. чуж. средств.">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>7</const>
          </call>
          <column table="this" column="summa" />
          <const>0</const>
        </call>
        <call function="if" as="summa_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="summa" />
          <const>0</const>
        </call>
        <column table="un_mat_pp" column="ogr" as="summa_ogr" group="sumnvl" />
        <column table="un_dp" column="sum_v" as="sum_v" group="sumnvl" />
        <call function="if" as="sum_v_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="sum_v" />
          <const>0</const>
        </call>
        <call function="if" as="sum_v_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="sum_v" />
          <const>0</const>
        </call>
        <call function="if" as="sum_v_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="sum_v" />
          <const>0</const>
        </call>
        <call function="if" as="sum_v_peny" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>7</const>
          </call>
          <column table="this" column="sum_v" />
          <const>0</const>
        </call>
        <call function="if" as="sum_v_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="sum_v" />
          <const>0</const>
        </call>
        <call function="coalesce" as="sum_v_ogr">
          <column table="un_hist_mat_pp" column="ogr" as="ogr_hist" group="sumnvl" />
          <column table="this" column="summa_ogr" />
          <const>0</const>
        </call>
        <column table="un_hist_mat_pp" column="sud_izd" as="sum_v_sud_izd" group="sumnvl" />
        <!--Оплаты-->
        <column table="un_opl_izv" column="opl" as="opl_izv" group="sumnvl" />
        <column table="un_opl_sf" column="opl" as="opl_sf" group="sumnvl" />
        <column table="un_opl_pn_sf" column="opl" as="opl_pn_sf" group="sumnvl" />
        <column table="un_opl_deb" column="opl" as="opl_deb" group="sumnvl" />
        <call function="+nvl" as="opl" type="number">
          <column table="this" column="opl_izv" />
          <column table="this" column="opl_sf" />
          <column table="this" column="opl_pn_sf" />
          <column table="this" column="opl_deb" />
        </call>
        <call function="if" as="opl_astrent" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <call function="if" as="opl_noosn" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <!--<column table="un_facopl_sf" column="opl" as="facopl_sf" group="sumnvl" />
        <column table="un_facopl_pn_sf" column="opl" as="facopl_pn_sf" group="sumnvl" />
        <column table="un_facopl_deb" column="opl" as="facopl_deb" group="sumnvl" />
        <call function="+nvl" as="facopl" type="number">
          <column table="this" column="opl_izv" />
          <column table="this" column="facopl_sf" />
          <column table="this" column="facopl_pn_sf" />
          <column table="this" column="facopl_deb" />
        </call>-->
        <call function="if" as="opl_doc" type="number">
          <call function="or">
            <call function="=1">
              <column table="this" column="prizn_konv" group="1" />
            </call>
            <call function="gt">
              <column table="this" column="dat_opl" />
              <call function="nvl">
                <call function="earliest">
                  <column table="this" column="dat_form" />
                  <column table="this" column="last_dat_post" group="1" />
                </call>
                <call function="nativity" />
              </call>
            </call>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <call function="if" as="opl_doc_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="opl_doc" />
          <const>0</const>
        </call>
        <call function="if" as="opl_doc_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="opl_doc" />
          <const>0</const>
        </call>
        <call function="if" as="opl_doc_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="opl_doc" />
          <const>0</const>
        </call>
        <call function="if" as="opl_doc_peny" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="opl_doc" />
          <const>0</const>
        </call>
        <call function="if" as="opl_doc_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="opl_doc" />
          <const>0</const>
        </call>
        <call function="if" title="Оплата до вынесения решения суда" as="opl_do_resh" type="number">
          <call function="and">
            <call function="gt">
              <column table="this" column="dat_opl" />
              <call function="nvl">
                <column table="this" column="dat_form" />
                <call function="nativity" />
              </call>
            </call>
            <call function="le">
              <column table="this" column="dat_opl" />
              <call function="nvl">
                <column table="kod_hist_mat_last" column="dat_post" group="1" />
                <call function="doomsday" />
              </call>
            </call>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_resh_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="opl_do_resh" />
          <const>0</const>
        </call>
        <call function="if" title="Оплата после вынесения решения суда" as="opl_resh" type="number">
          <call function="and">
            <call function="is not null">
              <column table="kod_hist_mat_last" column="kod_hist_mat" group="1" />
            </call>
            <call function="gt">
              <column table="this" column="dat_opl" />
              <column table="kod_hist_mat_last" column="dat_post" group="1" />
            </call>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <call function="if" title="Оплата по решению до выдачи исполнительного листа" as="opl_do_isp" type="number">
          <call function="and">
            <call function="gt">
              <column table="this" column="dat_opl" />
              <call function="nvl">
                <column table="kod_hist_mat_last" column="dat_post" group="1" />
                <call function="doomsday" />
              </call>
            </call>
            <call function="le">
              <column table="this" column="dat_opl" />
              <call function="nvl">
                <column table="kod_isp_last" column="dat_doc" group="1" />
                <call function="doomsday" />
              </call>
            </call>
          </call>
          <column table="this" column="opl" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_isp_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_isp_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_isp_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_isp_peny" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call>
        <call function="if" as="opl_do_isp_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call>has
        <call function="if" as="opl_do_isp_astrent" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="opl_do_isp" />
          <const>0</const>
        </call><column table="un_hist_mat_pp" column="opl_ogr" as="opl_do_isp_ogr" group="sumnvl" /><column table="un_hist_mat_pp" column="opl_sud_izd" as="opl_do_isp_sud_izd" group="sumnvl" /><!--Остаток--><call function="-nvl" title="Остаток задолженности до вынесения решения суда" as="dolg_do_resh">
          <column table="this" column="summa" />
          <column table="this" column="opl_do_resh" />
        </call><call function="if" as="dolg_do_resh_nogp">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="dolg_do_resh" />
        </call><call function="if" title="Остаток по решению до выдачи исполнительного листа" as="dolg_do_isp">
          <call function="is not null">
            <column table="kod_hist_mat_last" column="kod_hist_mat" group="1" />
          </call>
          <call function="-nvl">
            <column table="this" column="sum_v" />
            <column table="this" column="opl_do_isp" />
          </call>
        </call><call function="if" as="dolg_do_isp_nogp">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="if" as="dolg_do_isp_osn">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="if" as="dolg_do_isp_shtraf">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="if" as="dolg_do_isp_peny">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="if" as="dolg_do_isp_gp">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="if" as="dolg_do_isp_astrent">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="dolg_do_isp" />
        </call><call function="-nvl" as="dolg_do_isp_ogr">
          <column table="this" column="sum_v_ogr" />
          <column table="this" column="opl_do_isp_ogr" />
        </call><call function="-nvl" as="dolg_do_isp_sud_izd">
          <column table="this" column="sum_v_sud_izd" />
          <column table="this" column="opl_do_isp_sud_izd" />
        </call><call function="if" as="ost_doc_pp" type="number">
          <call function="is not null">
            <column table="kod_hist_mat_last" column="kod_hist_mat" group="1" />
          </call>
          <call function="-nvl">
            <column table="this" column="sum_v" />
            <column table="this" column="opl_resh" />
          </call>
          <call function="-nvl">
            <column table="this" column="summa" />
            <column table="this" column="opl_doc" />
          </call>
        </call><call function="if" as="ost_doc_pp_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="ost_doc_pp" />
          <const>0</const>
        </call><call function="if" as="ost_doc_pp_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="ost_doc_pp" />
          <const>0</const>
        </call><call function="if" as="ost_doc_pp_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="ost_doc_pp" />
          <const>0</const>
        </call><call function="if" as="ost_doc_pp_peny" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="ost_doc_pp" />
          <const>0</const>
        </call><call function="if" as="ost_doc_pp_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="ost_doc_pp" />
          <const>0</const>
        </call><call function="if" as="ost_doc_pp_astrent" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <call function="-nvl">
            <column table="this" column="nachisl" />
            <column table="this" column="opl" />
          </call>
          <const>0</const>
        </call><call function="-nvl" as="ost_doc" type="number">
          <column table="this" column="summa" />
          <column table="this" column="opl_doc" />
        </call><call function="if" as="ost_doc_nogp" type="number">
          <call function="!=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="ost_doc" />
          <const>0</const>
        </call><call function="if" as="ost_doc_osn" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="ost_doc" />
          <const>0</const>
        </call><call function="if" as="ost_doc_shtraf" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>4</const>
          </call>
          <column table="this" column="ost_doc" />
          <const>0</const>
        </call><call function="if" as="ost_doc_peny" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="not like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <column table="this" column="ost_doc" />
          <const>0</const>
        </call><call function="if" as="ost_doc_gp" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>9</const>
          </call>
          <column table="this" column="ost_doc" />
          <const>0</const>
        </call><call function="if" as="ost_doc_astrent" type="number">
          <call function="and">
            <call function="=">
              <column table="this" column="vid_real" />
              <const>7</const>
            </call>
            <call function="like">
              <column table="this" column="row_type" />
              <const>'%pn-sf'</const>
            </call>
          </call>
          <call function="-nvl">
            <column table="this" column="nachisl" />
            <column table="this" column="opl" />
          </call>
          <const>0</const>
        </call><!--Химия--><column table="this" column="ym_nach" as="ym_s" group="min" /><column table="this" column="ym_nach" as="ym_po" group="max" /><call function="if" as="ym_osn_s" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="ym_s" />
          <const>null</const>
        </call><call function="if" as="ym_osn_po" type="number">
          <call function="=">
            <column table="this" column="vid_real" />
            <const>2</const>
          </call>
          <column table="this" column="ym_po" />
          <const>null</const>
        </call><column table="un_opl_kred_ul" column="oplf" as="opl_kred" group="sumnvl" /><column table="this" column="opl_kred" as="opl_kred_itog" cumulate="ym" /><call function="+nvl" as="opl_kred_28007" type="number">
          <column table="this" column="sum_gp_prin" />
          <call function="if">
            <call function="!=">
              <column table="this" column="vid_real" />
              <const>2</const>
            </call>
            <column table="this" column="opl_kred" />
          </call>
        </call><column table="this" column="opl_kred_28007" as="opl_kred_28007_itog" cumulate="ym" /><call function="+nvl" as="nach_deb_28007" type="number">
          <column table="this" column="sum_gp" />
          <column table="this" column="nachisl_noosn" />
        </call><column table="this" column="nach_deb_28007" as="nach_deb_28007_itog" cumulate="ym" /><call function="-nvl" as="oborot" title="Задолженность">
          <column table="this" column="nachisl" />
          <column table="this" column="opl" />
        </call><call function="-nvl" as="oborot_28007" title="Задолженность">
          <call function="+nvl">
            <column table="this" column="nachisl_noosn" />
            <column table="this" column="sum_gp" />
          </call>
          <call function="+nvl">
            <column table="this" column="opl_noosn" />
            <column table="this" column="sum_gp_prin" />
            <column table="this" column="opl_kred" />
          </call>
        </call><column table="this" column="oborot_28007" as="oborot_28007_itog" cumulate="ym" /><call function="-nvl" as="oborot_gp">
          <column table="this" column="nachisl_gp" />
          <column table="this" column="opl_doc_gp" />
        </call><column table="this" column="oborot_gp" as="oborot_gp_itog" cumulate="ym" /><call function="-nvl" as="oborot_peny">
          <column table="this" column="nachisl_peny" />
          <column table="this" column="opl_doc_peny" />
        </call><column table="this" column="oborot_peny" as="oborot_peny_itog" cumulate="ym" /><call function="-nvl" as="oborot_full">
          <column table="this" column="oborot" />
          <column table="this" column="opl_kred" />
        </call><column table="this" column="oborot_full" as="oborot_full_itog" cumulate="ym" /><column table="un_opl_sf" column="pr_recalc_opl" as="pr_recalc_opl_sf" group="max" /><column table="un_opl_deb" column="pr_recalc_opl" as="pr_recalc_opl_deb" group="max" /><call function="coalesce" as="pr_recalc_opl" type="number">
          <column table="this" column="pr_recalc_opl_sf" />
          <column table="this" column="pr_recalc_opl_deb" />
        </call><column table="kod_mat_pp" column="kod_mat" as="pr_isk" window="kod_dog" group="max" /><column table="kod_mat_ba" column="kod_mat" as="pr_isk_ba" window="kod_dog" group="max" /><column table="this" column="oborot_gp_itog" as="oborot_gp_by_mat_itog" window="kod_mat_pp" virtual="1" /><column table="this" column="oborot_peny_itog" as="oborot_peny_by_mat_itog" window="kod_mat_pp" virtual="1" /><column table="this" column="oborot_peny_itog" as="oborot_peny_by_sf_itog" window="kod_sf" virtual="1" /><column table="un_peny_izv" column="ym_peny" as="ym_peny_s" group="min" /><column table="un_peny_izv" column="ym_peny" as="ym_peny_po" group="max" /><column table="un_peny_izv" column="ym_peny_zad" as="ym_peny_zad_s" group="max" /><column table="un_peny_izv" column="ym_peny_zad" as="ym_peny_zad_po" group="max" /><!--<column table="this" column="opl_kred_itog" as="opl_kred_itog_dog" window="kod_dog" virtual="1" />
        <column table="this" column="opl_kred_noosn_itog" as="opl_kred_noosn_itog_dog" window="kod_dog" virtual="1" />
        <column table="this" column="oborot_full_itog" as="oborot_full_itog_dog" window="kod_dog" virtual="1" />
        <column table="this" column="oborot_noosn_full_itog" as="oborot_noosn_full_itog_dog" window="kod_dog" virtual="1" />--><!--Фиктивные колонки чтобы запрос не отбрасывался--><column table="un_dp" column="un_dp" group="sumnvl" /><column table="un_sogl" column="un_sogl" group="sumnvl" /><column table="un_pretenz" column="un_pretenz" group="sumnvl" /><column table="un_mat_pp" column="un_mat_pp" group="sumnvl" /><column table="un_hist_mat_pp" column="un_hist_mat_pp" group="sumnvl" /><column table="un_isp_pp" column="un_isp_pp" group="sumnvl" /><column table="un_inkasso" column="un_inkasso" group="sumnvl" /><column table="un_kazn" column="un_kazn" group="sumnvl" /><column table="un_mat_ssp" column="un_mat_ssp" group="sumnvl" /><column table="un_mat_ip" column="un_mat_ip" group="sumnvl" /><column table="un_mat_ba" column="un_mat_ba" group="sumnvl" /><column table="un_stage_bk" column="un_stage_bk" group="sumnvl" /><column table="un_likvid" column="un_likvid" group="sumnvl" /><column table="un_dead" column="un_dead" group="sumnvl" /><column table="un_nach_izv" column="un_nach_izv" group="sumnvl" /><column table="un_peny_izv" column="un_peny_izv" group="sumnvl" /><column table="un_mat_pp" column="num_delo" group="stragg" />
      </select>
      <from>
        <query name="un-dp" as="un_dp" />
        <query name="un-dp-nach-izv" as="un_nach_izv" />
        <query name="un-dp-nach-sf" as="un_nach_sf" />
        <query name="un-dp-nach-pn-sf" as="un_nach_pn_sf" />
        <query name="un-dp-nach-deb" as="un_nach_deb" />
        <query name="un-dp-opl-izv" as="un_opl_izv" />
        <query name="un-dp-opl-sf" as="un_opl_sf" />
        <query name="un-dp-opl-pn-sf" as="un_opl_pn_sf" />
        <query name="un-dp-opl-deb" as="un_opl_deb" />
        <!--<query name="un-dp-facopl-sf" as="un_facopl_sf" />
        <query name="un-dp-facopl-pn-sf" as="un_facopl_pn_sf" />
        <query name="un-dp-facopl-deb" as="un_facopl_deb" />-->
        <query name="un-opl-kred-ul" as="un_opl_kred_ul" />
        <query name="un-sogl" as="un_sogl" />
        <query name="un-pretenz" as="un_pretenz" />
        <query name="un-mat-pp" as="un_mat_pp">
          <withparams>
            <const>0</const>
          </withparams>
        </query>
        <query name="un-mat-pp" as="un_mat_pp_prin">
          <withparams>
            <const>1</const>
          </withparams>
        </query>
        <query name="un-hist-mat-pp" as="un_hist_mat_pp" />
        <query name="un-isp-pp" as="un_isp_pp" />
        <query name="un-inkasso" as="un_inkasso" />
        <query name="un-kazn" as="un_kazn" />
        <query name="un-mat-ssp" as="un_mat_ssp" />
        <query name="un-mat-ip" as="un_mat_ip" />
        <query name="un-mat-ba" as="un_mat_ba" />
        <query name="un-stage-bk" as="un_stage_bk" />
        <query name="un-likvid" as="un_likvid" />
        <query name="un-dead" as="un_dead" />
        <query name="un-peny-izv" as="un_peny_izv" />
      </from>
      <push>
        <from>
          <query name="ur_dogplat" as="kod_dogplat" join="left outer" dname="un_dogplat">
            <using>
              <column column="kod_dogplat" />
            </using>
          </query>
          <query name="sr_facvip" as="kod_sf" join="left outer" dname="un_dogplat">
            <using>
              <column column="kod_sf" />
            </using>
          </query>
          <query name="kr_dogovor" as="kod_dog" join="left outer">
            <using>
              <column column="kod_dog" />
            </using>
          </query>
          <query name="ur_folders" as="kod_folders" join="left outer">
            <using>
              <column column="kod_folders" />
            </using>
          </query>
          <query name="ur_sogl" as="kod_sogl" join="left outer">
            <using>
              <column column="kod_sogl" />
            </using>
          </query>
          <query name="ur_pretenz" as="kod_pretenz" join="left outer">
            <using>
              <column column="kod_pretenz" />
            </using>
          </query>
          <query name="ur_mat" as="kod_mat_pp" join="left outer" dname="un_dogplat_pp">
            <link name="kod_hist_mat_last">
              <link name="kod_isp_last" />
            </link>
            <call function="=">
              <column table="*" column="kod_mat_pp" />
              <column table="kod_mat_pp" column="kod_mat" />
            </call>
          </query>
          <query name="ur_inkasso" as="kod_inkasso" join="left outer">
            <using>
              <column column="kod_inkasso" />
            </using>
          </query>
          <query name="ur_kazn" as="kod_kazn" join="left outer">
            <using>
              <column column="kod_kazn" />
            </using>
          </query>
          <query name="ur_mat" as="kod_mat_ssp" join="left outer" dname="un_dogplat_ssp">
            <call function="=">
              <column table="*" column="kod_mat_ssp" />
              <column table="kod_mat_ssp" column="kod_mat" />
            </call>
          </query>
          <query name="ur_mat" as="kod_mat_ip" join="left outer" dname="un_dogplat_ip">
            <call function="=">
              <column table="*" column="kod_mat_ip" />
              <column table="kod_mat_ip" column="kod_mat" />
            </call>
          </query>
          <query name="ur_mat" as="kod_mat_ba" join="left outer" dname="un_dogplat_ba">
            <call function="=">
              <column table="*" column="kod_mat_ba" />
              <column table="kod_mat_ba" column="kod_mat" />
            </call>
          </query>
          <query name="ur_likvid" as="kod_likvid" join="left outer">
            <using>
              <column column="kod_likvid" />
            </using>
          </query>
          <query name="ur_stage_bk" as="kod_stage_bk" join="left outer">
            <using>
              <column column="kod_stage_bk" />
            </using>
          </query>
          <query name="ur_dead" as="kod_dead" join="left outer">
            <using>
              <column column="kod_dead" />
            </using>
          </query>
        </from>
      </push>
    </query>
    <query name="un-dp">
      <select>
        <const type="string" as="row_type">'dogplat'</const>
        <column table="kodp" column="kod_abon_type" group="1" />
        <column table="kod_dog" column="dep" group="1" />
        <column table="kodp" column="kodp" group="1" />
        <column table="kod_dog" column="kod_dog" group="1" />
        <column table="kod_dogplat" column="kod_folders" group="1" />
        <column table="kod_dogplat" column="kod_sogl" group="1" />
        <column table="kod_dogplat" column="kod_pretenz" group="1" />
        <column table="kod_dogplat" column="kod_mat_pp" group="1" />
        <column table="kod_dogplat" column="kod_inkasso" group="1" />
        <column table="kod_dogplat" column="kod_kazn" group="1" />
        <column table="kod_dogplat" column="kod_mat_ssp" group="1" />
        <column table="kod_dogplat" column="kod_mat_ip" group="1" />
        <column table="kod_dogplat" column="kod_mat_ba" group="1" />
        <column table="kod_dogplat" column="kod_stage_bk" group="1" />
        <column table="kod_dogplat" column="kod_likvid" group="1" />
        <column table="kod_dogplat" column="kod_dead" group="1" />
        <call function="keep first" as="kod_dogplat">
          <column table="kod_dogplat" column="kod_dogplat" group="max" />
          <column table="kod_dogplat" column="dat_form" />
        </call>
        <column table="kod_dogplat" column="kod_sdp" group="1" />
        <column table="kod_dogplat" column="kod" group="1" />
        <column table="kod_dogplat" column="vid_real" group="1" />
        <column table="kod_dogplat" column="kod_izv" group="1" />
        <column table="kod_dogplat" column="kod_sf" group="1" />
        <column table="kod_dogplat" column="kod_deb" group="1" />
        <column table="kod_dogplat" column="dat_form" group="max" />
        <call function="keep first" as="summa">
          <column table="kod_dogplat" column="summa" group="max" />
          <column table="kod_dogplat" column="dat_form" />
        </call>
        <call function="keep first" as="sum_v">
          <column table="kod_dogplat" column="sum_v" group="max" />
          <column table="kod_dogplat" column="dat_form" />
        </call>
        <const type="number" as="un_dp">1</const>
      </select>
      <from>
        <query name="ur_dogplat" as="kod_dogplat">
          <link name="kod_dog">
            <link name="kodp" />
          </link>
        </query>
      </from>
    </query>
    <query name="un-dp-nach-izv">
      <select>
        <const type="string" as="row_type">'nach-izv'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_dogplat" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_izv" column="kod_izv" />
        <column table="kod_izv" column="date_izv" as="dat_izv" />
        <column table="kod_account" column="kod_account" />
        <column table="kod_account" column="vid_t" />
        <column table="kod_account" column="ym" as="ym_nach" />
        <column table="kod_account" column="ym" />
        <column table="kod_account" column="dat_priem" />
        <column table="kod_account" column="nachisl" />
        <!--<column table="kod_mat_pp" column="dat_doc" as="dat_mat"/>
        <column table="kod_hist_mat_last" column="dat_post" as="dat_hist"/>
        <column table="kod_isp" column="dat_doc" as="dat_isp" dgroup="max"/>-->
        <const type="number" as="un_nach_izv">1</const>
      </select>
      <from>
        <query name="tnr_account" as="kod_account">
          <link name="kod_izv">
            <elink name="ur_dogplat" as="kod_dogplat">
              <!--<link name="kod_mat_pp">
                <link name="kod_hist_mat_last">
                  <dlink name="ur_isp" as="kod_isp"/>
                </link>
              </link>-->
            </elink>
          </link>
          <link name="kod_dog">
            <link name="kodp" />
          </link>
        </query>
      </from>
    </query>
    <query name="un-dp-nach-sf">
      <select>
        <const type="string" as="row_type">'nach-sf'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_sf" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_ras" column="kod_ras" />
        <column table="kod_ras" column="vid_t" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="ym" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_ras" column="nachisl" />
      </select>
      <from>
        <query name="sr_facras" as="kod_ras">
          <link name="kod_sf">
            <elink name="ur_dogplat" as="kod_dogplat" />
            <link name="kod_dog">
              <link name="kodp" />
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="un-dp-nach-pn-sf" comment="Проценты за несвоевременную оплату по делу (Астрент)">
      <select>
        <const type="string" as="row_type">'nach-pn-sf'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_sf_pn" column="kod_delo" as="kod_mat_pp" />
        <const type="number" as="kod_sdp">6</const>
        <column table="kod_sf_pn" column="kod_delo" as="kod" />
        <column table="kod_sf" column="vid_real" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_ras" column="kod_ras" />
        <column table="kod_ras" column="vid_t" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="ym" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_ras" column="nachisl" />
      </select>
      <from>
        <query name="sr_facras" as="kod_ras">
          <link name="kod_sf">
            <elink name="sr_penni_mat" as="kod_sf_pn">
              <link name="kod_mat" />
            </elink>
            <link name="kod_dog">
              <link name="kodp" />
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="un-dp-opl-izv">
      <select>
        <const type="string" as="row_type">'opl-izv'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_opl" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_izv" column="kod_izv" />
        <column table="kod_account" column="kod_account" />
        <column table="kod_account" column="vid_t" />
        <column table="kod_account" column="ym" as="ym_nach" />
        <column table="kod_account" column="ym" />
        <column table="kod_account" column="dat_priem" />
        <column table="kod_opl" column="kod_opl" as="kod_opl_fl" />
        <column table="kod_link" column="dat_deb" as="dat_deb_bank" />
        <column table="kod_link" column="dat_opl" as="dat_opl_bank" />
        <column table="kod_opl" column="dat_bal" />
        <column table="kod_opl" column="dat_opl" />
        <column table="kod_opl" column="ym" as="ym_opl" />
        <column table="kod_opl" column="ym" />
        <column table="accopl" column="opl" />
      </select>
      <from>
        <query name="tnr_accopl" as="accopl">
          <link name="kod_opl">
            <link name="kod_link" />
            <link name="kod_dog">
              <link name="kodp" />
            </link>
          </link>
          <link name="kod_account">
            <link name="vid_t" />
            <link name="kod_izv">
              <elink name="ur_dogplat" as="kod_dogplat">
                <!--<link name="kod_mat_pp">
                  <link name="kod_hist_mat_last">
                    <dlink name="ur_isp" as="kod_isp"/>
                  </link>
                </link>-->
              </elink>
            </link>
          </link>
        </query>
      </from>
    </query>
    <query name="un-dp-opl-sf">
      <select>
        <const type="string" as="row_type">'opl-sf'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_opl" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_deb" column="kod_deb" />
        <column table="kod_deb" column="dat_deb" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_opl" column="kod_opl" as="kod_opl_ul" />
        <column table="kod_link" column="dat_deb" as="dat_deb_bank" />
        <column table="kod_link" column="dat_opl" as="dat_opl_bank" />
        <column table="kod_opl" column="dat_opl" />
        <column table="kod_opl" column="ym" as="ym_opl" />
        <column table="kod_opl" column="ym" />
        <column table="kod_opl" column="opl" />
        <call function="if" as="pr_recalc_opl" comment="Признак, что оплата перенесена откудато там">
          <call function="gt">
            <column table="sr_recalc_opl" column="kod_recalc" dgroup="count" />
            <const>0</const>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="sr_opl" as="kod_opl">
          <link name="kod_sf">
            <link name="kod_deb" />
            <elink name="ur_dogplat" as="kod_dogplat" />
          </link>
          <link name="kod_link" />
          <link name="kod_dog">
            <link name="kodp" />
          </link>
          <dlink name="sr_recalc_opl" />
        </query>
      </from>
    </query>
    <query name="un-dp-opl-deb">
      <select>
        <const type="string" as="row_type">'opl-deb'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_opl" column="vid_real" />
        <column table="kod_dogplat" column="dat_form" />
        <column table="kod_deb" column="kod_deb" />
        <column table="kod_deb" column="dat_deb" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_opl" column="kod_opl" as="kod_opl_ul" />
        <column table="kod_link" column="dat_deb" as="dat_deb_bank" />
        <column table="kod_link" column="dat_opl" as="dat_opl_bank" />
        <column table="kod_opl" column="dat_opl" />
        <column table="kod_opl" column="ym" as="ym_opl" />
        <column table="kod_opl" column="ym" />
        <column table="kod_opl" column="opl" />
        <call function="if" as="pr_recalc_opl" comment="Признак, что оплата перенесена откудато там">
          <call function="gt">
            <column table="sr_recalc_opl" column="kod_recalc" dgroup="count" />
            <const>0</const>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="sr_opl" as="kod_opl">
          <link name="kod_sf">
            <link name="kod_deb">
              <elink name="ur_dogplat" as="kod_dogplat" />
            </link>
          </link>
          <link name="kod_link" />
          <link name="kod_dog">
            <link name="kodp" />
          </link>
          <dlink name="sr_recalc_opl" />
        </query>
      </from>
    </query>
    <query name="un-dp-opl-pn-sf" comment="Оплата процентов за несвоевременную оплату по делу (Астрента)">
      <select>
        <const type="string" as="row_type">'opl-pn-sf'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_sf_pn" column="kod_delo" as="kod_mat_pp" />
        <const type="number" as="kod_sdp">6</const>
        <column table="kod_sf_pn" column="kod_delo" as="kod" />
        <column table="kod_opl" column="vid_real" />
        <column table="kod_deb" column="kod_deb" />
        <column table="kod_deb" column="dat_deb" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_opl" column="kod_opl" as="kod_opl_ul" />
        <column table="kod_link" column="dat_deb" as="dat_deb_bank" />
        <column table="kod_link" column="dat_opl" as="dat_opl_bank" />
        <column table="kod_opl" column="dat_opl" />
        <column table="kod_opl" column="ym" as="ym_opl" />
        <column table="kod_opl" column="ym" />
        <column table="kod_opl" column="opl" />
      </select>
      <from>
        <query name="sr_opl" as="kod_opl">
          <link name="kod_sf">
            <elink name="sr_penni_mat" as="kod_sf_pn">
              <link name="kod_mat" />
            </elink>
            <link name="kod_deb" />
          </link>
          <link name="kod_link" />
          <link name="kod_dog">
            <link name="kodp" />
          </link>
        </query>
      </from>
    </query>
    <query name="un-opl-kred-ul">
      <select>
        <const type="string" as="row_type">'opl-kred-ul'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_link" column="kod_mat" as="kod_mat_pp" />
        <column table="kod_opl" column="vid_real" />
        <column table="kod_deb" column="kod_deb" />
        <column table="kod_deb" column="dat_deb" />
        <column table="kod_sf" column="kod_sf" />
        <column table="kod_sf" column="dat_sf" />
        <column table="kod_sf" column="ym" as="ym_nach" />
        <column table="kod_sf" column="dat_priem" />
        <column table="kod_opl" column="kod_opl" as="kod_opl_ul" />
        <column table="kod_link" column="dat_deb" as="dat_deb_bank" />
        <column table="kod_link" column="dat_opl" as="dat_opl_bank" />
        <column table="kod_opl" column="dat_opl" />
        <column table="kod_opl" column="ym" as="ym_opl" />
        <column table="kod_opl" column="ym" />
        <column table="kod_opl" column="oplf" />
      </select>
      <from>
        <query name="sr_opl" as="kod_opl">
          <link name="kod_sf">
            <link name="kod_deb" />
          </link>
          <link name="kod_link">
            <link name="kod_mat">
              <link name="kod_folders" />
            </link>
          </link>
          <link name="kod_dog">
            <link name="kodp" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="in">
            <column table="kod_opl" column="kod_type_opl" />
            <array>
              <const>1</const>
              <const>2</const>
              <const>5</const>
              <const>6</const>
            </array>
          </call>
          <!--<call function="=">
            <column table="kod_dog" column="kod_dog"/>
            <const>20010051</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="un-sogl">
      <select>
        <const type="string" as="row_type">'sogl'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_sogl" column="kod_folders" />
        <column table="kod_sogl" column="kod_sogl" />
        <const type="number" as="kod_sdp">3</const>
        <column table="kod_sogl" column="kod_sogl" as="kod" />
        <const type="number" as="un_sogl">1</const>
      </select>
      <from>
        <query name="ur_sogl" as="kod_sogl">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-pretenz" timestamp="20.07.2022 12:40:30">
      <select>
        <const type="string" as="row_type">'pretenz'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_pretenz" column="kod_folders" />
        <column table="kod_pretenz" column="kod_pretenz" />
        <const type="number" as="kod_sdp">4</const>
        <column table="kod_pretenz" column="kod_pretenz" as="kod" />
        <const type="number" as="un_pretenz">1</const>
      </select>
      <from>
        <!--query name="ur_pretenz" as="kod_pretenz">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query -->
        <query name="ur_pretenz" as="kod_pretenz" />
        <query name="ur_folders" as="kod_folders">
          <call function="=">
            <column table="kod_folders" column="kod_folders" />
            <column table="kod_pretenz" column="kod_folders" />
          </call>
        </query>
        <query name="kr_payer" as="kodp">
          <call function="=">
            <column table="kodp" column="kodp" />
            <column table="kod_folders" column="kodp" />
          </call>
        </query>
        <query name="kr_dogovor" as="kod_dog">
          <call function="and">
            <call function="=">
              <column table="kod_dog" column="kodp" />
              <column table="kod_folders" column="kodp" />
            </call>
            <call function="=">
              <column table="kod_dog" column="dep" />
              <column table="kod_folders" column="kod_podr" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-mat-pp" class="1">
      <params>
        <param name="ym_type" type="number" comment="для 28007 0:ym = dat_gp, 1:ym = dat_prin" />
      </params>
      <select>
        <const type="string" as="row_type">'mat-pp'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_pp" />
        <const type="number" as="kod_sdp">6</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <call function="date to ym" as="ym">
          <call function="if">
            <call function="=">
              <useparam name="ym_type" />
              <const>0</const>
            </call>
            <call function="nvl">
              <column table="kod_mat" column="dat_gp" />
              <call function="doomsday" />
            </call>
            <call function="nvl">
              <column table="kod_mat" column="dat_prin" />
              <call function="doomsday" />
            </call>
          </call>
        </call>
        <call function="if" as="sum_gp">
          <call function="=">
            <useparam name="ym_type" />
            <const>0</const>
          </call>
          <column table="kod_mat" column="sum_gp" />
        </call>
        <call function="if" as="sum_gp_prin">
          <call function="=">
            <useparam name="ym_type" />
            <const>1</const>
          </call>
          <column table="kod_mat" column="sum_gp" />
        </call>
        <column table="kod_mat" column="num_delo" />
        <column table="kod_mat" column="ogr" />
        <const type="number" as="un_mat_pp">1</const>
      </select>
      <from>
        <query name="ur_mat" as="kod_mat">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>1</const>
          </call>
          <call function="is null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
        </call>
      </where>
    </query>
    <query name="un-hist-mat-pp">
      <select>
        <const type="string" as="row_type">'hist-mat-pp'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_pp" />
        <const type="number" as="kod_sdp">6</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <call function="date to ym" as="ym">
          <column table="kod_hist_mat" column="dat_post" />
        </call>
        <column table="kod_hist_mat" column="gp_es" as="sum_gp_es" />
        <column table="kod_hist_mat" column="gp_otv" as="sum_gp_otv" />
        <column table="kod_hist_mat" column="gp_ret" as="sum_gp_ret" />
        <column table="kod_hist_mat" column="ogr" />
        <column table="kod_hist_mat" column="sud_izd" />
        <column table="kod_hist_mat" column="opl_ogr" />
        <column table="kod_hist_mat" column="opl_sud_izd" />
        <const type="number" as="un_hist_mat_pp">1</const>
      </select>
      <from>
        <query name="ur_hist_mat" as="kod_hist_mat">
          <link name="kod_mat">
            <link name="kod_folders">
              <link name="kodp" />
            </link>
            <link name="kod_dog" />
          </link>
          <link name="kod_result" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>1</const>
          </call>
          <call function="is null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
          <call function="=">
            <column table="kod_result" column="decision" />
            <const>1</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-isp-pp" class="1">
      <select>
        <const type="string" as="row_type">'isp-pp'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_pp" />
        <const type="number" as="kod_sdp">6</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <call function="date to ym" as="ym">
          <column table="kod_hist_mat" column="dat_post" />
        </call>
        <const type="number" as="un_isp_pp">1</const>
      </select>
      <from>
        <query name="ur_isp" as="kod_isp">
          <link name="kod_hist_mat">
            <link name="kod_mat">
              <link name="kod_folders">
                <link name="kodp" />
              </link>
              <link name="kod_dog" />
            </link>
            <link name="kod_result" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>1</const>
          </call>
          <call function="is null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
          <!--<call function="=">
            <column table="kod_result" column="decision"/>
            <const>1</const>
          </call>-->
        </call>
      </where>
    </query>
    <query name="un-inkasso">
      <select>
        <const type="string" as="row_type">'inkasso'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_inkasso" column="kod_folders" />
        <column table="kod_inkasso" column="kod_inkasso" />
        <const type="number" as="kod_sdp">11</const>
        <column table="kod_inkasso" column="kod_inkasso" as="kod" />
        <const type="number" as="un_inkasso">1</const>
      </select>
      <from>
        <query name="ur_inkasso" as="kod_inkasso">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>2</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-kazn">
      <select>
        <const type="string" as="row_type">'kazn'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_kazn" column="kod_folders" />
        <column table="kod_kazn" column="kod_kazn" />
        <const type="number" as="kod_sdp">12</const>
        <column table="kod_kazn" column="kod_kazn" as="kod" />
        <const type="number" as="un_kazn">1</const>
      </select>
      <from>
        <query name="ur_kazn" as="kod_kazn">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>2</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-mat-ssp">
      <select>
        <const type="string" as="row_type">'mat-ssp'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_ssp" />
        <const type="number" as="kod_sdp">13</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <const type="number" as="un_mat_ssp">1</const>
      </select>
      <from>
        <query name="ur_mat" as="kod_mat">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>2</const>
          </call>
          <call function="is not null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
        </call>
      </where>
    </query>
    <query name="un-mat-ip">
      <select>
        <const type="string" as="row_type">'mat-ip'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_ip" />
        <const type="number" as="kod_sdp">14</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <const type="number" as="un_mat_ip">1</const>
      </select>
      <from>
        <query name="ur_mat" as="kod_mat">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>2</const>
          </call>
          <call function="is null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
        </call>
      </where>
    </query>
    <query name="un-mat-ba">
      <select>
        <const type="string" as="row_type">'mat-ba'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_mat" column="kod_folders" />
        <column table="kod_mat" column="kod_mat" as="kod_mat_ba" />
        <const type="number" as="kod_sdp">15</const>
        <column table="kod_mat" column="kod_mat" as="kod" />
        <const type="number" as="un_mat_ba">1</const>
      </select>
      <from>
        <query name="ur_mat" as="kod_mat">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>9</const>
          </call>
          <call function="is null">
            <column table="kod_mat" column="kod_ssp" />
          </call>
        </call>
      </where>
    </query>
    <query name="un-stage-bk">
      <select>
        <const type="string" as="row_type">'stage-bk'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_stage_bk" column="kod_folders" />
        <column table="kod_stage_bk" column="kod_stage_bk" />
        <const type="number" as="kod_sdp">20</const>
        <column table="kod_stage_bk" column="kod_stage_bk" as="kod" />
        <const type="number" as="un_stage_bk">1</const>
      </select>
      <from>
        <query name="ur_stage_bk" as="kod_stage_bk">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>9</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-likvid">
      <select>
        <const type="string" as="row_type">'likvid'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_likvid" column="kod_folders" />
        <column table="kod_likvid" column="kod_likvid" />
        <const type="number" as="kod_sdp">30</const>
        <column table="kod_likvid" column="kod_likvid" as="kod" />
        <const type="number" as="un_likvid">1</const>
      </select>
      <from>
        <query name="ur_likvid" as="kod_likvid">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>27</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-dead">
      <select>
        <const type="string" as="row_type">'dead'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_folders" column="kod_podr" as="dep" />
        <column table="kodp" column="kodp" />
        <!--Договор берется один с максимальным kod_dog!-->
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dead" column="kod_folders" />
        <column table="kod_dead" column="kod_dead" />
        <const type="number" as="kod_sdp">37</const>
        <column table="kod_dead" column="kod_dead" as="kod" />
        <const type="number" as="un_dead">1</const>
      </select>
      <from>
        <query name="ur_dead" as="kod_dead">
          <link name="kod_folders">
            <link name="kodp" />
          </link>
          <link name="kod_dog" />
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="kod_folders" column="kod_vi" />
            <const>1</const>
          </call>
          <call function="=">
            <column table="kod_folders" column="kod_sdp" />
            <const>36</const>
          </call>
        </call>
      </where>
    </query>
    <query name="un-peny-izv">
      <select>
        <const type="string" as="row_type">'peny-izv'</const>
        <column table="kodp" column="kod_abon_type" />
        <column table="kod_dog" column="dep" />
        <column table="kodp" column="kodp" />
        <column table="kod_dog" column="kod_dog" />
        <column table="kod_dogplat" column="kod_folders" />
        <column table="kod_dogplat" column="kod_sogl" />
        <column table="kod_dogplat" column="kod_pretenz" />
        <column table="kod_dogplat" column="kod_mat_pp" />
        <column table="kod_dogplat" column="kod_inkasso" />
        <column table="kod_dogplat" column="kod_kazn" />
        <column table="kod_dogplat" column="kod_mat_ssp" />
        <column table="kod_dogplat" column="kod_mat_ip" />
        <column table="kod_dogplat" column="kod_mat_ba" />
        <column table="kod_dogplat" column="kod_stage_bk" />
        <column table="kod_dogplat" column="kod_likvid" />
        <column table="kod_dogplat" column="kod_dead" />
        <column table="kod_dogplat" column="kod_dogplat" />
        <column table="kod_dogplat" column="kod_sdp" />
        <column table="kod_dogplat" column="kod" />
        <column table="kod_dogplat" column="vid_real" />
        <column table="kod_izv" column="kod_izv" />
        <column table="kod_izv_acc" column="ym" as="ym_peny" />
        <column table="kod_pen" column="ym" as="ym_peny_zad" />
        <const type="number" as="un_peny_izv">1</const>
      </select>
      <from>
        <query name="tsr_penni" as="kod_pen">
          <link name="kod_izv_acc">
            <elink name="ur_dogplat" as="kod_dogplat"></elink>
          </link>
          <link name="kod_dog">
            <link name="kodp" />
          </link>
        </query>
      </from>
    </query>
  </queries>
</root>