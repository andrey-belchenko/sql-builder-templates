<?xml version="1.0" encoding="utf-8"?>
<root timestamp="2025-07-10T22:24:15.7116315+03:00">
  <customers child-name="customer" key-name="id" />
  <queries child-name="query" key-name="name">
    <query name="vb_add_fdr" timestamp="21.11.2019 14:25:50" update-target="vb_kol_gr_fdr" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="pwrc_fdrid" type="number" />
        <param name="kod_kol_gr_pwrc" type="number" />
        <param name="entire_fdr" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="kod_kol_gr_pwrc">
          <useparam name="kod_kol_gr_pwrc" />
        </call>
        <call function="()" type="number" as="pwrc_fdrid">
          <useparam name="pwrc_fdrid" />
        </call>
        <call function="()" type="number" as="entire_fdr">
          <useparam name="entire_fdr" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vb_add_pwrc" timestamp="27.11.2018 19:17:46" update-target="vb_kol_gr_pwrc" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="pwrc_id" type="number" />
        <param name="kod_nastr" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="kod_kol_gr_nastr">
          <useparam name="kod_nastr" />
        </call>
        <call function="()" type="number" as="pwrc_id">
          <useparam name="pwrc_id" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vb_nastr_fdr_list" timestamp="21.11.2019 14:24:06" class="1" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <select>
        <call function="||-" key="1" as="pk">
          <column table="pwrc_id" column="kod_kol_gr_pwrc" />
          <column table="a" column="pwrc_fdrid" />
        </call>
        <column table="a" column="pwrc_fdrid" />
        <column table="a" column="pwrc_fdrname" />
        <column table="a" column="pwrcname" />
        <column table="pwrc_id" column="kod_kol_gr_pwrc" />
        <column table="pwrc_fdrid" column="entire_fdr" />
      </select>
      <from>
        <query name="hv_eopwrc_fdrs" as="a" auto-refresh="1" column-editable="0" />
        <query name="vb_kol_gr_pwrc" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="vb_kol_gr_fdr" as="pwrc_fdrid" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_fdrid" />
              <column table="pwrc_fdrid" column="pwrc_fdrid" />
            </call>
            <call function="=">
              <column table="this" column="kod_kol_gr_pwrc" />
              <column table="pwrc_fdrid" column="kod_kol_gr_pwrc" />
            </call>
          </call>
        </query>
        <query name="vb_nastr_fdr_list_exclude" as="pwrc_fdrid_exclude" join="left outer">
          <withparams>
            <useparam name="ym" />
          </withparams>
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid_exclude" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="pwrc_id" column="kod_kol_gr_nastr" />
            <useparam name="kod_nastr" />
          </call>
          <call function="is not null">
            <column table="pwrc_id" column="kod_kol_gr_pwrc" />
          </call>
          <call function="is null">
            <column table="pwrc_fdrid" column="kod_kol_gr_fdr" />
          </call>
          <call function="is null">
            <column table="pwrc_fdrid_exclude" column="pwrc_fdrid" />
          </call>
        </call>
      </where>
    </query>
    <query name="vb_nastr_tp_list" timestamp="21.11.2019 14:41:03" class="1" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <select>
        <call function="||-" key="1" as="pk">
          <column table="pwrc_id" column="kod_kol_gr_pwrc" />
          <column table="pwrc_fdrid" column="kod_kol_gr_fdr" />
          <column table="a" column="pwrc_fdrid" />
          <column table="a" column="src_id" />
        </call>
        <column table="a" column="src_id" />
        <column table="a" column="srcname" title="ТП" />
        <column table="a" column="pwrc_fdrname" title="Фидер" />
        <column table="a" column="pwrcname" title="ПС" />
        <column table="pwrc_fdrid" column="kod_kol_gr_fdr" />
        <column table="pwrc_fdrid" column="kod_kol_gr_pwrc" />
      </select>
      <from>
        <query name="hv_eopwrc_grid" as="a" auto-refresh="1" column-editable="0" />
        <query name="vb_kol_gr_fdr" as="pwrc_fdrid" auto-refresh="1" column-editable="0" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vb_kol_gr_pwrc" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="this" column="kod_kol_gr_pwrc" />
            <column table="pwrc_id" column="kod_kol_gr_pwrc" />
          </call>
        </query>
        <query name="vb_kol_gr_tp" as="src_id" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="src_id" />
              <column table="src_id" column="src_id" />
            </call>
            <call function="=">
              <column table="this" column="kod_kol_gr_fdr" />
              <column table="src_id" column="kod_kol_gr_fdr" />
            </call>
          </call>
        </query>
        <query name="vb_nastr_tp_list_exclude" join="left outer" as="src_id_exclude">
          <withparams>
            <useparam name="ym" />
          </withparams>
          <call function="=">
            <column table="a" column="src_id" />
            <column table="src_id_exclude" column="src_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="pwrc_id" column="kod_kol_gr_nastr" />
            <useparam name="kod_nastr" />
          </call>
          <call function="is not null">
            <column table="pwrc_id" column="kod_kol_gr_pwrc" />
          </call>
          <call function="is not null">
            <column table="pwrc_fdrid" column="kod_kol_gr_fdr" />
          </call>
          <call function="!=">
            <call function="nvl0">
              <column table="pwrc_fdrid" column="entire_fdr" />
            </call>
            <const>1</const>
          </call>
          <call function="is not null" comment="Если после открытия формы запущен отчет 2, то в списке ТП появятся пустые записи (уровень фидера с пустыми ТП, параметр is_test=1 процедуры схемы сети)">
            <column table="a" column="src_id" />
          </call>
          <call function="is null">
            <column table="src_id" column="kod_kol_gr_tp" />
          </call>
          <call function="is null">
            <column table="src_id_exclude" column="src_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="vb_add_tp" timestamp="28.11.2018 12:46:23" update-target="vb_kol_gr_tp" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="src_id" type="number" />
        <param name="kod_kol_gr_fdr" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="kod_kol_gr_fdr">
          <useparam name="kod_kol_gr_fdr" />
        </call>
        <call function="()" type="number" as="src_id">
          <useparam name="src_id" />
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vb_nastr_pwrc_list" timestamp="22.02.2019 12:53:57" class="1" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="kod_nastr" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="ПС" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def" as="a" auto-refresh="1" column-editable="0">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
        <query name="vb_kol_gr_pwrc" as="pwrc_id" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="pwrc_id" />
              <column table="pwrc_id" column="pwrc_id" />
            </call>
            <call function="=">
              <column table="pwrc_id" column="kod_kol_gr_nastr" />
              <useparam name="kod_nastr" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="is null">
          <column table="pwrc_id" column="kod_kol_gr_pwrc" />
        </call>
      </where>
    </query>
    <query name="45862_vb_kg_schema" class="1" timestamp="29.11.2018 17:53:26" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="period_s" type="number" />
        <param name="period_po" type="number" />
      </params>
      <select>
        <column table="a" column="rn" type="string" data-size="4000" />
        <column table="a" column="name" type="string" data-size="4000" title="КГ" />
        <column table="a" column="kod_fl" type="number" />
        <column table="a" column="s" type="number" title="С" />
        <column table="a" column="po" type="number" title="По" />
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrc_fdrid" type="number" title="" />
        <column table="a" column="src_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" data-size="121" title="ПС" />
        <column table="a" column="pwrc_fdrname" type="string" data-size="206" title="Фидер" />
        <column table="a" column="srcname" type="string" data-size="123" title="ТП" />
        <column table="a" column="is_new" type="string" data-size="123" />
        <column table="a" column="is_not_new" type="string" data-size="123" />
        <column table="ymm" column="ym" />
      </select>
      <from>
        <query name="vb_kg_schema" as="a" />
        <query join="left outer" name="spr_time_ym" as="s">
          <call function="=">
            <column table="a" column="s" />
            <column table="s" column="ym" />
          </call>
        </query>
        <query join="left outer" name="spr_time_ym" as="po">
          <call function="=">
            <column table="po" column="ym" />
            <column table="a" column="po" />
          </call>
        </query>
        <query name="spr_time_ym" join="left outer" as="ymm">
          <call function="and">
            <call function="between">
              <column table="ymm" column="ym" />
              <call function="nvl">
                <column table="a" column="s" />
                <const>1.01</const>
              </call>
              <call function="nvl">
                <column table="a" column="po" />
                <const>9999.12</const>
              </call>
            </call>
            <call function="between">
              <column table="ymm" column="ym" />
              <call function="nvl">
                <useparam name="period_s" />
                <const>1.01</const>
              </call>
              <call function="nvl">
                <useparam name="period_po" />
                <const>9999.12</const>
              </call>
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="kod_fl" />
            <useparam name="kod_fl" />
          </call>
          <call function="is not null">
            <column table="ymm" column="ym" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_init_filial" class="1" timestamp="10.12.2018 02:16:46" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <procedure>
        <text>
          BEGIN
       jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl);
	END;
        </text>
      </procedure>
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <call function="()" type="number" as="val">
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="dual" />
      </from>
      <where>
        <call function="is not null">
          <useparam name="kod_fl" />
        </call>
      </where>
    </query>
    <query name="45862_ym_editable" class="1" timestamp="17.04.2020 19:43:22" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="ym" type="number" />
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <call function="if" as="save_active" type="number">
          <call function="ge">
            <useparam name="ym" />
            <call function="max">
              <column table="a" column="ym" />
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="vr_rb_filial_for_param" as="a" />
      </from>
      <where>
        <call function="=" optional="1">
          <column table="a" column="kod_fl" />
          <useparam name="kod_fl" />
        </call>
      </where>
    </query>
    <query name="45862_kg_add_allow_flag" class="1" timestamp="17.04.2020 19:43:35" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="ym" type="number" />
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <call function="if" as="save_active">
          <call function="ge">
            <useparam name="ym" />
            <call function="max">
              <column table="b" column="ym" />
            </call>
          </call>
          <useparam name="kod_fl" />
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="vr_rb_filial_for_param" as="b" />
      </from>
      <where>
        <call function="=" optional="1">
          <column table="b" column="kod_fl" />
          <useparam name="kod_fl" />
        </call>
      </where>
    </query>
    <query name="vb_nastr_tp_list_exclude" timestamp="21.10.2019 16:05:36" class="1" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="ym" type="number" />
      </params>
      <select>
        <column table="vb_kol_gr_tp" column="src_id" group="1" />
      </select>
      <from>
        <query name="vb_kol_gr_tp">
          <link name="kod_kol_gr_fdr">
            <link name="kod_kol_gr_pwrc">
              <link name="kod_kol_gr_nastr" />
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is null">
              <column table="kod_kol_gr_nastr" column="po" />
            </call>
            <call function="ge">
              <column table="kod_kol_gr_nastr" column="po" />
              <useparam name="ym" />
            </call>
          </call>
          <call function="le">
            <column table="kod_kol_gr_nastr" column="s" />
            <useparam name="ym" />
          </call>
        </call>
      </where>
    </query>
    <query name="vb_nastr_fdr_list_exclude" timestamp="21.10.2019 15:33:59" class="1" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="ym" type="number" />
      </params>
      <select>
        <column table="vb_kol_gr_fdr" column="pwrc_fdrid" group="1" />
      </select>
      <from>
        <query name="vb_kol_gr_fdr">
          <elink name="vb_kol_gr_tp" />
          <link name="kod_kol_gr_pwrc">
            <link name="kod_kol_gr_nastr" />
          </link>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="is null">
              <column table="kod_kol_gr_nastr" column="po" />
            </call>
            <call function="ge">
              <column table="kod_kol_gr_nastr" column="po" />
              <useparam name="ym" />
            </call>
          </call>
          <call function="le">
            <column table="kod_kol_gr_nastr" column="s" />
            <useparam name="ym" />
          </call>
          <call function="is null">
            <column table="vb_kol_gr_tp" column="kod_kol_gr_tp" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_vb_kol_gr_allow_edit" class="1" timestamp="18.05.2020 11:56:21" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <params>
        <param name="ym" type="number" />
        <param name="kod_kol_gr_nastr" type="number" />
        <param type="number" name="kod_fl" />
      </params>
      <select>
        <call function="if" as="save_active" type="number">
          <call function="and">
            <call function="=0">
              <call function="nvl0">
                <column table="this" column="is_auto_kg" />
              </call>
            </call>
            <call function="ge">
              <useparam name="ym" />
              <column table="this" column="ym_last" />
            </call>
            <call function="=">
              <useparam name="ym" />
              <call function="nvl">
                <column table="this" column="kg_ym_s" />
                <useparam name="ym" />
              </call>
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <query as="is_auto_kg">
          <select>
            <column table="vb_kol_gr_nastr_sq" column="is_auto_kg" />
          </select>
          <from>
            <query name="vb_kol_gr_nastr" as="vb_kol_gr_nastr_sq" />
          </from>
          <where>
            <call function="=">
              <column table="vb_kol_gr_nastr_sq" column="kod_kol_gr_nastr" />
              <useparam name="kod_kol_gr_nastr" />
            </call>
          </where>
        </query>
        <query as="kg_ym_s">
          <select>
            <call function="min">
              <column table="vb_kol_gr_nastr_sq" column="s" />
            </call>
          </select>
          <from>
            <query name="vb_kol_gr_nastr" as="vb_kol_gr_nastr_sq" />
          </from>
          <where>
            <call function="=">
              <column table="vb_kol_gr_nastr_sq" column="kod_kol_gr_nastr" />
              <useparam name="kod_kol_gr_nastr" />
            </call>
          </where>
        </query>
        <query as="ym_last">
          <select>
            <call function="max" as="max_ym">
              <column table="vr_rb_filial_for_param_sq" column="ym" />
            </call>
          </select>
          <from>
            <query name="vr_rb_filial_for_param" as="vr_rb_filial_for_param_sq" />
          </from>
          <where>
            <call function="=" optional="1">
              <column table="vr_rb_filial_for_param_sq" column="kod_fl" />
              <useparam name="kod_fl" />
            </call>
          </where>
        </query>
      </select>
      <from>
        <query name="dual" />
      </from>
    </query>
    <query name="vr_rb_filial_for_param" class="1" timestamp="17.04.2020 19:42:49" file="sql.builder.templates\sql.builder\projects\45862\form\query.xml">
      <select>
        <column table="a" column="kod_fl" type="number" />
        <column table="a" column="name" type="string" title="Наименование" />
        <column table="a" column="ym" type="number" title="Отчетный период" />
      </select>
      <from>
        <table as="a" name="vr_rb_filial" />
      </from>
      <links exclude="1">
        <dlink name="vr_rb_pwrc" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="d49277_fdrid" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="d49277_pwrc" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="45862" timestamp="26.02.2019 16:52:10" is-report="1" title="Отчет пофидерный анализ по ПС филиалов" mode="excel" can-use-simple-params="1" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <procedure>
        <text>
          BEGIN
	 jg_reports_ise.jr_rep_blns_pwrc_vols_init(:ym);
          END;
        </text>
      </procedure>
      <print-templates>
        <excel>
          <template name="45862.xlsx" title="Отчет пофидерный анализ по ПС филиалов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <events>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_otp" column="wp_in">
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_potreb" column="wp_out" details-use-zeros="1">
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_otp" column="pnt_fdr">
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_potreb" column="pnt_grid">
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
      </events>
      <content>
        <usefield field="cmn_combo_num" title="Отчетный период" name="ym" column-mandatory="1">
          <listquery>
            <query name="45862-yms" />
          </listquery>
          <defaultquery>
            <query name="45862-ym-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_num" title="Филиал" name="kod_fl" column-mandatory="1">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
          <defaultquery>
            <query name="45862-kod_fl-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1">
          <listquery>
            <query name="hv_eopwrc_list" />
          </listquery>
          <defaultquery>
            <query name="45862-pwrc_id-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры" name="pwrc_fdrid" type="number">
          <listquery>
            <query name="hv_eopwrc_fdrs_list" />
          </listquery>
          <defaultquery>
            <query name="hv_eopwrc_fdrs_default" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="ТП, РП, КК" name="src_id" type="number">
          <listquery>
            <query name="hv_eopwrc_grid_dtl_src_list" />
          </listquery>
          <defaultquery>
            <query name="hv_eopwrc_grid_dtl_src_list" />
          </defaultquery>
        </usefield>
      </content>
      <select>
        <column table="pwrc_id" column="pwrc_id" />
        <column table="pwrc_fdrid" column="pwrc_fdrid" />
        <column table="pwrc_grid" column="hv_eopwrc_grid_id" />
        <column table="pwrc_grid_dtl" column="src_fdrid" />
        <column table="kod_fl" column="name" as="fskname" group="max" title="Филиал" />
        <column table="pwrc_id" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="pwrc_fdrid" column="pwrc_fdrname" group="max" title="ДИСП №ФИД" />
        <column table="pwrc_fdrid" column="isprm_fdr" group="max" title="ПР. ПРЯМОФИД" />
        <column table="pwrc_fdrid" column="pwrc_fdr_explname" title="Наименование РЭС" group="max" />
        <column table="pwrc_grid" column="srcname" group="max" title="ТП, РП, КК" />
        <column table="pwrc_grid" column="srcbalname" title="Балансовая принадлежность" group="max" />
        <column table="pwrc_grid_dtl" group="max" title="ТП, РП, КК (для линий)" column="src_fdrname" as="place_namefider" />
        <fact column="jr_rep_blns_pwrc_fdrs_wp_in" group="sum" as="wp_in" />
        <fact column="jr_rep_blns_pwrc_fdrs_wp_out" group="sum" as="wp_out" />
        <fact column="jr_rep_blns_pwrc_fdrs_pnt_fdr" group="sum" as="pnt_fdr" nvl="0" />
        <fact column="jr_rep_blns_pwrc_fdrs_pnt_grid" group="sum" as="pnt_grid" nvl="0" />
        <column table="pwrc_grid_dtl" column="src_id" as=" src_id" exclude="1" />
        <column table="pwrc_grid_dtl" column="src_fdrord" as="src_fdrord" group="max" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="pwrc_id" all-rows="1" />
          <link name="kod_fl" />
          <link name="pwrc_fdrid" all-rows="1" />
          <link name="pwrc_grid" all-rows="1" />
          <link name="pwrc_grid_dtl" all-rows="1" />
          <link name="rep_blns_pwrc_fdrs" exclude="1" />
          <where>
            <call function="and">
              <call function="=">
                <column table="kod_fl" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="in" optional="1">
                <column table="pwrc_id" column="pwrc_id" />
                <useparam name="pwrc_id" />
              </call>
              <call function="in" optional="1">
                <column table="pwrc_fdrid" column="pwrc_fdrid" />
                <useparam name="pwrc_fdrid" />
              </call>
              <call function="or" optional="1">
                <call function="is null">
                  <column table="pwrc_grid_dtl" column="src_id" />
                </call>
                <call function="in">
                  <column table="pwrc_grid_dtl" column="src_id" />
                  <useparam name="src_id" />
                </call>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where exclude="1">
        <call function="=">
          <column table="kod_fl" column="kod_fl" />
          <useparam name="kod_fl" />
        </call>
      </where>
      <grouping>
        <grset as="all" title="Всего">
          <grset as="ps" title="По сетям" order="pwrcname">
            <group>
              <sourcelink table="pwrc_id" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="pwrc_fdrid" />
              </group>
              <grset as="tp" title="По ТП" order="srcname">
                <group>
                  <sourcelink table="pwrc_grid" />
                </group>
                <where>
                  <call function="is not null">
                    <column table="this" column="hv_eopwrc_grid_id" />
                  </call>
                </where>
                <grset as="line" title="По линиям" order="src_fdrord">
                  <group>
                    <column column="src_fdrid" table="this" />
                  </group>
                  <where>
                    <call function="is not null">
                      <column table="this" column="src_fdrid" />
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45862-yms_beg" timestamp="27.12.2018 18:36:32" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="ym" type="number" />
      </params>
      <select>
        <call function="+" as="yms_beg" key="1">
          <call function="trunc">
            <call function="nvl">
              <useparam name="ym" />
              <call function="year">
                <call function="sysdate" />
              </call>
            </call>
          </call>
          <const>0.01</const>
        </call>
        <call as="name" type="" function="to_char">
          <column table="this" column="yms_beg" as="" type="" />
        </call>
      </select>
      <from>
        <query name="dual" as="a" />
      </from>
    </query>
    <query name="45862-detail_otp" timestamp="19.12.2018 19:23:14" is-report="1" title="Детализация отчета пофидер. анализ по ПС фил. ОТПУСК" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="kod_fl" type="number" part-id="45862-detail_otp_param" />
        <param name="pwrc_id" type="array" part-id="45862-detail_otp_param" />
        <param name="pwrc_fdrid" type="array" part-id="45862-detail_otp_param" />
        <param type="array" part-id="45862-detail_otp_param" name="src_id" />
      </params>
      <select>
        <column table="pwrc_grid" column="hv_eopwrc_grid_id" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="kod_rpoint" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="kod_outeris" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_id" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrcname" title="ДИСП №ПС" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrid" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrname" title="ДИСП №ФИД" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="src_id" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="srcname" title="ДИСП №ТП,РП,КК" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="tpoint" title="ВИД ТУ" part-id="45862-detail_otp_select" />
        <call function="to_char" title="№ТУ" as="pnum" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_select">
          <column table="rep_blns_pwrc_fdrs" column="pnum" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="pname" title="НАИМЕН. ТУ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="place_namefider" title="ОБОРУД" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_num" title="№ ПУ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="readvals" title="ПОКАЗАНИЯ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_rkoef" title="РАСЧ.КОЭФ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="out1" title="РАСХ. ПО СЧ., кВт*ч (А+)" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="cust1" title="КОЛИЧ. ЭЭ. кВт*ч (А+)" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="out2" title="РАСХ. ПО СЧ., кВт*ч (А-)" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="cust2" title="КОЛИЧ. ЭЭ. кВт*ч (А-)" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="wp_in" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" format="N2" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="wp_out" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" format="N2" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_es" title="ЭСК" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_fsk" title="ЗОНА ФИЛИАЛА ЛЭ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_rsk" title="РЭС" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="dog_num" title="№ ДОГОВОРА ЭНЕРГ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="user_name" title="ПОТРЕБИТЕЛЬ" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_num" title="№ ОБЪЕКТА" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_name" title="НАИМЕН. ОБЪЕКТА" part-id="45862-detail_otp_select" />
        <column table="rep_blns_pwrc_fdrs" column="r_pwrlev" title="УН" part-id="45862-detail_otp_select" />
        <call function="to_char" title="НАПРЯЖ, кВ" as="pwr_lev" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_select">
          <column table="rep_blns_pwrc_fdrs" column="pwr_lev" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="eobj_adress" title="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" part-id="45862-detail_otp_select" />
        <call function="to_char" title="№ ГРУППЫ ДАННЫХ" as="gr" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_select">
          <column table="rep_blns_pwrc_fdrs" column="gr" />
        </call>
        <call function="to_char" title="ОТЧ.ПЕРИОД" comment="чтобы не выводились итоги в футере" as="ym" part-id="45862-detail_otp_select">
          <column table="rep_blns_pwrc_fdrs" column="ym" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="src_fdrid" part-id="45862-detail_otp_select" />
      </select>
      <from>
        <qube star-scheme="1" part-id="45862-detail_otp_qube">
          <link name="pwrc_id" part-id="45862-detail_otp_qube" />
          <link name="kod_fl" part-id="45862-detail_otp_qube" />
          <link name="pwrc_fdrid" part-id="45862-detail_otp_qube" />
          <link name="pwrc_grid" part-id="45862-detail_otp_qube" />
          <link name="pwrc_grid_dtl" part-id="45862-detail_otp_qube" />
          <link name="rep_blns_pwrc_fdrs" all-rows="1" part-id="45862-detail_otp_qube" />
        </qube>
      </from>
    </query>
    <query name="45862-test" timestamp="14.03.2018 15:50:30" is-report="1" title="Отчет пофидерный анализ по ПС филиалов" mode="excel" can-use-simple-params="1" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="pwrc_id" column="pwrc_id" />
        <column table="pwrc_id" column="bal_id" />
        <column table="pwrc_fdrid" column="pwrc_fdrid" />
        <column table="pwrc_grid" column="hv_eopwrc_grid_id" />
        <column table="pwrc_grid_dtl" column="src_fdrid" />
        <column table="kod_fl" column="name" as="fskname" group="max" title="Филиал" />
        <column table="pwrc_id" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="pwrc_fdrid" column="pwrc_fdrname" group="max" title="ДИСП №ФИД" />
        <column table="pwrc_fdrid" column="isprm_fdr" group="max" title="ПР. ПРЯМОФИД" />
        <column table="pwrc_grid" column="srcname" group="max" title="ТП, РП, КК" />
        <column table="pwrc_grid_dtl" group="max" title="ТП, РП, КК (для линий)" column="src_fdrname" as="place_namefider" />
        <fact column="jr_rep_blns_pwrc_fdrs_wp_in" group="sum" as="wp_in" exclude="1" />
        <fact column="jr_rep_blns_pwrc_fdrs_wp_out" group="sum" as="wp_out" exclude="1" />
        <fact column="jr_rep_blns_pwrc_fdrs_pnt_fdr" group="sum" as="pnt_fdr" nvl="0" exclude="1" />
        <fact column="jr_rep_blns_pwrc_fdrs_pnt_grid" group="sum" as="pnt_grid" nvl="0" />
      </select>
      <from>
        <qube>
          <link name="pwrc_id" all-rows="1">
            <link name="kod_fl" />
          </link>
          <link name="pwrc_fdrid" all-rows="1" />
          <link name="pwrc_grid" all-rows="1" />
          <link name="pwrc_grid_dtl" all-rows="1" />
          <link name="rep_blns_pwrc_fdrs" />
          <where>
            <call function="and">
              <call function="=" exclude="1">
                <column table="kod_fl" column="kod_fl" />
                <const>12968</const>
              </call>
              <call function="=">
                <column table="pwrc_id" column="bal_id" />
                <const>12968</const>
              </call>
              <call function="in" optional="1">
                <column table="pwrc_id" column="pwrc_id" />
                <const>208996</const>
              </call>
              <call function="=" exclude="1">
                <column table="pwrc_grid_dtl" column="src_fdrid" />
                <const>336105</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <where exclude="1">
        <call function="=">
          <column table="pwrc_grid_dtl" column="src_fdrid" />
          <const>372910</const>
        </call>
      </where>
      <grouping>
        <grset as="all" title="Всего" exclude="1">
          <grset as="ps" title="По сетям" order="pwrcname">
            <group>
              <sourcelink table="pwrc_id" />
            </group>
            <grset as="fdr" title="По фидерам" order="pwrc_fdrname nulls first">
              <group>
                <sourcelink table="pwrc_fdrid" />
              </group>
              <grset as="tp" title="По ТП" order="srcname">
                <group>
                  <sourcelink table="pwrc_grid" />
                </group>
                <where>
                  <call function="is not null">
                    <column table="this" column="hv_eopwrc_grid_id" />
                  </call>
                </where>
                <grset as="line" title="По линиям" order="place_namefider">
                  <group>
                    <column column="src_fdrid" table="this" />
                  </group>
                  <where>
                    <call function="is not null">
                      <column table="this" column="src_fdrid" />
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45862-detail_potreb" timestamp="08.08.2018 18:25:34" is-report="1" title="Детализация отчета пофидер. анализ по ПС фил. ПОТРЕБЛЕНИЕ" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <usepart part="45862-detail_otp_param" />
      </params>
      <select>
        <usepart part="45862-detail_otp_select" />
      </select>
      <from>
        <usepart part="45862-detail_otp_qube" />
      </from>
    </query>
    <query name="45862_test" timestamp="21.05.2021 16:22:41" is-report="1" title="2. Отчет по небалансам электроэнергии" mode="excel" can-use-simple-params="1" order="YM_START_ANALYZ, PWRCNAME, per_kg_s desc, REAL_FDR, srcname, src_fdrord" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <procedure>
        <text>
    BEGIN
        --дублируется, костыль, но в качестве исправления по-другому никак
        --из-за изменения переменной пакета при запуске отчетов 3.1., 3.2.
        jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl, 1);
        
        delete from rr_temp where skod = '45862_fdr_lst';
        insert into rr_temp (skod, n1)
        select distinct '45862_fdr_lst' as skod, a.pwrc_fdrid
        from hv_eopwrc_fdrs a
        where a.pwrc_fdrid in :pwrc_fdrid;
        
        jg_reports_ise.jr_rep_blns_pwrc_vols_init(:ym);
        sqlb_d45862_fdr_kg.fill_table(:ym, :ym, 0);
    END;
</text>
      </procedure>
      <print-templates>
        <excel>
          <template name="45862_test.xlsx" title="Отчет пофидерный анализ по ПС филиалов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <events>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_otp_test" column="wp_in">
          <useparam name="ym" />
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_potreb_test" column="wp_out" details-use-zeros="1">
          <useparam name="ym" />
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_otp_test" column="pnt_fdr">
          <useparam name="ym" />
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_potreb_test" column="pnt_grid">
          <useparam name="ym" />
          <useparam name="kod_fl" />
          <useparam name="pwrc_id" />
          <useparam name="pwrc_fdrid" />
          <useparam name="src_id" />
        </useaction>
      </events>
      <content>
        <usefield field="cmn_combo_num" title="Отчетный период" name="ym" column-mandatory="1">
          <listquery>
            <query name="45862-yms" />
          </listquery>
          <defaultquery>
            <query name="45862-ym-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_num" name="ym_beg" column-mandatory="1" title="Начало года" column-visible="0">
          <listquery>
            <query name="45862-yms_beg" />
          </listquery>
          <defaultquery>
            <query name="45862-yms_beg" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_num" title="Филиал" name="kod_fl" column-mandatory="1">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
          <defaultquery>
            <query name="45862-kod_fl-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Подстанции" name="pwrc_id" type="number" column-mandatory="1">
          <listquery>
            <query name="hv_eopwrc_list_test" />
          </listquery>
          <defaultquery>
            <query name="45862-pwrc_id-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры" name="k_kg_name" type="string" column-mandatory="1">
          <listquery>
            <query name="45862_kg_name_list" />
          </listquery>
          <defaultquery>
            <query name="45862_kg_name_default" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Фидеры без КГ" name="pwrc_fdrid" type="number" column-visible="0">
          <listquery>
            <query name="45862_fdr_by_kn_name_list" />
          </listquery>
          <defaultquery>
            <query name="45862_fdr_by_kn_name_list" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="ТП, РП, КК" name="src_id" type="number" exclude="1">
          <listquery>
            <query name="45862_tp_list" />
          </listquery>
          <defaultquery>
            <query name="45862_tp_list" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="ТП, РП, КК" name="src_id" type="number">
          <listquery>
            <query name="45862_tp_list_v2" />
          </listquery>
          <defaultquery>
            <query name="45862_tp_list_v2" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_check" name="kg_missing_tp_flag" title="Есть новые тп не включены в кг" visible="0">
          <defaultquery>
            <query name="45862_fdr_kg_missing_tp_single_ym_flag" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_text" name="kg_missing_tp_text" column-editable="0" title="ТП, которые необходимо включить в КГ">
          <defaultquery>
            <query name="45862_fdr_kg_missing_tp_single_ym_text" />
          </defaultquery>
        </usefield>
      </content>
      <select>
        <column table="pwrc_id" column="pwrc_id" />
        <column table="pwrc_id" column="YM_START_ANALYZ" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_kg_name" exclude="1" />
        <column table="kg_name" column="k_kg_name" />
        <column table="k_gr_f_tp" column="src_id" />
        <column table="grid_dtl_kg" column="src_fdrid" />
        <column table="kod_fl" column="name" as="fskname" group="max" title="Филиал" />
        <column table="pwrc_id" column="pwrcname" group="max" title="ДИСП №ПС" />
        <column table="kg_name" column="val" title="ДИСП №ФИД" as="kg_name" exclude="1" />
        <column table="kg_name" column="kg_name_w_real_fdr" title="ДИСП №ФИД" as="kg_name" />
        <column table="k_gr_f_tp" column="isprm_fdr" group="stragg_dist" />
        <column table="k_gr_f_tp" column="pwrc_fdr_explname" group="stragg_dist" />
        <column table="k_gr_f_tp" group="max" column="real_fdr" />
        <column table="k_gr_f_tp" column="srcname" group="max" title="ТП, РП, КК" as="srcname" />
        <column table="k_gr_f_tp" column="srcbalname" title="Балансовая принадоежность" group="max" />
        <column table="grid_dtl_kg" group="max" title="ТП, РП, КК (для линий)" column="src_fdrname" as="place_namefider" />
        <fact column="jr_rep_blns_pwrc_fdrs_test_wp_in" group="sum" as="wp_in" table="all" />
        <call as="wp_in_ym1" function="if" group="sum" exclude="1">
          <call function="=">
            <column table="d45862_ym" column="val" />
            <useparam name="ym" />
          </call>
          <fact table="all" column="jr_rep_blns_pwrc_fdrs_test_wp_in" />
        </call>
        <call as="wp_in_ym2" function="if" group="sum" exclude="1">
          <call function="=">
            <column table="d45862_ym" column="val" />
            <useparam name="ym_end" />
          </call>
          <fact table="all" column="jr_rep_blns_pwrc_fdrs_test_wp_in" />
        </call>
        <fact column="jr_rep_blns_pwrc_fdrs_test_wp_out" group="sum" as="wp_out" table="all" />
        <call as="wp_out_ym1" function="if" group="sum" exclude="1">
          <call function="=">
            <column table="d45862_ym" column="val" />
            <useparam name="ym" />
          </call>
          <fact table="all" column="jr_rep_blns_pwrc_fdrs_test_wp_out" />
        </call>
        <call as="wp_out_ym2" function="if" group="sum" exclude="1">
          <call function="=">
            <column table="d45862_ym" column="val" />
            <useparam name="ym_end" />
          </call>
          <fact table="all" column="jr_rep_blns_pwrc_fdrs_test_wp_out" />
        </call>
        <fact column="jr_rep_blns_pwrc_fdrs_test_pnt_fdr" group="sum" as="pnt_fdr" nvl="0" table="all" />
        <fact column="jr_rep_blns_pwrc_fdrs_test_pnt_grid" group="sum" as="pnt_grid" nvl="0" table="all" />
        <column table="grid_dtl_kg" column="src_fdrord" as="src_fdrord" group="max" />
        <fact column="f45862_fdr_kg_pwrc_id" table="f_tp" />
        <fact column="f45862_kg_per_s" table="f_tp" exclude="1" />
        <fact table="all" column="f45862_grid_dtl_kg_pwrc_id" />
        <call function="nvl0" as="per_kg_s" exclude="1">
          <column table="k_gr_f_tp" column="per_kg_s" />
        </call>
        <column table="k_gr_f_tp" column="per_kg_s" as="per_kg_s" exclude="1" />
        <column table="kg_name" column="per_kg_s" />
      </select>
      <from>
        <qube star-scheme="1" single-way="1">
          <dimset as="all">
            <link name="k_gr_f_tp" />
            <link name="kg_name" />
            <link name="grid_dtl_kg" />
            <where>
              <call function="and">
                <call function="in" optional="1">
                  <column table="k_gr_f_tp" column="k_kg_name" />
                  <useparam name="k_kg_name" />
                </call>
                <call function="or" optional="1">
                  <call function="is null">
                    <column table="grid_dtl_kg" column="src_id" />
                  </call>
                  <call function="in">
                    <column table="grid_dtl_kg" column="src_id" />
                    <useparam name="src_id" />
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="f_tp">
            <link name="kg_name" />
            <link name="k_gr_f_tp" />
            <where>
              <call function="and">
                <call function="in" optional="1">
                  <column table="k_gr_f_tp" column="k_kg_name" />
                  <useparam name="k_kg_name" />
                </call>
              </call>
            </where>
          </dimset>
          <dimset as="eqp">
            <link name="grid_dtl_kg" />
            <where>
              <call function="and">
                <call function="or" optional="1">
                  <call function="is null">
                    <column table="grid_dtl_kg" column="src_id" />
                  </call>
                  <call function="in">
                    <column table="grid_dtl_kg" column="src_id" />
                    <useparam name="src_id" />
                  </call>
                </call>
              </call>
            </where>
          </dimset>
          <link name="kod_fl" />
          <link name="pwrc_id" />
          <link name="d45862_ym" exclude="1" />
          <where>
            <call function="and">
              <call function="in" optional="1">
                <column table="pwrc_id" column="pwrc_id" />
                <useparam name="pwrc_id" />
              </call>
              <call function="=">
                <column table="kod_fl" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call optional="1" function="between" exclude="1">
                <column table="d45862_ym" column="val" />
                <useparam name="ym" />
                <useparam name="ym_end" />
              </call>
              <call function="or" optional="1" exclude="1">
                <call function="is null">
                  <column table="pwrc_grid_dtl" column="src_id" />
                </call>
                <call function="in">
                  <column table="pwrc_grid_dtl" column="src_id" />
                  <useparam name="src_id" />
                </call>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего">
          <grset as="ps" title="По сетям" order="pwrcname">
            <group>
              <sourcelink table="pwrc_id" />
            </group>
            <grset as="fdr" title="По фидерам" order="(case when (SUBSTR( k_kg_name, 1 , 1) != '-') then 1 end) nulls last, kg_name nulls first">
              <group>
                <sourcelink table="kg_name" />
              </group>
              <grset as="tp" title="По ТП" order="real_fdr, srcname">
                <group>
                  <sourcelink table="k_gr_f_tp" />
                </group>
                <where>
                  <call function="is not null">
                    <column table="this" column="src_id" />
                  </call>
                </where>
                <grset as="line" title="По линиям" order="src_fdrord">
                  <group>
                    <column column="src_fdrid" table="this" />
                  </group>
                  <where>
                    <call function="is not null">
                      <column table="this" column="src_fdrid" />
                    </call>
                  </where>
                </grset>
              </grset>
            </grset>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45862_m2m_pwrc_fdr" class="1" timestamp="11.09.2019 18:06:58" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <call function="||-" as="id" key="1" group="1">
          <column table="this" column="pwrc_id" />
          <column table="a" column="id" />
        </call>
        <call as="k_pwrc_fdr" function="||-" group="1">
          <column table="this" column="pwrc_id" />
          <column table="a" column="k_gr_f_tp" />
        </call>
        <column table="a" column="k_gr_f_tp" group="1" />
        <call as="pwrc_id" function="nvl" group="1">
          <column table="kg_pwrc" column="pwrc_id" />
          <column table="a" column="pwrc_id" />
        </call>
        <column table="a" column="ym" group="1" />
      </select>
      <from>
        <query name="d45862_fdr_kg" as="a" />
        <query name="45862_kg_pwrc" as="kg_pwrc" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_kol_gr" />
              <column table="kg_pwrc" column="kod_kol_gr" />
            </call>
            <call function="=">
              <column table="a" column="ym" />
              <column table="kg_pwrc" column="ym" />
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="45862_kg_pwrc" class="1" timestamp="11.09.2019 18:06:58" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <call group="1" function="||-" as="id" key="1">
          <column table="a" column="kod_kol_gr" />
          <column table="a" column="ym" />
        </call>
        <column table="a" column="kod_kol_gr" group="1" />
        <column table="a" column="pwrc_id" group="1" />
        <column table="a" column="ym" group="1" />
      </select>
      <from>
        <query name="d45862_fdr_kg" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="is not null">
            <column table="a" column="kod_kol_gr" />
          </call>
          <call function="=0">
            <column table="a" column="exclude_auto_fdr" />
          </call>
        </call>
      </where>
    </query>
    <query name="OLD_45862_tp_kg" class="1" timestamp="26.12.2018 18:36:21" materialize="1" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <call as="id" function="||-" key="1">
          <column table="this" column="k_gr_f_tp" />
          <column table="ym" column="ym" />
        </call>
        <call as="k_gr_f_tp" function="||-">
          <column table="kod_kol_gr" column="kod_kol_gr" />
          <column table="a" column="pwrc_fdrid" />
          <column table="tpn" column="src_id" />
        </call>
        <call as="k_f_tp" function="||-">
          <column table="a" column="pwrc_fdrid" />
          <column table="tpn" column="src_id" />
        </call>
        <call as="is_tp_gr" function="if" type="number">
          <call function="or">
            <call function="is not null" comment="выбранные ТП">
              <column table="tp" column="src_id" />
            </call>
            <call function="is null" comment="не выбраны ТП (весь фидер)">
              <column table="tpsel" column="kod_kol_gr_fdr" />
            </call>
            <call function="is null" comment="фидеры без ТП + строка с фидером и пустой ТП, если в схеме у фидера есть ТП">
              <column table="tpn" column="src_id" />
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <column table="kod_kol_gr" column="name" />
        <column table="kod_kol_gr" column="kod_kol_gr" />
        <column table="ym" column="ym" />
      </select>
      <from>
        <query name="vb_kol_gr_fdr" as="a">
          <link name="kod_kol_gr_pwrc">
            <link name="kod_kol_gr_nastr">
              <link name="kod_kol_gr" />
              <link name="ym" />
            </link>
          </link>
          <link name="tpsel" />
        </query>
        <query name="hv_eopwrc_grid" as="tpn" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="tpn" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vb_kol_gr_tp" as="tp" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_kol_gr_fdr" />
              <column table="tp" column="kod_kol_gr_fdr" />
            </call>
            <call function="=">
              <column table="tpn" column="src_id" />
              <column table="tp" column="src_id" />
            </call>
          </call>
        </query>
        <query name="hv_eopwrc_grid" as="hv_eopwrc_grid_id" join="left outer" dname="45862_tp_kg_elink_tp">
          <call function="and">
            <call function="=">
              <column table="this" column="k_f_tp" />
              <column table="hv_eopwrc_grid_id" column="hv_eopwrc_grid_id" />
            </call>
            <call function="=" exclude="1">
              <column table="this" column="ym" />
              <column table="hv_eopwrc_grid_id" column="ym" />
            </call>
          </call>
        </query>
      </from>
      <where exclude="1">
        <call function="=" exclude="1">
          <column table="a" column="pwrc_fdrid" />
          <const>8885</const>
        </call>
        <call function="=">
          <column table="this" column="is_tp_gr" />
          <const>1</const>
        </call>
      </where>
    </query>
    <query name="45862_tp_is_selected" class="1" timestamp="05.12.2018 21:24:25" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="a" column="kod_kol_gr_fdr" group="1" />
      </select>
      <from>
        <query name="vb_kol_gr_tp" as="a" />
      </from>
    </query>
    <query name="OLD_d45862_fdr_kg" class="1" timestamp="26.12.2018 19:00:17" materialize="1" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <call function="if" as="id" key="1" type="string">
          <call function="=">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <column table="tp_kg" column="id" />
          <call function="||-">
            <const>''</const>
            <column table="hv_eopwrc_grid" column="hv_eopwrc_grid_id" />
            <column table="this" column="ym" />
          </call>
        </call>
        <call function="if" as="k_gr_f_tp" type="string">
          <call function="=">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <column table="tp_kg" column="k_gr_f_tp" />
          <call function="||-">
            <const>''</const>
            <column table="hv_eopwrc_grid" column="hv_eopwrc_grid_id" />
          </call>
        </call>
        <column table="hv_eopwrc_grid" column="hv_eopwrc_grid_id" as="k_f_tp" />
        <call function="if" as="k_kg_name">
          <call function="=">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <call function="||">
            <column table="tp_kg" column="kod_kol_gr" />
            <const>'-'</const>
          </call>
          <call function="||">
            <const>'-'</const>
            <column table="a" column="pwrc_fdrid" />
            <const>'-'</const>
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" is-fact="1" agg="max" fact="f45862_fdr_kg_pwrc_id" exclude="1" />
        <call function="if" as="kg_name" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name">
          <call function="=">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <column table="tp_kg" column="name" />
          <column table="a" column="pwrc_fdrname" />
        </call>
        <call function="if" as="kod_kol_gr">
          <call function="=">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <column table="tp_kg" column="kod_kol_gr" />
        </call>
        <column table="a" column="pwrc_fdrid" />
        <call as="real_fdr" function="||">
          <call function="substr">
            <column table="a" column="pwrcname" />
            <call function="+">
              <call function="instr">
                <column table="a" column="pwrcname" />
                <const>'('</const>
              </call>
              <const>1</const>
            </call>
            <call function="-">
              <call function="instr">
                <column table="a" column="pwrcname" />
                <const>')'</const>
              </call>
              <call function="instr">
                <column table="a" column="pwrcname" />
                <const>'('</const>
              </call>
              <const>1</const>
            </call>
          </call>
          <const>' ('</const>
          <column table="a" column="pwrc_fdrname" />
          <const>')'</const>
        </call>
        <column table="a" column="isprm_fdr" />
        <column table="a" column="pwrc_fdr_explname" />
        <column table="hv_eopwrc_grid" column="src_id" />
        <column table="hv_eopwrc_grid" column="srcname" />
        <column table="hv_eopwrc_grid" column="srcbalname" />
        <column table="tp_kg" column="ym" exclude="1" />
        <call as="ym" function="nvl">
          <column table="tp_kg" column="ym" />
          <const>2018.06</const>
          <call function="date to ym" exclude="1">
            <call function="sysdate" />
          </call>
        </call>
        <column table="ym" column="ym" is-private-dimension="d45862_ym" is-final-dimension="d45862_ym" dimension="d45862_ym" exclude="1" />
      </select>
      <from>
        <query name="hv_eopwrc_fdrs" as="a">
          <elink name="hv_eopwrc_grid">
            <elink name="45862_tp_kg_elink_tp" as="tp_kg" />
          </elink>
        </query>
        <query name="hv_eopwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="this" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="45862-yms_test" join="left outer" as="ym" exclude="1">
          <call function="=">
            <const>1</const>
            <const>1</const>
          </call>
        </query>
      </from>
      <where>
        <call function="=">
          <call function="nvl">
            <column table="tp_kg" column="is_tp_gr" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
      </where>
      <links>
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="45862_fdr_kg_list" class="1" timestamp="10.04.2020 21:07:11" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array">
          <const>78784</const>
        </param>
        <param type="number" name="ym">
          <const>2018.07</const>
        </param>
      </params>
      <select>
        <call function="||-" key="1" as="pk">
          <column table="kod_kol_gr" column="kod_kol_gr" />
          <column table="a" column="pwrc_fdrid" />
        </call>
        <call function="||" as="k_kg_name">
          <call function="nvl">
            <column column="kod_kol_gr" table="kod_kol_gr" />
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <const>'-'</const>
        </call>
        <call as="pwrc_fdrname" function="nvl" title="дисп.номер">
          <column table="kod_kol_gr" column="name" />
          <column table="a" column="pwrc_fdrname" />
        </call>
        <column table="a" column="pwrc_fdr_balname" type="string" title="Бал.принадл" />
        <column table="a" column="pwrc_fdr_bal_id" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="Наименование ПС" />
        <column table="a" column="pr_cycle" type="number" />
        <call function="case" as="pr_cycle_name" title="пр. Закольцован" type="string">
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>1</const>
            </call>
            <const>'Да'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>0</const>
            </call>
            <const>'Нет'</const>
          </call>
        </call>
        <column table="kod_kol_gr" column="kod_kol_gr" />
        <column table="kod_kol_gr" column="fdr_in_auto_kg" />
        <column table="kod_kol_gr" column="is_auto_kg_real" />
        <call as="cnt_fdr_in_kg" function="over">
          <call function="count">
            <call function="if">
              <call function="and">
                <call function="in">
                  <column table="a" column="pwrc_id" />
                  <useparam name="pwrc_id" />
                </call>
                <call function="true" />
                <call function="not" exclude="1">
                  <call function="and">
                    <call function="=">
                      <call function="nvl">
                        <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                        <const>-1</const>
                      </call>
                      <const>1</const>
                    </call>
                    <call function="=">
                      <call function="nvl">
                        <column table="kod_kol_gr" column="is_auto_kg_real" />
                        <const>-1</const>
                      </call>
                      <const>0</const>
                    </call>
                  </call>
                </call>
              </call>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <call function="partition by">
            <column table="kod_kol_gr" column="kod_kol_gr" />
          </call>
        </call>
      </select>
      <from>
        <query name="hv_eopwrc_fdrs" as="a" />
        <query name="45862_nastr_by_ym" join="left outer" as="kod_kol_gr">
          <withparams>
            <useparam name="ym" />
          </withparams>
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="45862_gr_by_pwrc_list" as="b" join="left outer">
          <withparams>
            <useparam name="pwrc_id" />
          </withparams>
          <call function="=">
            <column table="this" column="kod_kol_gr" />
            <column table="b" column="kod_kol_gr" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="false" />
            <call function="in" optional="1">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
            <call function="is not null">
              <column table="b" column="kod_kol_gr" />
            </call>
          </call>
          <call function="not" exclude="1">
            <call function="and">
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                  <const>-1</const>
                </call>
                <const>1</const>
              </call>
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="is_auto_kg_real" />
                  <const>-1</const>
                </call>
                <const>0</const>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862_gr_by_pwrc_list" class="1" timestamp="19.02.2019 10:48:44" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array">
          <const>8871</const>
        </param>
      </params>
      <select>
        <column table="kod_kol_gr" column="kod_kol_gr" group="1" />
      </select>
      <from>
        <query name="vb_kol_gr_pwrc" as="a">
          <link name="kod_kol_gr_nastr">
            <link name="kod_kol_gr" />
          </link>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="in" optional="1">
            <column table="a" column="pwrc_id" />
            <useparam name="pwrc_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_kg_name_list" class="1" timestamp="12.04.2020 01:11:13" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array">
          <const>8871</const>
        </param>
        <param type="number" name="ym">
          <const>2018.07</const>
        </param>
      </params>
      <select>
        <column table="a" column="k_kg_name" key="1" group="1" />
        <column table="a" column="pwrc_fdrname" group="stragg_dist" />
        <column table="a" column="pwrc_fdr_balname" type="string" title="Бал.принадл" group="stragg_dist" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" group="stragg_dist" />
        <column table="pwrc_dub" column="pwrcname" type="string" title="Наименование ПС" group="stragg_dist" />
        <column table="a" column="pr_cycle_name" type="string" group="stragg_dist" />
      </select>
      <from>
        <query name="45862_fdr_kg_list" as="a">
          <withparams>
            <useparam name="pwrc_id" />
            <useparam name="ym" />
          </withparams>
        </query>
        <query name="45862_fdr_kg_list" as="pwrc_dub" join="left outer">
          <withparams>
            <useparam name="pwrc_id" />
            <useparam name="ym" />
          </withparams>
          <call function="and">
            <call function="=" as="" type="">
              <column table="a" column="k_kg_name" />
              <column table="pwrc_dub" column="k_kg_name" />
            </call>
            <call function="true" />
            <call function="not" exclude="1">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="pwrc_dub" column="fdr_in_auto_kg" />
                    <const>-1</const>
                  </call>
                  <const>1</const>
                </call>
                <call function="=">
                  <call function="nvl">
                    <column table="pwrc_dub" column="is_auto_kg_real" />
                    <const>-1</const>
                  </call>
                  <const>0</const>
                </call>
              </call>
            </call>
          </call>
        </query>
        <query name="45862_kol_gr_type" join="left outer" as="kol_gr_type">
          <call function="=">
            <call function="||">
              <column table="kol_gr_type" column="kod_kol_gr" />
              <const>'-'</const>
            </call>
            <column table="a" column="k_kg_name" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="!=0">
            <column table="a" column="cnt_fdr_in_kg" />
          </call>
          <call function="or">
            <call function="=1">
              <column table="kol_gr_type" column="all_fdr_have_tp" />
            </call>
            <call function="not">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="a" column="fdr_in_auto_kg" />
                    <const>-1</const>
                  </call>
                  <const>1</const>
                </call>
                <call function="=">
                  <call function="nvl">
                    <column table="a" column="is_auto_kg_real" />
                    <const>-1</const>
                  </call>
                  <const>0</const>
                </call>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862_fdr_by_kn_name_list" class="1" timestamp="26.12.2018 14:43:15" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
        <param name="ym" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_fdrid" group="1" />
      </select>
      <from>
        <query name="45862_fdr_kg_list" as="a">
          <withparams>
            <useparam name="pwrc_id" />
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="in" optional="1">
            <column table="a" column="k_kg_name" />
            <useparam name="k_kg_name" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_kg_name_default" class="1" timestamp="11.09.2019 16:27:11" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="pwrc_id" type="array" />
        <param name="ym" type="number" />
      </params>
      <select>
        <call function="||" as="k_kg_name" group="1">
          <call function="nvl">
            <column column="kod_kol_gr" table="kod_kol_gr" />
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <const>'-'</const>
        </call>
        <call title="дисп.номер" as="kg_name" function="nvl" group="1">
          <column table="kod_kol_gr" column="name" />
          <column table="a" column="pwrc_fdrname" />
        </call>
      </select>
      <from>
        <query as="a" name="hv_eopwrc_fdrs" />
        <query name="45862_nastr_by_ym" join="left outer" as="kod_kol_gr">
          <withparams>
            <useparam name="ym" />
          </withparams>
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="and" optional="1">
            <call function="in">
              <column table="a" column="pwrc_fdr_bal_id" />
              <useparam name="kod_fl" />
            </call>
            <call function="in">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
            <call function="not">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                    <const>-1</const>
                  </call>
                  <const>1</const>
                </call>
                <call function="=">
                  <call function="nvl">
                    <column table="kod_kol_gr" column="is_auto_kg_real" />
                    <const>-1</const>
                  </call>
                  <const>0</const>
                </call>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="d45862_grid_dtl_kg" class="1" timestamp="21.06.2019 16:46:23" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <call as="grid_dtl_kg" function="||-" key="1">
          <column table="a" column="src_fdrid" />
          <column table="this" column="ym" />
        </call>
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="srcname" type="string" title="" />
        <column table="a" column="src_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" is-fact="1" agg="max" fact="f45862_grid_dtl_kg_pwrc_id" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="srckodp_fsk" type="number" column-mandatory="1" title="" />
        <column table="a" column="hv_eopwrc_grid_id" type="string" title="" />
        <column table="a" column="src_fdrord" type="number" />
        <column table="k_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_f_tp" column="ym" is-private-dimension="ym" is-final-dimension="ym" dimension="ym" />
      </select>
      <from>
        <query name="hv_eopwrc_grid_dtl" as="a" />
        <query name="d45862_fdr_kg" as="k_f_tp" join="left outer">
          <call function="=">
            <column table="this" column="hv_eopwrc_grid_id" />
            <column table="k_f_tp" column="k_f_tp" />
          </call>
        </query>
      </from>
      <links>
        <link name="k_f_tp">
          <dimlink name="kg_name" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="45862_tp_list" class="1" timestamp="07.12.2018 13:24:25" title="ТП, РП, КК" order="pwrcname, pwrc_fdrname, srcname" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_fdrid" type="array" />
      </params>
      <select>
        <column table="a" column="src_id" column-mandatory="1" title="" group="1" />
        <column table="a" column="srcname" group="max" />
        <column table="a" column="src_balnamex" group="max" />
        <call as="fdrname" title="Фидер" type="string" function="||" group="max">
          <column table="a" column="pwrc_fdrname" />
          <const>', '</const>
          <column table="a" column="pwrcname" />
        </call>
        <column table="a" column="pwrc_fdrname" type="string" group="max" />
        <column table="a" column="pwrcname" type="string" group="max" />
      </select>
      <from>
        <query name="hv_eopwrc_grid_dtl_src_fdr_list" as="a">
          <withparams>
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
        <query name="vb_kol_gr_fdr" as="kod_kol_gr_fdr" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr_fdr" column="pwrc_fdrid" />
          </call>
          <link name="tpsel" />
        </query>
        <query name="vb_kol_gr_tp" as="kod_kol_gr_tp" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="src_id" />
              <column table="kod_kol_gr_tp" column="src_id" />
            </call>
            <call function="=">
              <column table="kod_kol_gr_fdr" column="kod_kol_gr_fdr" />
              <column table="kod_kol_gr_tp" column="kod_kol_gr_fdr" />
            </call>
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="is null">
            <column table="tpsel" column="kod_kol_gr_fdr" />
          </call>
          <call function="is not null">
            <column table="kod_kol_gr_tp" column="kod_kol_gr_tp" />
          </call>
          <call function="and" exclude="1">
            <call function="is not null">
              <column table="tpsel" column="kod_kol_gr_fdr" />
            </call>
            <call function="is not null">
              <column table="kod_kol_gr_tp" column="kod_kol_gr_tp" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862-detail_otp_test" timestamp="11.08.2020 12:27:28" is-report="1" title="Детализация отчета пофидер. анализ по ПС фил. ОТПУСК" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="ym" type="number" part-id="45862-detail_otp_test_param" />
        <param name="kod_fl" type="number" part-id="45862-detail_otp_test_param" />
        <param name="pwrc_id" type="array" part-id="45862-detail_otp_test_param" />
        <param name="k_kg_name" type="array" part-id="45862-detail_otp_test_param" />
        <param name="pwrc_fdrid" type="array" part-id="45862-detail_otp_test_param" />
        <param type="array" part-id="45862-detail_otp_test_param" name="src_id" />
      </params>
      <select>
        <call as="id" function="||-" part-id="45862-detail_otp_test_select" key="1">
          <column table="rep_blns_pwrc_fdrs" column="k_gr_f_tp" />
          <column table="rep_blns_pwrc_fdrs" column="kod_rpoint" />
          <column table="rep_blns_pwrc_fdrs" column="cnt_num" />
          <column table="rep_blns_pwrc_fdrs" column="src_fdrid" />
          <column table="rep_blns_pwrc_fdrs" column="dog_num" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="k_gr_f_tp" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="hv_eopwrc_grid_id" part-id="45862-detail_otp_test_select" type="string" />
        <column table="rep_blns_pwrc_fdrs" column="kod_rpoint" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="kod_outeris" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_id" exclude="1" />
        <call function="nvl" part-id="45862-detail_otp_test_select" as="pwrc_id">
          <column table="kol_gr_pwrc" column="pwrc_id" />
          <column table="rep_blns_pwrc_fdrs" column="pwrc_id" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="pwrcname" title="ДИСП №ПС" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrid" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrname" title="ДИСП №ФИД" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="src_id" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="srcname" title="ДИСП №ТП,РП,КК" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="tpoint" title="ВИД ТУ" part-id="45862-detail_otp_test_select" />
        <call function="to_char" title="№ТУ" as="pnum" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_test_select">
          <column table="rep_blns_pwrc_fdrs" column="pnum" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="pname" title="НАИМЕН. ТУ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="place_namefider" title="ОБОРУД" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_num" title="№ ПУ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="readvals" title="ПОКАЗАНИЯ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_rkoef" title="РАСЧ.КОЭФ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="out1" title="РАСХ. ПО СЧ., кВт*ч (А+)" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="cust1" title="КОЛИЧ. ЭЭ. кВт*ч (А+)" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="out2" title="РАСХ. ПО СЧ., кВт*ч (А-)" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="cust2" title="КОЛИЧ. ЭЭ. кВт*ч (А-)" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="wp_in" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" format="N2" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="wp_out" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" format="N2" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_es" title="ЭСК" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_fsk" title="ЗОНА ФИЛИАЛА ЛЭ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="name_rsk" title="РЭС" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="dog_num" title="№ ДОГОВОРА ЭНЕРГ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="user_name" title="ПОТРЕБИТЕЛЬ" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_num" title="№ ОБЪЕКТА" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_name" title="НАИМЕН. ОБЪЕКТА" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="r_pwrlev" title="УН" part-id="45862-detail_otp_test_select" />
        <call function="to_char" title="НАПРЯЖ, кВ" as="pwr_lev" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_test_select">
          <column table="rep_blns_pwrc_fdrs" column="pwr_lev" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="eobj_adress" title="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" part-id="45862-detail_otp_test_select" />
        <call function="to_char" title="№ ГРУППЫ ДАННЫХ" as="gr" comment="чтобы не выводились итоги в футере" part-id="45862-detail_otp_test_select">
          <column table="rep_blns_pwrc_fdrs" column="gr" />
        </call>
        <call function="to_char" title="ОТЧ.ПЕРИОД" comment="чтобы не выводились итоги в футере" as="ym" part-id="45862-detail_otp_test_select">
          <column table="rep_blns_pwrc_fdrs" column="ym" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="src_fdrid" part-id="45862-detail_otp_test_select" />
        <column table="rep_blns_pwrc_fdrs" column="kg_name" part-id="45862-detail_otp_test_select" title=" " />
        <column table="rep_blns_pwrc_fdrs" column="k_kg_name" part-id="45862-detail_otp_test_select" title=" " />
        <column table="rep_blns_pwrc_fdrs" column="pnt_fdr" part-id="45862-detail_otp_test_select" title=" " />
        <column table="rep_blns_pwrc_fdrs" column="pnt_grid" part-id="45862-detail_otp_test_select" title=" " />
      </select>
      <from>
        <qube star-scheme="1" part-id="45862-detail_otp_test_qube">
          <link name="rep_blns_pwrc_fdrs_test" part-id="45862-detail_otp_test_qube" as="rep_blns_pwrc_fdrs" all-rows="1" />
          <dimset as="all" part-id="45862-detail_otp_test_qube">
            <link name="k_gr_f_tp" part-id="45862-detail_otp_test_qube" />
            <link name="kg_name" part-id="45862-detail_otp_test_qube" />
            <link name="grid_dtl_kg" part-id="45862-detail_otp_test_qube" />
          </dimset>
          <link name="kod_fl" part-id="45862-detail_otp_test_qube" />
          <link name="pwrc_id" part-id="45862-detail_otp_test_qube" />
        </qube>
        <query join="left outer" name="45862_kol_gr_src_pwrc" as="kol_gr_pwrc" part-id="45862-detail_otp_test_qube">
          <call function="and" part-id="45862-detail_otp_test_qube">
            <call function="=" part-id="45862-detail_otp_test_qube">
              <column table="rep_blns_pwrc_fdrs" column="src_id" part-id="45862-detail_otp_test_qube" />
              <column table="kol_gr_pwrc" column="src_id" part-id="45862-detail_otp_test_qube" />
            </call>
            <call function="=" part-id="45862-detail_otp_test_qube">
              <column table="rep_blns_pwrc_fdrs" column="k_kg_name" part-id="45862-detail_otp_test_qube" />
              <call function="||" part-id="45862-detail_otp_test_qube">
                <column table="kol_gr_pwrc" column="kod_kol_gr" part-id="45862-detail_otp_test_qube" />
                <const part-id="45862-detail_otp_test_qube">'-'</const>
              </call>
            </call>
          </call>
        </query>
      </from>
    </query>
    <query name="45862-detail_potreb_test" timestamp="11.08.2020 12:28:18" is-report="1" title="Детализация отчета пофидер. анализ по ПС фил. ПОТРЕБЛЕНИЕ" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <usepart part="45862-detail_otp_test_param" />
      </params>
      <select>
        <usepart part="45862-detail_otp_test_select" />
      </select>
      <from>
        <usepart part="45862-detail_otp_test_qube" />
      </from>
    </query>
    <query name="45862_test_det_mat" timestamp="23.12.2018 20:52:53" is-report="1" title="Отчет пофидерный анализ по ПС филиалов" mode="excel" can-use-simple-params="1" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <procedure>
        <text>
          BEGIN
jg_reports_ise.set_kodp_fsk(1105);
	 jg_reports_ise.jr_rep_blns_pwrc_vols_init(2018.07);
          END;
        </text>
      </procedure>
      <print-templates>
        <excel>
          <template name="45862_test_det_mat.xlsx" title="Отчет пофидерный анализ по ПС филиалов" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <events>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="45862-detail_otp_test_det_mat" column="wp_in">
          <const>1105</const>
          <const exclude="1">8871</const>
          <const exclude="1">8873</const>
        </useaction>
      </events>
      <select>
        <column table="kod_fl" column="kod_fl" />
        <column table="pwrc_id_test_det_mat" column="pwrc_id" />
        <column table="pwrc_id_test_det_mat" column="pwrcname" group="max" />
        <fact column="jr_rep_test_det_mat_wp_in" group="sum" as="wp_in" type="number" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_fl" />
          <link name="pwrc_id_test_det_mat" />
          <where exclude="1">
            <call function="and">
              <call function="=">
                <column table="kod_fl" column="kod_fl" />
                <const>1105</const>
              </call>
            </call>
          </where>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего">
          <group>
            <sourcelink table="kod_fl" />
          </group>
          <grset as="ps">
            <group>
              <sourcelink table="pwrc_id_test_det_mat" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="45862-detail_otp_test_det_mat" timestamp="23.12.2018 21:01:29" is-report="1" title="Детализация отчета пофидер. анализ по ПС фил. ОТПУСК" visible="0" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params exclude="1">
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <call function="||-" key="1" as="idr">
          <column table="rep_blns_pwrc_fdrs" column="bal_id" />
          <column table="rep_blns_pwrc_fdrs" column="pwrc_id" />
          <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrid" />
          <column table="rep_blns_pwrc_fdrs" column="src_id" />
          <column table="rep_blns_pwrc_fdrs" column="kod_rpoint" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="kod_rpoint" />
        <column table="rep_blns_pwrc_fdrs" column="kod_outeris" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_id" />
        <column table="rep_blns_pwrc_fdrs" column="pwrcname" title="ДИСП №ПС" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrid" />
        <column table="rep_blns_pwrc_fdrs" column="pwrc_fdrname" title="ДИСП №ФИД" />
        <column table="rep_blns_pwrc_fdrs" column="src_id" />
        <column table="rep_blns_pwrc_fdrs" column="srcname" title="ДИСП №ТП,РП,КК" />
        <column table="rep_blns_pwrc_fdrs" column="tpoint" title="ВИД ТУ" />
        <call function="to_char" title="№ТУ" as="pnum" comment="чтобы не выводились итоги в футере">
          <column table="rep_blns_pwrc_fdrs" column="pnum" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="pname" title="НАИМЕН. ТУ" />
        <column table="rep_blns_pwrc_fdrs" column="place_namefider" title="ОБОРУД" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_num" title="№ ПУ" />
        <column table="rep_blns_pwrc_fdrs" column="readvals" title="ПОКАЗАНИЯ" />
        <column table="rep_blns_pwrc_fdrs" column="cnt_rkoef" title="РАСЧ.КОЭФ" />
        <column table="rep_blns_pwrc_fdrs" column="out1" title="РАСХ. ПО СЧ., кВт*ч (А+)" />
        <column table="rep_blns_pwrc_fdrs" column="cust1" title="КОЛИЧ. ЭЭ. кВт*ч (А+)" />
        <column table="rep_blns_pwrc_fdrs" column="out2" title="РАСХ. ПО СЧ., кВт*ч (А-)" />
        <column table="rep_blns_pwrc_fdrs" column="cust2" title="КОЛИЧ. ЭЭ. кВт*ч (А-)" />
        <column table="rep_blns_pwrc_fdrs" column="wp_in" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" format="N2" />
        <column table="rep_blns_pwrc_fdrs" column="wp_out" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" format="N2" />
        <column table="rep_blns_pwrc_fdrs" column="name_es" title="ЭСК" />
        <column table="rep_blns_pwrc_fdrs" column="name_fsk" title="ЗОНА ФИЛИАЛА ЛЭ" />
        <column table="rep_blns_pwrc_fdrs" column="name_rsk" title="РЭС" />
        <column table="rep_blns_pwrc_fdrs" column="dog_num" title="№ ДОГОВОРА ЭНЕРГ" />
        <column table="rep_blns_pwrc_fdrs" column="user_name" title="ПОТРЕБИТЕЛЬ" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_num" title="№ ОБЪЕКТА" />
        <column table="rep_blns_pwrc_fdrs" column="eobj_name" title="НАИМЕН. ОБЪЕКТА" />
        <column table="rep_blns_pwrc_fdrs" column="r_pwrlev" title="УН" />
        <call function="to_char" title="НАПРЯЖ, кВ" as="pwr_lev" comment="чтобы не выводились итоги в футере">
          <column table="rep_blns_pwrc_fdrs" column="pwr_lev" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="eobj_adress" title="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" />
        <call function="to_char" title="№ ГРУППЫ ДАННЫХ" as="gr" comment="чтобы не выводились итоги в футере">
          <column table="rep_blns_pwrc_fdrs" column="gr" />
        </call>
        <call function="to_char" title="ОТЧ.ПЕРИОД" comment="чтобы не выводились итоги в футере" as="ym">
          <column table="rep_blns_pwrc_fdrs" column="ym" />
        </call>
        <column table="rep_blns_pwrc_fdrs" column="src_fdrid" />
        <column table="pwrc_id_test_det_mat" column="hv_eopwrc_id" />
        <column table="rep_blns_pwrc_fdrs" column="bal_id" as="kod_fl" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="kod_fl" />
          <link name="pwrc_id_test_det_mat" />
          <link all-rows="1" name="rep_blns_test_det_mat" as="rep_blns_pwrc_fdrs" />
        </qube>
      </from>
    </query>
    <query name="45862_nastr_by_ym" class="1" timestamp="11.09.2019 12:22:26" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="ym" type="number">
          <const>2018.07</const>
        </param>
      </params>
      <select>
        <column table="a" column="kod_kol_gr_fdr" />
        <column table="a" column="pwrc_fdrid" />
        <column table="kod_kol_gr" column="kod_kol_gr" />
        <column table="kod_kol_gr" column="name" exclude="1" />
        <call as="name" function="||">
          <column table="kod_kol_gr" column="name" />
          <call function="if">
            <call function="is not null">
              <column table="kod_kol_gr" column="kol_gr_comment" />
            </call>
            <call function="||">
              <const>' ['</const>
              <column table="kod_kol_gr" column="kol_gr_comment" />
              <const>']'</const>
            </call>
          </call>
        </call>
        <column table="kod_kol_gr_nastr" column="is_auto_kg_real" />
        <call function="over" as="fdr_in_auto_kg">
          <call function="max">
            <column table="this" column="is_auto_kg_real" />
          </call>
          <call function="partition by">
            <column table="a" column="pwrc_fdrid" />
          </call>
        </call>
      </select>
      <from>
        <query name="vb_kol_gr_fdr" as="a">
          <link name="kod_kol_gr_pwrc">
            <link name="kod_kol_gr_nastr">
              <link name="kod_kol_gr" />
              <link name="ym" />
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="ym" column="ym" />
            <useparam name="ym" />
          </call>
        </call>
      </where>
    </query>
    <query name="d45862_fdr_kg" class="1" timestamp="14.01.2020 18:37:36" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="a" column="id" />
        <column table="a" column="k_gr_f_tp" />
        <column table="a" column="k_f_tp" />
        <column table="a" column="k_kg_name" exclude="1" />
        <column table="a" column="k_kg_name" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="a" column="pwrc_id" is-fact="1" agg="max" fact="f45862_fdr_kg_pwrc_id" />
        <column table="a" column="kg_name" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" exclude="1" />
        <column table="a" column="kg_name" />
        <column table="a" column="kod_kol_gr" />
        <column table="a" column="pwrc_fdrid" />
        <column table="a" column="real_fdr" />
        <column table="a" column="isprm_fdr" />
        <column table="a" column="pwrc_fdr_explname" />
        <column table="a" column="src_id" />
        <column table="a" column="srcname" />
        <column table="a" column="srcbalname" />
        <column table="a" column="ym" />
        <column table="a" column="exclude_auto_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <call function="nvl0" as="per_kg_s" exclude="1">
          <column table="kod_kol_gr" column="s" as="per_kg_s" />
        </call>
      </select>
      <from>
        <query name="sqlb_d45862_fdr_kg_tbl" as="a" />
        <query name="vb_kol_gr_nastr" join="left outer" as="kod_kol_gr" exclude="1">
          <call function="=">
            <column table="a" column="kod_kol_gr" />
            <column table="kod_kol_gr" column="kod_kol_gr" />
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="k_gr_f_tp" />
              <column table="k_pwrc_fdr" column="k_gr_f_tp" />
            </call>
            <call function="=">
              <column table="a" column="ym" />
              <column table="k_pwrc_fdr" column="ym" />
              <call function="replace" exclude="1">
                <column table="k_pwrc_fdr" column="ym" />
                <const>9999.99</const>
                <column table="this" column="ym" />
              </call>
            </call>
          </call>
        </query>
        <query name="hv_eopwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="this" column="m2m_pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query as="pwrc_id" join="left outer" name="hv_eopwrc_g" exclude="1">
          <call function="=">
            <column column="pwrc_id" table="this" />
            <column column="pwrc_id" table="pwrc_id" />
          </call>
        </query>
      </from>
      <links>
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="45862-yms" timestamp="27.12.2018 18:32:19" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="a" column="ym" type="number" key="1" />
        <column table="a" column="name" type="string" />
      </select>
      <from>
        <table name="45862-yms" as="a" view="1" />
      </from>
    </query>
    <query name="45862_kg_name_default_test2" class="1" timestamp="11.09.2019 16:48:15" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="kod_fl" type="array">
          <const>1105</const>
        </param>
        <param name="pwrc_id" type="array">
          <const>8871</const>
        </param>
      </params>
      <select>
        <call function="||" as="k_kg_name" group="1">
          <call function="nvl">
            <column column="kod_kol_gr" table="kod_kol_gr" />
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <const>'-'</const>
        </call>
        <call title="дисп.номер" as="kg_name" function="nvl" group="1">
          <column table="kod_kol_gr" column="name" />
          <column table="a" column="pwrc_fdrname" />
        </call>
      </select>
      <from>
        <query as="a" name="hv_eopwrc_fdrs" />
        <query name="45862_nastr_by_ym_test2" join="left outer" as="kod_kol_gr">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer">
          <link name="kod_fl" />
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="def_fdr" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="and" optional="1">
            <call function="in">
              <column table="kod_fl" column="kod_fl" />
              <useparam name="kod_fl" />
            </call>
            <call function="in">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
            <call function="is not null">
              <column table="def_fdr" column="kod_id" />
            </call>
            <call function="not">
              <call function="and">
                <call function="=">
                  <call function="nvl">
                    <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                    <const>-1</const>
                  </call>
                  <const>1</const>
                </call>
                <call function="=">
                  <call function="nvl">
                    <column table="kod_kol_gr" column="is_auto_kg_real" />
                    <const>-1</const>
                  </call>
                  <const>0</const>
                </call>
              </call>
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862_nastr_by_ym_test2" class="1" timestamp="04.10.2022 14:39:04" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="a" column="kod_kol_gr_fdr" />
        <column table="a" column="pwrc_fdrid" />
        <column table="kod_kol_gr" column="kod_kol_gr" />
        <column table="kod_kol_gr" column="name" exclude="1" />
        <call as="name" function="||">
          <column table="kod_kol_gr" column="name" />
          <call function="if">
            <call function="is not null">
              <column table="kod_kol_gr" column="kol_gr_comment" />
            </call>
            <call function="||">
              <const>' ['</const>
              <column table="kod_kol_gr" column="kol_gr_comment" />
              <const>']'</const>
            </call>
          </call>
        </call>
        <column table="kod_kol_gr_nastr" column="is_auto_kg_real" />
        <call function="over" as="fdr_in_auto_kg" exclude="1">
          <call function="max">
            <column table="this" column="is_auto_kg_real" />
          </call>
          <call function="partition by">
            <column table="a" column="pwrc_fdrid" />
          </call>
        </call>
        <call function="()" as="fdr_in_auto_kg" type="number">
          <query>
            <select>
              <call function="max">
                <column table="sq_nastr" column="is_auto_kg_real" />
              </call>
            </select>
            <from>
              <query name="vb_kol_gr_fdr" as="sq_fdr">
                <link name="kod_kol_gr_nastr" as="sq_nastr" />
              </query>
            </from>
            <where>
              <call function="and">
                <call function="le">
                  <call function="nvl">
                    <column table="sq_nastr" column="s" />
                    <const type="number">0001.01</const>
                  </call>
                  <call function="nvl">
                    <column table="kod_kol_gr_nastr" column="po" />
                    <const type="number">9999.12</const>
                  </call>
                </call>
                <call function="ge">
                  <call function="nvl">
                    <column table="sq_nastr" column="po" />
                    <const type="number">9999.12</const>
                  </call>
                  <call function="nvl">
                    <column table="kod_kol_gr_nastr" column="s" />
                    <const type="number">0001.01</const>
                  </call>
                </call>
                <call function="=">
                  <column table="sq_fdr" column="pwrc_fdrid" />
                  <column table="a" column="pwrc_fdrid" />
                </call>
              </call>
            </where>
          </query>
        </call>
      </select>
      <from>
        <query name="vb_kol_gr_fdr" as="a">
          <link name="kod_kol_gr_pwrc">
            <link name="kod_kol_gr_nastr">
              <link name="kod_kol_gr" />
            </link>
            <link name="rb_pwrc">
              <link name="kod_fl_real" />
              <elink name="hv_eopwrc" exclude="1">
                <link name="kod_fl_real" />
              </elink>
            </link>
          </link>
        </query>
      </from>
      <where>
        <call function="between">
          <column table="kod_fl_real" column="ym" />
          <column table="kod_kol_gr_nastr" column="s" />
          <call function="nvl">
            <column table="kod_kol_gr_nastr" column="po" />
            <call function="date to ym">
              <call function="sysdate" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862_fdr_kg_list_test2" class="1" timestamp="01.04.2022 12:58:50" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array">
          <const>13831</const>
        </param>
      </params>
      <select>
        <call function="||-" key="1" as="pk">
          <column table="kod_kol_gr" column="kod_kol_gr" />
          <column table="a" column="pwrc_fdrid" />
        </call>
        <call function="||" as="k_kg_name">
          <call function="nvl">
            <call function="to_char">
              <column column="kod_kol_gr" table="kod_kol_gr" />
            </call>
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <const>'-'</const>
        </call>
        <call as="pwrc_fdrname" function="nvl" title="дисп.номер">
          <column table="kod_kol_gr" column="name" />
          <column table="a" column="pwrc_fdrname" />
        </call>
        <column table="a" column="pwrc_fdr_balname" type="string" title="Бал.принадл" />
        <column table="a" column="pwrc_fdr_bal_id" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="Наименование ПС" />
        <column table="a" column="pr_cycle" type="number" />
        <call function="case" as="pr_cycle_name" title="пр. Закольцован" type="string">
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>1</const>
            </call>
            <const>'Да'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>0</const>
            </call>
            <const>'Нет'</const>
          </call>
        </call>
        <column table="kod_kol_gr" column="kod_kol_gr" />
        <column table="a" column="pwrc_fdrname" as="pwrc_fdrname_def" />
        <column table="kod_kol_gr" column="fdr_in_auto_kg" />
        <column table="kod_kol_gr" column="is_auto_kg_real" />
        <call as="cnt_fdr_in_kg" function="over">
          <call function="count">
            <call function="if">
              <call function="in">
                <column table="a" column="pwrc_id" />
                <useparam name="pwrc_id" />
              </call>
              <column table="a" column="pwrc_fdrid" />
            </call>
          </call>
          <call function="partition by">
            <column table="kod_kol_gr" column="kod_kol_gr" />
          </call>
        </call>
      </select>
      <from>
        <query name="vr_rb_fider" as="a" />
        <query name="45862_nastr_by_ym_test2" join="left outer" as="kod_kol_gr">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kod_kol_gr" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="45862_gr_by_pwrc_list" as="b" join="left outer">
          <withparams>
            <useparam name="pwrc_id" />
          </withparams>
          <call function="=">
            <column table="this" column="kod_kol_gr" />
            <column table="b" column="kod_kol_gr" />
          </call>
        </query>
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer">
          <link name="kod_fl" />
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="def_fdr" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="false" />
            <call function="in" optional="1">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
            <call function="is not null">
              <column table="b" column="kod_kol_gr" />
            </call>
          </call>
          <call function="not">
            <call function="and">
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="fdr_in_auto_kg" />
                  <const>-1</const>
                </call>
                <const>1</const>
              </call>
              <call function="=">
                <call function="nvl">
                  <column table="kod_kol_gr" column="is_auto_kg_real" />
                  <const>-1</const>
                </call>
                <const>0</const>
              </call>
            </call>
          </call>
          <call function="is not null">
            <column table="def_fdr" column="kod_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_kg_name_list_test2" class="1" timestamp="11.09.2019 16:47:31" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array">
          <const>8871</const>
        </param>
      </params>
      <select>
        <column table="a" column="k_kg_name" key="1" group="1" />
        <column table="a" column="pwrc_fdrname" group="stragg_dist" />
        <column table="a" column="pwrc_fdr_balname" type="string" title="Бал.принадл" group="stragg_dist" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" group="stragg_dist" />
        <column table="pwrc_dub" column="pwrcname" type="string" title="Наименование ПС" group="stragg_dist" />
        <column table="a" column="pr_cycle_name" type="string" group="stragg_dist" />
      </select>
      <from>
        <query name="45862_fdr_kg_list_test2" as="a">
          <withparams>
            <useparam name="pwrc_id" />
          </withparams>
        </query>
        <query name="45862_fdr_kg_list_test2" as="pwrc_dub" join="left outer">
          <withparams>
            <useparam name="pwrc_id" />
          </withparams>
          <call function="=" as="" type="">
            <column table="a" column="k_kg_name" />
            <column table="pwrc_dub" column="k_kg_name" />
          </call>
        </query>
      </from>
      <where>
        <call function="!=0">
          <column table="a" column="cnt_fdr_in_kg" />
        </call>
      </where>
    </query>
    <query name="45862_fdr_by_kn_name_list_test2" class="1" timestamp="28.04.2022 17:23:18" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_fdrid" group="1" key="1" />
        <column table="a" column="pwrc_fdrname_def" as="pwrc_fdrname" group="1" title="дисп.номер" />
        <column table="a" column="pwrc_fdr_balname" group="1" intern="1" />
        <column table="a" column="pwrc_fdr_explname" group="1" intern="1" />
        <column table="a" column="pwrcname" group="1" intern="1" />
        <column table="a" column="pr_cycle_name" group="1" intern="1" />
      </select>
      <from>
        <query name="45862_fdr_kg_list_test2" as="a">
          <withparams>
            <useparam name="pwrc_id" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="in" optional="1">
            <column table="a" column="k_kg_name" />
            <useparam name="k_kg_name" />
          </call>
        </call>
      </where>
    </query>
    <query name="d45862_kg_name" class="1" timestamp="14.01.2020 18:40:53" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="a" column="k_kg_name" group="1" />
        <column table="a" column="kg_name" group="1" />
        <column table="a" column="kg_name_w_real_fdr" group="1" exclude="1" />
        <call function="||" as="kg_name_w_real_fdr" group="1">
          <column table="a" column="kg_name_w_real_fdr" />
          <call function="if">
            <call function="!=">
              <call function="substr">
                <column table="a" column="k_kg_name" />
                <const>1</const>
                <const>1</const>
              </call>
              <const>'-'</const>
            </call>
            <const>' КГ'</const>
          </call>
        </call>
        <call function="nvl0" as="per_kg_s" group="max">
          <column table="kod_kol_gr" column="s" as="per_kg_s" />
        </call>
      </select>
      <from>
        <query name="sqlb_d45862_fdr_kg_tbl" as="a" />
        <query name="vb_kol_gr_nastr" join="left outer" as="kod_kol_gr">
          <call function="=">
            <column table="a" column="kod_kol_gr" />
            <column table="kod_kol_gr" column="kod_kol_gr" />
          </call>
        </query>
      </from>
    </query>
    <query name="45862_tp_list_v2" class="1" timestamp="09.10.2019 13:59:00" title="ТП, РП, КК" order="pwrcname, pwrc_fdrname, srcname" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="k_kg_name" type="array" />
        <param name="pwrc_fdrid" type="array" />
      </params>
      <select>
        <column table="a" column="src_id" column-mandatory="1" title="" group="1" />
        <column table="a" column="srcname" group="max" />
        <column table="a" column="src_balnamex" group="max" />
        <call as="fdrname" title="Фидер" type="string" function="||" group="max">
          <column table="a" column="pwrc_fdrname" />
          <const>', '</const>
          <column table="a" column="pwrcname" />
        </call>
        <column table="a" column="pwrc_fdrname" type="string" group="max" />
        <column table="a" column="pwrcname" type="string" group="max" />
      </select>
      <from>
        <query name="hv_eopwrc_grid_dtl_src_fdr_list" as="a">
          <withparams>
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
        <query name="vb_kol_gr_tp" join="left outer">
          <call function="=">
            <column table="a" column="src_id" />
            <column table="vb_kol_gr_tp" column="src_id" />
          </call>
          <link name="kod_kol_gr_fdr">
            <link name="kod_kol_gr_pwrc">
              <link name="kod_kol_gr_nastr" />
            </link>
          </link>
        </query>
        <query name="45862_kol_gr_feaders_all_tp" join="left outer" as="kol_gr_feaders_all_tp">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="kol_gr_feaders_all_tp" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="in">
            <call function="||">
              <const>'-'</const>
              <column table="a" column="pwrc_fdrid" />
              <const>'-'</const>
            </call>
            <useparam name="k_kg_name" />
          </call>
          <call function="in">
            <call function="||">
              <column table="kod_kol_gr_nastr" column="kod_kol_gr" />
              <const>'-'</const>
            </call>
            <useparam name="k_kg_name" />
          </call>
          <call function="in">
            <call function="||">
              <column table="kol_gr_feaders_all_tp" column="kod_kol_gr" />
              <const>'-'</const>
            </call>
            <useparam name="k_kg_name" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_kol_gr_feaders_all_tp" class="1" timestamp="09.10.2019 14:17:42" title="Фидеры в кольцевых группах, в которых считаются все ТП" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="vb_kol_gr_fdr" column="kod_kol_gr_fdr" />
        <column table="kod_kol_gr_pwrc" column="kod_kol_gr_pwrc" />
        <column table="kod_kol_gr_nastr" column="kod_kol_gr_nastr" />
        <column table="kod_kol_gr_nastr" column="kod_kol_gr" />
        <column table="vb_kol_gr_fdr" column="pwrc_fdrid" />
      </select>
      <from>
        <query name="vb_kol_gr_fdr">
          <link name="kod_kol_gr_pwrc">
            <link name="kod_kol_gr_nastr" />
          </link>
          <elink name="vb_kol_gr_tp" />
        </query>
      </from>
      <where>
        <call function="is null">
          <column table="vb_kol_gr_tp" column="kod_kol_gr_tp" />
        </call>
      </where>
    </query>
    <query name="45862_kol_gr_src_pwrc" class="1" timestamp="10.10.2019 15:33:06" title="Подстанции для ТП в рамках кольцевой группы (временные подстанции)" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="vb_kol_gr_nastr" column="kod_kol_gr" group="1" />
        <column table="root_pwrc" column="pwrc_id" group="1" />
        <column table="child_pwrc_fdr_tp" column="src_id" group="1" />
      </select>
      <from>
        <query name="vb_kol_gr_nastr">
          <elink name="vb_kol_gr_pwrc" as="root_pwrc">
            <elink name="vb_kol_gr_fdr" as="root_pwrc_fdr">
              <elink name="vb_kol_gr_tp" as="root_pwrc_fdr_tp" />
            </elink>
          </elink>
          <elink name="vb_kol_gr_pwrc" as="child_pwrc">
            <elink name="vb_kol_gr_fdr" as="child_pwrc_fdr">
              <elink name="vb_kol_gr_tp" as="child_pwrc_fdr_tp" />
            </elink>
          </elink>
        </query>
        <query join="left outer" name="45862_kol_gr_type" as="kol_gr_type">
          <call function="=">
            <column table="vb_kol_gr_nastr" column="kod_kol_gr" />
            <column table="kol_gr_type" column="kod_kol_gr" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="or">
            <call function="=1">
              <call function="nvl0">
                <column table="vb_kol_gr_nastr" column="is_auto_kg" />
              </call>
            </call>
            <call function="and">
              <call function="is not null">
                <column table="root_pwrc_fdr" column="kod_kol_gr_fdr" />
              </call>
              <call function="is null">
                <column table="root_pwrc_fdr_tp" column="kod_kol_gr_tp" />
              </call>
            </call>
            <call function="=1">
              <column table="kol_gr_type" column="all_fdr_have_tp" />
            </call>
          </call>
          <call function="is not null">
            <column table="child_pwrc_fdr_tp" column="src_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="45862_kol_gr_type" class="1" timestamp="10.10.2019 15:29:53" title="Тип кольцевой группы " file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <select>
        <column table="vb_kol_gr_nastr" column="kod_kol_gr" group="1" />
        <call function="if" as="all_fdr_have_tp" title="Во всех фидерах добавлены ТП">
          <call function="lt">
            <call function="min">
              <call function="nvl">
                <column table="root_pwrc_fdr_tp" column="kod_kol_gr_tp" />
                <const>-1</const>
              </call>
            </call>
            <const>0</const>
          </call>
          <const>0</const>
          <const>1</const>
        </call>
        <call function="if" as="single_pwrc" title="Все в рамках одной подстанции">
          <call function="=1">
            <call function="count-distinct">
              <column table="root_pwrc" column="kod_kol_gr_pwrc" />
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="if" as="single_fdr_no_tp" title="1 фидер без ТП">
          <call function="=1">
            <call function="-">
              <call function="count">
                <column table="root_pwrc_fdr" column="kod_kol_gr_fdr" />
              </call>
              <call function="count">
                <column table="root_pwrc_fdr_tp" column="kod_kol_gr_tp" />
              </call>
            </call>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
        <call function="if" as="multiple_fdr_no_tp" title="Много фидеров без ТП">
          <call function="gt">
            <call function="-">
              <call function="count">
                <column table="root_pwrc_fdr" column="kod_kol_gr_fdr" />
              </call>
              <call function="count">
                <column table="root_pwrc_fdr_tp" column="kod_kol_gr_tp" />
              </call>
            </call>
            <const>1</const>
          </call>
          <const>1</const>
          <const>0</const>
        </call>
      </select>
      <from>
        <query name="vb_kol_gr_nastr">
          <elink name="vb_kol_gr_pwrc" as="root_pwrc">
            <elink name="vb_kol_gr_fdr" as="root_pwrc_fdr">
              <elink name="vb_kol_gr_tp" as="root_pwrc_fdr_tp" />
            </elink>
          </elink>
        </query>
      </from>
    </query>
    <query name="45862_fdr_kg_missing_tp_single_ym_text" class="1" timestamp="22.11.2019 22:26:22" order="name, pwrcname, pwrc_fdrname, srcname" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
        <param name="ym" type="number" />
      </params>
      <select>
        <call function="||" group="stragg" as="desc_text">
          <column table="a" column="name" />
          <const>' / '</const>
          <column table="a" column="pwrcname" />
          <const>' / '</const>
          <column table="a" column="pwrc_fdrname" />
          <const>' / '</const>
          <column table="a" column="srcname" />
          <call function="chr">
            <const>13</const>
          </call>
          <call function="chr">
            <const>10</const>
          </call>
        </call>
      </select>
      <from>
        <query name="45862_fdr_kg_missing_tp_single_ym_text_pre" as="a">
          <withparams>
            <useparam name="pwrc_id" />
            <useparam name="k_kg_name" />
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="45862_fdr_kg_missing_tp_single_ym_text_pre" class="1" timestamp="21.11.2019 21:22:59" order="name, pwrcname, pwrc_fdrname, srcname" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
        <param name="ym" type="number" />
      </params>
      <select>
        <column table="kod_fl" column="name" group="1" />
        <column table="tp" column="pwrcname" group="1" />
        <column table="tp" column="pwrc_fdrname" group="1" />
        <column table="tp" column="srcname" group="1" />
      </select>
      <from>
        <query name="kg_fdr_missing_tp" as="a" />
        <query name="vb_kol_gr_nastr" as="nastr" join="left outer">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_kol_gr" />
              <column table="nastr" column="kod_kol_gr" />
            </call>
          </call>
          <link name="kod_fl" />
        </query>
        <query name="hv_eopwrc_grid_dtl" as="tp" join="left outer">
          <call function="=">
            <column table="a" column="src_id" />
            <column table="tp" column="src_id" />
          </call>
        </query>
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="ym" />
            <useparam name="ym" />
          </call>
          <call function="or">
            <call function="in">
              <call function="||">
                <column table="a" column="kod_kol_gr" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
            <call function="in">
              <call function="||">
                <const>'-'</const>
                <column table="a" column="pwrc_fdrid" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="45862_fdr_kg_missing_tp_single_ym_flag" class="1" timestamp="22.11.2019 22:28:19" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <params>
        <param name="pwrc_id" type="array" />
        <param name="k_kg_name" type="array" />
        <param name="ym" type="number" />
      </params>
      <select>
        <column table="a" column="src_id" group="count" />
      </select>
      <from>
        <query name="kg_fdr_missing_tp" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <useparam name="ym" />
            <column table="a" column="ym" />
          </call>
          <call function="or">
            <call function="in">
              <call function="||">
                <column table="a" column="kod_kol_gr" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
            <call function="in">
              <call function="||">
                <const>'-'</const>
                <column table="a" column="pwrc_fdrid" />
                <const>'-'</const>
              </call>
              <useparam name="k_kg_name" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="46990" timestamp="22.05.2019 13:23:02" is-report="1" title="Ведомость присоединений потребителей услуг сетевой организации" mode="default" can-use-simple-params="1" nogrid="1" order="1,2,3" file="sql.builder.templates\sql.builder\projects\45862\reports\46990-rep.xml">
      <procedure>
        <text>
        BEGIN
            DELETE vr_number_array WHERE array_id = 'dep';
            
            INSERT INTO vr_number_array (array_id, val)
            select 'dep',KOD_FL from jv_rep_cons_d_fl where KOD_FL in :kod_fl;
            
            jg_reports_ise.JR_REP_SLPNT811_DTL_load (ym_         =&gt; :ym,
                                             array_id_   =&gt; 'dep');
        END; 
    </text>
      </procedure>
      <print-templates>
        <excel>
          <template name="46990.xlsx" title="Ведомость присоединений потребителей услуг сетевой организации" print-proc="2" print-xlsx="1" post-process="0" />
        </excel>
      </print-templates>
      <content>
        <usefield field="cmn_combo_num" title="Отчетный период" name="ym" column-mandatory="1">
          <listquery>
            <query name="45862-yms" />
          </listquery>
          <defaultquery>
            <query name="45862-ym-def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" title="Филиал" name="kod_fl" column-mandatory="1" type="number">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
        </usefield>
      </content>
      <select>
        <column table="a" column="flname" />
        <column table="a" column="src_dnum" />
        <column table="a" column="fdrsrc_dnum" />
        <column table="a" column="tp_dnum" />
        <call function="||" as="tp_nv" exclude="1">
          <const>' '</const>
          <column table="a" column="tp_nv" />
        </call>
        <column table="a" column="fdrtp_dnum" />
        <call function="||" as="fdrtp_nv" exclude="1">
          <const>' '</const>
          <column table="a" column="fdrtp_nv" />
        </call>
        <column table="a" column="tp_nv" />
        <column table="a" column="fdrtp_nv" />
        <column table="a" column="total_cnt" />
        <column table="a" column="i_cnt" />
        <column table="a" column="ii_cnt" />
        <column table="a" column="iii_cnt" />
        <column table="a" column="bh_cnt" />
        <column table="a" column="ch1_cnt" />
        <column table="a" column="ch2_cnt" />
        <column table="a" column="hh_cnt" />
        <column table="a" column="tco_cnt" />
        <call function="rownum" as="id" key="1" />
      </select>
      <from>
        <query name="pl_getslpnt811" as="a">
          <withparams>
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="hv_eopwrc" class="1" timestamp="16.09.2020 18:42:36" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <call function="||-" as="hv_eopwrc_id" key="1">
          <column table="this" column="pwrc_id" />
          <column table="this" column="bal_id" />
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="YM_START_ANALYZ" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_istest_0" as="a" />
        <query name="jv_rep_cons_d_fl" as="kod_fl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl" column="kod_fl" />
          </call>
        </query>
        <query name="hv_eopwrc_g" as="hv_eopwrc_g" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="hv_eopwrc_g" column="pwrc_id" />
          </call>
        </query>
        <query name="sqlb_d45862_fl_ym_tbl" as="kod_fl_real" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="bal_id" />
            <column table="kod_fl_real" column="kod_fl" />
          </call>
        </query>
      </from>
      <links>
        <dlink name="jr_rep_blns_pwrc_fdrs" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        <dlink name="hv_eopwrc_fdrs" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="pwrc_grid" is-private-dimension="1" is-final-dimension="1" dimension="1">
            <dimlink name="pwrc_grid_dtl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          </dimlink>
        </dlink>
      </links>
    </query>
    <query name="hv_eopwrc_list" class="1" timestamp="07.12.2018 14:49:31" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <procedure>
        <text>
          BEGIN
       jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl);
	END;
        </text>
      </procedure>
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def" as="a">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="hv_eopwrc_g" class="1" timestamp="14.01.2020 14:22:02" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" group="1" key="1" />
        <column table="a" column="pwrcname" type="string" group="max" />
        <column table="a" column="YM_START_ANALYZ" type="string" group="max" />
        <call function="()" type="number" as="cnt" is-fact="1" agg="sum">
          <const>1</const>
        </call>
      </select>
      <from>
        <query name="hv_eopwrc" as="a" />
      </from>
      <links>
        <dlink name="hv_eopwrc" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
        <dlink name="hv_eopwrc_fdrs" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="pwrc_grid" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="pwrc_grid_dtl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="hv_eopwrc_fdrs_default" class="1" timestamp="10.08.2018 18:07:15" title="Фидеры" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="pwrc_id" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" title="дисп.номер" />
      </select>
      <from>
        <table as="a" name="hv_eopwrc_fdrs" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="and" optional="1">
            <call function="=">
              <column table="a" column="pwrc_fdr_bal_id" />
              <useparam name="kod_fl" />
            </call>
            <call function="in">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_list_def" class="1" timestamp="16.09.2020 18:40:59" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <query as="a" name="hv_eopwrc" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="bal_id" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_list_test" class="1" timestamp="16.09.2020 19:27:25" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <procedure>
        <text>
    BEGIN
        jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl, 1);
    END;
</text>
      </procedure>
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def" as="a">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="!=">
          <column table="a" column="is_test" />
          <const type="number">3</const>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_test_det_mat" class="1" timestamp="23.12.2018 19:45:37" materialize="1" is-private-dimension="1" is-final-dimension="1" dimension="1" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <column table="a" column="hv_eopwrc_id" key="1" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc" as="a" />
      </from>
    </query>
    <query name="hv_eopwrc_list_test2" class="1" order="kod_fl.name, a.pwrcname" timestamp="25.01.2023 12:38:59" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="kod_fl" type="array" />
      </params>
      <select>
        <column table="a" column="hv_eopwrc_id" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="Подстанция" />
        <column table="kod_fl" column="name" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc" as="a">
          <link name="kod_fl" />
        </query>
      </from>
      <where>
        <call function="in" exclude="1">
          <column table="a" column="bal_id" />
          <useparam name="kod_fl" />
        </call>
        <call function="and">
          <call function="=" exclude="1">
            <column table="a" column="pwrc_id" />
            <const>13866</const>
          </call>
          <call function="in">
            <column table="a" column="bal_id" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="vr_rb_pwrc_list_by_hv_eopwrc_id" class="1" timestamp="25.01.2023 12:40:04" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="hv_eopwrc_id" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" group="1" />
        <column table="a" column="pwrcname" type="string" title="Подстанция" group="1" />
        <column table="a" column="hv_eopwrc_id" group="max" />
      </select>
      <from>
        <query name="vr_rb_pwrc" as="a" />
      </from>
      <where>
        <call function="in" exclude="1">
          <column table="a" column="hv_eopwrc_id" />
          <useparam name="hv_eopwrc_id" />
        </call>
        <call function="and">
          <call function="=" exclude="1">
            <column table="a" column="pwrc_id" />
            <const>13866</const>
          </call>
          <call function="in">
            <column table="a" column="hv_eopwrc_id" />
            <useparam name="hv_eopwrc_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_fdrs_def_by_33" class="1" timestamp="21.02.2021 00:08:00" title="Фидеры" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="kod_fl" type="array" />
        <param name="pwrc_id" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" group="1" />
        <column table="a" column="pwrc_fdrname" type="string" title="дисп.номер" group="1" />
      </select>
      <from>
        <table as="a" name="hv_eopwrc_fdrs" />
        <query name="vb_rb_default_fdr" as="def_fdr" join="left outer">
          <link name="kod_fl" />
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="def_fdr" column="pwrc_fdrid" />
          </call>
        </query>
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="and" optional="1">
            <call function="in">
              <column table="kod_fl" column="kod_fl" />
              <useparam name="kod_fl" />
            </call>
            <call function="in">
              <column table="a" column="pwrc_id" />
              <useparam name="pwrc_id" />
            </call>
            <call function="is not null">
              <column table="def_fdr" column="kod_id" />
            </call>
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_list_for_q3" class="1" timestamp="31.08.2020 11:57:36" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <procedure>
        <text>
    BEGIN
        jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl, 3);
    END;
</text>
      </procedure>
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def" as="a">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="is_test" />
          <const type="number">3</const>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_list_test_for_Q3" class="1" timestamp="16.09.2020 18:55:50" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <procedure>
        <text>
    BEGIN
        jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl, 3);
    END;
</text>
      </procedure>
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_list_def_istest_3" as="a">
          <withparams>
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
      <where>
        <call function="=">
          <column table="a" column="is_test" />
          <const type="number">3</const>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_full" class="1" timestamp="16.09.2020 18:36:32" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <call function="||-" as="hv_eopwrc_id" key="1">
          <column table="this" column="pwrc_id" />
          <column table="this" column="bal_id" />
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="YM_START_ANALYZ" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <table name="hv_eopwrc" as="a" />
      </from>
    </query>
    <query name="hv_eopwrc_istest_0" class="1" timestamp="16.09.2020 18:42:25" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <column table="a" column="hv_eopwrc_id" type="number" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="YM_START_ANALYZ" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_full" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="is_test" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_istest_3" class="1" timestamp="16.09.2020 18:42:25" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <select>
        <column table="a" column="hv_eopwrc_id" type="number" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="YM_START_ANALYZ" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <query name="hv_eopwrc_full" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="is_test" />
          <const>3</const>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_list_def_istest_3" class="1" timestamp="16.09.2020 18:55:20" order="pwrcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc.xml">
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <select>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="is_test" type="number" title="" />
      </select>
      <from>
        <query as="a" name="hv_eopwrc_istest_3" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="=" optional="1">
            <column table="a" column="bal_id" />
            <useparam name="kod_fl" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_fdrs" class="1" timestamp="26.12.2018 11:45:48" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_fdrs.xml">
      <select>
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" key="1" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="Фидер" vid="1" is-name="1" />
        <column table="a" column="isprm_fdr" type="string" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="ПС" vid="1" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" vid="1" />
        <column table="a" column="pwrc_fdr_balname" type="string" />
        <column table="a" column="pwrc_fdr_bal_id" type="number" />
        <column table="a" column="pr_cycle" type="number" />
      </select>
      <from>
        <table name="hv_eopwrc_fdrs" as="a" />
        <query name="hv_eopwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
      </from>
      <links>
        <link name="pwrc_id" as="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
        <dlink name="hv_eopwrc_grid" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="pwrc_grid_dtl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </dlink>
      </links>
    </query>
    <query name="hv_eopwrc_fdrs_list" class="1" timestamp="05.12.2018 22:32:14" title="Фидеры" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_fdrs.xml">
      <params>
        <param name="pwrc_id" type="array" />
      </params>
      <select>
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" title="дисп.номер" />
        <column table="a" column="pwrc_fdr_balname" type="string" title="Бал.принадл" />
        <column table="a" column="pwrc_fdr_explname" type="string" title="Экспл.отв" />
        <column table="a" column="pwrcname" type="string" title="Наименование ПС" />
        <column table="a" column="pr_cycle" type="number" />
        <call function="case" as="pr_cycle_name" title="пр. Закольцован">
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>1</const>
            </call>
            <const>'Да'</const>
          </call>
          <call function="when">
            <call function="=">
              <column table="a" column="pr_cycle" />
              <const>0</const>
            </call>
            <const>'Нет'</const>
          </call>
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" />
        <column table="a" column="pwrc_fdr_bal_id" type="number" />
      </select>
      <from>
        <table as="a" name="hv_eopwrc_fdrs" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="in" optional="1">
            <column table="a" column="pwrc_id" />
            <useparam name="pwrc_id" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_grid" class="1" timestamp="26.12.2018 12:06:21" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid.xml">
      <select>
        <call function="||-" as="hv_eopwrc_grid_id" key="1">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="ПС" vid="1" is-name="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="Фидер" vid="1" is-name="1" />
        <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="srcname" type="string" title="ТП" vid="1" is-name="1" />
        <column table="a" column="srcbalname" type="string" />
        <const as="ym" exclude="1">2018.07</const>
      </select>
      <from>
        <table name="hv_eopwrc_grid" as="a" />
        <query name="hv_eopwrc_fdrs" as="pwrc_fdrid" join="left outer" dname="hv_eopwrc_grid">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="hv_eopwrc_fdrs" as="pwrc_fdrid_tp_null" join="left outer" dname="hv_eopwrc_grid_tp_null" exclude="1">
          <call function="or">
            <call function="=">
              <call function="nvl" exclude="1">
                <column table="a" column="pwrc_fdrid" />
                <column table="pwrc_fdrid_tp_null" column="pwrc_fdrid" />
              </call>
              <column table="a" column="pwrc_fdrid" />
              <column table="pwrc_fdrid_tp_null" column="pwrc_fdrid" />
            </call>
            <call function="is null" exclude="1">
              <column table="a" column="src_id" />
            </call>
          </call>
        </query>
      </from>
      <links>
        <link name="pwrc_fdrid" is-private-dimension="1" is-final-dimension="1" dimension="1" as="pwrc_fdrid1">
          <dimlink name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
        <dlink name="hv_eopwrc_grid_dtl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
      </links>
    </query>
    <query name="hv_eopwrc_grid_dtl" class="1" timestamp="06.12.2018 16:08:41" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
      <select>
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" key="1" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="srcname" type="string" title="" />
        <column table="a" column="src_fdrname" type="string" column-mandatory="1" title="" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
        <column table="a" column="srckodp_fsk" type="number" column-mandatory="1" title="" />
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="a" column="src_fdrord" type="number" />
      </select>
      <from>
        <table name="hv_eopwrc_grid_dtl" as="a" />
        <query name="hv_eopwrc_grid" as="hv_eopwrc_grid" join="left outer">
          <call function="=">
            <column table="this" column="hv_eopwrc_grid_id" />
            <column table="hv_eopwrc_grid" column="hv_eopwrc_grid_id" />
          </call>
        </query>
      </from>
      <links>
        <link name="hv_eopwrc_grid" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <dimlink name="pwrc_fdrid" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" />
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="hv_eopwrc_grid_dtl_src_fdr_list" class="1" timestamp="21.08.2018 13:06:40" title="ТП, РП, КК" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
      <params>
        <param name="pwrc_fdrid" type="array" />
      </params>
      <select>
        <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
        <column table="a" column="srcname" type="string" title="Наименование" />
        <column table="a" column="src_balnamex" type="string" title="Бал.принадл" />
        <column table="a" column="pwrc_fdrname" type="string" />
        <column table="a" column="pwrcname" type="string" />
      </select>
      <from>
        <table as="a" name="hv_eopwrc_grid_dtl_src_fdr_list" view="1" />
      </from>
      <where>
        <call function="or">
          <call function="false" />
          <call function="in" optional="1">
            <column table="a" column="pwrc_fdrid" />
            <useparam name="pwrc_fdrid" />
          </call>
        </call>
      </where>
    </query>
    <query name="hv_eopwrc_grid_dtl_src_list" class="1" timestamp="21.08.2018 13:06:40" title="ТП, РП, КК" order="pwrcname, pwrc_fdrname, srcname" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
      <params>
        <param name="pwrc_fdrid" type="array" />
      </params>
      <select>
        <column table="a" column="src_id" column-mandatory="1" title="" group="1" />
        <column table="a" column="srcname" group="max" />
        <column table="a" column="src_balnamex" group="max" />
        <call as="fdrname" title="Фидер" type="string" function="||" group="max">
          <column table="a" column="pwrc_fdrname" />
          <const>', '</const>
          <column table="a" column="pwrcname" />
        </call>
        <column table="a" column="pwrc_fdrname" type="string" group="max" />
        <column table="a" column="pwrcname" type="string" group="max" />
      </select>
      <from>
        <query name="hv_eopwrc_grid_dtl_src_fdr_list" as="a">
          <withparams>
            <useparam name="pwrc_fdrid" />
          </withparams>
        </query>
      </from>
    </query>
    <query name="kg_fdr_missing_tp" class="1" timestamp="20.11.2019 21:24:47" title="ТП вне КГ, но в фидерах в КГ" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
      <select>
        <column table="a" column="kod_kol_gr" type="number" column-mandatory="1" title="" />
        <column table="a" column="ym" type="number" column-mandatory="1" title="" />
        <column table="a" column="pwrc_fdrid" type="number" />
        <column table="a" column="src_id" type="number" />
      </select>
      <from>
        <table as="a" name="kg_fdr_missing_tp" view="1" />
      </from>
    </query>
    <query name="jr_rep_blns_pwrc_fdrs" class="1" timestamp="19.06.2019 10:27:26" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jr_rep_blns_pwrc_fdrs.xml">
      <select>
        <call function="rowid" as="jr_rep_blns_pwrc_fdrs_id" key="1" />
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="kod_outeris" type="number" column-mandatory="1" comment="ID МОДУЛЯ" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrcname" type="string" title="" comment="ДИСП №ПС" data-size="121" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" comment="ДИСП №ФИД" data-size="100" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="srcname" type="string" title="" comment="ДИСП №ТП,РП,КК" data-size="123" />
        <column table="a" column="tpoint" type="string" column-mandatory="1" title="" comment="ВИД ТУ" data-size="10" />
        <column table="a" column="pnum" type="number" column-mandatory="1" title="" comment="№ТУ" />
        <column table="a" column="pname" type="string" column-mandatory="1" title="" comment="НАИМЕН. ТУ" data-size="210" />
        <column table="a" column="place_namefider" type="string" title="" comment="ОБОРУД" data-size="100" />
        <column table="a" column="cnt_num" type="string" title="" comment="№ ПУ" data-size="20" />
        <column table="a" column="readvals" type="string" title="" comment="ПОКАЗАНИЯ" data-size="100" />
        <column table="a" column="cnt_rkoef" type="string" title="" comment="РАСЧ.КОЭФ" data-size="100" />
        <column table="a" column="out1" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А+)" />
        <column table="a" column="cust1" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А+)" />
        <column table="a" column="out2" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А-)" />
        <column table="a" column="cust2" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А-)" />
        <column table="a" column="wp_in" type="number" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" comment="ОТПУСК ПО ФИДЕРУ, кВт*ч" is-fact="1" agg="sum" />
        <column table="a" column="wp_out" type="number" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" comment="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" is-fact="1" agg="sum" />
        <column table="a" column="name_es" type="string" column-mandatory="1" title="" comment="ЭСК" data-size="150" />
        <column table="a" column="name_fsk" type="string" column-mandatory="1" title="" comment="ЗОНА ФИЛИАЛА ЛЭ" data-size="150" />
        <column table="a" column="name_rsk" type="string" column-mandatory="1" title="" comment="РЭС" data-size="150" />
        <column table="a" column="dog_num" type="string" title="" comment="№ ДОГОВОРА ЭНЕРГ" data-size="50" />
        <column table="a" column="user_name" type="string" column-mandatory="1" title="" comment="ПОТРЕБИТЕЛЬ" data-size="255" />
        <column table="a" column="eobj_num" type="string" title="" comment="№ ОБЪЕКТА" data-size="20" />
        <column table="a" column="eobj_name" type="string" title="" comment="НАИМЕН. ОБЪЕКТА" data-size="200" />
        <column table="a" column="r_pwrlev" type="string" title="" comment="УН" data-size="20" />
        <column table="a" column="pwr_lev" type="number" title="" comment="НАПРЯЖ, кВ" />
        <column table="a" column="eobj_adress" type="string" title="" comment="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" data-size="250" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="ym" type="number" column-mandatory="1" title="" comment="ОТЧ.ПЕРИОД" />
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" comment="ID ЛИНИИ ТП,РП,КК (ПРИСОЕДИНЕНИЯ)" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="ID ФИЛИАЛА, К КОТОРОМУ ОТНОСИТСЯ НАБОР ДАННЫХ" />
        <column table="a" column="constype" comment="ГРУППА ПОТРЕБИТЕЛЕЙ" type="string" data-size="20" column-mandatory="1" title="" />
        <column table="a" type="string" column="constypex" comment="ГРУППА ПОТРЕБИТЕЛЕЙ ДЕТАЛИЗ." data-size="20" column-mandatory="1" title="" />
        <column table="a" type="string" comment="СПОСОБ ЗАГРУЗКИ" column="engway" data-size="20" column-mandatory="1" title="" />
        <call function="if" as="pnt_fdr" type="number" title="ОТПУСК ПО ФИДЕРУ, ШТ. ТУ" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="a" column="cnt_checkdate" type="date" title="" comment="Дата проверки Счетчика" />
        <column table="a" column="cnt_type" type="string" data-size="100" title="" comment="Тип счетчика" />
      </select>
      <from>
        <table name="jr_rep_blns_pwrc_fdrs" as="a" />
        <query name="hv_eopwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="hv_eopwrc_fdrs" as="pwrc_fdrid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="pwrc_fdrid" />
            <column table="pwrc_fdrid" column="pwrc_fdrid" />
          </call>
        </query>
        <query name="hv_eopwrc_grid" as="pwrc_grid" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="hv_eopwrc_grid_id" />
            <column table="pwrc_grid" column="hv_eopwrc_grid_id" />
          </call>
        </query>
        <query name="hv_eopwrc_grid_dtl" as="pwrc_grid_dtl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=">
            <column table="a" column="src_fdrid" />
            <column table="pwrc_grid_dtl" column="src_fdrid" />
          </call>
        </query>
      </from>
      <links>
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" as="pwrc_id1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
      <where exclude="1">
        <call function="false" />
      </where>
    </query>
    <query name="jr_rep_blns_pwrc_fdrs_test" class="1" timestamp="05.07.2021 15:00:23" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jr_rep_blns_pwrc_fdrs.xml">
      <select>
        <call function="rowid" as="jr_rep_blns_pwrc_fdrs_id" key="1" exclude="1" />
        <const as="jr_rep_blns_pwrc_fdrs_id" key="1">a.rowid</const>
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="kod_outeris" type="number" column-mandatory="1" comment="ID МОДУЛЯ" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrcname" type="string" title="" comment="ДИСП №ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" comment="ДИСП №ФИД" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="srcname" type="string" title="" comment="ДИСП №ТП,РП,КК" />
        <column table="a" column="tpoint" type="string" column-mandatory="1" title="" comment="ВИД ТУ" />
        <column table="a" column="pnum" type="number" column-mandatory="1" title="" comment="№ТУ" />
        <column table="a" column="pname" type="string" column-mandatory="1" title="" comment="НАИМЕН. ТУ" />
        <column table="a" column="place_namefider" type="string" title="" comment="ОБОРУД" />
        <column table="a" column="cnt_num" type="string" title="" comment="№ ПУ" />
        <column table="a" column="readvals" type="string" title="" comment="ПОКАЗАНИЯ" />
        <column table="a" column="cnt_rkoef" type="string" title="" comment="РАСЧ.КОЭФ" />
        <column table="a" column="out1" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А+)" />
        <column table="a" column="cust1" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А+)" />
        <column table="a" column="out2" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А-)" />
        <column table="a" column="cust2" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А-)" />
        <column table="a" column="wp_in" type="number" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" comment="ОТПУСК ПО ФИДЕРУ, кВт*ч" is-fact="1" agg="sum" />
        <column table="a" column="wp_out" type="number" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" comment="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" is-fact="1" agg="sum" />
        <column table="a" column="name_es" type="string" column-mandatory="1" title="" comment="ЭСК" />
        <column table="a" column="name_fsk" type="string" column-mandatory="1" title="" comment="ЗОНА ФИЛИАЛА ЛЭ" />
        <column table="a" column="name_rsk" type="string" column-mandatory="1" title="" comment="РЭС" />
        <column table="a" column="dog_num" type="string" title="" comment="№ ДОГОВОРА ЭНЕРГ" />
        <column table="a" column="user_name" type="string" column-mandatory="1" title="" comment="ПОТРЕБИТЕЛЬ" />
        <column table="a" column="eobj_num" type="string" title="" comment="№ ОБЪЕКТА" />
        <column table="a" column="eobj_name" type="string" title="" comment="НАИМЕН. ОБЪЕКТА" />
        <column table="a" column="r_pwrlev" type="string" title="" comment="УН" />
        <column table="a" column="pwr_lev" type="number" title="" comment="НАПРЯЖ, кВ" />
        <column table="a" column="eobj_adress" type="string" title="" comment="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="ym" type="number" column-mandatory="1" title="" comment="ОТЧ.ПЕРИОД" is-private-dimension="d45862_ym" is-final-dimension="d45862_ym" dimension="d45862_ym" exclude="1" />
        <column table="a" column="ym" type="number" column-mandatory="1" title="" comment="ОТЧ.ПЕРИОД" />
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" comment="ID ЛИНИИ ТП,РП,КК (ПРИСОЕДИНЕНИЯ)" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="ID ФИЛИАЛА, К КОТОРОМУ ОТНОСИТСЯ НАБОР ДАННЫХ" />
        <call function="if" as="pnt_fdr" type="number" title="ОТПУСК ПО ФИДЕРУ, ШТ. ТУ" is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>1</const>
          </call>
          <const>1</const>
        </call>
        <call function="if" as="pnt_grid" type="number" title="ПОТРЕБЛЕНИЕ ПО ФИДЕРУ, ШТ. ТУ " is-fact="1" agg="sum">
          <call function="=">
            <column table="a" column="gr" />
            <const>2</const>
          </call>
          <const>1</const>
        </call>
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="k_gr_f_tp" column="id" is-private-dimension="k_gr_f_tp" is-final-dimension="k_gr_f_tp" dimension="k_gr_f_tp" />
        <column table="k_gr_f_tp" column="k_gr_f_tp" />
        <column table="k_pwrc_fdr" column="k_pwrc_fdr" />
        <column table="k_pwrc_fdr" column="pwrc_id" as="m2m_pwrc_id" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" exclude="1" />
        <column table="k_gr_f_tp" column="kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" exclude="1" />
        <column table="k_gr_f_tp" column="k_kg_name" type="string" is-private-dimension="kg_name" is-final-dimension="kg_name" dimension="kg_name" />
        <column table="k_gr_f_tp" column="kg_name" type="string" />
        <call as="grid_dtl_kg" function="||-">
          <column table="a" column="src_fdrid" />
          <column table="a" column="ym" />
        </call>
      </select>
      <from>
        <table name="jr_rep_blns_pwrc_fdrs" as="a" />
        <query name="d45862_grid_dtl_kg" as="pwrc_grid_dtl" join="left outer" is-private-dimension="1" is-final-dimension="1" dimension="1">
          <call function="=" exclude="1">
            <column table="a" column="src_fdrid" />
            <column table="pwrc_grid_dtl" column="src_fdrid" />
          </call>
          <call function="=">
            <column table="this" column="grid_dtl_kg" />
            <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
            <call function="replace" exclude="1">
              <column table="pwrc_grid_dtl" column="grid_dtl_kg" />
              <const>9999.99</const>
              <column table="this" column="ym" />
            </call>
          </call>
        </query>
        <query name="d45862_fdr_kg" as="k_gr_f_tp" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="hv_eopwrc_grid_id" />
              <column table="k_gr_f_tp" column="k_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_gr_f_tp" column="ym" />
              <call function="replace" exclude="1">
                <column table="k_gr_f_tp" column="ym" />
                <const>9999.99</const>
                <column table="this" column="ym" />
              </call>
            </call>
          </call>
        </query>
        <query name="45862_m2m_pwrc_fdr" as="k_pwrc_fdr" join="left outer">
          <call function="and">
            <call function="=">
              <column table="this" column="k_gr_f_tp" />
              <column table="k_pwrc_fdr" column="k_gr_f_tp" />
            </call>
            <call function="=">
              <column table="this" column="ym" />
              <column table="k_pwrc_fdr" column="ym" />
              <call function="replace" exclude="1">
                <column table="k_pwrc_fdr" column="ym" />
                <const>9999.99</const>
                <column table="this" column="ym" />
              </call>
            </call>
          </call>
        </query>
        <query name="hv_eopwrc_g" as="pwrc_id" join="left outer">
          <call function="=">
            <column table="this" column="m2m_pwrc_id" />
            <column table="pwrc_id" column="pwrc_id" />
          </call>
        </query>
        <query name="d45862_kg_name" join="left outer" as="k_kg_name">
          <call function="=">
            <column table="k_gr_f_tp" column="k_kg_name" />
            <column table="k_kg_name" column="k_kg_name" />
          </call>
        </query>
      </from>
      <where>
        <call function="not">
          <call function="and">
            <call function="=">
              <column table="a" column="kod_outeris" />
              <const>7</const>
            </call>
            <call function="=">
              <column table="k_gr_f_tp" column="exclude_auto_fdr" />
              <const>1</const>
            </call>
          </call>
        </call>
      </where>
      <links>
        <link name="pwrc_id" is-private-dimension="1" is-final-dimension="1" dimension="1" as="pwrc_id1">
          <dimlink name="kod_fl" is-private-dimension="1" is-final-dimension="1" dimension="1" />
        </link>
      </links>
    </query>
    <query name="jr_rep_blns_pwrc_fdrs_test_det_mat" class="1" timestamp="23.12.2018 20:58:03" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jr_rep_blns_pwrc_fdrs.xml">
      <select>
        <call function="rowid" as="jr_rep_blns_pwrc_fdrs_id" key="1" exclude="1" />
        <const as="jr_rep_blns_pwrc_fdrs_id" key="1">a.rowid</const>
        <column table="a" column="kod_rpoint" type="number" comment="ID ТУ" />
        <column table="a" column="kod_outeris" type="number" column-mandatory="1" comment="ID МОДУЛЯ" />
        <column table="a" column="pwrc_id" type="number" column-mandatory="1" title="" comment="ID ПС" />
        <column table="a" column="pwrcname" type="string" title="" comment="ДИСП №ПС" />
        <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" comment="ID ФИДЕРА" />
        <column table="a" column="pwrc_fdrname" type="string" column-mandatory="1" title="" comment="ДИСП №ФИД" />
        <column table="a" column="src_id" type="number" title="" comment="ID ТП,РП,КК" />
        <column table="a" column="srcname" type="string" title="" comment="ДИСП №ТП,РП,КК" />
        <column table="a" column="tpoint" type="string" column-mandatory="1" title="" comment="ВИД ТУ" />
        <column table="a" column="pnum" type="number" column-mandatory="1" title="" comment="№ТУ" />
        <column table="a" column="pname" type="string" column-mandatory="1" title="" comment="НАИМЕН. ТУ" />
        <column table="a" column="place_namefider" type="string" title="" comment="ОБОРУД" />
        <column table="a" column="cnt_num" type="string" title="" comment="№ ПУ" />
        <column table="a" column="readvals" type="string" title="" comment="ПОКАЗАНИЯ" />
        <column table="a" column="cnt_rkoef" type="string" title="" comment="РАСЧ.КОЭФ" />
        <column table="a" column="out1" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А+)" />
        <column table="a" column="cust1" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А+)" />
        <column table="a" column="out2" type="number" title="" comment="РАСХ. ПО СЧ., кВт*ч (А-)" />
        <column table="a" column="cust2" type="number" title="" comment="КОЛИЧ. ЭЭ. кВт*ч (А-)" />
        <column table="a" column="wp_in" type="number" title="ОТПУСК ПО ФИДЕРУ, кВт*ч" comment="ОТПУСК ПО ФИДЕРУ, кВт*ч" is-fact="1" agg="sum" fact="jr_rep_test_det_mat_wp_in" />
        <column table="a" column="wp_out" type="number" title="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" comment="ПОТРЕБЛ. ПО ФИДЕРУ, кВт*ч" />
        <column table="a" column="name_es" type="string" column-mandatory="1" title="" comment="ЭСК" />
        <column table="a" column="name_fsk" type="string" column-mandatory="1" title="" comment="ЗОНА ФИЛИАЛА ЛЭ" />
        <column table="a" column="name_rsk" type="string" column-mandatory="1" title="" comment="РЭС" />
        <column table="a" column="dog_num" type="string" title="" comment="№ ДОГОВОРА ЭНЕРГ" />
        <column table="a" column="user_name" type="string" column-mandatory="1" title="" comment="ПОТРЕБИТЕЛЬ" />
        <column table="a" column="eobj_num" type="string" title="" comment="№ ОБЪЕКТА" />
        <column table="a" column="eobj_name" type="string" title="" comment="НАИМЕН. ОБЪЕКТА" />
        <column table="a" column="r_pwrlev" type="string" title="" comment="УН" />
        <column table="a" column="pwr_lev" type="number" title="" comment="НАПРЯЖ, кВ" />
        <column table="a" column="eobj_adress" type="string" title="" comment="АДРЕС ОБЪЕКТА ПОТРЕБИТЕЛЯ" />
        <column table="a" column="gr" type="number" title="" comment="№ ГРУППЫ ДАННЫХ" />
        <column table="a" column="ym" type="number" column-mandatory="1" title="" comment="ОТЧ.ПЕРИОД" />
        <column table="a" column="src_fdrid" type="number" column-mandatory="1" title="" comment="ID ЛИНИИ ТП,РП,КК (ПРИСОЕДИНЕНИЯ)" />
        <column table="a" column="bal_id" type="number" column-mandatory="1" title="" comment="ID ФИЛИАЛА, К КОТОРОМУ ОТНОСИТСЯ НАБОР ДАННЫХ" is-private-dimension="kod_fl" is-final-dimension="kod_fl" dimension="kod_fl" />
        <call function="||-" as="hv_eopwrc_grid_id">
          <column table="a" column="pwrc_fdrid" type="number" column-mandatory="1" title="" />
          <column table="a" column="src_id" type="number" column-mandatory="1" title="" />
        </call>
        <column table="pwrc_id_test" column="hv_eopwrc_id" is-private-dimension="pwrc_id_test_det_mat" is-final-dimension="pwrc_id_test_det_mat" dimension="pwrc_id_test_det_mat" />
      </select>
      <from>
        <table name="jr_rep_blns_pwrc_fdrs" as="a" />
        <query name="hv_eopwrc_test_det_mat" as="pwrc_id_test" join="left outer">
          <call function="=">
            <column table="a" column="pwrc_id" />
            <column table="pwrc_id_test" column="pwrc_id" />
          </call>
        </query>
      </from>
    </query>
    <query name="jv_rep_blns_comm_defvals" class="1" timestamp="25.04.2018 21:08:10" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jv_rep_blns_comm_defvals.xml">
      <select>
        <column table="a" column="srckodp_fsk" type="number" title="" />
        <column table="a" column="ym" type="number" title="" />
      </select>
      <from>
        <table name="jv_rep_blns_comm_defvals" as="a" />
      </from>
    </query>
    <query name="45862-kod_fl-def" class="1" timestamp="25.04.2018 21:09:50" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jv_rep_blns_comm_defvals.xml">
      <select>
        <column table="a" column="srckodp_fsk" type="number" title="" />
      </select>
      <from>
        <query name="jv_rep_blns_comm_defvals" as="a" />
      </from>
    </query>
    <query name="45862-ym-def" class="1" timestamp="25.04.2018 21:11:58" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jv_rep_blns_comm_defvals.xml">
      <select>
        <column table="a" column="ym" type="number" title="" />
      </select>
      <from>
        <query name="jv_rep_blns_comm_defvals" as="a" />
      </from>
    </query>
    <query name="jv_rep_blns_pwrc_defvals" class="1" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jv_rep_blns_pwrc_defvals.xml">
      <select>
        <call function="rowid" as="jv_rep_blns_pwrc_defvals_id" key="1" />
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
      </select>
      <from>
        <table name="jv_rep_blns_pwrc_defvals" as="a" />
      </from>
    </query>
    <query name="45862-pwrc_id-def" class="1" timestamp="25.04.2018 21:10:44" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\jv_rep_blns_pwrc_defvals.xml">
      <select>
        <column table="a" column="pwrc_id" type="number" title="" />
        <column table="a" column="pwrcname" type="string" title="" />
      </select>
      <from>
        <table name="jv_rep_blns_pwrc_defvals" as="a" />
      </from>
    </query>
    <query name="pl_getslpnt811" class="1" timestamp="22.05.2019 13:22:39" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\pl_getslpnt811.xml">
      <params>
        <param type="number" name="ym" />
      </params>
      <select>
        <column table="a" column="flname" type="string" title="" />
        <column table="a" column="src_dnum" type="string" title="" />
        <column table="a" column="fdrsrc_dnum" type="string" />
        <column table="a" column="tp_dnum" type="string" title="" />
        <column table="a" column="tp_nv" type="number" title="" />
        <column table="a" column="fdrtp_dnum" type="string" title="" />
        <column table="a" column="fdrtp_nv" type="number" title="" />
        <column table="a" column="total_cnt" type="number" title="" />
        <column table="a" column="i_cnt" type="number" title="" />
        <column table="a" column="ii_cnt" type="number" title="" />
        <column table="a" column="iii_cnt" type="number" title="" />
        <column table="a" column="bh_cnt" type="number" title="" />
        <column table="a" column="ch1_cnt" type="number" title="" />
        <column table="a" column="ch2_cnt" type="number" title="" />
        <column table="a" column="hh_cnt" type="number" title="" />
        <column table="a" column="tco_cnt" type="number" title="" />
      </select>
      <from>
        <table name="TABLE (JG_REPORTS_ISE.PL_getSLPNT811 (:ym, 'dep'))" as="a" />
      </from>
    </query>
  </queries>
  <functions child-name="function" key-name="name" />
  <parts child-name="part" key-name="id" />
  <views child-name="view" key-name="id">
    <view name="45862-yms" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      WITH X
      AS (SELECT MAX (X.CURR_YM) YM
      FROM KS_ZBD Z
      INNER JOIN KR_ORG O ON (Z.KODP = O.KODP)
      INNER JOIN (SELECT MAX (C.YM) AS CURR_YM, C.PODR
      FROM KR_CALC C
      GROUP BY C.PODR) X
      ON (Z.KODP = X.PODR))
      SELECT KG.YM_ADD (ym, -RN) ym,
      rpad(KG.YM_ADD (ym, -RN),7,'0') name
      FROM X
      CROSS JOIN (SELECT ROWNUM - 1 AS RN
      FROM DUAL
      CONNECT BY ROWNUM &lt;= 24)
    </view>
    <view name="45862-yms_test" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      SELECT KG.YM_ADD (ym, -RN) ym,
      rpad(KG.YM_ADD (ym, -RN),7,'0') name
      FROM
      (
      SELECT MAX (X.CURR_YM) YM
      FROM KS_ZBD Z
      INNER JOIN KR_ORG O ON (Z.KODP = O.KODP)
      INNER JOIN (SELECT MAX (C.YM) AS CURR_YM, C.PODR
      FROM KR_CALC C
      GROUP BY C.PODR) X
      ON (Z.KODP = X.PODR)
      )
      CROSS JOIN (SELECT ROWNUM - 1 AS RN
      FROM DUAL
      CONNECT BY ROWNUM &lt;= 2)
    </view>
    <view name="hv_eopwrc_grid_dtl_src_fdr_list" class="1" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
      select a.src_id, a.pwrc_fdrid, a.srcname, a.src_balnamex, fdr.pwrc_fdrname, fdr.pwrcname
      from hv_eopwrc_grid_dtl a
      left join hv_eopwrc_fdrs fdr on a.pwrc_fdrid = fdr.pwrc_fdrid
    </view>
    <view name="kg_fdr_missing_tp" class="1" file="sql.builder.templates\sql.builder\projects\45862\scheme\original\hv_eopwrc_grid_dtl.xml">
		  with kg_fdr_ym as
		  (
		  select kg_nastr.kod_kol_gr_nastr, kg_nastr.kod_kol_gr, kg_fdr.kod_kol_gr_fdr, kg_fdr.pwrc_fdrid,ym.ym   from vb_kol_gr_fdr kg_fdr
		  left join vb_kol_gr_pwrc kg_pwrc on kg_fdr.kod_kol_gr_pwrc = kg_pwrc.kod_kol_gr_pwrc
		  left join vb_kol_gr_nastr kg_nastr on kg_pwrc.kod_kol_gr_nastr = kg_nastr.kod_kol_gr_nastr
		  left join (select to_number(to_char( vv_day.dat_day ,'YYYYMM'))/100 as ym from vv_day group by to_number(to_char( vv_day.dat_day ,'YYYYMM'))/100) ym
		  on (ym.ym &gt;= kg_nastr.s) and (ym.ym &lt;= nvl(kg_nastr.po,9999))
	  where (ym.ym &gt;= (select max(ym) from kr_calc)) and nvl(kg_fdr.entire_fdr,0) = 0
	  ),
	  fdr_tp as
	  (
	  select kg_fdr_ym.kod_kol_gr, kg_fdr_ym.pwrc_fdrid, kg_fdr_ym.ym, src_id.src_id from kg_fdr_ym
	  inner join hv_eopwrc_grid_dtl src_id on kg_fdr_ym.pwrc_fdrid = src_id.pwrc_fdrid
	  ),
	  fdr_tp_kg as
	  (
	  select kg_fdr_ym.pwrc_fdrid, kg_fdr_ym.ym, kg_tp.src_id from kg_fdr_ym
	  left join vb_kol_gr_tp kg_tp on kg_fdr_ym.kod_kol_gr_fdr = kg_tp.kod_kol_gr_fdr
	  )

	  select fdr_tp.kod_kol_gr, fdr_tp.ym, fdr_tp.pwrc_fdrid, fdr_tp.src_id from fdr_tp left join fdr_tp_kg on fdr_tp.ym = fdr_tp_kg.ym and fdr_tp.pwrc_fdrid = fdr_tp_kg.pwrc_fdrid and fdr_tp.src_id = fdr_tp_kg.src_id
	  where fdr_tp_kg.pwrc_fdrid is null
  </view>
  </views>
  <reports child-name="report" key-name="name" />
  <forms child-name="form" key-name="name">
    <form name="45862_vb_kol_gr" timestamp="18.05.2020 11:54:18" title="Кольцевая группа" form-size="1050;800" show-toolbar="1" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <params>
        <param type="number" name="kod_nastr" />
        <param type="number" name="kod_fl" />
        <param type="number" name="ym" />
      </params>
      <toolbar>
        <uicommand button-type="form-save" visible="0" />
        <uicommand button-type="form-save-and-close" visible="0" />
        <uicommand action-type="save-and-close" button-type="custom-commit" exclude="1" />
        <uicommand action-type="custom" button-type="custom-commit" editable="save_active">
          <useaction action-type="save" />
          <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
            <useparam name="kod_nastr" />
          </useaction>
          <useaction action-type="close" />
        </uicommand>
      </toolbar>
      <content>
        <column table="kg_edit_allow_flag" column="save_active" title="ym_editable" parname="save_active" column-visible="0" />
        <column table="a" column="name_exp" column-editable="0" />
        <column table="a" column="kol_gr_comment" editable="save_active" />
        <column table="a" column="kod_fl" column-visible="0" default="kod_fl" />
        <column table="a" column="s" column-visible="0" default="ym" />
        <column table="a" column="is_not_new" column-visible="0" parname="is_not_new" as="is_not_new" />
        <splitcontainer>
          <fieldgroup title="ПС">
            <grid table="pwrc" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand title="Привязать" action-type="custom" button-type="custom-add-form" editable="save_active">
                  <useaction action-type="save" />
                  <useaction action-type="dynamic-form-create-multiple" call="45862_vb_pwrc_change" modal="1" title="Привязать">
                    <useparam name="kod_fl" />
                    <useparam name="kod_nastr" />
                    <useparam name="ym" />
                  </useaction>
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите отвязать выделенные ПС?" title="Отвязать отмеченные" editable="save_active" button-type="custom-delete">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="pwrc" />
                  <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                    <useparam name="kod_nastr" />
                    <useparam name="ym" />
                  </useaction>
                  <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                    <useparam name="kod_nastr" />
                  </useaction>
                  <useaction action-type="refresh-table" object="a" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="pwrc_id" column="pwrcname" title="ПС" column-width="316" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="Фидеры">
            <grid table="fdr" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="45862_vb_fdr_change" modal="1" title="Привязать" editable="save_active" button-type="custom-add-form">
                  <useparam name="kod_nastr" />
                  <useparam name="ym" />
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите отвязать выделенные фидеры?" title="Отвязать отмеченные" editable="save_active" button-type="custom-delete">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="fdr" />
                  <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                    <useparam name="kod_nastr" />
                    <useparam name="ym" />
                  </useaction>
                  <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                    <useparam name="kod_nastr" />
                  </useaction>
                  <useaction action-type="refresh-table" object="a" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="pwrc_fdrid" column="pwrc_fdrname" column-width="124" />
                <column table="fdr" column="entire_fdr" column-width="154" title="Фидер включен целиком" />
                <column table="pwrc_fdrid" column="pwrcname" column-width="316" />
                <column table="pwrc_fdrid" column="pwrc_fdr_explname" column-width="154" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="ТП">
            <grid table="tp" show-toolbar="1" show-checkbox="1" auto-filter="1">
              <toolbar>
                <uicommand button-type="grid-add" visible="0" />
                <uicommand button-type="grid-refresh" column-visible="0" />
                <uicommand button-type="grid-delete" column-visible="0" />
                <uicommand button-type="grid-save" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="45862_vb_tp_change" modal="1" title="Привязать" editable="save_active" button-type="custom-add-form">
                  <useparam name="kod_nastr" />
                  <useparam name="ym" />
                </uicommand>
                <uicommand action-type="custom" prompt="Вы уверены, что хотите отвязать выделенные ТП?" title="Отвязать отмеченные" editable="save_active" button-type="custom-delete">
                  <useaction action-type="client-remove-row" />
                  <useaction action-type="save" object="tp" />
                  <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                    <useparam name="kod_nastr" />
                    <useparam name="ym" />
                  </useaction>
                  <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                    <useparam name="kod_nastr" />
                  </useaction>
                  <useaction action-type="refresh-table" object="a" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="hv_eopwrc_grid_id" column="srcname" column-width="232" />
                <column table="hv_eopwrc_grid_id" column="pwrc_fdrname" column-width="128" />
                <column table="hv_eopwrc_grid_id" column="pwrcname" column-width="318" />
              </columns>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="vb_kol_gr_nastr" as="a">
          <elink name="vb_kol_gr_pwrc" as="pwrc" column-editable="0" order="pwrcname">
            <link name="pwrc_id" />
          </elink>
          <elink name="vb_kol_gr_fdr" as="fdr" column-editable="0" order="pwrcname, pwrc_fdrname">
            <link name="pwrc_fdrid" />
          </elink>
          <elink name="vb_kol_gr_tp" as="tp" column-editable="0" order="pwrcname, pwrc_fdrname, srcname">
            <link name="kod_kol_gr_fdr" />
            <link name="hv_eopwrc_grid_id" />
          </elink>
          <where>
            <call function="=">
              <column table="a" column="kod_kol_gr_nastr" />
              <useparam name="kod_nastr" />
            </call>
          </where>
        </query>
        <query name="45862_vb_kol_gr_allow_edit" join="right outer" as="kg_edit_allow_flag">
          <withparams>
            <useparam name="ym" />
            <useparam name="kod_nastr" />
            <useparam name="kod_fl" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="45862_vb_fdr_change" timestamp="21.11.2019 14:30:28" title="Изменить список фидеров" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <content>
        <grid table="a" show-toolbar="1" show-checkbox="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" title="Привязать выбранные" button-type="custom-ok">
              <useaction action-type="save" />
              <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                <useparam name="kod_nastr" />
                <useparam name="ym" />
              </useaction>
              <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                <useparam name="kod_nastr" />
              </useaction>
              <useaction action-type="close" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="a" column="pwrc_fdrid" parname="pwrc_fdrid" column-visible="0" />
            <column table="a" column="entire_fdr" editable="1" title="Включить фидер целиком" parname="entire_fdr" />
            <column table="a" column="pwrc_fdrname" column-width="120" />
            <column table="a" column="pwrcname" column-width="337" />
            <column table="a" column="kod_kol_gr_pwrc" parname="kod_kol_gr_pwrc" column-visible="0" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vb_add_fdr">
                <useparam name="pwrc_fdrid" />
                <useparam name="kod_kol_gr_pwrc" />
                <useparam name="entire_fdr" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vb_nastr_fdr_list" as="a" auto-refresh="1" column-editable="0" order="pwrcname, pwrc_fdrname">
          <withparams>
            <useparam name="kod_nastr" />
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="45862_vb_kol_gr_list" timestamp="10.12.2018 02:12:56" title="Кольцевые группы" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <content>
        <usefield field="cmn_combo_num" title="Филиал" name="kod_fl" column-mandatory="1" show-checkbox="0">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
        </usefield>
        <usefield field="cmn_text" name="init_dummy" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="45862_init_filial" />
          </defaultquery>
        </usefield>
        <uicommand name="jg_reports_ise.jr_rep_blns_pwrc_sx_init" title="Сформировать схему сети" exclude="1">
          <useparam name="kod_fl" />
        </uicommand>
        <fieldgroup title="Схема сети за период" exclude="1">
          <usefield field="asuse_ym" title="С" name="period_s" />
          <usefield field="asuse_ym" title="По" name="period_po" />
          <uicommand action-type="dynamic-form" call="45862_vb_kg_schema" modal="1" title="Показать схему сети">
            <useparam name="kod_fl" />
            <useparam name="period_s" />
            <useparam name="period_po" />
          </uicommand>
        </fieldgroup>
        <splitcontainer>
          <fieldgroup title="Кольцевые группы">
            <grid table="a" show-toolbar="1">
              <columns>
                <column table="a" column="name" column-editable="0" column-width="313" />
                <column table="a" column="kod_fl" column-editable="0" default="kod_fl" title="Филиал" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="Период действия группы">
            <grid table="gn" show-toolbar="1">
              <toolbar>
                <uicommand title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                  <useparam name="kod_nastr" />
                </uicommand>
                <uicommand action-type="dynamic-form" call="45862_vb_kol_gr" editable="gn_is_not_new" modal="1" title="Настройка">
                  <useparam name="kod_fl" />
                  <useparam name="kod_nastr" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="gn" column="is_not_new" column-visible="0" parname="gn_is_not_new" as="is_not_new" />
                <column table="gn" column="name" column-width="314" column-editable="0" />
                <band title="Период">
                  <column table="gn" column="s" title="С" />
                  <column table="gn" column="po" title="По" />
                </band>
                <column table="gn" column="kod_kol_gr_nastr" parname="kod_nastr" column-visible="0" />
              </columns>
            </grid>
          </fieldgroup>
          <fieldgroup title="Схема сети" exclude="1">
            <grid table="fdr" show-toolbar="1" show-checkbox="1">
              <toolbar>
                <uicommand button-type="grid-add" column-visible="0" />
                <uicommand action-type="dynamic-form-create-multiple" call="45862_vb_kol_gr_change" modal="1" title="Добавить" button-type="custom-add-form">
                  <useparam name="kod_fl" />
                  <useparam name="name" />
                  <useparam name="kod_nastr" />
                </uicommand>
              </toolbar>
              <columns>
                <column table="fdr" column="pwrc_fdrid" title="Фидер" />
                <column table="pwrc_id" column="pwrcname" title="ПС" column-width="316" />
              </columns>
            </grid>
          </fieldgroup>
        </splitcontainer>
      </content>
      <from>
        <query name="vb_kol_gr" as="a" auto-refresh="1">
          <elink name="vb_kol_gr_nastr" as="gn" order="s asc nulls last, po asc nulls first">
            <elink name="vb_kol_gr_fdr" as="fdr" column-editable="0" exclude="1">
              <link name="pwrc_fdrid">
                <link name="pwrc_id" />
              </link>
            </elink>
          </elink>
          <where>
            <call function="or">
              <call function="false" />
              <call function="=" optional="1">
                <column table="a" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
            </call>
          </where>
        </query>
      </from>
    </form>
    <form name="45862_vb_pwrc_change" timestamp="04.09.2019 17:46:36" title="Изменить список ПС" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <params>
        <param name="kod_fl" type="number" />
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <content>
        <grid table="a" show-toolbar="1" show-checkbox="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" title="Привязать выбранные" button-type="custom-ok">
              <useaction action-type="save" />
              <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                <useparam name="kod_nastr" />
                <useparam name="ym" />
              </useaction>
              <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                <useparam name="kod_nastr" />
              </useaction>
              <useaction action-type="close" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="a" column="pwrc_id" column-visible="0" parname="pwrc_id" />
            <column table="a" column="pwrcname" title="ПС" column-width="322" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vb_add_pwrc">
                <useparam name="pwrc_id" />
                <useparam name="kod_nastr" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vb_nastr_pwrc_list" as="a" auto-refresh="1" column-editable="0" order="pwrcname">
          <withparams>
            <useparam name="kod_fl" />
            <useparam name="kod_nastr" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="45862_vb_tp_change" timestamp="21.10.2019 14:40:16" title="Изменить список ТП" form-size="800;500" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <content>
        <grid table="a" show-toolbar="1" show-checkbox="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" title="Привязать выбранные" button-type="custom-ok">
              <useaction action-type="save" />
              <useaction title="Обновить настройки КГ" name="vb_kol_gr_pack.upd_kg_nastr">
                <useparam name="kod_nastr" />
                <useparam name="ym" />
              </useaction>
              <useaction title="Обновить имя КГ" name="vb_kol_gr_pack.upd_kg_name">
                <useparam name="kod_nastr" />
              </useaction>
              <useaction action-type="close" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="a" column="src_id" parname="src_id" column-visible="0" />
            <column table="a" column="srcname" column-width="241" />
            <column table="a" column="pwrc_fdrname" column-width="121" />
            <column table="a" column="pwrcname" column-width="339" />
            <column table="a" column="kod_kol_gr_fdr" parname="kod_kol_gr_fdr" column-visible="0" />
          </columns>
          <events>
            <useaction event-name="checked-row-save" action-type="custom">
              <useaction action-type="execute-add" call="vb_add_tp">
                <useparam name="src_id" />
                <useparam name="kod_kol_gr_fdr" />
              </useaction>
            </useaction>
          </events>
        </grid>
      </content>
      <from>
        <query name="vb_nastr_tp_list" as="a" auto-refresh="1" column-editable="0" order="pwrcname, pwrc_fdrname, srcname">
          <withparams>
            <useparam name="kod_nastr" />
            <useparam name="ym" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="45862_vb_kg_schema" timestamp="29.11.2018 18:23:20" title="Схема сети" form-size="1050;800" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <params>
        <param type="number" name="kod_fl" />
        <param type="number" name="period_s" />
        <param type="number" name="period_po" />
      </params>
      <content>
        <grid table="sch" show-toolbar="1" show-checkbox="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand button-type="grid-refresh" column-visible="0" />
            <uicommand button-type="custom-refresh" action-type="custom">
              <useaction action-type="refresh-table" object="a" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="sch" column="ym" title="Месяц" format="F2" />
            <column table="sch" column="pwrcname" type="string" data-size="121" title="" column-width="184" />
            <column table="sch" column="name" type="string" data-size="4000" column-width="300" />
            <column table="sch" column="pwrc_fdrname" type="string" data-size="206" title="" column-width="58" />
            <column table="sch" column="srcname" type="string" data-size="123" title="" column-width="190" />
            <column table="sch" column="s" column-visible="0" />
            <column table="sch" column="po" column-visible="0" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="45862_vb_kg_schema" as="sch" order="pwrcname, po desc nulls first, pwrc_fdrname, srcname" column-editable="0">
          <withparams>
            <useparam name="kod_fl" />
            <useparam name="period_s" />
            <useparam name="period_po" />
          </withparams>
        </query>
      </from>
    </form>
    <form name="45862_vb_kol_gr_list_simp" timestamp="17.04.2020 17:24:54" title="1. Формирование Кольцевых групп" file="sql.builder.templates\sql.builder\projects\45862\form\forms.xml">
      <content>
        <usefield field="asuse_ym" column-mandatory="1" show-checkbox="0" />
        <usefield field="cmn_combo_num" title="Филиал" name="kod_fl" column-mandatory="1" show-checkbox="0">
          <listquery>
            <query name="jv_rep_cons_d_fl" />
          </listquery>
        </usefield>
        <usefield field="cmn_text" name="init_dummy" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="45862_init_filial" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_text" name="ym_editable" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="45862_ym_editable">
              <withparams>
                <useparam name="ym" />
                <useparam name="kod_fl" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <usefield field="cmn_text" name="kg_add_allow_flag" show-checkbox="0" column-visible="0">
          <defaultquery>
            <query name="45862_kg_add_allow_flag">
              <withparams>
                <useparam name="ym" />
                <useparam name="kod_fl" />
              </withparams>
            </query>
          </defaultquery>
        </usefield>
        <uicommand name="jg_reports_ise.jr_rep_blns_pwrc_sx_init" title="Сформировать схему сети" exclude="1">
          <useparam name="kod_fl" />
        </uicommand>
        <fieldgroup title="Схема сети за период" exclude="1">
          <usefield field="asuse_ym" title="С" name="period_s" />
          <usefield field="asuse_ym" title="По" name="period_po" />
          <uicommand action-type="dynamic-form" call="45862_vb_kg_schema" modal="1" title="Показать схему сети">
            <useparam name="kod_fl" />
            <useparam name="period_s" />
            <useparam name="period_po" />
          </uicommand>
        </fieldgroup>
        <grid table="gn" show-toolbar="1" auto-filter="1">
          <toolbar>
            <uicommand button-type="grid-save" column-visible="0" />
            <uicommand button-type="grid-add" column-visible="0" />
            <uicommand button-type="grid-delete" column-visible="0" />
            <uicommand action-type="custom" type="Delete" title="Удалить" button-type="custom-delete" editable="kg_add_allow_flag">
              <useaction action-type="client-remove-row" action-rows="selected" />
            </uicommand>
            <uicommand action-type="custom" button-type="custom-commit" editable="gn_has_changes">
              <useaction action-type="save" />
              <useaction action-type="refresh-form" object="gn" />
            </uicommand>
            <uicommand action-type="custom" title="Кольцевая группа" button-type="custom-add-form" editable="kg_add_allow_flag">
              <useaction action-type="dynamic-form-create" call="45862_vb_kol_gr" modal="1">
                <const>null</const>
                <useparam name="kod_fl" />
                <useparam name="ym" />
              </useaction>
              <useaction action-type="refresh-form" object="gn" />
            </uicommand>
            <uicommand button-type="custom-add-form" action-type="dynamic-form-create" call="45862_vb_kol_gr" modal="1" editable="kod_fl" exclude="1">
              <const>null</const>
              <useparam name="kod_fl" />
              <useparam name="ym" />
            </uicommand>
          </toolbar>
          <columns>
            <column table="gn" column="is_not_new" column-visible="0" parname="gn_is_not_new" as="is_not_new" />
            <column table="gn" column="kod_kol_gr" column-visible="0" parname="kod_kol_gr" />
            <column table="gn" column="name_exp" column-width="576" column-editable="0">
              <buttons>
                <uicommand action-type="custom" title="Настройка" visible="kod_fl" side="Right">
                  <useaction action-type="save" />
                  <useaction action-type="dynamic-form" call="45862_vb_kol_gr" editable="gn_is_not_new" modal="1" title="Настройка" visible="1" side="Right">
                    <useparam name="kod_nastr" />
                    <useparam name="kod_fl" />
                    <useparam name="ym" />
                  </useaction>
                  <useaction action-type="refresh-form" object="gn" />
                </uicommand>
              </buttons>
            </column>
            <column table="gn" column="kol_gr_comment" column-width="383" editable="ym_editable" />
            <column table="gn" column="kod_fl" column-editable="0" title="Филиал" default="kod_fl" column-mandatory="1" />
            <band title="Период" exclude="1">
              <column table="gn" column="s" title="С" />
              <column table="gn" column="po" title="По" />
            </band>
            <column table="gn" column="kod_kol_gr_nastr" parname="kod_nastr" column-visible="0" />
          </columns>
        </grid>
      </content>
      <from>
        <query name="vb_kol_gr_nastr" as="gn" auto-refresh="1">
          <events>
            <useaction event-name="instead-object-delete" name="vb_kol_gr_pack.del_kg_nastr">
              <useparam name="kod_nastr" />
              <useparam name="ym" />
            </useaction>
          </events>
          <where>
            <call function="and">
              <call function="ge">
                <call function="nvl">
                  <column table="gn" column="po" />
                  <useparam name="ym" />
                </call>
                <useparam name="ym" />
              </call>
              <call function="le">
                <call function="nvl">
                  <column table="gn" column="s" />
                  <useparam name="ym" />
                </call>
                <useparam name="ym" />
              </call>
              <call function="=" optional="1">
                <column table="gn" column="kod_fl" />
                <useparam name="kod_fl" />
              </call>
              <call function="=1">
                <useparam name="init_dummy" />
              </call>
            </call>
          </where>
        </query>
      </from>
    </form>
  </forms>
  <datatypes />
  <editors />
  <folders />
  <globalparams child-name="param" key-name="name" />
  <!--<globalconsts child-name="globalconst" key-name="name">
  </globalconsts>-->
  <expression-packages child-name="expression-package" key-name="name" />
  <dimension-packages child-name="dimension-package" key-name="name">
    <dimension-package name="45862" timestamp="20.03.2019 15:21:16" file="sql.builder.templates\sql.builder\projects\45862\reports\45862-rep.xml">
      <dimension class-type="jr_rep_blns_pwrc_fdrs" name="rep_blns_pwrc_fdrs" />
      <dimension class-type="hv_eopwrc_g" name="pwrc_id" />
      <dimension class-type="hv_eopwrc" name="pwrc_bal_id" />
      <dimension class-type="hv_eopwrc_fdrs" name="pwrc_fdrid" />
      <dimension class-type="hv_eopwrc_grid" name="pwrc_grid" />
      <dimension class-type="hv_eopwrc_grid_dtl" name="pwrc_grid_dtl" />
      <dimension class-type="jv_rep_cons_d_fl" name="jv_rep_cons_d_fl" />
      <dimension class-type="vb_kg_schema_fdr" name="schema_fdr" exclude="1" />
      <dimension class-type="vb_kg_schema_tp" name="schema_tp" exclude="1" />
      <dimension name="k_gr_f_tp" class-type="d45862_fdr_kg" />
      <dimension name="grid_dtl_kg" class-type="d45862_grid_dtl_kg" />
      <dimension class-type="jr_rep_blns_pwrc_fdrs_test" name="rep_blns_pwrc_fdrs_test" />
      <dimension name="kg_name" time-type="string" exclude="1" />
      <dimension name="kg_name" class-type="d45862_kg_name" />
      <dimension name="d45862_ym" time-type="number" exclude="1" />
      <dimension class-type="hv_eopwrc_test_det_mat" name="pwrc_id_test_det_mat" />
      <dimension class-type="jr_rep_blns_pwrc_fdrs_test_det_mat" name="rep_blns_test_det_mat" />
    </dimension-package>
  </dimension-packages>
  <security-packages child-name="security-package" key-name="name" />
  <color-packages child-name="color-package" key-name="name" />
  <format-packages child-name="format-package" key-name="name" />
  <button-types child-name="button-type" key-name="name" />
  <!--раздел qlikview организовать по аналогии с остальными вместо qlikview/customer/@id   дать имена   qwprojects/qwproject/@customer-->
  <qvprojects />
  <!--<images>
    <image char="" name="link" />
    <image char="" name="dlink" rotate-flip="RotateNoneFlipY"/>
    <image char="" name="call"/>
    <image char="" name="column"/>
  </images>
  <eltypes>
    <eltype  name="vcall" image="call"/>
    <eltype  name="vlink" image="link"/>
    <eltype  name="vdink" image="dlink"/>
    <eltype  name="vcolumn" image="column"/>
  </eltypes>-->
  <fields child-name="field" key-name="id" />
  <actions child-name="action" key-name="name">
    <action name="jg_reports_ise.jr_rep_blns_pwrc_sx_init" action-type="call-plsql" timestamp="26.11.2018 21:51:34" file="sql.builder.templates\sql.builder\projects\45862\form\action.xml">
      <params>
        <param name="kod_fl" type="number" />
      </params>
      <text>BEGIN
       jg_reports_ise.jr_rep_blns_pwrc_sx_init(:kod_fl);
	END;</text>
    </action>
    <action name="vb_kol_gr_pack.upd_kg_name" action-type="call-plsql" timestamp="29.11.2018 14:01:21" file="sql.builder.templates\sql.builder\projects\45862\form\action.xml">
      <params>
        <param name="kod_nastr" type="number" />
      </params>
      <text>begin
vb_kol_gr_pack.upd_kg_name(:kod_nastr);
end;</text>
    </action>
    <action name="vb_kol_gr_pack.upd_kg_nastr" action-type="call-plsql" timestamp="10.12.2018 18:49:19" file="sql.builder.templates\sql.builder\projects\45862\form\action.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <text>begin
vb_kol_gr_pack.upd_kg_nastr(:kod_nastr, :ym);
end;</text>
    </action>
    <action name="vb_kol_gr_pack.del_kg_nastr" action-type="call-plsql" timestamp="04.09.2019 17:25:23" file="sql.builder.templates\sql.builder\projects\45862\form\action.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <text>
        begin
        vb_kol_gr_pack.del_kg_nastr(:kod_nastr, :ym);
        end;
</text>
    </action>
    <action name="vb_kol_gr_pack.auto_kg_nastr" action-type="call-plsql" timestamp="04.09.2019 16:02:00" file="sql.builder.templates\sql.builder\projects\45862\form\action.xml">
      <params>
        <param name="kod_nastr" type="number" />
        <param name="ym" type="number" />
      </params>
      <text>begin
vb_kol_gr_pack.auto_kg_nastr(:kod_nastr, :ym);
end;</text>
    </action>
  </actions>
  <navigators child-name="navigator" key-name="name" />
  <projects child-name="project" key-name="name" />
</root>