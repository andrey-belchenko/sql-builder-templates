<?xml version="1.0" encoding="utf-8"?>
<root>
  <queries>
    <query name="vbr_calculation" timestamp="20.08.2019 16:58:05" is-report="1" title="Данные по статьям калькуляции" mode="excel" can-use-simple-params="1">
      <print-templates>
        <excel>
          <template name="mped_calc.xlsx" title="Отчет по статьям калькуляции" print-proc="2" print-xlsx="1" />
        </excel>
      </print-templates>
      <events>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="ee_op">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="te_op">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="total_op">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="ee_vp">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="te_vp">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="total_vp">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="ee_opr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="te_opr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="total_opr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="ee_ohr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="te_ohr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="total_ohr">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
        <useaction event-name="double-click" action-type="open-column-grouping-detail" call="vbr_calc_details" column="total">
          <useparam name="p_kod_direct" />
          <useparam name="p_ym" />
          <useparam name="p_vd" />
          <useparam name="p_subj" />
          <useparam name="p_mode" />
          <useparam name="p_dir_arr" />
        </useaction>
      </events>
      <content>
        <usefield field="va_direct1" title="Подразделение" name="p_kod_direct" type="number" column-mandatory="1" show-checkbox="0" />
        <usefield type="string" field="cmn_string" name="p_dir_name" column-visible="0">
          <defaultquery>
            <query name="va_direct_name_by_kod" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" show-checkbox="0" column-mandatory="1" name="p_ym" title="Периоды" type="number">
          <listquery>
            <query name="mped_spr_time_ym" />
          </listquery>
          <defaultquery>
            <query name="mped_spr_time_ym_prev" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" show-checkbox="0" name="p_ym_str" type="string" column-visible="0">
          <defaultquery>
            <query name="mped_spr_time_ym_string" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" show-checkbox="0" column-mandatory="1" name="p_vd" title="Вид деятельности" type="number">
          <listquery>
            <query name="vb_spr_vid_dey_od_list" />
          </listquery>
          <defaultquery>
            <query name="vb_spr_vid_dey_od_list" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" show-checkbox="0" name="p_vd_str" type="string" column-visible="0">
          <defaultquery>
            <query name="vb_spr_vid_dey_od_string" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" show-checkbox="0" column-mandatory="1" name="p_subj" type="number" title="Субъект РФ">
          <listquery>
            <query name="vb_spr_fed_subject" />
          </listquery>
          <defaultquery>
            <query name="vb_spr_fed_subject" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" show-checkbox="0" name="p_subj_str" type="string" column-visible="0">
          <defaultquery>
            <query name="vb_spr_fed_subject_string" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_combo_num" show-checkbox="0" column-mandatory="1" name="p_mode" type="number" title="Режим просмотра данных">
          <listquery>
            <query name="vbr_calculation_mode" />
          </listquery>
          <defaultquery>
            <query name="vbr_calculation_mode_def" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" show-checkbox="0" name="p_mode_str" type="string" column-visible="0">
          <defaultquery>
            <query name="vbr_calculation_mode_string" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_list" name="p_dir_arr" type="number" column-visible="0">
          <listquery exclude="1">
            <query name="is_spr_dr_tree_start_kod_dr" />
          </listquery>
          <defaultquery>
            <query name="is_spr_dr_tree_start_kod_dr" />
          </defaultquery>
        </usefield>
      </content>
      <select>
        <column column="kod_sp_calc" table="va_sp_calc_rep" />
        <column table="vb_spr_smet_calc" column="kod_spr_smet_calc" />
        <column table="vb_spr_smet_calc" column="smet_calc_name" />
        <call as="ee_op" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>3</const>
            </call>
            <call function="in" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>(0, 2, 9)</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_ee" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="te_op" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>3</const>
            </call>
            <call function="in" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>(0, 2, 9)</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_te" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="total_op" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>3</const>
            </call>
            <call function="in" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>(0, 2, 9)</const>
            </call>
            <call function="*">
              <call function="+nvl">
                <fact column="va_sp_calc_rep_dr_ee" table="all" />
                <fact column="va_sp_calc_rep_dr_te" table="all" />
              </call>
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="ee_vp" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>0</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>3</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_ee" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="te_vp" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>0</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>3</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_te" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="total_vp" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>0</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>3</const>
            </call>
            <call function="*">
              <call function="+nvl">
                <fact column="va_sp_calc_rep_dr_ee" table="all" />
                <fact column="va_sp_calc_rep_dr_te" table="all" />
              </call>
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="ee_opr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>1</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>5</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_ee" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="te_opr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>1</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>5</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_te" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="total_opr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>1</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>5</const>
            </call>
            <call function="*">
              <call function="+nvl">
                <fact column="va_sp_calc_rep_dr_ee" table="all" />
                <fact column="va_sp_calc_rep_dr_te" table="all" />
              </call>
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="ee_ohr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>2</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>6</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_ee" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="te_ohr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>2</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>6</const>
            </call>
            <call function="*">
              <fact column="va_sp_calc_rep_dr_te" table="all" />
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="total_ohr" type="number" function="case" group="sum">
          <call function="when">
            <call function="=">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>2</const>
            </call>
            <call function="=" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>6</const>
            </call>
            <call function="*">
              <call function="+nvl">
                <fact column="va_sp_calc_rep_dr_ee" table="all" />
                <fact column="va_sp_calc_rep_dr_te" table="all" />
              </call>
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <call as="total" type="number" function="case" group="sum">
          <call function="when">
            <call function="in">
              <column table="vb_spr_schet_calc" column="kod_spr_schet_list" />
              <const>(0, 1, 2, 3)</const>
            </call>
            <call function="in" exclude="1">
              <column table="vb_spr_schet_calc" column="kod_schet" />
              <const>(0, 2, 3, 5, 6, 9)</const>
            </call>
            <call function="*">
              <call function="+nvl">
                <fact column="va_sp_calc_rep_dr_ee" table="all" />
                <fact column="va_sp_calc_rep_dr_te" table="all" />
              </call>
              <call function="if">
                <call function="and">
                  <call function="=">
                    <useparam name="p_mode" />
                    <const>3</const>
                  </call>
                </call>
                <const>-1</const>
                <const>1</const>
              </call>
            </call>
          </call>
        </call>
        <fact column="vb_spr_smet_calc_schet_no_mb3" group="min" />
      </select>
      <from>
        <qube single-way="1">
          <link name="vb_spr_smet_calc" />
          <dimset as="all">
            <link name="va_sp_calc_rep" only-for-cond="1" />
            <link name="is_spr_smet" only-for-cond="1" exclude="1" />
            <link name="va_direct" only-for-cond="1" />
            <link name="va_direct2" only-for-cond="1" />
            <link name="va_direct3" only-for-cond="1" />
            <link name="vb_spr_vid_dey" only-for-cond="1" />
            <link name="vb_spr_vid_energ" only-for-cond="1" />
            <link name="vb_spr_od_nd" only-for-cond="1" />
            <link name="ym" only-for-cond="1" />
            <link name="month" only-for-cond="1" />
            <link name="vb_spr_smet_zatr_calc" />
            <link name="vb_spr_schet_calc" />
            <link name="vb_spr_fed_subject" only-for-cond="1" />
            <link name="vbr_calculation_mode" only-for-cond="1" />
            <link name="vb_spr_rasp_zatr" only-for-cond="1" />
            <where>
              <call type="" function="and" as="">
                <call function="=" exclude="1">
                  <column table="is_spr_smet" column="prizn" />
                  <column table="vb_spr_vid_dey" column="prizn" />
                </call>
                <call function="=">
                  <column table="vb_spr_vid_dey" column="prizn" />
                  <const>0</const>
                </call>
                <call function="is not null">
                  <column table="vb_spr_smet_calc" column="kod_spr_smet_calc" />
                </call>
                <call function="in">
                  <column table="ym" column="val" />
                  <useparam name="p_ym" />
                </call>
                <call function="in">
                  <column table="vb_spr_vid_dey" column="kod_spr_vid_dey" />
                  <useparam name="p_vd" />
                </call>
                <call function="in">
                  <column table="vb_spr_fed_subject" column="kod_spr_subj" />
                  <useparam name="p_subj" />
                </call>
                <call function="or">
                  <call function="and">
                    <call function="=">
                      <useparam name="p_mode" />
                      <const>0</const>
                    </call>
                    <call function="in">
                      <column table="va_direct2" column="kod_direct" />
                      <useparam name="p_dir_arr" />
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="p_mode" />
                      <const>1</const>
                    </call>
                    <call function="in">
                      <column table="va_direct" column="kod_direct" />
                      <useparam name="p_dir_arr" />
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="p_mode" />
                      <const>2</const>
                    </call>
                    <call function="in">
                      <column table="va_direct2" column="kod_direct" />
                      <useparam name="p_dir_arr" />
                    </call>
                    <call function="!=">
                      <column table="va_sp_calc_rep" column="mvp_kod" />
                      <call function="substr">
                        <column table="va_sp_calc_rep" column="mb3_kod" />
                        <const>1</const>
                        <const>4</const>
                      </call>
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="p_mode" />
                      <const>3</const>
                    </call>
                    <call function="in">
                      <column table="va_direct3" column="kod_direct" />
                      <useparam name="p_dir_arr" />
                    </call>
                    <call function="!=">
                      <column table="va_sp_calc_rep" column="mvp_kod" />
                      <call function="nvl">
                        <call function="substr">
                          <column table="va_sp_calc_rep" column="mb3_kod" />
                          <const>1</const>
                          <const>4</const>
                        </call>
                        <column table="va_sp_calc_rep" column="mvp_partner_kod" />
                      </call>
                    </call>
                  </call>
                  <call function="and">
                    <call function="=">
                      <useparam name="p_mode" />
                      <const>4</const>
                    </call>
                    <call function="or">
                      <call function="in" comment="Затраты выбранного подразделения">
                        <column table="va_direct" column="kod_direct" />
                        <useparam name="p_dir_arr" />
                      </call>
                      <call function="and" comment="Затраты от распределения">
                        <call function="is not null">
                          <column table="vb_spr_rasp_zatr" column="kod_spr_rasp_zatr" />
                        </call>
                        <call function="in">
                          <column table="va_direct2" column="kod_direct" />
                          <useparam name="p_dir_arr" />
                        </call>
                        <call function="!=">
                          <column table="va_sp_calc_rep" column="mvp_kod" />
                          <call function="substr">
                            <column table="va_sp_calc_rep" column="mb3_kod" />
                            <const>1</const>
                            <const>4</const>
                          </call>
                        </call>
                      </call>
                    </call>
                  </call>
                </call>
              </call>
            </where>
          </dimset>
        </qube>
      </from>
      <grouping>
        <grset as="all" title="Всего">
          <grset as="sc" order="smet_calc_name" title="По статьям для калькуляции">
            <group>
              <sourcelink table="vb_spr_smet_calc" />
            </group>
            <grset as="rep">
              <group>
                <sourcelink table="va_sp_calc_rep" />
              </group>
            </grset>
          </grset>
        </grset>
      </grouping>
      <having exclude="1">
        <call function="!=0">
          <column table="this" column="total" />
        </call>
      </having>
    </query>
    <query name="vbr_calculation_mode" timestamp="20.08.2019 14:05:36">
      <const as="id" type="number">0</const>
      <const as="name" type="string" title="1">'Все затраты'</const>
      <const>1</const>
      <const>'Затраты выбранного подразделения'</const>
      <const>2</const>
      <const>'Распределенные затраты (полученные)'</const>
      <const>3</const>
      <const>'Распределенные затраты (переданные)'</const>
      <const>4</const>
      <const>'Затраты выбранного подразделения с учетом ПСДТУиИТ'</const>
    </query>
    <query name="vbr_calculation_mode_def" timestamp="24.07.2019 18:17:12">
      <select>
        <column table="a" column="id" />
        <column table="a" column="name" />
      </select>
      <from>
        <query name="vbr_calculation_mode" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id" />
          <const>0</const>
        </call>
      </where>
    </query>
    <query name="vbr_calc_details" timestamp="20.08.2019 14:57:06" is-report="1" title="Детализация отчета по статьям калькуляции" visible="0">
      <params>
        <param name="p_kod_direct" type="number" />
        <param name="p_ym" type="array" />
        <param name="p_vd" type="array" />
        <param name="p_subj" type="array" />
        <param name="p_mode" type="number" />
        <param type="array" name="p_dir_arr" />
      </params>
      <select>
        <column table="va_sp_calc_rep" column="kod_sp_calc" key="1" column-visible="0" format="F0" title="R" />
        <column table="vb_spr_smet_calc" column="kod_spr_smet_calc" column-visible="0" />
        <column table="va_sp_calc_rep" column="kod_direct2" column-visible="0" />
        <column table="va_sp_calc_rep" column="kod_direct3" column-visible="0" />
        <band title="Вид деятельности">
          <column table="va_sp_calc_rep" column="vid_dey_kod" title="Код" column-width="39" format="F0" />
          <column table="va_sp_calc_rep" column="vid_dey_name" title="Наименование" column-width="120" />
          <column table="vb_spr_vid_energ" column="vid_energ_name" column-width="94" />
          <column table="vb_spr_od_nd" column="od_nd_name" column-width="63" />
        </band>
        <band title="Объект генерации">
          <column table="va_sp_calc_rep" column="ob_gen_kod" title="Код" column-width="64" />
          <column table="va_sp_calc_rep" column="ob_gen_name" title="Наименование" column-width="133" />
        </band>
        <column table="va_sp_calc_rep" column="period" column-width="67" title="Период" format="F2" />
        <band title="Субъект РФ">
          <column table="va_sp_calc_rep" column="subject_fed_kod" title="Код" column-width="39" format="F0" />
          <column table="va_sp_calc_rep" column="subject_fed_name" title="Наименование" column-width="110" />
        </band>
        <band title="Заказ">
          <column table="va_sp_calc_rep" column="zakaz_kod" title="Код" column-width="39" />
          <column table="va_sp_calc_rep" column="zakaz_name" title="Наименование" column-width="92" />
        </band>
        <band title="МВЗ">
          <column table="va_sp_calc_rep" column="mb3_kod" title="Код" column-width="94" column-editable="1" />
          <column table="va_sp_calc_rep" column="mb3_name" title="Наименование" column-width="133" column-editable="1" />
          <column table="va_sp_calc_rep" column="kod_schet_mb3" column-width="133" title="Код счета МВЗ" />
        </band>
        <band title="МВП: Партнер">
          <column table="va_sp_calc_rep" column="mvp_partner_kod" title="Код" column-width="53" column-editable="1" />
          <column table="va_sp_calc_rep" column="mvp_partner_name" title="Наименование" column-width="129" column-editable="1" />
        </band>
        <band title="Элемент затрат">
          <column table="va_sp_calc_rep" column="el_zatr_kod" title="Код" column-width="87" format="F0" />
          <column table="va_sp_calc_rep" column="el_zatr_name" title="Наименование" column-width="103" />
        </band>
        <band title="МВП">
          <column table="va_sp_calc_rep" column="mvp_kod" title="Код" column-width="60" column-editable="1" />
          <column table="va_sp_calc_rep" column="mvp_name" title="Наименование" column-width="129" column-editable="1" />
        </band>
        <column table="va_sp_calc_rep" column="vyruchka" title="Выручка" column-width="63" />
        <column table="va_sp_calc_rep" column="vol_sbyt" title="ОбъемСбыта" column-width="85" />
        <column table="va_sp_calc_rep" column="zatr" title="Затраты" column-width="91" />
        <column table="va_sp_calc_rep" column="tut" title="ТУТ" column-width="85" />
        <column table="va_sp_calc_rep" column="rash_vod_m3" title="РасхВод М3" column-width="78" />
        <column table="va_sp_calc_rep" column="rash_vod_t" title="РасхВод Т" column-width="70" />
        <column table="va_sp_calc_rep" column="rez_tepl_nag" title="РезТеплНаг" column-width="78" />
        <column table="va_sp_calc_rep" column="pris_tep_nag" title="ПрисТепНаг" column-width="79" />
      </select>
      <from>
        <qube star-scheme="1">
          <link name="vb_spr_smet_calc" />
          <dimset as="all">
            <link name="va_sp_calc_rep" />
            <link name="is_spr_smet" exclude="1" />
            <link name="va_direct" />
            <link name="va_direct2" />
            <link name="va_direct3" />
            <link name="vb_spr_vid_dey" />
            <link name="vb_spr_vid_energ" />
            <link name="vb_spr_od_nd" />
            <link name="ym" />
            <link name="month" />
            <link name="vb_spr_smet_zatr_calc" />
            <link name="vb_spr_schet_calc" />
            <link name="vb_spr_fed_subject" />
            <link name="vbr_calculation_mode" />
            <link name="vb_spr_rasp_zatr" />
          </dimset>
        </qube>
      </from>
    </query>
    <query name="vbr_calculation_mode_string" class="1" timestamp="25.07.2019 17:35:54">
      <params>
        <param name="p_mode" type="number" />
      </params>
      <select>
        <column table="a" column="name" data-size="300" key="1" group="max" />
      </select>
      <from>
        <query name="vbr_calculation_mode" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="id" />
          <useparam name="p_mode" />
        </call>
      </where>
    </query>
    <query name="vbr_calculation_svod_old" timestamp="30.08.2019 16:44:14" is-report="1" title="Сводный отчет по калькуляции" mode="excel" can-use-simple-params="1">
      <procedure>
    begin
        vb_refs.report_calc_svod(:p_ym_str);
    end;
</procedure>
      <print-templates>
        <excel>
          <template name="mped_calc_svod.xlsx" print-proc="2" print-xlsx="1" title="Сводный отчет по калькуляции" />
        </excel>
      </print-templates>
      <content>
        <usefield field="cmn_list" show-checkbox="0" column-mandatory="1" name="p_ym" title="Периоды" type="number">
          <listquery>
            <query name="mped_spr_time_ym" />
          </listquery>
          <defaultquery>
            <query name="mped_spr_time_ym_prev" />
          </defaultquery>
        </usefield>
        <usefield field="cmn_string" show-checkbox="0" name="p_ym_str" type="string" column-visible="0">
          <defaultquery>
            <query name="mped_spr_time_ym_string" />
          </defaultquery>
        </usefield>
      </content>
      <select>
        <call as="id" function="rownum" />
        <column column="skod" table="a" type="string" />
        <column as="excel_list" column="s1" table="a" type="string" />
        <column as="ord" column="n1" table="a" type="number" />
        <column as="name" column="s2" table="a" type="string" />
        <column as="teplo_ee" column="n2" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="teplo_te" column="n3" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="voda_ee" column="n4" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="voda_te" column="n5" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="opl_trud_ee" column="n6" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="opl_trud_te" column="n7" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="soc_ee" column="n8" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="soc_te" column="n9" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="amort_ee" column="n10" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="amort_te" column="n11" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="sod_obor_ee" column="n12" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="sod_obor_te" column="n13" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="ceh_ee" column="n14" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="ceh_te" column="n15" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="zavod_ee" column="n16" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="zavod_te" column="n17" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="usl_ryn_ee" column="n18" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="pokup_ee" column="n19" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="pokup_te" column="n20" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="total_ee" column="n21" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="total_te" column="n22" group="sum" mp="-3" nullif="0" table="a" type="number" />
        <column as="total" column="n23" group="sum" mp="-3" nullif="0" table="a" type="number" />
      </select>
      <from>
        <table as="a" name="rr_temp" />
      </from>
      <where>
        <call function="=">
          <column column="skod" table="this" />
          <const>'mped_rep_calculation_svod'</const>
        </call>
      </where>
      <grouping>
        <grset as="by_dep" title="По филиалам">
          <group>
            <column column="excel_list" table="this" />
          </group>
          <grset as="by_podr" order="ord" title="По подразделениям">
            <group>
              <column column="name" table="this" />
              <column column="ord" table="this" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="vbr_calculation_svod_by_dep" timestamp="02.07.2023 19:45:17">
      <select>
        <call as="id" function="rownum" />
        <column table="a" column="skod" type="string" />
        <column table="a" column="s1" type="string" as="excel_list" />
        <column table="a" column="n1" type="number" as="ord" />
        <column table="a" column="s2" type="string" as="name" />
        <column table="a" column="n2" type="number" group="sum" as="teplo_ee" mp="-3" nullif="0" />
        <column table="a" column="n3" type="number" as="teplo_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n4" type="number" as="voda_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n5" type="number" as="voda_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n6" type="number" as="opl_trud_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n7" type="number" as="opl_trud_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n8" type="number" as="soc_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n9" type="number" as="soc_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n10" type="number" as="amort_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n11" type="number" as="amort_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n12" type="number" as="sod_obor_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n13" type="number" as="sod_obor_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n14" type="number" as="ceh_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n15" type="number" as="ceh_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n16" type="number" as="zavod_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n17" type="number" as="zavod_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n18" type="number" as="usl_ryn_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n19" type="number" as="pokup_ee_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n24" type="number" as="pokup_ee_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n20" type="number" as="pokup_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n21" type="number" as="total_ee" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n22" type="number" as="total_te" group="sum" mp="-3" nullif="0" />
        <column table="a" column="n23" type="number" as="total" group="sum" mp="-3" nullif="0" />
      </select>
      <from>
        <table name="rr_temp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="this" column="skod" />
          <const>'mped_rep_calculation_svod'</const>
        </call>
      </where>
      <grouping>
        <grset as="by_dep" title="По филиалам">
          <group>
            <column table="this" column="excel_list" />
          </group>
          <grset as="by_podr" title="По подразделениям" order="ord">
            <group>
              <column table="this" column="name" />
              <column table="this" column="ord" />
            </group>
          </grset>
        </grset>
      </grouping>
    </query>
    <query name="vbr_calculation_svod_ref" timestamp="11.10.2019 14:03:44" order="ord">
      <select>
        <call as="id" function="rownum" />
        <column table="a" column="skod" type="string" />
        <column table="a" column="n1" type="number" as="ord" />
        <column table="a" column="s2" type="string" as="name" />
        <column table="a" column="n2" type="number" as="vod_tax" mp="-3" nullif="0" />
        <column table="a" column="n3" type="number" as="en_hoz_ee" mp="-3" nullif="0" />
        <column table="a" column="n4" type="number" as="en_hoz_te" mp="-3" nullif="0" />
        <column table="a" column="n5" type="number" as="tax_ee" mp="-3" nullif="0" />
        <column table="a" column="n6" type="number" as="tax_te" mp="-3" nullif="0" />
        <column table="a" column="n7" type="number" as="remont_ee" mp="-3" nullif="0" />
        <column table="a" column="n8" type="number" as="remont_te" mp="-3" nullif="0" />
        <column table="a" column="n9" type="number" as="vod_tax_te" mp="-3" nullif="0" />
      </select>
      <from>
        <table name="rr_temp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="this" column="skod" />
          <const>'mped_rep_calculation_svod_ref'</const>
        </call>
      </where>
    </query>
    <query name="vbr_calc_details_dev" is-report="1" title="Детализация отчета по статьям калькуляции" visible="0" timestamp="30.07.2023 17:38:58">
      <params>
        <param name="p_ym" type="array" />
        <param name="p_sheet" type="string" />
        <param name="p_line" type="string" />
        <param name="p_col" type="string" />
      </params>
      <select>
        <call function="()" type="string" as="sheet" title="sheet">
          <useparam name="p_sheet" />
        </call>
        <call function="()" type="string" as="line" title="row">
          <useparam name="p_line" />
        </call>
        <call function="()" type="string" as="col" title="column">
          <useparam name="p_col" />
        </call>
        <column table="a" column="ym" key="1" />
        <column table="a" column="name" />
      </select>
      <from>
        <query name="mped_spr_time_ym" as="a" />
      </from>
      <where>
        <call function="in">
          <column table="a" column="ym" />
          <useparam name="p_ym" />
        </call>
      </where>
    </query>
    <query name="vbr_calc_details_proc_dev" is-report="1" title="Детализация отчета по статьям калькуляции" visible="0" timestamp="30.07.2023 18:00:15">
      <params>
        <param name="p_ym_str" type="array" />
        <param name="p_sheet" type="string" />
        <param name="p_line" type="string" />
        <param name="p_col" type="string" />
      </params>
      <procedure><![CDATA[ begin
        vb_refs.report_calc_svod_detail(:p_ym_str,:p_sheet,:p_line,:p_col);
    end;
]]></procedure>
      <select>
        <call function="row_num" as="rn" key="1">
          <const>1</const>
        </call>
        <column table="a" column="s1" as="yms" title="yms" />
        <column table="a" column="s2" title="sheet" as="sheet" />
        <column table="a" column="s3" as="line" title="row" />
        <column table="a" column="s4" as="col" title="column" />
      </select>
      <from>
        <query name="rr_temp" as="a" />
      </from>
      <where>
        <call function="=">
          <column table="a" column="skod" />
          <const>'mped_rep_calculation_svod_detail'</const>
        </call>
      </where>
    </query>
    <query name="vbr_calc_svod_details" is-report="1" title="Детализация Сводного отчета по калькуляции" visible="0" timestamp="24.08.2023 17:08:29">
      <params>
        <param name="p_ym_str" type="array" />
        <param name="p_sheet" type="string" />
        <param name="p_line" type="string" />
        <param name="p_col" type="string" />
      </params>
      <procedure><![CDATA[ begin
        vb_refs.report_calc_svod_detail(:p_ym_str,:p_sheet,:p_line,:p_col);
    end;
]]></procedure>
      <select>
        <column table="a" column="n1" key="1" column-visible="0" format="F0" title="R" as="kod_sp_calc" />
        <band title="Вид деятельности">
          <column table="a" column="n2" title="Код" column-width="39" format="F0" as="vid_dey_kod" />
          <column table="a" column="s1" title="Наименование" column-width="120" as="vid_dey_name" />
          <column table="a" column="s2" column-width="94" as="vid_energ_name" />
          <column table="a" column="s3" column-width="63" as="od_nd_name" />
        </band>
        <band title="Объект генерации">
          <column table="a" column="s4" title="Код" column-width="64" as="ob_gen_kod" />
          <column table="a" column="s5" title="Наименование" column-width="133" as="ob_gen_name" />
        </band>
        <column table="a" column="n3" column-width="67" title="Период" format="F2" as="period" />
        <band title="Субъект РФ">
          <column table="a" column="n4" title="Код" column-width="39" format="F0" as="subject_fed_kod" />
          <column table="a" title="Наименование" column-width="110" column="s6" as="subject_fed_name" />
        </band>
        <band title="Заказ">
          <column table="a" column="s7" title="Код" column-width="39" as="zakaz_kod" />
          <column table="a" column="s8" title="Наименование" column-width="92" as="zakaz_name" />
        </band>
        <band title="МВЗ">
          <column table="a" column="s9" title="Код" column-width="94" column-editable="1" as="mb3_kod" />
          <column table="a" column="s10" title="Наименование" column-width="133" column-editable="1" as="mb3_name" />
          <column table="a" column="n5" column-width="133" title="Код счета МВЗ" as="kod_schet_mb3" />
        </band>
        <band title="МВП: Партнер">
          <column table="a" column="s11" title="Код" column-width="53" column-editable="1" as="mvp_partner_kod" />
          <column table="a" column="s12" title="Наименование" column-width="129" column-editable="1" as="mvp_partner_name" />
        </band>
        <band title="Элемент затрат">
          <column table="a" column="n6" title="Код" column-width="87" format="F0" as="el_zatr_kod" />
          <column table="a" column="s13" title="Наименование" column-width="103" as="el_zatr_name" />
        </band>
        <band title="МВП">
          <column table="a" column="s14" title="Код" column-width="60" column-editable="1" as="mvp_kod" />
          <column table="a" column="s15" title="Наименование" column-width="129" column-editable="1" as="mvp_name" />
        </band>
        <column table="a" column="n7" title="Выручка" column-width="63" as="vyruchka" />
        <column table="a" column="n8" title="ОбъемСбыта" column-width="85" as="vol_sbyt" />
        <column table="a" column="n9" title="Затраты" column-width="91" as="zatr" />
        <column table="a" column="n10" title="ТУТ" column-width="85" as="tut" />
        <column table="a" column="n11" title="РасхВод М3" column-width="78" as="rash_vod_m3" />
        <column table="a" column="n12" title="РасхВод Т" column-width="70" as="rash_vod_t" />
        <column table="a" column="n13" title="РезТеплНаг" column-width="78" as="rez_tepl_nag" />
        <column table="a" column="n14" title="ПрисТепНаг" column-width="79" as="pris_tep_nag" />
      </select>
      <from>
        <query name="rr_temp" as="a" />
      </from>
      <where>
        <call function="and">
          <call function="=">
            <column table="a" column="skod" />
            <const>'mped_rep_calculation_svod_detail'</const>
          </call>
          <call function="=">
            <column table="a" column="polzov" />
            <const>user</const>
          </call>
        </call>
      </where>
    </query>
  </queries>
  <reports>
    <report name="vbr_calculation_svod" title="Сводный отчет по калькуляции" mode="excel" timestamp="25.08.2023 15:09:31">
      <params>
        <param name="p_ym" type="array" />
        <param name="p_ym_str" type="string" />
      </params>
      <procedure>
    begin
        vb_refs.report_calc_svod(:p_ym_str);
    end;
</procedure>
      <print-templates>
        <excel>
          <template name="mped_calc_svod.xlsx" print-proc="2" print-xlsx="1" title="Сводный отчет по калькуляции" />
        </excel>
      </print-templates>
      <queries>
        <query name="vbr_calculation_svod_by_dep" as="a">
          <events>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="teplo_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'teplo_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="teplo_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'teplo_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="voda_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'voda_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="voda_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'voda_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="opl_trud_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'opl_trud_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="opl_trud_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'opl_trud_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="soc_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'soc_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="soc_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'soc_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="amort_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'amort_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="amort_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'amort_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="sod_obor_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'sod_obor_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="sod_obor_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'sod_obor_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="ceh_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'ceh_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="ceh_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'ceh_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="zavod_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'zavod_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="zavod_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'zavod_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="usl_ryn_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'usl_ryn_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="pokup_ee_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'pokup_ee_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="pokup_ee_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'pokup_ee_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="pokup_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'pokup_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="total_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'total_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="total_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'total_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="total">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'total'</const>
            </useaction>
          </events>
        </query>
        <query name="vbr_calculation_svod_ref" as="ref">
          <events>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="vod_tax">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'vod_tax_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="vod_tax_te">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'vod_tax_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="en_hoz_ee">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'en_hoz_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="en_hoz_te">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'en_hoz_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="tax_ee">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'tax_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="tax_te">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'tax_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="remont_ee">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'remont_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_svod_details" event-name="double-click" column="remont_te">
              <useparam name="p_ym_str" />
              <const type="string">'Справка'</const>
              <column table="a" column="name" />
              <const type="string">'remont_te'</const>
            </useaction>
          </events>
        </query>
      </queries>
    </report>
    <report name="vbr_calculation_svod_dev" title="Сводный отчет по калькуляции" mode="excel" visible="0" form="vbr_calculation_svod" timestamp="30.07.2023 18:02:33">
      <params>
        <param name="p_ym" type="array" />
        <param name="p_ym_str" type="string" />
      </params>
      <procedure>
    begin
        vb_refs.report_calc_svod(:p_ym_str);
    end;
</procedure>
      <print-templates>
        <excel>
          <template name="mped_calc_svod.xlsx" print-proc="2" print-xlsx="1" title="Сводный отчет по калькуляции" />
        </excel>
      </print-templates>
      <queries>
        <query name="vbr_calculation_svod_by_dep" as="a">
          <events>
            <useaction action-type="open-report" call="vbr_calc_details_dev" event-name="double-click" column="teplo_ee">
              <useparam name="p_ym" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'teplo_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_details_dev" event-name="double-click" column="teplo_te">
              <useparam name="p_ym" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'teplo_te'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_details_proc_dev" event-name="double-click" column="voda_ee">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'voda_ee'</const>
            </useaction>
            <useaction action-type="open-report" call="vbr_calc_details_proc_dev" event-name="double-click" column="voda_te">
              <useparam name="p_ym_str" />
              <column table="a" column="excel_list" />
              <column table="a" column="name" />
              <const type="string">'voda_te'</const>
            </useaction>
          </events>
        </query>
        <query name="vbr_calculation_svod_ref" as="ref" />
      </queries>
    </report>
  </reports>
  <forms>
    <form name="vbr_calculation_svod" timestamp="30.08.2019 16:45:04">
      <usefield field="cmn_list" show-checkbox="0" column-mandatory="1" name="p_ym" title="Периоды" type="number">
        <listquery>
          <query name="mped_spr_time_ym" />
        </listquery>
        <defaultquery>
          <query name="mped_spr_time_ym_prev" />
        </defaultquery>
      </usefield>
      <usefield field="cmn_string" show-checkbox="0" name="p_ym_str" type="string" column-visible="0">
        <defaultquery>
          <query name="mped_spr_time_ym_string" />
        </defaultquery>
      </usefield>
    </form>
  </forms>
</root>